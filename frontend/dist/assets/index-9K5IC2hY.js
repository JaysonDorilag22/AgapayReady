var fY=Object.defineProperty;var pY=(e,r,s)=>r in e?fY(e,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[r]=s;var Ie=(e,r,s)=>(pY(e,typeof r!="symbol"?r+"":r,s),s);function mY(e,r){for(var s=0;s<r.length;s++){const a=r[s];if(typeof a!="string"&&!Array.isArray(a)){for(const h in a)if(h!=="default"&&!(h in e)){const f=Object.getOwnPropertyDescriptor(a,h);f&&Object.defineProperty(e,h,f.get?f:{enumerable:!0,get:()=>a[h]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const h of document.querySelectorAll('link[rel="modulepreload"]'))a(h);new MutationObserver(h=>{for(const f of h)if(f.type==="childList")for(const m of f.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&a(m)}).observe(document,{childList:!0,subtree:!0});function s(h){const f={};return h.integrity&&(f.integrity=h.integrity),h.referrerPolicy&&(f.referrerPolicy=h.referrerPolicy),h.crossOrigin==="use-credentials"?f.credentials="include":h.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function a(h){if(h.ep)return;h.ep=!0;const f=s(h);fetch(h.href,f)}})();var Fa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function mB(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var gB={exports:{}},Tx={},_B={exports:{}},Xn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bg=Symbol.for("react.element"),gY=Symbol.for("react.portal"),_Y=Symbol.for("react.fragment"),yY=Symbol.for("react.strict_mode"),vY=Symbol.for("react.profiler"),xY=Symbol.for("react.provider"),bY=Symbol.for("react.context"),wY=Symbol.for("react.forward_ref"),SY=Symbol.for("react.suspense"),TY=Symbol.for("react.memo"),EY=Symbol.for("react.lazy"),xz=Symbol.iterator;function MY(e){return e===null||typeof e!="object"?null:(e=xz&&e[xz]||e["@@iterator"],typeof e=="function"?e:null)}var yB={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},vB=Object.assign,xB={};function Sf(e,r,s){this.props=e,this.context=r,this.refs=xB,this.updater=s||yB}Sf.prototype.isReactComponent={};Sf.prototype.setState=function(e,r){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,r,"setState")};Sf.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function bB(){}bB.prototype=Sf.prototype;function cA(e,r,s){this.props=e,this.context=r,this.refs=xB,this.updater=s||yB}var uA=cA.prototype=new bB;uA.constructor=cA;vB(uA,Sf.prototype);uA.isPureReactComponent=!0;var bz=Array.isArray,wB=Object.prototype.hasOwnProperty,hA={current:null},SB={key:!0,ref:!0,__self:!0,__source:!0};function TB(e,r,s){var a,h={},f=null,m=null;if(r!=null)for(a in r.ref!==void 0&&(m=r.ref),r.key!==void 0&&(f=""+r.key),r)wB.call(r,a)&&!SB.hasOwnProperty(a)&&(h[a]=r[a]);var y=arguments.length-2;if(y===1)h.children=s;else if(1<y){for(var x=Array(y),w=0;w<y;w++)x[w]=arguments[w+2];h.children=x}if(e&&e.defaultProps)for(a in y=e.defaultProps,y)h[a]===void 0&&(h[a]=y[a]);return{$$typeof:bg,type:e,key:f,ref:m,props:h,_owner:hA.current}}function AY(e,r){return{$$typeof:bg,type:e.type,key:r,ref:e.ref,props:e.props,_owner:e._owner}}function dA(e){return typeof e=="object"&&e!==null&&e.$$typeof===bg}function CY(e){var r={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(s){return r[s]})}var wz=/\/+/g;function HS(e,r){return typeof e=="object"&&e!==null&&e.key!=null?CY(""+e.key):r.toString(36)}function U0(e,r,s,a,h){var f=typeof e;(f==="undefined"||f==="boolean")&&(e=null);var m=!1;if(e===null)m=!0;else switch(f){case"string":case"number":m=!0;break;case"object":switch(e.$$typeof){case bg:case gY:m=!0}}if(m)return m=e,h=h(m),e=a===""?"."+HS(m,0):a,bz(h)?(s="",e!=null&&(s=e.replace(wz,"$&/")+"/"),U0(h,r,s,"",function(w){return w})):h!=null&&(dA(h)&&(h=AY(h,s+(!h.key||m&&m.key===h.key?"":(""+h.key).replace(wz,"$&/")+"/")+e)),r.push(h)),1;if(m=0,a=a===""?".":a+":",bz(e))for(var y=0;y<e.length;y++){f=e[y];var x=a+HS(f,y);m+=U0(f,r,s,x,h)}else if(x=MY(e),typeof x=="function")for(e=x.call(e),y=0;!(f=e.next()).done;)f=f.value,x=a+HS(f,y++),m+=U0(f,r,s,x,h);else if(f==="object")throw r=String(e),Error("Objects are not valid as a React child (found: "+(r==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":r)+"). If you meant to render a collection of children, use an array instead.");return m}function qy(e,r,s){if(e==null)return e;var a=[],h=0;return U0(e,a,"","",function(f){return r.call(s,f,h++)}),a}function PY(e){if(e._status===-1){var r=e._result;r=r(),r.then(function(s){(e._status===0||e._status===-1)&&(e._status=1,e._result=s)},function(s){(e._status===0||e._status===-1)&&(e._status=2,e._result=s)}),e._status===-1&&(e._status=0,e._result=r)}if(e._status===1)return e._result.default;throw e._result}var As={current:null},$0={transition:null},IY={ReactCurrentDispatcher:As,ReactCurrentBatchConfig:$0,ReactCurrentOwner:hA};Xn.Children={map:qy,forEach:function(e,r,s){qy(e,function(){r.apply(this,arguments)},s)},count:function(e){var r=0;return qy(e,function(){r++}),r},toArray:function(e){return qy(e,function(r){return r})||[]},only:function(e){if(!dA(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Xn.Component=Sf;Xn.Fragment=_Y;Xn.Profiler=vY;Xn.PureComponent=cA;Xn.StrictMode=yY;Xn.Suspense=SY;Xn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=IY;Xn.cloneElement=function(e,r,s){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=vB({},e.props),h=e.key,f=e.ref,m=e._owner;if(r!=null){if(r.ref!==void 0&&(f=r.ref,m=hA.current),r.key!==void 0&&(h=""+r.key),e.type&&e.type.defaultProps)var y=e.type.defaultProps;for(x in r)wB.call(r,x)&&!SB.hasOwnProperty(x)&&(a[x]=r[x]===void 0&&y!==void 0?y[x]:r[x])}var x=arguments.length-2;if(x===1)a.children=s;else if(1<x){y=Array(x);for(var w=0;w<x;w++)y[w]=arguments[w+2];a.children=y}return{$$typeof:bg,type:e.type,key:h,ref:f,props:a,_owner:m}};Xn.createContext=function(e){return e={$$typeof:bY,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:xY,_context:e},e.Consumer=e};Xn.createElement=TB;Xn.createFactory=function(e){var r=TB.bind(null,e);return r.type=e,r};Xn.createRef=function(){return{current:null}};Xn.forwardRef=function(e){return{$$typeof:wY,render:e}};Xn.isValidElement=dA;Xn.lazy=function(e){return{$$typeof:EY,_payload:{_status:-1,_result:e},_init:PY}};Xn.memo=function(e,r){return{$$typeof:TY,type:e,compare:r===void 0?null:r}};Xn.startTransition=function(e){var r=$0.transition;$0.transition={};try{e()}finally{$0.transition=r}};Xn.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Xn.useCallback=function(e,r){return As.current.useCallback(e,r)};Xn.useContext=function(e){return As.current.useContext(e)};Xn.useDebugValue=function(){};Xn.useDeferredValue=function(e){return As.current.useDeferredValue(e)};Xn.useEffect=function(e,r){return As.current.useEffect(e,r)};Xn.useId=function(){return As.current.useId()};Xn.useImperativeHandle=function(e,r,s){return As.current.useImperativeHandle(e,r,s)};Xn.useInsertionEffect=function(e,r){return As.current.useInsertionEffect(e,r)};Xn.useLayoutEffect=function(e,r){return As.current.useLayoutEffect(e,r)};Xn.useMemo=function(e,r){return As.current.useMemo(e,r)};Xn.useReducer=function(e,r,s){return As.current.useReducer(e,r,s)};Xn.useRef=function(e){return As.current.useRef(e)};Xn.useState=function(e){return As.current.useState(e)};Xn.useSyncExternalStore=function(e,r,s){return As.current.useSyncExternalStore(e,r,s)};Xn.useTransition=function(){return As.current.useTransition()};Xn.version="18.2.0";_B.exports=Xn;var Y=_B.exports;const we=mB(Y),iu=mY({__proto__:null,default:we},[Y]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kY=Y,DY=Symbol.for("react.element"),RY=Symbol.for("react.fragment"),OY=Object.prototype.hasOwnProperty,LY=kY.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,zY={key:!0,ref:!0,__self:!0,__source:!0};function EB(e,r,s){var a,h={},f=null,m=null;s!==void 0&&(f=""+s),r.key!==void 0&&(f=""+r.key),r.ref!==void 0&&(m=r.ref);for(a in r)OY.call(r,a)&&!zY.hasOwnProperty(a)&&(h[a]=r[a]);if(e&&e.defaultProps)for(a in r=e.defaultProps,r)h[a]===void 0&&(h[a]=r[a]);return{$$typeof:DY,type:e,key:f,ref:m,props:h,_owner:LY.current}}Tx.Fragment=RY;Tx.jsx=EB;Tx.jsxs=EB;gB.exports=Tx;var D=gB.exports,cE={},MB={exports:{}},_o={},AB={exports:{}},CB={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function r(Ft,$t){var ee=Ft.length;Ft.push($t);t:for(;0<ee;){var se=ee-1>>>1,Ot=Ft[se];if(0<h(Ot,$t))Ft[se]=$t,Ft[ee]=Ot,ee=se;else break t}}function s(Ft){return Ft.length===0?null:Ft[0]}function a(Ft){if(Ft.length===0)return null;var $t=Ft[0],ee=Ft.pop();if(ee!==$t){Ft[0]=ee;t:for(var se=0,Ot=Ft.length,Me=Ot>>>1;se<Me;){var me=2*(se+1)-1,kt=Ft[me],Wt=me+1,Ct=Ft[Wt];if(0>h(kt,ee))Wt<Ot&&0>h(Ct,kt)?(Ft[se]=Ct,Ft[Wt]=ee,se=Wt):(Ft[se]=kt,Ft[me]=ee,se=me);else if(Wt<Ot&&0>h(Ct,ee))Ft[se]=Ct,Ft[Wt]=ee,se=Wt;else break t}}return $t}function h(Ft,$t){var ee=Ft.sortIndex-$t.sortIndex;return ee!==0?ee:Ft.id-$t.id}if(typeof performance=="object"&&typeof performance.now=="function"){var f=performance;e.unstable_now=function(){return f.now()}}else{var m=Date,y=m.now();e.unstable_now=function(){return m.now()-y}}var x=[],w=[],T=1,M=null,I=3,R=!1,O=!1,N=!1,G=typeof setTimeout=="function"?setTimeout:null,$=typeof clearTimeout=="function"?clearTimeout:null,z=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function B(Ft){for(var $t=s(w);$t!==null;){if($t.callback===null)a(w);else if($t.startTime<=Ft)a(w),$t.sortIndex=$t.expirationTime,r(x,$t);else break;$t=s(w)}}function H(Ft){if(N=!1,B(Ft),!O)if(s(x)!==null)O=!0,Rt(K);else{var $t=s(w);$t!==null&&Zt(H,$t.startTime-Ft)}}function K(Ft,$t){O=!1,N&&(N=!1,$(et),et=-1),R=!0;var ee=I;try{for(B($t),M=s(x);M!==null&&(!(M.expirationTime>$t)||Ft&&!Q());){var se=M.callback;if(typeof se=="function"){M.callback=null,I=M.priorityLevel;var Ot=se(M.expirationTime<=$t);$t=e.unstable_now(),typeof Ot=="function"?M.callback=Ot:M===s(x)&&a(x),B($t)}else a(x);M=s(x)}if(M!==null)var Me=!0;else{var me=s(w);me!==null&&Zt(H,me.startTime-$t),Me=!1}return Me}finally{M=null,I=ee,R=!1}}var at=!1,ft=null,et=-1,nt=5,W=-1;function Q(){return!(e.unstable_now()-W<nt)}function yt(){if(ft!==null){var Ft=e.unstable_now();W=Ft;var $t=!0;try{$t=ft(!0,Ft)}finally{$t?Pt():(at=!1,ft=null)}}else at=!1}var Pt;if(typeof z=="function")Pt=function(){z(yt)};else if(typeof MessageChannel<"u"){var st=new MessageChannel,St=st.port2;st.port1.onmessage=yt,Pt=function(){St.postMessage(null)}}else Pt=function(){G(yt,0)};function Rt(Ft){ft=Ft,at||(at=!0,Pt())}function Zt(Ft,$t){et=G(function(){Ft(e.unstable_now())},$t)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Ft){Ft.callback=null},e.unstable_continueExecution=function(){O||R||(O=!0,Rt(K))},e.unstable_forceFrameRate=function(Ft){0>Ft||125<Ft?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):nt=0<Ft?Math.floor(1e3/Ft):5},e.unstable_getCurrentPriorityLevel=function(){return I},e.unstable_getFirstCallbackNode=function(){return s(x)},e.unstable_next=function(Ft){switch(I){case 1:case 2:case 3:var $t=3;break;default:$t=I}var ee=I;I=$t;try{return Ft()}finally{I=ee}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Ft,$t){switch(Ft){case 1:case 2:case 3:case 4:case 5:break;default:Ft=3}var ee=I;I=Ft;try{return $t()}finally{I=ee}},e.unstable_scheduleCallback=function(Ft,$t,ee){var se=e.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?se+ee:se):ee=se,Ft){case 1:var Ot=-1;break;case 2:Ot=250;break;case 5:Ot=1073741823;break;case 4:Ot=1e4;break;default:Ot=5e3}return Ot=ee+Ot,Ft={id:T++,callback:$t,priorityLevel:Ft,startTime:ee,expirationTime:Ot,sortIndex:-1},ee>se?(Ft.sortIndex=ee,r(w,Ft),s(x)===null&&Ft===s(w)&&(N?($(et),et=-1):N=!0,Zt(H,ee-se))):(Ft.sortIndex=Ot,r(x,Ft),O||R||(O=!0,Rt(K))),Ft},e.unstable_shouldYield=Q,e.unstable_wrapCallback=function(Ft){var $t=I;return function(){var ee=I;I=$t;try{return Ft.apply(this,arguments)}finally{I=ee}}}})(CB);AB.exports=CB;var NY=AB.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var PB=Y,fo=NY;function Te(e){for(var r="https://reactjs.org/docs/error-decoder.html?invariant="+e,s=1;s<arguments.length;s++)r+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+e+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var IB=new Set,Nm={};function Ih(e,r){lf(e,r),lf(e+"Capture",r)}function lf(e,r){for(Nm[e]=r,e=0;e<r.length;e++)IB.add(r[e])}var zl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),uE=Object.prototype.hasOwnProperty,FY=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Sz={},Tz={};function BY(e){return uE.call(Tz,e)?!0:uE.call(Sz,e)?!1:FY.test(e)?Tz[e]=!0:(Sz[e]=!0,!1)}function jY(e,r,s,a){if(s!==null&&s.type===0)return!1;switch(typeof r){case"function":case"symbol":return!0;case"boolean":return a?!1:s!==null?!s.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function VY(e,r,s,a){if(r===null||typeof r>"u"||jY(e,r,s,a))return!0;if(a)return!1;if(s!==null)switch(s.type){case 3:return!r;case 4:return r===!1;case 5:return isNaN(r);case 6:return isNaN(r)||1>r}return!1}function Cs(e,r,s,a,h,f,m){this.acceptsBooleans=r===2||r===3||r===4,this.attributeName=a,this.attributeNamespace=h,this.mustUseProperty=s,this.propertyName=e,this.type=r,this.sanitizeURL=f,this.removeEmptyString=m}var ns={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){ns[e]=new Cs(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var r=e[0];ns[r]=new Cs(r,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){ns[e]=new Cs(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){ns[e]=new Cs(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){ns[e]=new Cs(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){ns[e]=new Cs(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){ns[e]=new Cs(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){ns[e]=new Cs(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){ns[e]=new Cs(e,5,!1,e.toLowerCase(),null,!1,!1)});var fA=/[\-:]([a-z])/g;function pA(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var r=e.replace(fA,pA);ns[r]=new Cs(r,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var r=e.replace(fA,pA);ns[r]=new Cs(r,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var r=e.replace(fA,pA);ns[r]=new Cs(r,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){ns[e]=new Cs(e,1,!1,e.toLowerCase(),null,!1,!1)});ns.xlinkHref=new Cs("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){ns[e]=new Cs(e,1,!1,e.toLowerCase(),null,!0,!0)});function mA(e,r,s,a){var h=ns.hasOwnProperty(r)?ns[r]:null;(h!==null?h.type!==0:a||!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(VY(r,s,h,a)&&(s=null),a||h===null?BY(r)&&(s===null?e.removeAttribute(r):e.setAttribute(r,""+s)):h.mustUseProperty?e[h.propertyName]=s===null?h.type===3?!1:"":s:(r=h.attributeName,a=h.attributeNamespace,s===null?e.removeAttribute(r):(h=h.type,s=h===3||h===4&&s===!0?"":""+s,a?e.setAttributeNS(a,r,s):e.setAttribute(r,s))))}var Ul=PB.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Zy=Symbol.for("react.element"),Fd=Symbol.for("react.portal"),Bd=Symbol.for("react.fragment"),gA=Symbol.for("react.strict_mode"),hE=Symbol.for("react.profiler"),kB=Symbol.for("react.provider"),DB=Symbol.for("react.context"),_A=Symbol.for("react.forward_ref"),dE=Symbol.for("react.suspense"),fE=Symbol.for("react.suspense_list"),yA=Symbol.for("react.memo"),kc=Symbol.for("react.lazy"),RB=Symbol.for("react.offscreen"),Ez=Symbol.iterator;function Fp(e){return e===null||typeof e!="object"?null:(e=Ez&&e[Ez]||e["@@iterator"],typeof e=="function"?e:null)}var oi=Object.assign,qS;function im(e){if(qS===void 0)try{throw Error()}catch(s){var r=s.stack.trim().match(/\n( *(at )?)/);qS=r&&r[1]||""}return`
`+qS+e}var ZS=!1;function XS(e,r){if(!e||ZS)return"";ZS=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(r)if(r=function(){throw Error()},Object.defineProperty(r.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(r,[])}catch(w){var a=w}Reflect.construct(e,[],r)}else{try{r.call()}catch(w){a=w}e.call(r.prototype)}else{try{throw Error()}catch(w){a=w}e()}}catch(w){if(w&&a&&typeof w.stack=="string"){for(var h=w.stack.split(`
`),f=a.stack.split(`
`),m=h.length-1,y=f.length-1;1<=m&&0<=y&&h[m]!==f[y];)y--;for(;1<=m&&0<=y;m--,y--)if(h[m]!==f[y]){if(m!==1||y!==1)do if(m--,y--,0>y||h[m]!==f[y]){var x=`
`+h[m].replace(" at new "," at ");return e.displayName&&x.includes("<anonymous>")&&(x=x.replace("<anonymous>",e.displayName)),x}while(1<=m&&0<=y);break}}}finally{ZS=!1,Error.prepareStackTrace=s}return(e=e?e.displayName||e.name:"")?im(e):""}function UY(e){switch(e.tag){case 5:return im(e.type);case 16:return im("Lazy");case 13:return im("Suspense");case 19:return im("SuspenseList");case 0:case 2:case 15:return e=XS(e.type,!1),e;case 11:return e=XS(e.type.render,!1),e;case 1:return e=XS(e.type,!0),e;default:return""}}function pE(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Bd:return"Fragment";case Fd:return"Portal";case hE:return"Profiler";case gA:return"StrictMode";case dE:return"Suspense";case fE:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case DB:return(e.displayName||"Context")+".Consumer";case kB:return(e._context.displayName||"Context")+".Provider";case _A:var r=e.render;return e=e.displayName,e||(e=r.displayName||r.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case yA:return r=e.displayName||null,r!==null?r:pE(e.type)||"Memo";case kc:r=e._payload,e=e._init;try{return pE(e(r))}catch{}}return null}function $Y(e){var r=e.type;switch(e.tag){case 24:return"Cache";case 9:return(r.displayName||"Context")+".Consumer";case 10:return(r._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=r.render,e=e.displayName||e.name||"",r.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return r;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return pE(r);case 8:return r===gA?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r}return null}function su(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function OB(e){var r=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function GY(e){var r=OB(e)?"checked":"value",s=Object.getOwnPropertyDescriptor(e.constructor.prototype,r),a=""+e[r];if(!e.hasOwnProperty(r)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var h=s.get,f=s.set;return Object.defineProperty(e,r,{configurable:!0,get:function(){return h.call(this)},set:function(m){a=""+m,f.call(this,m)}}),Object.defineProperty(e,r,{enumerable:s.enumerable}),{getValue:function(){return a},setValue:function(m){a=""+m},stopTracking:function(){e._valueTracker=null,delete e[r]}}}}function Xy(e){e._valueTracker||(e._valueTracker=GY(e))}function LB(e){if(!e)return!1;var r=e._valueTracker;if(!r)return!0;var s=r.getValue(),a="";return e&&(a=OB(e)?e.checked?"true":"false":e.value),e=a,e!==s?(r.setValue(e),!0):!1}function Sv(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function mE(e,r){var s=r.checked;return oi({},r,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:s??e._wrapperState.initialChecked})}function Mz(e,r){var s=r.defaultValue==null?"":r.defaultValue,a=r.checked!=null?r.checked:r.defaultChecked;s=su(r.value!=null?r.value:s),e._wrapperState={initialChecked:a,initialValue:s,controlled:r.type==="checkbox"||r.type==="radio"?r.checked!=null:r.value!=null}}function zB(e,r){r=r.checked,r!=null&&mA(e,"checked",r,!1)}function gE(e,r){zB(e,r);var s=su(r.value),a=r.type;if(s!=null)a==="number"?(s===0&&e.value===""||e.value!=s)&&(e.value=""+s):e.value!==""+s&&(e.value=""+s);else if(a==="submit"||a==="reset"){e.removeAttribute("value");return}r.hasOwnProperty("value")?_E(e,r.type,s):r.hasOwnProperty("defaultValue")&&_E(e,r.type,su(r.defaultValue)),r.checked==null&&r.defaultChecked!=null&&(e.defaultChecked=!!r.defaultChecked)}function Az(e,r,s){if(r.hasOwnProperty("value")||r.hasOwnProperty("defaultValue")){var a=r.type;if(!(a!=="submit"&&a!=="reset"||r.value!==void 0&&r.value!==null))return;r=""+e._wrapperState.initialValue,s||r===e.value||(e.value=r),e.defaultValue=r}s=e.name,s!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,s!==""&&(e.name=s)}function _E(e,r,s){(r!=="number"||Sv(e.ownerDocument)!==e)&&(s==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+s&&(e.defaultValue=""+s))}var sm=Array.isArray;function tf(e,r,s,a){if(e=e.options,r){r={};for(var h=0;h<s.length;h++)r["$"+s[h]]=!0;for(s=0;s<e.length;s++)h=r.hasOwnProperty("$"+e[s].value),e[s].selected!==h&&(e[s].selected=h),h&&a&&(e[s].defaultSelected=!0)}else{for(s=""+su(s),r=null,h=0;h<e.length;h++){if(e[h].value===s){e[h].selected=!0,a&&(e[h].defaultSelected=!0);return}r!==null||e[h].disabled||(r=e[h])}r!==null&&(r.selected=!0)}}function yE(e,r){if(r.dangerouslySetInnerHTML!=null)throw Error(Te(91));return oi({},r,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Cz(e,r){var s=r.value;if(s==null){if(s=r.children,r=r.defaultValue,s!=null){if(r!=null)throw Error(Te(92));if(sm(s)){if(1<s.length)throw Error(Te(93));s=s[0]}r=s}r==null&&(r=""),s=r}e._wrapperState={initialValue:su(s)}}function NB(e,r){var s=su(r.value),a=su(r.defaultValue);s!=null&&(s=""+s,s!==e.value&&(e.value=s),r.defaultValue==null&&e.defaultValue!==s&&(e.defaultValue=s)),a!=null&&(e.defaultValue=""+a)}function Pz(e){var r=e.textContent;r===e._wrapperState.initialValue&&r!==""&&r!==null&&(e.value=r)}function FB(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function vE(e,r){return e==null||e==="http://www.w3.org/1999/xhtml"?FB(r):e==="http://www.w3.org/2000/svg"&&r==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Yy,BB=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(r,s,a,h){MSApp.execUnsafeLocalFunction(function(){return e(r,s,a,h)})}:e}(function(e,r){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=r;else{for(Yy=Yy||document.createElement("div"),Yy.innerHTML="<svg>"+r.valueOf().toString()+"</svg>",r=Yy.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;r.firstChild;)e.appendChild(r.firstChild)}});function Fm(e,r){if(r){var s=e.firstChild;if(s&&s===e.lastChild&&s.nodeType===3){s.nodeValue=r;return}}e.textContent=r}var _m={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},WY=["Webkit","ms","Moz","O"];Object.keys(_m).forEach(function(e){WY.forEach(function(r){r=r+e.charAt(0).toUpperCase()+e.substring(1),_m[r]=_m[e]})});function jB(e,r,s){return r==null||typeof r=="boolean"||r===""?"":s||typeof r!="number"||r===0||_m.hasOwnProperty(e)&&_m[e]?(""+r).trim():r+"px"}function VB(e,r){e=e.style;for(var s in r)if(r.hasOwnProperty(s)){var a=s.indexOf("--")===0,h=jB(s,r[s],a);s==="float"&&(s="cssFloat"),a?e.setProperty(s,h):e[s]=h}}var HY=oi({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function xE(e,r){if(r){if(HY[e]&&(r.children!=null||r.dangerouslySetInnerHTML!=null))throw Error(Te(137,e));if(r.dangerouslySetInnerHTML!=null){if(r.children!=null)throw Error(Te(60));if(typeof r.dangerouslySetInnerHTML!="object"||!("__html"in r.dangerouslySetInnerHTML))throw Error(Te(61))}if(r.style!=null&&typeof r.style!="object")throw Error(Te(62))}}function bE(e,r){if(e.indexOf("-")===-1)return typeof r.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wE=null;function vA(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var SE=null,ef=null,nf=null;function Iz(e){if(e=Tg(e)){if(typeof SE!="function")throw Error(Te(280));var r=e.stateNode;r&&(r=Px(r),SE(e.stateNode,e.type,r))}}function UB(e){ef?nf?nf.push(e):nf=[e]:ef=e}function $B(){if(ef){var e=ef,r=nf;if(nf=ef=null,Iz(e),r)for(e=0;e<r.length;e++)Iz(r[e])}}function GB(e,r){return e(r)}function WB(){}var YS=!1;function HB(e,r,s){if(YS)return e(r,s);YS=!0;try{return GB(e,r,s)}finally{YS=!1,(ef!==null||nf!==null)&&(WB(),$B())}}function Bm(e,r){var s=e.stateNode;if(s===null)return null;var a=Px(s);if(a===null)return null;s=a[r];t:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(e=e.type,a=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!a;break t;default:e=!1}if(e)return null;if(s&&typeof s!="function")throw Error(Te(231,r,typeof s));return s}var TE=!1;if(zl)try{var Bp={};Object.defineProperty(Bp,"passive",{get:function(){TE=!0}}),window.addEventListener("test",Bp,Bp),window.removeEventListener("test",Bp,Bp)}catch{TE=!1}function qY(e,r,s,a,h,f,m,y,x){var w=Array.prototype.slice.call(arguments,3);try{r.apply(s,w)}catch(T){this.onError(T)}}var ym=!1,Tv=null,Ev=!1,EE=null,ZY={onError:function(e){ym=!0,Tv=e}};function XY(e,r,s,a,h,f,m,y,x){ym=!1,Tv=null,qY.apply(ZY,arguments)}function YY(e,r,s,a,h,f,m,y,x){if(XY.apply(this,arguments),ym){if(ym){var w=Tv;ym=!1,Tv=null}else throw Error(Te(198));Ev||(Ev=!0,EE=w)}}function kh(e){var r=e,s=e;if(e.alternate)for(;r.return;)r=r.return;else{e=r;do r=e,r.flags&4098&&(s=r.return),e=r.return;while(e)}return r.tag===3?s:null}function qB(e){if(e.tag===13){var r=e.memoizedState;if(r===null&&(e=e.alternate,e!==null&&(r=e.memoizedState)),r!==null)return r.dehydrated}return null}function kz(e){if(kh(e)!==e)throw Error(Te(188))}function KY(e){var r=e.alternate;if(!r){if(r=kh(e),r===null)throw Error(Te(188));return r!==e?null:e}for(var s=e,a=r;;){var h=s.return;if(h===null)break;var f=h.alternate;if(f===null){if(a=h.return,a!==null){s=a;continue}break}if(h.child===f.child){for(f=h.child;f;){if(f===s)return kz(h),e;if(f===a)return kz(h),r;f=f.sibling}throw Error(Te(188))}if(s.return!==a.return)s=h,a=f;else{for(var m=!1,y=h.child;y;){if(y===s){m=!0,s=h,a=f;break}if(y===a){m=!0,a=h,s=f;break}y=y.sibling}if(!m){for(y=f.child;y;){if(y===s){m=!0,s=f,a=h;break}if(y===a){m=!0,a=f,s=h;break}y=y.sibling}if(!m)throw Error(Te(189))}}if(s.alternate!==a)throw Error(Te(190))}if(s.tag!==3)throw Error(Te(188));return s.stateNode.current===s?e:r}function ZB(e){return e=KY(e),e!==null?XB(e):null}function XB(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var r=XB(e);if(r!==null)return r;e=e.sibling}return null}var YB=fo.unstable_scheduleCallback,Dz=fo.unstable_cancelCallback,JY=fo.unstable_shouldYield,QY=fo.unstable_requestPaint,wi=fo.unstable_now,tK=fo.unstable_getCurrentPriorityLevel,xA=fo.unstable_ImmediatePriority,KB=fo.unstable_UserBlockingPriority,Mv=fo.unstable_NormalPriority,eK=fo.unstable_LowPriority,JB=fo.unstable_IdlePriority,Ex=null,$a=null;function nK(e){if($a&&typeof $a.onCommitFiberRoot=="function")try{$a.onCommitFiberRoot(Ex,e,void 0,(e.current.flags&128)===128)}catch{}}var da=Math.clz32?Math.clz32:sK,rK=Math.log,iK=Math.LN2;function sK(e){return e>>>=0,e===0?32:31-(rK(e)/iK|0)|0}var Ky=64,Jy=4194304;function om(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Av(e,r){var s=e.pendingLanes;if(s===0)return 0;var a=0,h=e.suspendedLanes,f=e.pingedLanes,m=s&268435455;if(m!==0){var y=m&~h;y!==0?a=om(y):(f&=m,f!==0&&(a=om(f)))}else m=s&~h,m!==0?a=om(m):f!==0&&(a=om(f));if(a===0)return 0;if(r!==0&&r!==a&&!(r&h)&&(h=a&-a,f=r&-r,h>=f||h===16&&(f&4194240)!==0))return r;if(a&4&&(a|=s&16),r=e.entangledLanes,r!==0)for(e=e.entanglements,r&=a;0<r;)s=31-da(r),h=1<<s,a|=e[s],r&=~h;return a}function oK(e,r){switch(e){case 1:case 2:case 4:return r+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function aK(e,r){for(var s=e.suspendedLanes,a=e.pingedLanes,h=e.expirationTimes,f=e.pendingLanes;0<f;){var m=31-da(f),y=1<<m,x=h[m];x===-1?(!(y&s)||y&a)&&(h[m]=oK(y,r)):x<=r&&(e.expiredLanes|=y),f&=~y}}function ME(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function QB(){var e=Ky;return Ky<<=1,!(Ky&4194240)&&(Ky=64),e}function KS(e){for(var r=[],s=0;31>s;s++)r.push(e);return r}function wg(e,r,s){e.pendingLanes|=r,r!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,r=31-da(r),e[r]=s}function lK(e,r){var s=e.pendingLanes&~r;e.pendingLanes=r,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=r,e.mutableReadLanes&=r,e.entangledLanes&=r,r=e.entanglements;var a=e.eventTimes;for(e=e.expirationTimes;0<s;){var h=31-da(s),f=1<<h;r[h]=0,a[h]=-1,e[h]=-1,s&=~f}}function bA(e,r){var s=e.entangledLanes|=r;for(e=e.entanglements;s;){var a=31-da(s),h=1<<a;h&r|e[a]&r&&(e[a]|=r),s&=~h}}var br=0;function tj(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var ej,wA,nj,rj,ij,AE=!1,Qy=[],Hc=null,qc=null,Zc=null,jm=new Map,Vm=new Map,Oc=[],cK="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Rz(e,r){switch(e){case"focusin":case"focusout":Hc=null;break;case"dragenter":case"dragleave":qc=null;break;case"mouseover":case"mouseout":Zc=null;break;case"pointerover":case"pointerout":jm.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":Vm.delete(r.pointerId)}}function jp(e,r,s,a,h,f){return e===null||e.nativeEvent!==f?(e={blockedOn:r,domEventName:s,eventSystemFlags:a,nativeEvent:f,targetContainers:[h]},r!==null&&(r=Tg(r),r!==null&&wA(r)),e):(e.eventSystemFlags|=a,r=e.targetContainers,h!==null&&r.indexOf(h)===-1&&r.push(h),e)}function uK(e,r,s,a,h){switch(r){case"focusin":return Hc=jp(Hc,e,r,s,a,h),!0;case"dragenter":return qc=jp(qc,e,r,s,a,h),!0;case"mouseover":return Zc=jp(Zc,e,r,s,a,h),!0;case"pointerover":var f=h.pointerId;return jm.set(f,jp(jm.get(f)||null,e,r,s,a,h)),!0;case"gotpointercapture":return f=h.pointerId,Vm.set(f,jp(Vm.get(f)||null,e,r,s,a,h)),!0}return!1}function sj(e){var r=ah(e.target);if(r!==null){var s=kh(r);if(s!==null){if(r=s.tag,r===13){if(r=qB(s),r!==null){e.blockedOn=r,ij(e.priority,function(){nj(s)});return}}else if(r===3&&s.stateNode.current.memoizedState.isDehydrated){e.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}e.blockedOn=null}function G0(e){if(e.blockedOn!==null)return!1;for(var r=e.targetContainers;0<r.length;){var s=CE(e.domEventName,e.eventSystemFlags,r[0],e.nativeEvent);if(s===null){s=e.nativeEvent;var a=new s.constructor(s.type,s);wE=a,s.target.dispatchEvent(a),wE=null}else return r=Tg(s),r!==null&&wA(r),e.blockedOn=s,!1;r.shift()}return!0}function Oz(e,r,s){G0(e)&&s.delete(r)}function hK(){AE=!1,Hc!==null&&G0(Hc)&&(Hc=null),qc!==null&&G0(qc)&&(qc=null),Zc!==null&&G0(Zc)&&(Zc=null),jm.forEach(Oz),Vm.forEach(Oz)}function Vp(e,r){e.blockedOn===r&&(e.blockedOn=null,AE||(AE=!0,fo.unstable_scheduleCallback(fo.unstable_NormalPriority,hK)))}function Um(e){function r(h){return Vp(h,e)}if(0<Qy.length){Vp(Qy[0],e);for(var s=1;s<Qy.length;s++){var a=Qy[s];a.blockedOn===e&&(a.blockedOn=null)}}for(Hc!==null&&Vp(Hc,e),qc!==null&&Vp(qc,e),Zc!==null&&Vp(Zc,e),jm.forEach(r),Vm.forEach(r),s=0;s<Oc.length;s++)a=Oc[s],a.blockedOn===e&&(a.blockedOn=null);for(;0<Oc.length&&(s=Oc[0],s.blockedOn===null);)sj(s),s.blockedOn===null&&Oc.shift()}var rf=Ul.ReactCurrentBatchConfig,Cv=!0;function dK(e,r,s,a){var h=br,f=rf.transition;rf.transition=null;try{br=1,SA(e,r,s,a)}finally{br=h,rf.transition=f}}function fK(e,r,s,a){var h=br,f=rf.transition;rf.transition=null;try{br=4,SA(e,r,s,a)}finally{br=h,rf.transition=f}}function SA(e,r,s,a){if(Cv){var h=CE(e,r,s,a);if(h===null)aT(e,r,a,Pv,s),Rz(e,a);else if(uK(h,e,r,s,a))a.stopPropagation();else if(Rz(e,a),r&4&&-1<cK.indexOf(e)){for(;h!==null;){var f=Tg(h);if(f!==null&&ej(f),f=CE(e,r,s,a),f===null&&aT(e,r,a,Pv,s),f===h)break;h=f}h!==null&&a.stopPropagation()}else aT(e,r,a,null,s)}}var Pv=null;function CE(e,r,s,a){if(Pv=null,e=vA(a),e=ah(e),e!==null)if(r=kh(e),r===null)e=null;else if(s=r.tag,s===13){if(e=qB(r),e!==null)return e;e=null}else if(s===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;e=null}else r!==e&&(e=null);return Pv=e,null}function oj(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(tK()){case xA:return 1;case KB:return 4;case Mv:case eK:return 16;case JB:return 536870912;default:return 16}default:return 16}}var Nc=null,TA=null,W0=null;function aj(){if(W0)return W0;var e,r=TA,s=r.length,a,h="value"in Nc?Nc.value:Nc.textContent,f=h.length;for(e=0;e<s&&r[e]===h[e];e++);var m=s-e;for(a=1;a<=m&&r[s-a]===h[f-a];a++);return W0=h.slice(e,1<a?1-a:void 0)}function H0(e){var r=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&r===13&&(e=13)):e=r,e===10&&(e=13),32<=e||e===13?e:0}function t0(){return!0}function Lz(){return!1}function yo(e){function r(s,a,h,f,m){this._reactName=s,this._targetInst=h,this.type=a,this.nativeEvent=f,this.target=m,this.currentTarget=null;for(var y in e)e.hasOwnProperty(y)&&(s=e[y],this[y]=s?s(f):f[y]);return this.isDefaultPrevented=(f.defaultPrevented!=null?f.defaultPrevented:f.returnValue===!1)?t0:Lz,this.isPropagationStopped=Lz,this}return oi(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=t0)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=t0)},persist:function(){},isPersistent:t0}),r}var Tf={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},EA=yo(Tf),Sg=oi({},Tf,{view:0,detail:0}),pK=yo(Sg),JS,QS,Up,Mx=oi({},Sg,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:MA,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Up&&(Up&&e.type==="mousemove"?(JS=e.screenX-Up.screenX,QS=e.screenY-Up.screenY):QS=JS=0,Up=e),JS)},movementY:function(e){return"movementY"in e?e.movementY:QS}}),zz=yo(Mx),mK=oi({},Mx,{dataTransfer:0}),gK=yo(mK),_K=oi({},Sg,{relatedTarget:0}),tT=yo(_K),yK=oi({},Tf,{animationName:0,elapsedTime:0,pseudoElement:0}),vK=yo(yK),xK=oi({},Tf,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bK=yo(xK),wK=oi({},Tf,{data:0}),Nz=yo(wK),SK={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},TK={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},EK={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function MK(e){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(e):(e=EK[e])?!!r[e]:!1}function MA(){return MK}var AK=oi({},Sg,{key:function(e){if(e.key){var r=SK[e.key]||e.key;if(r!=="Unidentified")return r}return e.type==="keypress"?(e=H0(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?TK[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:MA,charCode:function(e){return e.type==="keypress"?H0(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?H0(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),CK=yo(AK),PK=oi({},Mx,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Fz=yo(PK),IK=oi({},Sg,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:MA}),kK=yo(IK),DK=oi({},Tf,{propertyName:0,elapsedTime:0,pseudoElement:0}),RK=yo(DK),OK=oi({},Mx,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),LK=yo(OK),zK=[9,13,27,32],AA=zl&&"CompositionEvent"in window,vm=null;zl&&"documentMode"in document&&(vm=document.documentMode);var NK=zl&&"TextEvent"in window&&!vm,lj=zl&&(!AA||vm&&8<vm&&11>=vm),Bz=" ",jz=!1;function cj(e,r){switch(e){case"keyup":return zK.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function uj(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var jd=!1;function FK(e,r){switch(e){case"compositionend":return uj(r);case"keypress":return r.which!==32?null:(jz=!0,Bz);case"textInput":return e=r.data,e===Bz&&jz?null:e;default:return null}}function BK(e,r){if(jd)return e==="compositionend"||!AA&&cj(e,r)?(e=aj(),W0=TA=Nc=null,jd=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return lj&&r.locale!=="ko"?null:r.data;default:return null}}var jK={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vz(e){var r=e&&e.nodeName&&e.nodeName.toLowerCase();return r==="input"?!!jK[e.type]:r==="textarea"}function hj(e,r,s,a){UB(a),r=Iv(r,"onChange"),0<r.length&&(s=new EA("onChange","change",null,s,a),e.push({event:s,listeners:r}))}var xm=null,$m=null;function VK(e){wj(e,0)}function Ax(e){var r=$d(e);if(LB(r))return e}function UK(e,r){if(e==="change")return r}var dj=!1;if(zl){var eT;if(zl){var nT="oninput"in document;if(!nT){var Uz=document.createElement("div");Uz.setAttribute("oninput","return;"),nT=typeof Uz.oninput=="function"}eT=nT}else eT=!1;dj=eT&&(!document.documentMode||9<document.documentMode)}function $z(){xm&&(xm.detachEvent("onpropertychange",fj),$m=xm=null)}function fj(e){if(e.propertyName==="value"&&Ax($m)){var r=[];hj(r,$m,e,vA(e)),HB(VK,r)}}function $K(e,r,s){e==="focusin"?($z(),xm=r,$m=s,xm.attachEvent("onpropertychange",fj)):e==="focusout"&&$z()}function GK(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Ax($m)}function WK(e,r){if(e==="click")return Ax(r)}function HK(e,r){if(e==="input"||e==="change")return Ax(r)}function qK(e,r){return e===r&&(e!==0||1/e===1/r)||e!==e&&r!==r}var ga=typeof Object.is=="function"?Object.is:qK;function Gm(e,r){if(ga(e,r))return!0;if(typeof e!="object"||e===null||typeof r!="object"||r===null)return!1;var s=Object.keys(e),a=Object.keys(r);if(s.length!==a.length)return!1;for(a=0;a<s.length;a++){var h=s[a];if(!uE.call(r,h)||!ga(e[h],r[h]))return!1}return!0}function Gz(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Wz(e,r){var s=Gz(e);e=0;for(var a;s;){if(s.nodeType===3){if(a=e+s.textContent.length,e<=r&&a>=r)return{node:s,offset:r-e};e=a}t:{for(;s;){if(s.nextSibling){s=s.nextSibling;break t}s=s.parentNode}s=void 0}s=Gz(s)}}function pj(e,r){return e&&r?e===r?!0:e&&e.nodeType===3?!1:r&&r.nodeType===3?pj(e,r.parentNode):"contains"in e?e.contains(r):e.compareDocumentPosition?!!(e.compareDocumentPosition(r)&16):!1:!1}function mj(){for(var e=window,r=Sv();r instanceof e.HTMLIFrameElement;){try{var s=typeof r.contentWindow.location.href=="string"}catch{s=!1}if(s)e=r.contentWindow;else break;r=Sv(e.document)}return r}function CA(e){var r=e&&e.nodeName&&e.nodeName.toLowerCase();return r&&(r==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||r==="textarea"||e.contentEditable==="true")}function ZK(e){var r=mj(),s=e.focusedElem,a=e.selectionRange;if(r!==s&&s&&s.ownerDocument&&pj(s.ownerDocument.documentElement,s)){if(a!==null&&CA(s)){if(r=a.start,e=a.end,e===void 0&&(e=r),"selectionStart"in s)s.selectionStart=r,s.selectionEnd=Math.min(e,s.value.length);else if(e=(r=s.ownerDocument||document)&&r.defaultView||window,e.getSelection){e=e.getSelection();var h=s.textContent.length,f=Math.min(a.start,h);a=a.end===void 0?f:Math.min(a.end,h),!e.extend&&f>a&&(h=a,a=f,f=h),h=Wz(s,f);var m=Wz(s,a);h&&m&&(e.rangeCount!==1||e.anchorNode!==h.node||e.anchorOffset!==h.offset||e.focusNode!==m.node||e.focusOffset!==m.offset)&&(r=r.createRange(),r.setStart(h.node,h.offset),e.removeAllRanges(),f>a?(e.addRange(r),e.extend(m.node,m.offset)):(r.setEnd(m.node,m.offset),e.addRange(r)))}}for(r=[],e=s;e=e.parentNode;)e.nodeType===1&&r.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<r.length;s++)e=r[s],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var XK=zl&&"documentMode"in document&&11>=document.documentMode,Vd=null,PE=null,bm=null,IE=!1;function Hz(e,r,s){var a=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;IE||Vd==null||Vd!==Sv(a)||(a=Vd,"selectionStart"in a&&CA(a)?a={start:a.selectionStart,end:a.selectionEnd}:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection(),a={anchorNode:a.anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset}),bm&&Gm(bm,a)||(bm=a,a=Iv(PE,"onSelect"),0<a.length&&(r=new EA("onSelect","select",null,r,s),e.push({event:r,listeners:a}),r.target=Vd)))}function e0(e,r){var s={};return s[e.toLowerCase()]=r.toLowerCase(),s["Webkit"+e]="webkit"+r,s["Moz"+e]="moz"+r,s}var Ud={animationend:e0("Animation","AnimationEnd"),animationiteration:e0("Animation","AnimationIteration"),animationstart:e0("Animation","AnimationStart"),transitionend:e0("Transition","TransitionEnd")},rT={},gj={};zl&&(gj=document.createElement("div").style,"AnimationEvent"in window||(delete Ud.animationend.animation,delete Ud.animationiteration.animation,delete Ud.animationstart.animation),"TransitionEvent"in window||delete Ud.transitionend.transition);function Cx(e){if(rT[e])return rT[e];if(!Ud[e])return e;var r=Ud[e],s;for(s in r)if(r.hasOwnProperty(s)&&s in gj)return rT[e]=r[s];return e}var _j=Cx("animationend"),yj=Cx("animationiteration"),vj=Cx("animationstart"),xj=Cx("transitionend"),bj=new Map,qz="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function pu(e,r){bj.set(e,r),Ih(r,[e])}for(var iT=0;iT<qz.length;iT++){var sT=qz[iT],YK=sT.toLowerCase(),KK=sT[0].toUpperCase()+sT.slice(1);pu(YK,"on"+KK)}pu(_j,"onAnimationEnd");pu(yj,"onAnimationIteration");pu(vj,"onAnimationStart");pu("dblclick","onDoubleClick");pu("focusin","onFocus");pu("focusout","onBlur");pu(xj,"onTransitionEnd");lf("onMouseEnter",["mouseout","mouseover"]);lf("onMouseLeave",["mouseout","mouseover"]);lf("onPointerEnter",["pointerout","pointerover"]);lf("onPointerLeave",["pointerout","pointerover"]);Ih("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ih("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ih("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ih("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ih("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ih("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var am="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),JK=new Set("cancel close invalid load scroll toggle".split(" ").concat(am));function Zz(e,r,s){var a=e.type||"unknown-event";e.currentTarget=s,YY(a,r,void 0,e),e.currentTarget=null}function wj(e,r){r=(r&4)!==0;for(var s=0;s<e.length;s++){var a=e[s],h=a.event;a=a.listeners;t:{var f=void 0;if(r)for(var m=a.length-1;0<=m;m--){var y=a[m],x=y.instance,w=y.currentTarget;if(y=y.listener,x!==f&&h.isPropagationStopped())break t;Zz(h,y,w),f=x}else for(m=0;m<a.length;m++){if(y=a[m],x=y.instance,w=y.currentTarget,y=y.listener,x!==f&&h.isPropagationStopped())break t;Zz(h,y,w),f=x}}}if(Ev)throw e=EE,Ev=!1,EE=null,e}function Br(e,r){var s=r[LE];s===void 0&&(s=r[LE]=new Set);var a=e+"__bubble";s.has(a)||(Sj(r,e,2,!1),s.add(a))}function oT(e,r,s){var a=0;r&&(a|=4),Sj(s,e,a,r)}var n0="_reactListening"+Math.random().toString(36).slice(2);function Wm(e){if(!e[n0]){e[n0]=!0,IB.forEach(function(s){s!=="selectionchange"&&(JK.has(s)||oT(s,!1,e),oT(s,!0,e))});var r=e.nodeType===9?e:e.ownerDocument;r===null||r[n0]||(r[n0]=!0,oT("selectionchange",!1,r))}}function Sj(e,r,s,a){switch(oj(r)){case 1:var h=dK;break;case 4:h=fK;break;default:h=SA}s=h.bind(null,r,s,e),h=void 0,!TE||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(h=!0),a?h!==void 0?e.addEventListener(r,s,{capture:!0,passive:h}):e.addEventListener(r,s,!0):h!==void 0?e.addEventListener(r,s,{passive:h}):e.addEventListener(r,s,!1)}function aT(e,r,s,a,h){var f=a;if(!(r&1)&&!(r&2)&&a!==null)t:for(;;){if(a===null)return;var m=a.tag;if(m===3||m===4){var y=a.stateNode.containerInfo;if(y===h||y.nodeType===8&&y.parentNode===h)break;if(m===4)for(m=a.return;m!==null;){var x=m.tag;if((x===3||x===4)&&(x=m.stateNode.containerInfo,x===h||x.nodeType===8&&x.parentNode===h))return;m=m.return}for(;y!==null;){if(m=ah(y),m===null)return;if(x=m.tag,x===5||x===6){a=f=m;continue t}y=y.parentNode}}a=a.return}HB(function(){var w=f,T=vA(s),M=[];t:{var I=bj.get(e);if(I!==void 0){var R=EA,O=e;switch(e){case"keypress":if(H0(s)===0)break t;case"keydown":case"keyup":R=CK;break;case"focusin":O="focus",R=tT;break;case"focusout":O="blur",R=tT;break;case"beforeblur":case"afterblur":R=tT;break;case"click":if(s.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":R=zz;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":R=gK;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":R=kK;break;case _j:case yj:case vj:R=vK;break;case xj:R=RK;break;case"scroll":R=pK;break;case"wheel":R=LK;break;case"copy":case"cut":case"paste":R=bK;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":R=Fz}var N=(r&4)!==0,G=!N&&e==="scroll",$=N?I!==null?I+"Capture":null:I;N=[];for(var z=w,B;z!==null;){B=z;var H=B.stateNode;if(B.tag===5&&H!==null&&(B=H,$!==null&&(H=Bm(z,$),H!=null&&N.push(Hm(z,H,B)))),G)break;z=z.return}0<N.length&&(I=new R(I,O,null,s,T),M.push({event:I,listeners:N}))}}if(!(r&7)){t:{if(I=e==="mouseover"||e==="pointerover",R=e==="mouseout"||e==="pointerout",I&&s!==wE&&(O=s.relatedTarget||s.fromElement)&&(ah(O)||O[Nl]))break t;if((R||I)&&(I=T.window===T?T:(I=T.ownerDocument)?I.defaultView||I.parentWindow:window,R?(O=s.relatedTarget||s.toElement,R=w,O=O?ah(O):null,O!==null&&(G=kh(O),O!==G||O.tag!==5&&O.tag!==6)&&(O=null)):(R=null,O=w),R!==O)){if(N=zz,H="onMouseLeave",$="onMouseEnter",z="mouse",(e==="pointerout"||e==="pointerover")&&(N=Fz,H="onPointerLeave",$="onPointerEnter",z="pointer"),G=R==null?I:$d(R),B=O==null?I:$d(O),I=new N(H,z+"leave",R,s,T),I.target=G,I.relatedTarget=B,H=null,ah(T)===w&&(N=new N($,z+"enter",O,s,T),N.target=B,N.relatedTarget=G,H=N),G=H,R&&O)e:{for(N=R,$=O,z=0,B=N;B;B=Rd(B))z++;for(B=0,H=$;H;H=Rd(H))B++;for(;0<z-B;)N=Rd(N),z--;for(;0<B-z;)$=Rd($),B--;for(;z--;){if(N===$||$!==null&&N===$.alternate)break e;N=Rd(N),$=Rd($)}N=null}else N=null;R!==null&&Xz(M,I,R,N,!1),O!==null&&G!==null&&Xz(M,G,O,N,!0)}}t:{if(I=w?$d(w):window,R=I.nodeName&&I.nodeName.toLowerCase(),R==="select"||R==="input"&&I.type==="file")var K=UK;else if(Vz(I))if(dj)K=HK;else{K=GK;var at=$K}else(R=I.nodeName)&&R.toLowerCase()==="input"&&(I.type==="checkbox"||I.type==="radio")&&(K=WK);if(K&&(K=K(e,w))){hj(M,K,s,T);break t}at&&at(e,I,w),e==="focusout"&&(at=I._wrapperState)&&at.controlled&&I.type==="number"&&_E(I,"number",I.value)}switch(at=w?$d(w):window,e){case"focusin":(Vz(at)||at.contentEditable==="true")&&(Vd=at,PE=w,bm=null);break;case"focusout":bm=PE=Vd=null;break;case"mousedown":IE=!0;break;case"contextmenu":case"mouseup":case"dragend":IE=!1,Hz(M,s,T);break;case"selectionchange":if(XK)break;case"keydown":case"keyup":Hz(M,s,T)}var ft;if(AA)t:{switch(e){case"compositionstart":var et="onCompositionStart";break t;case"compositionend":et="onCompositionEnd";break t;case"compositionupdate":et="onCompositionUpdate";break t}et=void 0}else jd?cj(e,s)&&(et="onCompositionEnd"):e==="keydown"&&s.keyCode===229&&(et="onCompositionStart");et&&(lj&&s.locale!=="ko"&&(jd||et!=="onCompositionStart"?et==="onCompositionEnd"&&jd&&(ft=aj()):(Nc=T,TA="value"in Nc?Nc.value:Nc.textContent,jd=!0)),at=Iv(w,et),0<at.length&&(et=new Nz(et,e,null,s,T),M.push({event:et,listeners:at}),ft?et.data=ft:(ft=uj(s),ft!==null&&(et.data=ft)))),(ft=NK?FK(e,s):BK(e,s))&&(w=Iv(w,"onBeforeInput"),0<w.length&&(T=new Nz("onBeforeInput","beforeinput",null,s,T),M.push({event:T,listeners:w}),T.data=ft))}wj(M,r)})}function Hm(e,r,s){return{instance:e,listener:r,currentTarget:s}}function Iv(e,r){for(var s=r+"Capture",a=[];e!==null;){var h=e,f=h.stateNode;h.tag===5&&f!==null&&(h=f,f=Bm(e,s),f!=null&&a.unshift(Hm(e,f,h)),f=Bm(e,r),f!=null&&a.push(Hm(e,f,h))),e=e.return}return a}function Rd(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Xz(e,r,s,a,h){for(var f=r._reactName,m=[];s!==null&&s!==a;){var y=s,x=y.alternate,w=y.stateNode;if(x!==null&&x===a)break;y.tag===5&&w!==null&&(y=w,h?(x=Bm(s,f),x!=null&&m.unshift(Hm(s,x,y))):h||(x=Bm(s,f),x!=null&&m.push(Hm(s,x,y)))),s=s.return}m.length!==0&&e.push({event:r,listeners:m})}var QK=/\r\n?/g,tJ=/\u0000|\uFFFD/g;function Yz(e){return(typeof e=="string"?e:""+e).replace(QK,`
`).replace(tJ,"")}function r0(e,r,s){if(r=Yz(r),Yz(e)!==r&&s)throw Error(Te(425))}function kv(){}var kE=null,DE=null;function RE(e,r){return e==="textarea"||e==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var OE=typeof setTimeout=="function"?setTimeout:void 0,eJ=typeof clearTimeout=="function"?clearTimeout:void 0,Kz=typeof Promise=="function"?Promise:void 0,nJ=typeof queueMicrotask=="function"?queueMicrotask:typeof Kz<"u"?function(e){return Kz.resolve(null).then(e).catch(rJ)}:OE;function rJ(e){setTimeout(function(){throw e})}function lT(e,r){var s=r,a=0;do{var h=s.nextSibling;if(e.removeChild(s),h&&h.nodeType===8)if(s=h.data,s==="/$"){if(a===0){e.removeChild(h),Um(r);return}a--}else s!=="$"&&s!=="$?"&&s!=="$!"||a++;s=h}while(s);Um(r)}function Xc(e){for(;e!=null;e=e.nextSibling){var r=e.nodeType;if(r===1||r===3)break;if(r===8){if(r=e.data,r==="$"||r==="$!"||r==="$?")break;if(r==="/$")return null}}return e}function Jz(e){e=e.previousSibling;for(var r=0;e;){if(e.nodeType===8){var s=e.data;if(s==="$"||s==="$!"||s==="$?"){if(r===0)return e;r--}else s==="/$"&&r++}e=e.previousSibling}return null}var Ef=Math.random().toString(36).slice(2),Va="__reactFiber$"+Ef,qm="__reactProps$"+Ef,Nl="__reactContainer$"+Ef,LE="__reactEvents$"+Ef,iJ="__reactListeners$"+Ef,sJ="__reactHandles$"+Ef;function ah(e){var r=e[Va];if(r)return r;for(var s=e.parentNode;s;){if(r=s[Nl]||s[Va]){if(s=r.alternate,r.child!==null||s!==null&&s.child!==null)for(e=Jz(e);e!==null;){if(s=e[Va])return s;e=Jz(e)}return r}e=s,s=e.parentNode}return null}function Tg(e){return e=e[Va]||e[Nl],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function $d(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Te(33))}function Px(e){return e[qm]||null}var zE=[],Gd=-1;function mu(e){return{current:e}}function Vr(e){0>Gd||(e.current=zE[Gd],zE[Gd]=null,Gd--)}function zr(e,r){Gd++,zE[Gd]=e.current,e.current=r}var ou={},fs=mu(ou),Gs=mu(!1),bh=ou;function cf(e,r){var s=e.type.contextTypes;if(!s)return ou;var a=e.stateNode;if(a&&a.__reactInternalMemoizedUnmaskedChildContext===r)return a.__reactInternalMemoizedMaskedChildContext;var h={},f;for(f in s)h[f]=r[f];return a&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=h),h}function Ws(e){return e=e.childContextTypes,e!=null}function Dv(){Vr(Gs),Vr(fs)}function Qz(e,r,s){if(fs.current!==ou)throw Error(Te(168));zr(fs,r),zr(Gs,s)}function Tj(e,r,s){var a=e.stateNode;if(r=r.childContextTypes,typeof a.getChildContext!="function")return s;a=a.getChildContext();for(var h in a)if(!(h in r))throw Error(Te(108,$Y(e)||"Unknown",h));return oi({},s,a)}function Rv(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ou,bh=fs.current,zr(fs,e),zr(Gs,Gs.current),!0}function t5(e,r,s){var a=e.stateNode;if(!a)throw Error(Te(169));s?(e=Tj(e,r,bh),a.__reactInternalMemoizedMergedChildContext=e,Vr(Gs),Vr(fs),zr(fs,e)):Vr(Gs),zr(Gs,s)}var Sl=null,Ix=!1,cT=!1;function Ej(e){Sl===null?Sl=[e]:Sl.push(e)}function oJ(e){Ix=!0,Ej(e)}function gu(){if(!cT&&Sl!==null){cT=!0;var e=0,r=br;try{var s=Sl;for(br=1;e<s.length;e++){var a=s[e];do a=a(!0);while(a!==null)}Sl=null,Ix=!1}catch(h){throw Sl!==null&&(Sl=Sl.slice(e+1)),YB(xA,gu),h}finally{br=r,cT=!1}}return null}var Wd=[],Hd=0,Ov=null,Lv=0,Oo=[],Lo=0,wh=null,El=1,Ml="";function th(e,r){Wd[Hd++]=Lv,Wd[Hd++]=Ov,Ov=e,Lv=r}function Mj(e,r,s){Oo[Lo++]=El,Oo[Lo++]=Ml,Oo[Lo++]=wh,wh=e;var a=El;e=Ml;var h=32-da(a)-1;a&=~(1<<h),s+=1;var f=32-da(r)+h;if(30<f){var m=h-h%5;f=(a&(1<<m)-1).toString(32),a>>=m,h-=m,El=1<<32-da(r)+h|s<<h|a,Ml=f+e}else El=1<<f|s<<h|a,Ml=e}function PA(e){e.return!==null&&(th(e,1),Mj(e,1,0))}function IA(e){for(;e===Ov;)Ov=Wd[--Hd],Wd[Hd]=null,Lv=Wd[--Hd],Wd[Hd]=null;for(;e===wh;)wh=Oo[--Lo],Oo[Lo]=null,Ml=Oo[--Lo],Oo[Lo]=null,El=Oo[--Lo],Oo[Lo]=null}var ho=null,ao=null,Xr=!1,aa=null;function Aj(e,r){var s=No(5,null,null,0);s.elementType="DELETED",s.stateNode=r,s.return=e,r=e.deletions,r===null?(e.deletions=[s],e.flags|=16):r.push(s)}function e5(e,r){switch(e.tag){case 5:var s=e.type;return r=r.nodeType!==1||s.toLowerCase()!==r.nodeName.toLowerCase()?null:r,r!==null?(e.stateNode=r,ho=e,ao=Xc(r.firstChild),!0):!1;case 6:return r=e.pendingProps===""||r.nodeType!==3?null:r,r!==null?(e.stateNode=r,ho=e,ao=null,!0):!1;case 13:return r=r.nodeType!==8?null:r,r!==null?(s=wh!==null?{id:El,overflow:Ml}:null,e.memoizedState={dehydrated:r,treeContext:s,retryLane:1073741824},s=No(18,null,null,0),s.stateNode=r,s.return=e,e.child=s,ho=e,ao=null,!0):!1;default:return!1}}function NE(e){return(e.mode&1)!==0&&(e.flags&128)===0}function FE(e){if(Xr){var r=ao;if(r){var s=r;if(!e5(e,r)){if(NE(e))throw Error(Te(418));r=Xc(s.nextSibling);var a=ho;r&&e5(e,r)?Aj(a,s):(e.flags=e.flags&-4097|2,Xr=!1,ho=e)}}else{if(NE(e))throw Error(Te(418));e.flags=e.flags&-4097|2,Xr=!1,ho=e}}}function n5(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;ho=e}function i0(e){if(e!==ho)return!1;if(!Xr)return n5(e),Xr=!0,!1;var r;if((r=e.tag!==3)&&!(r=e.tag!==5)&&(r=e.type,r=r!=="head"&&r!=="body"&&!RE(e.type,e.memoizedProps)),r&&(r=ao)){if(NE(e))throw Cj(),Error(Te(418));for(;r;)Aj(e,r),r=Xc(r.nextSibling)}if(n5(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Te(317));t:{for(e=e.nextSibling,r=0;e;){if(e.nodeType===8){var s=e.data;if(s==="/$"){if(r===0){ao=Xc(e.nextSibling);break t}r--}else s!=="$"&&s!=="$!"&&s!=="$?"||r++}e=e.nextSibling}ao=null}}else ao=ho?Xc(e.stateNode.nextSibling):null;return!0}function Cj(){for(var e=ao;e;)e=Xc(e.nextSibling)}function uf(){ao=ho=null,Xr=!1}function kA(e){aa===null?aa=[e]:aa.push(e)}var aJ=Ul.ReactCurrentBatchConfig;function ia(e,r){if(e&&e.defaultProps){r=oi({},r),e=e.defaultProps;for(var s in e)r[s]===void 0&&(r[s]=e[s]);return r}return r}var zv=mu(null),Nv=null,qd=null,DA=null;function RA(){DA=qd=Nv=null}function OA(e){var r=zv.current;Vr(zv),e._currentValue=r}function BE(e,r,s){for(;e!==null;){var a=e.alternate;if((e.childLanes&r)!==r?(e.childLanes|=r,a!==null&&(a.childLanes|=r)):a!==null&&(a.childLanes&r)!==r&&(a.childLanes|=r),e===s)break;e=e.return}}function sf(e,r){Nv=e,DA=qd=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&r&&($s=!0),e.firstContext=null)}function Vo(e){var r=e._currentValue;if(DA!==e)if(e={context:e,memoizedValue:r,next:null},qd===null){if(Nv===null)throw Error(Te(308));qd=e,Nv.dependencies={lanes:0,firstContext:e}}else qd=qd.next=e;return r}var lh=null;function LA(e){lh===null?lh=[e]:lh.push(e)}function Pj(e,r,s,a){var h=r.interleaved;return h===null?(s.next=s,LA(r)):(s.next=h.next,h.next=s),r.interleaved=s,Fl(e,a)}function Fl(e,r){e.lanes|=r;var s=e.alternate;for(s!==null&&(s.lanes|=r),s=e,e=e.return;e!==null;)e.childLanes|=r,s=e.alternate,s!==null&&(s.childLanes|=r),s=e,e=e.return;return s.tag===3?s.stateNode:null}var Dc=!1;function zA(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ij(e,r){e=e.updateQueue,r.updateQueue===e&&(r.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function kl(e,r){return{eventTime:e,lane:r,tag:0,payload:null,callback:null,next:null}}function Yc(e,r,s){var a=e.updateQueue;if(a===null)return null;if(a=a.shared,ir&2){var h=a.pending;return h===null?r.next=r:(r.next=h.next,h.next=r),a.pending=r,Fl(e,s)}return h=a.interleaved,h===null?(r.next=r,LA(a)):(r.next=h.next,h.next=r),a.interleaved=r,Fl(e,s)}function q0(e,r,s){if(r=r.updateQueue,r!==null&&(r=r.shared,(s&4194240)!==0)){var a=r.lanes;a&=e.pendingLanes,s|=a,r.lanes=s,bA(e,s)}}function r5(e,r){var s=e.updateQueue,a=e.alternate;if(a!==null&&(a=a.updateQueue,s===a)){var h=null,f=null;if(s=s.firstBaseUpdate,s!==null){do{var m={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};f===null?h=f=m:f=f.next=m,s=s.next}while(s!==null);f===null?h=f=r:f=f.next=r}else h=f=r;s={baseState:a.baseState,firstBaseUpdate:h,lastBaseUpdate:f,shared:a.shared,effects:a.effects},e.updateQueue=s;return}e=s.lastBaseUpdate,e===null?s.firstBaseUpdate=r:e.next=r,s.lastBaseUpdate=r}function Fv(e,r,s,a){var h=e.updateQueue;Dc=!1;var f=h.firstBaseUpdate,m=h.lastBaseUpdate,y=h.shared.pending;if(y!==null){h.shared.pending=null;var x=y,w=x.next;x.next=null,m===null?f=w:m.next=w,m=x;var T=e.alternate;T!==null&&(T=T.updateQueue,y=T.lastBaseUpdate,y!==m&&(y===null?T.firstBaseUpdate=w:y.next=w,T.lastBaseUpdate=x))}if(f!==null){var M=h.baseState;m=0,T=w=x=null,y=f;do{var I=y.lane,R=y.eventTime;if((a&I)===I){T!==null&&(T=T.next={eventTime:R,lane:0,tag:y.tag,payload:y.payload,callback:y.callback,next:null});t:{var O=e,N=y;switch(I=r,R=s,N.tag){case 1:if(O=N.payload,typeof O=="function"){M=O.call(R,M,I);break t}M=O;break t;case 3:O.flags=O.flags&-65537|128;case 0:if(O=N.payload,I=typeof O=="function"?O.call(R,M,I):O,I==null)break t;M=oi({},M,I);break t;case 2:Dc=!0}}y.callback!==null&&y.lane!==0&&(e.flags|=64,I=h.effects,I===null?h.effects=[y]:I.push(y))}else R={eventTime:R,lane:I,tag:y.tag,payload:y.payload,callback:y.callback,next:null},T===null?(w=T=R,x=M):T=T.next=R,m|=I;if(y=y.next,y===null){if(y=h.shared.pending,y===null)break;I=y,y=I.next,I.next=null,h.lastBaseUpdate=I,h.shared.pending=null}}while(!0);if(T===null&&(x=M),h.baseState=x,h.firstBaseUpdate=w,h.lastBaseUpdate=T,r=h.shared.interleaved,r!==null){h=r;do m|=h.lane,h=h.next;while(h!==r)}else f===null&&(h.shared.lanes=0);Th|=m,e.lanes=m,e.memoizedState=M}}function i5(e,r,s){if(e=r.effects,r.effects=null,e!==null)for(r=0;r<e.length;r++){var a=e[r],h=a.callback;if(h!==null){if(a.callback=null,a=s,typeof h!="function")throw Error(Te(191,h));h.call(a)}}}var kj=new PB.Component().refs;function jE(e,r,s,a){r=e.memoizedState,s=s(a,r),s=s==null?r:oi({},r,s),e.memoizedState=s,e.lanes===0&&(e.updateQueue.baseState=s)}var kx={isMounted:function(e){return(e=e._reactInternals)?kh(e)===e:!1},enqueueSetState:function(e,r,s){e=e._reactInternals;var a=Ms(),h=Jc(e),f=kl(a,h);f.payload=r,s!=null&&(f.callback=s),r=Yc(e,f,h),r!==null&&(fa(r,e,h,a),q0(r,e,h))},enqueueReplaceState:function(e,r,s){e=e._reactInternals;var a=Ms(),h=Jc(e),f=kl(a,h);f.tag=1,f.payload=r,s!=null&&(f.callback=s),r=Yc(e,f,h),r!==null&&(fa(r,e,h,a),q0(r,e,h))},enqueueForceUpdate:function(e,r){e=e._reactInternals;var s=Ms(),a=Jc(e),h=kl(s,a);h.tag=2,r!=null&&(h.callback=r),r=Yc(e,h,a),r!==null&&(fa(r,e,a,s),q0(r,e,a))}};function s5(e,r,s,a,h,f,m){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(a,f,m):r.prototype&&r.prototype.isPureReactComponent?!Gm(s,a)||!Gm(h,f):!0}function Dj(e,r,s){var a=!1,h=ou,f=r.contextType;return typeof f=="object"&&f!==null?f=Vo(f):(h=Ws(r)?bh:fs.current,a=r.contextTypes,f=(a=a!=null)?cf(e,h):ou),r=new r(s,f),e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,r.updater=kx,e.stateNode=r,r._reactInternals=e,a&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=h,e.__reactInternalMemoizedMaskedChildContext=f),r}function o5(e,r,s,a){e=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(s,a),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(s,a),r.state!==e&&kx.enqueueReplaceState(r,r.state,null)}function VE(e,r,s,a){var h=e.stateNode;h.props=s,h.state=e.memoizedState,h.refs=kj,zA(e);var f=r.contextType;typeof f=="object"&&f!==null?h.context=Vo(f):(f=Ws(r)?bh:fs.current,h.context=cf(e,f)),h.state=e.memoizedState,f=r.getDerivedStateFromProps,typeof f=="function"&&(jE(e,r,f,s),h.state=e.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof h.getSnapshotBeforeUpdate=="function"||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(r=h.state,typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount(),r!==h.state&&kx.enqueueReplaceState(h,h.state,null),Fv(e,s,h,a),h.state=e.memoizedState),typeof h.componentDidMount=="function"&&(e.flags|=4194308)}function $p(e,r,s){if(e=s.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(s._owner){if(s=s._owner,s){if(s.tag!==1)throw Error(Te(309));var a=s.stateNode}if(!a)throw Error(Te(147,e));var h=a,f=""+e;return r!==null&&r.ref!==null&&typeof r.ref=="function"&&r.ref._stringRef===f?r.ref:(r=function(m){var y=h.refs;y===kj&&(y=h.refs={}),m===null?delete y[f]:y[f]=m},r._stringRef=f,r)}if(typeof e!="string")throw Error(Te(284));if(!s._owner)throw Error(Te(290,e))}return e}function s0(e,r){throw e=Object.prototype.toString.call(r),Error(Te(31,e==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":e))}function a5(e){var r=e._init;return r(e._payload)}function Rj(e){function r($,z){if(e){var B=$.deletions;B===null?($.deletions=[z],$.flags|=16):B.push(z)}}function s($,z){if(!e)return null;for(;z!==null;)r($,z),z=z.sibling;return null}function a($,z){for($=new Map;z!==null;)z.key!==null?$.set(z.key,z):$.set(z.index,z),z=z.sibling;return $}function h($,z){return $=Qc($,z),$.index=0,$.sibling=null,$}function f($,z,B){return $.index=B,e?(B=$.alternate,B!==null?(B=B.index,B<z?($.flags|=2,z):B):($.flags|=2,z)):($.flags|=1048576,z)}function m($){return e&&$.alternate===null&&($.flags|=2),$}function y($,z,B,H){return z===null||z.tag!==6?(z=gT(B,$.mode,H),z.return=$,z):(z=h(z,B),z.return=$,z)}function x($,z,B,H){var K=B.type;return K===Bd?T($,z,B.props.children,H,B.key):z!==null&&(z.elementType===K||typeof K=="object"&&K!==null&&K.$$typeof===kc&&a5(K)===z.type)?(H=h(z,B.props),H.ref=$p($,z,B),H.return=$,H):(H=Q0(B.type,B.key,B.props,null,$.mode,H),H.ref=$p($,z,B),H.return=$,H)}function w($,z,B,H){return z===null||z.tag!==4||z.stateNode.containerInfo!==B.containerInfo||z.stateNode.implementation!==B.implementation?(z=_T(B,$.mode,H),z.return=$,z):(z=h(z,B.children||[]),z.return=$,z)}function T($,z,B,H,K){return z===null||z.tag!==7?(z=mh(B,$.mode,H,K),z.return=$,z):(z=h(z,B),z.return=$,z)}function M($,z,B){if(typeof z=="string"&&z!==""||typeof z=="number")return z=gT(""+z,$.mode,B),z.return=$,z;if(typeof z=="object"&&z!==null){switch(z.$$typeof){case Zy:return B=Q0(z.type,z.key,z.props,null,$.mode,B),B.ref=$p($,null,z),B.return=$,B;case Fd:return z=_T(z,$.mode,B),z.return=$,z;case kc:var H=z._init;return M($,H(z._payload),B)}if(sm(z)||Fp(z))return z=mh(z,$.mode,B,null),z.return=$,z;s0($,z)}return null}function I($,z,B,H){var K=z!==null?z.key:null;if(typeof B=="string"&&B!==""||typeof B=="number")return K!==null?null:y($,z,""+B,H);if(typeof B=="object"&&B!==null){switch(B.$$typeof){case Zy:return B.key===K?x($,z,B,H):null;case Fd:return B.key===K?w($,z,B,H):null;case kc:return K=B._init,I($,z,K(B._payload),H)}if(sm(B)||Fp(B))return K!==null?null:T($,z,B,H,null);s0($,B)}return null}function R($,z,B,H,K){if(typeof H=="string"&&H!==""||typeof H=="number")return $=$.get(B)||null,y(z,$,""+H,K);if(typeof H=="object"&&H!==null){switch(H.$$typeof){case Zy:return $=$.get(H.key===null?B:H.key)||null,x(z,$,H,K);case Fd:return $=$.get(H.key===null?B:H.key)||null,w(z,$,H,K);case kc:var at=H._init;return R($,z,B,at(H._payload),K)}if(sm(H)||Fp(H))return $=$.get(B)||null,T(z,$,H,K,null);s0(z,H)}return null}function O($,z,B,H){for(var K=null,at=null,ft=z,et=z=0,nt=null;ft!==null&&et<B.length;et++){ft.index>et?(nt=ft,ft=null):nt=ft.sibling;var W=I($,ft,B[et],H);if(W===null){ft===null&&(ft=nt);break}e&&ft&&W.alternate===null&&r($,ft),z=f(W,z,et),at===null?K=W:at.sibling=W,at=W,ft=nt}if(et===B.length)return s($,ft),Xr&&th($,et),K;if(ft===null){for(;et<B.length;et++)ft=M($,B[et],H),ft!==null&&(z=f(ft,z,et),at===null?K=ft:at.sibling=ft,at=ft);return Xr&&th($,et),K}for(ft=a($,ft);et<B.length;et++)nt=R(ft,$,et,B[et],H),nt!==null&&(e&&nt.alternate!==null&&ft.delete(nt.key===null?et:nt.key),z=f(nt,z,et),at===null?K=nt:at.sibling=nt,at=nt);return e&&ft.forEach(function(Q){return r($,Q)}),Xr&&th($,et),K}function N($,z,B,H){var K=Fp(B);if(typeof K!="function")throw Error(Te(150));if(B=K.call(B),B==null)throw Error(Te(151));for(var at=K=null,ft=z,et=z=0,nt=null,W=B.next();ft!==null&&!W.done;et++,W=B.next()){ft.index>et?(nt=ft,ft=null):nt=ft.sibling;var Q=I($,ft,W.value,H);if(Q===null){ft===null&&(ft=nt);break}e&&ft&&Q.alternate===null&&r($,ft),z=f(Q,z,et),at===null?K=Q:at.sibling=Q,at=Q,ft=nt}if(W.done)return s($,ft),Xr&&th($,et),K;if(ft===null){for(;!W.done;et++,W=B.next())W=M($,W.value,H),W!==null&&(z=f(W,z,et),at===null?K=W:at.sibling=W,at=W);return Xr&&th($,et),K}for(ft=a($,ft);!W.done;et++,W=B.next())W=R(ft,$,et,W.value,H),W!==null&&(e&&W.alternate!==null&&ft.delete(W.key===null?et:W.key),z=f(W,z,et),at===null?K=W:at.sibling=W,at=W);return e&&ft.forEach(function(yt){return r($,yt)}),Xr&&th($,et),K}function G($,z,B,H){if(typeof B=="object"&&B!==null&&B.type===Bd&&B.key===null&&(B=B.props.children),typeof B=="object"&&B!==null){switch(B.$$typeof){case Zy:t:{for(var K=B.key,at=z;at!==null;){if(at.key===K){if(K=B.type,K===Bd){if(at.tag===7){s($,at.sibling),z=h(at,B.props.children),z.return=$,$=z;break t}}else if(at.elementType===K||typeof K=="object"&&K!==null&&K.$$typeof===kc&&a5(K)===at.type){s($,at.sibling),z=h(at,B.props),z.ref=$p($,at,B),z.return=$,$=z;break t}s($,at);break}else r($,at);at=at.sibling}B.type===Bd?(z=mh(B.props.children,$.mode,H,B.key),z.return=$,$=z):(H=Q0(B.type,B.key,B.props,null,$.mode,H),H.ref=$p($,z,B),H.return=$,$=H)}return m($);case Fd:t:{for(at=B.key;z!==null;){if(z.key===at)if(z.tag===4&&z.stateNode.containerInfo===B.containerInfo&&z.stateNode.implementation===B.implementation){s($,z.sibling),z=h(z,B.children||[]),z.return=$,$=z;break t}else{s($,z);break}else r($,z);z=z.sibling}z=_T(B,$.mode,H),z.return=$,$=z}return m($);case kc:return at=B._init,G($,z,at(B._payload),H)}if(sm(B))return O($,z,B,H);if(Fp(B))return N($,z,B,H);s0($,B)}return typeof B=="string"&&B!==""||typeof B=="number"?(B=""+B,z!==null&&z.tag===6?(s($,z.sibling),z=h(z,B),z.return=$,$=z):(s($,z),z=gT(B,$.mode,H),z.return=$,$=z),m($)):s($,z)}return G}var hf=Rj(!0),Oj=Rj(!1),Eg={},Ga=mu(Eg),Zm=mu(Eg),Xm=mu(Eg);function ch(e){if(e===Eg)throw Error(Te(174));return e}function NA(e,r){switch(zr(Xm,r),zr(Zm,e),zr(Ga,Eg),e=r.nodeType,e){case 9:case 11:r=(r=r.documentElement)?r.namespaceURI:vE(null,"");break;default:e=e===8?r.parentNode:r,r=e.namespaceURI||null,e=e.tagName,r=vE(r,e)}Vr(Ga),zr(Ga,r)}function df(){Vr(Ga),Vr(Zm),Vr(Xm)}function Lj(e){ch(Xm.current);var r=ch(Ga.current),s=vE(r,e.type);r!==s&&(zr(Zm,e),zr(Ga,s))}function FA(e){Zm.current===e&&(Vr(Ga),Vr(Zm))}var ni=mu(0);function Bv(e){for(var r=e;r!==null;){if(r.tag===13){var s=r.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||s.data==="$!"))return r}else if(r.tag===19&&r.memoizedProps.revealOrder!==void 0){if(r.flags&128)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var uT=[];function BA(){for(var e=0;e<uT.length;e++)uT[e]._workInProgressVersionPrimary=null;uT.length=0}var Z0=Ul.ReactCurrentDispatcher,hT=Ul.ReactCurrentBatchConfig,Sh=0,si=null,Bi=null,Gi=null,jv=!1,wm=!1,Ym=0,lJ=0;function ls(){throw Error(Te(321))}function jA(e,r){if(r===null)return!1;for(var s=0;s<r.length&&s<e.length;s++)if(!ga(e[s],r[s]))return!1;return!0}function VA(e,r,s,a,h,f){if(Sh=f,si=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,Z0.current=e===null||e.memoizedState===null?dJ:fJ,e=s(a,h),wm){f=0;do{if(wm=!1,Ym=0,25<=f)throw Error(Te(301));f+=1,Gi=Bi=null,r.updateQueue=null,Z0.current=pJ,e=s(a,h)}while(wm)}if(Z0.current=Vv,r=Bi!==null&&Bi.next!==null,Sh=0,Gi=Bi=si=null,jv=!1,r)throw Error(Te(300));return e}function UA(){var e=Ym!==0;return Ym=0,e}function Ba(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Gi===null?si.memoizedState=Gi=e:Gi=Gi.next=e,Gi}function Uo(){if(Bi===null){var e=si.alternate;e=e!==null?e.memoizedState:null}else e=Bi.next;var r=Gi===null?si.memoizedState:Gi.next;if(r!==null)Gi=r,Bi=e;else{if(e===null)throw Error(Te(310));Bi=e,e={memoizedState:Bi.memoizedState,baseState:Bi.baseState,baseQueue:Bi.baseQueue,queue:Bi.queue,next:null},Gi===null?si.memoizedState=Gi=e:Gi=Gi.next=e}return Gi}function Km(e,r){return typeof r=="function"?r(e):r}function dT(e){var r=Uo(),s=r.queue;if(s===null)throw Error(Te(311));s.lastRenderedReducer=e;var a=Bi,h=a.baseQueue,f=s.pending;if(f!==null){if(h!==null){var m=h.next;h.next=f.next,f.next=m}a.baseQueue=h=f,s.pending=null}if(h!==null){f=h.next,a=a.baseState;var y=m=null,x=null,w=f;do{var T=w.lane;if((Sh&T)===T)x!==null&&(x=x.next={lane:0,action:w.action,hasEagerState:w.hasEagerState,eagerState:w.eagerState,next:null}),a=w.hasEagerState?w.eagerState:e(a,w.action);else{var M={lane:T,action:w.action,hasEagerState:w.hasEagerState,eagerState:w.eagerState,next:null};x===null?(y=x=M,m=a):x=x.next=M,si.lanes|=T,Th|=T}w=w.next}while(w!==null&&w!==f);x===null?m=a:x.next=y,ga(a,r.memoizedState)||($s=!0),r.memoizedState=a,r.baseState=m,r.baseQueue=x,s.lastRenderedState=a}if(e=s.interleaved,e!==null){h=e;do f=h.lane,si.lanes|=f,Th|=f,h=h.next;while(h!==e)}else h===null&&(s.lanes=0);return[r.memoizedState,s.dispatch]}function fT(e){var r=Uo(),s=r.queue;if(s===null)throw Error(Te(311));s.lastRenderedReducer=e;var a=s.dispatch,h=s.pending,f=r.memoizedState;if(h!==null){s.pending=null;var m=h=h.next;do f=e(f,m.action),m=m.next;while(m!==h);ga(f,r.memoizedState)||($s=!0),r.memoizedState=f,r.baseQueue===null&&(r.baseState=f),s.lastRenderedState=f}return[f,a]}function zj(){}function Nj(e,r){var s=si,a=Uo(),h=r(),f=!ga(a.memoizedState,h);if(f&&(a.memoizedState=h,$s=!0),a=a.queue,$A(jj.bind(null,s,a,e),[e]),a.getSnapshot!==r||f||Gi!==null&&Gi.memoizedState.tag&1){if(s.flags|=2048,Jm(9,Bj.bind(null,s,a,h,r),void 0,null),Hi===null)throw Error(Te(349));Sh&30||Fj(s,r,h)}return h}function Fj(e,r,s){e.flags|=16384,e={getSnapshot:r,value:s},r=si.updateQueue,r===null?(r={lastEffect:null,stores:null},si.updateQueue=r,r.stores=[e]):(s=r.stores,s===null?r.stores=[e]:s.push(e))}function Bj(e,r,s,a){r.value=s,r.getSnapshot=a,Vj(r)&&Uj(e)}function jj(e,r,s){return s(function(){Vj(r)&&Uj(e)})}function Vj(e){var r=e.getSnapshot;e=e.value;try{var s=r();return!ga(e,s)}catch{return!0}}function Uj(e){var r=Fl(e,1);r!==null&&fa(r,e,1,-1)}function l5(e){var r=Ba();return typeof e=="function"&&(e=e()),r.memoizedState=r.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Km,lastRenderedState:e},r.queue=e,e=e.dispatch=hJ.bind(null,si,e),[r.memoizedState,e]}function Jm(e,r,s,a){return e={tag:e,create:r,destroy:s,deps:a,next:null},r=si.updateQueue,r===null?(r={lastEffect:null,stores:null},si.updateQueue=r,r.lastEffect=e.next=e):(s=r.lastEffect,s===null?r.lastEffect=e.next=e:(a=s.next,s.next=e,e.next=a,r.lastEffect=e)),e}function $j(){return Uo().memoizedState}function X0(e,r,s,a){var h=Ba();si.flags|=e,h.memoizedState=Jm(1|r,s,void 0,a===void 0?null:a)}function Dx(e,r,s,a){var h=Uo();a=a===void 0?null:a;var f=void 0;if(Bi!==null){var m=Bi.memoizedState;if(f=m.destroy,a!==null&&jA(a,m.deps)){h.memoizedState=Jm(r,s,f,a);return}}si.flags|=e,h.memoizedState=Jm(1|r,s,f,a)}function c5(e,r){return X0(8390656,8,e,r)}function $A(e,r){return Dx(2048,8,e,r)}function Gj(e,r){return Dx(4,2,e,r)}function Wj(e,r){return Dx(4,4,e,r)}function Hj(e,r){if(typeof r=="function")return e=e(),r(e),function(){r(null)};if(r!=null)return e=e(),r.current=e,function(){r.current=null}}function qj(e,r,s){return s=s!=null?s.concat([e]):null,Dx(4,4,Hj.bind(null,r,e),s)}function GA(){}function Zj(e,r){var s=Uo();r=r===void 0?null:r;var a=s.memoizedState;return a!==null&&r!==null&&jA(r,a[1])?a[0]:(s.memoizedState=[e,r],e)}function Xj(e,r){var s=Uo();r=r===void 0?null:r;var a=s.memoizedState;return a!==null&&r!==null&&jA(r,a[1])?a[0]:(e=e(),s.memoizedState=[e,r],e)}function Yj(e,r,s){return Sh&21?(ga(s,r)||(s=QB(),si.lanes|=s,Th|=s,e.baseState=!0),r):(e.baseState&&(e.baseState=!1,$s=!0),e.memoizedState=s)}function cJ(e,r){var s=br;br=s!==0&&4>s?s:4,e(!0);var a=hT.transition;hT.transition={};try{e(!1),r()}finally{br=s,hT.transition=a}}function Kj(){return Uo().memoizedState}function uJ(e,r,s){var a=Jc(e);if(s={lane:a,action:s,hasEagerState:!1,eagerState:null,next:null},Jj(e))Qj(r,s);else if(s=Pj(e,r,s,a),s!==null){var h=Ms();fa(s,e,a,h),t6(s,r,a)}}function hJ(e,r,s){var a=Jc(e),h={lane:a,action:s,hasEagerState:!1,eagerState:null,next:null};if(Jj(e))Qj(r,h);else{var f=e.alternate;if(e.lanes===0&&(f===null||f.lanes===0)&&(f=r.lastRenderedReducer,f!==null))try{var m=r.lastRenderedState,y=f(m,s);if(h.hasEagerState=!0,h.eagerState=y,ga(y,m)){var x=r.interleaved;x===null?(h.next=h,LA(r)):(h.next=x.next,x.next=h),r.interleaved=h;return}}catch{}finally{}s=Pj(e,r,h,a),s!==null&&(h=Ms(),fa(s,e,a,h),t6(s,r,a))}}function Jj(e){var r=e.alternate;return e===si||r!==null&&r===si}function Qj(e,r){wm=jv=!0;var s=e.pending;s===null?r.next=r:(r.next=s.next,s.next=r),e.pending=r}function t6(e,r,s){if(s&4194240){var a=r.lanes;a&=e.pendingLanes,s|=a,r.lanes=s,bA(e,s)}}var Vv={readContext:Vo,useCallback:ls,useContext:ls,useEffect:ls,useImperativeHandle:ls,useInsertionEffect:ls,useLayoutEffect:ls,useMemo:ls,useReducer:ls,useRef:ls,useState:ls,useDebugValue:ls,useDeferredValue:ls,useTransition:ls,useMutableSource:ls,useSyncExternalStore:ls,useId:ls,unstable_isNewReconciler:!1},dJ={readContext:Vo,useCallback:function(e,r){return Ba().memoizedState=[e,r===void 0?null:r],e},useContext:Vo,useEffect:c5,useImperativeHandle:function(e,r,s){return s=s!=null?s.concat([e]):null,X0(4194308,4,Hj.bind(null,r,e),s)},useLayoutEffect:function(e,r){return X0(4194308,4,e,r)},useInsertionEffect:function(e,r){return X0(4,2,e,r)},useMemo:function(e,r){var s=Ba();return r=r===void 0?null:r,e=e(),s.memoizedState=[e,r],e},useReducer:function(e,r,s){var a=Ba();return r=s!==void 0?s(r):r,a.memoizedState=a.baseState=r,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:r},a.queue=e,e=e.dispatch=uJ.bind(null,si,e),[a.memoizedState,e]},useRef:function(e){var r=Ba();return e={current:e},r.memoizedState=e},useState:l5,useDebugValue:GA,useDeferredValue:function(e){return Ba().memoizedState=e},useTransition:function(){var e=l5(!1),r=e[0];return e=cJ.bind(null,e[1]),Ba().memoizedState=e,[r,e]},useMutableSource:function(){},useSyncExternalStore:function(e,r,s){var a=si,h=Ba();if(Xr){if(s===void 0)throw Error(Te(407));s=s()}else{if(s=r(),Hi===null)throw Error(Te(349));Sh&30||Fj(a,r,s)}h.memoizedState=s;var f={value:s,getSnapshot:r};return h.queue=f,c5(jj.bind(null,a,f,e),[e]),a.flags|=2048,Jm(9,Bj.bind(null,a,f,s,r),void 0,null),s},useId:function(){var e=Ba(),r=Hi.identifierPrefix;if(Xr){var s=Ml,a=El;s=(a&~(1<<32-da(a)-1)).toString(32)+s,r=":"+r+"R"+s,s=Ym++,0<s&&(r+="H"+s.toString(32)),r+=":"}else s=lJ++,r=":"+r+"r"+s.toString(32)+":";return e.memoizedState=r},unstable_isNewReconciler:!1},fJ={readContext:Vo,useCallback:Zj,useContext:Vo,useEffect:$A,useImperativeHandle:qj,useInsertionEffect:Gj,useLayoutEffect:Wj,useMemo:Xj,useReducer:dT,useRef:$j,useState:function(){return dT(Km)},useDebugValue:GA,useDeferredValue:function(e){var r=Uo();return Yj(r,Bi.memoizedState,e)},useTransition:function(){var e=dT(Km)[0],r=Uo().memoizedState;return[e,r]},useMutableSource:zj,useSyncExternalStore:Nj,useId:Kj,unstable_isNewReconciler:!1},pJ={readContext:Vo,useCallback:Zj,useContext:Vo,useEffect:$A,useImperativeHandle:qj,useInsertionEffect:Gj,useLayoutEffect:Wj,useMemo:Xj,useReducer:fT,useRef:$j,useState:function(){return fT(Km)},useDebugValue:GA,useDeferredValue:function(e){var r=Uo();return Bi===null?r.memoizedState=e:Yj(r,Bi.memoizedState,e)},useTransition:function(){var e=fT(Km)[0],r=Uo().memoizedState;return[e,r]},useMutableSource:zj,useSyncExternalStore:Nj,useId:Kj,unstable_isNewReconciler:!1};function ff(e,r){try{var s="",a=r;do s+=UY(a),a=a.return;while(a);var h=s}catch(f){h=`
Error generating stack: `+f.message+`
`+f.stack}return{value:e,source:r,stack:h,digest:null}}function pT(e,r,s){return{value:e,source:null,stack:s??null,digest:r??null}}function UE(e,r){try{console.error(r.value)}catch(s){setTimeout(function(){throw s})}}var mJ=typeof WeakMap=="function"?WeakMap:Map;function e6(e,r,s){s=kl(-1,s),s.tag=3,s.payload={element:null};var a=r.value;return s.callback=function(){$v||($v=!0,JE=a),UE(e,r)},s}function n6(e,r,s){s=kl(-1,s),s.tag=3;var a=e.type.getDerivedStateFromError;if(typeof a=="function"){var h=r.value;s.payload=function(){return a(h)},s.callback=function(){UE(e,r)}}var f=e.stateNode;return f!==null&&typeof f.componentDidCatch=="function"&&(s.callback=function(){UE(e,r),typeof a!="function"&&(Kc===null?Kc=new Set([this]):Kc.add(this));var m=r.stack;this.componentDidCatch(r.value,{componentStack:m!==null?m:""})}),s}function u5(e,r,s){var a=e.pingCache;if(a===null){a=e.pingCache=new mJ;var h=new Set;a.set(r,h)}else h=a.get(r),h===void 0&&(h=new Set,a.set(r,h));h.has(s)||(h.add(s),e=PJ.bind(null,e,r,s),r.then(e,e))}function h5(e){do{var r;if((r=e.tag===13)&&(r=e.memoizedState,r=r!==null?r.dehydrated!==null:!0),r)return e;e=e.return}while(e!==null);return null}function d5(e,r,s,a,h){return e.mode&1?(e.flags|=65536,e.lanes=h,e):(e===r?e.flags|=65536:(e.flags|=128,s.flags|=131072,s.flags&=-52805,s.tag===1&&(s.alternate===null?s.tag=17:(r=kl(-1,1),r.tag=2,Yc(s,r,1))),s.lanes|=1),e)}var gJ=Ul.ReactCurrentOwner,$s=!1;function Ts(e,r,s,a){r.child=e===null?Oj(r,null,s,a):hf(r,e.child,s,a)}function f5(e,r,s,a,h){s=s.render;var f=r.ref;return sf(r,h),a=VA(e,r,s,a,f,h),s=UA(),e!==null&&!$s?(r.updateQueue=e.updateQueue,r.flags&=-2053,e.lanes&=~h,Bl(e,r,h)):(Xr&&s&&PA(r),r.flags|=1,Ts(e,r,a,h),r.child)}function p5(e,r,s,a,h){if(e===null){var f=s.type;return typeof f=="function"&&!JA(f)&&f.defaultProps===void 0&&s.compare===null&&s.defaultProps===void 0?(r.tag=15,r.type=f,r6(e,r,f,a,h)):(e=Q0(s.type,null,a,r,r.mode,h),e.ref=r.ref,e.return=r,r.child=e)}if(f=e.child,!(e.lanes&h)){var m=f.memoizedProps;if(s=s.compare,s=s!==null?s:Gm,s(m,a)&&e.ref===r.ref)return Bl(e,r,h)}return r.flags|=1,e=Qc(f,a),e.ref=r.ref,e.return=r,r.child=e}function r6(e,r,s,a,h){if(e!==null){var f=e.memoizedProps;if(Gm(f,a)&&e.ref===r.ref)if($s=!1,r.pendingProps=a=f,(e.lanes&h)!==0)e.flags&131072&&($s=!0);else return r.lanes=e.lanes,Bl(e,r,h)}return $E(e,r,s,a,h)}function i6(e,r,s){var a=r.pendingProps,h=a.children,f=e!==null?e.memoizedState:null;if(a.mode==="hidden")if(!(r.mode&1))r.memoizedState={baseLanes:0,cachePool:null,transitions:null},zr(Xd,so),so|=s;else{if(!(s&1073741824))return e=f!==null?f.baseLanes|s:s,r.lanes=r.childLanes=1073741824,r.memoizedState={baseLanes:e,cachePool:null,transitions:null},r.updateQueue=null,zr(Xd,so),so|=e,null;r.memoizedState={baseLanes:0,cachePool:null,transitions:null},a=f!==null?f.baseLanes:s,zr(Xd,so),so|=a}else f!==null?(a=f.baseLanes|s,r.memoizedState=null):a=s,zr(Xd,so),so|=a;return Ts(e,r,h,s),r.child}function s6(e,r){var s=r.ref;(e===null&&s!==null||e!==null&&e.ref!==s)&&(r.flags|=512,r.flags|=2097152)}function $E(e,r,s,a,h){var f=Ws(s)?bh:fs.current;return f=cf(r,f),sf(r,h),s=VA(e,r,s,a,f,h),a=UA(),e!==null&&!$s?(r.updateQueue=e.updateQueue,r.flags&=-2053,e.lanes&=~h,Bl(e,r,h)):(Xr&&a&&PA(r),r.flags|=1,Ts(e,r,s,h),r.child)}function m5(e,r,s,a,h){if(Ws(s)){var f=!0;Rv(r)}else f=!1;if(sf(r,h),r.stateNode===null)Y0(e,r),Dj(r,s,a),VE(r,s,a,h),a=!0;else if(e===null){var m=r.stateNode,y=r.memoizedProps;m.props=y;var x=m.context,w=s.contextType;typeof w=="object"&&w!==null?w=Vo(w):(w=Ws(s)?bh:fs.current,w=cf(r,w));var T=s.getDerivedStateFromProps,M=typeof T=="function"||typeof m.getSnapshotBeforeUpdate=="function";M||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(y!==a||x!==w)&&o5(r,m,a,w),Dc=!1;var I=r.memoizedState;m.state=I,Fv(r,a,m,h),x=r.memoizedState,y!==a||I!==x||Gs.current||Dc?(typeof T=="function"&&(jE(r,s,T,a),x=r.memoizedState),(y=Dc||s5(r,s,y,a,I,x,w))?(M||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(r.flags|=4194308)):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=a,r.memoizedState=x),m.props=a,m.state=x,m.context=w,a=y):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),a=!1)}else{m=r.stateNode,Ij(e,r),y=r.memoizedProps,w=r.type===r.elementType?y:ia(r.type,y),m.props=w,M=r.pendingProps,I=m.context,x=s.contextType,typeof x=="object"&&x!==null?x=Vo(x):(x=Ws(s)?bh:fs.current,x=cf(r,x));var R=s.getDerivedStateFromProps;(T=typeof R=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(y!==M||I!==x)&&o5(r,m,a,x),Dc=!1,I=r.memoizedState,m.state=I,Fv(r,a,m,h);var O=r.memoizedState;y!==M||I!==O||Gs.current||Dc?(typeof R=="function"&&(jE(r,s,R,a),O=r.memoizedState),(w=Dc||s5(r,s,w,a,I,O,x)||!1)?(T||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(a,O,x),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(a,O,x)),typeof m.componentDidUpdate=="function"&&(r.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof m.componentDidUpdate!="function"||y===e.memoizedProps&&I===e.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||y===e.memoizedProps&&I===e.memoizedState||(r.flags|=1024),r.memoizedProps=a,r.memoizedState=O),m.props=a,m.state=O,m.context=x,a=w):(typeof m.componentDidUpdate!="function"||y===e.memoizedProps&&I===e.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||y===e.memoizedProps&&I===e.memoizedState||(r.flags|=1024),a=!1)}return GE(e,r,s,a,f,h)}function GE(e,r,s,a,h,f){s6(e,r);var m=(r.flags&128)!==0;if(!a&&!m)return h&&t5(r,s,!1),Bl(e,r,f);a=r.stateNode,gJ.current=r;var y=m&&typeof s.getDerivedStateFromError!="function"?null:a.render();return r.flags|=1,e!==null&&m?(r.child=hf(r,e.child,null,f),r.child=hf(r,null,y,f)):Ts(e,r,y,f),r.memoizedState=a.state,h&&t5(r,s,!0),r.child}function o6(e){var r=e.stateNode;r.pendingContext?Qz(e,r.pendingContext,r.pendingContext!==r.context):r.context&&Qz(e,r.context,!1),NA(e,r.containerInfo)}function g5(e,r,s,a,h){return uf(),kA(h),r.flags|=256,Ts(e,r,s,a),r.child}var WE={dehydrated:null,treeContext:null,retryLane:0};function HE(e){return{baseLanes:e,cachePool:null,transitions:null}}function a6(e,r,s){var a=r.pendingProps,h=ni.current,f=!1,m=(r.flags&128)!==0,y;if((y=m)||(y=e!==null&&e.memoizedState===null?!1:(h&2)!==0),y?(f=!0,r.flags&=-129):(e===null||e.memoizedState!==null)&&(h|=1),zr(ni,h&1),e===null)return FE(r),e=r.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(r.mode&1?e.data==="$!"?r.lanes=8:r.lanes=1073741824:r.lanes=1,null):(m=a.children,e=a.fallback,f?(a=r.mode,f=r.child,m={mode:"hidden",children:m},!(a&1)&&f!==null?(f.childLanes=0,f.pendingProps=m):f=Lx(m,a,0,null),e=mh(e,a,s,null),f.return=r,e.return=r,f.sibling=e,r.child=f,r.child.memoizedState=HE(s),r.memoizedState=WE,e):WA(r,m));if(h=e.memoizedState,h!==null&&(y=h.dehydrated,y!==null))return _J(e,r,m,a,y,h,s);if(f){f=a.fallback,m=r.mode,h=e.child,y=h.sibling;var x={mode:"hidden",children:a.children};return!(m&1)&&r.child!==h?(a=r.child,a.childLanes=0,a.pendingProps=x,r.deletions=null):(a=Qc(h,x),a.subtreeFlags=h.subtreeFlags&14680064),y!==null?f=Qc(y,f):(f=mh(f,m,s,null),f.flags|=2),f.return=r,a.return=r,a.sibling=f,r.child=a,a=f,f=r.child,m=e.child.memoizedState,m=m===null?HE(s):{baseLanes:m.baseLanes|s,cachePool:null,transitions:m.transitions},f.memoizedState=m,f.childLanes=e.childLanes&~s,r.memoizedState=WE,a}return f=e.child,e=f.sibling,a=Qc(f,{mode:"visible",children:a.children}),!(r.mode&1)&&(a.lanes=s),a.return=r,a.sibling=null,e!==null&&(s=r.deletions,s===null?(r.deletions=[e],r.flags|=16):s.push(e)),r.child=a,r.memoizedState=null,a}function WA(e,r){return r=Lx({mode:"visible",children:r},e.mode,0,null),r.return=e,e.child=r}function o0(e,r,s,a){return a!==null&&kA(a),hf(r,e.child,null,s),e=WA(r,r.pendingProps.children),e.flags|=2,r.memoizedState=null,e}function _J(e,r,s,a,h,f,m){if(s)return r.flags&256?(r.flags&=-257,a=pT(Error(Te(422))),o0(e,r,m,a)):r.memoizedState!==null?(r.child=e.child,r.flags|=128,null):(f=a.fallback,h=r.mode,a=Lx({mode:"visible",children:a.children},h,0,null),f=mh(f,h,m,null),f.flags|=2,a.return=r,f.return=r,a.sibling=f,r.child=a,r.mode&1&&hf(r,e.child,null,m),r.child.memoizedState=HE(m),r.memoizedState=WE,f);if(!(r.mode&1))return o0(e,r,m,null);if(h.data==="$!"){if(a=h.nextSibling&&h.nextSibling.dataset,a)var y=a.dgst;return a=y,f=Error(Te(419)),a=pT(f,a,void 0),o0(e,r,m,a)}if(y=(m&e.childLanes)!==0,$s||y){if(a=Hi,a!==null){switch(m&-m){case 4:h=2;break;case 16:h=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:h=32;break;case 536870912:h=268435456;break;default:h=0}h=h&(a.suspendedLanes|m)?0:h,h!==0&&h!==f.retryLane&&(f.retryLane=h,Fl(e,h),fa(a,e,h,-1))}return KA(),a=pT(Error(Te(421))),o0(e,r,m,a)}return h.data==="$?"?(r.flags|=128,r.child=e.child,r=IJ.bind(null,e),h._reactRetry=r,null):(e=f.treeContext,ao=Xc(h.nextSibling),ho=r,Xr=!0,aa=null,e!==null&&(Oo[Lo++]=El,Oo[Lo++]=Ml,Oo[Lo++]=wh,El=e.id,Ml=e.overflow,wh=r),r=WA(r,a.children),r.flags|=4096,r)}function _5(e,r,s){e.lanes|=r;var a=e.alternate;a!==null&&(a.lanes|=r),BE(e.return,r,s)}function mT(e,r,s,a,h){var f=e.memoizedState;f===null?e.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:a,tail:s,tailMode:h}:(f.isBackwards=r,f.rendering=null,f.renderingStartTime=0,f.last=a,f.tail=s,f.tailMode=h)}function l6(e,r,s){var a=r.pendingProps,h=a.revealOrder,f=a.tail;if(Ts(e,r,a.children,s),a=ni.current,a&2)a=a&1|2,r.flags|=128;else{if(e!==null&&e.flags&128)t:for(e=r.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&_5(e,s,r);else if(e.tag===19)_5(e,s,r);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===r)break t;for(;e.sibling===null;){if(e.return===null||e.return===r)break t;e=e.return}e.sibling.return=e.return,e=e.sibling}a&=1}if(zr(ni,a),!(r.mode&1))r.memoizedState=null;else switch(h){case"forwards":for(s=r.child,h=null;s!==null;)e=s.alternate,e!==null&&Bv(e)===null&&(h=s),s=s.sibling;s=h,s===null?(h=r.child,r.child=null):(h=s.sibling,s.sibling=null),mT(r,!1,h,s,f);break;case"backwards":for(s=null,h=r.child,r.child=null;h!==null;){if(e=h.alternate,e!==null&&Bv(e)===null){r.child=h;break}e=h.sibling,h.sibling=s,s=h,h=e}mT(r,!0,s,null,f);break;case"together":mT(r,!1,null,null,void 0);break;default:r.memoizedState=null}return r.child}function Y0(e,r){!(r.mode&1)&&e!==null&&(e.alternate=null,r.alternate=null,r.flags|=2)}function Bl(e,r,s){if(e!==null&&(r.dependencies=e.dependencies),Th|=r.lanes,!(s&r.childLanes))return null;if(e!==null&&r.child!==e.child)throw Error(Te(153));if(r.child!==null){for(e=r.child,s=Qc(e,e.pendingProps),r.child=s,s.return=r;e.sibling!==null;)e=e.sibling,s=s.sibling=Qc(e,e.pendingProps),s.return=r;s.sibling=null}return r.child}function yJ(e,r,s){switch(r.tag){case 3:o6(r),uf();break;case 5:Lj(r);break;case 1:Ws(r.type)&&Rv(r);break;case 4:NA(r,r.stateNode.containerInfo);break;case 10:var a=r.type._context,h=r.memoizedProps.value;zr(zv,a._currentValue),a._currentValue=h;break;case 13:if(a=r.memoizedState,a!==null)return a.dehydrated!==null?(zr(ni,ni.current&1),r.flags|=128,null):s&r.child.childLanes?a6(e,r,s):(zr(ni,ni.current&1),e=Bl(e,r,s),e!==null?e.sibling:null);zr(ni,ni.current&1);break;case 19:if(a=(s&r.childLanes)!==0,e.flags&128){if(a)return l6(e,r,s);r.flags|=128}if(h=r.memoizedState,h!==null&&(h.rendering=null,h.tail=null,h.lastEffect=null),zr(ni,ni.current),a)break;return null;case 22:case 23:return r.lanes=0,i6(e,r,s)}return Bl(e,r,s)}var c6,qE,u6,h6;c6=function(e,r){for(var s=r.child;s!==null;){if(s.tag===5||s.tag===6)e.appendChild(s.stateNode);else if(s.tag!==4&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return;s=s.return}s.sibling.return=s.return,s=s.sibling}};qE=function(){};u6=function(e,r,s,a){var h=e.memoizedProps;if(h!==a){e=r.stateNode,ch(Ga.current);var f=null;switch(s){case"input":h=mE(e,h),a=mE(e,a),f=[];break;case"select":h=oi({},h,{value:void 0}),a=oi({},a,{value:void 0}),f=[];break;case"textarea":h=yE(e,h),a=yE(e,a),f=[];break;default:typeof h.onClick!="function"&&typeof a.onClick=="function"&&(e.onclick=kv)}xE(s,a);var m;s=null;for(w in h)if(!a.hasOwnProperty(w)&&h.hasOwnProperty(w)&&h[w]!=null)if(w==="style"){var y=h[w];for(m in y)y.hasOwnProperty(m)&&(s||(s={}),s[m]="")}else w!=="dangerouslySetInnerHTML"&&w!=="children"&&w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&w!=="autoFocus"&&(Nm.hasOwnProperty(w)?f||(f=[]):(f=f||[]).push(w,null));for(w in a){var x=a[w];if(y=h!=null?h[w]:void 0,a.hasOwnProperty(w)&&x!==y&&(x!=null||y!=null))if(w==="style")if(y){for(m in y)!y.hasOwnProperty(m)||x&&x.hasOwnProperty(m)||(s||(s={}),s[m]="");for(m in x)x.hasOwnProperty(m)&&y[m]!==x[m]&&(s||(s={}),s[m]=x[m])}else s||(f||(f=[]),f.push(w,s)),s=x;else w==="dangerouslySetInnerHTML"?(x=x?x.__html:void 0,y=y?y.__html:void 0,x!=null&&y!==x&&(f=f||[]).push(w,x)):w==="children"?typeof x!="string"&&typeof x!="number"||(f=f||[]).push(w,""+x):w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&(Nm.hasOwnProperty(w)?(x!=null&&w==="onScroll"&&Br("scroll",e),f||y===x||(f=[])):(f=f||[]).push(w,x))}s&&(f=f||[]).push("style",s);var w=f;(r.updateQueue=w)&&(r.flags|=4)}};h6=function(e,r,s,a){s!==a&&(r.flags|=4)};function Gp(e,r){if(!Xr)switch(e.tailMode){case"hidden":r=e.tail;for(var s=null;r!==null;)r.alternate!==null&&(s=r),r=r.sibling;s===null?e.tail=null:s.sibling=null;break;case"collapsed":s=e.tail;for(var a=null;s!==null;)s.alternate!==null&&(a=s),s=s.sibling;a===null?r||e.tail===null?e.tail=null:e.tail.sibling=null:a.sibling=null}}function cs(e){var r=e.alternate!==null&&e.alternate.child===e.child,s=0,a=0;if(r)for(var h=e.child;h!==null;)s|=h.lanes|h.childLanes,a|=h.subtreeFlags&14680064,a|=h.flags&14680064,h.return=e,h=h.sibling;else for(h=e.child;h!==null;)s|=h.lanes|h.childLanes,a|=h.subtreeFlags,a|=h.flags,h.return=e,h=h.sibling;return e.subtreeFlags|=a,e.childLanes=s,r}function vJ(e,r,s){var a=r.pendingProps;switch(IA(r),r.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return cs(r),null;case 1:return Ws(r.type)&&Dv(),cs(r),null;case 3:return a=r.stateNode,df(),Vr(Gs),Vr(fs),BA(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(e===null||e.child===null)&&(i0(r)?r.flags|=4:e===null||e.memoizedState.isDehydrated&&!(r.flags&256)||(r.flags|=1024,aa!==null&&(eM(aa),aa=null))),qE(e,r),cs(r),null;case 5:FA(r);var h=ch(Xm.current);if(s=r.type,e!==null&&r.stateNode!=null)u6(e,r,s,a,h),e.ref!==r.ref&&(r.flags|=512,r.flags|=2097152);else{if(!a){if(r.stateNode===null)throw Error(Te(166));return cs(r),null}if(e=ch(Ga.current),i0(r)){a=r.stateNode,s=r.type;var f=r.memoizedProps;switch(a[Va]=r,a[qm]=f,e=(r.mode&1)!==0,s){case"dialog":Br("cancel",a),Br("close",a);break;case"iframe":case"object":case"embed":Br("load",a);break;case"video":case"audio":for(h=0;h<am.length;h++)Br(am[h],a);break;case"source":Br("error",a);break;case"img":case"image":case"link":Br("error",a),Br("load",a);break;case"details":Br("toggle",a);break;case"input":Mz(a,f),Br("invalid",a);break;case"select":a._wrapperState={wasMultiple:!!f.multiple},Br("invalid",a);break;case"textarea":Cz(a,f),Br("invalid",a)}xE(s,f),h=null;for(var m in f)if(f.hasOwnProperty(m)){var y=f[m];m==="children"?typeof y=="string"?a.textContent!==y&&(f.suppressHydrationWarning!==!0&&r0(a.textContent,y,e),h=["children",y]):typeof y=="number"&&a.textContent!==""+y&&(f.suppressHydrationWarning!==!0&&r0(a.textContent,y,e),h=["children",""+y]):Nm.hasOwnProperty(m)&&y!=null&&m==="onScroll"&&Br("scroll",a)}switch(s){case"input":Xy(a),Az(a,f,!0);break;case"textarea":Xy(a),Pz(a);break;case"select":case"option":break;default:typeof f.onClick=="function"&&(a.onclick=kv)}a=h,r.updateQueue=a,a!==null&&(r.flags|=4)}else{m=h.nodeType===9?h:h.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=FB(s)),e==="http://www.w3.org/1999/xhtml"?s==="script"?(e=m.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof a.is=="string"?e=m.createElement(s,{is:a.is}):(e=m.createElement(s),s==="select"&&(m=e,a.multiple?m.multiple=!0:a.size&&(m.size=a.size))):e=m.createElementNS(e,s),e[Va]=r,e[qm]=a,c6(e,r,!1,!1),r.stateNode=e;t:{switch(m=bE(s,a),s){case"dialog":Br("cancel",e),Br("close",e),h=a;break;case"iframe":case"object":case"embed":Br("load",e),h=a;break;case"video":case"audio":for(h=0;h<am.length;h++)Br(am[h],e);h=a;break;case"source":Br("error",e),h=a;break;case"img":case"image":case"link":Br("error",e),Br("load",e),h=a;break;case"details":Br("toggle",e),h=a;break;case"input":Mz(e,a),h=mE(e,a),Br("invalid",e);break;case"option":h=a;break;case"select":e._wrapperState={wasMultiple:!!a.multiple},h=oi({},a,{value:void 0}),Br("invalid",e);break;case"textarea":Cz(e,a),h=yE(e,a),Br("invalid",e);break;default:h=a}xE(s,h),y=h;for(f in y)if(y.hasOwnProperty(f)){var x=y[f];f==="style"?VB(e,x):f==="dangerouslySetInnerHTML"?(x=x?x.__html:void 0,x!=null&&BB(e,x)):f==="children"?typeof x=="string"?(s!=="textarea"||x!=="")&&Fm(e,x):typeof x=="number"&&Fm(e,""+x):f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&f!=="autoFocus"&&(Nm.hasOwnProperty(f)?x!=null&&f==="onScroll"&&Br("scroll",e):x!=null&&mA(e,f,x,m))}switch(s){case"input":Xy(e),Az(e,a,!1);break;case"textarea":Xy(e),Pz(e);break;case"option":a.value!=null&&e.setAttribute("value",""+su(a.value));break;case"select":e.multiple=!!a.multiple,f=a.value,f!=null?tf(e,!!a.multiple,f,!1):a.defaultValue!=null&&tf(e,!!a.multiple,a.defaultValue,!0);break;default:typeof h.onClick=="function"&&(e.onclick=kv)}switch(s){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break t;case"img":a=!0;break t;default:a=!1}}a&&(r.flags|=4)}r.ref!==null&&(r.flags|=512,r.flags|=2097152)}return cs(r),null;case 6:if(e&&r.stateNode!=null)h6(e,r,e.memoizedProps,a);else{if(typeof a!="string"&&r.stateNode===null)throw Error(Te(166));if(s=ch(Xm.current),ch(Ga.current),i0(r)){if(a=r.stateNode,s=r.memoizedProps,a[Va]=r,(f=a.nodeValue!==s)&&(e=ho,e!==null))switch(e.tag){case 3:r0(a.nodeValue,s,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&r0(a.nodeValue,s,(e.mode&1)!==0)}f&&(r.flags|=4)}else a=(s.nodeType===9?s:s.ownerDocument).createTextNode(a),a[Va]=r,r.stateNode=a}return cs(r),null;case 13:if(Vr(ni),a=r.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Xr&&ao!==null&&r.mode&1&&!(r.flags&128))Cj(),uf(),r.flags|=98560,f=!1;else if(f=i0(r),a!==null&&a.dehydrated!==null){if(e===null){if(!f)throw Error(Te(318));if(f=r.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(Te(317));f[Va]=r}else uf(),!(r.flags&128)&&(r.memoizedState=null),r.flags|=4;cs(r),f=!1}else aa!==null&&(eM(aa),aa=null),f=!0;if(!f)return r.flags&65536?r:null}return r.flags&128?(r.lanes=s,r):(a=a!==null,a!==(e!==null&&e.memoizedState!==null)&&a&&(r.child.flags|=8192,r.mode&1&&(e===null||ni.current&1?ji===0&&(ji=3):KA())),r.updateQueue!==null&&(r.flags|=4),cs(r),null);case 4:return df(),qE(e,r),e===null&&Wm(r.stateNode.containerInfo),cs(r),null;case 10:return OA(r.type._context),cs(r),null;case 17:return Ws(r.type)&&Dv(),cs(r),null;case 19:if(Vr(ni),f=r.memoizedState,f===null)return cs(r),null;if(a=(r.flags&128)!==0,m=f.rendering,m===null)if(a)Gp(f,!1);else{if(ji!==0||e!==null&&e.flags&128)for(e=r.child;e!==null;){if(m=Bv(e),m!==null){for(r.flags|=128,Gp(f,!1),a=m.updateQueue,a!==null&&(r.updateQueue=a,r.flags|=4),r.subtreeFlags=0,a=s,s=r.child;s!==null;)f=s,e=a,f.flags&=14680066,m=f.alternate,m===null?(f.childLanes=0,f.lanes=e,f.child=null,f.subtreeFlags=0,f.memoizedProps=null,f.memoizedState=null,f.updateQueue=null,f.dependencies=null,f.stateNode=null):(f.childLanes=m.childLanes,f.lanes=m.lanes,f.child=m.child,f.subtreeFlags=0,f.deletions=null,f.memoizedProps=m.memoizedProps,f.memoizedState=m.memoizedState,f.updateQueue=m.updateQueue,f.type=m.type,e=m.dependencies,f.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),s=s.sibling;return zr(ni,ni.current&1|2),r.child}e=e.sibling}f.tail!==null&&wi()>pf&&(r.flags|=128,a=!0,Gp(f,!1),r.lanes=4194304)}else{if(!a)if(e=Bv(m),e!==null){if(r.flags|=128,a=!0,s=e.updateQueue,s!==null&&(r.updateQueue=s,r.flags|=4),Gp(f,!0),f.tail===null&&f.tailMode==="hidden"&&!m.alternate&&!Xr)return cs(r),null}else 2*wi()-f.renderingStartTime>pf&&s!==1073741824&&(r.flags|=128,a=!0,Gp(f,!1),r.lanes=4194304);f.isBackwards?(m.sibling=r.child,r.child=m):(s=f.last,s!==null?s.sibling=m:r.child=m,f.last=m)}return f.tail!==null?(r=f.tail,f.rendering=r,f.tail=r.sibling,f.renderingStartTime=wi(),r.sibling=null,s=ni.current,zr(ni,a?s&1|2:s&1),r):(cs(r),null);case 22:case 23:return YA(),a=r.memoizedState!==null,e!==null&&e.memoizedState!==null!==a&&(r.flags|=8192),a&&r.mode&1?so&1073741824&&(cs(r),r.subtreeFlags&6&&(r.flags|=8192)):cs(r),null;case 24:return null;case 25:return null}throw Error(Te(156,r.tag))}function xJ(e,r){switch(IA(r),r.tag){case 1:return Ws(r.type)&&Dv(),e=r.flags,e&65536?(r.flags=e&-65537|128,r):null;case 3:return df(),Vr(Gs),Vr(fs),BA(),e=r.flags,e&65536&&!(e&128)?(r.flags=e&-65537|128,r):null;case 5:return FA(r),null;case 13:if(Vr(ni),e=r.memoizedState,e!==null&&e.dehydrated!==null){if(r.alternate===null)throw Error(Te(340));uf()}return e=r.flags,e&65536?(r.flags=e&-65537|128,r):null;case 19:return Vr(ni),null;case 4:return df(),null;case 10:return OA(r.type._context),null;case 22:case 23:return YA(),null;case 24:return null;default:return null}}var a0=!1,hs=!1,bJ=typeof WeakSet=="function"?WeakSet:Set,Xe=null;function Zd(e,r){var s=e.ref;if(s!==null)if(typeof s=="function")try{s(null)}catch(a){hi(e,r,a)}else s.current=null}function ZE(e,r,s){try{s()}catch(a){hi(e,r,a)}}var y5=!1;function wJ(e,r){if(kE=Cv,e=mj(),CA(e)){if("selectionStart"in e)var s={start:e.selectionStart,end:e.selectionEnd};else t:{s=(s=e.ownerDocument)&&s.defaultView||window;var a=s.getSelection&&s.getSelection();if(a&&a.rangeCount!==0){s=a.anchorNode;var h=a.anchorOffset,f=a.focusNode;a=a.focusOffset;try{s.nodeType,f.nodeType}catch{s=null;break t}var m=0,y=-1,x=-1,w=0,T=0,M=e,I=null;e:for(;;){for(var R;M!==s||h!==0&&M.nodeType!==3||(y=m+h),M!==f||a!==0&&M.nodeType!==3||(x=m+a),M.nodeType===3&&(m+=M.nodeValue.length),(R=M.firstChild)!==null;)I=M,M=R;for(;;){if(M===e)break e;if(I===s&&++w===h&&(y=m),I===f&&++T===a&&(x=m),(R=M.nextSibling)!==null)break;M=I,I=M.parentNode}M=R}s=y===-1||x===-1?null:{start:y,end:x}}else s=null}s=s||{start:0,end:0}}else s=null;for(DE={focusedElem:e,selectionRange:s},Cv=!1,Xe=r;Xe!==null;)if(r=Xe,e=r.child,(r.subtreeFlags&1028)!==0&&e!==null)e.return=r,Xe=e;else for(;Xe!==null;){r=Xe;try{var O=r.alternate;if(r.flags&1024)switch(r.tag){case 0:case 11:case 15:break;case 1:if(O!==null){var N=O.memoizedProps,G=O.memoizedState,$=r.stateNode,z=$.getSnapshotBeforeUpdate(r.elementType===r.type?N:ia(r.type,N),G);$.__reactInternalSnapshotBeforeUpdate=z}break;case 3:var B=r.stateNode.containerInfo;B.nodeType===1?B.textContent="":B.nodeType===9&&B.documentElement&&B.removeChild(B.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Te(163))}}catch(H){hi(r,r.return,H)}if(e=r.sibling,e!==null){e.return=r.return,Xe=e;break}Xe=r.return}return O=y5,y5=!1,O}function Sm(e,r,s){var a=r.updateQueue;if(a=a!==null?a.lastEffect:null,a!==null){var h=a=a.next;do{if((h.tag&e)===e){var f=h.destroy;h.destroy=void 0,f!==void 0&&ZE(r,s,f)}h=h.next}while(h!==a)}}function Rx(e,r){if(r=r.updateQueue,r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&e)===e){var a=s.create;s.destroy=a()}s=s.next}while(s!==r)}}function XE(e){var r=e.ref;if(r!==null){var s=e.stateNode;switch(e.tag){case 5:e=s;break;default:e=s}typeof r=="function"?r(e):r.current=e}}function d6(e){var r=e.alternate;r!==null&&(e.alternate=null,d6(r)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(r=e.stateNode,r!==null&&(delete r[Va],delete r[qm],delete r[LE],delete r[iJ],delete r[sJ])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function f6(e){return e.tag===5||e.tag===3||e.tag===4}function v5(e){t:for(;;){for(;e.sibling===null;){if(e.return===null||f6(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue t;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function YE(e,r,s){var a=e.tag;if(a===5||a===6)e=e.stateNode,r?s.nodeType===8?s.parentNode.insertBefore(e,r):s.insertBefore(e,r):(s.nodeType===8?(r=s.parentNode,r.insertBefore(e,s)):(r=s,r.appendChild(e)),s=s._reactRootContainer,s!=null||r.onclick!==null||(r.onclick=kv));else if(a!==4&&(e=e.child,e!==null))for(YE(e,r,s),e=e.sibling;e!==null;)YE(e,r,s),e=e.sibling}function KE(e,r,s){var a=e.tag;if(a===5||a===6)e=e.stateNode,r?s.insertBefore(e,r):s.appendChild(e);else if(a!==4&&(e=e.child,e!==null))for(KE(e,r,s),e=e.sibling;e!==null;)KE(e,r,s),e=e.sibling}var Ki=null,sa=!1;function Ac(e,r,s){for(s=s.child;s!==null;)p6(e,r,s),s=s.sibling}function p6(e,r,s){if($a&&typeof $a.onCommitFiberUnmount=="function")try{$a.onCommitFiberUnmount(Ex,s)}catch{}switch(s.tag){case 5:hs||Zd(s,r);case 6:var a=Ki,h=sa;Ki=null,Ac(e,r,s),Ki=a,sa=h,Ki!==null&&(sa?(e=Ki,s=s.stateNode,e.nodeType===8?e.parentNode.removeChild(s):e.removeChild(s)):Ki.removeChild(s.stateNode));break;case 18:Ki!==null&&(sa?(e=Ki,s=s.stateNode,e.nodeType===8?lT(e.parentNode,s):e.nodeType===1&&lT(e,s),Um(e)):lT(Ki,s.stateNode));break;case 4:a=Ki,h=sa,Ki=s.stateNode.containerInfo,sa=!0,Ac(e,r,s),Ki=a,sa=h;break;case 0:case 11:case 14:case 15:if(!hs&&(a=s.updateQueue,a!==null&&(a=a.lastEffect,a!==null))){h=a=a.next;do{var f=h,m=f.destroy;f=f.tag,m!==void 0&&(f&2||f&4)&&ZE(s,r,m),h=h.next}while(h!==a)}Ac(e,r,s);break;case 1:if(!hs&&(Zd(s,r),a=s.stateNode,typeof a.componentWillUnmount=="function"))try{a.props=s.memoizedProps,a.state=s.memoizedState,a.componentWillUnmount()}catch(y){hi(s,r,y)}Ac(e,r,s);break;case 21:Ac(e,r,s);break;case 22:s.mode&1?(hs=(a=hs)||s.memoizedState!==null,Ac(e,r,s),hs=a):Ac(e,r,s);break;default:Ac(e,r,s)}}function x5(e){var r=e.updateQueue;if(r!==null){e.updateQueue=null;var s=e.stateNode;s===null&&(s=e.stateNode=new bJ),r.forEach(function(a){var h=kJ.bind(null,e,a);s.has(a)||(s.add(a),a.then(h,h))})}}function ra(e,r){var s=r.deletions;if(s!==null)for(var a=0;a<s.length;a++){var h=s[a];try{var f=e,m=r,y=m;t:for(;y!==null;){switch(y.tag){case 5:Ki=y.stateNode,sa=!1;break t;case 3:Ki=y.stateNode.containerInfo,sa=!0;break t;case 4:Ki=y.stateNode.containerInfo,sa=!0;break t}y=y.return}if(Ki===null)throw Error(Te(160));p6(f,m,h),Ki=null,sa=!1;var x=h.alternate;x!==null&&(x.return=null),h.return=null}catch(w){hi(h,r,w)}}if(r.subtreeFlags&12854)for(r=r.child;r!==null;)m6(r,e),r=r.sibling}function m6(e,r){var s=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ra(r,e),za(e),a&4){try{Sm(3,e,e.return),Rx(3,e)}catch(N){hi(e,e.return,N)}try{Sm(5,e,e.return)}catch(N){hi(e,e.return,N)}}break;case 1:ra(r,e),za(e),a&512&&s!==null&&Zd(s,s.return);break;case 5:if(ra(r,e),za(e),a&512&&s!==null&&Zd(s,s.return),e.flags&32){var h=e.stateNode;try{Fm(h,"")}catch(N){hi(e,e.return,N)}}if(a&4&&(h=e.stateNode,h!=null)){var f=e.memoizedProps,m=s!==null?s.memoizedProps:f,y=e.type,x=e.updateQueue;if(e.updateQueue=null,x!==null)try{y==="input"&&f.type==="radio"&&f.name!=null&&zB(h,f),bE(y,m);var w=bE(y,f);for(m=0;m<x.length;m+=2){var T=x[m],M=x[m+1];T==="style"?VB(h,M):T==="dangerouslySetInnerHTML"?BB(h,M):T==="children"?Fm(h,M):mA(h,T,M,w)}switch(y){case"input":gE(h,f);break;case"textarea":NB(h,f);break;case"select":var I=h._wrapperState.wasMultiple;h._wrapperState.wasMultiple=!!f.multiple;var R=f.value;R!=null?tf(h,!!f.multiple,R,!1):I!==!!f.multiple&&(f.defaultValue!=null?tf(h,!!f.multiple,f.defaultValue,!0):tf(h,!!f.multiple,f.multiple?[]:"",!1))}h[qm]=f}catch(N){hi(e,e.return,N)}}break;case 6:if(ra(r,e),za(e),a&4){if(e.stateNode===null)throw Error(Te(162));h=e.stateNode,f=e.memoizedProps;try{h.nodeValue=f}catch(N){hi(e,e.return,N)}}break;case 3:if(ra(r,e),za(e),a&4&&s!==null&&s.memoizedState.isDehydrated)try{Um(r.containerInfo)}catch(N){hi(e,e.return,N)}break;case 4:ra(r,e),za(e);break;case 13:ra(r,e),za(e),h=e.child,h.flags&8192&&(f=h.memoizedState!==null,h.stateNode.isHidden=f,!f||h.alternate!==null&&h.alternate.memoizedState!==null||(ZA=wi())),a&4&&x5(e);break;case 22:if(T=s!==null&&s.memoizedState!==null,e.mode&1?(hs=(w=hs)||T,ra(r,e),hs=w):ra(r,e),za(e),a&8192){if(w=e.memoizedState!==null,(e.stateNode.isHidden=w)&&!T&&e.mode&1)for(Xe=e,T=e.child;T!==null;){for(M=Xe=T;Xe!==null;){switch(I=Xe,R=I.child,I.tag){case 0:case 11:case 14:case 15:Sm(4,I,I.return);break;case 1:Zd(I,I.return);var O=I.stateNode;if(typeof O.componentWillUnmount=="function"){a=I,s=I.return;try{r=a,O.props=r.memoizedProps,O.state=r.memoizedState,O.componentWillUnmount()}catch(N){hi(a,s,N)}}break;case 5:Zd(I,I.return);break;case 22:if(I.memoizedState!==null){w5(M);continue}}R!==null?(R.return=I,Xe=R):w5(M)}T=T.sibling}t:for(T=null,M=e;;){if(M.tag===5){if(T===null){T=M;try{h=M.stateNode,w?(f=h.style,typeof f.setProperty=="function"?f.setProperty("display","none","important"):f.display="none"):(y=M.stateNode,x=M.memoizedProps.style,m=x!=null&&x.hasOwnProperty("display")?x.display:null,y.style.display=jB("display",m))}catch(N){hi(e,e.return,N)}}}else if(M.tag===6){if(T===null)try{M.stateNode.nodeValue=w?"":M.memoizedProps}catch(N){hi(e,e.return,N)}}else if((M.tag!==22&&M.tag!==23||M.memoizedState===null||M===e)&&M.child!==null){M.child.return=M,M=M.child;continue}if(M===e)break t;for(;M.sibling===null;){if(M.return===null||M.return===e)break t;T===M&&(T=null),M=M.return}T===M&&(T=null),M.sibling.return=M.return,M=M.sibling}}break;case 19:ra(r,e),za(e),a&4&&x5(e);break;case 21:break;default:ra(r,e),za(e)}}function za(e){var r=e.flags;if(r&2){try{t:{for(var s=e.return;s!==null;){if(f6(s)){var a=s;break t}s=s.return}throw Error(Te(160))}switch(a.tag){case 5:var h=a.stateNode;a.flags&32&&(Fm(h,""),a.flags&=-33);var f=v5(e);KE(e,f,h);break;case 3:case 4:var m=a.stateNode.containerInfo,y=v5(e);YE(e,y,m);break;default:throw Error(Te(161))}}catch(x){hi(e,e.return,x)}e.flags&=-3}r&4096&&(e.flags&=-4097)}function SJ(e,r,s){Xe=e,g6(e)}function g6(e,r,s){for(var a=(e.mode&1)!==0;Xe!==null;){var h=Xe,f=h.child;if(h.tag===22&&a){var m=h.memoizedState!==null||a0;if(!m){var y=h.alternate,x=y!==null&&y.memoizedState!==null||hs;y=a0;var w=hs;if(a0=m,(hs=x)&&!w)for(Xe=h;Xe!==null;)m=Xe,x=m.child,m.tag===22&&m.memoizedState!==null?S5(h):x!==null?(x.return=m,Xe=x):S5(h);for(;f!==null;)Xe=f,g6(f),f=f.sibling;Xe=h,a0=y,hs=w}b5(e)}else h.subtreeFlags&8772&&f!==null?(f.return=h,Xe=f):b5(e)}}function b5(e){for(;Xe!==null;){var r=Xe;if(r.flags&8772){var s=r.alternate;try{if(r.flags&8772)switch(r.tag){case 0:case 11:case 15:hs||Rx(5,r);break;case 1:var a=r.stateNode;if(r.flags&4&&!hs)if(s===null)a.componentDidMount();else{var h=r.elementType===r.type?s.memoizedProps:ia(r.type,s.memoizedProps);a.componentDidUpdate(h,s.memoizedState,a.__reactInternalSnapshotBeforeUpdate)}var f=r.updateQueue;f!==null&&i5(r,f,a);break;case 3:var m=r.updateQueue;if(m!==null){if(s=null,r.child!==null)switch(r.child.tag){case 5:s=r.child.stateNode;break;case 1:s=r.child.stateNode}i5(r,m,s)}break;case 5:var y=r.stateNode;if(s===null&&r.flags&4){s=y;var x=r.memoizedProps;switch(r.type){case"button":case"input":case"select":case"textarea":x.autoFocus&&s.focus();break;case"img":x.src&&(s.src=x.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(r.memoizedState===null){var w=r.alternate;if(w!==null){var T=w.memoizedState;if(T!==null){var M=T.dehydrated;M!==null&&Um(M)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Te(163))}hs||r.flags&512&&XE(r)}catch(I){hi(r,r.return,I)}}if(r===e){Xe=null;break}if(s=r.sibling,s!==null){s.return=r.return,Xe=s;break}Xe=r.return}}function w5(e){for(;Xe!==null;){var r=Xe;if(r===e){Xe=null;break}var s=r.sibling;if(s!==null){s.return=r.return,Xe=s;break}Xe=r.return}}function S5(e){for(;Xe!==null;){var r=Xe;try{switch(r.tag){case 0:case 11:case 15:var s=r.return;try{Rx(4,r)}catch(x){hi(r,s,x)}break;case 1:var a=r.stateNode;if(typeof a.componentDidMount=="function"){var h=r.return;try{a.componentDidMount()}catch(x){hi(r,h,x)}}var f=r.return;try{XE(r)}catch(x){hi(r,f,x)}break;case 5:var m=r.return;try{XE(r)}catch(x){hi(r,m,x)}}}catch(x){hi(r,r.return,x)}if(r===e){Xe=null;break}var y=r.sibling;if(y!==null){y.return=r.return,Xe=y;break}Xe=r.return}}var TJ=Math.ceil,Uv=Ul.ReactCurrentDispatcher,HA=Ul.ReactCurrentOwner,Bo=Ul.ReactCurrentBatchConfig,ir=0,Hi=null,Ii=null,ts=0,so=0,Xd=mu(0),ji=0,Qm=null,Th=0,Ox=0,qA=0,Tm=null,Vs=null,ZA=0,pf=1/0,wl=null,$v=!1,JE=null,Kc=null,l0=!1,Fc=null,Gv=0,Em=0,QE=null,K0=-1,J0=0;function Ms(){return ir&6?wi():K0!==-1?K0:K0=wi()}function Jc(e){return e.mode&1?ir&2&&ts!==0?ts&-ts:aJ.transition!==null?(J0===0&&(J0=QB()),J0):(e=br,e!==0||(e=window.event,e=e===void 0?16:oj(e.type)),e):1}function fa(e,r,s,a){if(50<Em)throw Em=0,QE=null,Error(Te(185));wg(e,s,a),(!(ir&2)||e!==Hi)&&(e===Hi&&(!(ir&2)&&(Ox|=s),ji===4&&Lc(e,ts)),Hs(e,a),s===1&&ir===0&&!(r.mode&1)&&(pf=wi()+500,Ix&&gu()))}function Hs(e,r){var s=e.callbackNode;aK(e,r);var a=Av(e,e===Hi?ts:0);if(a===0)s!==null&&Dz(s),e.callbackNode=null,e.callbackPriority=0;else if(r=a&-a,e.callbackPriority!==r){if(s!=null&&Dz(s),r===1)e.tag===0?oJ(T5.bind(null,e)):Ej(T5.bind(null,e)),nJ(function(){!(ir&6)&&gu()}),s=null;else{switch(tj(a)){case 1:s=xA;break;case 4:s=KB;break;case 16:s=Mv;break;case 536870912:s=JB;break;default:s=Mv}s=T6(s,_6.bind(null,e))}e.callbackPriority=r,e.callbackNode=s}}function _6(e,r){if(K0=-1,J0=0,ir&6)throw Error(Te(327));var s=e.callbackNode;if(of()&&e.callbackNode!==s)return null;var a=Av(e,e===Hi?ts:0);if(a===0)return null;if(a&30||a&e.expiredLanes||r)r=Wv(e,a);else{r=a;var h=ir;ir|=2;var f=v6();(Hi!==e||ts!==r)&&(wl=null,pf=wi()+500,ph(e,r));do try{AJ();break}catch(y){y6(e,y)}while(!0);RA(),Uv.current=f,ir=h,Ii!==null?r=0:(Hi=null,ts=0,r=ji)}if(r!==0){if(r===2&&(h=ME(e),h!==0&&(a=h,r=tM(e,h))),r===1)throw s=Qm,ph(e,0),Lc(e,a),Hs(e,wi()),s;if(r===6)Lc(e,a);else{if(h=e.current.alternate,!(a&30)&&!EJ(h)&&(r=Wv(e,a),r===2&&(f=ME(e),f!==0&&(a=f,r=tM(e,f))),r===1))throw s=Qm,ph(e,0),Lc(e,a),Hs(e,wi()),s;switch(e.finishedWork=h,e.finishedLanes=a,r){case 0:case 1:throw Error(Te(345));case 2:eh(e,Vs,wl);break;case 3:if(Lc(e,a),(a&130023424)===a&&(r=ZA+500-wi(),10<r)){if(Av(e,0)!==0)break;if(h=e.suspendedLanes,(h&a)!==a){Ms(),e.pingedLanes|=e.suspendedLanes&h;break}e.timeoutHandle=OE(eh.bind(null,e,Vs,wl),r);break}eh(e,Vs,wl);break;case 4:if(Lc(e,a),(a&4194240)===a)break;for(r=e.eventTimes,h=-1;0<a;){var m=31-da(a);f=1<<m,m=r[m],m>h&&(h=m),a&=~f}if(a=h,a=wi()-a,a=(120>a?120:480>a?480:1080>a?1080:1920>a?1920:3e3>a?3e3:4320>a?4320:1960*TJ(a/1960))-a,10<a){e.timeoutHandle=OE(eh.bind(null,e,Vs,wl),a);break}eh(e,Vs,wl);break;case 5:eh(e,Vs,wl);break;default:throw Error(Te(329))}}}return Hs(e,wi()),e.callbackNode===s?_6.bind(null,e):null}function tM(e,r){var s=Tm;return e.current.memoizedState.isDehydrated&&(ph(e,r).flags|=256),e=Wv(e,r),e!==2&&(r=Vs,Vs=s,r!==null&&eM(r)),e}function eM(e){Vs===null?Vs=e:Vs.push.apply(Vs,e)}function EJ(e){for(var r=e;;){if(r.flags&16384){var s=r.updateQueue;if(s!==null&&(s=s.stores,s!==null))for(var a=0;a<s.length;a++){var h=s[a],f=h.getSnapshot;h=h.value;try{if(!ga(f(),h))return!1}catch{return!1}}}if(s=r.child,r.subtreeFlags&16384&&s!==null)s.return=r,r=s;else{if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function Lc(e,r){for(r&=~qA,r&=~Ox,e.suspendedLanes|=r,e.pingedLanes&=~r,e=e.expirationTimes;0<r;){var s=31-da(r),a=1<<s;e[s]=-1,r&=~a}}function T5(e){if(ir&6)throw Error(Te(327));of();var r=Av(e,0);if(!(r&1))return Hs(e,wi()),null;var s=Wv(e,r);if(e.tag!==0&&s===2){var a=ME(e);a!==0&&(r=a,s=tM(e,a))}if(s===1)throw s=Qm,ph(e,0),Lc(e,r),Hs(e,wi()),s;if(s===6)throw Error(Te(345));return e.finishedWork=e.current.alternate,e.finishedLanes=r,eh(e,Vs,wl),Hs(e,wi()),null}function XA(e,r){var s=ir;ir|=1;try{return e(r)}finally{ir=s,ir===0&&(pf=wi()+500,Ix&&gu())}}function Eh(e){Fc!==null&&Fc.tag===0&&!(ir&6)&&of();var r=ir;ir|=1;var s=Bo.transition,a=br;try{if(Bo.transition=null,br=1,e)return e()}finally{br=a,Bo.transition=s,ir=r,!(ir&6)&&gu()}}function YA(){so=Xd.current,Vr(Xd)}function ph(e,r){e.finishedWork=null,e.finishedLanes=0;var s=e.timeoutHandle;if(s!==-1&&(e.timeoutHandle=-1,eJ(s)),Ii!==null)for(s=Ii.return;s!==null;){var a=s;switch(IA(a),a.tag){case 1:a=a.type.childContextTypes,a!=null&&Dv();break;case 3:df(),Vr(Gs),Vr(fs),BA();break;case 5:FA(a);break;case 4:df();break;case 13:Vr(ni);break;case 19:Vr(ni);break;case 10:OA(a.type._context);break;case 22:case 23:YA()}s=s.return}if(Hi=e,Ii=e=Qc(e.current,null),ts=so=r,ji=0,Qm=null,qA=Ox=Th=0,Vs=Tm=null,lh!==null){for(r=0;r<lh.length;r++)if(s=lh[r],a=s.interleaved,a!==null){s.interleaved=null;var h=a.next,f=s.pending;if(f!==null){var m=f.next;f.next=h,a.next=m}s.pending=a}lh=null}return e}function y6(e,r){do{var s=Ii;try{if(RA(),Z0.current=Vv,jv){for(var a=si.memoizedState;a!==null;){var h=a.queue;h!==null&&(h.pending=null),a=a.next}jv=!1}if(Sh=0,Gi=Bi=si=null,wm=!1,Ym=0,HA.current=null,s===null||s.return===null){ji=1,Qm=r,Ii=null;break}t:{var f=e,m=s.return,y=s,x=r;if(r=ts,y.flags|=32768,x!==null&&typeof x=="object"&&typeof x.then=="function"){var w=x,T=y,M=T.tag;if(!(T.mode&1)&&(M===0||M===11||M===15)){var I=T.alternate;I?(T.updateQueue=I.updateQueue,T.memoizedState=I.memoizedState,T.lanes=I.lanes):(T.updateQueue=null,T.memoizedState=null)}var R=h5(m);if(R!==null){R.flags&=-257,d5(R,m,y,f,r),R.mode&1&&u5(f,w,r),r=R,x=w;var O=r.updateQueue;if(O===null){var N=new Set;N.add(x),r.updateQueue=N}else O.add(x);break t}else{if(!(r&1)){u5(f,w,r),KA();break t}x=Error(Te(426))}}else if(Xr&&y.mode&1){var G=h5(m);if(G!==null){!(G.flags&65536)&&(G.flags|=256),d5(G,m,y,f,r),kA(ff(x,y));break t}}f=x=ff(x,y),ji!==4&&(ji=2),Tm===null?Tm=[f]:Tm.push(f),f=m;do{switch(f.tag){case 3:f.flags|=65536,r&=-r,f.lanes|=r;var $=e6(f,x,r);r5(f,$);break t;case 1:y=x;var z=f.type,B=f.stateNode;if(!(f.flags&128)&&(typeof z.getDerivedStateFromError=="function"||B!==null&&typeof B.componentDidCatch=="function"&&(Kc===null||!Kc.has(B)))){f.flags|=65536,r&=-r,f.lanes|=r;var H=n6(f,y,r);r5(f,H);break t}}f=f.return}while(f!==null)}b6(s)}catch(K){r=K,Ii===s&&s!==null&&(Ii=s=s.return);continue}break}while(!0)}function v6(){var e=Uv.current;return Uv.current=Vv,e===null?Vv:e}function KA(){(ji===0||ji===3||ji===2)&&(ji=4),Hi===null||!(Th&268435455)&&!(Ox&268435455)||Lc(Hi,ts)}function Wv(e,r){var s=ir;ir|=2;var a=v6();(Hi!==e||ts!==r)&&(wl=null,ph(e,r));do try{MJ();break}catch(h){y6(e,h)}while(!0);if(RA(),ir=s,Uv.current=a,Ii!==null)throw Error(Te(261));return Hi=null,ts=0,ji}function MJ(){for(;Ii!==null;)x6(Ii)}function AJ(){for(;Ii!==null&&!JY();)x6(Ii)}function x6(e){var r=S6(e.alternate,e,so);e.memoizedProps=e.pendingProps,r===null?b6(e):Ii=r,HA.current=null}function b6(e){var r=e;do{var s=r.alternate;if(e=r.return,r.flags&32768){if(s=xJ(s,r),s!==null){s.flags&=32767,Ii=s;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ji=6,Ii=null;return}}else if(s=vJ(s,r,so),s!==null){Ii=s;return}if(r=r.sibling,r!==null){Ii=r;return}Ii=r=e}while(r!==null);ji===0&&(ji=5)}function eh(e,r,s){var a=br,h=Bo.transition;try{Bo.transition=null,br=1,CJ(e,r,s,a)}finally{Bo.transition=h,br=a}return null}function CJ(e,r,s,a){do of();while(Fc!==null);if(ir&6)throw Error(Te(327));s=e.finishedWork;var h=e.finishedLanes;if(s===null)return null;if(e.finishedWork=null,e.finishedLanes=0,s===e.current)throw Error(Te(177));e.callbackNode=null,e.callbackPriority=0;var f=s.lanes|s.childLanes;if(lK(e,f),e===Hi&&(Ii=Hi=null,ts=0),!(s.subtreeFlags&2064)&&!(s.flags&2064)||l0||(l0=!0,T6(Mv,function(){return of(),null})),f=(s.flags&15990)!==0,s.subtreeFlags&15990||f){f=Bo.transition,Bo.transition=null;var m=br;br=1;var y=ir;ir|=4,HA.current=null,wJ(e,s),m6(s,e),ZK(DE),Cv=!!kE,DE=kE=null,e.current=s,SJ(s),QY(),ir=y,br=m,Bo.transition=f}else e.current=s;if(l0&&(l0=!1,Fc=e,Gv=h),f=e.pendingLanes,f===0&&(Kc=null),nK(s.stateNode),Hs(e,wi()),r!==null)for(a=e.onRecoverableError,s=0;s<r.length;s++)h=r[s],a(h.value,{componentStack:h.stack,digest:h.digest});if($v)throw $v=!1,e=JE,JE=null,e;return Gv&1&&e.tag!==0&&of(),f=e.pendingLanes,f&1?e===QE?Em++:(Em=0,QE=e):Em=0,gu(),null}function of(){if(Fc!==null){var e=tj(Gv),r=Bo.transition,s=br;try{if(Bo.transition=null,br=16>e?16:e,Fc===null)var a=!1;else{if(e=Fc,Fc=null,Gv=0,ir&6)throw Error(Te(331));var h=ir;for(ir|=4,Xe=e.current;Xe!==null;){var f=Xe,m=f.child;if(Xe.flags&16){var y=f.deletions;if(y!==null){for(var x=0;x<y.length;x++){var w=y[x];for(Xe=w;Xe!==null;){var T=Xe;switch(T.tag){case 0:case 11:case 15:Sm(8,T,f)}var M=T.child;if(M!==null)M.return=T,Xe=M;else for(;Xe!==null;){T=Xe;var I=T.sibling,R=T.return;if(d6(T),T===w){Xe=null;break}if(I!==null){I.return=R,Xe=I;break}Xe=R}}}var O=f.alternate;if(O!==null){var N=O.child;if(N!==null){O.child=null;do{var G=N.sibling;N.sibling=null,N=G}while(N!==null)}}Xe=f}}if(f.subtreeFlags&2064&&m!==null)m.return=f,Xe=m;else t:for(;Xe!==null;){if(f=Xe,f.flags&2048)switch(f.tag){case 0:case 11:case 15:Sm(9,f,f.return)}var $=f.sibling;if($!==null){$.return=f.return,Xe=$;break t}Xe=f.return}}var z=e.current;for(Xe=z;Xe!==null;){m=Xe;var B=m.child;if(m.subtreeFlags&2064&&B!==null)B.return=m,Xe=B;else t:for(m=z;Xe!==null;){if(y=Xe,y.flags&2048)try{switch(y.tag){case 0:case 11:case 15:Rx(9,y)}}catch(K){hi(y,y.return,K)}if(y===m){Xe=null;break t}var H=y.sibling;if(H!==null){H.return=y.return,Xe=H;break t}Xe=y.return}}if(ir=h,gu(),$a&&typeof $a.onPostCommitFiberRoot=="function")try{$a.onPostCommitFiberRoot(Ex,e)}catch{}a=!0}return a}finally{br=s,Bo.transition=r}}return!1}function E5(e,r,s){r=ff(s,r),r=e6(e,r,1),e=Yc(e,r,1),r=Ms(),e!==null&&(wg(e,1,r),Hs(e,r))}function hi(e,r,s){if(e.tag===3)E5(e,e,s);else for(;r!==null;){if(r.tag===3){E5(r,e,s);break}else if(r.tag===1){var a=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof a.componentDidCatch=="function"&&(Kc===null||!Kc.has(a))){e=ff(s,e),e=n6(r,e,1),r=Yc(r,e,1),e=Ms(),r!==null&&(wg(r,1,e),Hs(r,e));break}}r=r.return}}function PJ(e,r,s){var a=e.pingCache;a!==null&&a.delete(r),r=Ms(),e.pingedLanes|=e.suspendedLanes&s,Hi===e&&(ts&s)===s&&(ji===4||ji===3&&(ts&130023424)===ts&&500>wi()-ZA?ph(e,0):qA|=s),Hs(e,r)}function w6(e,r){r===0&&(e.mode&1?(r=Jy,Jy<<=1,!(Jy&130023424)&&(Jy=4194304)):r=1);var s=Ms();e=Fl(e,r),e!==null&&(wg(e,r,s),Hs(e,s))}function IJ(e){var r=e.memoizedState,s=0;r!==null&&(s=r.retryLane),w6(e,s)}function kJ(e,r){var s=0;switch(e.tag){case 13:var a=e.stateNode,h=e.memoizedState;h!==null&&(s=h.retryLane);break;case 19:a=e.stateNode;break;default:throw Error(Te(314))}a!==null&&a.delete(r),w6(e,s)}var S6;S6=function(e,r,s){if(e!==null)if(e.memoizedProps!==r.pendingProps||Gs.current)$s=!0;else{if(!(e.lanes&s)&&!(r.flags&128))return $s=!1,yJ(e,r,s);$s=!!(e.flags&131072)}else $s=!1,Xr&&r.flags&1048576&&Mj(r,Lv,r.index);switch(r.lanes=0,r.tag){case 2:var a=r.type;Y0(e,r),e=r.pendingProps;var h=cf(r,fs.current);sf(r,s),h=VA(null,r,a,e,h,s);var f=UA();return r.flags|=1,typeof h=="object"&&h!==null&&typeof h.render=="function"&&h.$$typeof===void 0?(r.tag=1,r.memoizedState=null,r.updateQueue=null,Ws(a)?(f=!0,Rv(r)):f=!1,r.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,zA(r),h.updater=kx,r.stateNode=h,h._reactInternals=r,VE(r,a,e,s),r=GE(null,r,a,!0,f,s)):(r.tag=0,Xr&&f&&PA(r),Ts(null,r,h,s),r=r.child),r;case 16:a=r.elementType;t:{switch(Y0(e,r),e=r.pendingProps,h=a._init,a=h(a._payload),r.type=a,h=r.tag=RJ(a),e=ia(a,e),h){case 0:r=$E(null,r,a,e,s);break t;case 1:r=m5(null,r,a,e,s);break t;case 11:r=f5(null,r,a,e,s);break t;case 14:r=p5(null,r,a,ia(a.type,e),s);break t}throw Error(Te(306,a,""))}return r;case 0:return a=r.type,h=r.pendingProps,h=r.elementType===a?h:ia(a,h),$E(e,r,a,h,s);case 1:return a=r.type,h=r.pendingProps,h=r.elementType===a?h:ia(a,h),m5(e,r,a,h,s);case 3:t:{if(o6(r),e===null)throw Error(Te(387));a=r.pendingProps,f=r.memoizedState,h=f.element,Ij(e,r),Fv(r,a,null,s);var m=r.memoizedState;if(a=m.element,f.isDehydrated)if(f={element:a,isDehydrated:!1,cache:m.cache,pendingSuspenseBoundaries:m.pendingSuspenseBoundaries,transitions:m.transitions},r.updateQueue.baseState=f,r.memoizedState=f,r.flags&256){h=ff(Error(Te(423)),r),r=g5(e,r,a,s,h);break t}else if(a!==h){h=ff(Error(Te(424)),r),r=g5(e,r,a,s,h);break t}else for(ao=Xc(r.stateNode.containerInfo.firstChild),ho=r,Xr=!0,aa=null,s=Oj(r,null,a,s),r.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(uf(),a===h){r=Bl(e,r,s);break t}Ts(e,r,a,s)}r=r.child}return r;case 5:return Lj(r),e===null&&FE(r),a=r.type,h=r.pendingProps,f=e!==null?e.memoizedProps:null,m=h.children,RE(a,h)?m=null:f!==null&&RE(a,f)&&(r.flags|=32),s6(e,r),Ts(e,r,m,s),r.child;case 6:return e===null&&FE(r),null;case 13:return a6(e,r,s);case 4:return NA(r,r.stateNode.containerInfo),a=r.pendingProps,e===null?r.child=hf(r,null,a,s):Ts(e,r,a,s),r.child;case 11:return a=r.type,h=r.pendingProps,h=r.elementType===a?h:ia(a,h),f5(e,r,a,h,s);case 7:return Ts(e,r,r.pendingProps,s),r.child;case 8:return Ts(e,r,r.pendingProps.children,s),r.child;case 12:return Ts(e,r,r.pendingProps.children,s),r.child;case 10:t:{if(a=r.type._context,h=r.pendingProps,f=r.memoizedProps,m=h.value,zr(zv,a._currentValue),a._currentValue=m,f!==null)if(ga(f.value,m)){if(f.children===h.children&&!Gs.current){r=Bl(e,r,s);break t}}else for(f=r.child,f!==null&&(f.return=r);f!==null;){var y=f.dependencies;if(y!==null){m=f.child;for(var x=y.firstContext;x!==null;){if(x.context===a){if(f.tag===1){x=kl(-1,s&-s),x.tag=2;var w=f.updateQueue;if(w!==null){w=w.shared;var T=w.pending;T===null?x.next=x:(x.next=T.next,T.next=x),w.pending=x}}f.lanes|=s,x=f.alternate,x!==null&&(x.lanes|=s),BE(f.return,s,r),y.lanes|=s;break}x=x.next}}else if(f.tag===10)m=f.type===r.type?null:f.child;else if(f.tag===18){if(m=f.return,m===null)throw Error(Te(341));m.lanes|=s,y=m.alternate,y!==null&&(y.lanes|=s),BE(m,s,r),m=f.sibling}else m=f.child;if(m!==null)m.return=f;else for(m=f;m!==null;){if(m===r){m=null;break}if(f=m.sibling,f!==null){f.return=m.return,m=f;break}m=m.return}f=m}Ts(e,r,h.children,s),r=r.child}return r;case 9:return h=r.type,a=r.pendingProps.children,sf(r,s),h=Vo(h),a=a(h),r.flags|=1,Ts(e,r,a,s),r.child;case 14:return a=r.type,h=ia(a,r.pendingProps),h=ia(a.type,h),p5(e,r,a,h,s);case 15:return r6(e,r,r.type,r.pendingProps,s);case 17:return a=r.type,h=r.pendingProps,h=r.elementType===a?h:ia(a,h),Y0(e,r),r.tag=1,Ws(a)?(e=!0,Rv(r)):e=!1,sf(r,s),Dj(r,a,h),VE(r,a,h,s),GE(null,r,a,!0,e,s);case 19:return l6(e,r,s);case 22:return i6(e,r,s)}throw Error(Te(156,r.tag))};function T6(e,r){return YB(e,r)}function DJ(e,r,s,a){this.tag=e,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function No(e,r,s,a){return new DJ(e,r,s,a)}function JA(e){return e=e.prototype,!(!e||!e.isReactComponent)}function RJ(e){if(typeof e=="function")return JA(e)?1:0;if(e!=null){if(e=e.$$typeof,e===_A)return 11;if(e===yA)return 14}return 2}function Qc(e,r){var s=e.alternate;return s===null?(s=No(e.tag,r,e.key,e.mode),s.elementType=e.elementType,s.type=e.type,s.stateNode=e.stateNode,s.alternate=e,e.alternate=s):(s.pendingProps=r,s.type=e.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=e.flags&14680064,s.childLanes=e.childLanes,s.lanes=e.lanes,s.child=e.child,s.memoizedProps=e.memoizedProps,s.memoizedState=e.memoizedState,s.updateQueue=e.updateQueue,r=e.dependencies,s.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},s.sibling=e.sibling,s.index=e.index,s.ref=e.ref,s}function Q0(e,r,s,a,h,f){var m=2;if(a=e,typeof e=="function")JA(e)&&(m=1);else if(typeof e=="string")m=5;else t:switch(e){case Bd:return mh(s.children,h,f,r);case gA:m=8,h|=8;break;case hE:return e=No(12,s,r,h|2),e.elementType=hE,e.lanes=f,e;case dE:return e=No(13,s,r,h),e.elementType=dE,e.lanes=f,e;case fE:return e=No(19,s,r,h),e.elementType=fE,e.lanes=f,e;case RB:return Lx(s,h,f,r);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case kB:m=10;break t;case DB:m=9;break t;case _A:m=11;break t;case yA:m=14;break t;case kc:m=16,a=null;break t}throw Error(Te(130,e==null?e:typeof e,""))}return r=No(m,s,r,h),r.elementType=e,r.type=a,r.lanes=f,r}function mh(e,r,s,a){return e=No(7,e,a,r),e.lanes=s,e}function Lx(e,r,s,a){return e=No(22,e,a,r),e.elementType=RB,e.lanes=s,e.stateNode={isHidden:!1},e}function gT(e,r,s){return e=No(6,e,null,r),e.lanes=s,e}function _T(e,r,s){return r=No(4,e.children!==null?e.children:[],e.key,r),r.lanes=s,r.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},r}function OJ(e,r,s,a,h){this.tag=r,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=KS(0),this.expirationTimes=KS(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=KS(0),this.identifierPrefix=a,this.onRecoverableError=h,this.mutableSourceEagerHydrationData=null}function QA(e,r,s,a,h,f,m,y,x){return e=new OJ(e,r,s,y,x),r===1?(r=1,f===!0&&(r|=8)):r=0,f=No(3,null,null,r),e.current=f,f.stateNode=e,f.memoizedState={element:a,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},zA(f),e}function LJ(e,r,s){var a=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Fd,key:a==null?null:""+a,children:e,containerInfo:r,implementation:s}}function E6(e){if(!e)return ou;e=e._reactInternals;t:{if(kh(e)!==e||e.tag!==1)throw Error(Te(170));var r=e;do{switch(r.tag){case 3:r=r.stateNode.context;break t;case 1:if(Ws(r.type)){r=r.stateNode.__reactInternalMemoizedMergedChildContext;break t}}r=r.return}while(r!==null);throw Error(Te(171))}if(e.tag===1){var s=e.type;if(Ws(s))return Tj(e,s,r)}return r}function M6(e,r,s,a,h,f,m,y,x){return e=QA(s,a,!0,e,h,f,m,y,x),e.context=E6(null),s=e.current,a=Ms(),h=Jc(s),f=kl(a,h),f.callback=r??null,Yc(s,f,h),e.current.lanes=h,wg(e,h,a),Hs(e,a),e}function zx(e,r,s,a){var h=r.current,f=Ms(),m=Jc(h);return s=E6(s),r.context===null?r.context=s:r.pendingContext=s,r=kl(f,m),r.payload={element:e},a=a===void 0?null:a,a!==null&&(r.callback=a),e=Yc(h,r,m),e!==null&&(fa(e,h,m,f),q0(e,h,m)),m}function Hv(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function M5(e,r){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var s=e.retryLane;e.retryLane=s!==0&&s<r?s:r}}function tC(e,r){M5(e,r),(e=e.alternate)&&M5(e,r)}function zJ(){return null}var A6=typeof reportError=="function"?reportError:function(e){console.error(e)};function eC(e){this._internalRoot=e}Nx.prototype.render=eC.prototype.render=function(e){var r=this._internalRoot;if(r===null)throw Error(Te(409));zx(e,r,null,null)};Nx.prototype.unmount=eC.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var r=e.containerInfo;Eh(function(){zx(null,e,null,null)}),r[Nl]=null}};function Nx(e){this._internalRoot=e}Nx.prototype.unstable_scheduleHydration=function(e){if(e){var r=rj();e={blockedOn:null,target:e,priority:r};for(var s=0;s<Oc.length&&r!==0&&r<Oc[s].priority;s++);Oc.splice(s,0,e),s===0&&sj(e)}};function nC(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Fx(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function A5(){}function NJ(e,r,s,a,h){if(h){if(typeof a=="function"){var f=a;a=function(){var w=Hv(m);f.call(w)}}var m=M6(r,a,e,0,null,!1,!1,"",A5);return e._reactRootContainer=m,e[Nl]=m.current,Wm(e.nodeType===8?e.parentNode:e),Eh(),m}for(;h=e.lastChild;)e.removeChild(h);if(typeof a=="function"){var y=a;a=function(){var w=Hv(x);y.call(w)}}var x=QA(e,0,!1,null,null,!1,!1,"",A5);return e._reactRootContainer=x,e[Nl]=x.current,Wm(e.nodeType===8?e.parentNode:e),Eh(function(){zx(r,x,s,a)}),x}function Bx(e,r,s,a,h){var f=s._reactRootContainer;if(f){var m=f;if(typeof h=="function"){var y=h;h=function(){var x=Hv(m);y.call(x)}}zx(r,m,e,h)}else m=NJ(s,r,e,h,a);return Hv(m)}ej=function(e){switch(e.tag){case 3:var r=e.stateNode;if(r.current.memoizedState.isDehydrated){var s=om(r.pendingLanes);s!==0&&(bA(r,s|1),Hs(r,wi()),!(ir&6)&&(pf=wi()+500,gu()))}break;case 13:Eh(function(){var a=Fl(e,1);if(a!==null){var h=Ms();fa(a,e,1,h)}}),tC(e,1)}};wA=function(e){if(e.tag===13){var r=Fl(e,134217728);if(r!==null){var s=Ms();fa(r,e,134217728,s)}tC(e,134217728)}};nj=function(e){if(e.tag===13){var r=Jc(e),s=Fl(e,r);if(s!==null){var a=Ms();fa(s,e,r,a)}tC(e,r)}};rj=function(){return br};ij=function(e,r){var s=br;try{return br=e,r()}finally{br=s}};SE=function(e,r,s){switch(r){case"input":if(gE(e,s),r=s.name,s.type==="radio"&&r!=null){for(s=e;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+r)+'][type="radio"]'),r=0;r<s.length;r++){var a=s[r];if(a!==e&&a.form===e.form){var h=Px(a);if(!h)throw Error(Te(90));LB(a),gE(a,h)}}}break;case"textarea":NB(e,s);break;case"select":r=s.value,r!=null&&tf(e,!!s.multiple,r,!1)}};GB=XA;WB=Eh;var FJ={usingClientEntryPoint:!1,Events:[Tg,$d,Px,UB,$B,XA]},Wp={findFiberByHostInstance:ah,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},BJ={bundleType:Wp.bundleType,version:Wp.version,rendererPackageName:Wp.rendererPackageName,rendererConfig:Wp.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ul.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=ZB(e),e===null?null:e.stateNode},findFiberByHostInstance:Wp.findFiberByHostInstance||zJ,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var c0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!c0.isDisabled&&c0.supportsFiber)try{Ex=c0.inject(BJ),$a=c0}catch{}}_o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=FJ;_o.createPortal=function(e,r){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!nC(r))throw Error(Te(200));return LJ(e,r,null,s)};_o.createRoot=function(e,r){if(!nC(e))throw Error(Te(299));var s=!1,a="",h=A6;return r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(h=r.onRecoverableError)),r=QA(e,1,!1,null,null,s,!1,a,h),e[Nl]=r.current,Wm(e.nodeType===8?e.parentNode:e),new eC(r)};_o.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var r=e._reactInternals;if(r===void 0)throw typeof e.render=="function"?Error(Te(188)):(e=Object.keys(e).join(","),Error(Te(268,e)));return e=ZB(r),e=e===null?null:e.stateNode,e};_o.flushSync=function(e){return Eh(e)};_o.hydrate=function(e,r,s){if(!Fx(r))throw Error(Te(200));return Bx(null,e,r,!0,s)};_o.hydrateRoot=function(e,r,s){if(!nC(e))throw Error(Te(405));var a=s!=null&&s.hydratedSources||null,h=!1,f="",m=A6;if(s!=null&&(s.unstable_strictMode===!0&&(h=!0),s.identifierPrefix!==void 0&&(f=s.identifierPrefix),s.onRecoverableError!==void 0&&(m=s.onRecoverableError)),r=M6(r,null,e,1,s??null,h,!1,f,m),e[Nl]=r.current,Wm(e),a)for(e=0;e<a.length;e++)s=a[e],h=s._getVersion,h=h(s._source),r.mutableSourceEagerHydrationData==null?r.mutableSourceEagerHydrationData=[s,h]:r.mutableSourceEagerHydrationData.push(s,h);return new Nx(r)};_o.render=function(e,r,s){if(!Fx(r))throw Error(Te(200));return Bx(null,e,r,!1,s)};_o.unmountComponentAtNode=function(e){if(!Fx(e))throw Error(Te(40));return e._reactRootContainer?(Eh(function(){Bx(null,null,e,!1,function(){e._reactRootContainer=null,e[Nl]=null})}),!0):!1};_o.unstable_batchedUpdates=XA;_o.unstable_renderSubtreeIntoContainer=function(e,r,s,a){if(!Fx(s))throw Error(Te(200));if(e==null||e._reactInternals===void 0)throw Error(Te(38));return Bx(e,r,s,!1,a)};_o.version="18.2.0-next-9e3b772b8-20220608";function C6(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(C6)}catch(e){console.error(e)}}C6(),MB.exports=_o;var P6=MB.exports,C5=P6;cE.createRoot=C5.createRoot,cE.hydrateRoot=C5.hydrateRoot;const Za=Object.create(null);Za.open="0";Za.close="1";Za.ping="2";Za.pong="3";Za.message="4";Za.upgrade="5";Za.noop="6";const tv=Object.create(null);Object.keys(Za).forEach(e=>{tv[Za[e]]=e});const nM={type:"error",data:"parser error"},I6=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",k6=typeof ArrayBuffer=="function",D6=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,rC=({type:e,data:r},s,a)=>I6&&r instanceof Blob?s?a(r):P5(r,a):k6&&(r instanceof ArrayBuffer||D6(r))?s?a(r):P5(new Blob([r]),a):a(Za[e]+(r||"")),P5=(e,r)=>{const s=new FileReader;return s.onload=function(){const a=s.result.split(",")[1];r("b"+(a||""))},s.readAsDataURL(e)};function I5(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let yT;function jJ(e,r){if(I6&&e.data instanceof Blob)return e.data.arrayBuffer().then(I5).then(r);if(k6&&(e.data instanceof ArrayBuffer||D6(e.data)))return r(I5(e.data));rC(e,!1,s=>{yT||(yT=new TextEncoder),r(yT.encode(s))})}const k5="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lm=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let e=0;e<k5.length;e++)lm[k5.charCodeAt(e)]=e;const VJ=e=>{let r=e.length*.75,s=e.length,a,h=0,f,m,y,x;e[e.length-1]==="="&&(r--,e[e.length-2]==="="&&r--);const w=new ArrayBuffer(r),T=new Uint8Array(w);for(a=0;a<s;a+=4)f=lm[e.charCodeAt(a)],m=lm[e.charCodeAt(a+1)],y=lm[e.charCodeAt(a+2)],x=lm[e.charCodeAt(a+3)],T[h++]=f<<2|m>>4,T[h++]=(m&15)<<4|y>>2,T[h++]=(y&3)<<6|x&63;return w},UJ=typeof ArrayBuffer=="function",iC=(e,r)=>{if(typeof e!="string")return{type:"message",data:R6(e,r)};const s=e.charAt(0);return s==="b"?{type:"message",data:$J(e.substring(1),r)}:tv[s]?e.length>1?{type:tv[s],data:e.substring(1)}:{type:tv[s]}:nM},$J=(e,r)=>{if(UJ){const s=VJ(e);return R6(s,r)}else return{base64:!0,data:e}},R6=(e,r)=>{switch(r){case"blob":return e instanceof Blob?e:new Blob([e]);case"arraybuffer":default:return e instanceof ArrayBuffer?e:e.buffer}},O6="",GJ=(e,r)=>{const s=e.length,a=new Array(s);let h=0;e.forEach((f,m)=>{rC(f,!1,y=>{a[m]=y,++h===s&&r(a.join(O6))})})},WJ=(e,r)=>{const s=e.split(O6),a=[];for(let h=0;h<s.length;h++){const f=iC(s[h],r);if(a.push(f),f.type==="error")break}return a};function HJ(){return new TransformStream({transform(e,r){jJ(e,s=>{const a=s.length;let h;if(a<126)h=new Uint8Array(1),new DataView(h.buffer).setUint8(0,a);else if(a<65536){h=new Uint8Array(3);const f=new DataView(h.buffer);f.setUint8(0,126),f.setUint16(1,a)}else{h=new Uint8Array(9);const f=new DataView(h.buffer);f.setUint8(0,127),f.setBigUint64(1,BigInt(a))}e.data&&typeof e.data!="string"&&(h[0]|=128),r.enqueue(h),r.enqueue(s)})}})}let vT;function u0(e){return e.reduce((r,s)=>r+s.length,0)}function h0(e,r){if(e[0].length===r)return e.shift();const s=new Uint8Array(r);let a=0;for(let h=0;h<r;h++)s[h]=e[0][a++],a===e[0].length&&(e.shift(),a=0);return e.length&&a<e[0].length&&(e[0]=e[0].slice(a)),s}function qJ(e,r){vT||(vT=new TextDecoder);const s=[];let a=0,h=-1,f=!1;return new TransformStream({transform(m,y){for(s.push(m);;){if(a===0){if(u0(s)<1)break;const x=h0(s,1);f=(x[0]&128)===128,h=x[0]&127,h<126?a=3:h===126?a=1:a=2}else if(a===1){if(u0(s)<2)break;const x=h0(s,2);h=new DataView(x.buffer,x.byteOffset,x.length).getUint16(0),a=3}else if(a===2){if(u0(s)<8)break;const x=h0(s,8),w=new DataView(x.buffer,x.byteOffset,x.length),T=w.getUint32(0);if(T>Math.pow(2,21)-1){y.enqueue(nM);break}h=T*Math.pow(2,32)+w.getUint32(4),a=3}else{if(u0(s)<h)break;const x=h0(s,h);y.enqueue(iC(f?x:vT.decode(x),r)),a=0}if(h===0||h>e){y.enqueue(nM);break}}}})}const L6=4;function ki(e){if(e)return ZJ(e)}function ZJ(e){for(var r in ki.prototype)e[r]=ki.prototype[r];return e}ki.prototype.on=ki.prototype.addEventListener=function(e,r){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(r),this};ki.prototype.once=function(e,r){function s(){this.off(e,s),r.apply(this,arguments)}return s.fn=r,this.on(e,s),this};ki.prototype.off=ki.prototype.removeListener=ki.prototype.removeAllListeners=ki.prototype.removeEventListener=function(e,r){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var s=this._callbacks["$"+e];if(!s)return this;if(arguments.length==1)return delete this._callbacks["$"+e],this;for(var a,h=0;h<s.length;h++)if(a=s[h],a===r||a.fn===r){s.splice(h,1);break}return s.length===0&&delete this._callbacks["$"+e],this};ki.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var r=new Array(arguments.length-1),s=this._callbacks["$"+e],a=1;a<arguments.length;a++)r[a-1]=arguments[a];if(s){s=s.slice(0);for(var a=0,h=s.length;a<h;++a)s[a].apply(this,r)}return this};ki.prototype.emitReserved=ki.prototype.emit;ki.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]};ki.prototype.hasListeners=function(e){return!!this.listeners(e).length};const zo=typeof self<"u"?self:typeof window<"u"?window:Function("return this")();function z6(e,...r){return r.reduce((s,a)=>(e.hasOwnProperty(a)&&(s[a]=e[a]),s),{})}const XJ=zo.setTimeout,YJ=zo.clearTimeout;function jx(e,r){r.useNativeTimers?(e.setTimeoutFn=XJ.bind(zo),e.clearTimeoutFn=YJ.bind(zo)):(e.setTimeoutFn=zo.setTimeout.bind(zo),e.clearTimeoutFn=zo.clearTimeout.bind(zo))}const KJ=1.33;function JJ(e){return typeof e=="string"?QJ(e):Math.ceil((e.byteLength||e.size)*KJ)}function QJ(e){let r=0,s=0;for(let a=0,h=e.length;a<h;a++)r=e.charCodeAt(a),r<128?s+=1:r<2048?s+=2:r<55296||r>=57344?s+=3:(a++,s+=4);return s}function tQ(e){let r="";for(let s in e)e.hasOwnProperty(s)&&(r.length&&(r+="&"),r+=encodeURIComponent(s)+"="+encodeURIComponent(e[s]));return r}function eQ(e){let r={},s=e.split("&");for(let a=0,h=s.length;a<h;a++){let f=s[a].split("=");r[decodeURIComponent(f[0])]=decodeURIComponent(f[1])}return r}class nQ extends Error{constructor(r,s,a){super(r),this.description=s,this.context=a,this.type="TransportError"}}class sC extends ki{constructor(r){super(),this.writable=!1,jx(this,r),this.opts=r,this.query=r.query,this.socket=r.socket}onError(r,s,a){return super.emitReserved("error",new nQ(r,s,a)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(r){this.readyState==="open"&&this.write(r)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(r){const s=iC(r,this.socket.binaryType);this.onPacket(s)}onPacket(r){super.emitReserved("packet",r)}onClose(r){this.readyState="closed",super.emitReserved("close",r)}pause(r){}createUri(r,s={}){return r+"://"+this._hostname()+this._port()+this.opts.path+this._query(s)}_hostname(){const r=this.opts.hostname;return r.indexOf(":")===-1?r:"["+r+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(r){const s=tQ(r);return s.length?"?"+s:""}}const N6="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),rM=64,rQ={};let D5=0,d0=0,R5;function O5(e){let r="";do r=N6[e%rM]+r,e=Math.floor(e/rM);while(e>0);return r}function F6(){const e=O5(+new Date);return e!==R5?(D5=0,R5=e):e+"."+O5(D5++)}for(;d0<rM;d0++)rQ[N6[d0]]=d0;let B6=!1;try{B6=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const iQ=B6;function j6(e){const r=e.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!r||iQ))return new XMLHttpRequest}catch{}if(!r)try{return new zo[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}function sQ(){}const oQ=function(){return new j6({xdomain:!1}).responseType!=null}();class aQ extends sC{constructor(r){if(super(r),this.polling=!1,typeof location<"u"){const a=location.protocol==="https:";let h=location.port;h||(h=a?"443":"80"),this.xd=typeof location<"u"&&r.hostname!==location.hostname||h!==r.port}const s=r&&r.forceBase64;this.supportsBinary=oQ&&!s,this.opts.withCredentials&&(this.cookieJar=void 0)}get name(){return"polling"}doOpen(){this.poll()}pause(r){this.readyState="pausing";const s=()=>{this.readyState="paused",r()};if(this.polling||!this.writable){let a=0;this.polling&&(a++,this.once("pollComplete",function(){--a||s()})),this.writable||(a++,this.once("drain",function(){--a||s()}))}else s()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(r){const s=a=>{if(this.readyState==="opening"&&a.type==="open"&&this.onOpen(),a.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(a)};WJ(r,this.socket.binaryType).forEach(s),this.readyState!=="closed"&&(this.polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this.poll())}doClose(){const r=()=>{this.write([{type:"close"}])};this.readyState==="open"?r():this.once("open",r)}write(r){this.writable=!1,GJ(r,s=>{this.doWrite(s,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const r=this.opts.secure?"https":"http",s=this.query||{};return this.opts.timestampRequests!==!1&&(s[this.opts.timestampParam]=F6()),!this.supportsBinary&&!s.sid&&(s.b64=1),this.createUri(r,s)}request(r={}){return Object.assign(r,{xd:this.xd,cookieJar:this.cookieJar},this.opts),new Wa(this.uri(),r)}doWrite(r,s){const a=this.request({method:"POST",data:r});a.on("success",s),a.on("error",(h,f)=>{this.onError("xhr post error",h,f)})}doPoll(){const r=this.request();r.on("data",this.onData.bind(this)),r.on("error",(s,a)=>{this.onError("xhr poll error",s,a)}),this.pollXhr=r}}class Wa extends ki{constructor(r,s){super(),jx(this,s),this.opts=s,this.method=s.method||"GET",this.uri=r,this.data=s.data!==void 0?s.data:null,this.create()}create(){var r;const s=z6(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");s.xdomain=!!this.opts.xd;const a=this.xhr=new j6(s);try{a.open(this.method,this.uri,!0);try{if(this.opts.extraHeaders){a.setDisableHeaderCheck&&a.setDisableHeaderCheck(!0);for(let h in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(h)&&a.setRequestHeader(h,this.opts.extraHeaders[h])}}catch{}if(this.method==="POST")try{a.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{a.setRequestHeader("Accept","*/*")}catch{}(r=this.opts.cookieJar)===null||r===void 0||r.addCookies(a),"withCredentials"in a&&(a.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(a.timeout=this.opts.requestTimeout),a.onreadystatechange=()=>{var h;a.readyState===3&&((h=this.opts.cookieJar)===null||h===void 0||h.parseCookies(a)),a.readyState===4&&(a.status===200||a.status===1223?this.onLoad():this.setTimeoutFn(()=>{this.onError(typeof a.status=="number"?a.status:0)},0))},a.send(this.data)}catch(h){this.setTimeoutFn(()=>{this.onError(h)},0);return}typeof document<"u"&&(this.index=Wa.requestsCount++,Wa.requests[this.index]=this)}onError(r){this.emitReserved("error",r,this.xhr),this.cleanup(!0)}cleanup(r){if(!(typeof this.xhr>"u"||this.xhr===null)){if(this.xhr.onreadystatechange=sQ,r)try{this.xhr.abort()}catch{}typeof document<"u"&&delete Wa.requests[this.index],this.xhr=null}}onLoad(){const r=this.xhr.responseText;r!==null&&(this.emitReserved("data",r),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}Wa.requestsCount=0;Wa.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",L5);else if(typeof addEventListener=="function"){const e="onpagehide"in zo?"pagehide":"unload";addEventListener(e,L5,!1)}}function L5(){for(let e in Wa.requests)Wa.requests.hasOwnProperty(e)&&Wa.requests[e].abort()}const oC=typeof Promise=="function"&&typeof Promise.resolve=="function"?r=>Promise.resolve().then(r):(r,s)=>s(r,0),f0=zo.WebSocket||zo.MozWebSocket,z5=!0,lQ="arraybuffer",N5=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class cQ extends sC{constructor(r){super(r),this.supportsBinary=!r.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const r=this.uri(),s=this.opts.protocols,a=N5?{}:z6(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(a.headers=this.opts.extraHeaders);try{this.ws=z5&&!N5?s?new f0(r,s):new f0(r):new f0(r,s,a)}catch(h){return this.emitReserved("error",h)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=r=>this.onClose({description:"websocket connection closed",context:r}),this.ws.onmessage=r=>this.onData(r.data),this.ws.onerror=r=>this.onError("websocket error",r)}write(r){this.writable=!1;for(let s=0;s<r.length;s++){const a=r[s],h=s===r.length-1;rC(a,this.supportsBinary,f=>{const m={};try{z5&&this.ws.send(f)}catch{}h&&oC(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.close(),this.ws=null)}uri(){const r=this.opts.secure?"wss":"ws",s=this.query||{};return this.opts.timestampRequests&&(s[this.opts.timestampParam]=F6()),this.supportsBinary||(s.b64=1),this.createUri(r,s)}check(){return!!f0}}class uQ extends sC{get name(){return"webtransport"}doOpen(){typeof WebTransport=="function"&&(this.transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name]),this.transport.closed.then(()=>{this.onClose()}).catch(r=>{this.onError("webtransport error",r)}),this.transport.ready.then(()=>{this.transport.createBidirectionalStream().then(r=>{const s=qJ(Number.MAX_SAFE_INTEGER,this.socket.binaryType),a=r.readable.pipeThrough(s).getReader(),h=HJ();h.readable.pipeTo(r.writable),this.writer=h.writable.getWriter();const f=()=>{a.read().then(({done:y,value:x})=>{y||(this.onPacket(x),f())}).catch(y=>{})};f();const m={type:"open"};this.query.sid&&(m.data=`{"sid":"${this.query.sid}"}`),this.writer.write(m).then(()=>this.onOpen())})}))}write(r){this.writable=!1;for(let s=0;s<r.length;s++){const a=r[s],h=s===r.length-1;this.writer.write(a).then(()=>{h&&oC(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var r;(r=this.transport)===null||r===void 0||r.close()}}const hQ={websocket:cQ,webtransport:uQ,polling:aQ},dQ=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,fQ=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function iM(e){if(e.length>2e3)throw"URI too long";const r=e,s=e.indexOf("["),a=e.indexOf("]");s!=-1&&a!=-1&&(e=e.substring(0,s)+e.substring(s,a).replace(/:/g,";")+e.substring(a,e.length));let h=dQ.exec(e||""),f={},m=14;for(;m--;)f[fQ[m]]=h[m]||"";return s!=-1&&a!=-1&&(f.source=r,f.host=f.host.substring(1,f.host.length-1).replace(/;/g,":"),f.authority=f.authority.replace("[","").replace("]","").replace(/;/g,":"),f.ipv6uri=!0),f.pathNames=pQ(f,f.path),f.queryKey=mQ(f,f.query),f}function pQ(e,r){const s=/\/{2,9}/g,a=r.replace(s,"/").split("/");return(r.slice(0,1)=="/"||r.length===0)&&a.splice(0,1),r.slice(-1)=="/"&&a.splice(a.length-1,1),a}function mQ(e,r){const s={};return r.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(a,h,f){h&&(s[h]=f)}),s}let V6=class Nd extends ki{constructor(r,s={}){super(),this.binaryType=lQ,this.writeBuffer=[],r&&typeof r=="object"&&(s=r,r=null),r?(r=iM(r),s.hostname=r.host,s.secure=r.protocol==="https"||r.protocol==="wss",s.port=r.port,r.query&&(s.query=r.query)):s.host&&(s.hostname=iM(s.host).host),jx(this,s),this.secure=s.secure!=null?s.secure:typeof location<"u"&&location.protocol==="https:",s.hostname&&!s.port&&(s.port=this.secure?"443":"80"),this.hostname=s.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=s.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=s.transports||["polling","websocket","webtransport"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},s),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=eQ(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,typeof addEventListener=="function"&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(r){const s=Object.assign({},this.opts.query);s.EIO=L6,s.transport=r,this.id&&(s.sid=this.id);const a=Object.assign({},this.opts,{query:s,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[r]);return new hQ[r](a)}open(){let r;if(this.opts.rememberUpgrade&&Nd.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)r="websocket";else if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}else r=this.transports[0];this.readyState="opening";try{r=this.createTransport(r)}catch{this.transports.shift(),this.open();return}r.open(),this.setTransport(r)}setTransport(r){this.transport&&this.transport.removeAllListeners(),this.transport=r,r.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",s=>this.onClose("transport close",s))}probe(r){let s=this.createTransport(r),a=!1;Nd.priorWebsocketSuccess=!1;const h=()=>{a||(s.send([{type:"ping",data:"probe"}]),s.once("packet",M=>{if(!a)if(M.type==="pong"&&M.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",s),!s)return;Nd.priorWebsocketSuccess=s.name==="websocket",this.transport.pause(()=>{a||this.readyState!=="closed"&&(T(),this.setTransport(s),s.send([{type:"upgrade"}]),this.emitReserved("upgrade",s),s=null,this.upgrading=!1,this.flush())})}else{const I=new Error("probe error");I.transport=s.name,this.emitReserved("upgradeError",I)}}))};function f(){a||(a=!0,T(),s.close(),s=null)}const m=M=>{const I=new Error("probe error: "+M);I.transport=s.name,f(),this.emitReserved("upgradeError",I)};function y(){m("transport closed")}function x(){m("socket closed")}function w(M){s&&M.name!==s.name&&f()}const T=()=>{s.removeListener("open",h),s.removeListener("error",m),s.removeListener("close",y),this.off("close",x),this.off("upgrading",w)};s.once("open",h),s.once("error",m),s.once("close",y),this.once("close",x),this.once("upgrading",w),this.upgrades.indexOf("webtransport")!==-1&&r!=="webtransport"?this.setTimeoutFn(()=>{a||s.open()},200):s.open()}onOpen(){if(this.readyState="open",Nd.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush(),this.readyState==="open"&&this.opts.upgrade){let r=0;const s=this.upgrades.length;for(;r<s;r++)this.probe(this.upgrades[r])}}onPacket(r){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",r),this.emitReserved("heartbeat"),this.resetPingTimeout(),r.type){case"open":this.onHandshake(JSON.parse(r.data));break;case"ping":this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const s=new Error("server error");s.code=r.data,this.onError(s);break;case"message":this.emitReserved("data",r.data),this.emitReserved("message",r.data);break}}onHandshake(r){this.emitReserved("handshake",r),this.id=r.sid,this.transport.query.sid=r.sid,this.upgrades=this.filterUpgrades(r.upgrades),this.pingInterval=r.pingInterval,this.pingTimeout=r.pingTimeout,this.maxPayload=r.maxPayload,this.onOpen(),this.readyState!=="closed"&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const r=this.getWritablePackets();this.transport.send(r),this.prevBufferLen=r.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let s=1;for(let a=0;a<this.writeBuffer.length;a++){const h=this.writeBuffer[a].data;if(h&&(s+=JJ(h)),a>0&&s>this.maxPayload)return this.writeBuffer.slice(0,a);s+=2}return this.writeBuffer}write(r,s,a){return this.sendPacket("message",r,s,a),this}send(r,s,a){return this.sendPacket("message",r,s,a),this}sendPacket(r,s,a,h){if(typeof s=="function"&&(h=s,s=void 0),typeof a=="function"&&(h=a,a=null),this.readyState==="closing"||this.readyState==="closed")return;a=a||{},a.compress=a.compress!==!1;const f={type:r,data:s,options:a};this.emitReserved("packetCreate",f),this.writeBuffer.push(f),h&&this.once("flush",h),this.flush()}close(){const r=()=>{this.onClose("forced close"),this.transport.close()},s=()=>{this.off("upgrade",s),this.off("upgradeError",s),r()},a=()=>{this.once("upgrade",s),this.once("upgradeError",s)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?a():r()}):this.upgrading?a():r()),this}onError(r){Nd.priorWebsocketSuccess=!1,this.emitReserved("error",r),this.onClose("transport error",r)}onClose(r,s){(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")&&(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),typeof removeEventListener=="function"&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",r,s),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(r){const s=[];let a=0;const h=r.length;for(;a<h;a++)~this.transports.indexOf(r[a])&&s.push(r[a]);return s}};V6.protocol=L6;function gQ(e,r="",s){let a=e;s=s||typeof location<"u"&&location,e==null&&(e=s.protocol+"//"+s.host),typeof e=="string"&&(e.charAt(0)==="/"&&(e.charAt(1)==="/"?e=s.protocol+e:e=s.host+e),/^(https?|wss?):\/\//.test(e)||(typeof s<"u"?e=s.protocol+"//"+e:e="https://"+e),a=iM(e)),a.port||(/^(http|ws)$/.test(a.protocol)?a.port="80":/^(http|ws)s$/.test(a.protocol)&&(a.port="443")),a.path=a.path||"/";const f=a.host.indexOf(":")!==-1?"["+a.host+"]":a.host;return a.id=a.protocol+"://"+f+":"+a.port+r,a.href=a.protocol+"://"+f+(s&&s.port===a.port?"":":"+a.port),a}const _Q=typeof ArrayBuffer=="function",yQ=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,U6=Object.prototype.toString,vQ=typeof Blob=="function"||typeof Blob<"u"&&U6.call(Blob)==="[object BlobConstructor]",xQ=typeof File=="function"||typeof File<"u"&&U6.call(File)==="[object FileConstructor]";function aC(e){return _Q&&(e instanceof ArrayBuffer||yQ(e))||vQ&&e instanceof Blob||xQ&&e instanceof File}function ev(e,r){if(!e||typeof e!="object")return!1;if(Array.isArray(e)){for(let s=0,a=e.length;s<a;s++)if(ev(e[s]))return!0;return!1}if(aC(e))return!0;if(e.toJSON&&typeof e.toJSON=="function"&&arguments.length===1)return ev(e.toJSON(),!0);for(const s in e)if(Object.prototype.hasOwnProperty.call(e,s)&&ev(e[s]))return!0;return!1}function bQ(e){const r=[],s=e.data,a=e;return a.data=sM(s,r),a.attachments=r.length,{packet:a,buffers:r}}function sM(e,r){if(!e)return e;if(aC(e)){const s={_placeholder:!0,num:r.length};return r.push(e),s}else if(Array.isArray(e)){const s=new Array(e.length);for(let a=0;a<e.length;a++)s[a]=sM(e[a],r);return s}else if(typeof e=="object"&&!(e instanceof Date)){const s={};for(const a in e)Object.prototype.hasOwnProperty.call(e,a)&&(s[a]=sM(e[a],r));return s}return e}function wQ(e,r){return e.data=oM(e.data,r),delete e.attachments,e}function oM(e,r){if(!e)return e;if(e&&e._placeholder===!0){if(typeof e.num=="number"&&e.num>=0&&e.num<r.length)return r[e.num];throw new Error("illegal attachments")}else if(Array.isArray(e))for(let s=0;s<e.length;s++)e[s]=oM(e[s],r);else if(typeof e=="object")for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&(e[s]=oM(e[s],r));return e}const SQ=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],TQ=5;var Kn;(function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"})(Kn||(Kn={}));class EQ{constructor(r){this.replacer=r}encode(r){return(r.type===Kn.EVENT||r.type===Kn.ACK)&&ev(r)?this.encodeAsBinary({type:r.type===Kn.EVENT?Kn.BINARY_EVENT:Kn.BINARY_ACK,nsp:r.nsp,data:r.data,id:r.id}):[this.encodeAsString(r)]}encodeAsString(r){let s=""+r.type;return(r.type===Kn.BINARY_EVENT||r.type===Kn.BINARY_ACK)&&(s+=r.attachments+"-"),r.nsp&&r.nsp!=="/"&&(s+=r.nsp+","),r.id!=null&&(s+=r.id),r.data!=null&&(s+=JSON.stringify(r.data,this.replacer)),s}encodeAsBinary(r){const s=bQ(r),a=this.encodeAsString(s.packet),h=s.buffers;return h.unshift(a),h}}function F5(e){return Object.prototype.toString.call(e)==="[object Object]"}class lC extends ki{constructor(r){super(),this.reviver=r}add(r){let s;if(typeof r=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");s=this.decodeString(r);const a=s.type===Kn.BINARY_EVENT;a||s.type===Kn.BINARY_ACK?(s.type=a?Kn.EVENT:Kn.ACK,this.reconstructor=new MQ(s),s.attachments===0&&super.emitReserved("decoded",s)):super.emitReserved("decoded",s)}else if(aC(r)||r.base64)if(this.reconstructor)s=this.reconstructor.takeBinaryData(r),s&&(this.reconstructor=null,super.emitReserved("decoded",s));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+r)}decodeString(r){let s=0;const a={type:Number(r.charAt(0))};if(Kn[a.type]===void 0)throw new Error("unknown packet type "+a.type);if(a.type===Kn.BINARY_EVENT||a.type===Kn.BINARY_ACK){const f=s+1;for(;r.charAt(++s)!=="-"&&s!=r.length;);const m=r.substring(f,s);if(m!=Number(m)||r.charAt(s)!=="-")throw new Error("Illegal attachments");a.attachments=Number(m)}if(r.charAt(s+1)==="/"){const f=s+1;for(;++s&&!(r.charAt(s)===","||s===r.length););a.nsp=r.substring(f,s)}else a.nsp="/";const h=r.charAt(s+1);if(h!==""&&Number(h)==h){const f=s+1;for(;++s;){const m=r.charAt(s);if(m==null||Number(m)!=m){--s;break}if(s===r.length)break}a.id=Number(r.substring(f,s+1))}if(r.charAt(++s)){const f=this.tryParse(r.substr(s));if(lC.isPayloadValid(a.type,f))a.data=f;else throw new Error("invalid payload")}return a}tryParse(r){try{return JSON.parse(r,this.reviver)}catch{return!1}}static isPayloadValid(r,s){switch(r){case Kn.CONNECT:return F5(s);case Kn.DISCONNECT:return s===void 0;case Kn.CONNECT_ERROR:return typeof s=="string"||F5(s);case Kn.EVENT:case Kn.BINARY_EVENT:return Array.isArray(s)&&(typeof s[0]=="number"||typeof s[0]=="string"&&SQ.indexOf(s[0])===-1);case Kn.ACK:case Kn.BINARY_ACK:return Array.isArray(s)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class MQ{constructor(r){this.packet=r,this.buffers=[],this.reconPack=r}takeBinaryData(r){if(this.buffers.push(r),this.buffers.length===this.reconPack.attachments){const s=wQ(this.reconPack,this.buffers);return this.finishedReconstruction(),s}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const AQ=Object.freeze(Object.defineProperty({__proto__:null,Decoder:lC,Encoder:EQ,get PacketType(){return Kn},protocol:TQ},Symbol.toStringTag,{value:"Module"}));function oa(e,r,s){return e.on(r,s),function(){e.off(r,s)}}const CQ=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class $6 extends ki{constructor(r,s,a){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=r,this.nsp=s,a&&a.auth&&(this.auth=a.auth),this._opts=Object.assign({},a),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const r=this.io;this.subs=[oa(r,"open",this.onopen.bind(this)),oa(r,"packet",this.onpacket.bind(this)),oa(r,"error",this.onerror.bind(this)),oa(r,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...r){return r.unshift("message"),this.emit.apply(this,r),this}emit(r,...s){if(CQ.hasOwnProperty(r))throw new Error('"'+r.toString()+'" is a reserved event name');if(s.unshift(r),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(s),this;const a={type:Kn.EVENT,data:s};if(a.options={},a.options.compress=this.flags.compress!==!1,typeof s[s.length-1]=="function"){const m=this.ids++,y=s.pop();this._registerAckCallback(m,y),a.id=m}const h=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!h||!this.connected)||(this.connected?(this.notifyOutgoingListeners(a),this.packet(a)):this.sendBuffer.push(a)),this.flags={},this}_registerAckCallback(r,s){var a;const h=(a=this.flags.timeout)!==null&&a!==void 0?a:this._opts.ackTimeout;if(h===void 0){this.acks[r]=s;return}const f=this.io.setTimeoutFn(()=>{delete this.acks[r];for(let m=0;m<this.sendBuffer.length;m++)this.sendBuffer[m].id===r&&this.sendBuffer.splice(m,1);s.call(this,new Error("operation has timed out"))},h);this.acks[r]=(...m)=>{this.io.clearTimeoutFn(f),s.apply(this,[null,...m])}}emitWithAck(r,...s){const a=this.flags.timeout!==void 0||this._opts.ackTimeout!==void 0;return new Promise((h,f)=>{s.push((m,y)=>a?m?f(m):h(y):h(m)),this.emit(r,...s)})}_addToQueue(r){let s;typeof r[r.length-1]=="function"&&(s=r.pop());const a={id:this._queueSeq++,tryCount:0,pending:!1,args:r,flags:Object.assign({fromQueue:!0},this.flags)};r.push((h,...f)=>a!==this._queue[0]?void 0:(h!==null?a.tryCount>this._opts.retries&&(this._queue.shift(),s&&s(h)):(this._queue.shift(),s&&s(null,...f)),a.pending=!1,this._drainQueue())),this._queue.push(a),this._drainQueue()}_drainQueue(r=!1){if(!this.connected||this._queue.length===0)return;const s=this._queue[0];s.pending&&!r||(s.pending=!0,s.tryCount++,this.flags=s.flags,this.emit.apply(this,s.args))}packet(r){r.nsp=this.nsp,this.io._packet(r)}onopen(){typeof this.auth=="function"?this.auth(r=>{this._sendConnectPacket(r)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(r){this.packet({type:Kn.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},r):r})}onerror(r){this.connected||this.emitReserved("connect_error",r)}onclose(r,s){this.connected=!1,delete this.id,this.emitReserved("disconnect",r,s)}onpacket(r){if(r.nsp===this.nsp)switch(r.type){case Kn.CONNECT:r.data&&r.data.sid?this.onconnect(r.data.sid,r.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Kn.EVENT:case Kn.BINARY_EVENT:this.onevent(r);break;case Kn.ACK:case Kn.BINARY_ACK:this.onack(r);break;case Kn.DISCONNECT:this.ondisconnect();break;case Kn.CONNECT_ERROR:this.destroy();const a=new Error(r.data.message);a.data=r.data.data,this.emitReserved("connect_error",a);break}}onevent(r){const s=r.data||[];r.id!=null&&s.push(this.ack(r.id)),this.connected?this.emitEvent(s):this.receiveBuffer.push(Object.freeze(s))}emitEvent(r){if(this._anyListeners&&this._anyListeners.length){const s=this._anyListeners.slice();for(const a of s)a.apply(this,r)}super.emit.apply(this,r),this._pid&&r.length&&typeof r[r.length-1]=="string"&&(this._lastOffset=r[r.length-1])}ack(r){const s=this;let a=!1;return function(...h){a||(a=!0,s.packet({type:Kn.ACK,id:r,data:h}))}}onack(r){const s=this.acks[r.id];typeof s=="function"&&(s.apply(this,r.data),delete this.acks[r.id])}onconnect(r,s){this.id=r,this.recovered=s&&this._pid===s,this._pid=s,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(r=>this.emitEvent(r)),this.receiveBuffer=[],this.sendBuffer.forEach(r=>{this.notifyOutgoingListeners(r),this.packet(r)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(r=>r()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Kn.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(r){return this.flags.compress=r,this}get volatile(){return this.flags.volatile=!0,this}timeout(r){return this.flags.timeout=r,this}onAny(r){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(r),this}prependAny(r){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(r),this}offAny(r){if(!this._anyListeners)return this;if(r){const s=this._anyListeners;for(let a=0;a<s.length;a++)if(r===s[a])return s.splice(a,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(r){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(r),this}prependAnyOutgoing(r){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(r),this}offAnyOutgoing(r){if(!this._anyOutgoingListeners)return this;if(r){const s=this._anyOutgoingListeners;for(let a=0;a<s.length;a++)if(r===s[a])return s.splice(a,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(r){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const s=this._anyOutgoingListeners.slice();for(const a of s)a.apply(this,r.data)}}}function Mf(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}Mf.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var r=Math.random(),s=Math.floor(r*this.jitter*e);e=Math.floor(r*10)&1?e+s:e-s}return Math.min(e,this.max)|0};Mf.prototype.reset=function(){this.attempts=0};Mf.prototype.setMin=function(e){this.ms=e};Mf.prototype.setMax=function(e){this.max=e};Mf.prototype.setJitter=function(e){this.jitter=e};class aM extends ki{constructor(r,s){var a;super(),this.nsps={},this.subs=[],r&&typeof r=="object"&&(s=r,r=void 0),s=s||{},s.path=s.path||"/socket.io",this.opts=s,jx(this,s),this.reconnection(s.reconnection!==!1),this.reconnectionAttempts(s.reconnectionAttempts||1/0),this.reconnectionDelay(s.reconnectionDelay||1e3),this.reconnectionDelayMax(s.reconnectionDelayMax||5e3),this.randomizationFactor((a=s.randomizationFactor)!==null&&a!==void 0?a:.5),this.backoff=new Mf({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(s.timeout==null?2e4:s.timeout),this._readyState="closed",this.uri=r;const h=s.parser||AQ;this.encoder=new h.Encoder,this.decoder=new h.Decoder,this._autoConnect=s.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(r){return arguments.length?(this._reconnection=!!r,this):this._reconnection}reconnectionAttempts(r){return r===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=r,this)}reconnectionDelay(r){var s;return r===void 0?this._reconnectionDelay:(this._reconnectionDelay=r,(s=this.backoff)===null||s===void 0||s.setMin(r),this)}randomizationFactor(r){var s;return r===void 0?this._randomizationFactor:(this._randomizationFactor=r,(s=this.backoff)===null||s===void 0||s.setJitter(r),this)}reconnectionDelayMax(r){var s;return r===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=r,(s=this.backoff)===null||s===void 0||s.setMax(r),this)}timeout(r){return arguments.length?(this._timeout=r,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(r){if(~this._readyState.indexOf("open"))return this;this.engine=new V6(this.uri,this.opts);const s=this.engine,a=this;this._readyState="opening",this.skipReconnect=!1;const h=oa(s,"open",function(){a.onopen(),r&&r()}),f=y=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",y),r?r(y):this.maybeReconnectOnOpen()},m=oa(s,"error",f);if(this._timeout!==!1){const y=this._timeout,x=this.setTimeoutFn(()=>{h(),f(new Error("timeout")),s.close()},y);this.opts.autoUnref&&x.unref(),this.subs.push(()=>{this.clearTimeoutFn(x)})}return this.subs.push(h),this.subs.push(m),this}connect(r){return this.open(r)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const r=this.engine;this.subs.push(oa(r,"ping",this.onping.bind(this)),oa(r,"data",this.ondata.bind(this)),oa(r,"error",this.onerror.bind(this)),oa(r,"close",this.onclose.bind(this)),oa(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(r){try{this.decoder.add(r)}catch(s){this.onclose("parse error",s)}}ondecoded(r){oC(()=>{this.emitReserved("packet",r)},this.setTimeoutFn)}onerror(r){this.emitReserved("error",r)}socket(r,s){let a=this.nsps[r];return a?this._autoConnect&&!a.active&&a.connect():(a=new $6(this,r,s),this.nsps[r]=a),a}_destroy(r){const s=Object.keys(this.nsps);for(const a of s)if(this.nsps[a].active)return;this._close()}_packet(r){const s=this.encoder.encode(r);for(let a=0;a<s.length;a++)this.engine.write(s[a],r.options)}cleanup(){this.subs.forEach(r=>r()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(r,s){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",r,s),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const r=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const s=this.backoff.duration();this._reconnecting=!0;const a=this.setTimeoutFn(()=>{r.skipReconnect||(this.emitReserved("reconnect_attempt",r.backoff.attempts),!r.skipReconnect&&r.open(h=>{h?(r._reconnecting=!1,r.reconnect(),this.emitReserved("reconnect_error",h)):r.onreconnect()}))},s);this.opts.autoUnref&&a.unref(),this.subs.push(()=>{this.clearTimeoutFn(a)})}}onreconnect(){const r=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",r)}}const Hp={};function Mm(e,r){typeof e=="object"&&(r=e,e=void 0),r=r||{};const s=gQ(e,r.path||"/socket.io"),a=s.source,h=s.id,f=s.path,m=Hp[h]&&f in Hp[h].nsps,y=r.forceNew||r["force new connection"]||r.multiplex===!1||m;let x;return y?x=new aM(a,r):(Hp[h]||(Hp[h]=new aM(a,r)),x=Hp[h]),s.query&&!r.query&&(r.query=s.queryKey),x.socket(s.path,r)}Object.assign(Mm,{Manager:aM,Socket:$6,io:Mm,connect:Mm});/**
 * @remix-run/router v1.14.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function tg(){return tg=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},tg.apply(this,arguments)}var Bc;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Bc||(Bc={}));const B5="popstate";function PQ(e){e===void 0&&(e={});function r(a,h){let{pathname:f,search:m,hash:y}=a.location;return lM("",{pathname:f,search:m,hash:y},h.state&&h.state.usr||null,h.state&&h.state.key||"default")}function s(a,h){return typeof h=="string"?h:qv(h)}return kQ(r,s,null,e)}function Di(e,r){if(e===!1||e===null||typeof e>"u")throw new Error(r)}function cC(e,r){if(!e){typeof console<"u"&&console.warn(r);try{throw new Error(r)}catch{}}}function IQ(){return Math.random().toString(36).substr(2,8)}function j5(e,r){return{usr:e.state,key:e.key,idx:r}}function lM(e,r,s,a){return s===void 0&&(s=null),tg({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof r=="string"?Af(r):r,{state:s,key:r&&r.key||a||IQ()})}function qv(e){let{pathname:r="/",search:s="",hash:a=""}=e;return s&&s!=="?"&&(r+=s.charAt(0)==="?"?s:"?"+s),a&&a!=="#"&&(r+=a.charAt(0)==="#"?a:"#"+a),r}function Af(e){let r={};if(e){let s=e.indexOf("#");s>=0&&(r.hash=e.substr(s),e=e.substr(0,s));let a=e.indexOf("?");a>=0&&(r.search=e.substr(a),e=e.substr(0,a)),e&&(r.pathname=e)}return r}function kQ(e,r,s,a){a===void 0&&(a={});let{window:h=document.defaultView,v5Compat:f=!1}=a,m=h.history,y=Bc.Pop,x=null,w=T();w==null&&(w=0,m.replaceState(tg({},m.state,{idx:w}),""));function T(){return(m.state||{idx:null}).idx}function M(){y=Bc.Pop;let G=T(),$=G==null?null:G-w;w=G,x&&x({action:y,location:N.location,delta:$})}function I(G,$){y=Bc.Push;let z=lM(N.location,G,$);s&&s(z,G),w=T()+1;let B=j5(z,w),H=N.createHref(z);try{m.pushState(B,"",H)}catch(K){if(K instanceof DOMException&&K.name==="DataCloneError")throw K;h.location.assign(H)}f&&x&&x({action:y,location:N.location,delta:1})}function R(G,$){y=Bc.Replace;let z=lM(N.location,G,$);s&&s(z,G),w=T();let B=j5(z,w),H=N.createHref(z);m.replaceState(B,"",H),f&&x&&x({action:y,location:N.location,delta:0})}function O(G){let $=h.location.origin!=="null"?h.location.origin:h.location.href,z=typeof G=="string"?G:qv(G);return Di($,"No window.location.(origin|href) available to create URL for href: "+z),new URL(z,$)}let N={get action(){return y},get location(){return e(h,m)},listen(G){if(x)throw new Error("A history only accepts one active listener");return h.addEventListener(B5,M),x=G,()=>{h.removeEventListener(B5,M),x=null}},createHref(G){return r(h,G)},createURL:O,encodeLocation(G){let $=O(G);return{pathname:$.pathname,search:$.search,hash:$.hash}},push:I,replace:R,go(G){return m.go(G)}};return N}var V5;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(V5||(V5={}));function DQ(e,r,s){s===void 0&&(s="/");let a=typeof r=="string"?Af(r):r,h=uC(a.pathname||"/",s);if(h==null)return null;let f=G6(e);RQ(f);let m=null;for(let y=0;m==null&&y<f.length;++y)m=UQ(f[y],WQ(h));return m}function G6(e,r,s,a){r===void 0&&(r=[]),s===void 0&&(s=[]),a===void 0&&(a="");let h=(f,m,y)=>{let x={relativePath:y===void 0?f.path||"":y,caseSensitive:f.caseSensitive===!0,childrenIndex:m,route:f};x.relativePath.startsWith("/")&&(Di(x.relativePath.startsWith(a),'Absolute route path "'+x.relativePath+'" nested under path '+('"'+a+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),x.relativePath=x.relativePath.slice(a.length));let w=tu([a,x.relativePath]),T=s.concat(x);f.children&&f.children.length>0&&(Di(f.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+w+'".')),G6(f.children,r,T,w)),!(f.path==null&&!f.index)&&r.push({path:w,score:jQ(w,f.index),routesMeta:T})};return e.forEach((f,m)=>{var y;if(f.path===""||!((y=f.path)!=null&&y.includes("?")))h(f,m);else for(let x of W6(f.path))h(f,m,x)}),r}function W6(e){let r=e.split("/");if(r.length===0)return[];let[s,...a]=r,h=s.endsWith("?"),f=s.replace(/\?$/,"");if(a.length===0)return h?[f,""]:[f];let m=W6(a.join("/")),y=[];return y.push(...m.map(x=>x===""?f:[f,x].join("/"))),h&&y.push(...m),y.map(x=>e.startsWith("/")&&x===""?"/":x)}function RQ(e){e.sort((r,s)=>r.score!==s.score?s.score-r.score:VQ(r.routesMeta.map(a=>a.childrenIndex),s.routesMeta.map(a=>a.childrenIndex)))}const OQ=/^:[\w-]+$/,LQ=3,zQ=2,NQ=1,FQ=10,BQ=-2,U5=e=>e==="*";function jQ(e,r){let s=e.split("/"),a=s.length;return s.some(U5)&&(a+=BQ),r&&(a+=zQ),s.filter(h=>!U5(h)).reduce((h,f)=>h+(OQ.test(f)?LQ:f===""?NQ:FQ),a)}function VQ(e,r){return e.length===r.length&&e.slice(0,-1).every((a,h)=>a===r[h])?e[e.length-1]-r[r.length-1]:0}function UQ(e,r){let{routesMeta:s}=e,a={},h="/",f=[];for(let m=0;m<s.length;++m){let y=s[m],x=m===s.length-1,w=h==="/"?r:r.slice(h.length)||"/",T=$Q({path:y.relativePath,caseSensitive:y.caseSensitive,end:x},w);if(!T)return null;Object.assign(a,T.params);let M=y.route;f.push({params:a,pathname:tu([h,T.pathname]),pathnameBase:YQ(tu([h,T.pathnameBase])),route:M}),T.pathnameBase!=="/"&&(h=tu([h,T.pathnameBase]))}return f}function $Q(e,r){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[s,a]=GQ(e.path,e.caseSensitive,e.end),h=r.match(s);if(!h)return null;let f=h[0],m=f.replace(/(.)\/+$/,"$1"),y=h.slice(1);return{params:a.reduce((w,T,M)=>{let{paramName:I,isOptional:R}=T;if(I==="*"){let N=y[M]||"";m=f.slice(0,f.length-N.length).replace(/(.)\/+$/,"$1")}const O=y[M];return R&&!O?w[I]=void 0:w[I]=HQ(O||"",I),w},{}),pathname:f,pathnameBase:m,pattern:e}}function GQ(e,r,s){r===void 0&&(r=!1),s===void 0&&(s=!0),cC(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let a=[],h="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(m,y,x)=>(a.push({paramName:y,isOptional:x!=null}),x?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(a.push({paramName:"*"}),h+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?h+="\\/*$":e!==""&&e!=="/"&&(h+="(?:(?=\\/|$))"),[new RegExp(h,r?void 0:"i"),a]}function WQ(e){try{return decodeURI(e)}catch(r){return cC(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+r+").")),e}}function HQ(e,r){try{return decodeURIComponent(e)}catch(s){return cC(!1,'The value for the URL param "'+r+'" will not be decoded because'+(' the string "'+e+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+s+").")),e}}function uC(e,r){if(r==="/")return e;if(!e.toLowerCase().startsWith(r.toLowerCase()))return null;let s=r.endsWith("/")?r.length-1:r.length,a=e.charAt(s);return a&&a!=="/"?null:e.slice(s)||"/"}function qQ(e,r){r===void 0&&(r="/");let{pathname:s,search:a="",hash:h=""}=typeof e=="string"?Af(e):e;return{pathname:s?s.startsWith("/")?s:ZQ(s,r):r,search:KQ(a),hash:JQ(h)}}function ZQ(e,r){let s=r.replace(/\/+$/,"").split("/");return e.split("/").forEach(h=>{h===".."?s.length>1&&s.pop():h!=="."&&s.push(h)}),s.length>1?s.join("/"):"/"}function xT(e,r,s,a){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+r+"` field ["+JSON.stringify(a)+"].  Please separate it out to the ")+("`to."+s+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function XQ(e){return e.filter((r,s)=>s===0||r.route.path&&r.route.path.length>0)}function H6(e,r){let s=XQ(e);return r?s.map((a,h)=>h===e.length-1?a.pathname:a.pathnameBase):s.map(a=>a.pathnameBase)}function q6(e,r,s,a){a===void 0&&(a=!1);let h;typeof e=="string"?h=Af(e):(h=tg({},e),Di(!h.pathname||!h.pathname.includes("?"),xT("?","pathname","search",h)),Di(!h.pathname||!h.pathname.includes("#"),xT("#","pathname","hash",h)),Di(!h.search||!h.search.includes("#"),xT("#","search","hash",h)));let f=e===""||h.pathname==="",m=f?"/":h.pathname,y;if(m==null)y=s;else{let M=r.length-1;if(!a&&m.startsWith("..")){let I=m.split("/");for(;I[0]==="..";)I.shift(),M-=1;h.pathname=I.join("/")}y=M>=0?r[M]:"/"}let x=qQ(h,y),w=m&&m!=="/"&&m.endsWith("/"),T=(f||m===".")&&s.endsWith("/");return!x.pathname.endsWith("/")&&(w||T)&&(x.pathname+="/"),x}const tu=e=>e.join("/").replace(/\/\/+/g,"/"),YQ=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),KQ=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,JQ=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function QQ(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Z6=["post","put","patch","delete"];new Set(Z6);const t2=["get",...Z6];new Set(t2);/**
 * React Router v6.21.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function eg(){return eg=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},eg.apply(this,arguments)}const hC=Y.createContext(null),e2=Y.createContext(null),Dh=Y.createContext(null),Vx=Y.createContext(null),_u=Y.createContext({outlet:null,matches:[],isDataRoute:!1}),X6=Y.createContext(null);function n2(e,r){let{relative:s}=r===void 0?{}:r;Mg()||Di(!1);let{basename:a,navigator:h}=Y.useContext(Dh),{hash:f,pathname:m,search:y}=K6(e,{relative:s}),x=m;return a!=="/"&&(x=m==="/"?a:tu([a,m])),h.createHref({pathname:x,search:y,hash:f})}function Mg(){return Y.useContext(Vx)!=null}function Ux(){return Mg()||Di(!1),Y.useContext(Vx).location}function Y6(e){Y.useContext(Dh).static||Y.useLayoutEffect(e)}function $l(){let{isDataRoute:e}=Y.useContext(_u);return e?m2():r2()}function r2(){Mg()||Di(!1);let e=Y.useContext(hC),{basename:r,future:s,navigator:a}=Y.useContext(Dh),{matches:h}=Y.useContext(_u),{pathname:f}=Ux(),m=JSON.stringify(H6(h,s.v7_relativeSplatPath)),y=Y.useRef(!1);return Y6(()=>{y.current=!0}),Y.useCallback(function(w,T){if(T===void 0&&(T={}),!y.current)return;if(typeof w=="number"){a.go(w);return}let M=q6(w,JSON.parse(m),f,T.relative==="path");e==null&&r!=="/"&&(M.pathname=M.pathname==="/"?r:tu([r,M.pathname])),(T.replace?a.replace:a.push)(M,T.state,T)},[r,a,m,f,e])}function Cf(){let{matches:e}=Y.useContext(_u),r=e[e.length-1];return r?r.params:{}}function K6(e,r){let{relative:s}=r===void 0?{}:r,{future:a}=Y.useContext(Dh),{matches:h}=Y.useContext(_u),{pathname:f}=Ux(),m=JSON.stringify(H6(h,a.v7_relativeSplatPath));return Y.useMemo(()=>q6(e,JSON.parse(m),f,s==="path"),[e,m,f,s])}function i2(e,r){return s2(e,r)}function s2(e,r,s,a){Mg()||Di(!1);let{navigator:h}=Y.useContext(Dh),{matches:f}=Y.useContext(_u),m=f[f.length-1],y=m?m.params:{};m&&m.pathname;let x=m?m.pathnameBase:"/";m&&m.route;let w=Ux(),T;if(r){var M;let G=typeof r=="string"?Af(r):r;x==="/"||(M=G.pathname)!=null&&M.startsWith(x)||Di(!1),T=G}else T=w;let I=T.pathname||"/",R=x==="/"?I:I.slice(x.length)||"/",O=DQ(e,{pathname:R}),N=u2(O&&O.map(G=>Object.assign({},G,{params:Object.assign({},y,G.params),pathname:tu([x,h.encodeLocation?h.encodeLocation(G.pathname).pathname:G.pathname]),pathnameBase:G.pathnameBase==="/"?x:tu([x,h.encodeLocation?h.encodeLocation(G.pathnameBase).pathname:G.pathnameBase])})),f,s,a);return r&&N?Y.createElement(Vx.Provider,{value:{location:eg({pathname:"/",search:"",hash:"",state:null,key:"default"},T),navigationType:Bc.Pop}},N):N}function o2(){let e=p2(),r=QQ(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),s=e instanceof Error?e.stack:null,h={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return Y.createElement(Y.Fragment,null,Y.createElement("h2",null,"Unexpected Application Error!"),Y.createElement("h3",{style:{fontStyle:"italic"}},r),s?Y.createElement("pre",{style:h},s):null,null)}const a2=Y.createElement(o2,null);class l2 extends Y.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,s){return s.location!==r.location||s.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error!==void 0?r.error:s.error,location:s.location,revalidation:r.revalidation||s.revalidation}}componentDidCatch(r,s){console.error("React Router caught the following error during render",r,s)}render(){return this.state.error!==void 0?Y.createElement(_u.Provider,{value:this.props.routeContext},Y.createElement(X6.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function c2(e){let{routeContext:r,match:s,children:a}=e,h=Y.useContext(hC);return h&&h.static&&h.staticContext&&(s.route.errorElement||s.route.ErrorBoundary)&&(h.staticContext._deepestRenderedBoundaryId=s.route.id),Y.createElement(_u.Provider,{value:r},a)}function u2(e,r,s,a){var h;if(r===void 0&&(r=[]),s===void 0&&(s=null),a===void 0&&(a=null),e==null){var f;if((f=s)!=null&&f.errors)e=s.matches;else return null}let m=e,y=(h=s)==null?void 0:h.errors;if(y!=null){let T=m.findIndex(M=>M.route.id&&(y==null?void 0:y[M.route.id]));T>=0||Di(!1),m=m.slice(0,Math.min(m.length,T+1))}let x=!1,w=-1;if(s&&a&&a.v7_partialHydration)for(let T=0;T<m.length;T++){let M=m[T];if((M.route.HydrateFallback||M.route.hydrateFallbackElement)&&(w=T),M.route.id){let{loaderData:I,errors:R}=s,O=M.route.loader&&I[M.route.id]===void 0&&(!R||R[M.route.id]===void 0);if(M.route.lazy||O){x=!0,w>=0?m=m.slice(0,w+1):m=[m[0]];break}}}return m.reduceRight((T,M,I)=>{let R,O=!1,N=null,G=null;s&&(R=y&&M.route.id?y[M.route.id]:void 0,N=M.route.errorElement||a2,x&&(w<0&&I===0?(g2("route-fallback",!1),O=!0,G=null):w===I&&(O=!0,G=M.route.hydrateFallbackElement||null)));let $=r.concat(m.slice(0,I+1)),z=()=>{let B;return R?B=N:O?B=G:M.route.Component?B=Y.createElement(M.route.Component,null):M.route.element?B=M.route.element:B=T,Y.createElement(c2,{match:M,routeContext:{outlet:T,matches:$,isDataRoute:s!=null},children:B})};return s&&(M.route.ErrorBoundary||M.route.errorElement||I===0)?Y.createElement(l2,{location:s.location,revalidation:s.revalidation,component:N,error:R,children:z(),routeContext:{outlet:null,matches:$,isDataRoute:!0}}):z()},null)}var J6=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(J6||{}),Zv=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Zv||{});function h2(e){let r=Y.useContext(hC);return r||Di(!1),r}function d2(e){let r=Y.useContext(e2);return r||Di(!1),r}function f2(e){let r=Y.useContext(_u);return r||Di(!1),r}function Q6(e){let r=f2(),s=r.matches[r.matches.length-1];return s.route.id||Di(!1),s.route.id}function p2(){var e;let r=Y.useContext(X6),s=d2(Zv.UseRouteError),a=Q6(Zv.UseRouteError);return r!==void 0?r:(e=s.errors)==null?void 0:e[a]}function m2(){let{router:e}=h2(J6.UseNavigateStable),r=Q6(Zv.UseNavigateStable),s=Y.useRef(!1);return Y6(()=>{s.current=!0}),Y.useCallback(function(h,f){f===void 0&&(f={}),s.current&&(typeof h=="number"?e.navigate(h):e.navigate(h,eg({fromRouteId:r},f)))},[e,r])}const $5={};function g2(e,r,s){!r&&!$5[e]&&($5[e]=!0)}function Zr(e){Di(!1)}function _2(e){let{basename:r="/",children:s=null,location:a,navigationType:h=Bc.Pop,navigator:f,static:m=!1,future:y}=e;Mg()&&Di(!1);let x=r.replace(/^\/*/,"/"),w=Y.useMemo(()=>({basename:x,navigator:f,static:m,future:eg({v7_relativeSplatPath:!1},y)}),[x,y,f,m]);typeof a=="string"&&(a=Af(a));let{pathname:T="/",search:M="",hash:I="",state:R=null,key:O="default"}=a,N=Y.useMemo(()=>{let G=uC(T,x);return G==null?null:{location:{pathname:G,search:M,hash:I,state:R,key:O},navigationType:h}},[x,T,M,I,R,O,h]);return N==null?null:Y.createElement(Dh.Provider,{value:w},Y.createElement(Vx.Provider,{children:s,value:N}))}function G5(e){let{children:r,location:s}=e;return i2(cM(r),s)}new Promise(()=>{});function cM(e,r){r===void 0&&(r=[]);let s=[];return Y.Children.forEach(e,(a,h)=>{if(!Y.isValidElement(a))return;let f=[...r,h];if(a.type===Y.Fragment){s.push.apply(s,cM(a.props.children,f));return}a.type!==Zr&&Di(!1),!a.props.index||!a.props.children||Di(!1);let m={id:a.props.id||f.join("-"),caseSensitive:a.props.caseSensitive,element:a.props.element,Component:a.props.Component,index:a.props.index,path:a.props.path,loader:a.props.loader,action:a.props.action,errorElement:a.props.errorElement,ErrorBoundary:a.props.ErrorBoundary,hasErrorBoundary:a.props.ErrorBoundary!=null||a.props.errorElement!=null,shouldRevalidate:a.props.shouldRevalidate,handle:a.props.handle,lazy:a.props.lazy};a.props.children&&(m.children=cM(a.props.children,f)),s.push(m)}),s}/**
 * React Router DOM v6.21.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function uM(){return uM=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},uM.apply(this,arguments)}function y2(e,r){if(e==null)return{};var s={},a=Object.keys(e),h,f;for(f=0;f<a.length;f++)h=a[f],!(r.indexOf(h)>=0)&&(s[h]=e[h]);return s}function v2(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function x2(e,r){return e.button===0&&(!r||r==="_self")&&!v2(e)}const b2=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],w2="startTransition",W5=iu[w2];function S2(e){let{basename:r,children:s,future:a,window:h}=e,f=Y.useRef();f.current==null&&(f.current=PQ({window:h,v5Compat:!0}));let m=f.current,[y,x]=Y.useState({action:m.action,location:m.location}),{v7_startTransition:w}=a||{},T=Y.useCallback(M=>{w&&W5?W5(()=>x(M)):x(M)},[x,w]);return Y.useLayoutEffect(()=>m.listen(T),[m,T]),Y.createElement(_2,{basename:r,children:s,location:y.location,navigationType:y.action,navigator:m,future:a})}const T2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",E2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,qn=Y.forwardRef(function(r,s){let{onClick:a,relative:h,reloadDocument:f,replace:m,state:y,target:x,to:w,preventScrollReset:T,unstable_viewTransition:M}=r,I=y2(r,b2),{basename:R}=Y.useContext(Dh),O,N=!1;if(typeof w=="string"&&E2.test(w)&&(O=w,T2))try{let B=new URL(window.location.href),H=w.startsWith("//")?new URL(B.protocol+w):new URL(w),K=uC(H.pathname,R);H.origin===B.origin&&K!=null?w=K+H.search+H.hash:N=!0}catch{}let G=n2(w,{relative:h}),$=M2(w,{replace:m,state:y,target:x,preventScrollReset:T,relative:h,unstable_viewTransition:M});function z(B){a&&a(B),B.defaultPrevented||$(B)}return Y.createElement("a",uM({},I,{href:O||G,onClick:N||f?a:z,ref:s,target:x}))});var H5;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(H5||(H5={}));var q5;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(q5||(q5={}));function M2(e,r){let{target:s,replace:a,state:h,preventScrollReset:f,relative:m,unstable_viewTransition:y}=r===void 0?{}:r,x=$l(),w=Ux(),T=K6(e,{relative:m});return Y.useCallback(M=>{if(x2(M,s)){M.preventDefault();let I=a!==void 0?a:qv(w)===qv(T);x(e,{replace:I,state:h,preventScrollReset:f,relative:m,unstable_viewTransition:y})}},[w,x,T,a,h,s,e,f,m,y])}var tV={exports:{}},eV={};/**
 * @license React
 * use-sync-external-store-with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ag=Y;function A2(e,r){return e===r&&(e!==0||1/e===1/r)||e!==e&&r!==r}var C2=typeof Object.is=="function"?Object.is:A2,P2=Ag.useSyncExternalStore,I2=Ag.useRef,k2=Ag.useEffect,D2=Ag.useMemo,R2=Ag.useDebugValue;eV.useSyncExternalStoreWithSelector=function(e,r,s,a,h){var f=I2(null);if(f.current===null){var m={hasValue:!1,value:null};f.current=m}else m=f.current;f=D2(function(){function x(R){if(!w){if(w=!0,T=R,R=a(R),h!==void 0&&m.hasValue){var O=m.value;if(h(O,R))return M=O}return M=R}if(O=M,C2(T,R))return O;var N=a(R);return h!==void 0&&h(O,N)?O:(T=R,M=N)}var w=!1,T,M,I=s===void 0?null:s;return[function(){return x(r())},I===null?void 0:function(){return x(I())}]},[r,s,a,h]);var y=P2(e,f[0],f[1]);return k2(function(){m.hasValue=!0,m.value=y},[y]),R2(y),y};tV.exports=eV;var O2=tV.exports,lo="default"in iu?we:iu,Z5=Symbol.for("react-redux-context"),X5=typeof globalThis<"u"?globalThis:{};function L2(){if(!lo.createContext)return{};const e=X5[Z5]??(X5[Z5]=new Map);let r=e.get(lo.createContext);return r||(r=lo.createContext(null),e.set(lo.createContext,r)),r}var au=L2(),z2=()=>{throw new Error("uSES not initialized!")};function dC(e=au){return function(){return lo.useContext(e)}}var nV=dC(),rV=z2,N2=e=>{rV=e},F2=(e,r)=>e===r;function B2(e=au){const r=e===au?nV:dC(e),s=(a,h={})=>{const{equalityFn:f=F2,devModeChecks:m={}}=typeof h=="function"?{equalityFn:h}:h,{store:y,subscription:x,getServerState:w,stabilityCheck:T,identityFunctionCheck:M}=r();lo.useRef(!0);const I=lo.useCallback({[a.name](O){return a(O)}}[a.name],[a,T,m.stabilityCheck]),R=rV(x.addNestedSub,y.getState,w||y.getState,I,f);return lo.useDebugValue(R),R};return Object.assign(s,{withTypes:()=>s}),s}var Rh=B2();function j2(e){e()}function V2(){let e=null,r=null;return{clear(){e=null,r=null},notify(){j2(()=>{let s=e;for(;s;)s.callback(),s=s.next})},get(){const s=[];let a=e;for(;a;)s.push(a),a=a.next;return s},subscribe(s){let a=!0;const h=r={callback:s,next:null,prev:r};return h.prev?h.prev.next=h:e=h,function(){!a||e===null||(a=!1,h.next?h.next.prev=h.prev:r=h.prev,h.prev?h.prev.next=h.next:e=h.next)}}}}var Y5={notify(){},get:()=>[]};function U2(e,r){let s,a=Y5,h=0,f=!1;function m(N){T();const G=a.subscribe(N);let $=!1;return()=>{$||($=!0,G(),M())}}function y(){a.notify()}function x(){O.onStateChange&&O.onStateChange()}function w(){return f}function T(){h++,s||(s=r?r.addNestedSub(x):e.subscribe(x),a=V2())}function M(){h--,s&&h===0&&(s(),s=void 0,a.clear(),a=Y5)}function I(){f||(f=!0,T())}function R(){f&&(f=!1,M())}const O={addNestedSub:m,notifyNestedSubs:y,handleChangeWrapper:x,isSubscribed:w,trySubscribe:I,tryUnsubscribe:R,getListeners:()=>a};return O}var $2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",G2=$2?lo.useLayoutEffect:lo.useEffect;function W2({store:e,context:r,children:s,serverState:a,stabilityCheck:h="once",identityFunctionCheck:f="once"}){const m=lo.useMemo(()=>{const w=U2(e);return{store:e,subscription:w,getServerState:a?()=>a:void 0,stabilityCheck:h,identityFunctionCheck:f}},[e,a,h,f]),y=lo.useMemo(()=>e.getState(),[e]);G2(()=>{const{subscription:w}=m;return w.onStateChange=w.notifyNestedSubs,w.trySubscribe(),y!==e.getState()&&w.notifyNestedSubs(),()=>{w.tryUnsubscribe(),w.onStateChange=void 0}},[m,y]);const x=r||au;return lo.createElement(x.Provider,{value:m},s)}var H2=W2;function iV(e=au){const r=e===au?nV:dC(e),s=()=>{const{store:a}=r();return a};return Object.assign(s,{withTypes:()=>s}),s}var q2=iV();function Z2(e=au){const r=e===au?q2:iV(e),s=()=>r().dispatch;return Object.assign(s,{withTypes:()=>s}),s}var fC=Z2();N2(O2.useSyncExternalStoreWithSelector);var X2=Object.defineProperty,Y2=(e,r,s)=>r in e?X2(e,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[r]=s,bT=(e,r,s)=>(Y2(e,typeof r!="symbol"?r+"":r,s),s);let K2=class{constructor(){bT(this,"current",this.detect()),bT(this,"handoffState","pending"),bT(this,"currentId",0)}set(r){this.current!==r&&(this.handoffState="pending",this.currentId=0,this.current=r)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return this.current==="server"}get isClient(){return this.current==="client"}detect(){return typeof window>"u"||typeof document>"u"?"server":"client"}handoff(){this.handoffState==="pending"&&(this.handoffState="complete")}get isHandoffComplete(){return this.handoffState==="complete"}},Dl=new K2,Ui=(e,r)=>{Dl.isServer?Y.useEffect(e,r):Y.useLayoutEffect(e,r)};function pa(e){let r=Y.useRef(e);return Ui(()=>{r.current=e},[e]),r}let ln=function(e){let r=pa(e);return we.useCallback((...s)=>r.current(...s),[r])};function $x(e){typeof queueMicrotask=="function"?queueMicrotask(e):Promise.resolve().then(e).catch(r=>setTimeout(()=>{throw r}))}function _a(){let e=[],r={addEventListener(s,a,h,f){return s.addEventListener(a,h,f),r.add(()=>s.removeEventListener(a,h,f))},requestAnimationFrame(...s){let a=requestAnimationFrame(...s);return r.add(()=>cancelAnimationFrame(a))},nextFrame(...s){return r.requestAnimationFrame(()=>r.requestAnimationFrame(...s))},setTimeout(...s){let a=setTimeout(...s);return r.add(()=>clearTimeout(a))},microTask(...s){let a={current:!0};return $x(()=>{a.current&&s[0]()}),r.add(()=>{a.current=!1})},style(s,a,h){let f=s.style.getPropertyValue(a);return Object.assign(s.style,{[a]:h}),this.add(()=>{Object.assign(s.style,{[a]:f})})},group(s){let a=_a();return s(a),this.add(()=>a.dispose())},add(s){return e.push(s),()=>{let a=e.indexOf(s);if(a>=0)for(let h of e.splice(a,1))h()}},dispose(){for(let s of e.splice(0))s()}};return r}function Cg(){let[e]=Y.useState(_a);return Y.useEffect(()=>()=>e.dispose(),[e]),e}function J2(){let e=typeof document>"u";return"useSyncExternalStore"in iu?(r=>r.useSyncExternalStore)(iu)(()=>()=>{},()=>!1,()=>!e):!1}function Pf(){let e=J2(),[r,s]=Y.useState(Dl.isHandoffComplete);return r&&Dl.isHandoffComplete===!1&&s(!1),Y.useEffect(()=>{r!==!0&&s(!0)},[r]),Y.useEffect(()=>Dl.handoff(),[]),e?!1:r}var K5;let es=(K5=we.useId)!=null?K5:function(){let e=Pf(),[r,s]=we.useState(e?()=>Dl.nextId():null);return Ui(()=>{r===null&&s(Dl.nextId())},[r]),r!=null?""+r:void 0};function Er(e,r,...s){if(e in r){let h=r[e];return typeof h=="function"?h(...s):h}let a=new Error(`Tried to handle "${e}" but there is no handler defined. Only defined handlers are: ${Object.keys(r).map(h=>`"${h}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(a,Er),a}function If(e){return Dl.isServer?null:e instanceof Node?e.ownerDocument:e!=null&&e.hasOwnProperty("current")&&e.current instanceof Node?e.current.ownerDocument:document}let hM=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].map(e=>`${e}:not([tabindex='-1'])`).join(",");var Qi=(e=>(e[e.First=1]="First",e[e.Previous=2]="Previous",e[e.Next=4]="Next",e[e.Last=8]="Last",e[e.WrapAround=16]="WrapAround",e[e.NoScroll=32]="NoScroll",e))(Qi||{}),ng=(e=>(e[e.Error=0]="Error",e[e.Overflow=1]="Overflow",e[e.Success=2]="Success",e[e.Underflow=3]="Underflow",e))(ng||{}),Q2=(e=>(e[e.Previous=-1]="Previous",e[e.Next=1]="Next",e))(Q2||{});function Pg(e=document.body){return e==null?[]:Array.from(e.querySelectorAll(hM)).sort((r,s)=>Math.sign((r.tabIndex||Number.MAX_SAFE_INTEGER)-(s.tabIndex||Number.MAX_SAFE_INTEGER)))}var Gx=(e=>(e[e.Strict=0]="Strict",e[e.Loose=1]="Loose",e))(Gx||{});function Wx(e,r=0){var s;return e===((s=If(e))==null?void 0:s.body)?!1:Er(r,{0(){return e.matches(hM)},1(){let a=e;for(;a!==null;){if(a.matches(hM))return!0;a=a.parentElement}return!1}})}function sV(e){let r=If(e);_a().nextFrame(()=>{r&&!Wx(r.activeElement,0)&&eu(e)})}var ttt=(e=>(e[e.Keyboard=0]="Keyboard",e[e.Mouse=1]="Mouse",e))(ttt||{});typeof window<"u"&&typeof document<"u"&&(document.addEventListener("keydown",e=>{e.metaKey||e.altKey||e.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",e=>{e.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:e.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));function eu(e){e==null||e.focus({preventScroll:!0})}let ett=["textarea","input"].join(",");function ntt(e){var r,s;return(s=(r=e==null?void 0:e.matches)==null?void 0:r.call(e,ett))!=null?s:!1}function oV(e,r=s=>s){return e.slice().sort((s,a)=>{let h=r(s),f=r(a);if(h===null||f===null)return 0;let m=h.compareDocumentPosition(f);return m&Node.DOCUMENT_POSITION_FOLLOWING?-1:m&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function rtt(e,r){return Fo(Pg(),r,{relativeTo:e})}function Fo(e,r,{sorted:s=!0,relativeTo:a=null,skipElements:h=[]}={}){let f=Array.isArray(e)?e.length>0?e[0].ownerDocument:document:e.ownerDocument,m=Array.isArray(e)?s?oV(e):e:Pg(e);h.length>0&&m.length>1&&(m=m.filter(R=>!h.includes(R))),a=a??f.activeElement;let y=(()=>{if(r&5)return 1;if(r&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),x=(()=>{if(r&1)return 0;if(r&2)return Math.max(0,m.indexOf(a))-1;if(r&4)return Math.max(0,m.indexOf(a))+1;if(r&8)return m.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),w=r&32?{preventScroll:!0}:{},T=0,M=m.length,I;do{if(T>=M||T+M<=0)return 0;let R=x+T;if(r&16)R=(R+M)%M;else{if(R<0)return 3;if(R>=M)return 1}I=m[R],I==null||I.focus(w),T+=y}while(I!==f.activeElement);return r&6&&ntt(I)&&I.select(),2}function aV(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function itt(){return/Android/gi.test(window.navigator.userAgent)}function stt(){return aV()||itt()}function p0(e,r,s){let a=pa(r);Y.useEffect(()=>{function h(f){a.current(f)}return document.addEventListener(e,h,s),()=>document.removeEventListener(e,h,s)},[e,s])}function lV(e,r,s){let a=pa(r);Y.useEffect(()=>{function h(f){a.current(f)}return window.addEventListener(e,h,s),()=>window.removeEventListener(e,h,s)},[e,s])}function pC(e,r,s=!0){let a=Y.useRef(!1);Y.useEffect(()=>{requestAnimationFrame(()=>{a.current=s})},[s]);function h(m,y){if(!a.current||m.defaultPrevented)return;let x=y(m);if(x===null||!x.getRootNode().contains(x)||!x.isConnected)return;let w=function T(M){return typeof M=="function"?T(M()):Array.isArray(M)||M instanceof Set?M:[M]}(e);for(let T of w){if(T===null)continue;let M=T instanceof HTMLElement?T:T.current;if(M!=null&&M.contains(x)||m.composed&&m.composedPath().includes(M))return}return!Wx(x,Gx.Loose)&&x.tabIndex!==-1&&m.preventDefault(),r(m,x)}let f=Y.useRef(null);p0("pointerdown",m=>{var y,x;a.current&&(f.current=((x=(y=m.composedPath)==null?void 0:y.call(m))==null?void 0:x[0])||m.target)},!0),p0("mousedown",m=>{var y,x;a.current&&(f.current=((x=(y=m.composedPath)==null?void 0:y.call(m))==null?void 0:x[0])||m.target)},!0),p0("click",m=>{stt()||f.current&&(h(m,()=>f.current),f.current=null)},!0),p0("touchend",m=>h(m,()=>m.target instanceof HTMLElement?m.target:null),!0),lV("blur",m=>h(m,()=>window.document.activeElement instanceof HTMLIFrameElement?window.document.activeElement:null),!0)}function Gl(...e){return Y.useMemo(()=>If(...e),[...e])}function J5(e){var r;if(e.type)return e.type;let s=(r=e.as)!=null?r:"button";if(typeof s=="string"&&s.toLowerCase()==="button")return"button"}function mC(e,r){let[s,a]=Y.useState(()=>J5(e));return Ui(()=>{a(J5(e))},[e.type,e.as]),Ui(()=>{s||r.current&&r.current instanceof HTMLButtonElement&&!r.current.hasAttribute("type")&&a("button")},[s,r]),s}let cV=Symbol();function gC(e,r=!0){return Object.assign(e,{[cV]:r})}function Yr(...e){let r=Y.useRef(e);Y.useEffect(()=>{r.current=e},[e]);let s=ln(a=>{for(let h of r.current)h!=null&&(typeof h=="function"?h(a):h.current=a)});return e.every(a=>a==null||(a==null?void 0:a[cV]))?void 0:s}function Q5(e){return[e.screenX,e.screenY]}function ott(){let e=Y.useRef([-1,-1]);return{wasMoved(r){let s=Q5(r);return e.current[0]===s[0]&&e.current[1]===s[1]?!1:(e.current=s,!0)},update(r){e.current=Q5(r)}}}function att({container:e,accept:r,walk:s,enabled:a=!0}){let h=Y.useRef(r),f=Y.useRef(s);Y.useEffect(()=>{h.current=r,f.current=s},[r,s]),Ui(()=>{if(!e||!a)return;let m=If(e);if(!m)return;let y=h.current,x=f.current,w=Object.assign(M=>y(M),{acceptNode:y}),T=m.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,w,!1);for(;T.nextNode();)x(T.currentNode)},[e,a,h,f])}function _C(e,r){let s=Y.useRef([]),a=ln(e);Y.useEffect(()=>{let h=[...s.current];for(let[f,m]of r.entries())if(s.current[f]!==m){let y=a(r,h);return s.current=r,y}},[a,...r])}function Xv(...e){return Array.from(new Set(e.flatMap(r=>typeof r=="string"?r.split(" "):[]))).filter(Boolean).join(" ")}var $o=(e=>(e[e.None=0]="None",e[e.RenderStrategy=1]="RenderStrategy",e[e.Static=2]="Static",e))($o||{}),jc=(e=>(e[e.Unmount=0]="Unmount",e[e.Hidden=1]="Hidden",e))(jc||{});function Kr({ourProps:e,theirProps:r,slot:s,defaultTag:a,features:h,visible:f=!0,name:m,mergeRefs:y}){y=y??ltt;let x=uV(r,e);if(f)return m0(x,s,a,m,y);let w=h??0;if(w&2){let{static:T=!1,...M}=x;if(T)return m0(M,s,a,m,y)}if(w&1){let{unmount:T=!0,...M}=x;return Er(T?0:1,{0(){return null},1(){return m0({...M,hidden:!0,style:{display:"none"}},s,a,m,y)}})}return m0(x,s,a,m,y)}function m0(e,r={},s,a,h){let{as:f=s,children:m,refName:y="ref",...x}=wT(e,["unmount","static"]),w=e.ref!==void 0?{[y]:e.ref}:{},T=typeof m=="function"?m(r):m;"className"in x&&x.className&&typeof x.className=="function"&&(x.className=x.className(r));let M={};if(r){let I=!1,R=[];for(let[O,N]of Object.entries(r))typeof N=="boolean"&&(I=!0),N===!0&&R.push(O);I&&(M["data-headlessui-state"]=R.join(" "))}if(f===Y.Fragment&&Object.keys(t4(x)).length>0){if(!Y.isValidElement(T)||Array.isArray(T)&&T.length>1)throw new Error(['Passing props on "Fragment"!',"",`The current component <${a} /> is rendering a "Fragment".`,"However we need to passthrough the following props:",Object.keys(x).map(N=>`  - ${N}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map(N=>`  - ${N}`).join(`
`)].join(`
`));let I=T.props,R=typeof(I==null?void 0:I.className)=="function"?(...N)=>Xv(I==null?void 0:I.className(...N),x.className):Xv(I==null?void 0:I.className,x.className),O=R?{className:R}:{};return Y.cloneElement(T,Object.assign({},uV(T.props,t4(wT(x,["ref"]))),M,w,{ref:h(T.ref,w.ref)},O))}return Y.createElement(f,Object.assign({},wT(x,["ref"]),f!==Y.Fragment&&w,f!==Y.Fragment&&M),T)}function yC(){let e=Y.useRef([]),r=Y.useCallback(s=>{for(let a of e.current)a!=null&&(typeof a=="function"?a(s):a.current=s)},[]);return(...s)=>{if(!s.every(a=>a==null))return e.current=s,r}}function ltt(...e){return e.every(r=>r==null)?void 0:r=>{for(let s of e)s!=null&&(typeof s=="function"?s(r):s.current=r)}}function uV(...e){if(e.length===0)return{};if(e.length===1)return e[0];let r={},s={};for(let a of e)for(let h in a)h.startsWith("on")&&typeof a[h]=="function"?(s[h]!=null||(s[h]=[]),s[h].push(a[h])):r[h]=a[h];if(r.disabled||r["aria-disabled"])return Object.assign(r,Object.fromEntries(Object.keys(s).map(a=>[a,void 0])));for(let a in s)Object.assign(r,{[a](h,...f){let m=s[a];for(let y of m){if((h instanceof Event||(h==null?void 0:h.nativeEvent)instanceof Event)&&h.defaultPrevented)return;y(h,...f)}}});return r}function Gr(e){var r;return Object.assign(Y.forwardRef(e),{displayName:(r=e.displayName)!=null?r:e.name})}function t4(e){let r=Object.assign({},e);for(let s in r)r[s]===void 0&&delete r[s];return r}function wT(e,r=[]){let s=Object.assign({},e);for(let a of r)a in s&&delete s[a];return s}let ctt="div";var lu=(e=>(e[e.None=1]="None",e[e.Focusable=2]="Focusable",e[e.Hidden=4]="Hidden",e))(lu||{});function utt(e,r){var s;let{features:a=1,...h}=e,f={ref:r,"aria-hidden":(a&2)===2?!0:(s=h["aria-hidden"])!=null?s:void 0,style:{position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",...(a&4)===4&&(a&2)!==2&&{display:"none"}}};return Kr({ourProps:f,theirProps:h,slot:{},defaultTag:ctt,name:"Hidden"})}let Mh=Gr(utt),vC=Y.createContext(null);vC.displayName="OpenClosedContext";var Rr=(e=>(e[e.Open=1]="Open",e[e.Closed=2]="Closed",e[e.Closing=4]="Closing",e[e.Opening=8]="Opening",e))(Rr||{});function Oh(){return Y.useContext(vC)}function Hx({value:e,children:r}){return we.createElement(vC.Provider,{value:e},r)}function htt(e){function r(){document.readyState!=="loading"&&(e(),document.removeEventListener("DOMContentLoaded",r))}typeof window<"u"&&typeof document<"u"&&(document.addEventListener("DOMContentLoaded",r),r())}let zc=[];htt(()=>{function e(r){r.target instanceof HTMLElement&&r.target!==document.body&&zc[0]!==r.target&&(zc.unshift(r.target),zc=zc.filter(s=>s!=null&&s.isConnected),zc.splice(10))}window.addEventListener("click",e,{capture:!0}),window.addEventListener("mousedown",e,{capture:!0}),window.addEventListener("focus",e,{capture:!0}),document.body.addEventListener("click",e,{capture:!0}),document.body.addEventListener("mousedown",e,{capture:!0}),document.body.addEventListener("focus",e,{capture:!0})});function Ig(e){let r=e.parentElement,s=null;for(;r&&!(r instanceof HTMLFieldSetElement);)r instanceof HTMLLegendElement&&(s=r),r=r.parentElement;let a=(r==null?void 0:r.getAttribute("disabled"))==="";return a&&dtt(s)?!1:a}function dtt(e){if(!e)return!1;let r=e.previousElementSibling;for(;r!==null;){if(r instanceof HTMLLegendElement)return!1;r=r.previousElementSibling}return!0}function ftt(e){throw new Error("Unexpected object: "+e)}var ua=(e=>(e[e.First=0]="First",e[e.Previous=1]="Previous",e[e.Next=2]="Next",e[e.Last=3]="Last",e[e.Specific=4]="Specific",e[e.Nothing=5]="Nothing",e))(ua||{});function ptt(e,r){let s=r.resolveItems();if(s.length<=0)return null;let a=r.resolveActiveIndex(),h=a??-1;switch(e.focus){case 0:{for(let f=0;f<s.length;++f)if(!r.resolveDisabled(s[f],f,s))return f;return a}case 1:{for(let f=h-1;f>=0;--f)if(!r.resolveDisabled(s[f],f,s))return f;return a}case 2:{for(let f=h+1;f<s.length;++f)if(!r.resolveDisabled(s[f],f,s))return f;return a}case 3:{for(let f=s.length-1;f>=0;--f)if(!r.resolveDisabled(s[f],f,s))return f;return a}case 4:{for(let f=0;f<s.length;++f)if(r.resolveId(s[f],f,s)===e.id)return f;return a}case 5:return null;default:ftt(e)}}var yr=(e=>(e.Space=" ",e.Enter="Enter",e.Escape="Escape",e.Backspace="Backspace",e.Delete="Delete",e.ArrowLeft="ArrowLeft",e.ArrowUp="ArrowUp",e.ArrowRight="ArrowRight",e.ArrowDown="ArrowDown",e.Home="Home",e.End="End",e.PageUp="PageUp",e.PageDown="PageDown",e.Tab="Tab",e))(yr||{});function xC(e,r,s,a){let h=pa(s);Y.useEffect(()=>{e=e??window;function f(m){h.current(m)}return e.addEventListener(r,f,a),()=>e.removeEventListener(r,f,a)},[e,r,a])}function kg(){let e=Y.useRef(!1);return Ui(()=>(e.current=!0,()=>{e.current=!1}),[]),e}function hV(e){let r=ln(e),s=Y.useRef(!1);Y.useEffect(()=>(s.current=!1,()=>{s.current=!0,$x(()=>{s.current&&r()})}),[r])}var co=(e=>(e[e.Forwards=0]="Forwards",e[e.Backwards=1]="Backwards",e))(co||{});function bC(){let e=Y.useRef(0);return lV("keydown",r=>{r.key==="Tab"&&(e.current=r.shiftKey?1:0)},!0),e}function dV(e){if(!e)return new Set;if(typeof e=="function")return new Set(e());let r=new Set;for(let s of e.current)s.current instanceof HTMLElement&&r.add(s.current);return r}let mtt="div";var fV=(e=>(e[e.None=1]="None",e[e.InitialFocus=2]="InitialFocus",e[e.TabLock=4]="TabLock",e[e.FocusLock=8]="FocusLock",e[e.RestoreFocus=16]="RestoreFocus",e[e.All=30]="All",e))(fV||{});function gtt(e,r){let s=Y.useRef(null),a=Yr(s,r),{initialFocus:h,containers:f,features:m=30,...y}=e;Pf()||(m=1);let x=Gl(s);vtt({ownerDocument:x},!!(m&16));let w=xtt({ownerDocument:x,container:s,initialFocus:h},!!(m&2));btt({ownerDocument:x,container:s,containers:f,previousActiveElement:w},!!(m&8));let T=bC(),M=ln(N=>{let G=s.current;G&&($=>$())(()=>{Er(T.current,{[co.Forwards]:()=>{Fo(G,Qi.First,{skipElements:[N.relatedTarget]})},[co.Backwards]:()=>{Fo(G,Qi.Last,{skipElements:[N.relatedTarget]})}})})}),I=Cg(),R=Y.useRef(!1),O={ref:a,onKeyDown(N){N.key=="Tab"&&(R.current=!0,I.requestAnimationFrame(()=>{R.current=!1}))},onBlur(N){let G=dV(f);s.current instanceof HTMLElement&&G.add(s.current);let $=N.relatedTarget;$ instanceof HTMLElement&&$.dataset.headlessuiFocusGuard!=="true"&&(pV(G,$)||(R.current?Fo(s.current,Er(T.current,{[co.Forwards]:()=>Qi.Next,[co.Backwards]:()=>Qi.Previous})|Qi.WrapAround,{relativeTo:N.target}):N.target instanceof HTMLElement&&eu(N.target)))}};return we.createElement(we.Fragment,null,!!(m&4)&&we.createElement(Mh,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:M,features:lu.Focusable}),Kr({ourProps:O,theirProps:y,defaultTag:mtt,name:"FocusTrap"}),!!(m&4)&&we.createElement(Mh,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:M,features:lu.Focusable}))}let _tt=Gr(gtt),qp=Object.assign(_tt,{features:fV});function ytt(e=!0){let r=Y.useRef(zc.slice());return _C(([s],[a])=>{a===!0&&s===!1&&$x(()=>{r.current.splice(0)}),a===!1&&s===!0&&(r.current=zc.slice())},[e,zc,r]),ln(()=>{var s;return(s=r.current.find(a=>a!=null&&a.isConnected))!=null?s:null})}function vtt({ownerDocument:e},r){let s=ytt(r);_C(()=>{r||(e==null?void 0:e.activeElement)===(e==null?void 0:e.body)&&eu(s())},[r]),hV(()=>{r&&eu(s())})}function xtt({ownerDocument:e,container:r,initialFocus:s},a){let h=Y.useRef(null),f=kg();return _C(()=>{if(!a)return;let m=r.current;m&&$x(()=>{if(!f.current)return;let y=e==null?void 0:e.activeElement;if(s!=null&&s.current){if((s==null?void 0:s.current)===y){h.current=y;return}}else if(m.contains(y)){h.current=y;return}s!=null&&s.current?eu(s.current):Fo(m,Qi.First)===ng.Error&&console.warn("There are no focusable elements inside the <FocusTrap />"),h.current=e==null?void 0:e.activeElement})},[a]),h}function btt({ownerDocument:e,container:r,containers:s,previousActiveElement:a},h){let f=kg();xC(e==null?void 0:e.defaultView,"focus",m=>{if(!h||!f.current)return;let y=dV(s);r.current instanceof HTMLElement&&y.add(r.current);let x=a.current;if(!x)return;let w=m.target;w&&w instanceof HTMLElement?pV(y,w)?(a.current=w,eu(w)):(m.preventDefault(),m.stopPropagation(),eu(x)):eu(a.current)},!0)}function pV(e,r){for(let s of e)if(s.contains(r))return!0;return!1}let mV=Y.createContext(!1);function wtt(){return Y.useContext(mV)}function dM(e){return we.createElement(mV.Provider,{value:e.force},e.children)}function Stt(e){let r=wtt(),s=Y.useContext(gV),a=Gl(e),[h,f]=Y.useState(()=>{if(!r&&s!==null||Dl.isServer)return null;let m=a==null?void 0:a.getElementById("headlessui-portal-root");if(m)return m;if(a===null)return null;let y=a.createElement("div");return y.setAttribute("id","headlessui-portal-root"),a.body.appendChild(y)});return Y.useEffect(()=>{h!==null&&(a!=null&&a.body.contains(h)||a==null||a.body.appendChild(h))},[h,a]),Y.useEffect(()=>{r||s!==null&&f(s.current)},[s,f,r]),h}let Ttt=Y.Fragment;function Ett(e,r){let s=e,a=Y.useRef(null),h=Yr(gC(T=>{a.current=T}),r),f=Gl(a),m=Stt(a),[y]=Y.useState(()=>{var T;return Dl.isServer?null:(T=f==null?void 0:f.createElement("div"))!=null?T:null}),x=Y.useContext(fM),w=Pf();return Ui(()=>{!m||!y||m.contains(y)||(y.setAttribute("data-headlessui-portal",""),m.appendChild(y))},[m,y]),Ui(()=>{if(y&&x)return x.register(y)},[x,y]),hV(()=>{var T;!m||!y||(y instanceof Node&&m.contains(y)&&m.removeChild(y),m.childNodes.length<=0&&((T=m.parentElement)==null||T.removeChild(m)))}),w?!m||!y?null:P6.createPortal(Kr({ourProps:{ref:h},theirProps:s,defaultTag:Ttt,name:"Portal"}),y):null}let Mtt=Y.Fragment,gV=Y.createContext(null);function Att(e,r){let{target:s,...a}=e,h={ref:Yr(r)};return we.createElement(gV.Provider,{value:s},Kr({ourProps:h,theirProps:a,defaultTag:Mtt,name:"Popover.Group"}))}let fM=Y.createContext(null);function _V(){let e=Y.useContext(fM),r=Y.useRef([]),s=ln(f=>(r.current.push(f),e&&e.register(f),()=>a(f))),a=ln(f=>{let m=r.current.indexOf(f);m!==-1&&r.current.splice(m,1),e&&e.unregister(f)}),h=Y.useMemo(()=>({register:s,unregister:a,portals:r}),[s,a,r]);return[r,Y.useMemo(()=>function({children:f}){return we.createElement(fM.Provider,{value:h},f)},[h])]}let Ctt=Gr(Ett),Ptt=Gr(Att),pM=Object.assign(Ctt,{Group:Ptt});function Itt(e,r){return e===r&&(e!==0||1/e===1/r)||e!==e&&r!==r}const ktt=typeof Object.is=="function"?Object.is:Itt,{useState:Dtt,useEffect:Rtt,useLayoutEffect:Ott,useDebugValue:Ltt}=iu;function ztt(e,r,s){const a=r(),[{inst:h},f]=Dtt({inst:{value:a,getSnapshot:r}});return Ott(()=>{h.value=a,h.getSnapshot=r,ST(h)&&f({inst:h})},[e,a,r]),Rtt(()=>(ST(h)&&f({inst:h}),e(()=>{ST(h)&&f({inst:h})})),[e]),Ltt(a),a}function ST(e){const r=e.getSnapshot,s=e.value;try{const a=r();return!ktt(s,a)}catch{return!0}}function Ntt(e,r,s){return r()}const Ftt=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Btt=!Ftt,jtt=Btt?Ntt:ztt,Vtt="useSyncExternalStore"in iu?(e=>e.useSyncExternalStore)(iu):jtt;function Utt(e){return Vtt(e.subscribe,e.getSnapshot,e.getSnapshot)}function $tt(e,r){let s=e(),a=new Set;return{getSnapshot(){return s},subscribe(h){return a.add(h),()=>a.delete(h)},dispatch(h,...f){let m=r[h].call(s,...f);m&&(s=m,a.forEach(y=>y()))}}}function Gtt(){let e;return{before({doc:r}){var s;let a=r.documentElement;e=((s=r.defaultView)!=null?s:window).innerWidth-a.clientWidth},after({doc:r,d:s}){let a=r.documentElement,h=a.clientWidth-a.offsetWidth,f=e-h;s.style(a,"paddingRight",`${f}px`)}}}function Wtt(){return aV()?{before({doc:e,d:r,meta:s}){function a(h){return s.containers.flatMap(f=>f()).some(f=>f.contains(h))}r.microTask(()=>{var h;if(window.getComputedStyle(e.documentElement).scrollBehavior!=="auto"){let y=_a();y.style(e.documentElement,"scrollBehavior","auto"),r.add(()=>r.microTask(()=>y.dispose()))}let f=(h=window.scrollY)!=null?h:window.pageYOffset,m=null;r.addEventListener(e,"click",y=>{if(y.target instanceof HTMLElement)try{let x=y.target.closest("a");if(!x)return;let{hash:w}=new URL(x.href),T=e.querySelector(w);T&&!a(T)&&(m=T)}catch{}},!0),r.addEventListener(e,"touchstart",y=>{if(y.target instanceof HTMLElement)if(a(y.target)){let x=y.target;for(;x.parentElement&&a(x.parentElement);)x=x.parentElement;r.style(x,"overscrollBehavior","contain")}else r.style(y.target,"touchAction","none")}),r.addEventListener(e,"touchmove",y=>{if(y.target instanceof HTMLElement)if(a(y.target)){let x=y.target;for(;x.parentElement&&x.dataset.headlessuiPortal!==""&&!(x.scrollHeight>x.clientHeight||x.scrollWidth>x.clientWidth);)x=x.parentElement;x.dataset.headlessuiPortal===""&&y.preventDefault()}else y.preventDefault()},{passive:!1}),r.add(()=>{var y;let x=(y=window.scrollY)!=null?y:window.pageYOffset;f!==x&&window.scrollTo(0,f),m&&m.isConnected&&(m.scrollIntoView({block:"nearest"}),m=null)})})}}:{}}function Htt(){return{before({doc:e,d:r}){r.style(e.documentElement,"overflow","hidden")}}}function qtt(e){let r={};for(let s of e)Object.assign(r,s(r));return r}let uh=$tt(()=>new Map,{PUSH(e,r){var s;let a=(s=this.get(e))!=null?s:{doc:e,count:0,d:_a(),meta:new Set};return a.count++,a.meta.add(r),this.set(e,a),this},POP(e,r){let s=this.get(e);return s&&(s.count--,s.meta.delete(r)),this},SCROLL_PREVENT({doc:e,d:r,meta:s}){let a={doc:e,d:r,meta:qtt(s)},h=[Wtt(),Gtt(),Htt()];h.forEach(({before:f})=>f==null?void 0:f(a)),h.forEach(({after:f})=>f==null?void 0:f(a))},SCROLL_ALLOW({d:e}){e.dispose()},TEARDOWN({doc:e}){this.delete(e)}});uh.subscribe(()=>{let e=uh.getSnapshot(),r=new Map;for(let[s]of e)r.set(s,s.documentElement.style.overflow);for(let s of e.values()){let a=r.get(s.doc)==="hidden",h=s.count!==0;(h&&!a||!h&&a)&&uh.dispatch(s.count>0?"SCROLL_PREVENT":"SCROLL_ALLOW",s),s.count===0&&uh.dispatch("TEARDOWN",s)}});function Ztt(e,r,s){let a=Utt(uh),h=e?a.get(e):void 0,f=h?h.count>0:!1;return Ui(()=>{if(!(!e||!r))return uh.dispatch("PUSH",e,s),()=>uh.dispatch("POP",e,s)},[r,e]),f}let TT=new Map,Zp=new Map;function e4(e,r=!0){Ui(()=>{var s;if(!r)return;let a=typeof e=="function"?e():e.current;if(!a)return;function h(){var m;if(!a)return;let y=(m=Zp.get(a))!=null?m:1;if(y===1?Zp.delete(a):Zp.set(a,y-1),y!==1)return;let x=TT.get(a);x&&(x["aria-hidden"]===null?a.removeAttribute("aria-hidden"):a.setAttribute("aria-hidden",x["aria-hidden"]),a.inert=x.inert,TT.delete(a))}let f=(s=Zp.get(a))!=null?s:0;return Zp.set(a,f+1),f!==0||(TT.set(a,{"aria-hidden":a.getAttribute("aria-hidden"),inert:a.inert}),a.setAttribute("aria-hidden","true"),a.inert=!0),h},[e,r])}function yV({defaultContainers:e=[],portals:r,mainTreeNodeRef:s}={}){var a;let h=Y.useRef((a=s==null?void 0:s.current)!=null?a:null),f=Gl(h),m=ln(()=>{var y,x,w;let T=[];for(let M of e)M!==null&&(M instanceof HTMLElement?T.push(M):"current"in M&&M.current instanceof HTMLElement&&T.push(M.current));if(r!=null&&r.current)for(let M of r.current)T.push(M);for(let M of(y=f==null?void 0:f.querySelectorAll("html > *, body > *"))!=null?y:[])M!==document.body&&M!==document.head&&M instanceof HTMLElement&&M.id!=="headlessui-portal-root"&&(M.contains(h.current)||M.contains((w=(x=h.current)==null?void 0:x.getRootNode())==null?void 0:w.host)||T.some(I=>M.contains(I))||T.push(M));return T});return{resolveContainers:m,contains:ln(y=>m().some(x=>x.contains(y))),mainTreeNodeRef:h,MainTreeNode:Y.useMemo(()=>function(){return s!=null?null:we.createElement(Mh,{features:lu.Hidden,ref:h})},[h,s])}}function Xtt(){let e=Y.useRef(null);return{mainTreeNodeRef:e,MainTreeNode:Y.useMemo(()=>function(){return we.createElement(Mh,{features:lu.Hidden,ref:e})},[e])}}let wC=Y.createContext(()=>{});wC.displayName="StackContext";var mM=(e=>(e[e.Add=0]="Add",e[e.Remove=1]="Remove",e))(mM||{});function Ytt(){return Y.useContext(wC)}function Ktt({children:e,onUpdate:r,type:s,element:a,enabled:h}){let f=Ytt(),m=ln((...y)=>{r==null||r(...y),f(...y)});return Ui(()=>{let y=h===void 0||h===!0;return y&&m(0,s,a),()=>{y&&m(1,s,a)}},[m,s,a,h]),we.createElement(wC.Provider,{value:m},e)}let vV=Y.createContext(null);function xV(){let e=Y.useContext(vV);if(e===null){let r=new Error("You used a <Description /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(r,xV),r}return e}function Jtt(){let[e,r]=Y.useState([]);return[e.length>0?e.join(" "):void 0,Y.useMemo(()=>function(s){let a=ln(f=>(r(m=>[...m,f]),()=>r(m=>{let y=m.slice(),x=y.indexOf(f);return x!==-1&&y.splice(x,1),y}))),h=Y.useMemo(()=>({register:a,slot:s.slot,name:s.name,props:s.props}),[a,s.slot,s.name,s.props]);return we.createElement(vV.Provider,{value:h},s.children)},[r])]}let Qtt="p";function tet(e,r){let s=es(),{id:a=`headlessui-description-${s}`,...h}=e,f=xV(),m=Yr(r);Ui(()=>f.register(a),[a,f.register]);let y={ref:m,...f.props,id:a};return Kr({ourProps:y,theirProps:h,slot:f.slot||{},defaultTag:Qtt,name:f.name||"Description"})}let eet=Gr(tet),net=Object.assign(eet,{});var ret=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(ret||{}),iet=(e=>(e[e.SetTitleId=0]="SetTitleId",e))(iet||{});let set={0(e,r){return e.titleId===r.id?e:{...e,titleId:r.id}}},Yv=Y.createContext(null);Yv.displayName="DialogContext";function Dg(e){let r=Y.useContext(Yv);if(r===null){let s=new Error(`<${e} /> is missing a parent <Dialog /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(s,Dg),s}return r}function oet(e,r,s=()=>[document.body]){Ztt(e,r,a=>{var h;return{containers:[...(h=a.containers)!=null?h:[],s]}})}function aet(e,r){return Er(r.type,set,e,r)}let cet="div",uet=$o.RenderStrategy|$o.Static;function het(e,r){let s=es(),{id:a=`headlessui-dialog-${s}`,open:h,onClose:f,initialFocus:m,role:y="dialog",__demoMode:x=!1,...w}=e,[T,M]=Y.useState(0),I=Y.useRef(!1);y=function(){return y==="dialog"||y==="alertdialog"?y:(I.current||(I.current=!0,console.warn(`Invalid role [${y}] passed to <Dialog />. Only \`dialog\` and and \`alertdialog\` are supported. Using \`dialog\` instead.`)),"dialog")}();let R=Oh();h===void 0&&R!==null&&(h=(R&Rr.Open)===Rr.Open);let O=Y.useRef(null),N=Yr(O,r),G=Gl(O),$=e.hasOwnProperty("open")||R!==null,z=e.hasOwnProperty("onClose");if(!$&&!z)throw new Error("You have to provide an `open` and an `onClose` prop to the `Dialog` component.");if(!$)throw new Error("You provided an `onClose` prop to the `Dialog`, but forgot an `open` prop.");if(!z)throw new Error("You provided an `open` prop to the `Dialog`, but forgot an `onClose` prop.");if(typeof h!="boolean")throw new Error(`You provided an \`open\` prop to the \`Dialog\`, but the value is not a boolean. Received: ${h}`);if(typeof f!="function")throw new Error(`You provided an \`onClose\` prop to the \`Dialog\`, but the value is not a function. Received: ${f}`);let B=h?0:1,[H,K]=Y.useReducer(aet,{titleId:null,descriptionId:null,panelRef:Y.createRef()}),at=ln(()=>f(!1)),ft=ln(Oe=>K({type:0,id:Oe})),et=Pf()?x?!1:B===0:!1,nt=T>1,W=Y.useContext(Yv)!==null,[Q,yt]=_V(),Pt={get current(){var Oe;return(Oe=H.panelRef.current)!=null?Oe:O.current}},{resolveContainers:st,mainTreeNodeRef:St,MainTreeNode:Rt}=yV({portals:Q,defaultContainers:[Pt]}),Zt=nt?"parent":"leaf",Ft=R!==null?(R&Rr.Closing)===Rr.Closing:!1,$t=W||Ft?!1:et,ee=Y.useCallback(()=>{var Oe,Qe;return(Qe=Array.from((Oe=G==null?void 0:G.querySelectorAll("body > *"))!=null?Oe:[]).find(Le=>Le.id==="headlessui-portal-root"?!1:Le.contains(St.current)&&Le instanceof HTMLElement))!=null?Qe:null},[St]);e4(ee,$t);let se=nt?!0:et,Ot=Y.useCallback(()=>{var Oe,Qe;return(Qe=Array.from((Oe=G==null?void 0:G.querySelectorAll("[data-headlessui-portal]"))!=null?Oe:[]).find(Le=>Le.contains(St.current)&&Le instanceof HTMLElement))!=null?Qe:null},[St]);e4(Ot,se),pC(st,at,!(!et||nt));let me=!(nt||B!==0);xC(G==null?void 0:G.defaultView,"keydown",Oe=>{me&&(Oe.defaultPrevented||Oe.key===yr.Escape&&(Oe.preventDefault(),Oe.stopPropagation(),at()))}),oet(G,!(Ft||B!==0||W),st),Y.useEffect(()=>{if(B!==0||!O.current)return;let Oe=new ResizeObserver(Qe=>{for(let Le of Qe){let Ne=Le.target.getBoundingClientRect();Ne.x===0&&Ne.y===0&&Ne.width===0&&Ne.height===0&&at()}});return Oe.observe(O.current),()=>Oe.disconnect()},[B,O,at]);let[Wt,Ct]=Jtt(),Ae=Y.useMemo(()=>[{dialogState:B,close:at,setTitleId:ft},H],[B,H,at,ft]),he=Y.useMemo(()=>({open:B===0}),[B]),Fe={ref:N,id:a,role:y,"aria-modal":B===0?!0:void 0,"aria-labelledby":H.titleId,"aria-describedby":Wt};return we.createElement(Ktt,{type:"Dialog",enabled:B===0,element:O,onUpdate:ln((Oe,Qe)=>{Qe==="Dialog"&&Er(Oe,{[mM.Add]:()=>M(Le=>Le+1),[mM.Remove]:()=>M(Le=>Le-1)})})},we.createElement(dM,{force:!0},we.createElement(pM,null,we.createElement(Yv.Provider,{value:Ae},we.createElement(pM.Group,{target:O},we.createElement(dM,{force:!1},we.createElement(Ct,{slot:he,name:"Dialog.Description"},we.createElement(qp,{initialFocus:m,containers:st,features:et?Er(Zt,{parent:qp.features.RestoreFocus,leaf:qp.features.All&~qp.features.FocusLock}):qp.features.None},we.createElement(yt,null,Kr({ourProps:Fe,theirProps:w,slot:he,defaultTag:cet,features:uet,visible:B===0,name:"Dialog"}))))))))),we.createElement(Rt,null))}let det="div";function fet(e,r){let s=es(),{id:a=`headlessui-dialog-overlay-${s}`,...h}=e,[{dialogState:f,close:m}]=Dg("Dialog.Overlay"),y=Yr(r),x=ln(T=>{if(T.target===T.currentTarget){if(Ig(T.currentTarget))return T.preventDefault();T.preventDefault(),T.stopPropagation(),m()}}),w=Y.useMemo(()=>({open:f===0}),[f]);return Kr({ourProps:{ref:y,id:a,"aria-hidden":!0,onClick:x},theirProps:h,slot:w,defaultTag:det,name:"Dialog.Overlay"})}let pet="div";function met(e,r){let s=es(),{id:a=`headlessui-dialog-backdrop-${s}`,...h}=e,[{dialogState:f},m]=Dg("Dialog.Backdrop"),y=Yr(r);Y.useEffect(()=>{if(m.panelRef.current===null)throw new Error("A <Dialog.Backdrop /> component is being used, but a <Dialog.Panel /> component is missing.")},[m.panelRef]);let x=Y.useMemo(()=>({open:f===0}),[f]);return we.createElement(dM,{force:!0},we.createElement(pM,null,Kr({ourProps:{ref:y,id:a,"aria-hidden":!0},theirProps:h,slot:x,defaultTag:pet,name:"Dialog.Backdrop"})))}let get="div";function _et(e,r){let s=es(),{id:a=`headlessui-dialog-panel-${s}`,...h}=e,[{dialogState:f},m]=Dg("Dialog.Panel"),y=Yr(r,m.panelRef),x=Y.useMemo(()=>({open:f===0}),[f]),w=ln(T=>{T.stopPropagation()});return Kr({ourProps:{ref:y,id:a,onClick:w},theirProps:h,slot:x,defaultTag:get,name:"Dialog.Panel"})}let yet="h2";function vet(e,r){let s=es(),{id:a=`headlessui-dialog-title-${s}`,...h}=e,[{dialogState:f,setTitleId:m}]=Dg("Dialog.Title"),y=Yr(r);Y.useEffect(()=>(m(a),()=>m(null)),[a,m]);let x=Y.useMemo(()=>({open:f===0}),[f]);return Kr({ourProps:{ref:y,id:a},theirProps:h,slot:x,defaultTag:yet,name:"Dialog.Title"})}let xet=Gr(het),bet=Gr(met),wet=Gr(_et),Tet=Gr(fet),Eet=Gr(vet),n4=Object.assign(xet,{Backdrop:bet,Panel:wet,Overlay:Tet,Title:Eet,Description:net});var r4;let Met=(r4=we.startTransition)!=null?r4:function(e){e()};var Aet=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(Aet||{}),Cet=(e=>(e[e.ToggleDisclosure=0]="ToggleDisclosure",e[e.CloseDisclosure=1]="CloseDisclosure",e[e.SetButtonId=2]="SetButtonId",e[e.SetPanelId=3]="SetPanelId",e[e.LinkPanel=4]="LinkPanel",e[e.UnlinkPanel=5]="UnlinkPanel",e))(Cet||{});let Pet={0:e=>({...e,disclosureState:Er(e.disclosureState,{0:1,1:0})}),1:e=>e.disclosureState===1?e:{...e,disclosureState:1},4(e){return e.linkedPanel===!0?e:{...e,linkedPanel:!0}},5(e){return e.linkedPanel===!1?e:{...e,linkedPanel:!1}},2(e,r){return e.buttonId===r.buttonId?e:{...e,buttonId:r.buttonId}},3(e,r){return e.panelId===r.panelId?e:{...e,panelId:r.panelId}}},SC=Y.createContext(null);SC.displayName="DisclosureContext";function TC(e){let r=Y.useContext(SC);if(r===null){let s=new Error(`<${e} /> is missing a parent <Disclosure /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(s,TC),s}return r}let EC=Y.createContext(null);EC.displayName="DisclosureAPIContext";function bV(e){let r=Y.useContext(EC);if(r===null){let s=new Error(`<${e} /> is missing a parent <Disclosure /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(s,bV),s}return r}let MC=Y.createContext(null);MC.displayName="DisclosurePanelContext";function Iet(){return Y.useContext(MC)}function ket(e,r){return Er(r.type,Pet,e,r)}let Det=Y.Fragment;function Ret(e,r){let{defaultOpen:s=!1,...a}=e,h=Y.useRef(null),f=Yr(r,gC(G=>{h.current=G},e.as===void 0||e.as===Y.Fragment)),m=Y.useRef(null),y=Y.useRef(null),x=Y.useReducer(ket,{disclosureState:s?0:1,linkedPanel:!1,buttonRef:y,panelRef:m,buttonId:null,panelId:null}),[{disclosureState:w,buttonId:T},M]=x,I=ln(G=>{M({type:1});let $=If(h);if(!$||!T)return;let z=G?G instanceof HTMLElement?G:G.current instanceof HTMLElement?G.current:$.getElementById(T):$.getElementById(T);z==null||z.focus()}),R=Y.useMemo(()=>({close:I}),[I]),O=Y.useMemo(()=>({open:w===0,close:I}),[w,I]),N={ref:f};return we.createElement(SC.Provider,{value:x},we.createElement(EC.Provider,{value:R},we.createElement(Hx,{value:Er(w,{0:Rr.Open,1:Rr.Closed})},Kr({ourProps:N,theirProps:a,slot:O,defaultTag:Det,name:"Disclosure"}))))}let Oet="button";function Let(e,r){let s=es(),{id:a=`headlessui-disclosure-button-${s}`,...h}=e,[f,m]=TC("Disclosure.Button"),y=Iet(),x=y===null?!1:y===f.panelId,w=Y.useRef(null),T=Yr(w,r,x?null:f.buttonRef),M=yC();Y.useEffect(()=>{if(!x)return m({type:2,buttonId:a}),()=>{m({type:2,buttonId:null})}},[a,m,x]);let I=ln(z=>{var B;if(x){if(f.disclosureState===1)return;switch(z.key){case yr.Space:case yr.Enter:z.preventDefault(),z.stopPropagation(),m({type:0}),(B=f.buttonRef.current)==null||B.focus();break}}else switch(z.key){case yr.Space:case yr.Enter:z.preventDefault(),z.stopPropagation(),m({type:0});break}}),R=ln(z=>{switch(z.key){case yr.Space:z.preventDefault();break}}),O=ln(z=>{var B;Ig(z.currentTarget)||e.disabled||(x?(m({type:0}),(B=f.buttonRef.current)==null||B.focus()):m({type:0}))}),N=Y.useMemo(()=>({open:f.disclosureState===0}),[f]),G=mC(e,w),$=x?{ref:T,type:G,onKeyDown:I,onClick:O}:{ref:T,id:a,type:G,"aria-expanded":f.disclosureState===0,"aria-controls":f.linkedPanel?f.panelId:void 0,onKeyDown:I,onKeyUp:R,onClick:O};return Kr({mergeRefs:M,ourProps:$,theirProps:h,slot:N,defaultTag:Oet,name:"Disclosure.Button"})}let zet="div",Net=$o.RenderStrategy|$o.Static;function Fet(e,r){let s=es(),{id:a=`headlessui-disclosure-panel-${s}`,...h}=e,[f,m]=TC("Disclosure.Panel"),{close:y}=bV("Disclosure.Panel"),x=yC(),w=Yr(r,f.panelRef,O=>{Met(()=>m({type:O?4:5}))});Y.useEffect(()=>(m({type:3,panelId:a}),()=>{m({type:3,panelId:null})}),[a,m]);let T=Oh(),M=T!==null?(T&Rr.Open)===Rr.Open:f.disclosureState===0,I=Y.useMemo(()=>({open:f.disclosureState===0,close:y}),[f,y]),R={ref:w,id:a};return we.createElement(MC.Provider,{value:f.panelId},Kr({mergeRefs:x,ourProps:R,theirProps:h,slot:I,defaultTag:zet,features:Net,visible:M,name:"Disclosure.Panel"}))}let Bet=Gr(Ret),jet=Gr(Let),Vet=Gr(Fet),hh=Object.assign(Bet,{Button:jet,Panel:Vet}),i4=/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDD10-\uDDFF])/g;function s4(e){var r,s;let a=(r=e.innerText)!=null?r:"",h=e.cloneNode(!0);if(!(h instanceof HTMLElement))return a;let f=!1;for(let y of h.querySelectorAll('[hidden],[aria-hidden],[role="img"]'))y.remove(),f=!0;let m=f?(s=h.innerText)!=null?s:"":a;return i4.test(m)&&(m=m.replace(i4,"")),m}function Uet(e){let r=e.getAttribute("aria-label");if(typeof r=="string")return r.trim();let s=e.getAttribute("aria-labelledby");if(s){let a=s.split(" ").map(h=>{let f=document.getElementById(h);if(f){let m=f.getAttribute("aria-label");return typeof m=="string"?m.trim():s4(f).trim()}return null}).filter(Boolean);if(a.length>0)return a.join(", ")}return s4(e).trim()}function $et(e){let r=Y.useRef(""),s=Y.useRef("");return ln(()=>{let a=e.current;if(!a)return"";let h=a.innerText;if(r.current===h)return s.current;let f=Uet(a).trim().toLowerCase();return r.current=h,s.current=f,f})}var Get=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(Get||{}),Wet=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(Wet||{}),Het=(e=>(e[e.OpenMenu=0]="OpenMenu",e[e.CloseMenu=1]="CloseMenu",e[e.GoToItem=2]="GoToItem",e[e.Search=3]="Search",e[e.ClearSearch=4]="ClearSearch",e[e.RegisterItem=5]="RegisterItem",e[e.UnregisterItem=6]="UnregisterItem",e))(Het||{});function ET(e,r=s=>s){let s=e.activeItemIndex!==null?e.items[e.activeItemIndex]:null,a=oV(r(e.items.slice()),f=>f.dataRef.current.domRef.current),h=s?a.indexOf(s):null;return h===-1&&(h=null),{items:a,activeItemIndex:h}}let qet={1(e){return e.menuState===1?e:{...e,activeItemIndex:null,menuState:1}},0(e){return e.menuState===0?e:{...e,__demoMode:!1,menuState:0}},2:(e,r)=>{var s;let a=ET(e),h=ptt(r,{resolveItems:()=>a.items,resolveActiveIndex:()=>a.activeItemIndex,resolveId:f=>f.id,resolveDisabled:f=>f.dataRef.current.disabled});return{...e,...a,searchQuery:"",activeItemIndex:h,activationTrigger:(s=r.trigger)!=null?s:1}},3:(e,r)=>{let s=e.searchQuery!==""?0:1,a=e.searchQuery+r.value.toLowerCase(),h=(e.activeItemIndex!==null?e.items.slice(e.activeItemIndex+s).concat(e.items.slice(0,e.activeItemIndex+s)):e.items).find(m=>{var y;return((y=m.dataRef.current.textValue)==null?void 0:y.startsWith(a))&&!m.dataRef.current.disabled}),f=h?e.items.indexOf(h):-1;return f===-1||f===e.activeItemIndex?{...e,searchQuery:a}:{...e,searchQuery:a,activeItemIndex:f,activationTrigger:1}},4(e){return e.searchQuery===""?e:{...e,searchQuery:"",searchActiveItemIndex:null}},5:(e,r)=>{let s=ET(e,a=>[...a,{id:r.id,dataRef:r.dataRef}]);return{...e,...s}},6:(e,r)=>{let s=ET(e,a=>{let h=a.findIndex(f=>f.id===r.id);return h!==-1&&a.splice(h,1),a});return{...e,...s,activationTrigger:1}}},AC=Y.createContext(null);AC.displayName="MenuContext";function qx(e){let r=Y.useContext(AC);if(r===null){let s=new Error(`<${e} /> is missing a parent <Menu /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(s,qx),s}return r}function Zet(e,r){return Er(r.type,qet,e,r)}let Xet=Y.Fragment;function Yet(e,r){let{__demoMode:s=!1,...a}=e,h=Y.useReducer(Zet,{__demoMode:s,menuState:s?0:1,buttonRef:Y.createRef(),itemsRef:Y.createRef(),items:[],searchQuery:"",activeItemIndex:null,activationTrigger:1}),[{menuState:f,itemsRef:m,buttonRef:y},x]=h,w=Yr(r);pC([y,m],(R,O)=>{var N;x({type:1}),Wx(O,Gx.Loose)||(R.preventDefault(),(N=y.current)==null||N.focus())},f===0);let T=ln(()=>{x({type:1})}),M=Y.useMemo(()=>({open:f===0,close:T}),[f,T]),I={ref:w};return we.createElement(AC.Provider,{value:h},we.createElement(Hx,{value:Er(f,{0:Rr.Open,1:Rr.Closed})},Kr({ourProps:I,theirProps:a,slot:M,defaultTag:Xet,name:"Menu"})))}let Ket="button";function Jet(e,r){var s;let a=es(),{id:h=`headlessui-menu-button-${a}`,...f}=e,[m,y]=qx("Menu.Button"),x=Yr(m.buttonRef,r),w=Cg(),T=ln(N=>{switch(N.key){case yr.Space:case yr.Enter:case yr.ArrowDown:N.preventDefault(),N.stopPropagation(),y({type:0}),w.nextFrame(()=>y({type:2,focus:ua.First}));break;case yr.ArrowUp:N.preventDefault(),N.stopPropagation(),y({type:0}),w.nextFrame(()=>y({type:2,focus:ua.Last}));break}}),M=ln(N=>{switch(N.key){case yr.Space:N.preventDefault();break}}),I=ln(N=>{if(Ig(N.currentTarget))return N.preventDefault();e.disabled||(m.menuState===0?(y({type:1}),w.nextFrame(()=>{var G;return(G=m.buttonRef.current)==null?void 0:G.focus({preventScroll:!0})})):(N.preventDefault(),y({type:0})))}),R=Y.useMemo(()=>({open:m.menuState===0}),[m]),O={ref:x,id:h,type:mC(e,m.buttonRef),"aria-haspopup":"menu","aria-controls":(s=m.itemsRef.current)==null?void 0:s.id,"aria-expanded":m.menuState===0,onKeyDown:T,onKeyUp:M,onClick:I};return Kr({ourProps:O,theirProps:f,slot:R,defaultTag:Ket,name:"Menu.Button"})}let Qet="div",tnt=$o.RenderStrategy|$o.Static;function ent(e,r){var s,a;let h=es(),{id:f=`headlessui-menu-items-${h}`,...m}=e,[y,x]=qx("Menu.Items"),w=Yr(y.itemsRef,r),T=Gl(y.itemsRef),M=Cg(),I=Oh(),R=I!==null?(I&Rr.Open)===Rr.Open:y.menuState===0;Y.useEffect(()=>{let z=y.itemsRef.current;z&&y.menuState===0&&z!==(T==null?void 0:T.activeElement)&&z.focus({preventScroll:!0})},[y.menuState,y.itemsRef,T]),att({container:y.itemsRef.current,enabled:y.menuState===0,accept(z){return z.getAttribute("role")==="menuitem"?NodeFilter.FILTER_REJECT:z.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(z){z.setAttribute("role","none")}});let O=ln(z=>{var B,H;switch(M.dispose(),z.key){case yr.Space:if(y.searchQuery!=="")return z.preventDefault(),z.stopPropagation(),x({type:3,value:z.key});case yr.Enter:if(z.preventDefault(),z.stopPropagation(),x({type:1}),y.activeItemIndex!==null){let{dataRef:K}=y.items[y.activeItemIndex];(H=(B=K.current)==null?void 0:B.domRef.current)==null||H.click()}sV(y.buttonRef.current);break;case yr.ArrowDown:return z.preventDefault(),z.stopPropagation(),x({type:2,focus:ua.Next});case yr.ArrowUp:return z.preventDefault(),z.stopPropagation(),x({type:2,focus:ua.Previous});case yr.Home:case yr.PageUp:return z.preventDefault(),z.stopPropagation(),x({type:2,focus:ua.First});case yr.End:case yr.PageDown:return z.preventDefault(),z.stopPropagation(),x({type:2,focus:ua.Last});case yr.Escape:z.preventDefault(),z.stopPropagation(),x({type:1}),_a().nextFrame(()=>{var K;return(K=y.buttonRef.current)==null?void 0:K.focus({preventScroll:!0})});break;case yr.Tab:z.preventDefault(),z.stopPropagation(),x({type:1}),_a().nextFrame(()=>{rtt(y.buttonRef.current,z.shiftKey?Qi.Previous:Qi.Next)});break;default:z.key.length===1&&(x({type:3,value:z.key}),M.setTimeout(()=>x({type:4}),350));break}}),N=ln(z=>{switch(z.key){case yr.Space:z.preventDefault();break}}),G=Y.useMemo(()=>({open:y.menuState===0}),[y]),$={"aria-activedescendant":y.activeItemIndex===null||(s=y.items[y.activeItemIndex])==null?void 0:s.id,"aria-labelledby":(a=y.buttonRef.current)==null?void 0:a.id,id:f,onKeyDown:O,onKeyUp:N,role:"menu",tabIndex:0,ref:w};return Kr({ourProps:$,theirProps:m,slot:G,defaultTag:Qet,features:tnt,visible:R,name:"Menu.Items"})}let nnt=Y.Fragment;function rnt(e,r){let s=es(),{id:a=`headlessui-menu-item-${s}`,disabled:h=!1,...f}=e,[m,y]=qx("Menu.Item"),x=m.activeItemIndex!==null?m.items[m.activeItemIndex].id===a:!1,w=Y.useRef(null),T=Yr(r,w);Ui(()=>{if(m.__demoMode||m.menuState!==0||!x||m.activationTrigger===0)return;let K=_a();return K.requestAnimationFrame(()=>{var at,ft;(ft=(at=w.current)==null?void 0:at.scrollIntoView)==null||ft.call(at,{block:"nearest"})}),K.dispose},[m.__demoMode,w,x,m.menuState,m.activationTrigger,m.activeItemIndex]);let M=$et(w),I=Y.useRef({disabled:h,domRef:w,get textValue(){return M()}});Ui(()=>{I.current.disabled=h},[I,h]),Ui(()=>(y({type:5,id:a,dataRef:I}),()=>y({type:6,id:a})),[I,a]);let R=ln(()=>{y({type:1})}),O=ln(K=>{if(h)return K.preventDefault();y({type:1}),sV(m.buttonRef.current)}),N=ln(()=>{if(h)return y({type:2,focus:ua.Nothing});y({type:2,focus:ua.Specific,id:a})}),G=ott(),$=ln(K=>G.update(K)),z=ln(K=>{G.wasMoved(K)&&(h||x||y({type:2,focus:ua.Specific,id:a,trigger:0}))}),B=ln(K=>{G.wasMoved(K)&&(h||x&&y({type:2,focus:ua.Nothing}))}),H=Y.useMemo(()=>({active:x,disabled:h,close:R}),[x,h,R]);return Kr({ourProps:{id:a,ref:T,role:"menuitem",tabIndex:h===!0?void 0:-1,"aria-disabled":h===!0?!0:void 0,disabled:void 0,onClick:O,onFocus:N,onPointerEnter:$,onMouseEnter:$,onPointerMove:z,onMouseMove:z,onPointerLeave:B,onMouseLeave:B},theirProps:f,slot:H,defaultTag:nnt,name:"Menu.Item"})}let int=Gr(Yet),snt=Gr(Jet),ont=Gr(ent),ant=Gr(rnt),Od=Object.assign(int,{Button:snt,Items:ont,Item:ant});var lnt=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(lnt||{}),cnt=(e=>(e[e.TogglePopover=0]="TogglePopover",e[e.ClosePopover=1]="ClosePopover",e[e.SetButton=2]="SetButton",e[e.SetButtonId=3]="SetButtonId",e[e.SetPanel=4]="SetPanel",e[e.SetPanelId=5]="SetPanelId",e))(cnt||{});let unt={0:e=>{let r={...e,popoverState:Er(e.popoverState,{0:1,1:0})};return r.popoverState===0&&(r.__demoMode=!1),r},1(e){return e.popoverState===1?e:{...e,popoverState:1}},2(e,r){return e.button===r.button?e:{...e,button:r.button}},3(e,r){return e.buttonId===r.buttonId?e:{...e,buttonId:r.buttonId}},4(e,r){return e.panel===r.panel?e:{...e,panel:r.panel}},5(e,r){return e.panelId===r.panelId?e:{...e,panelId:r.panelId}}},CC=Y.createContext(null);CC.displayName="PopoverContext";function Zx(e){let r=Y.useContext(CC);if(r===null){let s=new Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(s,Zx),s}return r}let PC=Y.createContext(null);PC.displayName="PopoverAPIContext";function IC(e){let r=Y.useContext(PC);if(r===null){let s=new Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(s,IC),s}return r}let kC=Y.createContext(null);kC.displayName="PopoverGroupContext";function wV(){return Y.useContext(kC)}let Xx=Y.createContext(null);Xx.displayName="PopoverPanelContext";function hnt(){return Y.useContext(Xx)}function dnt(e,r){return Er(r.type,unt,e,r)}let fnt="div";function pnt(e,r){var s;let{__demoMode:a=!1,...h}=e,f=Y.useRef(null),m=Yr(r,gC(Rt=>{f.current=Rt})),y=Y.useRef([]),x=Y.useReducer(dnt,{__demoMode:a,popoverState:a?0:1,buttons:y,button:null,buttonId:null,panel:null,panelId:null,beforePanelSentinel:Y.createRef(),afterPanelSentinel:Y.createRef()}),[{popoverState:w,button:T,buttonId:M,panel:I,panelId:R,beforePanelSentinel:O,afterPanelSentinel:N},G]=x,$=Gl((s=f.current)!=null?s:T),z=Y.useMemo(()=>{if(!T||!I)return!1;for(let Ot of document.querySelectorAll("body > *"))if(Number(Ot==null?void 0:Ot.contains(T))^Number(Ot==null?void 0:Ot.contains(I)))return!0;let Rt=Pg(),Zt=Rt.indexOf(T),Ft=(Zt+Rt.length-1)%Rt.length,$t=(Zt+1)%Rt.length,ee=Rt[Ft],se=Rt[$t];return!I.contains(ee)&&!I.contains(se)},[T,I]),B=pa(M),H=pa(R),K=Y.useMemo(()=>({buttonId:B,panelId:H,close:()=>G({type:1})}),[B,H,G]),at=wV(),ft=at==null?void 0:at.registerPopover,et=ln(()=>{var Rt;return(Rt=at==null?void 0:at.isFocusWithinPopoverGroup())!=null?Rt:($==null?void 0:$.activeElement)&&((T==null?void 0:T.contains($.activeElement))||(I==null?void 0:I.contains($.activeElement)))});Y.useEffect(()=>ft==null?void 0:ft(K),[ft,K]);let[nt,W]=_V(),Q=yV({mainTreeNodeRef:at==null?void 0:at.mainTreeNodeRef,portals:nt,defaultContainers:[T,I]});xC($==null?void 0:$.defaultView,"focus",Rt=>{var Zt,Ft,$t,ee;Rt.target!==window&&Rt.target instanceof HTMLElement&&w===0&&(et()||T&&I&&(Q.contains(Rt.target)||(Ft=(Zt=O.current)==null?void 0:Zt.contains)!=null&&Ft.call(Zt,Rt.target)||(ee=($t=N.current)==null?void 0:$t.contains)!=null&&ee.call($t,Rt.target)||G({type:1})))},!0),pC(Q.resolveContainers,(Rt,Zt)=>{G({type:1}),Wx(Zt,Gx.Loose)||(Rt.preventDefault(),T==null||T.focus())},w===0);let yt=ln(Rt=>{G({type:1});let Zt=Rt?Rt instanceof HTMLElement?Rt:"current"in Rt&&Rt.current instanceof HTMLElement?Rt.current:T:T;Zt==null||Zt.focus()}),Pt=Y.useMemo(()=>({close:yt,isPortalled:z}),[yt,z]),st=Y.useMemo(()=>({open:w===0,close:yt}),[w,yt]),St={ref:m};return we.createElement(Xx.Provider,{value:null},we.createElement(CC.Provider,{value:x},we.createElement(PC.Provider,{value:Pt},we.createElement(Hx,{value:Er(w,{0:Rr.Open,1:Rr.Closed})},we.createElement(W,null,Kr({ourProps:St,theirProps:h,slot:st,defaultTag:fnt,name:"Popover"}),we.createElement(Q.MainTreeNode,null))))))}let mnt="button";function gnt(e,r){let s=es(),{id:a=`headlessui-popover-button-${s}`,...h}=e,[f,m]=Zx("Popover.Button"),{isPortalled:y}=IC("Popover.Button"),x=Y.useRef(null),w=`headlessui-focus-sentinel-${es()}`,T=wV(),M=T==null?void 0:T.closeOthers,I=hnt()!==null;Y.useEffect(()=>{if(!I)return m({type:3,buttonId:a}),()=>{m({type:3,buttonId:null})}},[I,a,m]);let[R]=Y.useState(()=>Symbol()),O=Yr(x,r,I?null:Q=>{if(Q)f.buttons.current.push(R);else{let yt=f.buttons.current.indexOf(R);yt!==-1&&f.buttons.current.splice(yt,1)}f.buttons.current.length>1&&console.warn("You are already using a <Popover.Button /> but only 1 <Popover.Button /> is supported."),Q&&m({type:2,button:Q})}),N=Yr(x,r),G=Gl(x),$=ln(Q=>{var yt,Pt,st;if(I){if(f.popoverState===1)return;switch(Q.key){case yr.Space:case yr.Enter:Q.preventDefault(),(Pt=(yt=Q.target).click)==null||Pt.call(yt),m({type:1}),(st=f.button)==null||st.focus();break}}else switch(Q.key){case yr.Space:case yr.Enter:Q.preventDefault(),Q.stopPropagation(),f.popoverState===1&&(M==null||M(f.buttonId)),m({type:0});break;case yr.Escape:if(f.popoverState!==0)return M==null?void 0:M(f.buttonId);if(!x.current||G!=null&&G.activeElement&&!x.current.contains(G.activeElement))return;Q.preventDefault(),Q.stopPropagation(),m({type:1});break}}),z=ln(Q=>{I||Q.key===yr.Space&&Q.preventDefault()}),B=ln(Q=>{var yt,Pt;Ig(Q.currentTarget)||e.disabled||(I?(m({type:1}),(yt=f.button)==null||yt.focus()):(Q.preventDefault(),Q.stopPropagation(),f.popoverState===1&&(M==null||M(f.buttonId)),m({type:0}),(Pt=f.button)==null||Pt.focus()))}),H=ln(Q=>{Q.preventDefault(),Q.stopPropagation()}),K=f.popoverState===0,at=Y.useMemo(()=>({open:K}),[K]),ft=mC(e,x),et=I?{ref:N,type:ft,onKeyDown:$,onClick:B}:{ref:O,id:f.buttonId,type:ft,"aria-expanded":f.popoverState===0,"aria-controls":f.panel?f.panelId:void 0,onKeyDown:$,onKeyUp:z,onClick:B,onMouseDown:H},nt=bC(),W=ln(()=>{let Q=f.panel;if(!Q)return;function yt(){Er(nt.current,{[co.Forwards]:()=>Fo(Q,Qi.First),[co.Backwards]:()=>Fo(Q,Qi.Last)})===ng.Error&&Fo(Pg().filter(Pt=>Pt.dataset.headlessuiFocusGuard!=="true"),Er(nt.current,{[co.Forwards]:Qi.Next,[co.Backwards]:Qi.Previous}),{relativeTo:f.button})}yt()});return we.createElement(we.Fragment,null,Kr({ourProps:et,theirProps:h,slot:at,defaultTag:mnt,name:"Popover.Button"}),K&&!I&&y&&we.createElement(Mh,{id:w,features:lu.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:W}))}let _nt="div",ynt=$o.RenderStrategy|$o.Static;function vnt(e,r){let s=es(),{id:a=`headlessui-popover-overlay-${s}`,...h}=e,[{popoverState:f},m]=Zx("Popover.Overlay"),y=Yr(r),x=Oh(),w=x!==null?(x&Rr.Open)===Rr.Open:f===0,T=ln(I=>{if(Ig(I.currentTarget))return I.preventDefault();m({type:1})}),M=Y.useMemo(()=>({open:f===0}),[f]);return Kr({ourProps:{ref:y,id:a,"aria-hidden":!0,onClick:T},theirProps:h,slot:M,defaultTag:_nt,features:ynt,visible:w,name:"Popover.Overlay"})}let xnt="div",bnt=$o.RenderStrategy|$o.Static;function wnt(e,r){let s=es(),{id:a=`headlessui-popover-panel-${s}`,focus:h=!1,...f}=e,[m,y]=Zx("Popover.Panel"),{close:x,isPortalled:w}=IC("Popover.Panel"),T=`headlessui-focus-sentinel-before-${es()}`,M=`headlessui-focus-sentinel-after-${es()}`,I=Y.useRef(null),R=Yr(I,r,et=>{y({type:4,panel:et})}),O=Gl(I),N=yC();Ui(()=>(y({type:5,panelId:a}),()=>{y({type:5,panelId:null})}),[a,y]);let G=Oh(),$=G!==null?(G&Rr.Open)===Rr.Open:m.popoverState===0,z=ln(et=>{var nt;switch(et.key){case yr.Escape:if(m.popoverState!==0||!I.current||O!=null&&O.activeElement&&!I.current.contains(O.activeElement))return;et.preventDefault(),et.stopPropagation(),y({type:1}),(nt=m.button)==null||nt.focus();break}});Y.useEffect(()=>{var et;e.static||m.popoverState===1&&((et=e.unmount)==null||et)&&y({type:4,panel:null})},[m.popoverState,e.unmount,e.static,y]),Y.useEffect(()=>{if(m.__demoMode||!h||m.popoverState!==0||!I.current)return;let et=O==null?void 0:O.activeElement;I.current.contains(et)||Fo(I.current,Qi.First)},[m.__demoMode,h,I,m.popoverState]);let B=Y.useMemo(()=>({open:m.popoverState===0,close:x}),[m,x]),H={ref:R,id:a,onKeyDown:z,onBlur:h&&m.popoverState===0?et=>{var nt,W,Q,yt,Pt;let st=et.relatedTarget;st&&I.current&&((nt=I.current)!=null&&nt.contains(st)||(y({type:1}),((Q=(W=m.beforePanelSentinel.current)==null?void 0:W.contains)!=null&&Q.call(W,st)||(Pt=(yt=m.afterPanelSentinel.current)==null?void 0:yt.contains)!=null&&Pt.call(yt,st))&&st.focus({preventScroll:!0})))}:void 0,tabIndex:-1},K=bC(),at=ln(()=>{let et=I.current;if(!et)return;function nt(){Er(K.current,{[co.Forwards]:()=>{var W;Fo(et,Qi.First)===ng.Error&&((W=m.afterPanelSentinel.current)==null||W.focus())},[co.Backwards]:()=>{var W;(W=m.button)==null||W.focus({preventScroll:!0})}})}nt()}),ft=ln(()=>{let et=I.current;if(!et)return;function nt(){Er(K.current,{[co.Forwards]:()=>{var W;if(!m.button)return;let Q=Pg(),yt=Q.indexOf(m.button),Pt=Q.slice(0,yt+1),st=[...Q.slice(yt+1),...Pt];for(let St of st.slice())if(St.dataset.headlessuiFocusGuard==="true"||(W=m.panel)!=null&&W.contains(St)){let Rt=st.indexOf(St);Rt!==-1&&st.splice(Rt,1)}Fo(st,Qi.First,{sorted:!1})},[co.Backwards]:()=>{var W;Fo(et,Qi.Previous)===ng.Error&&((W=m.button)==null||W.focus())}})}nt()});return we.createElement(Xx.Provider,{value:a},$&&w&&we.createElement(Mh,{id:T,ref:m.beforePanelSentinel,features:lu.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:at}),Kr({mergeRefs:N,ourProps:H,theirProps:f,slot:B,defaultTag:xnt,features:bnt,visible:$,name:"Popover.Panel"}),$&&w&&we.createElement(Mh,{id:M,ref:m.afterPanelSentinel,features:lu.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:ft}))}let Snt="div";function Tnt(e,r){let s=Y.useRef(null),a=Yr(s,r),[h,f]=Y.useState([]),m=Xtt(),y=ln(N=>{f(G=>{let $=G.indexOf(N);if($!==-1){let z=G.slice();return z.splice($,1),z}return G})}),x=ln(N=>(f(G=>[...G,N]),()=>y(N))),w=ln(()=>{var N;let G=If(s);if(!G)return!1;let $=G.activeElement;return(N=s.current)!=null&&N.contains($)?!0:h.some(z=>{var B,H;return((B=G.getElementById(z.buttonId.current))==null?void 0:B.contains($))||((H=G.getElementById(z.panelId.current))==null?void 0:H.contains($))})}),T=ln(N=>{for(let G of h)G.buttonId.current!==N&&G.close()}),M=Y.useMemo(()=>({registerPopover:x,unregisterPopover:y,isFocusWithinPopoverGroup:w,closeOthers:T,mainTreeNodeRef:m.mainTreeNodeRef}),[x,y,w,T,m.mainTreeNodeRef]),I=Y.useMemo(()=>({}),[]),R=e,O={ref:a};return we.createElement(kC.Provider,{value:M},Kr({ourProps:O,theirProps:R,slot:I,defaultTag:Snt,name:"Popover.Group"}),we.createElement(m.MainTreeNode,null))}let Ent=Gr(pnt),Mnt=Gr(gnt),Ant=Gr(vnt),Cnt=Gr(wnt),Pnt=Gr(Tnt),Int=Object.assign(Ent,{Button:Mnt,Overlay:Ant,Panel:Cnt,Group:Pnt});function knt(e=0){let[r,s]=Y.useState(e),a=kg(),h=Y.useCallback(x=>{a.current&&s(w=>w|x)},[r,a]),f=Y.useCallback(x=>!!(r&x),[r]),m=Y.useCallback(x=>{a.current&&s(w=>w&~x)},[s,a]),y=Y.useCallback(x=>{a.current&&s(w=>w^x)},[s]);return{flags:r,addFlag:h,hasFlag:f,removeFlag:m,toggleFlag:y}}function Dnt(e){let r={called:!1};return(...s)=>{if(!r.called)return r.called=!0,e(...s)}}function MT(e,...r){e&&r.length>0&&e.classList.add(...r)}function AT(e,...r){e&&r.length>0&&e.classList.remove(...r)}function Rnt(e,r){let s=_a();if(!e)return s.dispose;let{transitionDuration:a,transitionDelay:h}=getComputedStyle(e),[f,m]=[a,h].map(x=>{let[w=0]=x.split(",").filter(Boolean).map(T=>T.includes("ms")?parseFloat(T):parseFloat(T)*1e3).sort((T,M)=>M-T);return w}),y=f+m;if(y!==0){s.group(w=>{w.setTimeout(()=>{r(),w.dispose()},y),w.addEventListener(e,"transitionrun",T=>{T.target===T.currentTarget&&w.dispose()})});let x=s.addEventListener(e,"transitionend",w=>{w.target===w.currentTarget&&(r(),x())})}else r();return s.add(()=>r()),s.dispose}function Ont(e,r,s,a){let h=s?"enter":"leave",f=_a(),m=a!==void 0?Dnt(a):()=>{};h==="enter"&&(e.removeAttribute("hidden"),e.style.display="");let y=Er(h,{enter:()=>r.enter,leave:()=>r.leave}),x=Er(h,{enter:()=>r.enterTo,leave:()=>r.leaveTo}),w=Er(h,{enter:()=>r.enterFrom,leave:()=>r.leaveFrom});return AT(e,...r.base,...r.enter,...r.enterTo,...r.enterFrom,...r.leave,...r.leaveFrom,...r.leaveTo,...r.entered),MT(e,...r.base,...y,...w),f.nextFrame(()=>{AT(e,...r.base,...y,...w),MT(e,...r.base,...y,...x),Rnt(e,()=>(AT(e,...r.base,...y),MT(e,...r.base,...r.entered),m()))}),f.dispose}function Lnt({immediate:e,container:r,direction:s,classes:a,onStart:h,onStop:f}){let m=kg(),y=Cg(),x=pa(s);Ui(()=>{e&&(x.current="enter")},[e]),Ui(()=>{let w=_a();y.add(w.dispose);let T=r.current;if(T&&x.current!=="idle"&&m.current)return w.dispose(),h.current(x.current),w.add(Ont(T,a.current,x.current==="enter",()=>{w.dispose(),f.current(x.current)})),w.dispose},[s])}function Cc(e=""){return e.split(/\s+/).filter(r=>r.length>1)}let Yx=Y.createContext(null);Yx.displayName="TransitionContext";var znt=(e=>(e.Visible="visible",e.Hidden="hidden",e))(znt||{});function Nnt(){let e=Y.useContext(Yx);if(e===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}function Fnt(){let e=Y.useContext(Kx);if(e===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}let Kx=Y.createContext(null);Kx.displayName="NestingContext";function Jx(e){return"children"in e?Jx(e.children):e.current.filter(({el:r})=>r.current!==null).filter(({state:r})=>r==="visible").length>0}function SV(e,r){let s=pa(e),a=Y.useRef([]),h=kg(),f=Cg(),m=ln((R,O=jc.Hidden)=>{let N=a.current.findIndex(({el:G})=>G===R);N!==-1&&(Er(O,{[jc.Unmount](){a.current.splice(N,1)},[jc.Hidden](){a.current[N].state="hidden"}}),f.microTask(()=>{var G;!Jx(a)&&h.current&&((G=s.current)==null||G.call(s))}))}),y=ln(R=>{let O=a.current.find(({el:N})=>N===R);return O?O.state!=="visible"&&(O.state="visible"):a.current.push({el:R,state:"visible"}),()=>m(R,jc.Unmount)}),x=Y.useRef([]),w=Y.useRef(Promise.resolve()),T=Y.useRef({enter:[],leave:[],idle:[]}),M=ln((R,O,N)=>{x.current.splice(0),r&&(r.chains.current[O]=r.chains.current[O].filter(([G])=>G!==R)),r==null||r.chains.current[O].push([R,new Promise(G=>{x.current.push(G)})]),r==null||r.chains.current[O].push([R,new Promise(G=>{Promise.all(T.current[O].map(([$,z])=>z)).then(()=>G())})]),O==="enter"?w.current=w.current.then(()=>r==null?void 0:r.wait.current).then(()=>N(O)):N(O)}),I=ln((R,O,N)=>{Promise.all(T.current[O].splice(0).map(([G,$])=>$)).then(()=>{var G;(G=x.current.shift())==null||G()}).then(()=>N(O))});return Y.useMemo(()=>({children:a,register:y,unregister:m,onStart:M,onStop:I,wait:w,chains:T}),[y,m,a,M,I,T,w])}function Bnt(){}let jnt=["beforeEnter","afterEnter","beforeLeave","afterLeave"];function o4(e){var r;let s={};for(let a of jnt)s[a]=(r=e[a])!=null?r:Bnt;return s}function Vnt(e){let r=Y.useRef(o4(e));return Y.useEffect(()=>{r.current=o4(e)},[e]),r}let Unt="div",TV=$o.RenderStrategy;function $nt(e,r){var s,a;let{beforeEnter:h,afterEnter:f,beforeLeave:m,afterLeave:y,enter:x,enterFrom:w,enterTo:T,entered:M,leave:I,leaveFrom:R,leaveTo:O,...N}=e,G=Y.useRef(null),$=Yr(G,r),z=(s=N.unmount)==null||s?jc.Unmount:jc.Hidden,{show:B,appear:H,initial:K}=Nnt(),[at,ft]=Y.useState(B?"visible":"hidden"),et=Fnt(),{register:nt,unregister:W}=et;Y.useEffect(()=>nt(G),[nt,G]),Y.useEffect(()=>{if(z===jc.Hidden&&G.current){if(B&&at!=="visible"){ft("visible");return}return Er(at,{hidden:()=>W(G),visible:()=>nt(G)})}},[at,G,nt,W,B,z]);let Q=pa({base:Cc(N.className),enter:Cc(x),enterFrom:Cc(w),enterTo:Cc(T),entered:Cc(M),leave:Cc(I),leaveFrom:Cc(R),leaveTo:Cc(O)}),yt=Vnt({beforeEnter:h,afterEnter:f,beforeLeave:m,afterLeave:y}),Pt=Pf();Y.useEffect(()=>{if(Pt&&at==="visible"&&G.current===null)throw new Error("Did you forget to passthrough the `ref` to the actual DOM node?")},[G,at,Pt]);let st=K&&!H,St=H&&B&&K,Rt=!Pt||st?"idle":B?"enter":"leave",Zt=knt(0),Ft=ln(me=>Er(me,{enter:()=>{Zt.addFlag(Rr.Opening),yt.current.beforeEnter()},leave:()=>{Zt.addFlag(Rr.Closing),yt.current.beforeLeave()},idle:()=>{}})),$t=ln(me=>Er(me,{enter:()=>{Zt.removeFlag(Rr.Opening),yt.current.afterEnter()},leave:()=>{Zt.removeFlag(Rr.Closing),yt.current.afterLeave()},idle:()=>{}})),ee=SV(()=>{ft("hidden"),W(G)},et),se=Y.useRef(!1);Lnt({immediate:St,container:G,classes:Q,direction:Rt,onStart:pa(me=>{se.current=!0,ee.onStart(G,me,Ft)}),onStop:pa(me=>{se.current=!1,ee.onStop(G,me,$t),me==="leave"&&!Jx(ee)&&(ft("hidden"),W(G))})});let Ot=N,Me={ref:$};return St?Ot={...Ot,className:Xv(N.className,...Q.current.enter,...Q.current.enterFrom)}:se.current&&(Ot.className=Xv(N.className,(a=G.current)==null?void 0:a.className),Ot.className===""&&delete Ot.className),we.createElement(Kx.Provider,{value:ee},we.createElement(Hx,{value:Er(at,{visible:Rr.Open,hidden:Rr.Closed})|Zt.flags},Kr({ourProps:Me,theirProps:Ot,defaultTag:Unt,features:TV,visible:at==="visible",name:"Transition.Child"})))}function Gnt(e,r){let{show:s,appear:a=!1,unmount:h=!0,...f}=e,m=Y.useRef(null),y=Yr(m,r);Pf();let x=Oh();if(s===void 0&&x!==null&&(s=(x&Rr.Open)===Rr.Open),![!0,!1].includes(s))throw new Error("A <Transition /> is used but it is missing a `show={true | false}` prop.");let[w,T]=Y.useState(s?"visible":"hidden"),M=SV(()=>{T("hidden")}),[I,R]=Y.useState(!0),O=Y.useRef([s]);Ui(()=>{I!==!1&&O.current[O.current.length-1]!==s&&(O.current.push(s),R(!1))},[O,s]);let N=Y.useMemo(()=>({show:s,appear:a,initial:I}),[s,a,I]);Y.useEffect(()=>{if(s)T("visible");else if(!Jx(M))T("hidden");else{let B=m.current;if(!B)return;let H=B.getBoundingClientRect();H.x===0&&H.y===0&&H.width===0&&H.height===0&&T("hidden")}},[s,M]);let G={unmount:h},$=ln(()=>{var B;I&&R(!1),(B=e.beforeEnter)==null||B.call(e)}),z=ln(()=>{var B;I&&R(!1),(B=e.beforeLeave)==null||B.call(e)});return we.createElement(Kx.Provider,{value:M},we.createElement(Yx.Provider,{value:N},Kr({ourProps:{...G,as:Y.Fragment,children:we.createElement(EV,{ref:y,...G,...f,beforeEnter:$,beforeLeave:z})},theirProps:{},defaultTag:Y.Fragment,features:TV,visible:w==="visible",name:"Transition"})))}function Wnt(e,r){let s=Y.useContext(Yx)!==null,a=Oh()!==null;return we.createElement(we.Fragment,null,!s&&a?we.createElement(gM,{ref:r,...e}):we.createElement(EV,{ref:r,...e}))}let gM=Gr(Gnt),EV=Gr($nt),Hnt=Gr(Wnt),qnt=Object.assign(gM,{Child:Hnt,Root:gM});function Znt({title:e,titleId:r,...s},a){return Y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":r},s),e?Y.createElement("title",{id:r},e):null,Y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"}))}const Xnt=Y.forwardRef(Znt),Ynt=Xnt;function Knt({title:e,titleId:r,...s},a){return Y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":r},s),e?Y.createElement("title",{id:r},e):null,Y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"}))}const Jnt=Y.forwardRef(Knt),MV=Jnt;function Qnt({title:e,titleId:r,...s},a){return Y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":r},s),e?Y.createElement("title",{id:r},e):null,Y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0"}))}const trt=Y.forwardRef(Qnt),ert=trt;function nrt({title:e,titleId:r,...s},a){return Y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":r},s),e?Y.createElement("title",{id:r},e):null,Y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 6a7.5 7.5 0 1 0 7.5 7.5h-7.5V6Z"}),Y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 10.5H21A7.5 7.5 0 0 0 13.5 3v7.5Z"}))}const rrt=Y.forwardRef(nrt),irt=rrt;function srt({title:e,titleId:r,...s},a){return Y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":r},s),e?Y.createElement("title",{id:r},e):null,Y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.042 21.672 13.684 16.6m0 0-2.51 2.225.569-9.47 5.227 7.917-3.286-.672ZM12 2.25V4.5m5.834.166-1.591 1.591M20.25 10.5H18M7.757 14.743l-1.59 1.59M6 10.5H3.75m4.007-4.243-1.59-1.59"}))}const ort=Y.forwardRef(srt),art=ort;function lrt({title:e,titleId:r,...s},a){return Y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":r},s),e?Y.createElement("title",{id:r},e):null,Y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.864 4.243A7.5 7.5 0 0 1 19.5 10.5c0 2.92-.556 5.709-1.568 8.268M5.742 6.364A7.465 7.465 0 0 0 4.5 10.5a7.464 7.464 0 0 1-1.15 3.993m1.989 3.559A11.209 11.209 0 0 0 8.25 10.5a3.75 3.75 0 1 1 7.5 0c0 .527-.021 1.049-.064 1.565M12 10.5a14.94 14.94 0 0 1-3.6 9.75m6.633-4.596a18.666 18.666 0 0 1-2.485 5.33"}))}const crt=Y.forwardRef(lrt),urt=crt;function hrt({title:e,titleId:r,...s},a){return Y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":r},s),e?Y.createElement("title",{id:r},e):null,Y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 16.875h3.375m0 0h3.375m-3.375 0V13.5m0 3.375v3.375M6 10.5h2.25a2.25 2.25 0 0 0 2.25-2.25V6a2.25 2.25 0 0 0-2.25-2.25H6A2.25 2.25 0 0 0 3.75 6v2.25A2.25 2.25 0 0 0 6 10.5Zm0 9.75h2.25A2.25 2.25 0 0 0 10.5 18v-2.25a2.25 2.25 0 0 0-2.25-2.25H6a2.25 2.25 0 0 0-2.25 2.25V18A2.25 2.25 0 0 0 6 20.25Zm9.75-9.75H18a2.25 2.25 0 0 0 2.25-2.25V6A2.25 2.25 0 0 0 18 3.75h-2.25A2.25 2.25 0 0 0 13.5 6v2.25a2.25 2.25 0 0 0 2.25 2.25Z"}))}const drt=Y.forwardRef(hrt),frt=drt;function prt({title:e,titleId:r,...s},a){return Y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":r},s),e?Y.createElement("title",{id:r},e):null,Y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const mrt=Y.forwardRef(prt),AV=mrt;function grt({title:e,titleId:r,...s},a){return Y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":r},s),e?Y.createElement("title",{id:r},e):null,Y.createElement("path",{fillRule:"evenodd",d:"M5.22 8.22a.75.75 0 0 1 1.06 0L10 11.94l3.72-3.72a.75.75 0 1 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L5.22 9.28a.75.75 0 0 1 0-1.06Z",clipRule:"evenodd"}))}const _rt=Y.forwardRef(grt),yrt=_rt;function vrt({title:e,titleId:r,...s},a){return Y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":r},s),e?Y.createElement("title",{id:r},e):null,Y.createElement("path",{fillRule:"evenodd",d:"M2 3.5A1.5 1.5 0 0 1 3.5 2h1.148a1.5 1.5 0 0 1 1.465 1.175l.716 3.223a1.5 1.5 0 0 1-1.052 1.767l-.933.267c-.41.117-.643.555-.48.95a11.542 11.542 0 0 0 6.254 6.254c.395.163.833-.07.95-.48l.267-.933a1.5 1.5 0 0 1 1.767-1.052l3.223.716A1.5 1.5 0 0 1 18 15.352V16.5a1.5 1.5 0 0 1-1.5 1.5H15c-1.149 0-2.263-.15-3.326-.43A13.022 13.022 0 0 1 2.43 8.326 13.019 13.019 0 0 1 2 5V3.5Z",clipRule:"evenodd"}))}const xrt=Y.forwardRef(vrt),brt=xrt;function wrt({title:e,titleId:r,...s},a){return Y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":r},s),e?Y.createElement("title",{id:r},e):null,Y.createElement("path",{fillRule:"evenodd",d:"M2 10a8 8 0 1 1 16 0 8 8 0 0 1-16 0Zm6.39-2.908a.75.75 0 0 1 .766.027l3.5 2.25a.75.75 0 0 1 0 1.262l-3.5 2.25A.75.75 0 0 1 8 12.25v-4.5a.75.75 0 0 1 .39-.658Z",clipRule:"evenodd"}))}const Srt=Y.forwardRef(wrt),Trt=Srt,Kv="/assets/AgapayReadylogo-L614LLUk.png",Ert=[{name:"Analytics",description:"Get a better understanding of your traffic",to:"/",icon:irt},{name:"Engagement",description:"Speak directly to your customers",to:"/",icon:art},{name:"Security",description:"Your customers data will be safe and secure",to:"/",icon:urt},{name:"Integrations",description:"Connect with third-party tools",to:"/",icon:frt},{name:"Automations",description:"Build strategic funnels that will convert",to:"/",icon:Ynt}],Mrt=[{name:"Watch demo",to:"/",icon:Trt},{name:"Contact sales",to:"/",icon:brt}];function Art(...e){return e.filter(Boolean).join(" ")}function Crt(){const[e,r]=Y.useState(!1);return D.jsxs("div",{className:"bg-white",children:[D.jsxs("nav",{className:"mx-auto flex max-w-7xl items-center justify-between p-6 lg:px-8","aria-label":"Global",children:[D.jsx("div",{className:"flex lg:flex-1",children:D.jsxs(qn,{to:"/",className:"-m-1.5 p-1.5",children:[D.jsx("span",{className:"sr-only",children:"Your Company"}),D.jsx("img",{className:"h-10 w-auto",src:Kv,alt:"logo"})]})}),D.jsx("div",{className:"flex lg:hidden",children:D.jsxs("button",{type:"button",className:"-m-2.5 inline-flex items-center justify-center rounded-md p-2.5 text-gray-700",onClick:()=>r(!0),children:[D.jsx("span",{className:"sr-only",children:"Open main menu"}),D.jsx(MV,{className:"h-6 w-6","aria-hidden":"true"})]})}),D.jsxs(Int.Group,{className:"hidden lg:flex lg:gap-x-12",children:[D.jsx(qn,{to:"/",className:"text-sm font-semibold leading-6 text-gray-900",children:"Features"}),D.jsx(qn,{to:"/",className:"text-sm font-semibold leading-6 text-gray-900",children:"Marketplace"}),D.jsx(qn,{to:"/evacuation/guidelines",className:"text-sm font-semibold leading-6 text-gray-900",children:"Evacuation Guidelines"}),D.jsx(qn,{to:"/blog",className:"text-sm font-semibold leading-6 text-gray-900",children:"Blog"})]}),D.jsx("div",{className:"hidden lg:flex lg:flex-1 lg:justify-end",children:D.jsxs(qn,{to:"/login",className:"text-sm font-semibold leading-6 text-gray-900",children:["Log in ",D.jsx("span",{"aria-hidden":"true",children:""})]})})]}),D.jsxs(n4,{as:"div",className:"lg:hidden",open:e,onClose:r,children:[D.jsx("div",{className:"fixed inset-0 z-10"}),D.jsxs(n4.Panel,{className:"fixed inset-y-0 right-0 z-10 w-full overflow-y-auto bg-white px-6 py-6 sm:max-w-sm sm:ring-1 sm:ring-gray-900/10",children:[D.jsxs("div",{className:"flex items-center justify-between",children:[D.jsxs(qn,{to:"/",className:"-m-1.5 p-1.5",children:[D.jsx("span",{className:"sr-only",children:"Your Company"}),D.jsx("img",{className:"h-10 w-auto",src:Kv,alt:"logo"})]}),D.jsxs("button",{type:"button",className:"-m-2.5 rounded-md p-2.5 text-gray-700",onClick:()=>r(!1),children:[D.jsx("span",{className:"sr-only",children:"Close menu"}),D.jsx(AV,{className:"h-6 w-6","aria-hidden":"true"})]})]}),D.jsx("div",{className:"mt-6 flow-root",children:D.jsxs("div",{className:"-my-6 divide-y divide-gray-500/10",children:[D.jsxs("div",{className:"space-y-2 py-6",children:[D.jsx(hh,{as:"div",className:"-mx-3",children:({open:s})=>D.jsxs(D.Fragment,{children:[D.jsxs(hh.Button,{className:"flex w-full items-center justify-between rounded-lg py-2 pl-3 pr-3.5 text-base font-semibold leading-7 text-gray-900 hover:bg-gray-50",children:["Product",D.jsx(yrt,{className:Art(s?"rotate-180":"","h-5 w-5 flex-none"),"aria-hidden":"true"})]}),D.jsx(hh.Panel,{className:"mt-2 space-y-2",children:[...Ert,...Mrt].map(a=>D.jsx(hh.Button,{as:qn,to:a.to,className:"block rounded-lg py-2 pl-6 pr-3 text-sm font-semibold leading-7 text-gray-900 hover:bg-gray-50",children:a.name},a.name))})]})}),D.jsx(qn,{to:"/",className:"-mx-3 block rounded-lg px-3 py-2 text-base font-semibold leading-7 text-gray-900 hover:bg-gray-50",children:"Features"}),D.jsx(qn,{to:"/",className:"-mx-3 block rounded-lg px-3 py-2 text-base font-semibold leading-7 text-gray-900 hover:bg-gray-50",children:"Marketplace"}),D.jsx(qn,{to:"/",className:"-mx-3 block rounded-lg px-3 py-2 text-base font-semibold leading-7 text-gray-900 hover:bg-gray-50",children:"Company"}),D.jsx(qn,{to:"/evacuation/guidelines",className:"-mx-3 block rounded-lg px-3 py-2 text-base font-semibold leading-7 text-gray-900 hover:bg-gray-50",children:"Evacuation Guidelines"}),D.jsx(qn,{to:"/blog",className:"-mx-3 block rounded-lg px-3 py-2 text-base font-semibold leading-7 text-gray-900 hover:bg-gray-50",children:"Blog"})]}),D.jsxs("div",{className:"py-6",children:[D.jsx(qn,{to:"/login",className:"-mx-3 block rounded-lg px-3 py-2.5 text-base font-semibold leading-7 text-gray-900 hover:bg-gray-50",children:"Log in"}),D.jsx(qn,{to:"/register",className:"-mx-3 block rounded-lg px-3 py-2.5 text-base font-semibold leading-7 text-gray-900 hover:bg-gray-50",children:"Register"})]})]})})]})]})]})}const rg="/assets/vite-_AdFxfIa.png";function Prt(){return D.jsxs("div",{className:"footer p-10 bg-base-200 text-base-content",children:[D.jsxs("aside",{children:[D.jsx("img",{src:rg,alt:"Vite Logo",className:"h-20 w-auto"}),D.jsxs("p",{children:["AgapayReady",D.jsx("br",{}),"Emergency Response App since 2024"]})]}),D.jsxs("nav",{children:[D.jsx("h6",{className:"footer-title",children:"Services"}),D.jsx("a",{className:"link link-hover",children:"Evacuation"}),D.jsx("a",{className:"link link-hover",children:"Emergency Drills"}),D.jsx("a",{className:"link link-hover",children:"Emergency Contacts"}),D.jsx("a",{className:"link link-hover",children:"Real Time Updates"})]}),D.jsxs("nav",{children:[D.jsx("h6",{className:"footer-title",children:"Company"}),D.jsx("a",{className:"link link-hover",children:"About us"}),D.jsx("a",{className:"link link-hover",children:"Contact"}),D.jsx("a",{className:"link link-hover",children:"Blog"}),D.jsx("a",{className:"link link-hover",children:"Announcement"})]}),D.jsxs("nav",{children:[D.jsx("h6",{className:"footer-title",children:"Legal"}),D.jsx("a",{className:"link link-hover",children:"Terms of use"}),D.jsx("a",{className:"link link-hover",children:"Privacy policy"}),D.jsx("a",{className:"link link-hover",children:"Cookie policy"})]})]})}var CV={exports:{}};(function(e,r){(function(s,a){e.exports=a()})(Fa,function(){return function(s){function a(f){if(h[f])return h[f].exports;var m=h[f]={exports:{},id:f,loaded:!1};return s[f].call(m.exports,m,m.exports,a),m.loaded=!0,m.exports}var h={};return a.m=s,a.c=h,a.p="dist/",a(0)}([function(s,a,h){function f(st){return st&&st.__esModule?st:{default:st}}var m=Object.assign||function(st){for(var St=1;St<arguments.length;St++){var Rt=arguments[St];for(var Zt in Rt)Object.prototype.hasOwnProperty.call(Rt,Zt)&&(st[Zt]=Rt[Zt])}return st},y=h(1),x=(f(y),h(6)),w=f(x),T=h(7),M=f(T),I=h(8),R=f(I),O=h(9),N=f(O),G=h(10),$=f(G),z=h(11),B=f(z),H=h(14),K=f(H),at=[],ft=!1,et={offset:120,delay:0,easing:"ease",duration:400,disable:!1,once:!1,startEvent:"DOMContentLoaded",throttleDelay:99,debounceDelay:50,disableMutationObserver:!1},nt=function(){var st=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(st&&(ft=!0),ft)return at=(0,B.default)(at,et),(0,$.default)(at,et.once),at},W=function(){at=(0,K.default)(),nt()},Q=function(){at.forEach(function(st,St){st.node.removeAttribute("data-aos"),st.node.removeAttribute("data-aos-easing"),st.node.removeAttribute("data-aos-duration"),st.node.removeAttribute("data-aos-delay")})},yt=function(st){return st===!0||st==="mobile"&&N.default.mobile()||st==="phone"&&N.default.phone()||st==="tablet"&&N.default.tablet()||typeof st=="function"&&st()===!0},Pt=function(st){et=m(et,st),at=(0,K.default)();var St=document.all&&!window.atob;return yt(et.disable)||St?Q():(et.disableMutationObserver||R.default.isSupported()||(console.info(`
      aos: MutationObserver is not supported on this browser,
      code mutations observing has been disabled.
      You may have to call "refreshHard()" by yourself.
    `),et.disableMutationObserver=!0),document.querySelector("body").setAttribute("data-aos-easing",et.easing),document.querySelector("body").setAttribute("data-aos-duration",et.duration),document.querySelector("body").setAttribute("data-aos-delay",et.delay),et.startEvent==="DOMContentLoaded"&&["complete","interactive"].indexOf(document.readyState)>-1?nt(!0):et.startEvent==="load"?window.addEventListener(et.startEvent,function(){nt(!0)}):document.addEventListener(et.startEvent,function(){nt(!0)}),window.addEventListener("resize",(0,M.default)(nt,et.debounceDelay,!0)),window.addEventListener("orientationchange",(0,M.default)(nt,et.debounceDelay,!0)),window.addEventListener("scroll",(0,w.default)(function(){(0,$.default)(at,et.once)},et.throttleDelay)),et.disableMutationObserver||R.default.ready("[data-aos]",W),at)};s.exports={init:Pt,refresh:nt,refreshHard:W}},function(s,a){},,,,,function(s,a){(function(h){function f(yt,Pt,st){function St(Ne){var Yn=me,_n=kt;return me=kt=void 0,Fe=Ne,Ct=yt.apply(_n,Yn)}function Rt(Ne){return Fe=Ne,Ae=setTimeout($t,Pt),Oe?St(Ne):Ct}function Zt(Ne){var Yn=Ne-he,_n=Ne-Fe,Qt=Pt-Yn;return Qe?W(Qt,Wt-_n):Qt}function Ft(Ne){var Yn=Ne-he,_n=Ne-Fe;return he===void 0||Yn>=Pt||Yn<0||Qe&&_n>=Wt}function $t(){var Ne=Q();return Ft(Ne)?ee(Ne):void(Ae=setTimeout($t,Zt(Ne)))}function ee(Ne){return Ae=void 0,Le&&me?St(Ne):(me=kt=void 0,Ct)}function se(){Ae!==void 0&&clearTimeout(Ae),Fe=0,me=he=kt=Ae=void 0}function Ot(){return Ae===void 0?Ct:ee(Q())}function Me(){var Ne=Q(),Yn=Ft(Ne);if(me=arguments,kt=this,he=Ne,Yn){if(Ae===void 0)return Rt(he);if(Qe)return Ae=setTimeout($t,Pt),St(he)}return Ae===void 0&&(Ae=setTimeout($t,Pt)),Ct}var me,kt,Wt,Ct,Ae,he,Fe=0,Oe=!1,Qe=!1,Le=!0;if(typeof yt!="function")throw new TypeError(I);return Pt=T(Pt)||0,y(st)&&(Oe=!!st.leading,Qe="maxWait"in st,Wt=Qe?nt(T(st.maxWait)||0,Pt):Wt,Le="trailing"in st?!!st.trailing:Le),Me.cancel=se,Me.flush=Ot,Me}function m(yt,Pt,st){var St=!0,Rt=!0;if(typeof yt!="function")throw new TypeError(I);return y(st)&&(St="leading"in st?!!st.leading:St,Rt="trailing"in st?!!st.trailing:Rt),f(yt,Pt,{leading:St,maxWait:Pt,trailing:Rt})}function y(yt){var Pt=typeof yt>"u"?"undefined":M(yt);return!!yt&&(Pt=="object"||Pt=="function")}function x(yt){return!!yt&&(typeof yt>"u"?"undefined":M(yt))=="object"}function w(yt){return(typeof yt>"u"?"undefined":M(yt))=="symbol"||x(yt)&&et.call(yt)==O}function T(yt){if(typeof yt=="number")return yt;if(w(yt))return R;if(y(yt)){var Pt=typeof yt.valueOf=="function"?yt.valueOf():yt;yt=y(Pt)?Pt+"":Pt}if(typeof yt!="string")return yt===0?yt:+yt;yt=yt.replace(N,"");var st=$.test(yt);return st||z.test(yt)?B(yt.slice(2),st?2:8):G.test(yt)?R:+yt}var M=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(yt){return typeof yt}:function(yt){return yt&&typeof Symbol=="function"&&yt.constructor===Symbol&&yt!==Symbol.prototype?"symbol":typeof yt},I="Expected a function",R=NaN,O="[object Symbol]",N=/^\s+|\s+$/g,G=/^[-+]0x[0-9a-f]+$/i,$=/^0b[01]+$/i,z=/^0o[0-7]+$/i,B=parseInt,H=(typeof h>"u"?"undefined":M(h))=="object"&&h&&h.Object===Object&&h,K=(typeof self>"u"?"undefined":M(self))=="object"&&self&&self.Object===Object&&self,at=H||K||Function("return this")(),ft=Object.prototype,et=ft.toString,nt=Math.max,W=Math.min,Q=function(){return at.Date.now()};s.exports=m}).call(a,function(){return this}())},function(s,a){(function(h){function f(Q,yt,Pt){function st(Le){var Ne=Me,Yn=me;return Me=me=void 0,he=Le,Wt=Q.apply(Yn,Ne)}function St(Le){return he=Le,Ct=setTimeout(Ft,yt),Fe?st(Le):Wt}function Rt(Le){var Ne=Le-Ae,Yn=Le-he,_n=yt-Ne;return Oe?nt(_n,kt-Yn):_n}function Zt(Le){var Ne=Le-Ae,Yn=Le-he;return Ae===void 0||Ne>=yt||Ne<0||Oe&&Yn>=kt}function Ft(){var Le=W();return Zt(Le)?$t(Le):void(Ct=setTimeout(Ft,Rt(Le)))}function $t(Le){return Ct=void 0,Qe&&Me?st(Le):(Me=me=void 0,Wt)}function ee(){Ct!==void 0&&clearTimeout(Ct),he=0,Me=Ae=me=Ct=void 0}function se(){return Ct===void 0?Wt:$t(W())}function Ot(){var Le=W(),Ne=Zt(Le);if(Me=arguments,me=this,Ae=Le,Ne){if(Ct===void 0)return St(Ae);if(Oe)return Ct=setTimeout(Ft,yt),st(Ae)}return Ct===void 0&&(Ct=setTimeout(Ft,yt)),Wt}var Me,me,kt,Wt,Ct,Ae,he=0,Fe=!1,Oe=!1,Qe=!0;if(typeof Q!="function")throw new TypeError(M);return yt=w(yt)||0,m(Pt)&&(Fe=!!Pt.leading,Oe="maxWait"in Pt,kt=Oe?et(w(Pt.maxWait)||0,yt):kt,Qe="trailing"in Pt?!!Pt.trailing:Qe),Ot.cancel=ee,Ot.flush=se,Ot}function m(Q){var yt=typeof Q>"u"?"undefined":T(Q);return!!Q&&(yt=="object"||yt=="function")}function y(Q){return!!Q&&(typeof Q>"u"?"undefined":T(Q))=="object"}function x(Q){return(typeof Q>"u"?"undefined":T(Q))=="symbol"||y(Q)&&ft.call(Q)==R}function w(Q){if(typeof Q=="number")return Q;if(x(Q))return I;if(m(Q)){var yt=typeof Q.valueOf=="function"?Q.valueOf():Q;Q=m(yt)?yt+"":yt}if(typeof Q!="string")return Q===0?Q:+Q;Q=Q.replace(O,"");var Pt=G.test(Q);return Pt||$.test(Q)?z(Q.slice(2),Pt?2:8):N.test(Q)?I:+Q}var T=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Q){return typeof Q}:function(Q){return Q&&typeof Symbol=="function"&&Q.constructor===Symbol&&Q!==Symbol.prototype?"symbol":typeof Q},M="Expected a function",I=NaN,R="[object Symbol]",O=/^\s+|\s+$/g,N=/^[-+]0x[0-9a-f]+$/i,G=/^0b[01]+$/i,$=/^0o[0-7]+$/i,z=parseInt,B=(typeof h>"u"?"undefined":T(h))=="object"&&h&&h.Object===Object&&h,H=(typeof self>"u"?"undefined":T(self))=="object"&&self&&self.Object===Object&&self,K=B||H||Function("return this")(),at=Object.prototype,ft=at.toString,et=Math.max,nt=Math.min,W=function(){return K.Date.now()};s.exports=f}).call(a,function(){return this}())},function(s,a){function h(T){var M=void 0,I=void 0;for(M=0;M<T.length;M+=1)if(I=T[M],I.dataset&&I.dataset.aos||I.children&&h(I.children))return!0;return!1}function f(){return window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver}function m(){return!!f()}function y(T,M){var I=window.document,R=f(),O=new R(x);w=M,O.observe(I.documentElement,{childList:!0,subtree:!0,removedNodes:!0})}function x(T){T&&T.forEach(function(M){var I=Array.prototype.slice.call(M.addedNodes),R=Array.prototype.slice.call(M.removedNodes),O=I.concat(R);if(h(O))return w()})}Object.defineProperty(a,"__esModule",{value:!0});var w=function(){};a.default={isSupported:m,ready:y}},function(s,a){function h(I,R){if(!(I instanceof R))throw new TypeError("Cannot call a class as a function")}function f(){return navigator.userAgent||navigator.vendor||window.opera||""}Object.defineProperty(a,"__esModule",{value:!0});var m=function(){function I(R,O){for(var N=0;N<O.length;N++){var G=O[N];G.enumerable=G.enumerable||!1,G.configurable=!0,"value"in G&&(G.writable=!0),Object.defineProperty(R,G.key,G)}}return function(R,O,N){return O&&I(R.prototype,O),N&&I(R,N),R}}(),y=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i,x=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i,w=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i,T=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i,M=function(){function I(){h(this,I)}return m(I,[{key:"phone",value:function(){var R=f();return!(!y.test(R)&&!x.test(R.substr(0,4)))}},{key:"mobile",value:function(){var R=f();return!(!w.test(R)&&!T.test(R.substr(0,4)))}},{key:"tablet",value:function(){return this.mobile()&&!this.phone()}}]),I}();a.default=new M},function(s,a){Object.defineProperty(a,"__esModule",{value:!0});var h=function(m,y,x){var w=m.node.getAttribute("data-aos-once");y>m.position?m.node.classList.add("aos-animate"):typeof w<"u"&&(w==="false"||!x&&w!=="true")&&m.node.classList.remove("aos-animate")},f=function(m,y){var x=window.pageYOffset,w=window.innerHeight;m.forEach(function(T,M){h(T,w+x,y)})};a.default=f},function(s,a,h){function f(w){return w&&w.__esModule?w:{default:w}}Object.defineProperty(a,"__esModule",{value:!0});var m=h(12),y=f(m),x=function(w,T){return w.forEach(function(M,I){M.node.classList.add("aos-init"),M.position=(0,y.default)(M.node,T.offset)}),w};a.default=x},function(s,a,h){function f(w){return w&&w.__esModule?w:{default:w}}Object.defineProperty(a,"__esModule",{value:!0});var m=h(13),y=f(m),x=function(w,T){var M=0,I=0,R=window.innerHeight,O={offset:w.getAttribute("data-aos-offset"),anchor:w.getAttribute("data-aos-anchor"),anchorPlacement:w.getAttribute("data-aos-anchor-placement")};switch(O.offset&&!isNaN(O.offset)&&(I=parseInt(O.offset)),O.anchor&&document.querySelectorAll(O.anchor)&&(w=document.querySelectorAll(O.anchor)[0]),M=(0,y.default)(w).top,O.anchorPlacement){case"top-bottom":break;case"center-bottom":M+=w.offsetHeight/2;break;case"bottom-bottom":M+=w.offsetHeight;break;case"top-center":M+=R/2;break;case"bottom-center":M+=R/2+w.offsetHeight;break;case"center-center":M+=R/2+w.offsetHeight/2;break;case"top-top":M+=R;break;case"bottom-top":M+=w.offsetHeight+R;break;case"center-top":M+=w.offsetHeight/2+R}return O.anchorPlacement||O.offset||isNaN(T)||(I=T),M+I};a.default=x},function(s,a){Object.defineProperty(a,"__esModule",{value:!0});var h=function(f){for(var m=0,y=0;f&&!isNaN(f.offsetLeft)&&!isNaN(f.offsetTop);)m+=f.offsetLeft-(f.tagName!="BODY"?f.scrollLeft:0),y+=f.offsetTop-(f.tagName!="BODY"?f.scrollTop:0),f=f.offsetParent;return{top:y,left:m}};a.default=h},function(s,a){Object.defineProperty(a,"__esModule",{value:!0});var h=function(f){return f=f||document.querySelectorAll("[data-aos]"),Array.prototype.map.call(f,function(m){return{node:m}})};a.default=h}])})})(CV);var Irt=CV.exports;const PV=mB(Irt);var IV={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},a4=we.createContext&&we.createContext(IV),krt=["attr","size","title"];function Drt(e,r){if(e==null)return{};var s=Rrt(e,r),a,h;if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);for(h=0;h<f.length;h++)a=f[h],!(r.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(s[a]=e[a])}return s}function Rrt(e,r){if(e==null)return{};var s={},a=Object.keys(e),h,f;for(f=0;f<a.length;f++)h=a[f],!(r.indexOf(h)>=0)&&(s[h]=e[h]);return s}function Jv(){return Jv=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Jv.apply(this,arguments)}function l4(e,r){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),s.push.apply(s,a)}return s}function Qv(e){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?l4(Object(s),!0).forEach(function(a){Ort(e,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):l4(Object(s)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(s,a))})}return e}function Ort(e,r,s){return r=Lrt(r),r in e?Object.defineProperty(e,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[r]=s,e}function Lrt(e){var r=zrt(e,"string");return typeof r=="symbol"?r:String(r)}function zrt(e,r){if(typeof e!="object"||e===null)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var a=s.call(e,r||"default");if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function kV(e){return e&&e.map((r,s)=>we.createElement(r.tag,Qv({key:s},r.attr),kV(r.child)))}function ms(e){return r=>we.createElement(Nrt,Jv({attr:Qv({},e.attr)},r),kV(e.child))}function Nrt(e){var r=s=>{var{attr:a,size:h,title:f}=e,m=Drt(e,krt),y=h||s.size||"1em",x;return s.className&&(x=s.className),e.className&&(x=(x?x+" ":"")+e.className),we.createElement("svg",Jv({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},s.attr,a,m,{className:x,style:Qv(Qv({color:e.color||s.color},s.style),e.style),height:y,width:y,xmlns:"http://www.w3.org/2000/svg"}),f&&we.createElement("title",null,f),e.children)};return a4!==void 0?we.createElement(a4.Consumer,null,s=>r(s)):r(IV)}function Frt(e){return ms({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M216 23.86c0-23.8-30.65-32.77-44.15-13.04C48 191.85 224 200 224 288c0 35.63-29.11 64.46-64.85 63.99-35.17-.45-63.15-29.77-63.15-64.94v-85.51c0-21.7-26.47-32.23-41.43-16.5C27.8 213.16 0 261.33 0 320c0 105.87 86.13 192 192 192s192-86.13 192-192c0-170.29-168-193-168-296.14z"},child:[]}]})(e)}function Brt(e){return ms({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M288 0c-69.59 0-126 56.41-126 126 0 56.26 82.35 158.8 113.9 196.02 6.39 7.54 17.82 7.54 24.2 0C331.65 284.8 414 182.26 414 126 414 56.41 357.59 0 288 0zm0 168c-23.2 0-42-18.8-42-42s18.8-42 42-42 42 18.8 42 42-18.8 42-42 42zM20.12 215.95A32.006 32.006 0 0 0 0 245.66v250.32c0 11.32 11.43 19.06 21.94 14.86L160 448V214.92c-8.84-15.98-16.07-31.54-21.25-46.42L20.12 215.95zM288 359.67c-14.07 0-27.38-6.18-36.51-16.96-19.66-23.2-40.57-49.62-59.49-76.72v182l192 64V266c-18.92 27.09-39.82 53.52-59.49 76.72-9.13 10.77-22.44 16.95-36.51 16.95zm266.06-198.51L416 224v288l139.88-55.95A31.996 31.996 0 0 0 576 426.34V176.02c0-11.32-11.43-19.06-21.94-14.86z"},child:[]}]})(e)}function DV(e){return ms({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M290.74 93.24l128.02 128.02-277.99 277.99-114.14 12.6C11.35 513.54-1.56 500.62.14 485.34l12.7-114.22 277.9-277.88zm207.2-19.06l-60.11-60.11c-18.75-18.75-49.16-18.75-67.91 0l-56.55 56.55 128.02 128.02 56.55-56.55c18.75-18.76 18.75-49.16 0-67.91z"},child:[]}]})(e)}function jrt(e){return ms({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497.39 361.8l-112-48a24 24 0 0 0-28 6.9l-49.6 60.6A370.66 370.66 0 0 1 130.6 204.11l60.6-49.6a23.94 23.94 0 0 0 6.9-28l-48-112A24.16 24.16 0 0 0 122.6.61l-104 24A24 24 0 0 0 0 48c0 256.5 207.9 464 464 464a24 24 0 0 0 23.4-18.6l24-104a24.29 24.29 0 0 0-14.01-27.6z"},child:[]}]})(e)}function RV(e){return ms({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"},child:[]}]})(e)}function Vrt(e){return ms({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M13 8V16C13 17.6569 11.6569 19 10 19H7.82929C7.41746 20.1652 6.30622 21 5 21C3.34315 21 2 19.6569 2 18C2 16.3431 3.34315 15 5 15C6.30622 15 7.41746 15.8348 7.82929 17H10C10.5523 17 11 16.5523 11 16V8C11 6.34315 12.3431 5 14 5H17V2L22 6L17 10V7H14C13.4477 7 13 7.44772 13 8Z"},child:[]}]})(e)}function Urt(e){return ms({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M11.3273 1.61162C11.677 1.29377 12.1956 1.26728 12.5734 1.53216L12.6727 1.61162L23 11.0001H20V20.0001C20 20.5129 19.614 20.9356 19.1166 20.9934L19 21.0001H12.5L15 17.0001L11.5 14.0001L15.5 11.0001L13 9.0001L13.5 6.0001L10.5 9.0001L13 11.0001L8 14.0001L11.75 17.5001L8.5 21.0001H5C4.48716 21.0001 4.06449 20.6141 4.00673 20.1167L4 20.0001V11.0001H1L11.3273 1.61162Z"},child:[]}]})(e)}function $rt(e){return ms({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"m12 12.9-2.13 2.09c-.56.56-.87 1.29-.87 2.07C9 18.68 10.35 20 12 20s3-1.32 3-2.94c0-.78-.31-1.52-.87-2.07L12 12.9z"},child:[]},{tag:"path",attr:{d:"m16 6-.44.55C14.38 8.02 12 7.19 12 5.3V2S4 6 4 13c0 2.92 1.56 5.47 3.89 6.86-.56-.79-.89-1.76-.89-2.8 0-1.32.52-2.56 1.47-3.5L12 10.1l3.53 3.47c.95.93 1.47 2.17 1.47 3.5 0 1.02-.31 1.96-.85 2.75 1.89-1.15 3.29-3.06 3.71-5.3.66-3.55-1.07-6.9-3.86-8.52z"},child:[]}]})(e)}function Grt(e){return ms({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M18.67 17.63c-3.8 2.8-6.12.4-6.67 0-.66.49-2.92 2.76-6.67 0C3.43 19.03 2.65 19 2 19v2c1.16 0 2.3-.32 3.33-.93a6.535 6.535 0 0 0 6.67 0 6.535 6.535 0 0 0 6.67 0c1.03.61 2.17.93 3.33.93v-2c-.66 0-1.5-.02-3.33-1.37zM19.33 12H22v-2h-2.67C17.5 10 16 8.5 16 6.67c0-1.02.38-1.74 1.09-3.34-1.37-.21-2-.33-3.09-.33C7.36 3 2.15 8.03 2.01 14.5l-.01 2c1.16 0 2.3-.32 3.33-.93a6.535 6.535 0 0 0 6.67 0 6.535 6.535 0 0 0 6.67 0c1.03.61 2.17.93 3.33.93v-2c-.66 0-1.5-.02-3.33-1.37-3.8 2.8-6.12.4-6.67 0-.9.67-.54.41-.91.63-.7-.94-1.09-2.06-1.09-3.26 0-2.58 1.77-4.74 4.21-5.33-.13.51-.21 1.02-.21 1.5C14 9.61 16.39 12 19.33 12z"},child:[]}]})(e)}function Wrt(e){return ms({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M11 8v5l4.25 2.52.77-1.28-3.52-2.09V8H11zm10 2V3l-2.64 2.64A8.937 8.937 0 0 0 12 3a9 9 0 1 0 9 9h-2c0 3.86-3.14 7-7 7s-7-3.14-7-7 3.14-7 7-7c1.93 0 3.68.79 4.95 2.05L14 10h7z"},child:[]}]})(e)}var Hrt={exports:{}};(function(e,r){var s={};(function(a,h){e.exports=h()})(Fa,function(){var a,h,f;function m(x,w){if(!a)a=w;else if(!h)h=w;else{var T="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+a+")(sharedChunk); ("+h+")(sharedChunk); self.onerror = null;",M={};a(M),f=w(M),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(f.workerUrl=window.URL.createObjectURL(new Blob([T],{type:"text/javascript"})))}}m(["exports"],function(x){var w=typeof self<"u"?self:{},T="3.1.2";let M;const I={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(M==null){const n=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{M=s.API_URL_REGEX!=null?new RegExp(s.API_URL_REGEX):n}catch{M=n}}return M},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!I.API_URL)return null;try{const n=new URL(I.API_URL);return n.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":n.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},R={supported:!1,testSupport:function(n){!G&&N&&($?z(n):O=n)}};let O,N,G=!1,$=!1;function z(n){const t=n.createTexture();n.bindTexture(n.TEXTURE_2D,t);try{if(n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,N),n.isContextLost())return;R.supported=!0}catch{}n.deleteTexture(t),G=!0}w.document&&(N=w.document.createElement("img"),N.onload=function(){O&&z(O),O=null,$=!0},N.onerror=function(){G=!0,O=null},N.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const B="01";function H(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var K=at;function at(n,t,i,o){this.cx=3*n,this.bx=3*(i-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(o-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=t,this.p2x=i,this.p2y=o}at.prototype={sampleCurveX:function(n){return((this.ax*n+this.bx)*n+this.cx)*n},sampleCurveY:function(n){return((this.ay*n+this.by)*n+this.cy)*n},sampleCurveDerivativeX:function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},solveCurveX:function(n,t){if(t===void 0&&(t=1e-6),n<0)return 0;if(n>1)return 1;for(var i=n,o=0;o<8;o++){var c=this.sampleCurveX(i)-n;if(Math.abs(c)<t)return i;var u=this.sampleCurveDerivativeX(i);if(Math.abs(u)<1e-6)break;i-=c/u}var d=0,p=1;for(i=n,o=0;o<20&&(c=this.sampleCurveX(i),!(Math.abs(c-n)<t));o++)n>c?d=i:p=i,i=.5*(p-d)+d;return i},solve:function(n,t){return this.sampleCurveY(this.solveCurveX(n,t))}};var ft=H(K),et=nt;function nt(n,t){this.x=n,this.y=t}nt.prototype={clone:function(){return new nt(this.x,this.y)},add:function(n){return this.clone()._add(n)},sub:function(n){return this.clone()._sub(n)},multByPoint:function(n){return this.clone()._multByPoint(n)},divByPoint:function(n){return this.clone()._divByPoint(n)},mult:function(n){return this.clone()._mult(n)},div:function(n){return this.clone()._div(n)},rotate:function(n){return this.clone()._rotate(n)},rotateAround:function(n,t){return this.clone()._rotateAround(n,t)},matMult:function(n){return this.clone()._matMult(n)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(n){return this.x===n.x&&this.y===n.y},dist:function(n){return Math.sqrt(this.distSqr(n))},distSqr:function(n){var t=n.x-this.x,i=n.y-this.y;return t*t+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(n){return Math.atan2(this.y-n.y,this.x-n.x)},angleWith:function(n){return this.angleWithSep(n.x,n.y)},angleWithSep:function(n,t){return Math.atan2(this.x*t-this.y*n,this.x*n+this.y*t)},_matMult:function(n){var t=n[2]*this.x+n[3]*this.y;return this.x=n[0]*this.x+n[1]*this.y,this.y=t,this},_add:function(n){return this.x+=n.x,this.y+=n.y,this},_sub:function(n){return this.x-=n.x,this.y-=n.y,this},_mult:function(n){return this.x*=n,this.y*=n,this},_div:function(n){return this.x/=n,this.y/=n,this},_multByPoint:function(n){return this.x*=n.x,this.y*=n.y,this},_divByPoint:function(n){return this.x/=n.x,this.y/=n.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var n=this.y;return this.y=this.x,this.x=-n,this},_rotate:function(n){var t=Math.cos(n),i=Math.sin(n),o=i*this.x+t*this.y;return this.x=t*this.x-i*this.y,this.y=o,this},_rotateAround:function(n,t){var i=Math.cos(n),o=Math.sin(n),c=t.y+o*(this.x-t.x)+i*(this.y-t.y);return this.x=t.x+i*(this.x-t.x)-o*(this.y-t.y),this.y=c,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},nt.convert=function(n){return n instanceof nt?n:Array.isArray(n)?new nt(n[0],n[1]):n};var W=H(et);function Q(n,t){if(Array.isArray(n)){if(!Array.isArray(t)||n.length!==t.length)return!1;for(let i=0;i<n.length;i++)if(!Q(n[i],t[i]))return!1;return!0}if(typeof n=="object"&&n!==null&&t!==null){if(typeof t!="object"||Object.keys(n).length!==Object.keys(t).length)return!1;for(const i in n)if(!Q(n[i],t[i]))return!1;return!0}return n===t}const yt=Math.PI/180,Pt=180/Math.PI;function st(n){return n*yt}function St(n){return n*Pt}const Rt=[[0,0],[1,0],[1,1],[0,1]];function Zt(n){if(n<=0)return 0;if(n>=1)return 1;const t=n*n,i=t*n;return 4*(n<.5?i:3*(n-t)+i-.75)}function Ft(n){let t=1/0,i=1/0,o=-1/0,c=-1/0;for(const u of n)t=Math.min(t,u.x),i=Math.min(i,u.y),o=Math.max(o,u.x),c=Math.max(c,u.y);return{min:new W(t,i),max:new W(o,c)}}function $t(n,t,i=0,o=!0){const c=new W(i,i),u=n.sub(c),d=t.add(c),p=[u,new W(d.x,u.y),d,new W(u.x,d.y)];return o&&p.push(u.clone()),p}function ee(n,t,i,o){const c=new ft(n,t,i,o);return function(u){return c.solve(u)}}const se=ee(.25,.1,.25,1);function Ot(n,t,i){return Math.min(i,Math.max(t,n))}function Me(n,t,i){return(i=Ot((i-n)/(t-n),0,1))*i*(3-2*i)}function me(n,t,i){const o=i-t,c=((n-t)%o+o)%o+t;return c===t?i:c}function kt(n,t,i){if(!n.length)return i(null,[]);let o=n.length;const c=new Array(n.length);let u=null;n.forEach((d,p)=>{t(d,(g,_)=>{g&&(u=g),c[p]=_,--o==0&&i(u,c)})})}function Wt(n){const t=[];for(const i in n)t.push(n[i]);return t}function Ct(n,...t){for(const i of t)for(const o in i)n[o]=i[o];return n}function Ae(n,t){const i={};for(let o=0;o<t.length;o++){const c=t[o];c in n&&(i[c]=n[c])}return i}let he=1;function Fe(){return he++}function Oe(){return function n(t){return t?(t^Math.random()*(16>>t/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,n)}()}function Qe(n){return n<=1?1:Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function Le(n){return!!n&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(n)}function Ne(n,t){n.forEach(i=>{t[i]&&(t[i]=t[i].bind(t))})}function Yn(n,t){return n.indexOf(t,n.length-t.length)!==-1}function _n(n,t,i){const o={};for(const c in n)o[c]=t.call(i||this,n[c],c,n);return o}function Qt(n,t,i){const o={};for(const c in n)t.call(i||this,n[c],c,n)&&(o[c]=n[c]);return o}function ot(n){return Array.isArray(n)?n.map(ot):typeof n=="object"&&n?_n(n,ot):n}const lt={};function _t(n){lt[n]||(typeof console<"u"&&console.warn(n),lt[n]=!0)}function Ut(n,t,i){return(i.y-n.y)*(t.x-n.x)>(t.y-n.y)*(i.x-n.x)}function Ht(n){let t=0;for(let i,o,c=0,u=n.length,d=u-1;c<u;d=c++)i=n[c],o=n[d],t+=(o.x-i.x)*(i.y+o.y);return t}function ge([n,t,i]){const o=st(t+90),c=st(i);return{x:n*Math.cos(o)*Math.sin(c),y:n*Math.sin(o)*Math.sin(c),z:n*Math.cos(c),azimuthal:t,polar:i}}function Ee(n,t,i){const o=Math.sqrt(n*n+t*t+i*i),c=o>0?Math.acos(i/o)*Pt:0;let u=n!==0||t!==0?Math.atan2(-t,-n)*Pt+90:0;return u<0&&(u+=360),[o,u,c]}function qt(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function ke(n){const t={};if(n.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(i,o,c,u)=>{const d=c||u;return t[o]=!d||d.toLowerCase(),""}),t["max-age"]){const i=parseInt(t["max-age"],10);isNaN(i)?delete t["max-age"]:t["max-age"]=i}return t}let Ve=null;function $e(){return!!w.document.fullscreenElement||!!w.document.webkitFullscreenElement}function Un(n){try{const t=w[n];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch{return!1}}function or(n,t){return[n[4*t],n[4*t+1],n[4*t+2],n[4*t+3]]}function Mr(n,t,i){n[4*t+0]=i[0],n[4*t+1]=i[1],n[4*t+2]=i[2],n[4*t+3]=i[3]}function Jn(n,t){return[Math.pow(n[0],2.2)*t,Math.pow(n[1],2.2)*t,Math.pow(n[2],2.2)*t]}function cr(n){return[Math.pow(n[0],1/2.2),Math.pow(n[1],1/2.2),Math.pow(n[2],1/2.2)]}const En="mapbox-tiles";let ai=500,Wr=50,pi,Ri;function Jr(){try{return w.caches}catch{}}function Ei(){Jr()&&!pi&&(pi=w.caches.open(En))}function gs(n){const t=n.indexOf("?");if(t<0)return n;const i=function(c){const u=c.indexOf("?");return u>0?c.slice(u+1).split("&"):[]}(n),o=i.filter(c=>{const u=c.split("=");return u[0]==="language"||u[0]==="worldview"});return o.length?`${n.slice(0,t)}?${o.join("&")}`:n.slice(0,t)}let vo=1/0;function rs(n){vo++,vo>Wr&&(n.getActor().send("enforceCacheSizeLimit",ai),vo=0)}const zt={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(zt);class Vt extends Error{constructor(t,i,o){i===401&&Qn(o)&&(t+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(t),this.status=i,this.url=o}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Yt=qt()?()=>self.worker&&self.worker.referrer:()=>(w.location.protocol==="blob:"?w.parent:w).location.href,ne=function(n,t){if(!(/^file:/.test(i=n.url)||/^file:/.test(Yt())&&!/^\w+:/.test(i))){if(w.fetch&&w.Request&&w.AbortController&&w.Request.prototype.hasOwnProperty("signal"))return function(o,c){const u=new w.AbortController,d=new w.Request(o.url,{method:o.method||"GET",body:o.body,credentials:o.credentials,headers:o.headers,referrer:Yt(),referrerPolicy:o.referrerPolicy,signal:u.signal});let p=!1,g=!1;const _=(v=d.url).indexOf("sku=")>0&&Qn(v);var v;o.type==="json"&&d.headers.set("Accept","application/json");const b=(E,A,C)=>{if(g)return;if(E&&E.message!=="SecurityError"&&_t(E.toString()),A&&C)return S(A);const P=Date.now();w.fetch(d).then(k=>{if(k.ok){const L=_?k.clone():null;return S(k,L,P)}return c(new Vt(k.statusText,k.status,o.url))}).catch(k=>{k.name!=="AbortError"&&c(new Error(`${k.message} ${o.url}`))})},S=(E,A,C)=>{(o.type==="arrayBuffer"?E.arrayBuffer():o.type==="json"?E.json():E.text()).then(P=>{g||(A&&C&&function(k,L,j){if(Ei(),!pi)return;const V={status:L.status,statusText:L.statusText,headers:new w.Headers};L.headers.forEach((q,Z)=>V.headers.set(Z,q));const F=ke(L.headers.get("Cache-Control")||"");if(F["no-store"])return;F["max-age"]&&V.headers.set("Expires",new Date(j+1e3*F["max-age"]).toUTCString());const U=V.headers.get("Expires");U&&(new Date(U).getTime()-j<42e4||function(q,Z){if(Ri===void 0)try{new Response(new ReadableStream),Ri=!0}catch{Ri=!1}Ri?Z(q.body):q.blob().then(Z)}(L,q=>{const Z=new w.Response(q,V);Ei(),pi&&pi.then(X=>X.put(gs(k.url),Z)).catch(X=>_t(X.message))}))}(d,A,C),p=!0,c(null,P,E.headers.get("Cache-Control"),E.headers.get("Expires")))}).catch(P=>{g||c(new Error(P.message))})};return _?function(E,A){if(Ei(),!pi)return A(null);const C=gs(E.url);pi.then(P=>{P.match(C).then(k=>{const L=function(j){if(!j)return!1;const V=new Date(j.headers.get("Expires")||0),F=ke(j.headers.get("Cache-Control")||"");return V>Date.now()&&!F["no-cache"]}(k);P.delete(C),L&&P.put(C,k.clone()),A(null,k,L)}).catch(A)}).catch(A)}(d,b):b(null,null),{cancel:()=>{g=!0,p||u.abort()}}}(n,t);if(qt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",n,t,void 0,!0)}var i;return function(o,c){const u=new w.XMLHttpRequest;u.open(o.method||"GET",o.url,!0),o.type==="arrayBuffer"&&(u.responseType="arraybuffer");for(const d in o.headers)u.setRequestHeader(d,o.headers[d]);return o.type==="json"&&(u.responseType="text",u.setRequestHeader("Accept","application/json")),u.withCredentials=o.credentials==="include",u.onerror=()=>{c(new Error(u.statusText))},u.onload=()=>{if((u.status>=200&&u.status<300||u.status===0)&&u.response!==null){let d=u.response;if(o.type==="json")try{d=JSON.parse(u.response)}catch(p){return c(p)}c(null,d,u.getResponseHeader("Cache-Control"),u.getResponseHeader("Expires"))}else c(new Vt(u.statusText,u.status,o.url))},u.send(o.body),{cancel:()=>u.abort()}}(n,t)},Kt=function(n,t){return ne(Ct(n,{type:"json"}),t)},oe=function(n,t){return ne(Ct(n,{type:"arrayBuffer"}),t)};function fe(n){const t=w.document.createElement("a");return t.href=n,t.protocol===w.document.location.protocol&&t.host===w.document.location.host}const re="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let ve,le;ve=[],le=0;const Ye=function(n,t){if(R.supported&&(n.headers||(n.headers={}),n.headers.accept="image/webp,*/*"),le>=I.MAX_PARALLEL_IMAGE_REQUESTS){const u={requestParameters:n,callback:t,cancelled:!1,cancel(){this.cancelled=!0}};return ve.push(u),u}le++;let i=!1;const o=()=>{if(!i)for(i=!0,le--;ve.length&&le<I.MAX_PARALLEL_IMAGE_REQUESTS;){const u=ve.shift(),{requestParameters:d,callback:p,cancelled:g}=u;g||(u.cancel=Ye(d,p).cancel)}},c=oe(n,(u,d,p,g)=>{o(),u?t(u):d&&(w.createImageBitmap?function(_,v){const b=new w.Blob([new Uint8Array(_)],{type:"image/png"});w.createImageBitmap(b).then(S=>{v(null,S)}).catch(S=>{v(new Error(`Could not load image because of ${S.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(d,(_,v)=>t(_,v,p,g)):function(_,v){const b=new w.Image,S=w.URL;b.onload=()=>{v(null,b),S.revokeObjectURL(b.src),b.onload=null,w.requestAnimationFrame(()=>{b.src=re})},b.onerror=()=>v(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const E=new w.Blob([new Uint8Array(_)],{type:"image/png"});b.src=_.byteLength?S.createObjectURL(E):re}(d,(_,v)=>t(_,v,p,g)))});return{cancel:()=>{c.cancel(),o()}}},In="NO_ACCESS_TOKEN";class De{constructor(t,i,o){this._transformRequestFn=t,this._customAccessToken=i,this._silenceAuthErrors=!!o,this._createSkuToken()}_createSkuToken(){const t=function(){let i="";for(let o=0;o<10;o++)i+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",B,i].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(t,i){return this._transformRequestFn&&this._transformRequestFn(t,i)||{url:t}}normalizeStyleURL(t,i){if(!kn(t))return t;const o=Nr(t);return o.params.push(`sdk=js-${T}`),o.path=`/styles/v1${o.path}`,this._makeAPIURL(o,this._customAccessToken||i)}normalizeGlyphsURL(t,i){if(!kn(t))return t;const o=Nr(t);return o.path=`/fonts/v1${o.path}`,this._makeAPIURL(o,this._customAccessToken||i)}normalizeModelURL(t,i){if(!kn(t))return t;const o=Nr(t);return o.path=`/models/v1${o.path}`,this._makeAPIURL(o,this._customAccessToken||i)}normalizeSourceURL(t,i,o,c){if(!kn(t))return t;const u=Nr(t);return u.path=`/v4/${u.authority}.json`,u.params.push("secure"),o&&u.params.push(`language=${o}`),c&&u.params.push(`worldview=${c}`),this._makeAPIURL(u,this._customAccessToken||i)}normalizeSpriteURL(t,i,o,c){const u=Nr(t);return kn(t)?(u.path=`/styles/v1${u.path}/sprite${i}${o}`,this._makeAPIURL(u,this._customAccessToken||c)):(u.path+=`${i}${o}`,Oi(u))}normalizeTileURL(t,i,o){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!kn(t))return t;const c=Nr(t);c.path=c.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${i||o&&c.authority!=="raster"&&o===512?"@2x":""}${R.supported?".webp":"$1"}`),c.authority==="raster"?c.path=`/${I.RASTER_URL_PREFIX}${c.path}`:(c.path=c.path.replace(/^.+\/v4\//,"/"),c.path=`/${I.TILE_URL_VERSION}${c.path}`);const u=this._customAccessToken||function(d){for(const p of d){const g=p.match(/^access_token=(.*)$/);if(g)return g[1]}return null}(c.params)||I.ACCESS_TOKEN;return I.REQUIRE_ACCESS_TOKEN&&u&&this._skuToken&&c.params.push(`sku=${this._skuToken}`),this._makeAPIURL(c,u)}canonicalizeTileURL(t,i){const o=Nr(t);if(!o.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!o.path.match(/\.[\w]+$/))return t;let c="mapbox://";o.path.match(/^\/raster\/v1\//)?c+=`raster/${o.path.replace(`/${I.RASTER_URL_PREFIX}/`,"")}`:c+=`tiles/${o.path.replace(`/${I.TILE_URL_VERSION}/`,"")}`;let u=o.params;return i&&(u=u.filter(d=>!d.match(/^access_token=/))),u.length&&(c+=`?${u.join("&")}`),c}canonicalizeTileset(t,i){const o=!!i&&kn(i),c=[];for(const u of t.tiles||[])Qn(u)?c.push(this.canonicalizeTileURL(u,o)):c.push(u);return c}_makeAPIURL(t,i){const o="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",c=Nr(I.API_URL);if(t.protocol=c.protocol,t.authority=c.authority,t.protocol==="http"){const u=t.params.indexOf("secure");u>=0&&t.params.splice(u,1)}if(c.path!=="/"&&(t.path=`${c.path}${t.path}`),!I.REQUIRE_ACCESS_TOKEN)return Oi(t);if(i=i||I.ACCESS_TOKEN,!this._silenceAuthErrors){if(!i)throw new Error(`An API access token is required to use Mapbox GL. ${o}`);if(i[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${o}`)}return t.params=t.params.filter(u=>u.indexOf("access_token")===-1),t.params.push(`access_token=${i||""}`),Oi(t)}}function kn(n){return n.indexOf("mapbox:")===0}function Qn(n){return I.API_URL_REGEX.test(n)}function Wn(n){return I.API_CDN_URL_REGEX.test(n)}function tr(n){return I.API_STYLE_REGEX.test(n)&&!mi(n)}function mi(n){return I.API_SPRITE_REGEX.test(n)}const is=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Nr(n){const t=n.match(is);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function Oi(n){const t=n.params.length?`?${n.params.join("&")}`:"";return`${n.protocol}://${n.authority}${n.path}${t}`}const li="mapbox.eventData";function $i(n){if(!n)return null;const t=n.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(decodeURIComponent(w.atob(t[1]).split("").map(i=>"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Xs{constructor(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(t){const i=$i(I.ACCESS_TOKEN);let o="";return o=i&&i.u?w.btoa(encodeURIComponent(i.u).replace(/%([0-9A-F]{2})/g,(c,u)=>String.fromCharCode(+("0x"+u)))):I.ACCESS_TOKEN||"",t?`${li}.${t}:${o}`:`${li}:${o}`}fetchEventData(){const t=Un("localStorage"),i=this.getStorageKey(),o=this.getStorageKey("uuid");if(t)try{const c=w.localStorage.getItem(i);c&&(this.eventData=JSON.parse(c));const u=w.localStorage.getItem(o);u&&(this.anonId=u)}catch{_t("Unable to read from LocalStorage")}}saveEventData(){const t=Un("localStorage"),i=this.getStorageKey(),o=this.getStorageKey("uuid");if(t)try{w.localStorage.setItem(o,this.anonId),Object.keys(this.eventData).length>=1&&w.localStorage.setItem(i,JSON.stringify(this.eventData))}catch{_t("Unable to write to LocalStorage")}}processRequests(t){}postEvent(t,i,o,c){if(!I.EVENTS_URL)return;const u=Nr(I.EVENTS_URL);u.params.push(`access_token=${c||I.ACCESS_TOKEN||""}`);const d={event:this.type,created:new Date(t).toISOString()},p=i?Ct(d,i):d,g={url:Oi(u),headers:{"Content-Type":"text/plain"},body:JSON.stringify([p])};this.pendingRequest=function(_,v){return ne(Ct(_,{method:"POST"}),v)}(g,_=>{this.pendingRequest=null,o(_),this.saveEventData(),this.processRequests(c)})}queueRequest(t,i){this.queue.push(t),this.processRequests(i)}}const ya=new class extends Xs{constructor(n){super("appUserTurnstile"),this._customAccessToken=n}postTurnstileEvent(n,t){I.EVENTS_URL&&I.ACCESS_TOKEN&&Array.isArray(n)&&n.some(i=>kn(i)||Qn(i))&&this.queueRequest(Date.now(),t)}processRequests(n){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const t=$i(I.ACCESS_TOKEN),i=t?t.u:I.ACCESS_TOKEN;let o=i!==this.eventData.tokenU;Le(this.anonId)||(this.anonId=Oe(),o=!0);const c=this.queue.shift();if(this.eventData.lastSuccess){const u=new Date(this.eventData.lastSuccess),d=new Date(c),p=(c-this.eventData.lastSuccess)/864e5;o=o||p>=1||p<-1||u.getDate()!==d.getDate()}else o=!0;o?this.postEvent(c,{sdkIdentifier:"mapbox-gl-js",sdkVersion:T,skuId:B,"enabled.telemetry":!1,userId:this.anonId},u=>{u||(this.eventData.lastSuccess=c,this.eventData.tokenU=i)},n):this.processRequests()}},bu=ya.postTurnstileEvent.bind(ya),wu=new class extends Xs{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(n,t,i,o){this.skuToken=t,this.errorCb=o,I.EVENTS_URL&&(i||I.ACCESS_TOKEN?this.queueRequest({id:n,timestamp:Date.now()},i):this.errorCb(new Error(In)))}processRequests(n){if(this.pendingRequest||this.queue.length===0)return;const{id:t,timestamp:i}=this.queue.shift();t&&this.success[t]||(this.anonId||this.fetchEventData(),Le(this.anonId)||(this.anonId=Oe()),this.postEvent(i,{sdkIdentifier:"mapbox-gl-js",sdkVersion:T,skuId:B,skuToken:this.skuToken,userId:this.anonId},o=>{o?this.errorCb(o):t&&(this.success[t]=!0)},n))}},Df=wu.postMapLoadEvent.bind(wu),xo=new class extends Xs{constructor(){super("gljs.performance")}postPerformanceEvent(n,t){I.EVENTS_URL&&(n||I.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:t},n)}processRequests(n){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:t,performanceData:i}=this.queue.shift(),o=function(c){const u=w.performance.getEntriesByType("resource"),d=w.performance.getEntriesByType("mark"),p=function(S){const E={};if(S){for(const A in S)if(A!=="other")for(const C of S[A]){const P=`${A}ResolveRangeMin`,k=`${A}ResolveRangeMax`,L=`${A}RequestCount`,j=`${A}RequestCachedCount`;E[P]=Math.min(E[P]||1/0,C.startTime),E[k]=Math.max(E[k]||-1/0,C.responseEnd);const V=F=>{E[F]===void 0&&(E[F]=0),++E[F]};C.transferSize!==void 0&&C.transferSize===0&&V(j),V(L)}}return E}(function(S,E){const A={};if(S)for(const C of S){const P=E(C);A[P]===void 0&&(A[P]=[]),A[P].push(C)}return A}(u,Of)),g=w.devicePixelRatio,_=w.navigator.connection||w.navigator.mozConnection||w.navigator.webkitConnection,v={counters:[],metadata:[],attributes:[]},b=(S,E,A)=>{A!=null&&S.push({name:E,value:A.toString()})};for(const S in p)b(v.counters,S,p[S]);if(c.interactionRange[0]!==1/0&&c.interactionRange[1]!==-1/0&&(b(v.counters,"interactionRangeMin",c.interactionRange[0]),b(v.counters,"interactionRangeMax",c.interactionRange[1])),d)for(const S of Object.keys(Go)){const E=Go[S],A=d.find(C=>C.name===E);A&&b(v.counters,E,A.startTime)}return b(v.counters,"visibilityHidden",c.visibilityHidden),b(v.attributes,"style",function(S){if(S)for(const E of S){const A=E.name.split("?")[0];if(tr(A)){const C=A.split("/").slice(-2);if(C.length===2)return`mapbox://styles/${C[0]}/${C[1]}`}}}(u)),b(v.attributes,"terrainEnabled",c.terrainEnabled?"true":"false"),b(v.attributes,"fogEnabled",c.fogEnabled?"true":"false"),b(v.attributes,"projection",c.projection),b(v.attributes,"zoom",c.zoom),b(v.metadata,"devicePixelRatio",g),b(v.metadata,"connectionEffectiveType",_?_.effectiveType:void 0),b(v.metadata,"navigatorUserAgent",w.navigator.userAgent),b(v.metadata,"screenWidth",w.screen.width),b(v.metadata,"screenHeight",w.screen.height),b(v.metadata,"windowWidth",w.innerWidth),b(v.metadata,"windowHeight",w.innerHeight),b(v.metadata,"mapWidth",c.width/g),b(v.metadata,"mapHeight",c.height/g),b(v.metadata,"webglRenderer",c.renderer),b(v.metadata,"webglVendor",c.vendor),b(v.metadata,"sdkVersion",T),b(v.metadata,"sdkIdentifier","mapbox-gl-js"),v}(i);for(const c of o.metadata);for(const c of o.counters);for(const c of o.attributes);this.postEvent(t,o,()=>{},n)}},Fh=xo.postPerformanceEvent.bind(xo),Su=new class extends Xs{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(n,t,i,o){if(!I.API_URL||!I.SESSION_PATH)return;const c=Nr(I.API_URL+I.SESSION_PATH);c.params.push(`sku=${t||""}`),c.params.push(`access_token=${o||I.ACCESS_TOKEN||""}`);const u={url:Oi(c),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(d,p){return ne(Ct(d,{method:"GET"}),p)}(u,d=>{this.pendingRequest=null,i(d),this.saveEventData(),this.processRequests(o)})}getSessionAPI(n,t,i,o){this.skuToken=t,this.errorCb=o,I.SESSION_PATH&&I.API_URL&&(i||I.ACCESS_TOKEN?this.queueRequest({id:n,timestamp:Date.now()},i):this.errorCb(new Error(In)))}processRequests(n){if(this.pendingRequest||this.queue.length===0)return;const{id:t,timestamp:i}=this.queue.shift();t&&this.success[t]||this.getSession(i,this.skuToken,o=>{o?this.errorCb(o):t&&(this.success[t]=!0)},n)}},Rf=Su.getSessionAPI.bind(Su),Ya=new Set;function Bh(n,t){t?Ya.add(n):Ya.delete(n)}const Go={create:"create",load:"load",fullLoad:"fullLoad"},jh={mark(n){w.performance.mark(n)},measure(n,t,i){w.performance.measure(n,t,i)}};function Of(n){const t=n.name.split("?")[0];return Wn(t)&&t.includes("mapbox-gl.js")?"javascript":Wn(t)&&t.includes("mapbox-gl.css")?"css":function(i){return I.API_FONTS_REGEX.test(i)}(t)?"fontRange":mi(t)?"sprite":tr(t)?"style":function(i){return I.API_TILEJSON_REGEX.test(i)}(t)?"tilejson":"other"}const bo=w.performance;function Vh(n){const t=n?n.url.toString():void 0;return bo.getEntriesByName(t)}var Hl=Tu;function Tu(n){return!function(t){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var o,c,u=new Blob([""],{type:"text/javascript"}),d=URL.createObjectURL(u);try{c=new Worker(d),o=!0}catch{o=!1}return c&&c.terminate(),URL.revokeObjectURL(d),o}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var o=document.createElement("canvas");o.width=o.height=1;var c=o.getContext("2d");if(!c)return!1;var u=c.getImageData(0,0,1,1);return u&&u.width===o.width}()?(ql[i=t&&t.failIfMajorPerformanceCaveat]===void 0&&(ql[i]=function(o){var c,u=function(d){var p=document.createElement("canvas"),g=Object.create(Tu.webGLContextAttributes);return g.failIfMajorPerformanceCaveat=d,p.getContext("webgl",g)||p.getContext("experimental-webgl",g)}(o);if(!u)return!1;try{c=u.createShader(u.VERTEX_SHADER)}catch{return!1}return!(!c||u.isContextLost())&&(u.shaderSource(c,"void main() {}"),u.compileShader(c),u.getShaderParameter(c,u.COMPILE_STATUS)===!0)}(i)),ql[i]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var i}(n)}var ql={};let Ka,Zl,Wo,Ja,ss;function va(){return Ka==null&&(Ka=w.OffscreenCanvas&&new w.OffscreenCanvas(1,1).getContext("2d")&&typeof w.createImageBitmap=="function"),Ka}Tu.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const Be={now:()=>Ja!==void 0?Ja:w.performance.now(),setNow(n){Ja=n},restoreNow(){Ja=void 0},frame(n){const t=w.requestAnimationFrame(n);return{cancel:()=>w.cancelAnimationFrame(t)}},getImageData(n,t=0){const{width:i,height:o}=n;ss||(ss=w.document.createElement("canvas"));const c=ss.getContext("2d",{willReadFrequently:!0});if(!c)throw new Error("failed to create canvas 2d context");return(i>ss.width||o>ss.height)&&(ss.width=i,ss.height=o),c.clearRect(-t,-t,i+2*t,o+2*t),c.drawImage(n,0,0,i,o),c.getImageData(-t,-t,i+2*t,o+2*t)},resolveURL:n=>(Zl||(Zl=w.document.createElement("a")),Zl.href=n,Zl.href),get devicePixelRatio(){return w.devicePixelRatio},get prefersReducedMotion(){return!!w.matchMedia&&(Wo==null&&(Wo=w.matchMedia("(prefers-reduced-motion: reduce)")),Wo.matches)},hasCanvasFingerprintNoise(){if(!va())return!1;const n=new w.OffscreenCanvas(85,1),t=n.getContext("2d",{willReadFrequently:!0});let i=0;for(let c=0;c<n.width;++c)t.fillStyle=`rgba(${i++},${i++},${i++}, 255)`,t.fillRect(c,0,1,1);const o=t.getImageData(0,0,n.width,n.height);i=0;for(let c=0;c<o.data.length;++c)if(c%4!=3&&i++!==o.data[c])return!0;return!1}};function Nn(n,t,i){const o=w.document.createElement(n);return t!==void 0&&(o.className=t),i&&i.appendChild(o),o}function Ys(n,t,i){const o=w.document.createElementNS("http://www.w3.org/2000/svg",n);for(const c of Object.keys(t))o.setAttributeNS(null,c,t[c]);return i&&i.appendChild(o),o}const Ho=w.document&&w.document.documentElement.style,Qa=Ho&&Ho.userSelect!==void 0?"userSelect":"WebkitUserSelect";let Xl;function Uh(){Ho&&Qa&&(Xl=Ho[Qa],Ho[Qa]="none")}function $h(){Ho&&Qa&&(Ho[Qa]=Xl)}function Yl(n){n.preventDefault(),n.stopPropagation(),w.removeEventListener("click",Yl,!0)}function xa(){w.addEventListener("click",Yl,!0),w.setTimeout(()=>{w.removeEventListener("click",Yl,!0)},0)}function Ps(n,t){const i=n.getBoundingClientRect();return Tt(n,i,t)}function tl(n,t){const i=n.getBoundingClientRect(),o=[];for(let c=0;c<t.length;c++)o.push(Tt(n,i,t[c]));return o}function Gh(n){return w.InstallTrigger!==void 0&&n.button===2&&n.ctrlKey&&w.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:n.button}function Tt(n,t,i){const o=n.offsetWidth===t.width?1:n.offsetWidth/t.width;return new W((i.clientX-t.left)*o,(i.clientY-t.top)*o)}function Jt(n,t,i){i[n]&&i[n].indexOf(t)!==-1||(i[n]=i[n]||[],i[n].push(t))}function _e(n,t,i){if(i&&i[n]){const o=i[n].indexOf(t);o!==-1&&i[n].splice(o,1)}}class Bt{constructor(t,i={}){Ct(this,i),this.type=t}}class xe extends Bt{constructor(t,i={}){super("error",Ct({error:t},i))}}class Mn{on(t,i){return this._listeners=this._listeners||{},Jt(t,i,this._listeners),this}off(t,i){return _e(t,i,this._listeners),_e(t,i,this._oneTimeListeners),this}once(t,i){return i?(this._oneTimeListeners=this._oneTimeListeners||{},Jt(t,i,this._oneTimeListeners),this):new Promise(o=>this.once(t,o))}fire(t,i){typeof t=="string"&&(t=new Bt(t,i||{}));const o=t.type;if(this.listens(o)){t.target=this;const c=this._listeners&&this._listeners[o]?this._listeners[o].slice():[];for(const p of c)p.call(this,t);const u=this._oneTimeListeners&&this._oneTimeListeners[o]?this._oneTimeListeners[o].slice():[];for(const p of u)_e(o,p,this._oneTimeListeners),p.call(this,t);const d=this._eventedParent;d&&(Ct(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),d.fire(t))}else t instanceof xe&&console.error(t.error);return this}listens(t){return!!(this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t))}setEventedParent(t,i){return this._eventedParent=t,this._eventedParentData=i,this}}var vt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"camera":{"type":"camera"},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"expression":{},"property-type":"data-constant"},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"model":{},"background":{},"sky":{},"slot":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","default":[0,1],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');class ie{constructor(t,i,o,c){this.message=(t?`${t}: `:"")+o,c&&(this.identifier=c),i!=null&&i.__line__&&(this.line=i.__line__)}}class Mi extends ie{}function Ar(n,...t){for(const i of t)for(const o in i)n[o]=i[o];return n}function wr(n){return n instanceof Number||n instanceof String||n instanceof Boolean?n.valueOf():n}function Sr(n){if(Array.isArray(n))return n.map(Sr);if(n instanceof Object&&!(n instanceof Number||n instanceof String||n instanceof Boolean)){const t={};for(const i in n)t[i]=Sr(n[i]);return t}return wr(n)}class Lf extends Error{constructor(t,i){super(i),this.message=i,this.key=t}}var _s=Lf;class ba{constructor(t,i=[]){this.parent=t,this.bindings={};for(const[o,c]of i)this.bindings[o]=c}concat(t){return new ba(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}var el=ba;const ys={kind:"null"},pe={kind:"number"},pn={kind:"string"},An={kind:"boolean"},qi={kind:"color"},mt={kind:"object"},bt={kind:"value"},de={kind:"collator"},je={kind:"formatted"},ur={kind:"resolvedImage"};function on(n,t){return{kind:"array",itemType:n,N:t}}function Sn(n){if(n.kind==="array"){const t=Sn(n.itemType);return typeof n.N=="number"?`array<${t}, ${n.N}>`:n.itemType.kind==="value"?"array":`array<${t}>`}return n.kind}const Ai=[ys,pe,pn,An,qi,je,mt,on(bt),ur];function Qr(n,t){if(t.kind==="error")return null;if(n.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Qr(n.itemType,t.itemType))&&(typeof n.N!="number"||n.N===t.N))return null}else{if(n.kind===t.kind)return null;if(n.kind==="value"){for(const i of Ai)if(!Qr(i,t))return null}}return`Expected ${Sn(n)} but found ${Sn(t)} instead.`}function Cr(n,t){return t.some(i=>i.kind===n.kind)}function Li(n,t){return t.some(i=>i==="null"?n===null:i==="array"?Array.isArray(n):i==="object"?n&&!Array.isArray(n)&&typeof n=="object":i===typeof n)}var vs,zi={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Zi(n){return(n=Math.round(n))<0?0:n>255?255:n}function os(n){return Zi(n[n.length-1]==="%"?parseFloat(n)/100*255:parseInt(n))}function Ks(n){return(t=n[n.length-1]==="%"?parseFloat(n)/100:parseFloat(n))<0?0:t>1?1:t;var t}function Js(n,t,i){return i<0?i+=1:i>1&&(i-=1),6*i<1?n+(t-n)*i*6:2*i<1?t:3*i<2?n+(t-n)*(2/3-i)*6:n}try{vs={}.parseCSSColor=function(n){var t,i=n.replace(/ /g,"").toLowerCase();if(i in zi)return zi[i].slice();if(i[0]==="#")return i.length===4?(t=parseInt(i.substr(1),16))>=0&&t<=4095?[(3840&t)>>4|(3840&t)>>8,240&t|(240&t)>>4,15&t|(15&t)<<4,1]:null:i.length===7&&(t=parseInt(i.substr(1),16))>=0&&t<=16777215?[(16711680&t)>>16,(65280&t)>>8,255&t,1]:null;var o=i.indexOf("("),c=i.indexOf(")");if(o!==-1&&c+1===i.length){var u=i.substr(0,o),d=i.substr(o+1,c-(o+1)).split(","),p=1;switch(u){case"rgba":if(d.length!==4)return null;p=Ks(d.pop());case"rgb":return d.length!==3?null:[os(d[0]),os(d[1]),os(d[2]),p];case"hsla":if(d.length!==4)return null;p=Ks(d.pop());case"hsl":if(d.length!==3)return null;var g=(parseFloat(d[0])%360+360)%360/360,_=Ks(d[1]),v=Ks(d[2]),b=v<=.5?v*(_+1):v+_-v*_,S=2*v-b;return[Zi(255*Js(S,b,g+1/3)),Zi(255*Js(S,b,g)),Zi(255*Js(S,b,g-1/3)),p];default:return null}}return null}}catch{}class ci{constructor(t,i,o,c=1){this.r=t,this.g=i,this.b=o,this.a=c}static parse(t){if(!t)return;if(t instanceof ci)return t;if(typeof t!="string")return;const i=vs(t);return i?new ci(i[0]/255*i[3],i[1]/255*i[3],i[2]/255*i[3],i[3]):void 0}toString(){const[t,i,o,c]=this.toArray();return`rgba(${Math.round(t)},${Math.round(i)},${Math.round(o)},${c})`}toArray(){const{r:t,g:i,b:o,a:c}=this;return c===0?[0,0,0,0]:[255*t/c,255*i/c,255*o/c,c]}toArray01(){const{r:t,g:i,b:o,a:c}=this;return c===0?[0,0,0,0]:[t/c,i/c,o/c,c]}toArray01Scaled(t){const{r:i,g:o,b:c,a:u}=this;return u===0?[0,0,0]:[i/u*t,o/u*t,c/u*t]}toArray01PremultipliedAlpha(){const{r:t,g:i,b:o,a:c}=this;return[t,i,o,c]}toArray01Linear(){const{r:t,g:i,b:o,a:c}=this;return c===0?[0,0,0,0]:[Math.pow(t/c,2.2),Math.pow(i/c,2.2),Math.pow(o/c,2.2),c]}}ci.black=new ci(0,0,0,1),ci.white=new ci(1,1,1,1),ci.transparent=new ci(0,0,0,0),ci.red=new ci(1,0,0,1),ci.blue=new ci(0,0,1,1);var tn=ci;class Kl{constructor(t,i,o){this.sensitivity=t?i?"variant":"case":i?"accent":"base",this.locale=o,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,i){return this.collator.compare(t,i)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Jl{constructor(t,i,o,c,u){this.text=t.normalize?t.normalize():t,this.image=i,this.scale=o,this.fontStack=c,this.textColor=u}}class Is{constructor(t){this.sections=t}static fromString(t){return new Is([new Jl(t,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.namePrimary.length!==0)}static factory(t){return t instanceof Is?t:Is.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}serialize(){const t=["format"];for(const i of this.sections){if(i.image){t.push(["image",i.image.namePrimary]);continue}t.push(i.text);const o={};i.fontStack&&(o["text-font"]=["literal",i.fontStack.split(",")]),i.scale&&(o["font-scale"]=i.scale),i.textColor&&(o["text-color"]=["rgba"].concat(i.textColor.toArray())),t.push(o)}return t}}class wo{constructor(t){this.namePrimary=t.namePrimary,t.nameSecondary&&(this.nameSecondary=t.nameSecondary),this.available=t.available}toString(){return this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}static fromString(t,i){return t?new wo({namePrimary:t,nameSecondary:i,available:!1}):null}serialize(){return this.nameSecondary?["image",this.namePrimary,this.nameSecondary]:["image",this.namePrimary]}}function LP(n,t,i,o){return typeof n=="number"&&n>=0&&n<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof i=="number"&&i>=0&&i<=255?o===void 0||typeof o=="number"&&o>=0&&o<=1?null:`Invalid rgba value [${[n,t,i,o].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof o=="number"?[n,t,i,o]:[n,t,i]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Wh(n){if(n===null||typeof n=="string"||typeof n=="boolean"||typeof n=="number"||n instanceof tn||n instanceof Kl||n instanceof Is||n instanceof wo)return!0;if(Array.isArray(n)){for(const t of n)if(!Wh(t))return!1;return!0}if(typeof n=="object"){for(const t in n)if(!Wh(n[t]))return!1;return!0}return!1}function gi(n){if(n===null)return ys;if(typeof n=="string")return pn;if(typeof n=="boolean")return An;if(typeof n=="number")return pe;if(n instanceof tn)return qi;if(n instanceof Kl)return de;if(n instanceof Is)return je;if(n instanceof wo)return ur;if(Array.isArray(n)){const t=n.length;let i;for(const o of n){const c=gi(o);if(i){if(i===c)continue;i=bt;break}i=c}return on(i||bt,t)}return mt}function zf(n){const t=typeof n;return n===null?"":t==="string"||t==="number"||t==="boolean"?String(n):n instanceof tn||n instanceof Is||n instanceof wo?n.toString():JSON.stringify(n)}class w1{constructor(t,i){this.type=t,this.value=i}static parse(t,i){if(t.length!==2)return i.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Wh(t[1]))return i.error("invalid value");const o=t[1];let c=gi(o);const u=i.expectedType;return c.kind!=="array"||c.N!==0||!u||u.kind!=="array"||typeof u.N=="number"&&u.N!==0||(c=u),new w1(c,o)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof tn?["rgba"].concat(this.value.toArray()):this.value instanceof Is?this.value.serialize():this.value}}var Nf=w1,Ci=class{constructor(n){this.name="ExpressionEvaluationError",this.message=n}toJSON(){return this.message}};const S1={string:pn,number:pe,boolean:An,object:mt};class T1{constructor(t,i){this.type=t,this.args=i}static parse(t,i){if(t.length<2)return i.error("Expected at least one argument.");let o,c=1;const u=t[0];if(u==="array"){let p,g;if(t.length>2){const _=t[1];if(typeof _!="string"||!(_ in S1)||_==="object")return i.error('The item type argument of "array" must be one of string, number, boolean',1);p=S1[_],c++}else p=bt;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return i.error('The length argument to "array" must be a positive integer literal',2);g=t[2],c++}o=on(p,g)}else o=S1[u];const d=[];for(;c<t.length;c++){const p=i.parse(t[c],c,bt);if(!p)return null;d.push(p)}return new T1(o,d)}evaluate(t){for(let i=0;i<this.args.length;i++){const o=this.args[i].evaluate(t);if(!Qr(this.type,gi(o)))return o;if(i===this.args.length-1)throw new Ci(`Expected value to be of type ${Sn(this.type)}, but found ${Sn(gi(o))} instead.`)}return null}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=this.type,i=[t.kind];if(t.kind==="array"){const o=t.itemType;if(o.kind==="string"||o.kind==="number"||o.kind==="boolean"){i.push(o.kind);const c=t.N;(typeof c=="number"||this.args.length>1)&&i.push(c)}}return i.concat(this.args.map(o=>o.serialize()))}}var nl=T1;class Ff{constructor(t){this.type=je,this.sections=t}static parse(t,i){if(t.length<2)return i.error("Expected at least one argument.");const o=t[1];if(!Array.isArray(o)&&typeof o=="object")return i.error("First argument must be an image or text section.");const c=[];let u=!1;for(let d=1;d<=t.length-1;++d){const p=t[d];if(u&&typeof p=="object"&&!Array.isArray(p)){u=!1;let g=null;if(p["font-scale"]&&(g=i.parse(p["font-scale"],1,pe),!g))return null;let _=null;if(p["text-font"]&&(_=i.parse(p["text-font"],1,on(pn)),!_))return null;let v=null;if(p["text-color"]&&(v=i.parse(p["text-color"],1,qi),!v))return null;const b=c[c.length-1];b.scale=g,b.font=_,b.textColor=v}else{const g=i.parse(t[d],1,bt);if(!g)return null;const _=g.type.kind;if(_!=="string"&&_!=="value"&&_!=="null"&&_!=="resolvedImage")return i.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");u=!0,c.push({content:g,scale:null,font:null,textColor:null})}}return new Ff(c)}evaluate(t){return new Is(this.sections.map(i=>{const o=i.content.evaluate(t);return gi(o)===ur?new Jl("",o,null,null,null):new Jl(zf(o),null,i.scale?i.scale.evaluate(t):null,i.font?i.font.evaluate(t).join(","):null,i.textColor?i.textColor.evaluate(t):null)}))}eachChild(t){for(const i of this.sections)t(i.content),i.scale&&t(i.scale),i.font&&t(i.font),i.textColor&&t(i.textColor)}outputDefined(){return!1}serialize(){const t=["format"];for(const i of this.sections){t.push(i.content.serialize());const o={};i.scale&&(o["font-scale"]=i.scale.serialize()),i.font&&(o["text-font"]=i.font.serialize()),i.textColor&&(o["text-color"]=i.textColor.serialize()),t.push(o)}return t}}class Bf{constructor(t,i){this.type=ur,this.inputPrimary=t,this.inputSecondary=i}static parse(t,i){if(t.length<2)return i.error("Expected two or more arguments.");const o=i.parse(t[1],1,pn);if(!o)return i.error("No image name provided.");if(t.length===2)return new Bf(o);const c=i.parse(t[2],1,pn);return c?new Bf(o,c):i.error("Secondary image variant is not a string.")}evaluate(t){const i=wo.fromString(this.inputPrimary.evaluate(t),this.inputSecondary?this.inputSecondary.evaluate(t):void 0);return i&&t.availableImages&&(i.available=t.availableImages.indexOf(i.namePrimary)>-1,i.nameSecondary&&i.available&&t.availableImages&&(i.available=t.availableImages.indexOf(i.nameSecondary)>-1)),i}eachChild(t){t(this.inputPrimary),this.inputSecondary&&t(this.inputSecondary)}outputDefined(){return!1}serialize(){return this.inputSecondary?["image",this.inputPrimary.serialize(),this.inputSecondary.serialize()]:["image",this.inputPrimary.serialize()]}}function Fn(n){return n instanceof Number?"number":n instanceof String?"string":n instanceof Boolean?"boolean":Array.isArray(n)?"array":n===null?"null":typeof n}const r7={"to-boolean":An,"to-color":qi,"to-number":pe,"to-string":pn};class E1{constructor(t,i){this.type=t,this.args=i}static parse(t,i){if(t.length<2)return i.error("Expected at least one argument.");const o=t[0],c=[];let u=ys;if(o==="to-array"){if(!Array.isArray(t[1]))return null;const d=t[1].length;if(i.expectedType){if(i.expectedType.kind!=="array")return i.error(`Expected ${i.expectedType.kind} but found array.`);u=on(i.expectedType.itemType,d)}else{if(!(d>0&&Wh(t[1][0])))return null;u=on(gi(t[1][0]),d)}for(let p=0;p<d;p++){const g=t[1][p];let _;if(Fn(g)==="array")_=i.parse(g,void 0,u.itemType);else{const v=Fn(g);if(v!==u.itemType.kind)return i.error(`Expected ${u.itemType.kind} but found ${v}.`);_=i.registry.literal.parse(["literal",g===void 0?null:g],i)}if(!_)return null;c.push(_)}}else{if((o==="to-boolean"||o==="to-string")&&t.length!==2)return i.error("Expected one argument.");u=r7[o];for(let d=1;d<t.length;d++){const p=i.parse(t[d],d,bt);if(!p)return null;c.push(p)}}return new E1(u,c)}evaluate(t){if(this.type.kind==="boolean")return!!this.args[0].evaluate(t);if(this.type.kind==="color"){let i,o;for(const c of this.args){if(i=c.evaluate(t),o=null,i instanceof tn)return i;if(typeof i=="string"){const u=t.parseColor(i);if(u)return u}else if(Array.isArray(i)&&(o=i.length<3||i.length>4?`Invalid rbga value ${JSON.stringify(i)}: expected an array containing either three or four numeric values.`:LP(i[0],i[1],i[2],i[3]),!o))return new tn(i[0]/255,i[1]/255,i[2]/255,i[3])}throw new Ci(o||`Could not parse color from value '${typeof i=="string"?i:String(JSON.stringify(i))}'`)}if(this.type.kind==="number"){let i=null;for(const o of this.args){if(i=o.evaluate(t),i===null)return 0;const c=Number(i);if(!isNaN(c))return c}throw new Ci(`Could not convert ${JSON.stringify(i)} to number.`)}return this.type.kind==="formatted"?Is.fromString(zf(this.args[0].evaluate(t))):this.type.kind==="resolvedImage"?wo.fromString(zf(this.args[0].evaluate(t))):this.type.kind==="array"?this.args.map(i=>i.evaluate(t)):zf(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Ff([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Bf(this.args[0]).serialize();const t=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(i=>{t.push(i.serialize())}),t}}var Eu=E1;const i7=["Unknown","Point","LineString","Polygon"];var zP=class{constructor(n){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.options=n}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?i7[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(n){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const n=this.featureDistanceData.center,t=this.featureDistanceData.scale,{x:i,y:o}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(i*t-n[0])+this.featureDistanceData.bearing[1]*(o*t-n[1])}return 0}parseColor(n){let t=this._parseColorCache[n];return t||(t=this._parseColorCache[n]=tn.parse(n)),t}getConfig(n){return this.options?this.options.get(n):null}};class Mu{constructor(t,i,o,c,u){this.name=t,this.type=i,this._evaluate=o,this.args=c,this._overloadIndex=u}evaluate(t){if(!this._evaluate){const i=Mu.definitions[this.name];this._evaluate=Array.isArray(i)?i[2]:i.overloads[this._overloadIndex][1]}return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(t=>t.serialize()))}static parse(t,i){const o=t[0],c=Mu.definitions[o];if(!c)return i.error(`Unknown expression "${o}". If you wanted a literal array, use ["literal", [...]].`,0);const u=Array.isArray(c)?c[0]:c.type,d=Array.isArray(c)?[[c[1],c[2]]]:c.overloads,p=[];let g=null,_=-1;for(const[v,b]of d){if(Array.isArray(v)&&v.length!==t.length-1)continue;p.push(v),_++,g=new QP(i.registry,i.path,null,i.scope,void 0,i.options);const S=[];let E=!1;for(let A=1;A<t.length;A++){const C=t[A],P=Array.isArray(v)?v[A-1]:v.type,k=g.parse(C,1+S.length,P);if(!k){E=!0;break}S.push(k)}if(!E)if(Array.isArray(v)&&v.length!==S.length)g.error(`Expected ${v.length} arguments, but found ${S.length} instead.`);else{for(let A=0;A<S.length;A++){const C=Array.isArray(v)?v[A]:v.type,P=S[A];g.concat(A+1).checkSubtype(C,P.type)}if(g.errors.length===0)return new Mu(o,u,b,S,_)}}if(p.length===1)i.errors.push(...g.errors);else{const v=(p.length?p:d.map(([S])=>S)).map(s7).join(" | "),b=[];for(let S=1;S<t.length;S++){const E=i.parse(t[S],1+b.length);if(!E)return null;b.push(Sn(E.type))}i.error(`Expected arguments of type ${v}, but found (${b.join(", ")}) instead.`)}return null}static register(t,i){Mu.definitions=i;for(const o in i)t[o]=Mu}}function s7(n){return Array.isArray(n)?`(${n.map(Sn).join(", ")})`:`(${Sn(n.type)}...)`}var wa=Mu;class Ug{constructor(t,i,o){this.type=de,this.locale=o,this.caseSensitive=t,this.diacriticSensitive=i}static parse(t,i){if(t.length!==2)return i.error("Expected one argument.");const o=t[1];if(typeof o!="object"||Array.isArray(o))return i.error("Collator options argument must be an object.");const c=i.parse(o["case-sensitive"]!==void 0&&o["case-sensitive"],1,An);if(!c)return null;const u=i.parse(o["diacritic-sensitive"]!==void 0&&o["diacritic-sensitive"],1,An);if(!u)return null;let d=null;return o.locale&&(d=i.parse(o.locale,1,pn),!d)?null:new Ug(c,u,d)}evaluate(t){return new Kl(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}serialize(){const t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]}}var NP={exports:{}};NP.exports=function(){function n(o,c,u,d,p){for(;d>u;){if(d-u>600){var g=d-u+1,_=c-u+1,v=Math.log(g),b=.5*Math.exp(2*v/3),S=.5*Math.sqrt(v*b*(g-b)/g)*(_-g/2<0?-1:1);n(o,c,Math.max(u,Math.floor(c-_*b/g+S)),Math.min(d,Math.floor(c+(g-_)*b/g+S)),p)}var E=o[c],A=u,C=d;for(t(o,u,c),p(o[d],E)>0&&t(o,u,d);A<C;){for(t(o,A,C),A++,C--;p(o[A],E)<0;)A++;for(;p(o[C],E)>0;)C--}p(o[u],E)===0?t(o,u,C):t(o,++C,d),C<=c&&(u=C+1),c<=C&&(d=C-1)}}function t(o,c,u){var d=o[c];o[c]=o[u],o[u]=d}function i(o,c){return o<c?-1:o>c?1:0}return function(o,c,u,d,p){n(o,c,u||0,d||o.length-1,p||i)}}();var o7=H(NP.exports);function a7(n){let t=0;for(let i,o,c=0,u=n.length,d=u-1;c<u;d=c++)i=n[c],o=n[d],t+=(o.x-i.x)*(i.y+o.y);return t}function jf(n,t){n[0]=Math.min(n[0],t[0]),n[1]=Math.min(n[1],t[1]),n[2]=Math.max(n[2],t[0]),n[3]=Math.max(n[3],t[1])}function Vf(n,t){return!(n[0]<=t[0]||n[2]>=t[2]||n[1]<=t[1]||n[3]>=t[3])}function l7(n,t,i){const o=n[0]-t[0],c=n[1]-t[1],u=n[0]-i[0],d=n[1]-i[1];return o*d-u*c==0&&o*u<=0&&c*d<=0}function Hh(n,t,i=!1){let o=!1;for(let p=0,g=t.length;p<g;p++){const _=t[p];for(let v=0,b=_.length,S=b-1;v<b;S=v++){const E=_[S],A=_[v];if(l7(n,E,A))return i;(u=E)[1]>(c=n)[1]!=(d=A)[1]>c[1]&&c[0]<(d[0]-u[0])*(c[1]-u[1])/(d[1]-u[1])+u[0]&&(o=!o)}}var c,u,d;return o}function FP(n,t,i,o){const c=o[0]-i[0],u=o[1]-i[1],d=(n[0]-i[0])*u-c*(n[1]-i[1]),p=(t[0]-i[0])*u-c*(t[1]-i[1]);return d>0&&p<0||d<0&&p>0}function $g(n,t,i,o){return(c=[o[0]-i[0],o[1]-i[1]])[0]*(u=[t[0]-n[0],t[1]-n[1]])[1]-c[1]*u[0]!=0&&!(!FP(n,t,i,o)||!FP(i,o,n,t));var c,u}const Ql=8192;function c7(n,t){const i=(180+n[0])/360,o=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n[1]*Math.PI/360)))/360,c=Math.pow(2,t.z);return[Math.round(i*c*Ql),Math.round(o*c*Ql)]}function u7(n,t){for(let i=0;i<t.length;i++)if(Hh(n,t[i]))return!0;return!1}function h7(n,t,i){for(const o of i)for(let c=0,u=o.length,d=u-1;c<u;d=c++)if($g(n,t,o[d],o[c]))return!0;return!1}function BP(n,t){for(let i=0;i<n.length;++i)if(!Hh(n[i],t))return!1;for(let i=0;i<n.length-1;++i)if(h7(n[i],n[i+1],t))return!1;return!0}function d7(n,t){for(let i=0;i<t.length;i++)if(BP(n,t[i]))return!0;return!1}function M1(n,t,i){const o=[];for(let c=0;c<n.length;c++){const u=[];for(let d=0;d<n[c].length;d++){const p=c7(n[c][d],i);jf(t,p),u.push(p)}o.push(u)}return o}function jP(n,t,i){const o=[];for(let c=0;c<n.length;c++){const u=M1(n[c],t,i);o.push(u)}return o}function VP(n,t,i,o){if(n[0]<i[0]||n[0]>i[2]){const c=.5*o;let u=n[0]-i[0]>c?-o:i[0]-n[0]>c?o:0;u===0&&(u=n[0]-i[2]>c?-o:i[2]-n[0]>c?o:0),n[0]+=u}jf(t,n)}function UP(n,t,i,o){const c=Math.pow(2,o.z)*Ql,u=[o.x*Ql,o.y*Ql],d=[];if(!n)return d;for(const p of n)for(const g of p){const _=[g.x+u[0],g.y+u[1]];VP(_,t,i,c),d.push(_)}return d}function $P(n,t,i,o){const c=Math.pow(2,o.z)*Ql,u=[o.x*Ql,o.y*Ql],d=[];if(!n)return d;for(const g of n){const _=[];for(const v of g){const b=[v.x+u[0],v.y+u[1]];jf(t,b),_.push(b)}d.push(_)}if(t[2]-t[0]<=c/2){(p=t)[0]=p[1]=1/0,p[2]=p[3]=-1/0;for(const g of d)for(const _ of g)VP(_,t,i,c)}var p;return d}class Uf{constructor(t,i){this.type=An,this.geojson=t,this.geometries=i}static parse(t,i){if(t.length!==2)return i.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Wh(t[1])){const o=t[1];if(o.type==="FeatureCollection")for(let c=0;c<o.features.length;++c){const u=o.features[c].geometry.type;if(u==="Polygon"||u==="MultiPolygon")return new Uf(o,o.features[c].geometry)}else if(o.type==="Feature"){const c=o.geometry.type;if(c==="Polygon"||c==="MultiPolygon")return new Uf(o,o.geometry)}else if(o.type==="Polygon"||o.type==="MultiPolygon")return new Uf(o,o)}return i.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(i,o){const c=[1/0,1/0,-1/0,-1/0],u=[1/0,1/0,-1/0,-1/0],d=i.canonicalID();if(!d)return!1;if(o.type==="Polygon"){const p=M1(o.coordinates,u,d),g=UP(i.geometry(),c,u,d);if(!Vf(c,u))return!1;for(const _ of g)if(!Hh(_,p))return!1}if(o.type==="MultiPolygon"){const p=jP(o.coordinates,u,d),g=UP(i.geometry(),c,u,d);if(!Vf(c,u))return!1;for(const _ of g)if(!u7(_,p))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(i,o){const c=[1/0,1/0,-1/0,-1/0],u=[1/0,1/0,-1/0,-1/0],d=i.canonicalID();if(!d)return!1;if(o.type==="Polygon"){const p=M1(o.coordinates,u,d),g=$P(i.geometry(),c,u,d);if(!Vf(c,u))return!1;for(const _ of g)if(!BP(_,p))return!1}if(o.type==="MultiPolygon"){const p=jP(o.coordinates,u,d),g=$P(i.geometry(),c,u,d);if(!Vf(c,u))return!1;for(const _ of g)if(!d7(_,p))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var A1=Uf,GP={exports:{}};GP.exports=function(){var n={kilometers:1,miles:.621371192237334,nauticalmiles:.5399568034557235,meters:1e3,metres:1e3,yards:1093.6132983377079,feet:3280.839895013123,inches:39370.078740157485},t=1/298.257223563,i=t*(2-t),o=Math.PI/180,c=function(_,v){if(_===void 0)throw new Error("No latitude given.");if(v&&!n[v])throw new Error("Unknown unit "+v+". Use one of: "+Object.keys(n).join(", "));var b=6378.137*o*(v?n[v]:1),S=Math.cos(_*o),E=1/(1-i*(1-S*S)),A=Math.sqrt(E);this.kx=b*A*S,this.ky=b*A*E*(1-i)},u={units:{configurable:!0}};function d(_,v){return _[0]===v[0]&&_[1]===v[1]}function p(_,v,b){var S=g(v[0]-_[0]);return[_[0]+S*b,_[1]+(v[1]-_[1])*b]}function g(_){for(;_<-180;)_+=360;for(;_>180;)_-=360;return _}return c.fromTile=function(_,v,b){var S=Math.PI*(1-2*(_+.5)/Math.pow(2,v)),E=Math.atan(.5*(Math.exp(S)-Math.exp(-S)))/o;return new c(E,b)},u.units.get=function(){return n},c.prototype.distance=function(_,v){var b=g(_[0]-v[0])*this.kx,S=(_[1]-v[1])*this.ky;return Math.sqrt(b*b+S*S)},c.prototype.bearing=function(_,v){var b=g(v[0]-_[0])*this.kx;return Math.atan2(b,(v[1]-_[1])*this.ky)/o},c.prototype.destination=function(_,v,b){var S=b*o;return this.offset(_,Math.sin(S)*v,Math.cos(S)*v)},c.prototype.offset=function(_,v,b){return[_[0]+v/this.kx,_[1]+b/this.ky]},c.prototype.lineDistance=function(_){for(var v=0,b=0;b<_.length-1;b++)v+=this.distance(_[b],_[b+1]);return v},c.prototype.area=function(_){for(var v=0,b=0;b<_.length;b++)for(var S=_[b],E=0,A=S.length,C=A-1;E<A;C=E++)v+=g(S[E][0]-S[C][0])*(S[E][1]+S[C][1])*(b?-1:1);return Math.abs(v)/2*this.kx*this.ky},c.prototype.along=function(_,v){var b=0;if(v<=0)return _[0];for(var S=0;S<_.length-1;S++){var E=_[S],A=_[S+1],C=this.distance(E,A);if((b+=C)>v)return p(E,A,(v-(b-C))/C)}return _[_.length-1]},c.prototype.pointToSegmentDistance=function(_,v,b){var S=v[0],E=v[1],A=g(b[0]-S)*this.kx,C=(b[1]-E)*this.ky,P=0;return A===0&&C===0||((P=(g(_[0]-S)*this.kx*A+(_[1]-E)*this.ky*C)/(A*A+C*C))>1?(S=b[0],E=b[1]):P>0&&(S+=A/this.kx*P,E+=C/this.ky*P)),A=g(_[0]-S)*this.kx,C=(_[1]-E)*this.ky,Math.sqrt(A*A+C*C)},c.prototype.pointOnLine=function(_,v){for(var b,S,E,A,C=1/0,P=0;P<_.length-1;P++){var k=_[P][0],L=_[P][1],j=g(_[P+1][0]-k)*this.kx,V=(_[P+1][1]-L)*this.ky,F=0;j===0&&V===0||((F=(g(v[0]-k)*this.kx*j+(v[1]-L)*this.ky*V)/(j*j+V*V))>1?(k=_[P+1][0],L=_[P+1][1]):F>0&&(k+=j/this.kx*F,L+=V/this.ky*F));var U=(j=g(v[0]-k)*this.kx)*j+(V=(v[1]-L)*this.ky)*V;U<C&&(C=U,b=k,S=L,E=P,A=F)}return{point:[b,S],index:E,t:Math.max(0,Math.min(1,A))}},c.prototype.lineSlice=function(_,v,b){var S=this.pointOnLine(b,_),E=this.pointOnLine(b,v);if(S.index>E.index||S.index===E.index&&S.t>E.t){var A=S;S=E,E=A}var C=[S.point],P=S.index+1,k=E.index;!d(b[P],C[0])&&P<=k&&C.push(b[P]);for(var L=P+1;L<=k;L++)C.push(b[L]);return d(b[k],E.point)||C.push(E.point),C},c.prototype.lineSliceAlong=function(_,v,b){for(var S=0,E=[],A=0;A<b.length-1;A++){var C=b[A],P=b[A+1],k=this.distance(C,P);if((S+=k)>_&&E.length===0&&E.push(p(C,P,(_-(S-k))/k)),S>=v)return E.push(p(C,P,(v-(S-k))/k)),E;S>_&&E.push(P)}return E},c.prototype.bufferPoint=function(_,v){var b=v/this.ky,S=v/this.kx;return[_[0]-S,_[1]-b,_[0]+S,_[1]+b]},c.prototype.bufferBBox=function(_,v){var b=v/this.ky,S=v/this.kx;return[_[0]-S,_[1]-b,_[2]+S,_[3]+b]},c.prototype.insideBBox=function(_,v){return g(_[0]-v[0])>=0&&g(_[0]-v[2])<=0&&_[1]>=v[1]&&_[1]<=v[3]},Object.defineProperties(c,u),c}();var C1=H(GP.exports),WP={exports:{}};WP.exports=function(){var n=function(i,o){if(i===void 0&&(i=[]),o===void 0&&(o=t),this.data=i,this.length=this.data.length,this.compare=o,this.length>0)for(var c=(this.length>>1)-1;c>=0;c--)this._down(c)};function t(i,o){return i<o?-1:i>o?1:0}return n.prototype.push=function(i){this.data.push(i),this.length++,this._up(this.length-1)},n.prototype.pop=function(){if(this.length!==0){var i=this.data[0],o=this.data.pop();return this.length--,this.length>0&&(this.data[0]=o,this._down(0)),i}},n.prototype.peek=function(){return this.data[0]},n.prototype._up=function(i){for(var o=this.data,c=this.compare,u=o[i];i>0;){var d=i-1>>1,p=o[d];if(c(u,p)>=0)break;o[i]=p,i=d}o[i]=u},n.prototype._down=function(i){for(var o=this.data,c=this.compare,u=this.length>>1,d=o[i];i<u;){var p=1+(i<<1),g=o[p],_=p+1;if(_<this.length&&c(o[_],g)<0&&(p=_,g=o[_]),c(g,d)>=0)break;o[i]=g,i=p}o[i]=d},n}();var P1=H(WP.exports),Dt=8192;function HP(n,t){return t.dist-n.dist}const I1=100,k1=50;function qP(n){const t=[1/0,1/0,-1/0,-1/0];if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(t[i]!==n[i])return!1;return!0}function Gg(n){return n[1]-n[0]+1}function rl(n,t){const i=n[1]>=n[0]&&n[1]<t;return i||console.warn("Distance Expression: Index is out of range"),i}function D1(n,t){if(n[0]>n[1])return[null,null];const i=Gg(n);if(t){if(i===2)return[n,null];const o=Math.floor(i/2);return[[n[0],n[0]+o],[n[0]+o,n[1]]]}{if(i===1)return[n,null];const o=Math.floor(i/2)-1;return[[n[0],n[0]+o],[n[0]+o+1,n[1]]]}}function Au(n,t){const i=[1/0,1/0,-1/0,-1/0];if(!rl(t,n.length))return i;for(let o=t[0];o<=t[1];++o)jf(i,n[o]);return i}function Wg(n){const t=[1/0,1/0,-1/0,-1/0];for(let i=0;i<n.length;++i)for(let o=0;o<n[i].length;++o)jf(t,n[i][o]);return t}function qh(n,t,i){if(qP(n)||qP(t))return NaN;let o=0,c=0;return n[2]<t[0]&&(o=t[0]-n[2]),n[0]>t[2]&&(o=n[0]-t[2]),n[1]>t[3]&&(c=n[1]-t[3]),n[3]<t[1]&&(c=t[1]-n[3]),i.distance([0,0],[o,c])}function R1(n,t){const i=Math.pow(2,t.z);return[(c=(n.x/Dt+t.x)/i,360*c-180),(o=(n.y/Dt+t.y)/i,360/Math.PI*Math.atan(Math.exp((180-360*o)*Math.PI/180))-90)];var o,c}function f7(n,t){const i=[];for(let o=0;o<n.length;++o)i.push(R1(n[o],t));return i}function ZP(n,t,i){const o=i.pointOnLine(t,n).point;return i.distance(n,o)}function XP(n,t,i,o,c){const u=i.slice(o[0],o[1]+1);let d=1/0;for(let p=t[0];p<=t[1];++p)if((d=Math.min(d,ZP(n[p],u,c)))===0)return 0;return d}function O1(n,t,i,o,c){const u=Math.min(c.pointToSegmentDistance(n,i,o),c.pointToSegmentDistance(t,i,o)),d=Math.min(c.pointToSegmentDistance(i,n,t),c.pointToSegmentDistance(o,n,t));return Math.min(u,d)}function p7(n,t,i,o,c){if(!rl(t,n.length)||!rl(o,i.length))return NaN;let u=1/0;for(let d=t[0];d<t[1];++d)for(let p=o[0];p<o[1];++p){if($g(n[d],n[d+1],i[p],i[p+1]))return 0;u=Math.min(u,O1(n[d],n[d+1],i[p],i[p+1],c))}return u}function m7(n,t,i,o,c){if(!rl(t,n.length)||!rl(o,i.length))return NaN;let u=1/0;for(let d=t[0];d<=t[1];++d)for(let p=o[0];p<=o[1];++p)if((u=Math.min(u,c.distance(n[d],i[p])))===0)return u;return u}function g7(n,t,i){if(Hh(n,t,!0))return 0;let o=1/0;for(const c of t){const u=c.length;if(u<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(c[0]!==c[u-1]&&(o=Math.min(o,i.pointToSegmentDistance(n,c[u-1],c[0])))===0||(o=Math.min(o,ZP(n,c,i)))===0)return o}return o}function _7(n,t,i,o){if(!rl(t,n.length))return NaN;for(let u=t[0];u<=t[1];++u)if(Hh(n[u],i,!0))return 0;let c=1/0;for(let u=t[0];u<t[1];++u)for(const d of i)for(let p=0,g=d.length,_=g-1;p<g;_=p++){if($g(n[u],n[u+1],d[_],d[p]))return 0;c=Math.min(c,O1(n[u],n[u+1],d[_],d[p],o))}return c}function YP(n,t){for(const i of n)for(let o=0;o<=i.length-1;++o)if(Hh(i[o],t,!0))return!0;return!1}function y7(n,t,i,o=1/0){const c=Wg(n),u=Wg(t);if(o!==1/0&&qh(c,u,i)>=o)return o;if(Vf(c,u)){if(YP(n,t))return 0}else if(YP(t,n))return 0;let d=o;for(const p of n)for(let g=0,_=p.length,v=_-1;g<_;v=g++)for(const b of t)for(let S=0,E=b.length,A=E-1;S<E;A=S++){if($g(p[v],p[g],b[A],b[S]))return 0;d=Math.min(d,O1(p[v],p[g],b[A],b[S],i))}return d}function Hg(n,t,i,o,c,u,d){if(u===null||d===null)return;const p=qh(Au(o,u),Au(c,d),i);p<t&&n.push({dist:p,range1:u,range2:d})}function v7(n,t,i,o,c=1/0){let u=Math.min(o.distance(n[0],i[0][0]),c);if(u===0)return u;const d=new P1([{dist:0,range1:[0,n.length-1],range2:[0,0]}],HP),p=t?k1:I1,g=Wg(i);for(;d.length;){const _=d.pop();if(_.dist>=u)continue;const v=_.range1;if(Gg(v)<=p){if(!rl(v,n.length))return NaN;if(t){const b=_7(n,v,i,o);if((u=Math.min(u,b))===0)return u}else for(let b=v[0];b<=v[1];++b){const S=g7(n[b],i,o);if((u=Math.min(u,S))===0)return u}}else{const b=D1(v,t);if(b[0]!==null){const S=qh(Au(n,b[0]),g,o);S<u&&d.push({dist:S,range1:b[0],range2:[0,0]})}if(b[1]!==null){const S=qh(Au(n,b[1]),g,o);S<u&&d.push({dist:S,range1:b[1],range2:[0,0]})}}}return u}function KP(n,t,i,o,c,u=1/0){let d=Math.min(u,c.distance(n[0],i[0]));if(d===0)return d;const p=new P1([{dist:0,range1:[0,n.length-1],range2:[0,i.length-1]}],HP),g=t?k1:I1,_=o?k1:I1;for(;p.length;){const v=p.pop();if(v.dist>=d)continue;const b=v.range1,S=v.range2;if(Gg(b)<=g&&Gg(S)<=_){if(!rl(b,n.length)||!rl(S,i.length))return NaN;if(t&&o?d=Math.min(d,p7(n,b,i,S,c)):t||o?t&&!o?d=Math.min(d,XP(i,S,n,b,c)):!t&&o&&(d=Math.min(d,XP(n,b,i,S,c))):d=Math.min(d,m7(n,b,i,S,c)),d===0)return d}else{const E=D1(b,t),A=D1(S,o);Hg(p,d,c,n,i,E[0],A[0]),Hg(p,d,c,n,i,E[0],A[1]),Hg(p,d,c,n,i,E[1],A[0]),Hg(p,d,c,n,i,E[1],A[1])}}return d}function L1(n,t,i,o,c=1/0){let u=c;const d=Au(n,[0,n.length-1]);for(const p of i)if(!(u!==1/0&&qh(d,Au(p,[0,p.length-1]),o)>=u)&&(u=Math.min(u,KP(n,t,p,!0,o,u)),u===0))return u;return u}function qg(n,t,i,o,c=1/0){let u=c;const d=Au(n,[0,n.length-1]);for(const p of i){if(u!==1/0&&qh(d,Wg(p),o)>=u)continue;const g=v7(n,t,p,o,u);if(isNaN(g))return g;if((u=Math.min(u,g))===0)return u}return u}function z1(n){return n==="Point"||n==="MultiPoint"||n==="LineString"||n==="MultiLineString"||n==="Polygon"||n==="MultiPolygon"}class $f{constructor(t,i){this.type=pe,this.geojson=t,this.geometries=i}static parse(t,i){if(t.length!==2)return i.error(`'distance' expression requires either one argument, but found ' ${t.length-1} instead.`);if(Wh(t[1])){const o=t[1];if(o.type==="FeatureCollection"){for(let c=0;c<o.features.length;++c)if(z1(o.features[c].geometry.type))return new $f(o,o.features[c].geometry)}else if(o.type==="Feature"){if(z1(o.geometry.type))return new $f(o,o.geometry)}else if(z1(o.type))return new $f(o,o)}return i.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(t){const i=t.geometry(),o=t.canonicalID();if(i!=null&&o!=null){if(t.geometryType()==="Point")return function(c,u,d){const p=[];for(const _ of c)for(const v of _)p.push(R1(v,u));const g=new C1(p[0][1],"meters");return d.type==="Point"||d.type==="MultiPoint"||d.type==="LineString"?KP(p,!1,d.type==="Point"?[d.coordinates]:d.coordinates,d.type==="LineString",g):d.type==="MultiLineString"?L1(p,!1,d.coordinates,g):d.type==="Polygon"||d.type==="MultiPolygon"?qg(p,!1,d.type==="Polygon"?[d.coordinates]:d.coordinates,g):null}(i,o,this.geometries);if(t.geometryType()==="LineString")return function(c,u,d){const p=[];for(const _ of c){const v=[];for(const b of _)v.push(R1(b,u));p.push(v)}const g=new C1(p[0][0][1],"meters");if(d.type==="Point"||d.type==="MultiPoint"||d.type==="LineString")return L1(d.type==="Point"?[d.coordinates]:d.coordinates,d.type==="LineString",p,g);if(d.type==="MultiLineString"){let _=1/0;for(let v=0;v<d.coordinates.length;v++){const b=L1(d.coordinates[v],!0,p,g,_);if(isNaN(b))return b;if((_=Math.min(_,b))===0)return _}return _}if(d.type==="Polygon"||d.type==="MultiPolygon"){let _=1/0;for(let v=0;v<p.length;v++){const b=qg(p[v],!0,d.type==="Polygon"?[d.coordinates]:d.coordinates,g,_);if(isNaN(b))return b;if((_=Math.min(_,b))===0)return _}return _}return null}(i,o,this.geometries);if(t.geometryType()==="Polygon")return function(c,u,d){const p=[];for(const _ of function(v,b){const S=v.length;if(S<=1)return[v];const E=[];let A,C;for(let P=0;P<S;P++){const k=a7(v[P]);k!==0&&(v[P].area=Math.abs(k),C===void 0&&(C=k<0),C===k<0?(A&&E.push(A),A=[v[P]]):A.push(v[P]))}return A&&E.push(A),E}(c)){const v=[];for(let b=0;b<_.length;++b)v.push(f7(_[b],u));p.push(v)}const g=new C1(p[0][0][0][1],"meters");if(d.type==="Point"||d.type==="MultiPoint"||d.type==="LineString")return qg(d.type==="Point"?[d.coordinates]:d.coordinates,d.type==="LineString",p,g);if(d.type==="MultiLineString"){let _=1/0;for(let v=0;v<d.coordinates.length;v++){const b=qg(d.coordinates[v],!0,p,g,_);if(isNaN(b))return b;if((_=Math.min(_,b))===0)return _}return _}return d.type==="Polygon"||d.type==="MultiPolygon"?function(_,v,b){let S=1/0;for(const E of _)for(const A of v){const C=y7(E,A,b,S);if(isNaN(C))return C;if((S=Math.min(S,C))===0)return S}return S}(d.type==="Polygon"?[d.coordinates]:d.coordinates,p,g):null}(i,o,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}var N1=$f;function Zh(n){if(n instanceof wa&&(n.name==="get"&&n.args.length===1||n.name==="feature-state"||n.name==="has"&&n.args.length===1||n.name==="properties"||n.name==="geometry-type"||n.name==="id"||/^filter-/.test(n.name))||n instanceof A1||n instanceof N1)return!1;let t=!0;return n.eachChild(i=>{t&&!Zh(i)&&(t=!1)}),t}function Gf(n){if(n instanceof wa&&n.name==="feature-state")return!1;let t=!0;return n.eachChild(i=>{t&&!Gf(i)&&(t=!1)}),t}function F1(n){if(n instanceof wa&&n.name==="config")return!1;let t=!0;return n.eachChild(i=>{t&&!F1(i)&&(t=!1)}),t}function Xh(n,t){if(n instanceof wa&&t.indexOf(n.name)>=0)return!1;let i=!0;return n.eachChild(o=>{i&&!Xh(o,t)&&(i=!1)}),i}class B1{constructor(t,i){this.type=i.type,this.name=t,this.boundExpression=i}static parse(t,i){if(t.length!==2||typeof t[1]!="string")return i.error("'var' expression requires exactly one string literal argument.");const o=t[1];return i.scope.has(o)?new B1(o,i.scope.get(o)):i.error(`Unknown variable "${o}". Make sure "${o}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var JP=B1;class j1{constructor(t,i=[],o,c=new el,u=[],d){this.registry=t,this.path=i,this.key=i.map(p=>`[${p}]`).join(""),this.scope=c,this.errors=u,this.expectedType=o,this.options=d}parse(t,i,o,c,u={}){return i||o?this.concat(i,o,c)._parse(t,u):this._parse(t,u)}_parse(t,i){function o(c,u,d){return d==="assert"?new nl(u,[c]):d==="coerce"?new Eu(u,[c]):c}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const c=typeof t[0]=="string"?this.registry[t[0]]:void 0;if(c){let u=c.parse(t,this);if(!u)return null;if(this.expectedType){const d=this.expectedType,p=u.type;if(d.kind!=="string"&&d.kind!=="number"&&d.kind!=="boolean"&&d.kind!=="object"&&d.kind!=="array"||p.kind!=="value")if(d.kind!=="color"&&d.kind!=="formatted"&&d.kind!=="resolvedImage"||p.kind!=="value"&&p.kind!=="string"){if(this.checkSubtype(d,p))return null}else u=o(u,d,i.typeAnnotation||"coerce");else u=o(u,d,i.typeAnnotation||"assert")}if(!(u instanceof Nf)&&u.type.kind!=="resolvedImage"&&V1(u)){const d=new zP(this.options);try{u=new Nf(u.type,u.evaluate(d))}catch(p){return this.error(p.message),null}}return u}return Eu.parse(["to-array",t],this)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,i,o){const c=typeof t=="number"?this.path.concat(t):this.path,u=o?this.scope.concat(o):this.scope;return new j1(this.registry,c,i||null,u,this.errors,this.options)}error(t,...i){const o=`${this.key}${i.map(c=>`[${c}]`).join("")}`;this.errors.push(new _s(o,t))}checkSubtype(t,i){const o=Qr(t,i);return o&&this.error(o),o}}var QP=j1;function V1(n){if(n instanceof JP)return V1(n.boundExpression);if(n instanceof wa&&n.name==="error"||n instanceof wa&&n.name==="config"||n instanceof Ug||n instanceof A1||n instanceof N1)return!1;const t=n instanceof Eu||n instanceof nl;let i=!0;return n.eachChild(o=>{i=t?i&&V1(o):i&&o instanceof Nf}),!!i&&Zh(n)&&Xh(n,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light"])}function Zg(n,t){const i=n.length-1;let o,c,u=0,d=i,p=0;for(;u<=d;)if(p=Math.floor((u+d)/2),o=n[p],c=n[p+1],o<=t){if(p===i||t<c)return p;u=p+1}else{if(!(o>t))throw new Ci("Input is not a number.");d=p-1}return 0}class U1{constructor(t,i,o){this.type=t,this.input=i,this.labels=[],this.outputs=[];for(const[c,u]of o)this.labels.push(c),this.outputs.push(u)}static parse(t,i){if(t.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return i.error("Expected an even number of arguments.");const o=i.parse(t[1],1,pe);if(!o)return null;const c=[];let u=null;i.expectedType&&i.expectedType.kind!=="value"&&(u=i.expectedType);for(let d=1;d<t.length;d+=2){const p=d===1?-1/0:t[d],g=t[d+1],_=d,v=d+1;if(typeof p!="number")return i.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',_);if(c.length&&c[c.length-1][0]>=p)return i.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',_);const b=i.parse(g,v,u);if(!b)return null;u=u||b.type,c.push([p,b])}return new U1(u,o,c)}evaluate(t){const i=this.labels,o=this.outputs;if(i.length===1)return o[0].evaluate(t);const c=this.input.evaluate(t);if(c<=i[0])return o[0].evaluate(t);const u=i.length;return c>=i[u-1]?o[u-1].evaluate(t):o[Zg(i,c)].evaluate(t)}eachChild(t){t(this.input);for(const i of this.outputs)t(i)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){const t=["step",this.input.serialize()];for(let i=0;i<this.labels.length;i++)i>0&&t.push(this.labels[i]),t.push(this.outputs[i].serialize());return t}}var $1=U1;function qe(n,t,i){return n*(1-i)+t*i}function tI(n,t,i){return n.map((o,c)=>qe(o,t[c],i))}var Xg=Object.freeze({__proto__:null,array:tI,color:function(n,t,i){return new tn(qe(n.r,t.r,i),qe(n.g,t.g,i),qe(n.b,t.b,i),qe(n.a,t.a,i))},number:qe});const eI=.95047,nI=1.08883,rI=4/29,Yh=6/29,iI=3*Yh*Yh,x7=Yh*Yh*Yh,b7=Math.PI/180,w7=180/Math.PI;function G1(n){return n>x7?Math.pow(n,1/3):n/iI+rI}function W1(n){return n>Yh?n*n*n:iI*(n-rI)}function H1(n){return 255*(n<=.0031308?12.92*n:1.055*Math.pow(n,1/2.4)-.055)}function q1(n){return(n/=255)<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function sI(n){const t=q1(n.r),i=q1(n.g),o=q1(n.b),c=G1((.4124564*t+.3575761*i+.1804375*o)/eI),u=G1((.2126729*t+.7151522*i+.072175*o)/1);return{l:116*u-16,a:500*(c-u),b:200*(u-G1((.0193339*t+.119192*i+.9503041*o)/nI)),alpha:n.a}}function oI(n){let t=(n.l+16)/116,i=isNaN(n.a)?t:t+n.a/500,o=isNaN(n.b)?t:t-n.b/200;return t=1*W1(t),i=eI*W1(i),o=nI*W1(o),new tn(H1(3.2404542*i-1.5371385*t-.4985314*o),H1(-.969266*i+1.8760108*t+.041556*o),H1(.0556434*i-.2040259*t+1.0572252*o),n.alpha)}function S7(n,t,i){const o=t-n;return n+i*(o>180||o<-180?o-360*Math.round(o/360):o)}const Wf={forward:sI,reverse:oI,interpolate:function(n,t,i){return{l:qe(n.l,t.l,i),a:qe(n.a,t.a,i),b:qe(n.b,t.b,i),alpha:qe(n.alpha,t.alpha,i)}}},Hf={forward:function(n){const{l:t,a:i,b:o}=sI(n),c=Math.atan2(o,i)*w7;return{h:c<0?c+360:c,c:Math.sqrt(i*i+o*o),l:t,alpha:n.a}},reverse:function(n){const t=n.h*b7,i=n.c;return oI({l:n.l,a:Math.cos(t)*i,b:Math.sin(t)*i,alpha:n.alpha})},interpolate:function(n,t,i){return{h:S7(n.h,t.h,i),c:qe(n.c,t.c,i),l:qe(n.l,t.l,i),alpha:qe(n.alpha,t.alpha,i)}}};var aI=Object.freeze({__proto__:null,hcl:Hf,lab:Wf});class Yg{constructor(t,i,o,c,u){this.type=t,this.operator=i,this.interpolation=o,this.input=c,this.labels=[],this.outputs=[];for(const[d,p]of u)this.labels.push(d),this.outputs.push(p)}static interpolationFactor(t,i,o,c){let u=0;if(t.name==="exponential")u=Z1(i,t.base,o,c);else if(t.name==="linear")u=Z1(i,1,o,c);else if(t.name==="cubic-bezier"){const d=t.controlPoints;u=new ft(d[0],d[1],d[2],d[3]).solve(Z1(i,1,o,c))}return u}static parse(t,i){let[o,c,u,...d]=t;if(!Array.isArray(c)||c.length===0)return i.error("Expected an interpolation type expression.",1);if(c[0]==="linear")c={name:"linear"};else if(c[0]==="exponential"){const _=c[1];if(typeof _!="number")return i.error("Exponential interpolation requires a numeric base.",1,1);c={name:"exponential",base:_}}else{if(c[0]!=="cubic-bezier")return i.error(`Unknown interpolation type ${String(c[0])}`,1,0);{const _=c.slice(1);if(_.length!==4||_.some(v=>typeof v!="number"||v<0||v>1))return i.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);c={name:"cubic-bezier",controlPoints:_}}}if(t.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return i.error("Expected an even number of arguments.");if(u=i.parse(u,2,pe),!u)return null;const p=[];let g=null;o==="interpolate-hcl"||o==="interpolate-lab"?g=qi:i.expectedType&&i.expectedType.kind!=="value"&&(g=i.expectedType);for(let _=0;_<d.length;_+=2){const v=d[_],b=d[_+1],S=_+3,E=_+4;if(typeof v!="number")return i.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',S);if(p.length&&p[p.length-1][0]>=v)return i.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',S);const A=i.parse(b,E,g);if(!A)return null;g=g||A.type,p.push([v,A])}return g.kind==="number"||g.kind==="color"||g.kind==="array"&&g.itemType.kind==="number"&&typeof g.N=="number"?new Yg(g,o,c,u,p):i.error(`Type ${Sn(g)} is not interpolatable.`)}evaluate(t){const i=this.labels,o=this.outputs;if(i.length===1)return o[0].evaluate(t);const c=this.input.evaluate(t);if(c<=i[0])return o[0].evaluate(t);const u=i.length;if(c>=i[u-1])return o[u-1].evaluate(t);const d=Zg(i,c),p=Yg.interpolationFactor(this.interpolation,c,i[d],i[d+1]),g=o[d].evaluate(t),_=o[d+1].evaluate(t);return this.operator==="interpolate"?Xg[this.type.kind.toLowerCase()](g,_,p):this.operator==="interpolate-hcl"?Hf.reverse(Hf.interpolate(Hf.forward(g),Hf.forward(_),p)):Wf.reverse(Wf.interpolate(Wf.forward(g),Wf.forward(_),p))}eachChild(t){t(this.input);for(const i of this.outputs)t(i)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){let t;t=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const i=[this.operator,t,this.input.serialize()];for(let o=0;o<this.labels.length;o++)i.push(this.labels[o],this.outputs[o].serialize());return i}}function Z1(n,t,i,o){const c=o-i,u=n-i;return c===0?0:t===1?u/c:(Math.pow(t,u)-1)/(Math.pow(t,c)-1)}var Sa=Yg;class X1{constructor(t,i){this.type=t,this.args=i}static parse(t,i){if(t.length<2)return i.error("Expectected at least one argument.");let o=null;const c=i.expectedType;c&&c.kind!=="value"&&(o=c);const u=[];for(const p of t.slice(1)){const g=i.parse(p,1+u.length,o,void 0,{typeAnnotation:"omit"});if(!g)return null;o=o||g.type,u.push(g)}const d=c&&u.some(p=>Qr(c,p.type));return new X1(d?bt:o,u)}evaluate(t){let i,o=null,c=0;for(const u of this.args){if(c++,o=u.evaluate(t),o&&o instanceof wo&&!o.available&&(i||(i=o),o=null,c===this.args.length))return i;if(o!==null)break}return o}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=["coalesce"];return this.eachChild(i=>{t.push(i.serialize())}),t}}var lI=X1;class Y1{constructor(t,i){this.type=i.type,this.bindings=[].concat(t),this.result=i}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const i of this.bindings)t(i[1]);t(this.result)}static parse(t,i){if(t.length<4)return i.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const o=[];for(let u=1;u<t.length-1;u+=2){const d=t[u];if(typeof d!="string")return i.error(`Expected string, but found ${typeof d} instead.`,u);if(/[^a-zA-Z0-9_]/.test(d))return i.error("Variable names must contain only alphanumeric characters or '_'.",u);const p=i.parse(t[u+1],u+1);if(!p)return null;o.push([d,p])}const c=i.parse(t[t.length-1],t.length-1,i.expectedType,o);return c?new Y1(o,c):null}outputDefined(){return this.result.outputDefined()}serialize(){const t=["let"];for(const[i,o]of this.bindings)t.push(i,o.serialize());return t.push(this.result.serialize()),t}}var cI=Y1;class K1{constructor(t,i,o){this.type=t,this.index=i,this.input=o}static parse(t,i){if(t.length!==3)return i.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const o=i.parse(t[1],1,pe),c=i.parse(t[2],2,on(i.expectedType||bt));return o&&c?new K1(c.type.itemType,o,c):null}evaluate(t){const i=this.index.evaluate(t),o=this.input.evaluate(t);if(i<0)throw new Ci(`Array index out of bounds: ${i} < 0.`);if(i>=o.length)throw new Ci(`Array index out of bounds: ${i} > ${o.length-1}.`);if(i!==Math.floor(i))throw new Ci(`Array index must be an integer, but found ${i} instead.`);return o[i]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var T7=K1;class J1{constructor(t,i){this.type=An,this.needle=t,this.haystack=i}static parse(t,i){if(t.length!==3)return i.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const o=i.parse(t[1],1,bt),c=i.parse(t[2],2,bt);return o&&c?Cr(o.type,[An,pn,pe,ys,bt])?new J1(o,c):i.error(`Expected first argument to be of type boolean, string, number or null, but found ${Sn(o.type)} instead`):null}evaluate(t){const i=this.needle.evaluate(t),o=this.haystack.evaluate(t);if(o==null)return!1;if(!Li(i,["boolean","string","number","null"]))throw new Ci(`Expected first argument to be of type boolean, string, number or null, but found ${Sn(gi(i))} instead.`);if(!Li(o,["string","array"]))throw new Ci(`Expected second argument to be of type array or string, but found ${Sn(gi(o))} instead.`);return o.indexOf(i)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var E7=J1;class Kg{constructor(t,i,o){this.type=pe,this.needle=t,this.haystack=i,this.fromIndex=o}static parse(t,i){if(t.length<=2||t.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const o=i.parse(t[1],1,bt),c=i.parse(t[2],2,bt);if(!o||!c)return null;if(!Cr(o.type,[An,pn,pe,ys,bt]))return i.error(`Expected first argument to be of type boolean, string, number or null, but found ${Sn(o.type)} instead`);if(t.length===4){const u=i.parse(t[3],3,pe);return u?new Kg(o,c,u):null}return new Kg(o,c)}evaluate(t){const i=this.needle.evaluate(t),o=this.haystack.evaluate(t);if(!Li(i,["boolean","string","number","null"]))throw new Ci(`Expected first argument to be of type boolean, string, number or null, but found ${Sn(gi(i))} instead.`);if(!Li(o,["string","array"]))throw new Ci(`Expected second argument to be of type array or string, but found ${Sn(gi(o))} instead.`);if(this.fromIndex){const c=this.fromIndex.evaluate(t);return o.indexOf(i,c)}return o.indexOf(i)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var M7=Kg;class Q1{constructor(t,i,o,c,u,d){this.inputType=t,this.type=i,this.input=o,this.cases=c,this.outputs=u,this.otherwise=d}static parse(t,i){if(t.length<5)return i.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return i.error("Expected an even number of arguments.");let o,c;i.expectedType&&i.expectedType.kind!=="value"&&(c=i.expectedType);const u={},d=[];for(let _=2;_<t.length-1;_+=2){let v=t[_];const b=t[_+1];Array.isArray(v)||(v=[v]);const S=i.concat(_);if(v.length===0)return S.error("Expected at least one branch label.");for(const A of v){if(typeof A!="number"&&typeof A!="string")return S.error("Branch labels must be numbers or strings.");if(typeof A=="number"&&Math.abs(A)>Number.MAX_SAFE_INTEGER)return S.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof A=="number"&&Math.floor(A)!==A)return S.error("Numeric branch labels must be integer values.");if(o){if(S.checkSubtype(o,gi(A)))return null}else o=gi(A);if(u[String(A)]!==void 0)return S.error("Branch labels must be unique.");u[String(A)]=d.length}const E=i.parse(b,_,c);if(!E)return null;c=c||E.type,d.push(E)}const p=i.parse(t[1],1,bt);if(!p)return null;const g=i.parse(t[t.length-1],t.length-1,c);return g?p.type.kind!=="value"&&i.concat(1).checkSubtype(o,p.type)?null:new Q1(o,c,p,u,d,g):null}evaluate(t){const i=this.input.evaluate(t);return(gi(i)===this.inputType&&this.outputs[this.cases[i]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["match",this.input.serialize()],i=Object.keys(this.cases).sort(),o=[],c={};for(const d of i){const p=c[this.cases[d]];p===void 0?(c[this.cases[d]]=o.length,o.push([this.cases[d],[d]])):o[p][1].push(d)}const u=d=>this.inputType.kind==="number"?Number(d):d;for(const[d,p]of o)t.push(p.length===1?u(p[0]):p.map(u)),t.push(this.outputs[d].serialize());return t.push(this.otherwise.serialize()),t}}var A7=Q1;class tb{constructor(t,i,o){this.type=t,this.branches=i,this.otherwise=o}static parse(t,i){if(t.length<4)return i.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return i.error("Expected an odd number of arguments.");let o;i.expectedType&&i.expectedType.kind!=="value"&&(o=i.expectedType);const c=[];for(let d=1;d<t.length-1;d+=2){const p=i.parse(t[d],d,An);if(!p)return null;const g=i.parse(t[d+1],d+1,o);if(!g)return null;c.push([p,g]),o=o||g.type}const u=i.parse(t[t.length-1],t.length-1,o);return u?new tb(o,c,u):null}evaluate(t){for(const[i,o]of this.branches)if(i.evaluate(t))return o.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[i,o]of this.branches)t(i),t(o);t(this.otherwise)}outputDefined(){return this.branches.every(([t,i])=>i.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["case"];return this.eachChild(i=>{t.push(i.serialize())}),t}}var C7=tb;class Jg{constructor(t,i,o,c){this.type=t,this.input=i,this.beginIndex=o,this.endIndex=c}static parse(t,i){if(t.length<=2||t.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const o=i.parse(t[1],1,bt),c=i.parse(t[2],2,pe);if(!o||!c)return null;if(!Cr(o.type,[on(bt),pn,bt]))return i.error(`Expected first argument to be of type array or string, but found ${Sn(o.type)} instead`);if(t.length===4){const u=i.parse(t[3],3,pe);return u?new Jg(o.type,o,c,u):null}return new Jg(o.type,o,c)}evaluate(t){const i=this.input.evaluate(t),o=this.beginIndex.evaluate(t);if(!Li(i,["string","array"]))throw new Ci(`Expected first argument to be of type array or string, but found ${Sn(gi(i))} instead.`);if(this.endIndex){const c=this.endIndex.evaluate(t);return i.slice(o,c)}return i.slice(o)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var P7=Jg;function uI(n,t){return n==="=="||n==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function hI(n,t,i,o){return o.compare(t,i)===0}function Kh(n,t,i){const o=n!=="=="&&n!=="!=";return class OV{constructor(u,d,p){this.type=An,this.lhs=u,this.rhs=d,this.collator=p,this.hasUntypedArgument=u.type.kind==="value"||d.type.kind==="value"}static parse(u,d){if(u.length!==3&&u.length!==4)return d.error("Expected two or three arguments.");const p=u[0];let g=d.parse(u[1],1,bt);if(!g)return null;if(!uI(p,g.type))return d.concat(1).error(`"${p}" comparisons are not supported for type '${Sn(g.type)}'.`);let _=d.parse(u[2],2,bt);if(!_)return null;if(!uI(p,_.type))return d.concat(2).error(`"${p}" comparisons are not supported for type '${Sn(_.type)}'.`);if(g.type.kind!==_.type.kind&&g.type.kind!=="value"&&_.type.kind!=="value")return d.error(`Cannot compare types '${Sn(g.type)}' and '${Sn(_.type)}'.`);o&&(g.type.kind==="value"&&_.type.kind!=="value"?g=new nl(_.type,[g]):g.type.kind!=="value"&&_.type.kind==="value"&&(_=new nl(g.type,[_])));let v=null;if(u.length===4){if(g.type.kind!=="string"&&_.type.kind!=="string"&&g.type.kind!=="value"&&_.type.kind!=="value")return d.error("Cannot use collator to compare non-string types.");if(v=d.parse(u[3],3,de),!v)return null}return new OV(g,_,v)}evaluate(u){const d=this.lhs.evaluate(u),p=this.rhs.evaluate(u);if(o&&this.hasUntypedArgument){const g=gi(d),_=gi(p);if(g.kind!==_.kind||g.kind!=="string"&&g.kind!=="number")throw new Ci(`Expected arguments for "${n}" to be (string, string) or (number, number), but found (${g.kind}, ${_.kind}) instead.`)}if(this.collator&&!o&&this.hasUntypedArgument){const g=gi(d),_=gi(p);if(g.kind!=="string"||_.kind!=="string")return t(u,d,p)}return this.collator?i(u,d,p,this.collator.evaluate(u)):t(u,d,p)}eachChild(u){u(this.lhs),u(this.rhs),this.collator&&u(this.collator)}outputDefined(){return!0}serialize(){const u=[n];return this.eachChild(d=>{u.push(d.serialize())}),u}}}const I7=Kh("==",function(n,t,i){return t===i},hI),k7=Kh("!=",function(n,t,i){return t!==i},function(n,t,i,o){return!hI(0,t,i,o)}),D7=Kh("<",function(n,t,i){return t<i},function(n,t,i,o){return o.compare(t,i)<0}),R7=Kh(">",function(n,t,i){return t>i},function(n,t,i,o){return o.compare(t,i)>0}),O7=Kh("<=",function(n,t,i){return t<=i},function(n,t,i,o){return o.compare(t,i)<=0}),L7=Kh(">=",function(n,t,i){return t>=i},function(n,t,i,o){return o.compare(t,i)>=0});class eb{constructor(t,i,o,c,u,d){this.type=pn,this.number=t,this.locale=i,this.currency=o,this.unit=c,this.minFractionDigits=u,this.maxFractionDigits=d}static parse(t,i){if(t.length!==3)return i.error("Expected two arguments.");const o=i.parse(t[1],1,pe);if(!o)return null;const c=t[2];if(typeof c!="object"||Array.isArray(c))return i.error("NumberFormat options argument must be an object.");let u=null;if(c.locale&&(u=i.parse(c.locale,1,pn),!u))return null;let d=null;if(c.currency&&(d=i.parse(c.currency,1,pn),!d))return null;let p=null;if(c.unit&&(p=i.parse(c.unit,1,pn),!p))return null;let g=null;if(c["min-fraction-digits"]&&(g=i.parse(c["min-fraction-digits"],1,pe),!g))return null;let _=null;return c["max-fraction-digits"]&&(_=i.parse(c["max-fraction-digits"],1,pe),!_)?null:new eb(o,u,d,p,g,_)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(t):void 0,unit:this.unit?this.unit.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.unit&&t(this.unit),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.unit&&(t.unit=this.unit.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]}}class nb{constructor(t){this.type=pe,this.input=t}static parse(t,i){if(t.length!==2)return i.error(`Expected 1 argument, but found ${t.length-1} instead.`);const o=i.parse(t[1],1);return o?o.type.kind!=="array"&&o.type.kind!=="string"&&o.type.kind!=="value"?i.error(`Expected argument of type string or array, but found ${Sn(o.type)} instead.`):new nb(o):null}evaluate(t){const i=this.input.evaluate(t);if(typeof i=="string"||Array.isArray(i))return i.length;throw new Ci(`Expected value to be of type string or array, but found ${Sn(gi(i))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){const t=["length"];return this.eachChild(i=>{t.push(i.serialize())}),t}}function rb(n){return function(){n=1831565813+(n|=0)|0;let t=Math.imul(n^n>>>15,1|n);return t=t+Math.imul(t^t>>>7,61|t)^t,((t^t>>>14)>>>0)/4294967296}}const dI={"==":I7,"!=":k7,">":R7,"<":D7,">=":L7,"<=":O7,array:nl,at:T7,boolean:nl,case:C7,coalesce:lI,collator:Ug,format:Ff,image:Bf,in:E7,"index-of":M7,interpolate:Sa,"interpolate-hcl":Sa,"interpolate-lab":Sa,length:nb,let:cI,literal:Nf,match:A7,number:nl,"number-format":eb,object:nl,slice:P7,step:$1,string:nl,"to-boolean":Eu,"to-color":Eu,"to-number":Eu,"to-string":Eu,var:JP,within:A1,distance:N1};function fI(n,[t,i,o,c]){t=t.evaluate(n),i=i.evaluate(n),o=o.evaluate(n);const u=c?c.evaluate(n):1,d=LP(t,i,o,u);if(d)throw new Ci(d);return new tn(t/255*u,i/255*u,o/255*u,u)}function pI(n,[t,i,o,c]){t=t.evaluate(n),i=i.evaluate(n),o=o.evaluate(n);const u=c?c.evaluate(n):1,d=function(_,v,b,S){return typeof _=="number"&&_>=0&&_<=360?typeof v=="number"&&v>=0&&v<=100&&typeof b=="number"&&b>=0&&b<=100?S===void 0||typeof S=="number"&&S>=0&&S<=1?null:`Invalid hsla value [${[_,v,b,S].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof S=="number"?[_,v,b,S]:[_,v,b]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof S=="number"?[_,v,b,S]:[_,v,b]).join(", ")}]: 'h' must be between 0 and 360.`}(t,i,o,u);if(d)throw new Ci(d);const p=`hsla(${t}, ${i}%, ${o}%, ${u})`,g=tn.parse(p);if(!g)throw new Ci(`Failed to parse HSLA color: ${p}`);return g}function mI(n,t){return n in t}function ib(n,t){const i=t[n];return i===void 0?null:i}function gI(n,t){switch(n){case"string":return String(t);case"number":return+t;case"boolean":return!!t;case"color":return tn.parse(t)}return t}function _I(n,t,i,o){return o!==void 0&&(n=o*Math.round(n/o)),t!==void 0&&n<t&&(n=t),i!==void 0&&n>i&&(n=i),n}function yI(n,t,i){i.length&&(t+=`${i}`);const o=n.getConfig(t);if(!o)return null;const{type:c,value:u,values:d,minValue:p,maxValue:g,stepValue:_}=o,v=o.default.evaluate(n);let b=u?u.evaluate(n):v;return c&&(b=gI(c,b)),u!==void 0&&b!==void 0&&d&&!d.includes(b)&&(b=v,c&&(b=gI(c,b))),b===void 0||p===void 0&&g===void 0&&_===void 0||(typeof b=="number"?b=_I(b,p,g,_):Array.isArray(b)&&(b=b.map(S=>typeof S=="number"?_I(S,p,g,_):S))),b}function Cu(n){return{type:n}}wa.register(dI,{error:[{kind:"error"},[pn],(n,[t])=>{throw new Ci(t.evaluate(n))}],typeof:[pn,[bt],(n,[t])=>Sn(gi(t.evaluate(n)))],"to-rgba":[on(pe,4),[qi],(n,[t])=>t.evaluate(n).toArray()],rgb:[qi,[pe,pe,pe],fI],rgba:[qi,[pe,pe,pe,pe],fI],hsl:[qi,[pe,pe,pe],pI],hsla:[qi,[pe,pe,pe,pe],pI],has:{type:An,overloads:[[[pn],(n,[t])=>mI(t.evaluate(n),n.properties())],[[pn,mt],(n,[t,i])=>mI(t.evaluate(n),i.evaluate(n))]]},get:{type:bt,overloads:[[[pn],(n,[t])=>ib(t.evaluate(n),n.properties())],[[pn,mt],(n,[t,i])=>ib(t.evaluate(n),i.evaluate(n))]]},config:{type:bt,overloads:[[[pn],(n,[t])=>yI(n,t.evaluate(n),"")],[[pn,pn],(n,[t,i])=>yI(n,t.evaluate(n),i.evaluate(n))]]},"feature-state":[bt,[pn],(n,[t])=>ib(t.evaluate(n),n.featureState||{})],properties:[mt,[],n=>n.properties()],"geometry-type":[pn,[],n=>n.geometryType()],id:[bt,[],n=>n.id()],zoom:[pe,[],n=>n.globals.zoom],pitch:[pe,[],n=>n.globals.pitch||0],"distance-from-center":[pe,[],n=>n.distanceFromCenter()],"measure-light":[pe,[pn],(n,[t])=>n.measureLight(t.evaluate(n))],"heatmap-density":[pe,[],n=>n.globals.heatmapDensity||0],"line-progress":[pe,[],n=>n.globals.lineProgress||0],"raster-value":[pe,[],n=>n.globals.rasterValue||0],"sky-radial-progress":[pe,[],n=>n.globals.skyRadialProgress||0],accumulated:[bt,[],n=>n.globals.accumulated===void 0?null:n.globals.accumulated],"+":[pe,Cu(pe),(n,t)=>{let i=0;for(const o of t)i+=o.evaluate(n);return i}],"*":[pe,Cu(pe),(n,t)=>{let i=1;for(const o of t)i*=o.evaluate(n);return i}],"-":{type:pe,overloads:[[[pe,pe],(n,[t,i])=>t.evaluate(n)-i.evaluate(n)],[[pe],(n,[t])=>-t.evaluate(n)]]},"/":[pe,[pe,pe],(n,[t,i])=>t.evaluate(n)/i.evaluate(n)],"%":[pe,[pe,pe],(n,[t,i])=>t.evaluate(n)%i.evaluate(n)],ln2:[pe,[],()=>Math.LN2],pi:[pe,[],()=>Math.PI],e:[pe,[],()=>Math.E],"^":[pe,[pe,pe],(n,[t,i])=>Math.pow(t.evaluate(n),i.evaluate(n))],sqrt:[pe,[pe],(n,[t])=>Math.sqrt(t.evaluate(n))],log10:[pe,[pe],(n,[t])=>Math.log(t.evaluate(n))/Math.LN10],ln:[pe,[pe],(n,[t])=>Math.log(t.evaluate(n))],log2:[pe,[pe],(n,[t])=>Math.log(t.evaluate(n))/Math.LN2],sin:[pe,[pe],(n,[t])=>Math.sin(t.evaluate(n))],cos:[pe,[pe],(n,[t])=>Math.cos(t.evaluate(n))],tan:[pe,[pe],(n,[t])=>Math.tan(t.evaluate(n))],asin:[pe,[pe],(n,[t])=>Math.asin(t.evaluate(n))],acos:[pe,[pe],(n,[t])=>Math.acos(t.evaluate(n))],atan:[pe,[pe],(n,[t])=>Math.atan(t.evaluate(n))],min:[pe,Cu(pe),(n,t)=>Math.min(...t.map(i=>i.evaluate(n)))],max:[pe,Cu(pe),(n,t)=>Math.max(...t.map(i=>i.evaluate(n)))],abs:[pe,[pe],(n,[t])=>Math.abs(t.evaluate(n))],round:[pe,[pe],(n,[t])=>{const i=t.evaluate(n);return i<0?-Math.round(-i):Math.round(i)}],floor:[pe,[pe],(n,[t])=>Math.floor(t.evaluate(n))],ceil:[pe,[pe],(n,[t])=>Math.ceil(t.evaluate(n))],"filter-==":[An,[pn,bt],(n,[t,i])=>n.properties()[t.value]===i.value],"filter-id-==":[An,[bt],(n,[t])=>n.id()===t.value],"filter-type-==":[An,[pn],(n,[t])=>n.geometryType()===t.value],"filter-<":[An,[pn,bt],(n,[t,i])=>{const o=n.properties()[t.value],c=i.value;return typeof o==typeof c&&o<c}],"filter-id-<":[An,[bt],(n,[t])=>{const i=n.id(),o=t.value;return typeof i==typeof o&&i<o}],"filter->":[An,[pn,bt],(n,[t,i])=>{const o=n.properties()[t.value],c=i.value;return typeof o==typeof c&&o>c}],"filter-id->":[An,[bt],(n,[t])=>{const i=n.id(),o=t.value;return typeof i==typeof o&&i>o}],"filter-<=":[An,[pn,bt],(n,[t,i])=>{const o=n.properties()[t.value],c=i.value;return typeof o==typeof c&&o<=c}],"filter-id-<=":[An,[bt],(n,[t])=>{const i=n.id(),o=t.value;return typeof i==typeof o&&i<=o}],"filter->=":[An,[pn,bt],(n,[t,i])=>{const o=n.properties()[t.value],c=i.value;return typeof o==typeof c&&o>=c}],"filter-id->=":[An,[bt],(n,[t])=>{const i=n.id(),o=t.value;return typeof i==typeof o&&i>=o}],"filter-has":[An,[bt],(n,[t])=>t.value in n.properties()],"filter-has-id":[An,[],n=>n.id()!==null&&n.id()!==void 0],"filter-type-in":[An,[on(pn)],(n,[t])=>t.value.indexOf(n.geometryType())>=0],"filter-id-in":[An,[on(bt)],(n,[t])=>t.value.indexOf(n.id())>=0],"filter-in-small":[An,[pn,on(bt)],(n,[t,i])=>i.value.indexOf(n.properties()[t.value])>=0],"filter-in-large":[An,[pn,on(bt)],(n,[t,i])=>function(o,c,u,d){for(;u<=d;){const p=u+d>>1;if(c[p]===o)return!0;c[p]>o?d=p-1:u=p+1}return!1}(n.properties()[t.value],i.value,0,i.value.length-1)],all:{type:An,overloads:[[[An,An],(n,[t,i])=>t.evaluate(n)&&i.evaluate(n)],[Cu(An),(n,t)=>{for(const i of t)if(!i.evaluate(n))return!1;return!0}]]},any:{type:An,overloads:[[[An,An],(n,[t,i])=>t.evaluate(n)||i.evaluate(n)],[Cu(An),(n,t)=>{for(const i of t)if(i.evaluate(n))return!0;return!1}]]},"!":[An,[An],(n,[t])=>!t.evaluate(n)],"is-supported-script":[An,[pn],(n,[t])=>{const i=n.globals&&n.globals.isSupportedScript;return!i||i(t.evaluate(n))}],upcase:[pn,[pn],(n,[t])=>t.evaluate(n).toUpperCase()],downcase:[pn,[pn],(n,[t])=>t.evaluate(n).toLowerCase()],concat:[pn,Cu(bt),(n,t)=>t.map(i=>zf(i.evaluate(n))).join("")],"resolved-locale":[pn,[de],(n,[t])=>t.evaluate(n).resolvedLocale()],random:[pe,[pe,pe,bt],(n,t)=>{const[i,o,c]=t.map(d=>d.evaluate(n));if(i>o||i===o)return i;let u;if(typeof c=="string")u=function(d){let p=0;if(d.length===0)return p;for(let g=0;g<d.length;g++)p=(p<<5)-p+d.charCodeAt(g),p&=p;return p}(c);else{if(typeof c!="number")throw new Ci(`Invalid seed input: ${c}`);u=c}return i+rb(u)()*(o-i)}]});var qf=dI;function vI(n){return{result:"success",value:n}}function Pu(n){return{result:"error",value:n}}function xI(n,t){return!!n&&!!n.parameters&&n.parameters.indexOf(t)>-1}function Iu(n){return n["property-type"]==="data-driven"}function bI(n){return xI(n.expression,"measure-light")}function sb(n){return xI(n.expression,"zoom")}function ob(n){return!!n.expression&&n.expression.interpolated}function Qg(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)}function z7(n){return n}function wI(n,t){const i=t.type==="color",o=n.stops&&typeof n.stops[0][0]=="object",c=o||!(o||n.property!==void 0),u=n.type||(ob(t)?"exponential":"interval");if(i&&((n=Ar({},n)).stops&&(n.stops=n.stops.map(_=>[_[0],tn.parse(_[1])])),n.default=tn.parse(n.default?n.default:t.default)),n.colorSpace&&n.colorSpace!=="rgb"&&!aI[n.colorSpace])throw new Error(`Unknown color space: ${n.colorSpace}`);let d,p,g;if(u==="exponential")d=SI;else if(u==="interval")d=F7;else if(u==="categorical"){d=N7,p=Object.create(null);for(const _ of n.stops)p[_[0]]=_[1];g=typeof n.stops[0][0]}else{if(u!=="identity")throw new Error(`Unknown function type "${u}"`);d=B7}if(o){const _={},v=[];for(let E=0;E<n.stops.length;E++){const A=n.stops[E],C=A[0].zoom;_[C]===void 0&&(_[C]={zoom:C,type:n.type,property:n.property,default:n.default,stops:[]},v.push(C)),_[C].stops.push([A[0].value,A[1]])}const b=[];for(const E of v)b.push([_[E].zoom,wI(_[E],t)]);const S={name:"linear"};return{kind:"composite",interpolationType:S,interpolationFactor:Sa.interpolationFactor.bind(void 0,S),zoomStops:b.map(E=>E[0]),evaluate:({zoom:E},A)=>SI({stops:b,base:n.base},t,E).evaluate(E,A)}}if(c){const _=u==="exponential"?{name:"exponential",base:n.base!==void 0?n.base:1}:null;return{kind:"camera",interpolationType:_,interpolationFactor:Sa.interpolationFactor.bind(void 0,_),zoomStops:n.stops.map(v=>v[0]),evaluate:({zoom:v})=>d(n,t,v,p,g)}}return{kind:"source",evaluate(_,v){const b=v&&v.properties?v.properties[n.property]:void 0;return b===void 0?Zf(n.default,t.default):d(n,t,b,p,g)}}}function Zf(n,t,i){return n!==void 0?n:t!==void 0?t:i!==void 0?i:void 0}function N7(n,t,i,o,c){return Zf(typeof i===c?o[i]:void 0,n.default,t.default)}function F7(n,t,i){if(Fn(i)!=="number")return Zf(n.default,t.default);const o=n.stops.length;if(o===1||i<=n.stops[0][0])return n.stops[0][1];if(i>=n.stops[o-1][0])return n.stops[o-1][1];const c=Zg(n.stops.map(u=>u[0]),i);return n.stops[c][1]}function SI(n,t,i){const o=n.base!==void 0?n.base:1;if(Fn(i)!=="number")return Zf(n.default,t.default);const c=n.stops.length;if(c===1||i<=n.stops[0][0])return n.stops[0][1];if(i>=n.stops[c-1][0])return n.stops[c-1][1];const u=Zg(n.stops.map(v=>v[0]),i),d=function(v,b,S,E){const A=E-S,C=v-S;return A===0?0:b===1?C/A:(Math.pow(b,C)-1)/(Math.pow(b,A)-1)}(i,o,n.stops[u][0],n.stops[u+1][0]),p=n.stops[u][1],g=n.stops[u+1][1];let _=Xg[t.type]||z7;if(n.colorSpace&&n.colorSpace!=="rgb"){const v=aI[n.colorSpace];_=(b,S)=>v.reverse(v.interpolate(v.forward(b),v.forward(S),d))}return typeof p.evaluate=="function"?{evaluate(...v){const b=p.evaluate.apply(void 0,v),S=g.evaluate.apply(void 0,v);if(b!==void 0&&S!==void 0)return _(b,S,d)}}:_(p,g,d)}function B7(n,t,i){return t.type==="color"?i=tn.parse(i):t.type==="formatted"?i=Is.fromString(i.toString()):t.type==="resolvedImage"?i=wo.fromString(i.toString()):Fn(i)===t.type||t.type==="enum"&&t.values[i]||(i=void 0),Zf(i,n.default,t.default)}class ab{constructor(t,i,o){this.expression=t,this._warningHistory={},this._evaluator=new zP(o),this._defaultValue=i?function(c){return c.type==="color"&&(Qg(c.default)||Array.isArray(c.default))?new tn(0,0,0,0):c.type==="color"?tn.parse(c.default)||null:c.default===void 0?null:c.default}(i):null,this._enumValues=i&&i.type==="enum"?i.values:null}evaluateWithoutErrorHandling(t,i,o,c,u,d,p,g){return this._evaluator.globals=t,this._evaluator.feature=i,this._evaluator.featureState=o,this._evaluator.canonical=c||null,this._evaluator.availableImages=u||null,this._evaluator.formattedSection=d,this._evaluator.featureTileCoord=p||null,this._evaluator.featureDistanceData=g||null,this.expression.evaluate(this._evaluator)}evaluate(t,i,o,c,u,d,p,g){this._evaluator.globals=t,this._evaluator.feature=i||null,this._evaluator.featureState=o||null,this._evaluator.canonical=c||null,this._evaluator.availableImages=u||null,this._evaluator.formattedSection=d||null,this._evaluator.featureTileCoord=p||null,this._evaluator.featureDistanceData=g||null;try{const _=this.expression.evaluate(this._evaluator);if(_==null||typeof _=="number"&&_!=_)return this._defaultValue;if(this._enumValues&&!(_ in this._enumValues))throw new Ci(`Expected value to be one of ${Object.keys(this._enumValues).map(v=>JSON.stringify(v)).join(", ")}, but found ${JSON.stringify(_)} instead.`);return _}catch(_){return this._warningHistory[_.message]||(this._warningHistory[_.message]=!0,typeof console<"u"&&console.warn(_.message)),this._defaultValue}}}function t_(n){return Array.isArray(n)&&n.length>0&&typeof n[0]=="string"&&n[0]in qf}function tc(n,t,i){const o=new QP(qf,[],t?function(u){const d={color:qi,string:pn,number:pe,enum:pn,boolean:An,formatted:je,resolvedImage:ur};return u.type==="array"?on(d[u.value]||bt,u.length):d[u.type]}(t):void 0,void 0,void 0,i),c=o.parse(n,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return c?vI(new ab(c,t,i)):Pu(o.errors)}class lb{constructor(t,i,o){this.kind=t,this._styleExpression=i,this.isLightConstant=o,this.isStateDependent=t!=="constant"&&!Gf(i.expression),this.isConfigDependent=!F1(i.expression)}evaluateWithoutErrorHandling(t,i,o,c,u,d){return this._styleExpression.evaluateWithoutErrorHandling(t,i,o,c,u,d)}evaluate(t,i,o,c,u,d){return this._styleExpression.evaluate(t,i,o,c,u,d)}}class ec{constructor(t,i,o,c,u){this.kind=t,this.zoomStops=o,this._styleExpression=i,this.isStateDependent=t!=="camera"&&!Gf(i.expression),this.isLightConstant=u,this.isConfigDependent=!F1(i.expression),this.interpolationType=c}evaluateWithoutErrorHandling(t,i,o,c,u,d){return this._styleExpression.evaluateWithoutErrorHandling(t,i,o,c,u,d)}evaluate(t,i,o,c,u,d){return this._styleExpression.evaluate(t,i,o,c,u,d)}interpolationFactor(t,i,o){return this.interpolationType?Sa.interpolationFactor(this.interpolationType,t,i,o):0}}function cb(n,t,i){if((n=tc(n,t,i)).result==="error")return n;const o=n.value.expression,c=Zh(o);if(!c&&!Iu(t))return Pu([new _s("","data expressions not supported")]);const u=Xh(o,["zoom","pitch","distance-from-center"]);if(!u&&!sb(t))return Pu([new _s("","zoom expressions not supported")]);const d=Xh(o,["measure-light"]);if(!d&&!bI(t))return Pu([new _s("","measure-light expression not supported")]);const p=t.expression&&t.expression.relaxZoomRestriction,g=n_(o);return g||u||p?g instanceof _s?Pu([g]):g instanceof Sa&&!ob(t)?Pu([new _s("",'"interpolate" expressions cannot be used with this property')]):vI(g?new ec(c?"camera":"composite",n.value,g.labels,g instanceof Sa?g.interpolation:void 0,d):new lb(c?"constant":"source",n.value,d)):Pu([new _s("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class e_{constructor(t,i){this._parameters=t,this._specification=i,Ar(this,wI(this._parameters,this._specification))}static deserialize(t){return new e_(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function n_(n){let t=null;if(n instanceof cI)t=n_(n.result);else if(n instanceof lI){for(const i of n.args)if(t=n_(i),t)break}else(n instanceof $1||n instanceof Sa)&&n.input instanceof wa&&n.input.name==="zoom"&&(t=n);return t instanceof _s||n.eachChild(i=>{const o=n_(i);o instanceof _s?t=o:t&&o&&t!==o&&(t=new _s("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function So(n){const t=n.key,i=n.value,o=n.valueSpec||{},c=n.objectElementValidators||{},u=n.style,d=n.styleSpec;let p=[];const g=Fn(i);if(g!=="object")return[new ie(t,i,`object expected, ${g} found`)];for(const _ in i){const v=_.split(".")[0];let b;c[v]?b=c[v]:o[v]?b=Ni:c["*"]?b=c["*"]:o["*"]&&(b=Ni),b?p=p.concat(b({key:(t&&`${t}.`)+_,value:i[_],valueSpec:o[v]||o["*"],style:u,styleSpec:d,object:i,objectKey:_},i)):p.push(new Mi(t,i[_],`unknown property "${_}"`))}for(const _ in o)c[_]||o[_].required&&o[_].default===void 0&&i[_]===void 0&&p.push(new ie(t,i,`missing required property "${_}"`));return p}function TI(n){const t=n.value,i=n.valueSpec,o=n.style,c=n.styleSpec,u=n.key,d=n.arrayElementValidator||Ni;if(Fn(t)!=="array")return[new ie(u,t,`array expected, ${Fn(t)} found`)];if(i.length&&t.length!==i.length)return[new ie(u,t,`array length ${i.length} expected, length ${t.length} found`)];if(i["min-length"]&&t.length<i["min-length"])return[new ie(u,t,`array length at least ${i["min-length"]} expected, length ${t.length} found`)];let p={type:i.value,values:i.values,minimum:i.minimum,maximum:i.maximum,function:void 0};c.$version<7&&(p.function=i.function),Fn(i.value)==="object"&&(p=i.value);let g=[];for(let _=0;_<t.length;_++)g=g.concat(d({array:t,arrayIndex:_,value:t[_],valueSpec:p,style:o,styleSpec:c,key:`${u}[${_}]`},!0));return g}function EI(n){const t=n.key,i=n.value,o=n.valueSpec;let c=Fn(i);if(c==="number"&&i!=i&&(c="NaN"),c!=="number")return[new ie(t,i,`number expected, ${c} found`)];if("minimum"in o){let u=o.minimum;if(Fn(o.minimum)==="array"&&(u=o.minimum[n.arrayIndex]),i<u)return[new ie(t,i,`${i} is less than the minimum value ${u}`)]}if("maximum"in o){let u=o.maximum;if(Fn(o.maximum)==="array"&&(u=o.maximum[n.arrayIndex]),i>u)return[new ie(t,i,`${i} is greater than the maximum value ${u}`)]}return[]}function MI(n){const t=n.valueSpec,i=wr(n.value.type);let o,c,u,d={};const p=i!=="categorical"&&n.value.property===void 0,g=!p,_=Fn(n.value.stops)==="array"&&Fn(n.value.stops[0])==="array"&&Fn(n.value.stops[0][0])==="object",v=So({key:n.key,value:n.value,valueSpec:n.styleSpec.function,style:n.style,styleSpec:n.styleSpec,objectElementValidators:{stops:function(E){if(i==="identity")return[new ie(E.key,E.value,'identity function may not have a "stops" property')];let A=[];const C=E.value;return A=A.concat(TI({key:E.key,value:C,valueSpec:E.valueSpec,style:E.style,styleSpec:E.styleSpec,arrayElementValidator:b})),Fn(C)==="array"&&C.length===0&&A.push(new ie(E.key,C,"array must have at least one stop")),A},default:function(E){return Ni({key:E.key,value:E.value,valueSpec:t,style:E.style,styleSpec:E.styleSpec})}}});return i==="identity"&&p&&v.push(new ie(n.key,n.value,'missing required property "property"')),i==="identity"||n.value.stops||v.push(new ie(n.key,n.value,'missing required property "stops"')),i==="exponential"&&n.valueSpec.expression&&!ob(n.valueSpec)&&v.push(new ie(n.key,n.value,"exponential functions not supported")),n.styleSpec.$version>=8&&(g&&!Iu(n.valueSpec)?v.push(new ie(n.key,n.value,"property functions not supported")):p&&!sb(n.valueSpec)&&v.push(new ie(n.key,n.value,"zoom functions not supported"))),i!=="categorical"&&!_||n.value.property!==void 0||v.push(new ie(n.key,n.value,'"property" property is required')),v;function b(E){let A=[];const C=E.value,P=E.key;if(Fn(C)!=="array")return[new ie(P,C,`array expected, ${Fn(C)} found`)];if(C.length!==2)return[new ie(P,C,`array length 2 expected, length ${C.length} found`)];if(_){if(Fn(C[0])!=="object")return[new ie(P,C,`object expected, ${Fn(C[0])} found`)];if(C[0].zoom===void 0)return[new ie(P,C,"object stop key must have zoom")];if(C[0].value===void 0)return[new ie(P,C,"object stop key must have value")];const k=wr(C[0].zoom);if(typeof k!="number")return[new ie(P,C[0].zoom,"stop zoom values must be numbers")];if(u&&u>k)return[new ie(P,C[0].zoom,"stop zoom values must appear in ascending order")];k!==u&&(u=k,c=void 0,d={}),A=A.concat(So({key:`${P}[0]`,value:C[0],valueSpec:{zoom:{}},style:E.style,styleSpec:E.styleSpec,objectElementValidators:{zoom:EI,value:S}}))}else A=A.concat(S({key:`${P}[0]`,value:C[0],valueSpec:{},style:E.style,styleSpec:E.styleSpec},C));return t_(Sr(C[1]))?A.concat([new ie(`${P}[1]`,C[1],"expressions are not allowed in function stops.")]):A.concat(Ni({key:`${P}[1]`,value:C[1],valueSpec:t,style:E.style,styleSpec:E.styleSpec}))}function S(E,A){const C=Fn(E.value),P=wr(E.value),k=E.value!==null?E.value:A;if(o){if(C!==o)return[new ie(E.key,k,`${C} stop domain type must match previous stop domain type ${o}`)]}else o=C;if(C!=="number"&&C!=="string"&&C!=="boolean"&&typeof P!="number"&&typeof P!="string"&&typeof P!="boolean")return[new ie(E.key,k,"stop domain value must be a number, string, or boolean")];if(C!=="number"&&i!=="categorical"){let L=`number expected, ${C} found`;return Iu(t)&&i===void 0&&(L+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ie(E.key,k,L)]}return i!=="categorical"||C!=="number"||typeof P=="number"&&isFinite(P)&&Math.floor(P)===P?i!=="categorical"&&C==="number"&&typeof P=="number"&&typeof c=="number"&&c!==void 0&&P<c?[new ie(E.key,k,"stop domain values must appear in ascending order")]:(c=P,i==="categorical"&&P in d?[new ie(E.key,k,"stop domain values must be unique")]:(d[P]=!0,[])):[new ie(E.key,k,`integer expected, found ${String(P)}`)]}}function ku(n){const t=(n.expressionContext==="property"?cb:tc)(Sr(n.value),n.valueSpec);if(t.result==="error")return t.value.map(o=>new ie(`${n.key}${o.key}`,n.value,o.message));const i=t.value.expression||t.value._styleExpression.expression;if(n.expressionContext==="property"&&n.propertyKey==="text-font"&&!i.outputDefined())return[new ie(n.key,n.value,`Invalid data expression for "${n.propertyKey}". Output values must be contained as literals within the expression.`)];if(n.expressionContext==="property"&&n.propertyType==="layout"&&!Gf(i))return[new ie(n.key,n.value,'"feature-state" data expressions are not supported with layout properties.')];if(n.expressionContext==="filter")return AI(i,n);if(n.expressionContext&&n.expressionContext.indexOf("cluster")===0){if(!Xh(i,["zoom","feature-state"]))return[new ie(n.key,n.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(n.expressionContext==="cluster-initial"&&!Zh(i))return[new ie(n.key,n.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function AI(n,t){const i=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(t.valueSpec&&t.valueSpec.expression)for(const c of t.valueSpec.expression.parameters)i.delete(c);if(i.size===0)return[];const o=[];return n instanceof wa&&i.has(n.name)?[new ie(t.key,t.value,`["${n.name}"] expression is not supported in a filter for a ${t.object.type} layer with id: ${t.object.id}`)]:(n.eachChild(c=>{o.push(...AI(c,t))}),o)}function r_(n){const t=n.key,i=n.value,o=n.valueSpec,c=[];return Array.isArray(o.values)?o.values.indexOf(wr(i))===-1&&c.push(new ie(t,i,`expected one of [${o.values.join(", ")}], ${JSON.stringify(i)} found`)):Object.keys(o.values).indexOf(wr(i))===-1&&c.push(new ie(t,i,`expected one of [${Object.keys(o.values).join(", ")}], ${JSON.stringify(i)} found`)),c}function ub(n){if(n===!0||n===!1)return!0;if(!Array.isArray(n)||n.length===0)return!1;switch(n[0]){case"has":return n.length>=2&&n[1]!=="$id"&&n[1]!=="$type";case"in":return n.length>=3&&(typeof n[1]!="string"||Array.isArray(n[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return n.length!==3||Array.isArray(n[1])||Array.isArray(n[2]);case"any":case"all":for(const t of n.slice(1))if(!ub(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}function i_(n,t="fill"){if(n==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};ub(n)||(n=s_(n));const i=n;let o=!0;try{o=function(_){if(!Jh(_))return _;let v=Sr(_);return PI(v),v=CI(v),v}(i)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(i,null,2)}
        `)}const c=vt[`filter_${t}`],u=tc(o,c);let d=null;if(u.result==="error")throw new Error(u.value.map(_=>`${_.key}: ${_.message}`).join(", "));d=(_,v,b)=>u.value.evaluate(_,v,{},b);let p=null,g=null;if(o!==i){const _=tc(i,c);if(_.result==="error")throw new Error(_.value.map(v=>`${v.key}: ${v.message}`).join(", "));p=(v,b,S,E,A)=>_.value.evaluate(v,b,{},S,void 0,void 0,E,A),g=!Zh(_.value.expression)}return{filter:d,dynamicFilter:p||void 0,needGeometry:II(o),needFeature:!!g}}function CI(n){if(!Array.isArray(n))return n;const t=function(i){if(j7.has(i[0])){for(let o=1;o<i.length;o++)if(Jh(i[o]))return!0}return i}(n);return t===!0?t:t.map(i=>CI(i))}function PI(n){let t=!1;const i=[];if(n[0]==="case"){for(let o=1;o<n.length-1;o+=2)t=t||Jh(n[o]),i.push(n[o+1]);i.push(n[n.length-1])}else if(n[0]==="match"){t=t||Jh(n[1]);for(let o=2;o<n.length-1;o+=2)i.push(n[o+1]);i.push(n[n.length-1])}else if(n[0]==="step"){t=t||Jh(n[1]);for(let o=1;o<n.length-1;o+=2)i.push(n[o+1])}t&&(n.length=0,n.push("any",...i));for(let o=1;o<n.length;o++)PI(n[o])}function Jh(n){if(!Array.isArray(n))return!1;if((t=n[0])==="pitch"||t==="distance-from-center")return!0;var t;for(let i=1;i<n.length;i++)if(Jh(n[i]))return!0;return!1}const j7=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function V7(n,t){return n<t?-1:n>t?1:0}function II(n){if(!Array.isArray(n))return!1;if(n[0]==="within"||n[0]==="distance")return!0;for(let t=1;t<n.length;t++)if(II(n[t]))return!0;return!1}function s_(n){if(!n)return!0;const t=n[0];return n.length<=1?t!=="any":t==="=="?hb(n[1],n[2],"=="):t==="!="?o_(hb(n[1],n[2],"==")):t==="<"||t===">"||t==="<="||t===">="?hb(n[1],n[2],t):t==="any"?(i=n.slice(1),["any"].concat(i.map(s_))):t==="all"?["all"].concat(n.slice(1).map(s_)):t==="none"?["all"].concat(n.slice(1).map(s_).map(o_)):t==="in"?kI(n[1],n.slice(2)):t==="!in"?o_(kI(n[1],n.slice(2))):t==="has"?DI(n[1]):t!=="!has"||o_(DI(n[1]));var i}function hb(n,t,i){switch(n){case"$type":return[`filter-type-${i}`,t];case"$id":return[`filter-id-${i}`,t];default:return[`filter-${i}`,n,t]}}function kI(n,t){if(t.length===0)return!1;switch(n){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(i=>typeof i!=typeof t[0])?["filter-in-large",n,["literal",t.sort(V7)]]:["filter-in-small",n,["literal",t]]}}function DI(n){switch(n){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",n]}}function o_(n){return["!",n]}function db(n){return ub(Sr(n.value))?ku(Ar({},n,{expressionContext:"filter",valueSpec:n.styleSpec[`filter_${n.layerType||"fill"}`]})):RI(n)}function RI(n){const t=n.value,i=n.key;if(Fn(t)!=="array")return[new ie(i,t,`array expected, ${Fn(t)} found`)];const o=n.styleSpec;let c,u=[];if(t.length<1)return[new ie(i,t,"filter array must have at least 1 element")];switch(u=u.concat(r_({key:`${i}[0]`,value:t[0],valueSpec:o.filter_operator,style:n.style,styleSpec:n.styleSpec})),wr(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&wr(t[1])==="$type"&&u.push(new ie(i,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&u.push(new ie(i,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(c=Fn(t[1]),c!=="string"&&u.push(new ie(`${i}[1]`,t[1],`string expected, ${c} found`)));for(let d=2;d<t.length;d++)c=Fn(t[d]),wr(t[1])==="$type"?u=u.concat(r_({key:`${i}[${d}]`,value:t[d],valueSpec:o.geometry_type,style:n.style,styleSpec:n.styleSpec})):c!=="string"&&c!=="number"&&c!=="boolean"&&u.push(new ie(`${i}[${d}]`,t[d],`string, number, or boolean expected, ${c} found`));break;case"any":case"all":case"none":for(let d=1;d<t.length;d++)u=u.concat(RI({key:`${i}[${d}]`,value:t[d],style:n.style,styleSpec:n.styleSpec}));break;case"has":case"!has":c=Fn(t[1]),t.length!==2?u.push(new ie(i,t,`filter array for "${t[0]}" operator must have 2 elements`)):c!=="string"&&u.push(new ie(`${i}[1]`,t[1],`string expected, ${c} found`))}return u}function OI(n,t){const i=n.key,o=n.style,c=n.layer,u=n.styleSpec,d=n.value,p=n.objectKey,g=u[`${t}_${n.layerType}`];if(!g)return[];const _=p.match(/^(.*)-transition$/);if(t==="paint"&&_&&g[_[1]]&&g[_[1]].transition)return Ni({key:i,value:d,valueSpec:u.transition,style:o,styleSpec:u});const v=n.valueSpec||g[p];if(!v)return[new Mi(i,d,`unknown property "${p}"`)];let b;if(Fn(d)==="string"&&Iu(v)&&!v.tokens&&(b=/^{([^}]+)}$/.exec(d))){const E=`\`{ "type": "identity", "property": ${b?JSON.stringify(b[1]):'"_"'} }\``;return[new ie(i,d,`"${p}" does not support interpolation syntax
Use an identity property function instead: ${E}.`)]}const S=[];if(n.layerType==="symbol")p!=="text-field"||!o||o.glyphs||o.imports||S.push(new ie(i,d,'use of "text-field" requires a style "glyphs" property')),p==="text-font"&&Qg(Sr(d))&&wr(d.type)==="identity"&&S.push(new ie(i,d,'"text-font" does not support identity functions'));else if(n.layerType==="model"&&t==="paint"&&c&&c.layout&&c.layout.hasOwnProperty("model-id")&&Iu(v)&&(bI(v)||sb(v))){const E=cb(Sr(d),v),A=E.value.expression||E.value._styleExpression.expression;A&&!Xh(A,["measure-light"])&&(p==="model-emissive-strength"&&Zh(A)&&Gf(A)||S.push(new ie(i,d,`${p} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return S.concat(Ni({key:n.key,value:d,valueSpec:v,style:o,styleSpec:u,expressionContext:"property",propertyType:t,propertyKey:p}))}function LI(n){return OI(n,"paint")}function zI(n){return OI(n,"layout")}function NI(n){let t=[];const i=n.value,o=n.key,c=n.style,u=n.styleSpec;i.type||i.ref||t.push(new ie(o,i,'either "type" or "ref" is required'));let d=wr(i.type);const p=wr(i.ref);if(i.id){const g=wr(i.id);for(let _=0;_<n.arrayIndex;_++){const v=c.layers[_];wr(v.id)===g&&t.push(new ie(o,i.id,`duplicate layer id "${i.id}", previously used at line ${v.id.__line__}`))}}if("ref"in i){let g;["type","source","source-layer","filter","layout"].forEach(_=>{_ in i&&t.push(new ie(o,i[_],`"${_}" is prohibited for ref layers`))}),c.layers.forEach(_=>{wr(_.id)===p&&(g=_)}),g?g.ref?t.push(new ie(o,i.ref,"ref cannot reference another ref layer")):d=wr(g.type):typeof p=="string"&&t.push(new ie(o,i.ref,`ref layer "${p}" not found`))}else if(d!=="background"&&d!=="sky"&&d!=="slot")if(i.source){const g=c.sources&&c.sources[i.source],_=g&&wr(g.type);g?_==="vector"&&d==="raster"?t.push(new ie(o,i.source,`layer "${i.id}" requires a raster source`)):_==="raster"&&d!=="raster"?t.push(new ie(o,i.source,`layer "${i.id}" requires a vector source`)):_!=="vector"||i["source-layer"]?_==="raster-dem"&&d!=="hillshade"?t.push(new ie(o,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):d!=="line"||!i.paint||!i.paint["line-gradient"]&&!i.paint["line-trim-offset"]||_==="geojson"&&g.lineMetrics||t.push(new ie(o,i,`layer "${i.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new ie(o,i,`layer "${i.id}" must specify a "source-layer"`)):t.push(new ie(o,i.source,`source "${i.source}" not found`))}else t.push(new ie(o,i,'missing required property "source"'));return t=t.concat(So({key:o,value:i,valueSpec:u.layer,style:n.style,styleSpec:n.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Ni({key:`${o}.type`,value:i.type,valueSpec:u.layer.type,style:n.style,styleSpec:n.styleSpec,object:i,objectKey:"type"}),filter:g=>db(Ar({layerType:d},g)),layout:g=>So({layer:i,key:g.key,value:g.value,valueSpec:{},style:g.style,styleSpec:g.styleSpec,objectElementValidators:{"*":_=>zI(Ar({layerType:d},_))}}),paint:g=>So({layer:i,key:g.key,value:g.value,valueSpec:{},style:g.style,styleSpec:g.styleSpec,objectElementValidators:{"*":_=>LI(Ar({layerType:d,layer:i},_))}})}})),t}function Qh(n){const t=n.value,i=n.key,o=Fn(t);return o!=="string"?[new ie(i,t,`string expected, ${o} found`)]:[]}const FI={promoteId:function({key:n,value:t}){if(Fn(t)==="string")return Qh({key:n,value:t});{const i=[];for(const o in t)i.push(...Qh({key:`${n}.${o}`,value:t[o]}));return i}}};function BI(n){const t=n.value,i=n.key,o=n.styleSpec,c=n.style;if(!t.type)return[new ie(i,t,'"type" is required')];const u=wr(t.type);let d=[];switch(["vector","raster","raster-dem"].includes(u)&&(t.url||t.tiles||d.push(new ie(i,t,'Either "url" or "tiles" is required.'))),u){case"vector":case"raster":case"raster-dem":return d=d.concat(So({key:i,value:t,valueSpec:o[`source_${u.replace("-","_")}`],style:n.style,styleSpec:o,objectElementValidators:FI})),d;case"geojson":if(d=So({key:i,value:t,valueSpec:o.source_geojson,style:c,styleSpec:o,objectElementValidators:FI}),t.cluster)for(const p in t.clusterProperties){const[g,_]=t.clusterProperties[p],v=typeof g=="string"?[g,["accumulated"],["get",p]]:g;d.push(...ku({key:`${i}.${p}.map`,value:_,expressionContext:"cluster-map"})),d.push(...ku({key:`${i}.${p}.reduce`,value:v,expressionContext:"cluster-reduce"}))}return d;case"video":return So({key:i,value:t,valueSpec:o.source_video,style:c,styleSpec:o});case"image":return So({key:i,value:t,valueSpec:o.source_image,style:c,styleSpec:o});case"canvas":return[new ie(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return r_({key:`${i}.type`,value:t.type,valueSpec:{values:U7(o)},style:c,styleSpec:o})}}function U7(n){return n.source.reduce((t,i)=>{const o=n[i];return o.type.type==="enum"&&(t=t.concat(Object.keys(o.type.values))),t},[])}function jI(n){const t=n.value;let i=[];if(!t)return i;const o=Fn(t);return o!=="string"?(i=i.concat([new ie(n.key,t,`string expected, "${o}" found`)]),i):(function(c){const u=c.indexOf("://")===-1;try{return new URL(c,u?"http://example.com":void 0),!0}catch{return!1}}(t)||(i=i.concat([new ie(n.key,t,`invalid url "${t}"`)])),i)}function VI(n){const t=n.value,i=n.styleSpec,o=i.light,c=n.style;let u=[];const d=Fn(t);if(t===void 0)return u;if(d!=="object")return u=u.concat([new ie("light",t,`object expected, ${d} found`)]),u;for(const p in t){const g=p.match(/^(.*)-transition$/);u=u.concat(g&&o[g[1]]&&o[g[1]].transition?Ni({key:p,value:t[p],valueSpec:i.transition,style:c,styleSpec:i}):o[p]?Ni({key:p,value:t[p],valueSpec:o[p],style:c,styleSpec:i}):[new ie(p,t[p],`unknown property "${p}"`)])}return u}function UI(n){const t=n.value;let i=[];if(!t)return i;const o=Fn(t);if(o!=="object")return i=i.concat([new ie("light-3d",t,`object expected, ${o} found`)]),i;const c=n.styleSpec,u=c["light-3d"],d=n.key,p=n.style,g=n.style.lights;for(const b of["type","id"])if(!(b in t))return i=i.concat([new ie("light-3d",t,`missing property ${b} on light`)]),i;if(t.type&&g)for(let b=0;b<n.arrayIndex;b++){const S=wr(t.type),E=g[b];wr(E.type)===S&&i.push(new ie(d,t.id,`duplicate light type "${t.type}", previously defined at line ${E.id.__line__}`))}const _=`properties_light_${t.type}`;if(!(_ in c))return i=i.concat([new ie("light-3d",t,`Invalid light type ${t.type}`)]),i;const v=c[_];for(const b in t)if(b==="properties"){const S=t[b],E=Fn(S);if(E!=="object")return i=i.concat([new ie("properties",S,`object expected, ${E} found`)]),i;for(const A in S)i=i.concat(v[A]?Ni({key:A,value:S[A],valueSpec:v[A],style:p,styleSpec:c}):[new Mi(n.key,S[A],`unknown property "${A}"`)])}else{const S=b.match(/^(.*)-transition$/);i=i.concat(S&&u[S[1]]&&u[S[1]].transition?Ni({key:b,value:t[b],valueSpec:c.transition,style:p,styleSpec:c}):u[b]?Ni({key:b,value:t[b],valueSpec:u[b],style:p,styleSpec:c}):[new Mi(b,t[b],`unknown property "${b}"`)])}return i}function $I(n){const t=n.value,i=n.key,o=n.style,c=n.styleSpec,u=c.terrain;let d=[];const p=Fn(t);if(t===void 0||p==="null")return d;if(p!=="object")return d=d.concat([new ie("terrain",t,`object expected, ${p} found`)]),d;for(const g in t){const _=g.match(/^(.*)-transition$/);d=d.concat(_&&u[_[1]]&&u[_[1]].transition?Ni({key:g,value:t[g],valueSpec:c.transition,style:o,styleSpec:c}):u[g]?Ni({key:g,value:t[g],valueSpec:u[g],style:o,styleSpec:c}):[new Mi(g,t[g],`unknown property "${g}"`)])}if(t.source){const g=o.sources&&o.sources[t.source],_=g&&wr(g.type);g?_!=="raster-dem"&&d.push(new ie(i,t.source,`terrain cannot be used with a source of type ${String(_)}, it only be used with a "raster-dem" source type`)):d.push(new ie(i,t.source,`source "${t.source}" not found`))}else d.push(new ie(i,t,'terrain is missing required property "source"'));return d}function GI(n){const t=n.value,i=n.style,o=n.styleSpec,c=o.fog;let u=[];const d=Fn(t);if(t===void 0)return u;if(d!=="object")return u=u.concat([new ie("fog",t,`object expected, ${d} found`)]),u;for(const p in t){const g=p.match(/^(.*)-transition$/);u=u.concat(g&&c[g[1]]&&c[g[1]].transition?Ni({key:p,value:t[p],valueSpec:o.transition,style:i,styleSpec:o}):c[p]?Ni({key:p,value:t[p],valueSpec:c[p],style:i,styleSpec:o}):[new Mi(p,t[p],`unknown property "${p}"`)])}return u}const WI={"*":()=>[],array:TI,boolean:function(n){const t=n.value,i=n.key,o=Fn(t);return o!=="boolean"?[new ie(i,t,`boolean expected, ${o} found`)]:[]},number:EI,color:function(n){const t=n.key,i=n.value,o=Fn(i);return o!=="string"?[new ie(t,i,`color expected, ${o} found`)]:vs(i)===null?[new ie(t,i,`color expected, "${i}" found`)]:[]},enum:r_,filter:db,function:MI,layer:NI,object:So,source:BI,model:jI,light:VI,"light-3d":UI,terrain:$I,fog:GI,string:Qh,formatted:function(n){return Qh(n).length===0?[]:ku(n)},resolvedImage:function(n){return Qh(n).length===0?[]:ku(n)},projection:function(n){const t=n.value,i=n.styleSpec,o=i.projection,c=n.style;let u=[];const d=Fn(t);if(d==="object")for(const p in t)u=u.concat(Ni({key:p,value:t[p],valueSpec:o[p],style:c,styleSpec:i}));else d!=="string"&&(u=u.concat([new ie("projection",t,`object or string expected, ${d} found`)]));return u},import:function(n){const{value:t,styleSpec:i}=n,{data:o,...c}=t;Object.defineProperty(c,"__line__",{value:t.__line__,enumerable:!1});let u=So(Ar({},n,{value:c,valueSpec:i.import}));return wr(c.id)===""&&u.push(new ie(`${n.key}.id`,c,"import id can't be an empty string")),o&&(u=u.concat(HI(o,i,{key:`${n.key}.data`}))),u}};function Ni(n,t=!1){const i=n.value,o=n.valueSpec,c=n.styleSpec;if(o.expression&&Qg(wr(i)))return MI(n);if(o.expression&&t_(Sr(i)))return ku(n);if(o.type&&WI[o.type]){const u=WI[o.type](n);return t===!0&&u.length>0&&Fn(n.value)==="array"?ku(n):u}return So(Ar({},n,{valueSpec:o.type?c[o.type]:o}))}function $7(n){const t=n.value,i=n.key,o=Qh(n);return o.length||(t.indexOf("{fontstack}")===-1&&o.push(new ie(i,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&o.push(new ie(i,t,'"glyphs" url must include a "{range}" token'))),o}function HI(n,t=vt,i={}){return Ni({key:i.key||"",value:n,valueSpec:t.$root,styleSpec:t,style:n,objectElementValidators:{glyphs:$7,"*":()=>[]}})}function td(n,t=vt){return qo(HI(n,t))}const G7=n=>qo(BI(n)),W7=n=>qo(VI(n)),H7=n=>qo(UI(n)),q7=n=>qo($I(n)),Z7=n=>qo(GI(n)),X7=n=>qo(NI(n)),fb=n=>qo(db(n)),Y7=n=>qo(LI(n)),K7=n=>qo(zI(n)),J7=n=>qo(jI(n));function qo(n){return n.slice().sort((t,i)=>t.line&&i.line?t.line-i.line:0)}function a_(n,t){let i=!1;if(t&&t.length)for(const o of t)o instanceof Mi?_t(o.message):(n.fire(new xe(new Error(o.message))),i=!0);return i}var Q7=Ta,nc=3;function Ta(n,t,i){var o=this.cells=[];if(n instanceof ArrayBuffer){this.arrayBuffer=n;var c=new Int32Array(this.arrayBuffer);n=c[0],this.d=(t=c[1])+2*(i=c[2]);for(var u=0;u<this.d*this.d;u++){var d=c[nc+u],p=c[nc+u+1];o.push(d===p?null:c.subarray(d,p))}var g=c[nc+o.length+1];this.keys=c.subarray(c[nc+o.length],g),this.bboxes=c.subarray(g),this.insert=this._insertReadonly}else{this.d=t+2*i;for(var _=0;_<this.d*this.d;_++)o.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=n,this.padding=i,this.scale=t/n,this.uid=0;var v=i/t*n;this.min=-v,this.max=n+v}Ta.prototype.insert=function(n,t,i,o,c){this._forEachCell(t,i,o,c,this._insertCell,this.uid++),this.keys.push(n),this.bboxes.push(t),this.bboxes.push(i),this.bboxes.push(o),this.bboxes.push(c)},Ta.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Ta.prototype._insertCell=function(n,t,i,o,c,u){this.cells[c].push(u)},Ta.prototype.query=function(n,t,i,o,c){var u=this.min,d=this.max;if(n<=u&&t<=u&&d<=i&&d<=o&&!c)return Array.prototype.slice.call(this.keys);var p=[];return this._forEachCell(n,t,i,o,this._queryCell,p,{},c),p},Ta.prototype._queryCell=function(n,t,i,o,c,u,d,p){var g=this.cells[c];if(g!==null)for(var _=this.keys,v=this.bboxes,b=0;b<g.length;b++){var S=g[b];if(d[S]===void 0){var E=4*S;(p?p(v[E+0],v[E+1],v[E+2],v[E+3]):n<=v[E+2]&&t<=v[E+3]&&i>=v[E+0]&&o>=v[E+1])?(d[S]=!0,u.push(_[S])):d[S]=!1}}},Ta.prototype._forEachCell=function(n,t,i,o,c,u,d,p){for(var g=this._convertToCellCoord(n),_=this._convertToCellCoord(t),v=this._convertToCellCoord(i),b=this._convertToCellCoord(o),S=g;S<=v;S++)for(var E=_;E<=b;E++){var A=this.d*E+S;if((!p||p(this._convertFromCellCoord(S),this._convertFromCellCoord(E),this._convertFromCellCoord(S+1),this._convertFromCellCoord(E+1)))&&c.call(this,n,t,i,o,A,u,d,p))return}},Ta.prototype._convertFromCellCoord=function(n){return(n-this.padding)/this.scale},Ta.prototype._convertToCellCoord=function(n){return Math.max(0,Math.min(this.d-1,Math.floor(n*this.scale)+this.padding))},Ta.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var n=this.cells,t=nc+this.cells.length+1+1,i=0,o=0;o<this.cells.length;o++)i+=this.cells[o].length;var c=new Int32Array(t+i+this.keys.length+this.bboxes.length);c[0]=this.extent,c[1]=this.n,c[2]=this.padding;for(var u=t,d=0;d<n.length;d++){var p=n[d];c[nc+d]=u,c.set(p,u),u+=p.length}return c[nc+n.length]=u,c.set(this.keys,u),c[nc+n.length+1]=u+=this.keys.length,c.set(this.bboxes,u),u+=this.bboxes.length,c.buffer};var ed=H(Q7);const l_={};function Se(n,t,i={}){Object.defineProperty(n,"_classRegistryKey",{value:t,writeable:!1}),l_[t]={klass:n,omit:i.omit||[]}}Se(Object,"Object"),ed.serialize=function(n,t){const i=n.toArrayBuffer();return t&&t.add(i),{buffer:i}},ed.deserialize=function(n){return new ed(n.buffer)},Object.defineProperty(ed,"name",{value:"Grid"}),Se(ed,"Grid"),Se(tn,"Color"),Se(Error,"Error"),Se(Vt,"AJAXError"),Se(wo,"ResolvedImage"),Se(e_,"StylePropertyFunction"),Se(ab,"StyleExpression",{omit:["_evaluator"]}),Se(ec,"ZoomDependentExpression"),Se(lb,"ZoomConstantExpression"),Se(wa,"CompoundExpression",{omit:["_evaluate"]});for(const n in qf)l_[qf[n]._classRegistryKey]||Se(qf[n],`Expression${n}`);function qI(n){return n&&typeof ArrayBuffer<"u"&&(n instanceof ArrayBuffer||n.constructor&&n.constructor.name==="ArrayBuffer")}function ZI(n){return w.ImageBitmap&&n instanceof w.ImageBitmap}function nd(n,t){if(n==null||typeof n=="boolean"||typeof n=="number"||typeof n=="string"||n instanceof Boolean||n instanceof Number||n instanceof String||n instanceof Date||n instanceof RegExp)return n;if(qI(n)||ZI(n))return t&&t.add(n),n;if(ArrayBuffer.isView(n)){const i=n;return t&&t.add(i.buffer),i}if(n instanceof w.ImageData)return t&&t.add(n.data.buffer),n;if(Array.isArray(n)){const i=[];for(const o of n)i.push(nd(o,t));return i}if(n instanceof Map){const i={$name:"Map"};for(const[o,c]of n.entries())i[o]=nd(c);return i}if(typeof n=="object"){const i=n.constructor,o=i._classRegistryKey;if(!o)throw new Error(`can't serialize object of unregistered class ${o}`);const c=i.serialize?i.serialize(n,t):{};if(!i.serialize){for(const u in n)n.hasOwnProperty(u)&&(l_[o].omit.indexOf(u)>=0||(c[u]=nd(n[u],t)));n instanceof Error&&(c.message=n.message)}if(c.$name)throw new Error("$name property is reserved for worker serialization logic.");return o!=="Object"&&(c.$name=o),c}throw new Error("can't serialize object of type "+typeof n)}function rd(n){if(n==null||typeof n=="boolean"||typeof n=="number"||typeof n=="string"||n instanceof Boolean||n instanceof Number||n instanceof String||n instanceof Date||n instanceof RegExp||qI(n)||ZI(n)||ArrayBuffer.isView(n)||n instanceof w.ImageData)return n;if(Array.isArray(n))return n.map(rd);if(typeof n=="object"){const t=n.$name||"Object";if(t==="Map"){const c=new Map;for(const u of Object.keys(n))u!=="$name"&&c.set(u,rd(n[u]));return c}const{klass:i}=l_[t];if(!i)throw new Error(`can't deserialize unregistered class ${t}`);if(i.deserialize)return i.deserialize(n);const o=Object.create(i.prototype);for(const c of Object.keys(n))c!=="$name"&&(o[c]=rd(n[c]));return o}throw new Error("can't deserialize object of type "+typeof n)}const Ce={"Latin-1 Supplement":n=>n>=128&&n<=255,Arabic:n=>n>=1536&&n<=1791,"Arabic Supplement":n=>n>=1872&&n<=1919,"Arabic Extended-A":n=>n>=2208&&n<=2303,"Hangul Jamo":n=>n>=4352&&n<=4607,"Unified Canadian Aboriginal Syllabics":n=>n>=5120&&n<=5759,Khmer:n=>n>=6016&&n<=6143,"Unified Canadian Aboriginal Syllabics Extended":n=>n>=6320&&n<=6399,"General Punctuation":n=>n>=8192&&n<=8303,"Letterlike Symbols":n=>n>=8448&&n<=8527,"Number Forms":n=>n>=8528&&n<=8591,"Miscellaneous Technical":n=>n>=8960&&n<=9215,"Control Pictures":n=>n>=9216&&n<=9279,"Optical Character Recognition":n=>n>=9280&&n<=9311,"Enclosed Alphanumerics":n=>n>=9312&&n<=9471,"Geometric Shapes":n=>n>=9632&&n<=9727,"Miscellaneous Symbols":n=>n>=9728&&n<=9983,"Miscellaneous Symbols and Arrows":n=>n>=11008&&n<=11263,"CJK Radicals Supplement":n=>n>=11904&&n<=12031,"Kangxi Radicals":n=>n>=12032&&n<=12255,"Ideographic Description Characters":n=>n>=12272&&n<=12287,"CJK Symbols and Punctuation":n=>n>=12288&&n<=12351,Hiragana:n=>n>=12352&&n<=12447,Katakana:n=>n>=12448&&n<=12543,Bopomofo:n=>n>=12544&&n<=12591,"Hangul Compatibility Jamo":n=>n>=12592&&n<=12687,Kanbun:n=>n>=12688&&n<=12703,"Bopomofo Extended":n=>n>=12704&&n<=12735,"CJK Strokes":n=>n>=12736&&n<=12783,"Katakana Phonetic Extensions":n=>n>=12784&&n<=12799,"Enclosed CJK Letters and Months":n=>n>=12800&&n<=13055,"CJK Compatibility":n=>n>=13056&&n<=13311,"CJK Unified Ideographs Extension A":n=>n>=13312&&n<=19903,"Yijing Hexagram Symbols":n=>n>=19904&&n<=19967,"CJK Unified Ideographs":n=>n>=19968&&n<=40959,"Yi Syllables":n=>n>=40960&&n<=42127,"Yi Radicals":n=>n>=42128&&n<=42191,"Hangul Jamo Extended-A":n=>n>=43360&&n<=43391,"Hangul Syllables":n=>n>=44032&&n<=55215,"Hangul Jamo Extended-B":n=>n>=55216&&n<=55295,"Private Use Area":n=>n>=57344&&n<=63743,"CJK Compatibility Ideographs":n=>n>=63744&&n<=64255,"Arabic Presentation Forms-A":n=>n>=64336&&n<=65023,"Vertical Forms":n=>n>=65040&&n<=65055,"CJK Compatibility Forms":n=>n>=65072&&n<=65103,"Small Form Variants":n=>n>=65104&&n<=65135,"Arabic Presentation Forms-B":n=>n>=65136&&n<=65279,"Halfwidth and Fullwidth Forms":n=>n>=65280&&n<=65519,"CJK Unified Ideographs Extension B":n=>n>=131072&&n<=173791};function pb(n){for(const t of n)if(mb(t.charCodeAt(0)))return!0;return!1}function t9(n){for(const t of n)if(!e9(t.charCodeAt(0)))return!1;return!0}function e9(n){return!(Ce.Arabic(n)||Ce["Arabic Supplement"](n)||Ce["Arabic Extended-A"](n)||Ce["Arabic Presentation Forms-A"](n)||Ce["Arabic Presentation Forms-B"](n))}function mb(n){return!(n!==746&&n!==747&&(n<4352||!(Ce["Bopomofo Extended"](n)||Ce.Bopomofo(n)||Ce["CJK Compatibility Forms"](n)&&!(n>=65097&&n<=65103)||Ce["CJK Compatibility Ideographs"](n)||Ce["CJK Compatibility"](n)||Ce["CJK Radicals Supplement"](n)||Ce["CJK Strokes"](n)||!(!Ce["CJK Symbols and Punctuation"](n)||n>=12296&&n<=12305||n>=12308&&n<=12319||n===12336)||Ce["CJK Unified Ideographs Extension A"](n)||Ce["CJK Unified Ideographs"](n)||Ce["Enclosed CJK Letters and Months"](n)||Ce["Hangul Compatibility Jamo"](n)||Ce["Hangul Jamo Extended-A"](n)||Ce["Hangul Jamo Extended-B"](n)||Ce["Hangul Jamo"](n)||Ce["Hangul Syllables"](n)||Ce.Hiragana(n)||Ce["Ideographic Description Characters"](n)||Ce.Kanbun(n)||Ce["Kangxi Radicals"](n)||Ce["Katakana Phonetic Extensions"](n)||Ce.Katakana(n)&&n!==12540||!(!Ce["Halfwidth and Fullwidth Forms"](n)||n===65288||n===65289||n===65293||n>=65306&&n<=65310||n===65339||n===65341||n===65343||n>=65371&&n<=65503||n===65507||n>=65512&&n<=65519)||!(!Ce["Small Form Variants"](n)||n>=65112&&n<=65118||n>=65123&&n<=65126)||Ce["Unified Canadian Aboriginal Syllabics"](n)||Ce["Unified Canadian Aboriginal Syllabics Extended"](n)||Ce["Vertical Forms"](n)||Ce["Yijing Hexagram Symbols"](n)||Ce["Yi Syllables"](n)||Ce["Yi Radicals"](n))))}function XI(n){return!(mb(n)||function(t){return!!(Ce["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||Ce["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||Ce["Letterlike Symbols"](t)||Ce["Number Forms"](t)||Ce["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||Ce["Control Pictures"](t)&&t!==9251||Ce["Optical Character Recognition"](t)||Ce["Enclosed Alphanumerics"](t)||Ce["Geometric Shapes"](t)||Ce["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||Ce["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Ce["CJK Symbols and Punctuation"](t)||Ce.Katakana(t)||Ce["Private Use Area"](t)||Ce["CJK Compatibility Forms"](t)||Ce["Small Form Variants"](t)||Ce["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(n))}function YI(n){return n>=1424&&n<=2303||Ce["Arabic Presentation Forms-A"](n)||Ce["Arabic Presentation Forms-B"](n)}function n9(n,t){return!(!t&&YI(n)||n>=2304&&n<=3583||n>=3840&&n<=4255||Ce.Khmer(n))}function r9(n){for(const t of n)if(YI(t.charCodeAt(0)))return!0;return!1}const gb="deferred",_b="loading",yb="loaded";let vb=null,ks="unavailable",rc=null;const KI=function(n){n&&typeof n=="string"&&n.indexOf("NetworkError")>-1&&(ks="error"),vb&&vb(n)};function xb(){bb.fire(new Bt("pluginStateChange",{pluginStatus:ks,pluginURL:rc}))}const bb=new Mn,wb=function(){return ks},JI=function(){if(ks!==gb||!rc)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");ks=_b,xb(),rc&&oe({url:rc},n=>{n?KI(n):(ks=yb,xb())})},To={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>ks===yb||To.applyArabicShaping!=null,isLoading:()=>ks===_b,setState(n){ks=n.pluginStatus,rc=n.pluginURL},isParsed:()=>To.applyArabicShaping!=null&&To.processBidirectionalText!=null&&To.processStyledBidirectionalText!=null,getPluginURL:()=>rc};class pr{constructor(t,i){this.zoom=t,i?(this.now=i.now,this.fadeDuration=i.fadeDuration,this.transition=i.transition,this.pitch=i.pitch,this.brightness=i.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(t){return function(i,o){for(const c of i)if(!n9(c.charCodeAt(0),o))return!1;return!0}(t,To.isLoaded())}}class c_{constructor(t,i,o){this.property=t,this.value=i,this.expression=function(c,u,d){if(Qg(c))return new e_(c,u);if(t_(c)||Array.isArray(c)&&c.length>0){const p=cb(c,u,d);if(p.result==="error")throw new Error(p.value.map(g=>`${g.key}: ${g.message}`).join(", "));return p.value}{let p=c;return typeof c=="string"&&u.type==="color"&&(p=tn.parse(c)),{kind:"constant",isConfigDependent:!1,evaluate:()=>p}}}(i===void 0?t.specification.default:i,t.specification,o)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,i,o){return this.property.possiblyEvaluate(this,t,i,o)}}class Sb{constructor(t,i){this.property=t,this.value=new c_(t,void 0,i)}transitioned(t,i){return new QI(this.property,this.value,i,Ct({},t.transition,this.transition),t.now)}untransitioned(){return new QI(this.property,this.value,null,{},0)}}class Xf{constructor(t,i){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues),this._options=i,this.isConfigDependent=!1}getValue(t){return ot(this._values[t].value.value)}setValue(t,i){this._values.hasOwnProperty(t)||(this._values[t]=new Sb(this._values[t].property,this._options)),this._values[t].value=new c_(this._values[t].property,i===null?void 0:ot(i),this._options),this.isConfigDependent=this.isConfigDependent||this._values[t].value.expression.isConfigDependent}setTransitionOrValue(t,i){i&&(this._options=i);const o=this._properties.properties;if(t)for(const c in t){const u=t[c];if(Yn(c,"-transition")){const d=c.slice(0,-11);o[d]&&this.setTransition(d,u)}else o[c]&&this.setValue(c,u)}}getTransition(t){return ot(this._values[t].transition)}setTransition(t,i){this._values.hasOwnProperty(t)||(this._values[t]=new Sb(this._values[t].property)),this._values[t].transition=ot(i)||void 0}serialize(){const t={};for(const i of Object.keys(this._values)){const o=this.getValue(i);o!==void 0&&(t[i]=o);const c=this.getTransition(i);c!==void 0&&(t[`${i}-transition`]=c)}return t}transitioned(t,i){const o=new tk(this._properties);for(const c of Object.keys(this._values))o._values[c]=this._values[c].transitioned(t,i._values[c]);return o}untransitioned(){const t=new tk(this._properties);for(const i of Object.keys(this._values))t._values[i]=this._values[i].untransitioned();return t}}class QI{constructor(t,i,o,c,u){const d=c.delay||0,p=c.duration||0;u=u||0,this.property=t,this.value=i,this.begin=u+d,this.end=this.begin+p,t.specification.transition&&(c.delay||c.duration)&&(this.prior=o)}possiblyEvaluate(t,i,o){const c=t.now||0,u=this.value.possiblyEvaluate(t,i,o),d=this.prior;if(d){if(c>this.end)return this.prior=null,u;if(this.value.isDataDriven())return this.prior=null,u;if(c<this.begin)return d.possiblyEvaluate(t,i,o);{const p=(c-this.begin)/(this.end-this.begin);return this.property.interpolate(d.possiblyEvaluate(t,i,o),u,Zt(p))}}return u}}class tk{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,i,o){const c=new Yf(this._properties);for(const u of Object.keys(this._values))c._values[u]=this._values[u].possiblyEvaluate(t,i,o);return c}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class i9{constructor(t,i){this._properties=t,this._values=Object.create(t.defaultPropertyValues),this._options=i,this.isConfigDependent=!1}getValue(t){return ot(this._values[t].value)}setValue(t,i){this._values[t]=new c_(this._values[t].property,i===null?void 0:ot(i),this._options),this.isConfigDependent=this.isConfigDependent||this._values[t].expression.isConfigDependent}serialize(){const t={};for(const i of Object.keys(this._values)){const o=this.getValue(i);o!==void 0&&(t[i]=o)}return t}possiblyEvaluate(t,i,o){const c=new Yf(this._properties);for(const u of Object.keys(this._values))c._values[u]=this._values[u].possiblyEvaluate(t,i,o);return c}}class id{constructor(t,i,o){this.property=t,this.value=i,this.parameters=o}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,i,o,c){return this.property.evaluate(this.value,this.parameters,t,i,o,c)}}class Yf{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class te{constructor(t){this.specification=t}possiblyEvaluate(t,i){return t.expression.evaluate(i)}interpolate(t,i,o){const c=Xg[this.specification.type];return c?c(t,i,o):t}}class ze{constructor(t,i){this.specification=t,this.overrides=i}possiblyEvaluate(t,i,o,c){return new id(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(i,null,{},o,c)}:t.expression,i)}interpolate(t,i,o){if(t.value.kind!=="constant"||i.value.kind!=="constant")return t;if(t.value.value===void 0||i.value.value===void 0)return new id(this,{kind:"constant",value:void 0},t.parameters);const c=Xg[this.specification.type];return c?new id(this,{kind:"constant",value:c(t.value.value,i.value.value,o)},t.parameters):t}evaluate(t,i,o,c,u,d){return t.kind==="constant"?t.value:t.evaluate(i,o,c,u,d)}}class Kf{constructor(t){this.specification=t}possiblyEvaluate(t,i,o,c){return!!t.expression.evaluate(i,null,{},o,c)}interpolate(){return!1}}class Tr{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const i=new pr(0,{});for(const o in t){const c=t[o];c.specification.overridable&&this.overridableProperties.push(o);const u=this.defaultPropertyValues[o]=new c_(c,void 0),d=this.defaultTransitionablePropertyValues[o]=new Sb(c);this.defaultTransitioningPropertyValues[o]=d.untransitioned(),this.defaultPossiblyEvaluatedValues[o]=u.possiblyEvaluate(i)}}}Se(ze,"DataDrivenProperty"),Se(te,"DataConstantProperty"),Se(Kf,"ColorRampProperty");const u_="";function ek(n){return n.indexOf(u_)>=0}function Xi(n,t){return t?`${n}${u_}${t}`:n}function h_(n){const t=n.indexOf(u_);return t>=0?n.slice(0,t):n}const nk="-transition";class Qs extends Mn{constructor(t,i,o){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.isConfigDependent=!1,t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&t.type!=="sky"&&t.type!=="slot"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),this.options=o,t.slot&&(this.slot=t.slot),i.layout&&(this._unevaluatedLayout=new i9(i.layout,o),this.isConfigDependent=this.isConfigDependent||this._unevaluatedLayout.isConfigDependent),i.paint)){this._transitionablePaint=new Xf(i.paint,o);for(const c in t.paint)this.setPaintProperty(c,t.paint[c],{validate:!1});for(const c in t.layout)this.setLayoutProperty(c,t.layout[c],{validate:!1});this.isConfigDependent=this.isConfigDependent||this._transitionablePaint.isConfigDependent,this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Yf(i.paint)}}setScope(t){this.scope=t,this.fqid=Xi(this.id,t)}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,i,o={}){if(i!=null&&this._validate(K7,`layers.${this.id}.layout.${t}`,t,i,o))return;if(this.type==="custom"&&t==="visibility")return void(this.visibility=i);const c=this._unevaluatedLayout;c._properties.properties[t]&&(c.setValue(t,i),this.isConfigDependent=this.isConfigDependent||c.isConfigDependent,t==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0})}getPaintProperty(t){return Yn(t,nk)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,i,o={}){if(i!=null&&this._validate(Y7,`layers.${this.id}.paint.${t}`,t,i,o))return!1;const c=this._transitionablePaint,u=c._properties.properties;if(Yn(t,nk)){const S=t.slice(0,-11);return u[S]&&c.setTransition(S,i||void 0),!1}if(!u[t])return!1;const d=c._values[t],p=d.value.isDataDriven(),g=d.value;c.setValue(t,i),this.isConfigDependent=this.isConfigDependent||c.isConfigDependent,this._handleSpecialPaintPropertyUpdate(t);const _=c._values[t].value,v=_.isDataDriven(),b=Yn(t,"pattern")||t==="line-dasharray";return v||p||b||this._handleOverridablePaintPropertyUpdate(t,g,_)}_handleSpecialPaintPropertyUpdate(t){}getProgramIds(){return null}getDefaultProgramParams(t,i){return null}_handleOverridablePaintPropertyUpdate(t,i,o){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,i){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,i)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,i)}serialize(){return Qt({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(t,i)=>!(t===void 0||i==="layout"&&!Object.keys(t).length||i==="paint"&&!Object.keys(t).length))}_validate(t,i,o,c,u={}){return(!u||u.validate!==!1)&&a_(this,t.call(td,{key:i,layerType:this.type,objectKey:o,value:c,styleSpec:vt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}resize(){}isStateDependent(){for(const t in this.paint._values){const i=this.paint.get(t);if(i instanceof id&&Iu(i.property.specification)&&(i.value.kind==="source"||i.value.kind==="composite")&&i.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=i_(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(){this._stats&&(this._stats.numRenderedVerticesInShadowPass=0,this._stats.numRenderedVerticesInTransparentPass=0)}}class s9{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(t,i){this._updatedSourceCaches[t]=i,this.setDirty()}discardSourceCacheUpdate(t){delete this._updatedSourceCaches[t]}updateLayer(t){const i=t.scope;this._updatedLayers[i]=this._updatedLayers[i]||new Set,this._updatedLayers[i].add(t.id),this.setDirty()}removeLayer(t){const i=t.scope;this._removedLayers[i]=this._removedLayers[i]||{},this._updatedLayers[i]=this._updatedLayers[i]||new Set,this._removedLayers[i][t.id]=t,this._updatedLayers[i].delete(t.id),this._updatedPaintProps.delete(t.fqid),this.setDirty()}getRemovedLayer(t){return this._removedLayers[t.scope]?this._removedLayers[t.scope][t.id]:null}discardLayerRemoval(t){this._removedLayers[t.scope]&&delete this._removedLayers[t.scope][t.id]}getLayerUpdatesByScope(){const t={};for(const i in this._updatedLayers)t[i]=t[i]||{},t[i].updatedIds=Array.from(this._updatedLayers[i].values());for(const i in this._removedLayers)t[i]=t[i]||{},t[i].removedIds=Object.keys(this._removedLayers[i]);return t}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(t){this._updatedPaintProps.add(t.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(t){this._updatedImages.add(t),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}const o9={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class d_{constructor(t,i){this._structArray=t,this._pos1=i*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class mr{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,i){return t._trim(),i&&(t.isTransferred=!0,i.add(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const i=Object.create(this.prototype);return i.arrayBuffer=t.arrayBuffer,i.length=t.length,i.capacity=t.arrayBuffer.byteLength/i.bytesPerElement,i._refreshViews(),i}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const i=this.uint8;this._refreshViews(),i&&this.uint8.set(i)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Rn(n,t=1){let i=0,o=0;return{members:n.map(c=>{const u=o9[c.type].BYTES_PER_ELEMENT,d=i=rk(i,Math.max(t,u)),p=c.components||1;return o=Math.max(o,u),i+=u*p,{name:c.name,type:c.type,components:p,offset:d}}),size:rk(i,Math.max(o,t)),alignment:t}}function rk(n,t){return Math.ceil(n/t)*t}class Ds extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i){const o=this.length;return this.resize(o+1),this.emplace(o,t,i)}emplace(t,i,o){const c=2*t;return this.int16[c+0]=i,this.int16[c+1]=o,t}}Ds.prototype.bytesPerElement=4,Se(Ds,"StructArrayLayout2i4");class f_ extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,o){const c=this.length;return this.resize(c+1),this.emplace(c,t,i,o)}emplace(t,i,o,c){const u=3*t;return this.int16[u+0]=i,this.int16[u+1]=o,this.int16[u+2]=c,t}}f_.prototype.bytesPerElement=6,Se(f_,"StructArrayLayout3i6");class Du extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,o,c){const u=this.length;return this.resize(u+1),this.emplace(u,t,i,o,c)}emplace(t,i,o,c,u){const d=4*t;return this.int16[d+0]=i,this.int16[d+1]=o,this.int16[d+2]=c,this.int16[d+3]=u,t}}Du.prototype.bytesPerElement=8,Se(Du,"StructArrayLayout4i8");class Tb extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,o,c,u){const d=this.length;return this.resize(d+1),this.emplace(d,t,i,o,c,u)}emplace(t,i,o,c,u,d){const p=5*t;return this.int16[p+0]=i,this.int16[p+1]=o,this.int16[p+2]=c,this.int16[p+3]=u,this.int16[p+4]=d,t}}Tb.prototype.bytesPerElement=10,Se(Tb,"StructArrayLayout5i10");class Eb extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,o,c,u,d,p){const g=this.length;return this.resize(g+1),this.emplace(g,t,i,o,c,u,d,p)}emplace(t,i,o,c,u,d,p,g){const _=6*t,v=12*t,b=3*t;return this.int16[_+0]=i,this.int16[_+1]=o,this.uint8[v+4]=c,this.uint8[v+5]=u,this.uint8[v+6]=d,this.uint8[v+7]=p,this.float32[b+2]=g,t}}Eb.prototype.bytesPerElement=12,Se(Eb,"StructArrayLayout2i4ub1f12");class il extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,o,c){const u=this.length;return this.resize(u+1),this.emplace(u,t,i,o,c)}emplace(t,i,o,c,u){const d=4*t;return this.float32[d+0]=i,this.float32[d+1]=o,this.float32[d+2]=c,this.float32[d+3]=u,t}}il.prototype.bytesPerElement=16,Se(il,"StructArrayLayout4f16");class ic extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,o,c,u){const d=this.length;return this.resize(d+1),this.emplace(d,t,i,o,c,u)}emplace(t,i,o,c,u,d){const p=6*t,g=3*t;return this.uint16[p+0]=i,this.uint16[p+1]=o,this.uint16[p+2]=c,this.uint16[p+3]=u,this.float32[g+2]=d,t}}ic.prototype.bytesPerElement=12,Se(ic,"StructArrayLayout4ui1f12");class p_ extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,o,c){const u=this.length;return this.resize(u+1),this.emplace(u,t,i,o,c)}emplace(t,i,o,c,u){const d=4*t;return this.uint16[d+0]=i,this.uint16[d+1]=o,this.uint16[d+2]=c,this.uint16[d+3]=u,t}}p_.prototype.bytesPerElement=8,Se(p_,"StructArrayLayout4ui8");class m_ extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,o,c,u,d){const p=this.length;return this.resize(p+1),this.emplace(p,t,i,o,c,u,d)}emplace(t,i,o,c,u,d,p){const g=6*t;return this.int16[g+0]=i,this.int16[g+1]=o,this.int16[g+2]=c,this.int16[g+3]=u,this.int16[g+4]=d,this.int16[g+5]=p,t}}m_.prototype.bytesPerElement=12,Se(m_,"StructArrayLayout6i12");class Mb extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,o,c,u,d,p,g,_,v,b,S){const E=this.length;return this.resize(E+1),this.emplace(E,t,i,o,c,u,d,p,g,_,v,b,S)}emplace(t,i,o,c,u,d,p,g,_,v,b,S,E){const A=12*t;return this.int16[A+0]=i,this.int16[A+1]=o,this.int16[A+2]=c,this.int16[A+3]=u,this.uint16[A+4]=d,this.uint16[A+5]=p,this.uint16[A+6]=g,this.uint16[A+7]=_,this.int16[A+8]=v,this.int16[A+9]=b,this.int16[A+10]=S,this.int16[A+11]=E,t}}Mb.prototype.bytesPerElement=24,Se(Mb,"StructArrayLayout4i4ui4i24");class Ab extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,o,c,u,d){const p=this.length;return this.resize(p+1),this.emplace(p,t,i,o,c,u,d)}emplace(t,i,o,c,u,d,p){const g=10*t,_=5*t;return this.int16[g+0]=i,this.int16[g+1]=o,this.int16[g+2]=c,this.float32[_+2]=u,this.float32[_+3]=d,this.float32[_+4]=p,t}}Ab.prototype.bytesPerElement=20,Se(Ab,"StructArrayLayout3i3f20");class Cb extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const i=this.length;return this.resize(i+1),this.emplace(i,t)}emplace(t,i){return this.uint32[1*t+0]=i,t}}Cb.prototype.bytesPerElement=4,Se(Cb,"StructArrayLayout1ul4");class sc extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i){const o=this.length;return this.resize(o+1),this.emplace(o,t,i)}emplace(t,i,o){const c=2*t;return this.uint16[c+0]=i,this.uint16[c+1]=o,t}}sc.prototype.bytesPerElement=4,Se(sc,"StructArrayLayout2ui4");class Pb extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,o,c,u,d,p,g,_,v,b,S,E){const A=this.length;return this.resize(A+1),this.emplace(A,t,i,o,c,u,d,p,g,_,v,b,S,E)}emplace(t,i,o,c,u,d,p,g,_,v,b,S,E,A){const C=20*t,P=10*t;return this.int16[C+0]=i,this.int16[C+1]=o,this.int16[C+2]=c,this.int16[C+3]=u,this.int16[C+4]=d,this.float32[P+3]=p,this.float32[P+4]=g,this.float32[P+5]=_,this.float32[P+6]=v,this.int16[C+14]=b,this.uint32[P+8]=S,this.uint16[C+18]=E,this.uint16[C+19]=A,t}}Pb.prototype.bytesPerElement=40,Se(Pb,"StructArrayLayout5i4f1i1ul2ui40");class g_ extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,o,c,u,d,p){const g=this.length;return this.resize(g+1),this.emplace(g,t,i,o,c,u,d,p)}emplace(t,i,o,c,u,d,p,g){const _=8*t;return this.int16[_+0]=i,this.int16[_+1]=o,this.int16[_+2]=c,this.int16[_+4]=u,this.int16[_+5]=d,this.int16[_+6]=p,this.int16[_+7]=g,t}}g_.prototype.bytesPerElement=16,Se(g_,"StructArrayLayout3i2i2i16");class Ib extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,o,c,u){const d=this.length;return this.resize(d+1),this.emplace(d,t,i,o,c,u)}emplace(t,i,o,c,u,d){const p=4*t,g=8*t;return this.float32[p+0]=i,this.float32[p+1]=o,this.float32[p+2]=c,this.int16[g+6]=u,this.int16[g+7]=d,t}}Ib.prototype.bytesPerElement=16,Se(Ib,"StructArrayLayout2f1f2i16");class kb extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,o,c){const u=this.length;return this.resize(u+1),this.emplace(u,t,i,o,c)}emplace(t,i,o,c,u){const d=12*t,p=3*t;return this.uint8[d+0]=i,this.uint8[d+1]=o,this.float32[p+1]=c,this.float32[p+2]=u,t}}kb.prototype.bytesPerElement=12,Se(kb,"StructArrayLayout2ub2f12");class Hr extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,o){const c=this.length;return this.resize(c+1),this.emplace(c,t,i,o)}emplace(t,i,o,c){const u=3*t;return this.uint16[u+0]=i,this.uint16[u+1]=o,this.uint16[u+2]=c,t}}Hr.prototype.bytesPerElement=6,Se(Hr,"StructArrayLayout3ui6");class Db extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,i,o,c,u,d,p,g,_,v,b,S,E,A,C,P,k,L,j,V,F){const U=this.length;return this.resize(U+1),this.emplace(U,t,i,o,c,u,d,p,g,_,v,b,S,E,A,C,P,k,L,j,V,F)}emplace(t,i,o,c,u,d,p,g,_,v,b,S,E,A,C,P,k,L,j,V,F,U){const q=30*t,Z=15*t,X=60*t;return this.int16[q+0]=i,this.int16[q+1]=o,this.int16[q+2]=c,this.float32[Z+2]=u,this.float32[Z+3]=d,this.uint16[q+8]=p,this.uint16[q+9]=g,this.uint32[Z+5]=_,this.uint32[Z+6]=v,this.uint32[Z+7]=b,this.uint16[q+16]=S,this.uint16[q+17]=E,this.uint16[q+18]=A,this.float32[Z+10]=C,this.float32[Z+11]=P,this.uint8[X+48]=k,this.uint8[X+49]=L,this.uint8[X+50]=j,this.uint32[Z+13]=V,this.int16[q+28]=F,this.uint8[X+58]=U,t}}Db.prototype.bytesPerElement=60,Se(Db,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Rb extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,i,o,c,u,d,p,g,_,v,b,S,E,A,C,P,k,L,j,V,F,U,q,Z,X,J,rt,it,ut,tt,dt,gt){const xt=this.length;return this.resize(xt+1),this.emplace(xt,t,i,o,c,u,d,p,g,_,v,b,S,E,A,C,P,k,L,j,V,F,U,q,Z,X,J,rt,it,ut,tt,dt,gt)}emplace(t,i,o,c,u,d,p,g,_,v,b,S,E,A,C,P,k,L,j,V,F,U,q,Z,X,J,rt,it,ut,tt,dt,gt,xt){const ht=20*t,pt=40*t,Et=80*t;return this.float32[ht+0]=i,this.float32[ht+1]=o,this.int16[pt+4]=c,this.int16[pt+5]=u,this.int16[pt+6]=d,this.int16[pt+7]=p,this.int16[pt+8]=g,this.int16[pt+9]=_,this.int16[pt+10]=v,this.int16[pt+11]=b,this.int16[pt+12]=S,this.uint16[pt+13]=E,this.uint16[pt+14]=A,this.uint16[pt+15]=C,this.uint16[pt+16]=P,this.uint16[pt+17]=k,this.uint16[pt+18]=L,this.uint16[pt+19]=j,this.uint16[pt+20]=V,this.uint16[pt+21]=F,this.uint16[pt+22]=U,this.uint16[pt+23]=q,this.uint16[pt+24]=Z,this.uint16[pt+25]=X,this.uint16[pt+26]=J,this.uint16[pt+27]=rt,this.uint32[ht+14]=it,this.float32[ht+15]=ut,this.float32[ht+16]=tt,this.float32[ht+17]=dt,this.float32[ht+18]=gt,this.uint8[Et+76]=xt,t}}Rb.prototype.bytesPerElement=80,Se(Rb,"StructArrayLayout2f9i15ui1ul4f1ub80");class Jf extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const i=this.length;return this.resize(i+1),this.emplace(i,t)}emplace(t,i){return this.float32[1*t+0]=i,t}}Jf.prototype.bytesPerElement=4,Se(Jf,"StructArrayLayout1f4");class Ru extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,o,c,u){const d=this.length;return this.resize(d+1),this.emplace(d,t,i,o,c,u)}emplace(t,i,o,c,u,d){const p=5*t;return this.float32[p+0]=i,this.float32[p+1]=o,this.float32[p+2]=c,this.float32[p+3]=u,this.float32[p+4]=d,t}}Ru.prototype.bytesPerElement=20,Se(Ru,"StructArrayLayout5f20");class Ob extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,o,c,u,d,p){const g=this.length;return this.resize(g+1),this.emplace(g,t,i,o,c,u,d,p)}emplace(t,i,o,c,u,d,p,g){const _=7*t;return this.float32[_+0]=i,this.float32[_+1]=o,this.float32[_+2]=c,this.float32[_+3]=u,this.float32[_+4]=d,this.float32[_+5]=p,this.float32[_+6]=g,t}}Ob.prototype.bytesPerElement=28,Se(Ob,"StructArrayLayout7f28");class Lb extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,o,c){const u=this.length;return this.resize(u+1),this.emplace(u,t,i,o,c)}emplace(t,i,o,c,u){const d=6*t;return this.uint32[3*t+0]=i,this.uint16[d+2]=o,this.uint16[d+3]=c,this.uint16[d+4]=u,t}}Lb.prototype.bytesPerElement=12,Se(Lb,"StructArrayLayout1ul3ui12");class Qf extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const i=this.length;return this.resize(i+1),this.emplace(i,t)}emplace(t,i){return this.uint16[1*t+0]=i,t}}Qf.prototype.bytesPerElement=2,Se(Qf,"StructArrayLayout1ui2");class Ou extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,o){const c=this.length;return this.resize(c+1),this.emplace(c,t,i,o)}emplace(t,i,o,c){const u=3*t;return this.float32[u+0]=i,this.float32[u+1]=o,this.float32[u+2]=c,t}}Ou.prototype.bytesPerElement=12,Se(Ou,"StructArrayLayout3f12");class tp extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i){const o=this.length;return this.resize(o+1),this.emplace(o,t,i)}emplace(t,i,o){const c=2*t;return this.float32[c+0]=i,this.float32[c+1]=o,t}}tp.prototype.bytesPerElement=8,Se(tp,"StructArrayLayout2f8");class zb extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,o,c,u,d,p,g,_,v,b,S,E,A,C,P){const k=this.length;return this.resize(k+1),this.emplace(k,t,i,o,c,u,d,p,g,_,v,b,S,E,A,C,P)}emplace(t,i,o,c,u,d,p,g,_,v,b,S,E,A,C,P,k){const L=16*t;return this.float32[L+0]=i,this.float32[L+1]=o,this.float32[L+2]=c,this.float32[L+3]=u,this.float32[L+4]=d,this.float32[L+5]=p,this.float32[L+6]=g,this.float32[L+7]=_,this.float32[L+8]=v,this.float32[L+9]=b,this.float32[L+10]=S,this.float32[L+11]=E,this.float32[L+12]=A,this.float32[L+13]=C,this.float32[L+14]=P,this.float32[L+15]=k,t}}zb.prototype.bytesPerElement=64,Se(zb,"StructArrayLayout16f64");class __ extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,o,c,u,d,p){const g=this.length;return this.resize(g+1),this.emplace(g,t,i,o,c,u,d,p)}emplace(t,i,o,c,u,d,p,g){const _=10*t,v=5*t;return this.uint16[_+0]=i,this.uint16[_+1]=o,this.uint16[_+2]=c,this.uint16[_+3]=u,this.float32[v+2]=d,this.float32[v+3]=p,this.float32[v+4]=g,t}}__.prototype.bytesPerElement=20,Se(__,"StructArrayLayout4ui3f20");class Nb extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(t){const i=this.length;return this.resize(i+1),this.emplace(i,t)}emplace(t,i){return this.uint8[1*t+0]=i,t}}Nb.prototype.bytesPerElement=1,Se(Nb,"StructArrayLayout1ub1");class ik extends d_{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}ik.prototype.size=40;class Fb extends Pb{get(t){return new ik(this,t)}}Se(Fb,"CollisionBoxArray");class sk extends d_{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(t){this._structArray.uint8[this._pos1+49]=t}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(t){this._structArray.uint8[this._pos1+50]=t}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(t){this._structArray.uint32[this._pos4+13]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(t){this._structArray.uint8[this._pos1+58]=t}}sk.prototype.size=60;class ok extends Db{get(t){return new sk(this,t)}}Se(ok,"PlacedSymbolArray");class ak extends d_{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(t){this._structArray.uint32[this._pos4+14]=t}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(t){this._structArray.float32[this._pos4+18]=t}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}ak.prototype.size=80;class lk extends Rb{get(t){return new ak(this,t)}}Se(lk,"SymbolInstanceArray");class ck extends Jf{getoffsetX(t){return this.float32[1*t+0]}}Se(ck,"GlyphOffsetArray");class uk extends Ds{getx(t){return this.int16[2*t+0]}gety(t){return this.int16[2*t+1]}}Se(uk,"SymbolLineVertexArray");class hk extends d_{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}hk.prototype.size=12;class dk extends Lb{get(t){return new hk(this,t)}}Se(dk,"FeatureIndexArray");class fk extends sc{geta_centroid_pos0(t){return this.uint16[2*t+0]}geta_centroid_pos1(t){return this.uint16[2*t+1]}}Se(fk,"FillExtrusionCentroidArray");const a9=Rn([{name:"a_pos",components:2,type:"Int16"}],4),l9=Rn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Bn{constructor(t=[]){this.segments=t}_prepareSegment(t,i,o,c){let u=this.segments[this.segments.length-1];return t>Bn.MAX_VERTEX_ARRAY_LENGTH&&_t(`Max vertices per segment is ${Bn.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!u||u.vertexLength+t>Bn.MAX_VERTEX_ARRAY_LENGTH||u.sortKey!==c)&&(u={vertexOffset:i,primitiveOffset:o,vertexLength:0,primitiveLength:0},c!==void 0&&(u.sortKey=c),this.segments.push(u)),u}prepareSegment(t,i,o,c){return this._prepareSegment(t,i.length,o.length,c)}get(){return this.segments}destroy(){for(const t of this.segments)for(const i in t.vaos)t.vaos[i].destroy()}static simpleSegment(t,i,o,c){return new Bn([{vertexOffset:t,primitiveOffset:i,vertexLength:o,primitiveLength:c,vaos:{},sortKey:0}])}}function pk(n,t){return 256*(n=Ot(Math.floor(n),0,255))+Ot(Math.floor(t),0,255)}Bn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Se(Bn,"SegmentVector");const c9=Rn([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),u9=Rn([{name:"a_dash",components:4,type:"Uint16"}]);var y_={exports:{}},mk={exports:{}};(function(n){n.exports=function(t,i){var o,c,u,d,p,g,_,v;for(c=t.length-(o=3&t.length),u=i,p=3432918353,g=461845907,v=0;v<c;)_=255&t.charCodeAt(v)|(255&t.charCodeAt(++v))<<8|(255&t.charCodeAt(++v))<<16|(255&t.charCodeAt(++v))<<24,++v,u=27492+(65535&(d=5*(65535&(u=(u^=_=(65535&(_=(_=(65535&_)*p+(((_>>>16)*p&65535)<<16)&4294967295)<<15|_>>>17))*g+(((_>>>16)*g&65535)<<16)&4294967295)<<13|u>>>19))+((5*(u>>>16)&65535)<<16)&4294967295))+((58964+(d>>>16)&65535)<<16);switch(_=0,o){case 3:_^=(255&t.charCodeAt(v+2))<<16;case 2:_^=(255&t.charCodeAt(v+1))<<8;case 1:u^=_=(65535&(_=(_=(65535&(_^=255&t.charCodeAt(v)))*p+(((_>>>16)*p&65535)<<16)&4294967295)<<15|_>>>17))*g+(((_>>>16)*g&65535)<<16)&4294967295}return u^=t.length,u=2246822507*(65535&(u^=u>>>16))+((2246822507*(u>>>16)&65535)<<16)&4294967295,u=3266489909*(65535&(u^=u>>>13))+((3266489909*(u>>>16)&65535)<<16)&4294967295,(u^=u>>>16)>>>0}})(mk);var h9=mk.exports,gk={exports:{}};(function(n){n.exports=function(t,i){for(var o,c=t.length,u=i^c,d=0;c>=4;)o=1540483477*(65535&(o=255&t.charCodeAt(d)|(255&t.charCodeAt(++d))<<8|(255&t.charCodeAt(++d))<<16|(255&t.charCodeAt(++d))<<24))+((1540483477*(o>>>16)&65535)<<16),u=1540483477*(65535&u)+((1540483477*(u>>>16)&65535)<<16)^(o=1540483477*(65535&(o^=o>>>24))+((1540483477*(o>>>16)&65535)<<16)),c-=4,++d;switch(c){case 3:u^=(255&t.charCodeAt(d+2))<<16;case 2:u^=(255&t.charCodeAt(d+1))<<8;case 1:u=1540483477*(65535&(u^=255&t.charCodeAt(d)))+((1540483477*(u>>>16)&65535)<<16)}return u=1540483477*(65535&(u^=u>>>13))+((1540483477*(u>>>16)&65535)<<16),(u^=u>>>15)>>>0}})(gk);var _k=h9,d9=gk.exports;y_.exports=_k,y_.exports.murmur3=_k,y_.exports.murmur2=d9;var Bb=H(y_.exports);class ep{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(t,i,o,c){this.ids.push(yk(t)),this.positions.push(i,o,c)}eachPosition(t,i){const o=yk(t);let c=0,u=this.ids.length-1;for(;c<u;){const d=c+u>>1;this.ids[d]>=o?u=d:c=d+1}for(;this.ids[c]===o;)i(this.positions[3*c],this.positions[3*c+1],this.positions[3*c+2]),c++}static serialize(t,i){const o=new Float64Array(t.ids),c=new Uint32Array(t.positions);return jb(o,c,0,o.length-1),i&&(i.add(o.buffer),i.add(c.buffer)),{ids:o,positions:c}}static deserialize(t){const i=new ep;let o;i.ids=t.ids,i.positions=t.positions;for(const c of i.ids)c!==o&&i.uniqueIds.push(c),o=c;return i.indexed=!0,i}}function yk(n){const t=+n;return!isNaN(t)&&Number.MIN_SAFE_INTEGER<=t&&t<=Number.MAX_SAFE_INTEGER?t:Bb(String(n))}function jb(n,t,i,o){for(;i<o;){const c=n[i+o>>1];let u=i-1,d=o+1;for(;;){do u++;while(n[u]<c);do d--;while(n[d]>c);if(u>=d)break;v_(n,u,d),v_(t,3*u,3*d),v_(t,3*u+1,3*d+1),v_(t,3*u+2,3*d+2)}d-i<o-d?(jb(n,t,i,d),i=d+1):(jb(n,t,d+1,o),o=d)}}function v_(n,t,i){const o=n[t];n[t]=n[i],n[i]=o}Se(ep,"FeaturePositionMap");class sl{constructor(t){this.gl=t.gl,this.initialized=!1}fetchUniformLocation(t,i){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(t,i),this.initialized=!0),!!this.location}}class hn extends sl{constructor(t){super(t),this.current=0}set(t,i,o){this.fetchUniformLocation(t,i)&&this.current!==o&&(this.current=o,this.gl.uniform1i(this.location,o))}}class Xt extends sl{constructor(t){super(t),this.current=0}set(t,i,o){this.fetchUniformLocation(t,i)&&this.current!==o&&(this.current=o,this.gl.uniform1f(this.location,o))}}class dn extends sl{constructor(t){super(t),this.current=[0,0]}set(t,i,o){this.fetchUniformLocation(t,i)&&(o[0]===this.current[0]&&o[1]===this.current[1]||(this.current=o,this.gl.uniform2f(this.location,o[0],o[1])))}}class en extends sl{constructor(t){super(t),this.current=[0,0,0]}set(t,i,o){this.fetchUniformLocation(t,i)&&(o[0]===this.current[0]&&o[1]===this.current[1]&&o[2]===this.current[2]||(this.current=o,this.gl.uniform3f(this.location,o[0],o[1],o[2])))}}class Rs extends sl{constructor(t){super(t),this.current=[0,0,0,0]}set(t,i,o){this.fetchUniformLocation(t,i)&&(o[0]===this.current[0]&&o[1]===this.current[1]&&o[2]===this.current[2]&&o[3]===this.current[3]||(this.current=o,this.gl.uniform4f(this.location,o[0],o[1],o[2],o[3])))}}class sd extends sl{constructor(t){super(t),this.current=tn.transparent}set(t,i,o){this.fetchUniformLocation(t,i)&&(o.r===this.current.r&&o.g===this.current.g&&o.b===this.current.b&&o.a===this.current.a||(this.current=o,this.gl.uniform4f(this.location,o.r,o.g,o.b,o.a)))}}const f9=new Float32Array(16);class Ke extends sl{constructor(t){super(t),this.current=f9}set(t,i,o){if(this.fetchUniformLocation(t,i)){if(o[12]!==this.current[12]||o[0]!==this.current[0])return this.current=o,void this.gl.uniformMatrix4fv(this.location,!1,o);for(let c=1;c<16;c++)if(o[c]!==this.current[c]){this.current=o,this.gl.uniformMatrix4fv(this.location,!1,o);break}}}}const p9=new Float32Array(9);class Vb extends sl{constructor(t){super(t),this.current=p9}set(t,i,o){if(this.fetchUniformLocation(t,i)){for(let c=0;c<9;c++)if(o[c]!==this.current[c]){this.current=o,this.gl.uniformMatrix3fv(this.location,!1,o);break}}}}const m9=new Float32Array(4);class Ub extends sl{constructor(t){super(t),this.current=m9}set(t,i,o){if(this.fetchUniformLocation(t,i)){for(let c=0;c<4;c++)if(o[c]!==this.current[c]){this.current=o,this.gl.uniformMatrix2fv(this.location,!1,o);break}}}}function $b(n){return[pk(255*n.r,255*n.g),pk(255*n.b,255*n.a)]}class np{constructor(t,i,o){this.value=t,this.uniformNames=i.map(c=>`u_${c}`),this.type=o}setUniform(t,i,o,c,u){i.set(t,u,c.constantOr(this.value))}getBinding(t,i){return this.type==="color"?new sd(t):new Xt(t)}}class od{constructor(t,i){this.uniformNames=i.map(o=>`u_${o}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(t){this.pixelRatio=t.pixelRatio||1,this.pattern=t.tl.concat(t.br)}setUniform(t,i,o,c,u){const d=u==="u_pattern"||u==="u_dash"?this.pattern:u==="u_pixel_ratio"?this.pixelRatio:null;d&&i.set(t,u,d)}getBinding(t,i){return i==="u_pattern"||i==="u_dash"?new Rs(t):new Xt(t)}}class ol{constructor(t,i,o,c){this.expression=t,this.type=o,this.maxValue=0,this.paintVertexAttributes=i.map(u=>({name:`a_${u}`,type:"Float32",components:o==="color"?2:1,offset:0})),this.paintVertexArray=new c}populatePaintArray(t,i,o,c,u,d,p){const g=this.paintVertexArray.length,_=this.expression.evaluate(new pr(0,{brightness:d}),i,{},u,c,p);this.paintVertexArray.resize(t),this._setPaintValue(g,t,_)}updatePaintArray(t,i,o,c,u,d,p){const g=this.expression.evaluate({zoom:0,brightness:p},o,c,void 0,u);this._setPaintValue(t,i,g)}_setPaintValue(t,i,o){if(this.type==="color"){const c=$b(o);for(let u=t;u<i;u++)this.paintVertexArray.emplace(u,c[0],c[1])}else{for(let c=t;c<i;c++)this.paintVertexArray.emplace(c,o);this.maxValue=Math.max(this.maxValue,Math.abs(o))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Zo{constructor(t,i,o,c,u,d){this.expression=t,this.uniformNames=i.map(p=>`u_${p}_t`),this.type=o,this.useIntegerZoom=c,this.zoom=u,this.maxValue=0,this.paintVertexAttributes=i.map(p=>({name:`a_${p}`,type:"Float32",components:o==="color"?4:2,offset:0})),this.paintVertexArray=new d}populatePaintArray(t,i,o,c,u,d,p){const g=this.expression.evaluate(new pr(this.zoom,{brightness:d}),i,{},u,c,p),_=this.expression.evaluate(new pr(this.zoom+1,{brightness:d}),i,{},u,c,p),v=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(v,t,g,_)}updatePaintArray(t,i,o,c,u,d,p){const g=this.expression.evaluate({zoom:this.zoom,brightness:p},o,c,void 0,u),_=this.expression.evaluate({zoom:this.zoom+1,brightness:p},o,c,void 0,u);this._setPaintValue(t,i,g,_)}_setPaintValue(t,i,o,c){if(this.type==="color"){const u=$b(o),d=$b(c);for(let p=t;p<i;p++)this.paintVertexArray.emplace(p,u[0],u[1],d[0],d[1])}else{for(let u=t;u<i;u++)this.paintVertexArray.emplace(u,o,c);this.maxValue=Math.max(this.maxValue,Math.abs(o),Math.abs(c))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,i,o,c,u){const d=this.useIntegerZoom?Math.floor(o.zoom):o.zoom,p=Ot(this.expression.interpolationFactor(d,this.zoom,this.zoom+1),0,1);i.set(t,u,p)}getBinding(t,i){return new Xt(t)}}class oc{constructor(t,i,o,c,u){this.expression=t,this.layerId=u,this.paintVertexAttributes=(o==="array"?u9:c9).members;for(let d=0;d<i.length;++d);this.paintVertexArray=new c}populatePaintArray(t,i,o){const c=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValues(c,t,i.patterns&&i.patterns[this.layerId],o)}updatePaintArray(t,i,o,c,u,d,p){this._setPaintValues(t,i,o.patterns&&o.patterns[this.layerId],d)}_setPaintValues(t,i,o,c){if(!c||!o)return;const u=c[o];if(!u)return;const{tl:d,br:p,pixelRatio:g}=u;for(let _=t;_<i;_++)this.paintVertexArray.emplace(_,d[0],d[1],p[0],p[1],g)}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Lu{constructor(t,i,o=()=>!0){this.binders={},this._buffers=[];const c=[];for(const u in t.paint._values){const d=t.paint.get(u);if(!o(u)||!(d instanceof id&&Iu(d.property.specification)))continue;const p=_9(u,t.type),g=d.value,_=d.property.specification.type,v=!!d.property.useIntegerZoom,b=u==="line-dasharray"||u.endsWith("pattern"),S=u==="line-dasharray"&&t.layout.get("line-cap").value.kind!=="constant";if(g.kind!=="constant"||S)if(g.kind==="source"||S||b){const E=vk(u,_,"source");this.binders[u]=b?new oc(g,p,_,E,t.id):new ol(g,p,_,E),c.push(`/a_${u}`)}else{const E=vk(u,_,"composite");this.binders[u]=new Zo(g,p,_,v,i,E),c.push(`/z_${u}`)}else this.binders[u]=b?new od(g.value,p):new np(g.value,p,_),c.push(`/u_${u}`)}this.cacheKey=c.sort().join("")}getMaxValue(t){const i=this.binders[t];return i instanceof ol||i instanceof Zo?i.maxValue:0}populatePaintArrays(t,i,o,c,u,d,p){for(const g in this.binders){const _=this.binders[g];(_ instanceof ol||_ instanceof Zo||_ instanceof oc)&&_.populatePaintArray(t,i,o,c,u,d,p)}}setConstantPatternPositions(t){for(const i in this.binders){const o=this.binders[i];o instanceof od&&o.setConstantPatternPositions(t)}}updatePaintArrays(t,i,o,c,u,d,p,g){let _=!1;const v=Object.keys(t),b=v.length!==0,S=b?v:i.uniqueIds;for(const E in this.binders){const A=this.binders[E];if((A instanceof ol||A instanceof Zo||A instanceof oc)&&(A.expression.isStateDependent===!0||A.expression.isLightConstant===!1)){const C=u.paint.get(E);A.expression=C.value;for(const P of S){const k=t[P.toString()];i.eachPosition(P,(L,j,V)=>{const F=c.feature(L);A.updatePaintArray(j,V,F,k,d,p,g)})}if(!b)for(const P of o.uniqueIds){const k=t[P.toString()];o.eachPosition(P,(L,j,V)=>{const F=c.feature(L);A.updatePaintArray(j,V,F,k,d,p,g)})}_=!0}}return _}defines(){const t=[];for(const i in this.binders){const o=this.binders[i];(o instanceof np||o instanceof od)&&t.push(...o.uniformNames.map(c=>`#define HAS_UNIFORM_${c}`))}return t}getBinderAttributes(){const t=[];for(const i in this.binders){const o=this.binders[i];if(o instanceof ol||o instanceof Zo||o instanceof oc)for(let c=0;c<o.paintVertexAttributes.length;c++)t.push(o.paintVertexAttributes[c].name)}return t}getBinderUniforms(){const t=[];for(const i in this.binders){const o=this.binders[i];if(o instanceof np||o instanceof od||o instanceof Zo)for(const c of o.uniformNames)t.push(c)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t){const i=[];for(const o in this.binders){const c=this.binders[o];if(c instanceof np||c instanceof od||c instanceof Zo)for(const u of c.uniformNames)i.push({name:u,property:o,binding:c.getBinding(t,u)})}return i}setUniforms(t,i,o,c,u){for(const{name:d,property:p,binding:g}of o)this.binders[p].setUniform(t,g,u,c.get(p),d)}updatePaintBuffers(){this._buffers=[];for(const t in this.binders){const i=this.binders[t];(i instanceof ol||i instanceof Zo||i instanceof oc)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer)}}upload(t){for(const i in this.binders){const o=this.binders[i];(o instanceof ol||o instanceof Zo||o instanceof oc)&&o.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const i=this.binders[t];(i instanceof ol||i instanceof Zo||i instanceof oc)&&i.destroy()}}}class ac{constructor(t,i,o=()=>!0){this.programConfigurations={};for(const c of t)this.programConfigurations[c.id]=new Lu(c,i,o);this.needsUpload=!1,this._featureMap=new ep,this._featureMapWithoutIds=new ep,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(t,i,o,c,u,d,p,g){for(const _ in this.programConfigurations)this.programConfigurations[_].populatePaintArrays(t,i,c,u,d,p,g);i.id!==void 0?this._featureMap.add(i.id,o,this._bufferOffset,t):(this._featureMapWithoutIds.add(this._idlessCounter,o,this._bufferOffset,t),this._idlessCounter+=1),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,i,o,c,u,d){for(const p of o)this.needsUpload=this.programConfigurations[p.id].updatePaintArrays(t,this._featureMap,this._featureMapWithoutIds,i,p,c,u,d||0)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const i in this.programConfigurations)this.programConfigurations[i].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}const g9={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function _9(n,t){return g9[n]||[n.replace(`${t}-`,"").replace(/-/g,"_")]}const y9={"line-pattern":{source:ic,composite:ic},"fill-pattern":{source:ic,composite:ic},"fill-extrusion-pattern":{source:ic,composite:ic},"line-dasharray":{source:p_,composite:p_}},v9={color:{source:tp,composite:il},number:{source:Jf,composite:tp}};function vk(n,t,i){const o=y9[n];return o&&o[i]||v9[t][i]}Se(np,"ConstantBinder"),Se(od,"PatternConstantBinder"),Se(ol,"SourceExpressionBinder"),Se(oc,"PatternCompositeBinder"),Se(Zo,"CompositeExpressionBinder"),Se(Lu,"ProgramConfiguration",{omit:["_buffers"]}),Se(ac,"ProgramConfigurationSet");class Os{constructor(t,i){t&&(i?this.setSouthWest(t).setNorthEast(i):t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))}setNorthEast(t){return this._ne=t instanceof Ze?new Ze(t.lng,t.lat):Ze.convert(t),this}setSouthWest(t){return this._sw=t instanceof Ze?new Ze(t.lng,t.lat):Ze.convert(t),this}extend(t){const i=this._sw,o=this._ne;let c,u;if(t instanceof Ze)c=t,u=t;else{if(!(t instanceof Os))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(Os.convert(t)):this.extend(Ze.convert(t)):typeof t=="object"&&t!==null&&t.hasOwnProperty("lat")&&(t.hasOwnProperty("lon")||t.hasOwnProperty("lng"))?this.extend(Ze.convert(t)):this;if(c=t._sw,u=t._ne,!c||!u)return this}return i||o?(i.lng=Math.min(c.lng,i.lng),i.lat=Math.min(c.lat,i.lat),o.lng=Math.max(u.lng,o.lng),o.lat=Math.max(u.lat,o.lat)):(this._sw=new Ze(c.lng,c.lat),this._ne=new Ze(u.lng,u.lat)),this}getCenter(){return new Ze((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Ze(this.getWest(),this.getNorth())}getSouthEast(){return new Ze(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:i,lat:o}=Ze.convert(t);let c=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(c=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=o&&o<=this._ne.lat&&c}static convert(t){return!t||t instanceof Os?t:new Os(t)}}var _i={},yi={};Object.defineProperty(yi,"__esModule",{value:!0}),yi.setMatrixArrayType=function(n){yi.ARRAY_TYPE=bk=n},yi.toRadian=function(n){return n*b9},yi.equals=function(n,t){return Math.abs(n-t)<=xk*Math.max(1,Math.abs(n),Math.abs(t))},yi.RANDOM=yi.ARRAY_TYPE=yi.EPSILON=void 0;var xk=1e-6;yi.EPSILON=xk;var bk=typeof Float32Array<"u"?Float32Array:Array;yi.ARRAY_TYPE=bk;var x9=Math.random;yi.RANDOM=x9;var b9=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var n=0,t=arguments.length;t--;)n+=arguments[t]*arguments[t];return Math.sqrt(n)});var gr={};function Gb(n){return Gb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gb(n)}Object.defineProperty(gr,"__esModule",{value:!0}),gr.create=function(){var n=new lc.ARRAY_TYPE(4);return lc.ARRAY_TYPE!=Float32Array&&(n[1]=0,n[2]=0),n[0]=1,n[3]=1,n},gr.clone=function(n){var t=new lc.ARRAY_TYPE(4);return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t},gr.copy=function(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n},gr.identity=function(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=1,n},gr.fromValues=function(n,t,i,o){var c=new lc.ARRAY_TYPE(4);return c[0]=n,c[1]=t,c[2]=i,c[3]=o,c},gr.set=function(n,t,i,o,c){return n[0]=t,n[1]=i,n[2]=o,n[3]=c,n},gr.transpose=function(n,t){if(n===t){var i=t[1];n[1]=t[2],n[2]=i}else n[0]=t[0],n[1]=t[2],n[2]=t[1],n[3]=t[3];return n},gr.invert=function(n,t){var i=t[0],o=t[1],c=t[2],u=t[3],d=i*u-c*o;return d?(n[0]=u*(d=1/d),n[1]=-o*d,n[2]=-c*d,n[3]=i*d,n):null},gr.adjoint=function(n,t){var i=t[0];return n[0]=t[3],n[1]=-t[1],n[2]=-t[2],n[3]=i,n},gr.determinant=function(n){return n[0]*n[3]-n[2]*n[1]},gr.multiply=Sk,gr.rotate=function(n,t,i){var o=t[0],c=t[1],u=t[2],d=t[3],p=Math.sin(i),g=Math.cos(i);return n[0]=o*g+u*p,n[1]=c*g+d*p,n[2]=o*-p+u*g,n[3]=c*-p+d*g,n},gr.scale=function(n,t,i){var o=t[1],c=t[2],u=t[3],d=i[0],p=i[1];return n[0]=t[0]*d,n[1]=o*d,n[2]=c*p,n[3]=u*p,n},gr.fromRotation=function(n,t){var i=Math.sin(t),o=Math.cos(t);return n[0]=o,n[1]=i,n[2]=-i,n[3]=o,n},gr.fromScaling=function(n,t){return n[0]=t[0],n[1]=0,n[2]=0,n[3]=t[1],n},gr.str=function(n){return"mat2("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+")"},gr.frob=function(n){return Math.hypot(n[0],n[1],n[2],n[3])},gr.LDU=function(n,t,i,o){return n[2]=o[2]/o[0],i[0]=o[0],i[1]=o[1],i[3]=o[3]-n[2]*i[1],[n,t,i]},gr.add=function(n,t,i){return n[0]=t[0]+i[0],n[1]=t[1]+i[1],n[2]=t[2]+i[2],n[3]=t[3]+i[3],n},gr.subtract=Tk,gr.exactEquals=function(n,t){return n[0]===t[0]&&n[1]===t[1]&&n[2]===t[2]&&n[3]===t[3]},gr.equals=function(n,t){var i=n[0],o=n[1],c=n[2],u=n[3],d=t[0],p=t[1],g=t[2],_=t[3];return Math.abs(i-d)<=lc.EPSILON*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(o-p)<=lc.EPSILON*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(c-g)<=lc.EPSILON*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(u-_)<=lc.EPSILON*Math.max(1,Math.abs(u),Math.abs(_))},gr.multiplyScalar=function(n,t,i){return n[0]=t[0]*i,n[1]=t[1]*i,n[2]=t[2]*i,n[3]=t[3]*i,n},gr.multiplyScalarAndAdd=function(n,t,i,o){return n[0]=t[0]+i[0]*o,n[1]=t[1]+i[1]*o,n[2]=t[2]+i[2]*o,n[3]=t[3]+i[3]*o,n},gr.sub=gr.mul=void 0;var lc=function(n,t){if(n&&n.__esModule)return n;if(n===null||Gb(n)!=="object"&&typeof n!="function")return{default:n};var i=wk(void 0);if(i&&i.has(n))return i.get(n);var o={},c=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in n)if(u!=="default"&&Object.prototype.hasOwnProperty.call(n,u)){var d=c?Object.getOwnPropertyDescriptor(n,u):null;d&&(d.get||d.set)?Object.defineProperty(o,u,d):o[u]=n[u]}return o.default=n,i&&i.set(n,o),o}(yi);function wk(n){if(typeof WeakMap!="function")return null;var t=new WeakMap,i=new WeakMap;return(wk=function(o){return o?i:t})(n)}function Sk(n,t,i){var o=t[0],c=t[1],u=t[2],d=t[3],p=i[0],g=i[1],_=i[2],v=i[3];return n[0]=o*p+u*g,n[1]=c*p+d*g,n[2]=o*_+u*v,n[3]=c*_+d*v,n}function Tk(n,t,i){return n[0]=t[0]-i[0],n[1]=t[1]-i[1],n[2]=t[2]-i[2],n[3]=t[3]-i[3],n}gr.mul=Sk,gr.sub=Tk;var vr={};function Wb(n){return Wb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wb(n)}Object.defineProperty(vr,"__esModule",{value:!0}),vr.create=function(){var n=new Ea.ARRAY_TYPE(6);return Ea.ARRAY_TYPE!=Float32Array&&(n[1]=0,n[2]=0,n[4]=0,n[5]=0),n[0]=1,n[3]=1,n},vr.clone=function(n){var t=new Ea.ARRAY_TYPE(6);return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t},vr.copy=function(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n},vr.identity=function(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=1,n[4]=0,n[5]=0,n},vr.fromValues=function(n,t,i,o,c,u){var d=new Ea.ARRAY_TYPE(6);return d[0]=n,d[1]=t,d[2]=i,d[3]=o,d[4]=c,d[5]=u,d},vr.set=function(n,t,i,o,c,u,d){return n[0]=t,n[1]=i,n[2]=o,n[3]=c,n[4]=u,n[5]=d,n},vr.invert=function(n,t){var i=t[0],o=t[1],c=t[2],u=t[3],d=t[4],p=t[5],g=i*u-o*c;return g?(n[0]=u*(g=1/g),n[1]=-o*g,n[2]=-c*g,n[3]=i*g,n[4]=(c*p-u*d)*g,n[5]=(o*d-i*p)*g,n):null},vr.determinant=function(n){return n[0]*n[3]-n[1]*n[2]},vr.multiply=Mk,vr.rotate=function(n,t,i){var o=t[0],c=t[1],u=t[2],d=t[3],p=t[4],g=t[5],_=Math.sin(i),v=Math.cos(i);return n[0]=o*v+u*_,n[1]=c*v+d*_,n[2]=o*-_+u*v,n[3]=c*-_+d*v,n[4]=p,n[5]=g,n},vr.scale=function(n,t,i){var o=t[1],c=t[2],u=t[3],d=t[4],p=t[5],g=i[0],_=i[1];return n[0]=t[0]*g,n[1]=o*g,n[2]=c*_,n[3]=u*_,n[4]=d,n[5]=p,n},vr.translate=function(n,t,i){var o=t[0],c=t[1],u=t[2],d=t[3],p=t[4],g=t[5],_=i[0],v=i[1];return n[0]=o,n[1]=c,n[2]=u,n[3]=d,n[4]=o*_+u*v+p,n[5]=c*_+d*v+g,n},vr.fromRotation=function(n,t){var i=Math.sin(t),o=Math.cos(t);return n[0]=o,n[1]=i,n[2]=-i,n[3]=o,n[4]=0,n[5]=0,n},vr.fromScaling=function(n,t){return n[0]=t[0],n[1]=0,n[2]=0,n[3]=t[1],n[4]=0,n[5]=0,n},vr.fromTranslation=function(n,t){return n[0]=1,n[1]=0,n[2]=0,n[3]=1,n[4]=t[0],n[5]=t[1],n},vr.str=function(n){return"mat2d("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+", "+n[4]+", "+n[5]+")"},vr.frob=function(n){return Math.hypot(n[0],n[1],n[2],n[3],n[4],n[5],1)},vr.add=function(n,t,i){return n[0]=t[0]+i[0],n[1]=t[1]+i[1],n[2]=t[2]+i[2],n[3]=t[3]+i[3],n[4]=t[4]+i[4],n[5]=t[5]+i[5],n},vr.subtract=Ak,vr.multiplyScalar=function(n,t,i){return n[0]=t[0]*i,n[1]=t[1]*i,n[2]=t[2]*i,n[3]=t[3]*i,n[4]=t[4]*i,n[5]=t[5]*i,n},vr.multiplyScalarAndAdd=function(n,t,i,o){return n[0]=t[0]+i[0]*o,n[1]=t[1]+i[1]*o,n[2]=t[2]+i[2]*o,n[3]=t[3]+i[3]*o,n[4]=t[4]+i[4]*o,n[5]=t[5]+i[5]*o,n},vr.exactEquals=function(n,t){return n[0]===t[0]&&n[1]===t[1]&&n[2]===t[2]&&n[3]===t[3]&&n[4]===t[4]&&n[5]===t[5]},vr.equals=function(n,t){var i=n[0],o=n[1],c=n[2],u=n[3],d=n[4],p=n[5],g=t[0],_=t[1],v=t[2],b=t[3],S=t[4],E=t[5];return Math.abs(i-g)<=Ea.EPSILON*Math.max(1,Math.abs(i),Math.abs(g))&&Math.abs(o-_)<=Ea.EPSILON*Math.max(1,Math.abs(o),Math.abs(_))&&Math.abs(c-v)<=Ea.EPSILON*Math.max(1,Math.abs(c),Math.abs(v))&&Math.abs(u-b)<=Ea.EPSILON*Math.max(1,Math.abs(u),Math.abs(b))&&Math.abs(d-S)<=Ea.EPSILON*Math.max(1,Math.abs(d),Math.abs(S))&&Math.abs(p-E)<=Ea.EPSILON*Math.max(1,Math.abs(p),Math.abs(E))},vr.sub=vr.mul=void 0;var Ea=function(n,t){if(n&&n.__esModule)return n;if(n===null||Wb(n)!=="object"&&typeof n!="function")return{default:n};var i=Ek(void 0);if(i&&i.has(n))return i.get(n);var o={},c=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in n)if(u!=="default"&&Object.prototype.hasOwnProperty.call(n,u)){var d=c?Object.getOwnPropertyDescriptor(n,u):null;d&&(d.get||d.set)?Object.defineProperty(o,u,d):o[u]=n[u]}return o.default=n,i&&i.set(n,o),o}(yi);function Ek(n){if(typeof WeakMap!="function")return null;var t=new WeakMap,i=new WeakMap;return(Ek=function(o){return o?i:t})(n)}function Mk(n,t,i){var o=t[0],c=t[1],u=t[2],d=t[3],p=t[4],g=t[5],_=i[0],v=i[1],b=i[2],S=i[3],E=i[4],A=i[5];return n[0]=o*_+u*v,n[1]=c*_+d*v,n[2]=o*b+u*S,n[3]=c*b+d*S,n[4]=o*E+u*A+p,n[5]=c*E+d*A+g,n}function Ak(n,t,i){return n[0]=t[0]-i[0],n[1]=t[1]-i[1],n[2]=t[2]-i[2],n[3]=t[3]-i[3],n[4]=t[4]-i[4],n[5]=t[5]-i[5],n}vr.mul=Mk,vr.sub=Ak;var Hn={};function Hb(n){return Hb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hb(n)}Object.defineProperty(Hn,"__esModule",{value:!0}),Hn.create=function(){var n=new to.ARRAY_TYPE(9);return to.ARRAY_TYPE!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1,n},Hn.fromMat4=function(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[4],n[4]=t[5],n[5]=t[6],n[6]=t[8],n[7]=t[9],n[8]=t[10],n},Hn.clone=function(n){var t=new to.ARRAY_TYPE(9);return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t},Hn.copy=function(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n},Hn.fromValues=function(n,t,i,o,c,u,d,p,g){var _=new to.ARRAY_TYPE(9);return _[0]=n,_[1]=t,_[2]=i,_[3]=o,_[4]=c,_[5]=u,_[6]=d,_[7]=p,_[8]=g,_},Hn.set=function(n,t,i,o,c,u,d,p,g,_){return n[0]=t,n[1]=i,n[2]=o,n[3]=c,n[4]=u,n[5]=d,n[6]=p,n[7]=g,n[8]=_,n},Hn.identity=function(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=1,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n},Hn.transpose=function(n,t){if(n===t){var i=t[1],o=t[2],c=t[5];n[1]=t[3],n[2]=t[6],n[3]=i,n[5]=t[7],n[6]=o,n[7]=c}else n[0]=t[0],n[1]=t[3],n[2]=t[6],n[3]=t[1],n[4]=t[4],n[5]=t[7],n[6]=t[2],n[7]=t[5],n[8]=t[8];return n},Hn.invert=function(n,t){var i=t[0],o=t[1],c=t[2],u=t[3],d=t[4],p=t[5],g=t[6],_=t[7],v=t[8],b=v*d-p*_,S=-v*u+p*g,E=_*u-d*g,A=i*b+o*S+c*E;return A?(n[0]=b*(A=1/A),n[1]=(-v*o+c*_)*A,n[2]=(p*o-c*d)*A,n[3]=S*A,n[4]=(v*i-c*g)*A,n[5]=(-p*i+c*u)*A,n[6]=E*A,n[7]=(-_*i+o*g)*A,n[8]=(d*i-o*u)*A,n):null},Hn.adjoint=function(n,t){var i=t[0],o=t[1],c=t[2],u=t[3],d=t[4],p=t[5],g=t[6],_=t[7],v=t[8];return n[0]=d*v-p*_,n[1]=c*_-o*v,n[2]=o*p-c*d,n[3]=p*g-u*v,n[4]=i*v-c*g,n[5]=c*u-i*p,n[6]=u*_-d*g,n[7]=o*g-i*_,n[8]=i*d-o*u,n},Hn.determinant=function(n){var t=n[3],i=n[4],o=n[5],c=n[6],u=n[7],d=n[8];return n[0]*(d*i-o*u)+n[1]*(-d*t+o*c)+n[2]*(u*t-i*c)},Hn.multiply=Pk,Hn.translate=function(n,t,i){var o=t[0],c=t[1],u=t[2],d=t[3],p=t[4],g=t[5],_=t[6],v=t[7],b=t[8],S=i[0],E=i[1];return n[0]=o,n[1]=c,n[2]=u,n[3]=d,n[4]=p,n[5]=g,n[6]=S*o+E*d+_,n[7]=S*c+E*p+v,n[8]=S*u+E*g+b,n},Hn.rotate=function(n,t,i){var o=t[0],c=t[1],u=t[2],d=t[3],p=t[4],g=t[5],_=t[6],v=t[7],b=t[8],S=Math.sin(i),E=Math.cos(i);return n[0]=E*o+S*d,n[1]=E*c+S*p,n[2]=E*u+S*g,n[3]=E*d-S*o,n[4]=E*p-S*c,n[5]=E*g-S*u,n[6]=_,n[7]=v,n[8]=b,n},Hn.scale=function(n,t,i){var o=i[0],c=i[1];return n[0]=o*t[0],n[1]=o*t[1],n[2]=o*t[2],n[3]=c*t[3],n[4]=c*t[4],n[5]=c*t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n},Hn.fromTranslation=function(n,t){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=1,n[5]=0,n[6]=t[0],n[7]=t[1],n[8]=1,n},Hn.fromRotation=function(n,t){var i=Math.sin(t),o=Math.cos(t);return n[0]=o,n[1]=i,n[2]=0,n[3]=-i,n[4]=o,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n},Hn.fromScaling=function(n,t){return n[0]=t[0],n[1]=0,n[2]=0,n[3]=0,n[4]=t[1],n[5]=0,n[6]=0,n[7]=0,n[8]=1,n},Hn.fromMat2d=function(n,t){return n[0]=t[0],n[1]=t[1],n[2]=0,n[3]=t[2],n[4]=t[3],n[5]=0,n[6]=t[4],n[7]=t[5],n[8]=1,n},Hn.fromQuat=function(n,t){var i=t[0],o=t[1],c=t[2],u=t[3],d=i+i,p=o+o,g=c+c,_=i*d,v=o*d,b=o*p,S=c*d,E=c*p,A=c*g,C=u*d,P=u*p,k=u*g;return n[0]=1-b-A,n[3]=v-k,n[6]=S+P,n[1]=v+k,n[4]=1-_-A,n[7]=E-C,n[2]=S-P,n[5]=E+C,n[8]=1-_-b,n},Hn.normalFromMat4=function(n,t){var i=t[0],o=t[1],c=t[2],u=t[3],d=t[4],p=t[5],g=t[6],_=t[7],v=t[8],b=t[9],S=t[10],E=t[11],A=t[12],C=t[13],P=t[14],k=t[15],L=i*p-o*d,j=i*g-c*d,V=i*_-u*d,F=o*g-c*p,U=o*_-u*p,q=c*_-u*g,Z=v*C-b*A,X=v*P-S*A,J=v*k-E*A,rt=b*P-S*C,it=b*k-E*C,ut=S*k-E*P,tt=L*ut-j*it+V*rt+F*J-U*X+q*Z;return tt?(n[0]=(p*ut-g*it+_*rt)*(tt=1/tt),n[1]=(g*J-d*ut-_*X)*tt,n[2]=(d*it-p*J+_*Z)*tt,n[3]=(c*it-o*ut-u*rt)*tt,n[4]=(i*ut-c*J+u*X)*tt,n[5]=(o*J-i*it-u*Z)*tt,n[6]=(C*q-P*U+k*F)*tt,n[7]=(P*V-A*q-k*j)*tt,n[8]=(A*U-C*V+k*L)*tt,n):null},Hn.projection=function(n,t,i){return n[0]=2/t,n[1]=0,n[2]=0,n[3]=0,n[4]=-2/i,n[5]=0,n[6]=-1,n[7]=1,n[8]=1,n},Hn.str=function(n){return"mat3("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+", "+n[4]+", "+n[5]+", "+n[6]+", "+n[7]+", "+n[8]+")"},Hn.frob=function(n){return Math.hypot(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8])},Hn.add=function(n,t,i){return n[0]=t[0]+i[0],n[1]=t[1]+i[1],n[2]=t[2]+i[2],n[3]=t[3]+i[3],n[4]=t[4]+i[4],n[5]=t[5]+i[5],n[6]=t[6]+i[6],n[7]=t[7]+i[7],n[8]=t[8]+i[8],n},Hn.subtract=Ik,Hn.multiplyScalar=function(n,t,i){return n[0]=t[0]*i,n[1]=t[1]*i,n[2]=t[2]*i,n[3]=t[3]*i,n[4]=t[4]*i,n[5]=t[5]*i,n[6]=t[6]*i,n[7]=t[7]*i,n[8]=t[8]*i,n},Hn.multiplyScalarAndAdd=function(n,t,i,o){return n[0]=t[0]+i[0]*o,n[1]=t[1]+i[1]*o,n[2]=t[2]+i[2]*o,n[3]=t[3]+i[3]*o,n[4]=t[4]+i[4]*o,n[5]=t[5]+i[5]*o,n[6]=t[6]+i[6]*o,n[7]=t[7]+i[7]*o,n[8]=t[8]+i[8]*o,n},Hn.exactEquals=function(n,t){return n[0]===t[0]&&n[1]===t[1]&&n[2]===t[2]&&n[3]===t[3]&&n[4]===t[4]&&n[5]===t[5]&&n[6]===t[6]&&n[7]===t[7]&&n[8]===t[8]},Hn.equals=function(n,t){var i=n[0],o=n[1],c=n[2],u=n[3],d=n[4],p=n[5],g=n[6],_=n[7],v=n[8],b=t[0],S=t[1],E=t[2],A=t[3],C=t[4],P=t[5],k=t[6],L=t[7],j=t[8];return Math.abs(i-b)<=to.EPSILON*Math.max(1,Math.abs(i),Math.abs(b))&&Math.abs(o-S)<=to.EPSILON*Math.max(1,Math.abs(o),Math.abs(S))&&Math.abs(c-E)<=to.EPSILON*Math.max(1,Math.abs(c),Math.abs(E))&&Math.abs(u-A)<=to.EPSILON*Math.max(1,Math.abs(u),Math.abs(A))&&Math.abs(d-C)<=to.EPSILON*Math.max(1,Math.abs(d),Math.abs(C))&&Math.abs(p-P)<=to.EPSILON*Math.max(1,Math.abs(p),Math.abs(P))&&Math.abs(g-k)<=to.EPSILON*Math.max(1,Math.abs(g),Math.abs(k))&&Math.abs(_-L)<=to.EPSILON*Math.max(1,Math.abs(_),Math.abs(L))&&Math.abs(v-j)<=to.EPSILON*Math.max(1,Math.abs(v),Math.abs(j))},Hn.sub=Hn.mul=void 0;var to=function(n,t){if(n&&n.__esModule)return n;if(n===null||Hb(n)!=="object"&&typeof n!="function")return{default:n};var i=Ck(void 0);if(i&&i.has(n))return i.get(n);var o={},c=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in n)if(u!=="default"&&Object.prototype.hasOwnProperty.call(n,u)){var d=c?Object.getOwnPropertyDescriptor(n,u):null;d&&(d.get||d.set)?Object.defineProperty(o,u,d):o[u]=n[u]}return o.default=n,i&&i.set(n,o),o}(yi);function Ck(n){if(typeof WeakMap!="function")return null;var t=new WeakMap,i=new WeakMap;return(Ck=function(o){return o?i:t})(n)}function Pk(n,t,i){var o=t[0],c=t[1],u=t[2],d=t[3],p=t[4],g=t[5],_=t[6],v=t[7],b=t[8],S=i[0],E=i[1],A=i[2],C=i[3],P=i[4],k=i[5],L=i[6],j=i[7],V=i[8];return n[0]=S*o+E*d+A*_,n[1]=S*c+E*p+A*v,n[2]=S*u+E*g+A*b,n[3]=C*o+P*d+k*_,n[4]=C*c+P*p+k*v,n[5]=C*u+P*g+k*b,n[6]=L*o+j*d+V*_,n[7]=L*c+j*p+V*v,n[8]=L*u+j*g+V*b,n}function Ik(n,t,i){return n[0]=t[0]-i[0],n[1]=t[1]-i[1],n[2]=t[2]-i[2],n[3]=t[3]-i[3],n[4]=t[4]-i[4],n[5]=t[5]-i[5],n[6]=t[6]-i[6],n[7]=t[7]-i[7],n[8]=t[8]-i[8],n}Hn.mul=Pk,Hn.sub=Ik;var rn={};function qb(n){return qb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qb(n)}Object.defineProperty(rn,"__esModule",{value:!0}),rn.create=function(){var n=new Pr.ARRAY_TYPE(16);return Pr.ARRAY_TYPE!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0),n[0]=1,n[5]=1,n[10]=1,n[15]=1,n},rn.clone=function(n){var t=new Pr.ARRAY_TYPE(16);return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t},rn.copy=function(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n},rn.fromValues=function(n,t,i,o,c,u,d,p,g,_,v,b,S,E,A,C){var P=new Pr.ARRAY_TYPE(16);return P[0]=n,P[1]=t,P[2]=i,P[3]=o,P[4]=c,P[5]=u,P[6]=d,P[7]=p,P[8]=g,P[9]=_,P[10]=v,P[11]=b,P[12]=S,P[13]=E,P[14]=A,P[15]=C,P},rn.set=function(n,t,i,o,c,u,d,p,g,_,v,b,S,E,A,C,P){return n[0]=t,n[1]=i,n[2]=o,n[3]=c,n[4]=u,n[5]=d,n[6]=p,n[7]=g,n[8]=_,n[9]=v,n[10]=b,n[11]=S,n[12]=E,n[13]=A,n[14]=C,n[15]=P,n},rn.identity=Dk,rn.transpose=function(n,t){if(n===t){var i=t[1],o=t[2],c=t[3],u=t[6],d=t[7],p=t[11];n[1]=t[4],n[2]=t[8],n[3]=t[12],n[4]=i,n[6]=t[9],n[7]=t[13],n[8]=o,n[9]=u,n[11]=t[14],n[12]=c,n[13]=d,n[14]=p}else n[0]=t[0],n[1]=t[4],n[2]=t[8],n[3]=t[12],n[4]=t[1],n[5]=t[5],n[6]=t[9],n[7]=t[13],n[8]=t[2],n[9]=t[6],n[10]=t[10],n[11]=t[14],n[12]=t[3],n[13]=t[7],n[14]=t[11],n[15]=t[15];return n},rn.invert=function(n,t){var i=t[0],o=t[1],c=t[2],u=t[3],d=t[4],p=t[5],g=t[6],_=t[7],v=t[8],b=t[9],S=t[10],E=t[11],A=t[12],C=t[13],P=t[14],k=t[15],L=i*p-o*d,j=i*g-c*d,V=i*_-u*d,F=o*g-c*p,U=o*_-u*p,q=c*_-u*g,Z=v*C-b*A,X=v*P-S*A,J=v*k-E*A,rt=b*P-S*C,it=b*k-E*C,ut=S*k-E*P,tt=L*ut-j*it+V*rt+F*J-U*X+q*Z;return tt?(n[0]=(p*ut-g*it+_*rt)*(tt=1/tt),n[1]=(c*it-o*ut-u*rt)*tt,n[2]=(C*q-P*U+k*F)*tt,n[3]=(S*U-b*q-E*F)*tt,n[4]=(g*J-d*ut-_*X)*tt,n[5]=(i*ut-c*J+u*X)*tt,n[6]=(P*V-A*q-k*j)*tt,n[7]=(v*q-S*V+E*j)*tt,n[8]=(d*it-p*J+_*Z)*tt,n[9]=(o*J-i*it-u*Z)*tt,n[10]=(A*U-C*V+k*L)*tt,n[11]=(b*V-v*U-E*L)*tt,n[12]=(p*X-d*rt-g*Z)*tt,n[13]=(i*rt-o*X+c*Z)*tt,n[14]=(C*j-A*F-P*L)*tt,n[15]=(v*F-b*j+S*L)*tt,n):null},rn.adjoint=function(n,t){var i=t[0],o=t[1],c=t[2],u=t[3],d=t[4],p=t[5],g=t[6],_=t[7],v=t[8],b=t[9],S=t[10],E=t[11],A=t[12],C=t[13],P=t[14],k=t[15];return n[0]=p*(S*k-E*P)-b*(g*k-_*P)+C*(g*E-_*S),n[1]=-(o*(S*k-E*P)-b*(c*k-u*P)+C*(c*E-u*S)),n[2]=o*(g*k-_*P)-p*(c*k-u*P)+C*(c*_-u*g),n[3]=-(o*(g*E-_*S)-p*(c*E-u*S)+b*(c*_-u*g)),n[4]=-(d*(S*k-E*P)-v*(g*k-_*P)+A*(g*E-_*S)),n[5]=i*(S*k-E*P)-v*(c*k-u*P)+A*(c*E-u*S),n[6]=-(i*(g*k-_*P)-d*(c*k-u*P)+A*(c*_-u*g)),n[7]=i*(g*E-_*S)-d*(c*E-u*S)+v*(c*_-u*g),n[8]=d*(b*k-E*C)-v*(p*k-_*C)+A*(p*E-_*b),n[9]=-(i*(b*k-E*C)-v*(o*k-u*C)+A*(o*E-u*b)),n[10]=i*(p*k-_*C)-d*(o*k-u*C)+A*(o*_-u*p),n[11]=-(i*(p*E-_*b)-d*(o*E-u*b)+v*(o*_-u*p)),n[12]=-(d*(b*P-S*C)-v*(p*P-g*C)+A*(p*S-g*b)),n[13]=i*(b*P-S*C)-v*(o*P-c*C)+A*(o*S-c*b),n[14]=-(i*(p*P-g*C)-d*(o*P-c*C)+A*(o*g-c*p)),n[15]=i*(p*S-g*b)-d*(o*S-c*b)+v*(o*g-c*p),n},rn.determinant=function(n){var t=n[0],i=n[1],o=n[2],c=n[3],u=n[4],d=n[5],p=n[6],g=n[7],_=n[8],v=n[9],b=n[10],S=n[11],E=n[12],A=n[13],C=n[14],P=n[15];return(t*d-i*u)*(b*P-S*C)-(t*p-o*u)*(v*P-S*A)+(t*g-c*u)*(v*C-b*A)+(i*p-o*d)*(_*P-S*E)-(i*g-c*d)*(_*C-b*E)+(o*g-c*p)*(_*A-v*E)},rn.multiply=Rk,rn.translate=function(n,t,i){var o,c,u,d,p,g,_,v,b,S,E,A,C=i[0],P=i[1],k=i[2];return t===n?(n[12]=t[0]*C+t[4]*P+t[8]*k+t[12],n[13]=t[1]*C+t[5]*P+t[9]*k+t[13],n[14]=t[2]*C+t[6]*P+t[10]*k+t[14],n[15]=t[3]*C+t[7]*P+t[11]*k+t[15]):(c=t[1],u=t[2],d=t[3],p=t[4],g=t[5],_=t[6],v=t[7],b=t[8],S=t[9],E=t[10],A=t[11],n[0]=o=t[0],n[1]=c,n[2]=u,n[3]=d,n[4]=p,n[5]=g,n[6]=_,n[7]=v,n[8]=b,n[9]=S,n[10]=E,n[11]=A,n[12]=o*C+p*P+b*k+t[12],n[13]=c*C+g*P+S*k+t[13],n[14]=u*C+_*P+E*k+t[14],n[15]=d*C+v*P+A*k+t[15]),n},rn.scale=function(n,t,i){var o=i[0],c=i[1],u=i[2];return n[0]=t[0]*o,n[1]=t[1]*o,n[2]=t[2]*o,n[3]=t[3]*o,n[4]=t[4]*c,n[5]=t[5]*c,n[6]=t[6]*c,n[7]=t[7]*c,n[8]=t[8]*u,n[9]=t[9]*u,n[10]=t[10]*u,n[11]=t[11]*u,n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n},rn.rotate=function(n,t,i,o){var c,u,d,p,g,_,v,b,S,E,A,C,P,k,L,j,V,F,U,q,Z,X,J,rt,it=o[0],ut=o[1],tt=o[2],dt=Math.hypot(it,ut,tt);return dt<Pr.EPSILON?null:(it*=dt=1/dt,ut*=dt,tt*=dt,c=Math.sin(i),u=Math.cos(i),g=t[1],_=t[2],v=t[3],S=t[5],E=t[6],A=t[7],P=t[9],k=t[10],L=t[11],U=it*ut*(d=1-u)-tt*c,q=ut*ut*d+u,Z=tt*ut*d+it*c,X=it*tt*d+ut*c,J=ut*tt*d-it*c,rt=tt*tt*d+u,n[0]=(p=t[0])*(j=it*it*d+u)+(b=t[4])*(V=ut*it*d+tt*c)+(C=t[8])*(F=tt*it*d-ut*c),n[1]=g*j+S*V+P*F,n[2]=_*j+E*V+k*F,n[3]=v*j+A*V+L*F,n[4]=p*U+b*q+C*Z,n[5]=g*U+S*q+P*Z,n[6]=_*U+E*q+k*Z,n[7]=v*U+A*q+L*Z,n[8]=p*X+b*J+C*rt,n[9]=g*X+S*J+P*rt,n[10]=_*X+E*J+k*rt,n[11]=v*X+A*J+L*rt,t!==n&&(n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n)},rn.rotateX=function(n,t,i){var o=Math.sin(i),c=Math.cos(i),u=t[4],d=t[5],p=t[6],g=t[7],_=t[8],v=t[9],b=t[10],S=t[11];return t!==n&&(n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[4]=u*c+_*o,n[5]=d*c+v*o,n[6]=p*c+b*o,n[7]=g*c+S*o,n[8]=_*c-u*o,n[9]=v*c-d*o,n[10]=b*c-p*o,n[11]=S*c-g*o,n},rn.rotateY=function(n,t,i){var o=Math.sin(i),c=Math.cos(i),u=t[0],d=t[1],p=t[2],g=t[3],_=t[8],v=t[9],b=t[10],S=t[11];return t!==n&&(n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[0]=u*c-_*o,n[1]=d*c-v*o,n[2]=p*c-b*o,n[3]=g*c-S*o,n[8]=u*o+_*c,n[9]=d*o+v*c,n[10]=p*o+b*c,n[11]=g*o+S*c,n},rn.rotateZ=function(n,t,i){var o=Math.sin(i),c=Math.cos(i),u=t[0],d=t[1],p=t[2],g=t[3],_=t[4],v=t[5],b=t[6],S=t[7];return t!==n&&(n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[0]=u*c+_*o,n[1]=d*c+v*o,n[2]=p*c+b*o,n[3]=g*c+S*o,n[4]=_*c-u*o,n[5]=v*c-d*o,n[6]=b*c-p*o,n[7]=S*c-g*o,n},rn.fromTranslation=function(n,t){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=t[0],n[13]=t[1],n[14]=t[2],n[15]=1,n},rn.fromScaling=function(n,t){return n[0]=t[0],n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=t[1],n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=t[2],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},rn.fromRotation=function(n,t,i){var o,c,u,d=i[0],p=i[1],g=i[2],_=Math.hypot(d,p,g);return _<Pr.EPSILON?null:(d*=_=1/_,p*=_,g*=_,o=Math.sin(t),c=Math.cos(t),n[0]=d*d*(u=1-c)+c,n[1]=p*d*u+g*o,n[2]=g*d*u-p*o,n[3]=0,n[4]=d*p*u-g*o,n[5]=p*p*u+c,n[6]=g*p*u+d*o,n[7]=0,n[8]=d*g*u+p*o,n[9]=p*g*u-d*o,n[10]=g*g*u+c,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n)},rn.fromXRotation=function(n,t){var i=Math.sin(t),o=Math.cos(t);return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=o,n[6]=i,n[7]=0,n[8]=0,n[9]=-i,n[10]=o,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},rn.fromYRotation=function(n,t){var i=Math.sin(t),o=Math.cos(t);return n[0]=o,n[1]=0,n[2]=-i,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=i,n[9]=0,n[10]=o,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},rn.fromZRotation=function(n,t){var i=Math.sin(t),o=Math.cos(t);return n[0]=o,n[1]=i,n[2]=0,n[3]=0,n[4]=-i,n[5]=o,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},rn.fromRotationTranslation=Ok,rn.fromQuat2=function(n,t){var i=new Pr.ARRAY_TYPE(3),o=-t[0],c=-t[1],u=-t[2],d=t[3],p=t[4],g=t[5],_=t[6],v=t[7],b=o*o+c*c+u*u+d*d;return b>0?(i[0]=2*(p*d+v*o+g*u-_*c)/b,i[1]=2*(g*d+v*c+_*o-p*u)/b,i[2]=2*(_*d+v*u+p*c-g*o)/b):(i[0]=2*(p*d+v*o+g*u-_*c),i[1]=2*(g*d+v*c+_*o-p*u),i[2]=2*(_*d+v*u+p*c-g*o)),Ok(n,t,i),n},rn.getTranslation=function(n,t){return n[0]=t[12],n[1]=t[13],n[2]=t[14],n},rn.getScaling=Lk,rn.getRotation=function(n,t){var i=new Pr.ARRAY_TYPE(3);Lk(i,t);var o=1/i[0],c=1/i[1],u=1/i[2],d=t[0]*o,p=t[1]*c,g=t[2]*u,_=t[4]*o,v=t[5]*c,b=t[6]*u,S=t[8]*o,E=t[9]*c,A=t[10]*u,C=d+v+A,P=0;return C>0?(P=2*Math.sqrt(C+1),n[3]=.25*P,n[0]=(b-E)/P,n[1]=(S-g)/P,n[2]=(p-_)/P):d>v&&d>A?(P=2*Math.sqrt(1+d-v-A),n[3]=(b-E)/P,n[0]=.25*P,n[1]=(p+_)/P,n[2]=(S+g)/P):v>A?(P=2*Math.sqrt(1+v-d-A),n[3]=(S-g)/P,n[0]=(p+_)/P,n[1]=.25*P,n[2]=(b+E)/P):(P=2*Math.sqrt(1+A-d-v),n[3]=(p-_)/P,n[0]=(S+g)/P,n[1]=(b+E)/P,n[2]=.25*P),n},rn.fromRotationTranslationScale=function(n,t,i,o){var c=t[0],u=t[1],d=t[2],p=t[3],g=c+c,_=u+u,v=d+d,b=c*g,S=c*_,E=c*v,A=u*_,C=u*v,P=d*v,k=p*g,L=p*_,j=p*v,V=o[0],F=o[1],U=o[2];return n[0]=(1-(A+P))*V,n[1]=(S+j)*V,n[2]=(E-L)*V,n[3]=0,n[4]=(S-j)*F,n[5]=(1-(b+P))*F,n[6]=(C+k)*F,n[7]=0,n[8]=(E+L)*U,n[9]=(C-k)*U,n[10]=(1-(b+A))*U,n[11]=0,n[12]=i[0],n[13]=i[1],n[14]=i[2],n[15]=1,n},rn.fromRotationTranslationScaleOrigin=function(n,t,i,o,c){var u=t[0],d=t[1],p=t[2],g=t[3],_=u+u,v=d+d,b=p+p,S=u*_,E=u*v,A=u*b,C=d*v,P=d*b,k=p*b,L=g*_,j=g*v,V=g*b,F=o[0],U=o[1],q=o[2],Z=c[0],X=c[1],J=c[2],rt=(1-(C+k))*F,it=(E+V)*F,ut=(A-j)*F,tt=(E-V)*U,dt=(1-(S+k))*U,gt=(P+L)*U,xt=(A+j)*q,ht=(P-L)*q,pt=(1-(S+C))*q;return n[0]=rt,n[1]=it,n[2]=ut,n[3]=0,n[4]=tt,n[5]=dt,n[6]=gt,n[7]=0,n[8]=xt,n[9]=ht,n[10]=pt,n[11]=0,n[12]=i[0]+Z-(rt*Z+tt*X+xt*J),n[13]=i[1]+X-(it*Z+dt*X+ht*J),n[14]=i[2]+J-(ut*Z+gt*X+pt*J),n[15]=1,n},rn.fromQuat=function(n,t){var i=t[0],o=t[1],c=t[2],u=t[3],d=i+i,p=o+o,g=c+c,_=i*d,v=o*d,b=o*p,S=c*d,E=c*p,A=c*g,C=u*d,P=u*p,k=u*g;return n[0]=1-b-A,n[1]=v+k,n[2]=S-P,n[3]=0,n[4]=v-k,n[5]=1-_-A,n[6]=E+C,n[7]=0,n[8]=S+P,n[9]=E-C,n[10]=1-_-b,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},rn.frustum=function(n,t,i,o,c,u,d){var p=1/(i-t),g=1/(c-o),_=1/(u-d);return n[0]=2*u*p,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=2*u*g,n[6]=0,n[7]=0,n[8]=(i+t)*p,n[9]=(c+o)*g,n[10]=(d+u)*_,n[11]=-1,n[12]=0,n[13]=0,n[14]=d*u*2*_,n[15]=0,n},rn.perspectiveNO=zk,rn.perspectiveZO=function(n,t,i,o,c){var u,d=1/Math.tan(t/2);return n[0]=d/i,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=d,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,c!=null&&c!==1/0?(n[10]=c*(u=1/(o-c)),n[14]=c*o*u):(n[10]=-1,n[14]=-o),n},rn.perspectiveFromFieldOfView=function(n,t,i,o){var c=Math.tan(t.upDegrees*Math.PI/180),u=Math.tan(t.downDegrees*Math.PI/180),d=Math.tan(t.leftDegrees*Math.PI/180),p=Math.tan(t.rightDegrees*Math.PI/180),g=2/(d+p),_=2/(c+u);return n[0]=g,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=_,n[6]=0,n[7]=0,n[8]=-(d-p)*g*.5,n[9]=(c-u)*_*.5,n[10]=o/(i-o),n[11]=-1,n[12]=0,n[13]=0,n[14]=o*i/(i-o),n[15]=0,n},rn.orthoNO=Nk,rn.orthoZO=function(n,t,i,o,c,u,d){var p=1/(t-i),g=1/(o-c),_=1/(u-d);return n[0]=-2*p,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*g,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=_,n[11]=0,n[12]=(t+i)*p,n[13]=(c+o)*g,n[14]=u*_,n[15]=1,n},rn.lookAt=function(n,t,i,o){var c,u,d,p,g,_,v,b,S,E,A=t[0],C=t[1],P=t[2],k=o[0],L=o[1],j=o[2],V=i[0],F=i[1],U=i[2];return Math.abs(A-V)<Pr.EPSILON&&Math.abs(C-F)<Pr.EPSILON&&Math.abs(P-U)<Pr.EPSILON?Dk(n):(v=A-V,b=C-F,S=P-U,c=L*(S*=E=1/Math.hypot(v,b,S))-j*(b*=E),u=j*(v*=E)-k*S,d=k*b-L*v,(E=Math.hypot(c,u,d))?(c*=E=1/E,u*=E,d*=E):(c=0,u=0,d=0),p=b*d-S*u,g=S*c-v*d,_=v*u-b*c,(E=Math.hypot(p,g,_))?(p*=E=1/E,g*=E,_*=E):(p=0,g=0,_=0),n[0]=c,n[1]=p,n[2]=v,n[3]=0,n[4]=u,n[5]=g,n[6]=b,n[7]=0,n[8]=d,n[9]=_,n[10]=S,n[11]=0,n[12]=-(c*A+u*C+d*P),n[13]=-(p*A+g*C+_*P),n[14]=-(v*A+b*C+S*P),n[15]=1,n)},rn.targetTo=function(n,t,i,o){var c=t[0],u=t[1],d=t[2],p=o[0],g=o[1],_=o[2],v=c-i[0],b=u-i[1],S=d-i[2],E=v*v+b*b+S*S;E>0&&(v*=E=1/Math.sqrt(E),b*=E,S*=E);var A=g*S-_*b,C=_*v-p*S,P=p*b-g*v;return(E=A*A+C*C+P*P)>0&&(A*=E=1/Math.sqrt(E),C*=E,P*=E),n[0]=A,n[1]=C,n[2]=P,n[3]=0,n[4]=b*P-S*C,n[5]=S*A-v*P,n[6]=v*C-b*A,n[7]=0,n[8]=v,n[9]=b,n[10]=S,n[11]=0,n[12]=c,n[13]=u,n[14]=d,n[15]=1,n},rn.str=function(n){return"mat4("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+", "+n[4]+", "+n[5]+", "+n[6]+", "+n[7]+", "+n[8]+", "+n[9]+", "+n[10]+", "+n[11]+", "+n[12]+", "+n[13]+", "+n[14]+", "+n[15]+")"},rn.frob=function(n){return Math.hypot(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],n[9],n[10],n[11],n[12],n[13],n[14],n[15])},rn.add=function(n,t,i){return n[0]=t[0]+i[0],n[1]=t[1]+i[1],n[2]=t[2]+i[2],n[3]=t[3]+i[3],n[4]=t[4]+i[4],n[5]=t[5]+i[5],n[6]=t[6]+i[6],n[7]=t[7]+i[7],n[8]=t[8]+i[8],n[9]=t[9]+i[9],n[10]=t[10]+i[10],n[11]=t[11]+i[11],n[12]=t[12]+i[12],n[13]=t[13]+i[13],n[14]=t[14]+i[14],n[15]=t[15]+i[15],n},rn.subtract=Fk,rn.multiplyScalar=function(n,t,i){return n[0]=t[0]*i,n[1]=t[1]*i,n[2]=t[2]*i,n[3]=t[3]*i,n[4]=t[4]*i,n[5]=t[5]*i,n[6]=t[6]*i,n[7]=t[7]*i,n[8]=t[8]*i,n[9]=t[9]*i,n[10]=t[10]*i,n[11]=t[11]*i,n[12]=t[12]*i,n[13]=t[13]*i,n[14]=t[14]*i,n[15]=t[15]*i,n},rn.multiplyScalarAndAdd=function(n,t,i,o){return n[0]=t[0]+i[0]*o,n[1]=t[1]+i[1]*o,n[2]=t[2]+i[2]*o,n[3]=t[3]+i[3]*o,n[4]=t[4]+i[4]*o,n[5]=t[5]+i[5]*o,n[6]=t[6]+i[6]*o,n[7]=t[7]+i[7]*o,n[8]=t[8]+i[8]*o,n[9]=t[9]+i[9]*o,n[10]=t[10]+i[10]*o,n[11]=t[11]+i[11]*o,n[12]=t[12]+i[12]*o,n[13]=t[13]+i[13]*o,n[14]=t[14]+i[14]*o,n[15]=t[15]+i[15]*o,n},rn.exactEquals=function(n,t){return n[0]===t[0]&&n[1]===t[1]&&n[2]===t[2]&&n[3]===t[3]&&n[4]===t[4]&&n[5]===t[5]&&n[6]===t[6]&&n[7]===t[7]&&n[8]===t[8]&&n[9]===t[9]&&n[10]===t[10]&&n[11]===t[11]&&n[12]===t[12]&&n[13]===t[13]&&n[14]===t[14]&&n[15]===t[15]},rn.equals=function(n,t){var i=n[0],o=n[1],c=n[2],u=n[3],d=n[4],p=n[5],g=n[6],_=n[7],v=n[8],b=n[9],S=n[10],E=n[11],A=n[12],C=n[13],P=n[14],k=n[15],L=t[0],j=t[1],V=t[2],F=t[3],U=t[4],q=t[5],Z=t[6],X=t[7],J=t[8],rt=t[9],it=t[10],ut=t[11],tt=t[12],dt=t[13],gt=t[14],xt=t[15];return Math.abs(i-L)<=Pr.EPSILON*Math.max(1,Math.abs(i),Math.abs(L))&&Math.abs(o-j)<=Pr.EPSILON*Math.max(1,Math.abs(o),Math.abs(j))&&Math.abs(c-V)<=Pr.EPSILON*Math.max(1,Math.abs(c),Math.abs(V))&&Math.abs(u-F)<=Pr.EPSILON*Math.max(1,Math.abs(u),Math.abs(F))&&Math.abs(d-U)<=Pr.EPSILON*Math.max(1,Math.abs(d),Math.abs(U))&&Math.abs(p-q)<=Pr.EPSILON*Math.max(1,Math.abs(p),Math.abs(q))&&Math.abs(g-Z)<=Pr.EPSILON*Math.max(1,Math.abs(g),Math.abs(Z))&&Math.abs(_-X)<=Pr.EPSILON*Math.max(1,Math.abs(_),Math.abs(X))&&Math.abs(v-J)<=Pr.EPSILON*Math.max(1,Math.abs(v),Math.abs(J))&&Math.abs(b-rt)<=Pr.EPSILON*Math.max(1,Math.abs(b),Math.abs(rt))&&Math.abs(S-it)<=Pr.EPSILON*Math.max(1,Math.abs(S),Math.abs(it))&&Math.abs(E-ut)<=Pr.EPSILON*Math.max(1,Math.abs(E),Math.abs(ut))&&Math.abs(A-tt)<=Pr.EPSILON*Math.max(1,Math.abs(A),Math.abs(tt))&&Math.abs(C-dt)<=Pr.EPSILON*Math.max(1,Math.abs(C),Math.abs(dt))&&Math.abs(P-gt)<=Pr.EPSILON*Math.max(1,Math.abs(P),Math.abs(gt))&&Math.abs(k-xt)<=Pr.EPSILON*Math.max(1,Math.abs(k),Math.abs(xt))},rn.sub=rn.mul=rn.ortho=rn.perspective=void 0;var Pr=function(n,t){if(n&&n.__esModule)return n;if(n===null||qb(n)!=="object"&&typeof n!="function")return{default:n};var i=kk(void 0);if(i&&i.has(n))return i.get(n);var o={},c=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in n)if(u!=="default"&&Object.prototype.hasOwnProperty.call(n,u)){var d=c?Object.getOwnPropertyDescriptor(n,u):null;d&&(d.get||d.set)?Object.defineProperty(o,u,d):o[u]=n[u]}return o.default=n,i&&i.set(n,o),o}(yi);function kk(n){if(typeof WeakMap!="function")return null;var t=new WeakMap,i=new WeakMap;return(kk=function(o){return o?i:t})(n)}function Dk(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Rk(n,t,i){var o=t[0],c=t[1],u=t[2],d=t[3],p=t[4],g=t[5],_=t[6],v=t[7],b=t[8],S=t[9],E=t[10],A=t[11],C=t[12],P=t[13],k=t[14],L=t[15],j=i[0],V=i[1],F=i[2],U=i[3];return n[0]=j*o+V*p+F*b+U*C,n[1]=j*c+V*g+F*S+U*P,n[2]=j*u+V*_+F*E+U*k,n[3]=j*d+V*v+F*A+U*L,n[4]=(j=i[4])*o+(V=i[5])*p+(F=i[6])*b+(U=i[7])*C,n[5]=j*c+V*g+F*S+U*P,n[6]=j*u+V*_+F*E+U*k,n[7]=j*d+V*v+F*A+U*L,n[8]=(j=i[8])*o+(V=i[9])*p+(F=i[10])*b+(U=i[11])*C,n[9]=j*c+V*g+F*S+U*P,n[10]=j*u+V*_+F*E+U*k,n[11]=j*d+V*v+F*A+U*L,n[12]=(j=i[12])*o+(V=i[13])*p+(F=i[14])*b+(U=i[15])*C,n[13]=j*c+V*g+F*S+U*P,n[14]=j*u+V*_+F*E+U*k,n[15]=j*d+V*v+F*A+U*L,n}function Ok(n,t,i){var o=t[0],c=t[1],u=t[2],d=t[3],p=o+o,g=c+c,_=u+u,v=o*p,b=o*g,S=o*_,E=c*g,A=c*_,C=u*_,P=d*p,k=d*g,L=d*_;return n[0]=1-(E+C),n[1]=b+L,n[2]=S-k,n[3]=0,n[4]=b-L,n[5]=1-(v+C),n[6]=A+P,n[7]=0,n[8]=S+k,n[9]=A-P,n[10]=1-(v+E),n[11]=0,n[12]=i[0],n[13]=i[1],n[14]=i[2],n[15]=1,n}function Lk(n,t){var i=t[4],o=t[5],c=t[6],u=t[8],d=t[9],p=t[10];return n[0]=Math.hypot(t[0],t[1],t[2]),n[1]=Math.hypot(i,o,c),n[2]=Math.hypot(u,d,p),n}function zk(n,t,i,o,c){var u,d=1/Math.tan(t/2);return n[0]=d/i,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=d,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,c!=null&&c!==1/0?(n[10]=(c+o)*(u=1/(o-c)),n[14]=2*c*o*u):(n[10]=-1,n[14]=-2*o),n}function Nk(n,t,i,o,c,u,d){var p=1/(t-i),g=1/(o-c),_=1/(u-d);return n[0]=-2*p,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*g,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*_,n[11]=0,n[12]=(t+i)*p,n[13]=(c+o)*g,n[14]=(d+u)*_,n[15]=1,n}function Fk(n,t,i){return n[0]=t[0]-i[0],n[1]=t[1]-i[1],n[2]=t[2]-i[2],n[3]=t[3]-i[3],n[4]=t[4]-i[4],n[5]=t[5]-i[5],n[6]=t[6]-i[6],n[7]=t[7]-i[7],n[8]=t[8]-i[8],n[9]=t[9]-i[9],n[10]=t[10]-i[10],n[11]=t[11]-i[11],n[12]=t[12]-i[12],n[13]=t[13]-i[13],n[14]=t[14]-i[14],n[15]=t[15]-i[15],n}rn.perspective=zk,rn.ortho=Nk,rn.mul=Rk,rn.sub=Fk;var Je={},nn={};function Zb(n){return Zb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zb(n)}Object.defineProperty(nn,"__esModule",{value:!0}),nn.create=jk,nn.clone=function(n){var t=new al.ARRAY_TYPE(3);return t[0]=n[0],t[1]=n[1],t[2]=n[2],t},nn.length=Vk,nn.fromValues=function(n,t,i){var o=new al.ARRAY_TYPE(3);return o[0]=n,o[1]=t,o[2]=i,o},nn.copy=function(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n},nn.set=function(n,t,i,o){return n[0]=t,n[1]=i,n[2]=o,n},nn.add=function(n,t,i){return n[0]=t[0]+i[0],n[1]=t[1]+i[1],n[2]=t[2]+i[2],n},nn.subtract=Uk,nn.multiply=$k,nn.divide=Gk,nn.ceil=function(n,t){return n[0]=Math.ceil(t[0]),n[1]=Math.ceil(t[1]),n[2]=Math.ceil(t[2]),n},nn.floor=function(n,t){return n[0]=Math.floor(t[0]),n[1]=Math.floor(t[1]),n[2]=Math.floor(t[2]),n},nn.min=function(n,t,i){return n[0]=Math.min(t[0],i[0]),n[1]=Math.min(t[1],i[1]),n[2]=Math.min(t[2],i[2]),n},nn.max=function(n,t,i){return n[0]=Math.max(t[0],i[0]),n[1]=Math.max(t[1],i[1]),n[2]=Math.max(t[2],i[2]),n},nn.round=function(n,t){return n[0]=Math.round(t[0]),n[1]=Math.round(t[1]),n[2]=Math.round(t[2]),n},nn.scale=function(n,t,i){return n[0]=t[0]*i,n[1]=t[1]*i,n[2]=t[2]*i,n},nn.scaleAndAdd=function(n,t,i,o){return n[0]=t[0]+i[0]*o,n[1]=t[1]+i[1]*o,n[2]=t[2]+i[2]*o,n},nn.distance=Wk,nn.squaredDistance=Hk,nn.squaredLength=qk,nn.negate=function(n,t){return n[0]=-t[0],n[1]=-t[1],n[2]=-t[2],n},nn.inverse=function(n,t){return n[0]=1/t[0],n[1]=1/t[1],n[2]=1/t[2],n},nn.normalize=function(n,t){var i=t[0],o=t[1],c=t[2],u=i*i+o*o+c*c;return u>0&&(u=1/Math.sqrt(u)),n[0]=t[0]*u,n[1]=t[1]*u,n[2]=t[2]*u,n},nn.dot=Zk,nn.cross=function(n,t,i){var o=t[0],c=t[1],u=t[2],d=i[0],p=i[1],g=i[2];return n[0]=c*g-u*p,n[1]=u*d-o*g,n[2]=o*p-c*d,n},nn.lerp=function(n,t,i,o){var c=t[0],u=t[1],d=t[2];return n[0]=c+o*(i[0]-c),n[1]=u+o*(i[1]-u),n[2]=d+o*(i[2]-d),n},nn.hermite=function(n,t,i,o,c,u){var d=u*u,p=d*(2*u-3)+1,g=d*(u-2)+u,_=d*(u-1),v=d*(3-2*u);return n[0]=t[0]*p+i[0]*g+o[0]*_+c[0]*v,n[1]=t[1]*p+i[1]*g+o[1]*_+c[1]*v,n[2]=t[2]*p+i[2]*g+o[2]*_+c[2]*v,n},nn.bezier=function(n,t,i,o,c,u){var d=1-u,p=d*d,g=u*u,_=p*d,v=3*u*p,b=3*g*d,S=g*u;return n[0]=t[0]*_+i[0]*v+o[0]*b+c[0]*S,n[1]=t[1]*_+i[1]*v+o[1]*b+c[1]*S,n[2]=t[2]*_+i[2]*v+o[2]*b+c[2]*S,n},nn.random=function(n,t){t=t||1;var i=2*al.RANDOM()*Math.PI,o=2*al.RANDOM()-1,c=Math.sqrt(1-o*o)*t;return n[0]=Math.cos(i)*c,n[1]=Math.sin(i)*c,n[2]=o*t,n},nn.transformMat4=function(n,t,i){var o=t[0],c=t[1],u=t[2],d=i[3]*o+i[7]*c+i[11]*u+i[15];return n[0]=(i[0]*o+i[4]*c+i[8]*u+i[12])/(d=d||1),n[1]=(i[1]*o+i[5]*c+i[9]*u+i[13])/d,n[2]=(i[2]*o+i[6]*c+i[10]*u+i[14])/d,n},nn.transformMat3=function(n,t,i){var o=t[0],c=t[1],u=t[2];return n[0]=o*i[0]+c*i[3]+u*i[6],n[1]=o*i[1]+c*i[4]+u*i[7],n[2]=o*i[2]+c*i[5]+u*i[8],n},nn.transformQuat=function(n,t,i){var o=i[0],c=i[1],u=i[2],d=t[0],p=t[1],g=t[2],_=c*g-u*p,v=u*d-o*g,b=o*p-c*d,S=c*b-u*v,E=u*_-o*b,A=o*v-c*_,C=2*i[3];return v*=C,b*=C,E*=2,A*=2,n[0]=d+(_*=C)+(S*=2),n[1]=p+v+E,n[2]=g+b+A,n},nn.rotateX=function(n,t,i,o){var c=[],u=[];return c[0]=t[0]-i[0],c[1]=t[1]-i[1],c[2]=t[2]-i[2],u[0]=c[0],u[1]=c[1]*Math.cos(o)-c[2]*Math.sin(o),u[2]=c[1]*Math.sin(o)+c[2]*Math.cos(o),n[0]=u[0]+i[0],n[1]=u[1]+i[1],n[2]=u[2]+i[2],n},nn.rotateY=function(n,t,i,o){var c=[],u=[];return c[0]=t[0]-i[0],c[1]=t[1]-i[1],c[2]=t[2]-i[2],u[0]=c[2]*Math.sin(o)+c[0]*Math.cos(o),u[1]=c[1],u[2]=c[2]*Math.cos(o)-c[0]*Math.sin(o),n[0]=u[0]+i[0],n[1]=u[1]+i[1],n[2]=u[2]+i[2],n},nn.rotateZ=function(n,t,i,o){var c=[],u=[];return c[0]=t[0]-i[0],c[1]=t[1]-i[1],c[2]=t[2]-i[2],u[0]=c[0]*Math.cos(o)-c[1]*Math.sin(o),u[1]=c[0]*Math.sin(o)+c[1]*Math.cos(o),u[2]=c[2],n[0]=u[0]+i[0],n[1]=u[1]+i[1],n[2]=u[2]+i[2],n},nn.angle=function(n,t){var i=n[0],o=n[1],c=n[2],u=t[0],d=t[1],p=t[2],g=Math.sqrt(i*i+o*o+c*c)*Math.sqrt(u*u+d*d+p*p),_=g&&Zk(n,t)/g;return Math.acos(Math.min(Math.max(_,-1),1))},nn.zero=function(n){return n[0]=0,n[1]=0,n[2]=0,n},nn.str=function(n){return"vec3("+n[0]+", "+n[1]+", "+n[2]+")"},nn.exactEquals=function(n,t){return n[0]===t[0]&&n[1]===t[1]&&n[2]===t[2]},nn.equals=function(n,t){var i=n[0],o=n[1],c=n[2],u=t[0],d=t[1],p=t[2];return Math.abs(i-u)<=al.EPSILON*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-d)<=al.EPSILON*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(c-p)<=al.EPSILON*Math.max(1,Math.abs(c),Math.abs(p))},nn.forEach=nn.sqrLen=nn.len=nn.sqrDist=nn.dist=nn.div=nn.mul=nn.sub=void 0;var al=function(n,t){if(n&&n.__esModule)return n;if(n===null||Zb(n)!=="object"&&typeof n!="function")return{default:n};var i=Bk(void 0);if(i&&i.has(n))return i.get(n);var o={},c=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in n)if(u!=="default"&&Object.prototype.hasOwnProperty.call(n,u)){var d=c?Object.getOwnPropertyDescriptor(n,u):null;d&&(d.get||d.set)?Object.defineProperty(o,u,d):o[u]=n[u]}return o.default=n,i&&i.set(n,o),o}(yi);function Bk(n){if(typeof WeakMap!="function")return null;var t=new WeakMap,i=new WeakMap;return(Bk=function(o){return o?i:t})(n)}function jk(){var n=new al.ARRAY_TYPE(3);return al.ARRAY_TYPE!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function Vk(n){return Math.hypot(n[0],n[1],n[2])}function Uk(n,t,i){return n[0]=t[0]-i[0],n[1]=t[1]-i[1],n[2]=t[2]-i[2],n}function $k(n,t,i){return n[0]=t[0]*i[0],n[1]=t[1]*i[1],n[2]=t[2]*i[2],n}function Gk(n,t,i){return n[0]=t[0]/i[0],n[1]=t[1]/i[1],n[2]=t[2]/i[2],n}function Wk(n,t){return Math.hypot(t[0]-n[0],t[1]-n[1],t[2]-n[2])}function Hk(n,t){var i=t[0]-n[0],o=t[1]-n[1],c=t[2]-n[2];return i*i+o*o+c*c}function qk(n){var t=n[0],i=n[1],o=n[2];return t*t+i*i+o*o}function Zk(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}nn.sub=Uk,nn.mul=$k,nn.div=Gk,nn.dist=Wk,nn.sqrDist=Hk,nn.len=Vk,nn.sqrLen=qk;var ll,w9=(ll=jk(),function(n,t,i,o,c,u){var d,p;for(t||(t=3),i||(i=0),p=o?Math.min(o*t+i,n.length):n.length,d=i;d<p;d+=t)ll[0]=n[d],ll[1]=n[d+1],ll[2]=n[d+2],c(ll,ll,u),n[d]=ll[0],n[d+1]=ll[1],n[d+2]=ll[2];return n});nn.forEach=w9;var mn={};function Xb(n){return Xb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xb(n)}Object.defineProperty(mn,"__esModule",{value:!0}),mn.create=Yk,mn.clone=function(n){var t=new Eo.ARRAY_TYPE(4);return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t},mn.fromValues=function(n,t,i,o){var c=new Eo.ARRAY_TYPE(4);return c[0]=n,c[1]=t,c[2]=i,c[3]=o,c},mn.copy=function(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n},mn.set=function(n,t,i,o,c){return n[0]=t,n[1]=i,n[2]=o,n[3]=c,n},mn.add=function(n,t,i){return n[0]=t[0]+i[0],n[1]=t[1]+i[1],n[2]=t[2]+i[2],n[3]=t[3]+i[3],n},mn.subtract=Kk,mn.multiply=Jk,mn.divide=Qk,mn.ceil=function(n,t){return n[0]=Math.ceil(t[0]),n[1]=Math.ceil(t[1]),n[2]=Math.ceil(t[2]),n[3]=Math.ceil(t[3]),n},mn.floor=function(n,t){return n[0]=Math.floor(t[0]),n[1]=Math.floor(t[1]),n[2]=Math.floor(t[2]),n[3]=Math.floor(t[3]),n},mn.min=function(n,t,i){return n[0]=Math.min(t[0],i[0]),n[1]=Math.min(t[1],i[1]),n[2]=Math.min(t[2],i[2]),n[3]=Math.min(t[3],i[3]),n},mn.max=function(n,t,i){return n[0]=Math.max(t[0],i[0]),n[1]=Math.max(t[1],i[1]),n[2]=Math.max(t[2],i[2]),n[3]=Math.max(t[3],i[3]),n},mn.round=function(n,t){return n[0]=Math.round(t[0]),n[1]=Math.round(t[1]),n[2]=Math.round(t[2]),n[3]=Math.round(t[3]),n},mn.scale=function(n,t,i){return n[0]=t[0]*i,n[1]=t[1]*i,n[2]=t[2]*i,n[3]=t[3]*i,n},mn.scaleAndAdd=function(n,t,i,o){return n[0]=t[0]+i[0]*o,n[1]=t[1]+i[1]*o,n[2]=t[2]+i[2]*o,n[3]=t[3]+i[3]*o,n},mn.distance=tD,mn.squaredDistance=eD,mn.length=nD,mn.squaredLength=rD,mn.negate=function(n,t){return n[0]=-t[0],n[1]=-t[1],n[2]=-t[2],n[3]=-t[3],n},mn.inverse=function(n,t){return n[0]=1/t[0],n[1]=1/t[1],n[2]=1/t[2],n[3]=1/t[3],n},mn.normalize=function(n,t){var i=t[0],o=t[1],c=t[2],u=t[3],d=i*i+o*o+c*c+u*u;return d>0&&(d=1/Math.sqrt(d)),n[0]=i*d,n[1]=o*d,n[2]=c*d,n[3]=u*d,n},mn.dot=function(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]+n[3]*t[3]},mn.cross=function(n,t,i,o){var c=i[0]*o[1]-i[1]*o[0],u=i[0]*o[2]-i[2]*o[0],d=i[0]*o[3]-i[3]*o[0],p=i[1]*o[2]-i[2]*o[1],g=i[1]*o[3]-i[3]*o[1],_=i[2]*o[3]-i[3]*o[2],v=t[0],b=t[1],S=t[2],E=t[3];return n[0]=b*_-S*g+E*p,n[1]=-v*_+S*d-E*u,n[2]=v*g-b*d+E*c,n[3]=-v*p+b*u-S*c,n},mn.lerp=function(n,t,i,o){var c=t[0],u=t[1],d=t[2],p=t[3];return n[0]=c+o*(i[0]-c),n[1]=u+o*(i[1]-u),n[2]=d+o*(i[2]-d),n[3]=p+o*(i[3]-p),n},mn.random=function(n,t){var i,o,c,u,d,p;t=t||1;do d=(i=2*Eo.RANDOM()-1)*i+(o=2*Eo.RANDOM()-1)*o;while(d>=1);do p=(c=2*Eo.RANDOM()-1)*c+(u=2*Eo.RANDOM()-1)*u;while(p>=1);var g=Math.sqrt((1-d)/p);return n[0]=t*i,n[1]=t*o,n[2]=t*c*g,n[3]=t*u*g,n},mn.transformMat4=function(n,t,i){var o=t[0],c=t[1],u=t[2],d=t[3];return n[0]=i[0]*o+i[4]*c+i[8]*u+i[12]*d,n[1]=i[1]*o+i[5]*c+i[9]*u+i[13]*d,n[2]=i[2]*o+i[6]*c+i[10]*u+i[14]*d,n[3]=i[3]*o+i[7]*c+i[11]*u+i[15]*d,n},mn.transformQuat=function(n,t,i){var o=t[0],c=t[1],u=t[2],d=i[0],p=i[1],g=i[2],_=i[3],v=_*o+p*u-g*c,b=_*c+g*o-d*u,S=_*u+d*c-p*o,E=-d*o-p*c-g*u;return n[0]=v*_+E*-d+b*-g-S*-p,n[1]=b*_+E*-p+S*-d-v*-g,n[2]=S*_+E*-g+v*-p-b*-d,n[3]=t[3],n},mn.zero=function(n){return n[0]=0,n[1]=0,n[2]=0,n[3]=0,n},mn.str=function(n){return"vec4("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+")"},mn.exactEquals=function(n,t){return n[0]===t[0]&&n[1]===t[1]&&n[2]===t[2]&&n[3]===t[3]},mn.equals=function(n,t){var i=n[0],o=n[1],c=n[2],u=n[3],d=t[0],p=t[1],g=t[2],_=t[3];return Math.abs(i-d)<=Eo.EPSILON*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(o-p)<=Eo.EPSILON*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(c-g)<=Eo.EPSILON*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(u-_)<=Eo.EPSILON*Math.max(1,Math.abs(u),Math.abs(_))},mn.forEach=mn.sqrLen=mn.len=mn.sqrDist=mn.dist=mn.div=mn.mul=mn.sub=void 0;var Eo=function(n,t){if(n&&n.__esModule)return n;if(n===null||Xb(n)!=="object"&&typeof n!="function")return{default:n};var i=Xk(void 0);if(i&&i.has(n))return i.get(n);var o={},c=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in n)if(u!=="default"&&Object.prototype.hasOwnProperty.call(n,u)){var d=c?Object.getOwnPropertyDescriptor(n,u):null;d&&(d.get||d.set)?Object.defineProperty(o,u,d):o[u]=n[u]}return o.default=n,i&&i.set(n,o),o}(yi);function Xk(n){if(typeof WeakMap!="function")return null;var t=new WeakMap,i=new WeakMap;return(Xk=function(o){return o?i:t})(n)}function Yk(){var n=new Eo.ARRAY_TYPE(4);return Eo.ARRAY_TYPE!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0,n[3]=0),n}function Kk(n,t,i){return n[0]=t[0]-i[0],n[1]=t[1]-i[1],n[2]=t[2]-i[2],n[3]=t[3]-i[3],n}function Jk(n,t,i){return n[0]=t[0]*i[0],n[1]=t[1]*i[1],n[2]=t[2]*i[2],n[3]=t[3]*i[3],n}function Qk(n,t,i){return n[0]=t[0]/i[0],n[1]=t[1]/i[1],n[2]=t[2]/i[2],n[3]=t[3]/i[3],n}function tD(n,t){return Math.hypot(t[0]-n[0],t[1]-n[1],t[2]-n[2],t[3]-n[3])}function eD(n,t){var i=t[0]-n[0],o=t[1]-n[1],c=t[2]-n[2],u=t[3]-n[3];return i*i+o*o+c*c+u*u}function nD(n){return Math.hypot(n[0],n[1],n[2],n[3])}function rD(n){var t=n[0],i=n[1],o=n[2],c=n[3];return t*t+i*i+o*o+c*c}mn.sub=Kk,mn.mul=Jk,mn.div=Qk,mn.dist=tD,mn.sqrDist=eD,mn.len=nD,mn.sqrLen=rD;var S9=function(){var n=Yk();return function(t,i,o,c,u,d){var p,g;for(i||(i=4),o||(o=0),g=c?Math.min(c*i+o,t.length):t.length,p=o;p<g;p+=i)n[0]=t[p],n[1]=t[p+1],n[2]=t[p+2],n[3]=t[p+3],u(n,n,d),t[p]=n[0],t[p+1]=n[1],t[p+2]=n[2],t[p+3]=n[3];return t}}();function Yb(n){return Yb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yb(n)}mn.forEach=S9,Object.defineProperty(Je,"__esModule",{value:!0}),Je.create=Kb,Je.identity=function(n){return n[0]=0,n[1]=0,n[2]=0,n[3]=1,n},Je.setAxisAngle=sD,Je.getAxisAngle=function(n,t){var i=2*Math.acos(t[3]),o=Math.sin(i/2);return o>zu.EPSILON?(n[0]=t[0]/o,n[1]=t[1]/o,n[2]=t[2]/o):(n[0]=1,n[1]=0,n[2]=0),i},Je.getAngle=function(n,t){var i=hD(n,t);return Math.acos(2*i*i-1)},Je.multiply=oD,Je.rotateX=function(n,t,i){i*=.5;var o=t[0],c=t[1],u=t[2],d=t[3],p=Math.sin(i),g=Math.cos(i);return n[0]=o*g+d*p,n[1]=c*g+u*p,n[2]=u*g-c*p,n[3]=d*g-o*p,n},Je.rotateY=function(n,t,i){i*=.5;var o=t[0],c=t[1],u=t[2],d=t[3],p=Math.sin(i),g=Math.cos(i);return n[0]=o*g-u*p,n[1]=c*g+d*p,n[2]=u*g+o*p,n[3]=d*g-c*p,n},Je.rotateZ=function(n,t,i){i*=.5;var o=t[0],c=t[1],u=t[2],d=t[3],p=Math.sin(i),g=Math.cos(i);return n[0]=o*g+c*p,n[1]=c*g-o*p,n[2]=u*g+d*p,n[3]=d*g-u*p,n},Je.calculateW=function(n,t){var i=t[0],o=t[1],c=t[2];return n[0]=i,n[1]=o,n[2]=c,n[3]=Math.sqrt(Math.abs(1-i*i-o*o-c*c)),n},Je.exp=aD,Je.ln=lD,Je.pow=function(n,t,i){return lD(n,t),uD(n,n,i),aD(n,n),n},Je.slerp=b_,Je.random=function(n){var t=zu.RANDOM(),i=zu.RANDOM(),o=zu.RANDOM(),c=Math.sqrt(1-t),u=Math.sqrt(t);return n[0]=c*Math.sin(2*Math.PI*i),n[1]=c*Math.cos(2*Math.PI*i),n[2]=u*Math.sin(2*Math.PI*o),n[3]=u*Math.cos(2*Math.PI*o),n},Je.invert=function(n,t){var i=t[0],o=t[1],c=t[2],u=t[3],d=i*i+o*o+c*c+u*u,p=d?1/d:0;return n[0]=-i*p,n[1]=-o*p,n[2]=-c*p,n[3]=u*p,n},Je.conjugate=function(n,t){return n[0]=-t[0],n[1]=-t[1],n[2]=-t[2],n[3]=t[3],n},Je.fromMat3=cD,Je.fromEuler=function(n,t,i,o){var c=.5*Math.PI/180;t*=c,i*=c,o*=c;var u=Math.sin(t),d=Math.cos(t),p=Math.sin(i),g=Math.cos(i),_=Math.sin(o),v=Math.cos(o);return n[0]=u*g*v-d*p*_,n[1]=d*p*v+u*g*_,n[2]=d*g*_-u*p*v,n[3]=d*g*v+u*p*_,n},Je.str=function(n){return"quat("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+")"},Je.setAxes=Je.sqlerp=Je.rotationTo=Je.equals=Je.exactEquals=Je.normalize=Je.sqrLen=Je.squaredLength=Je.len=Je.length=Je.lerp=Je.dot=Je.scale=Je.mul=Je.add=Je.set=Je.copy=Je.fromValues=Je.clone=void 0;var zu=x_(yi),T9=x_(Hn),cl=x_(nn),eo=x_(mn);function iD(n){if(typeof WeakMap!="function")return null;var t=new WeakMap,i=new WeakMap;return(iD=function(o){return o?i:t})(n)}function x_(n,t){if(!t&&n&&n.__esModule)return n;if(n===null||Yb(n)!=="object"&&typeof n!="function")return{default:n};var i=iD(t);if(i&&i.has(n))return i.get(n);var o={},c=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in n)if(u!=="default"&&Object.prototype.hasOwnProperty.call(n,u)){var d=c?Object.getOwnPropertyDescriptor(n,u):null;d&&(d.get||d.set)?Object.defineProperty(o,u,d):o[u]=n[u]}return o.default=n,i&&i.set(n,o),o}function Kb(){var n=new zu.ARRAY_TYPE(4);return zu.ARRAY_TYPE!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n[3]=1,n}function sD(n,t,i){i*=.5;var o=Math.sin(i);return n[0]=o*t[0],n[1]=o*t[1],n[2]=o*t[2],n[3]=Math.cos(i),n}function oD(n,t,i){var o=t[0],c=t[1],u=t[2],d=t[3],p=i[0],g=i[1],_=i[2],v=i[3];return n[0]=o*v+d*p+c*_-u*g,n[1]=c*v+d*g+u*p-o*_,n[2]=u*v+d*_+o*g-c*p,n[3]=d*v-o*p-c*g-u*_,n}function aD(n,t){var i=t[0],o=t[1],c=t[2],u=t[3],d=Math.sqrt(i*i+o*o+c*c),p=Math.exp(u),g=d>0?p*Math.sin(d)/d:0;return n[0]=i*g,n[1]=o*g,n[2]=c*g,n[3]=p*Math.cos(d),n}function lD(n,t){var i=t[0],o=t[1],c=t[2],u=t[3],d=Math.sqrt(i*i+o*o+c*c),p=d>0?Math.atan2(d,u)/d:0;return n[0]=i*p,n[1]=o*p,n[2]=c*p,n[3]=.5*Math.log(i*i+o*o+c*c+u*u),n}function b_(n,t,i,o){var c,u,d,p,g,_=t[0],v=t[1],b=t[2],S=t[3],E=i[0],A=i[1],C=i[2],P=i[3];return(u=_*E+v*A+b*C+S*P)<0&&(u=-u,E=-E,A=-A,C=-C,P=-P),1-u>zu.EPSILON?(c=Math.acos(u),d=Math.sin(c),p=Math.sin((1-o)*c)/d,g=Math.sin(o*c)/d):(p=1-o,g=o),n[0]=p*_+g*E,n[1]=p*v+g*A,n[2]=p*b+g*C,n[3]=p*S+g*P,n}function cD(n,t){var i,o=t[0]+t[4]+t[8];if(o>0)i=Math.sqrt(o+1),n[3]=.5*i,n[0]=(t[5]-t[7])*(i=.5/i),n[1]=(t[6]-t[2])*i,n[2]=(t[1]-t[3])*i;else{var c=0;t[4]>t[0]&&(c=1),t[8]>t[3*c+c]&&(c=2);var u=(c+1)%3,d=(c+2)%3;i=Math.sqrt(t[3*c+c]-t[3*u+u]-t[3*d+d]+1),n[c]=.5*i,n[3]=(t[3*u+d]-t[3*d+u])*(i=.5/i),n[u]=(t[3*u+c]+t[3*c+u])*i,n[d]=(t[3*d+c]+t[3*c+d])*i}return n}Je.clone=eo.clone,Je.fromValues=eo.fromValues,Je.copy=eo.copy,Je.set=eo.set,Je.add=eo.add,Je.mul=oD;var uD=eo.scale;Je.scale=uD;var hD=eo.dot;Je.dot=hD,Je.lerp=eo.lerp;var dD=eo.length;Je.length=dD,Je.len=dD;var fD=eo.squaredLength;Je.squaredLength=fD,Je.sqrLen=fD;var Jb=eo.normalize;Je.normalize=Jb,Je.exactEquals=eo.exactEquals,Je.equals=eo.equals;var Xo,pD,mD,E9=(Xo=cl.create(),pD=cl.fromValues(1,0,0),mD=cl.fromValues(0,1,0),function(n,t,i){var o=cl.dot(t,i);return o<-.999999?(cl.cross(Xo,pD,t),cl.len(Xo)<1e-6&&cl.cross(Xo,mD,t),cl.normalize(Xo,Xo),sD(n,Xo,Math.PI),n):o>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(cl.cross(Xo,t,i),n[0]=Xo[0],n[1]=Xo[1],n[2]=Xo[2],n[3]=1+o,Jb(n,n))});Je.rotationTo=E9;var Qb,tw,M9=(Qb=Kb(),tw=Kb(),function(n,t,i,o,c,u){return b_(Qb,t,c,u),b_(tw,i,o,u),b_(n,Qb,tw,2*u*(1-u)),n});Je.sqlerp=M9;var Yo,A9=(Yo=T9.create(),function(n,t,i,o){return Yo[0]=i[0],Yo[3]=i[1],Yo[6]=i[2],Yo[1]=o[0],Yo[4]=o[1],Yo[7]=o[2],Yo[2]=-t[0],Yo[5]=-t[1],Yo[8]=-t[2],Jb(n,cD(n,Yo))});Je.setAxes=A9;var xn={};function ew(n){return ew=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ew(n)}Object.defineProperty(xn,"__esModule",{value:!0}),xn.create=function(){var n=new xs.ARRAY_TYPE(8);return xs.ARRAY_TYPE!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0,n[4]=0,n[5]=0,n[6]=0,n[7]=0),n[3]=1,n},xn.clone=function(n){var t=new xs.ARRAY_TYPE(8);return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t},xn.fromValues=function(n,t,i,o,c,u,d,p){var g=new xs.ARRAY_TYPE(8);return g[0]=n,g[1]=t,g[2]=i,g[3]=o,g[4]=c,g[5]=u,g[6]=d,g[7]=p,g},xn.fromRotationTranslationValues=function(n,t,i,o,c,u,d){var p=new xs.ARRAY_TYPE(8);p[0]=n,p[1]=t,p[2]=i,p[3]=o;var g=.5*c,_=.5*u,v=.5*d;return p[4]=g*o+_*i-v*t,p[5]=_*o+v*n-g*i,p[6]=v*o+g*t-_*n,p[7]=-g*n-_*t-v*i,p},xn.fromRotationTranslation=yD,xn.fromTranslation=function(n,t){return n[0]=0,n[1]=0,n[2]=0,n[3]=1,n[4]=.5*t[0],n[5]=.5*t[1],n[6]=.5*t[2],n[7]=0,n},xn.fromRotation=function(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=0,n[5]=0,n[6]=0,n[7]=0,n},xn.fromMat4=function(n,t){var i=ul.create();gD.getRotation(i,t);var o=new xs.ARRAY_TYPE(3);return gD.getTranslation(o,t),yD(n,i,o),n},xn.copy=vD,xn.identity=function(n){return n[0]=0,n[1]=0,n[2]=0,n[3]=1,n[4]=0,n[5]=0,n[6]=0,n[7]=0,n},xn.set=function(n,t,i,o,c,u,d,p,g){return n[0]=t,n[1]=i,n[2]=o,n[3]=c,n[4]=u,n[5]=d,n[6]=p,n[7]=g,n},xn.getDual=function(n,t){return n[0]=t[4],n[1]=t[5],n[2]=t[6],n[3]=t[7],n},xn.setDual=function(n,t){return n[4]=t[0],n[5]=t[1],n[6]=t[2],n[7]=t[3],n},xn.getTranslation=function(n,t){var i=t[4],o=t[5],c=t[6],u=t[7],d=-t[0],p=-t[1],g=-t[2],_=t[3];return n[0]=2*(i*_+u*d+o*g-c*p),n[1]=2*(o*_+u*p+c*d-i*g),n[2]=2*(c*_+u*g+i*p-o*d),n},xn.translate=function(n,t,i){var o=t[0],c=t[1],u=t[2],d=t[3],p=.5*i[0],g=.5*i[1],_=.5*i[2],v=t[4],b=t[5],S=t[6],E=t[7];return n[0]=o,n[1]=c,n[2]=u,n[3]=d,n[4]=d*p+c*_-u*g+v,n[5]=d*g+u*p-o*_+b,n[6]=d*_+o*g-c*p+S,n[7]=-o*p-c*g-u*_+E,n},xn.rotateX=function(n,t,i){var o=-t[0],c=-t[1],u=-t[2],d=t[3],p=t[4],g=t[5],_=t[6],v=t[7],b=p*d+v*o+g*u-_*c,S=g*d+v*c+_*o-p*u,E=_*d+v*u+p*c-g*o,A=v*d-p*o-g*c-_*u;return ul.rotateX(n,t,i),n[4]=b*(d=n[3])+A*(o=n[0])+S*(u=n[2])-E*(c=n[1]),n[5]=S*d+A*c+E*o-b*u,n[6]=E*d+A*u+b*c-S*o,n[7]=A*d-b*o-S*c-E*u,n},xn.rotateY=function(n,t,i){var o=-t[0],c=-t[1],u=-t[2],d=t[3],p=t[4],g=t[5],_=t[6],v=t[7],b=p*d+v*o+g*u-_*c,S=g*d+v*c+_*o-p*u,E=_*d+v*u+p*c-g*o,A=v*d-p*o-g*c-_*u;return ul.rotateY(n,t,i),n[4]=b*(d=n[3])+A*(o=n[0])+S*(u=n[2])-E*(c=n[1]),n[5]=S*d+A*c+E*o-b*u,n[6]=E*d+A*u+b*c-S*o,n[7]=A*d-b*o-S*c-E*u,n},xn.rotateZ=function(n,t,i){var o=-t[0],c=-t[1],u=-t[2],d=t[3],p=t[4],g=t[5],_=t[6],v=t[7],b=p*d+v*o+g*u-_*c,S=g*d+v*c+_*o-p*u,E=_*d+v*u+p*c-g*o,A=v*d-p*o-g*c-_*u;return ul.rotateZ(n,t,i),n[4]=b*(d=n[3])+A*(o=n[0])+S*(u=n[2])-E*(c=n[1]),n[5]=S*d+A*c+E*o-b*u,n[6]=E*d+A*u+b*c-S*o,n[7]=A*d-b*o-S*c-E*u,n},xn.rotateByQuatAppend=function(n,t,i){var o=i[0],c=i[1],u=i[2],d=i[3],p=t[0],g=t[1],_=t[2],v=t[3];return n[0]=p*d+v*o+g*u-_*c,n[1]=g*d+v*c+_*o-p*u,n[2]=_*d+v*u+p*c-g*o,n[3]=v*d-p*o-g*c-_*u,n[4]=(p=t[4])*d+(v=t[7])*o+(g=t[5])*u-(_=t[6])*c,n[5]=g*d+v*c+_*o-p*u,n[6]=_*d+v*u+p*c-g*o,n[7]=v*d-p*o-g*c-_*u,n},xn.rotateByQuatPrepend=function(n,t,i){var o=t[0],c=t[1],u=t[2],d=t[3],p=i[0],g=i[1],_=i[2],v=i[3];return n[0]=o*v+d*p+c*_-u*g,n[1]=c*v+d*g+u*p-o*_,n[2]=u*v+d*_+o*g-c*p,n[3]=d*v-o*p-c*g-u*_,n[4]=o*(v=i[7])+d*(p=i[4])+c*(_=i[6])-u*(g=i[5]),n[5]=c*v+d*g+u*p-o*_,n[6]=u*v+d*_+o*g-c*p,n[7]=d*v-o*p-c*g-u*_,n},xn.rotateAroundAxis=function(n,t,i,o){if(Math.abs(o)<xs.EPSILON)return vD(n,t);var c=Math.hypot(i[0],i[1],i[2]);o*=.5;var u=Math.sin(o),d=u*i[0]/c,p=u*i[1]/c,g=u*i[2]/c,_=Math.cos(o),v=t[0],b=t[1],S=t[2],E=t[3];n[0]=v*_+E*d+b*g-S*p,n[1]=b*_+E*p+S*d-v*g,n[2]=S*_+E*g+v*p-b*d,n[3]=E*_-v*d-b*p-S*g;var A=t[4],C=t[5],P=t[6],k=t[7];return n[4]=A*_+k*d+C*g-P*p,n[5]=C*_+k*p+P*d-A*g,n[6]=P*_+k*g+A*p-C*d,n[7]=k*_-A*d-C*p-P*g,n},xn.add=function(n,t,i){return n[0]=t[0]+i[0],n[1]=t[1]+i[1],n[2]=t[2]+i[2],n[3]=t[3]+i[3],n[4]=t[4]+i[4],n[5]=t[5]+i[5],n[6]=t[6]+i[6],n[7]=t[7]+i[7],n},xn.multiply=xD,xn.scale=function(n,t,i){return n[0]=t[0]*i,n[1]=t[1]*i,n[2]=t[2]*i,n[3]=t[3]*i,n[4]=t[4]*i,n[5]=t[5]*i,n[6]=t[6]*i,n[7]=t[7]*i,n},xn.lerp=function(n,t,i,o){var c=1-o;return bD(t,i)<0&&(o=-o),n[0]=t[0]*c+i[0]*o,n[1]=t[1]*c+i[1]*o,n[2]=t[2]*c+i[2]*o,n[3]=t[3]*c+i[3]*o,n[4]=t[4]*c+i[4]*o,n[5]=t[5]*c+i[5]*o,n[6]=t[6]*c+i[6]*o,n[7]=t[7]*c+i[7]*o,n},xn.invert=function(n,t){var i=w_(t);return n[0]=-t[0]/i,n[1]=-t[1]/i,n[2]=-t[2]/i,n[3]=t[3]/i,n[4]=-t[4]/i,n[5]=-t[5]/i,n[6]=-t[6]/i,n[7]=t[7]/i,n},xn.conjugate=function(n,t){return n[0]=-t[0],n[1]=-t[1],n[2]=-t[2],n[3]=t[3],n[4]=-t[4],n[5]=-t[5],n[6]=-t[6],n[7]=t[7],n},xn.normalize=function(n,t){var i=w_(t);if(i>0){i=Math.sqrt(i);var o=t[0]/i,c=t[1]/i,u=t[2]/i,d=t[3]/i,p=t[4],g=t[5],_=t[6],v=t[7],b=o*p+c*g+u*_+d*v;n[0]=o,n[1]=c,n[2]=u,n[3]=d,n[4]=(p-o*b)/i,n[5]=(g-c*b)/i,n[6]=(_-u*b)/i,n[7]=(v-d*b)/i}return n},xn.str=function(n){return"quat2("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+", "+n[4]+", "+n[5]+", "+n[6]+", "+n[7]+")"},xn.exactEquals=function(n,t){return n[0]===t[0]&&n[1]===t[1]&&n[2]===t[2]&&n[3]===t[3]&&n[4]===t[4]&&n[5]===t[5]&&n[6]===t[6]&&n[7]===t[7]},xn.equals=function(n,t){var i=n[0],o=n[1],c=n[2],u=n[3],d=n[4],p=n[5],g=n[6],_=n[7],v=t[0],b=t[1],S=t[2],E=t[3],A=t[4],C=t[5],P=t[6],k=t[7];return Math.abs(i-v)<=xs.EPSILON*Math.max(1,Math.abs(i),Math.abs(v))&&Math.abs(o-b)<=xs.EPSILON*Math.max(1,Math.abs(o),Math.abs(b))&&Math.abs(c-S)<=xs.EPSILON*Math.max(1,Math.abs(c),Math.abs(S))&&Math.abs(u-E)<=xs.EPSILON*Math.max(1,Math.abs(u),Math.abs(E))&&Math.abs(d-A)<=xs.EPSILON*Math.max(1,Math.abs(d),Math.abs(A))&&Math.abs(p-C)<=xs.EPSILON*Math.max(1,Math.abs(p),Math.abs(C))&&Math.abs(g-P)<=xs.EPSILON*Math.max(1,Math.abs(g),Math.abs(P))&&Math.abs(_-k)<=xs.EPSILON*Math.max(1,Math.abs(_),Math.abs(k))},xn.sqrLen=xn.squaredLength=xn.len=xn.length=xn.dot=xn.mul=xn.setReal=xn.getReal=void 0;var xs=nw(yi),ul=nw(Je),gD=nw(rn);function _D(n){if(typeof WeakMap!="function")return null;var t=new WeakMap,i=new WeakMap;return(_D=function(o){return o?i:t})(n)}function nw(n,t){if(!t&&n&&n.__esModule)return n;if(n===null||ew(n)!=="object"&&typeof n!="function")return{default:n};var i=_D(t);if(i&&i.has(n))return i.get(n);var o={},c=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in n)if(u!=="default"&&Object.prototype.hasOwnProperty.call(n,u)){var d=c?Object.getOwnPropertyDescriptor(n,u):null;d&&(d.get||d.set)?Object.defineProperty(o,u,d):o[u]=n[u]}return o.default=n,i&&i.set(n,o),o}function yD(n,t,i){var o=.5*i[0],c=.5*i[1],u=.5*i[2],d=t[0],p=t[1],g=t[2],_=t[3];return n[0]=d,n[1]=p,n[2]=g,n[3]=_,n[4]=o*_+c*g-u*p,n[5]=c*_+u*d-o*g,n[6]=u*_+o*p-c*d,n[7]=-o*d-c*p-u*g,n}function vD(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n}function xD(n,t,i){var o=t[0],c=t[1],u=t[2],d=t[3],p=i[4],g=i[5],_=i[6],v=i[7],b=t[4],S=t[5],E=t[6],A=t[7],C=i[0],P=i[1],k=i[2],L=i[3];return n[0]=o*L+d*C+c*k-u*P,n[1]=c*L+d*P+u*C-o*k,n[2]=u*L+d*k+o*P-c*C,n[3]=d*L-o*C-c*P-u*k,n[4]=o*v+d*p+c*_-u*g+b*L+A*C+S*k-E*P,n[5]=c*v+d*g+u*p-o*_+S*L+A*P+E*C-b*k,n[6]=u*v+d*_+o*g-c*p+E*L+A*k+b*P-S*C,n[7]=d*v-o*p-c*g-u*_+A*L-b*C-S*P-E*k,n}xn.getReal=ul.copy,xn.setReal=ul.copy,xn.mul=xD;var bD=ul.dot;xn.dot=bD;var wD=ul.length;xn.length=wD,xn.len=wD;var w_=ul.squaredLength;xn.squaredLength=w_,xn.sqrLen=w_;var cn={};function rw(n){return rw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rw(n)}Object.defineProperty(cn,"__esModule",{value:!0}),cn.create=TD,cn.clone=function(n){var t=new Nu.ARRAY_TYPE(2);return t[0]=n[0],t[1]=n[1],t},cn.fromValues=function(n,t){var i=new Nu.ARRAY_TYPE(2);return i[0]=n,i[1]=t,i},cn.copy=function(n,t){return n[0]=t[0],n[1]=t[1],n},cn.set=function(n,t,i){return n[0]=t,n[1]=i,n},cn.add=function(n,t,i){return n[0]=t[0]+i[0],n[1]=t[1]+i[1],n},cn.subtract=ED,cn.multiply=MD,cn.divide=AD,cn.ceil=function(n,t){return n[0]=Math.ceil(t[0]),n[1]=Math.ceil(t[1]),n},cn.floor=function(n,t){return n[0]=Math.floor(t[0]),n[1]=Math.floor(t[1]),n},cn.min=function(n,t,i){return n[0]=Math.min(t[0],i[0]),n[1]=Math.min(t[1],i[1]),n},cn.max=function(n,t,i){return n[0]=Math.max(t[0],i[0]),n[1]=Math.max(t[1],i[1]),n},cn.round=function(n,t){return n[0]=Math.round(t[0]),n[1]=Math.round(t[1]),n},cn.scale=function(n,t,i){return n[0]=t[0]*i,n[1]=t[1]*i,n},cn.scaleAndAdd=function(n,t,i,o){return n[0]=t[0]+i[0]*o,n[1]=t[1]+i[1]*o,n},cn.distance=CD,cn.squaredDistance=PD,cn.length=ID,cn.squaredLength=kD,cn.negate=function(n,t){return n[0]=-t[0],n[1]=-t[1],n},cn.inverse=function(n,t){return n[0]=1/t[0],n[1]=1/t[1],n},cn.normalize=function(n,t){var i=t[0],o=t[1],c=i*i+o*o;return c>0&&(c=1/Math.sqrt(c)),n[0]=t[0]*c,n[1]=t[1]*c,n},cn.dot=function(n,t){return n[0]*t[0]+n[1]*t[1]},cn.cross=function(n,t,i){var o=t[0]*i[1]-t[1]*i[0];return n[0]=n[1]=0,n[2]=o,n},cn.lerp=function(n,t,i,o){var c=t[0],u=t[1];return n[0]=c+o*(i[0]-c),n[1]=u+o*(i[1]-u),n},cn.random=function(n,t){t=t||1;var i=2*Nu.RANDOM()*Math.PI;return n[0]=Math.cos(i)*t,n[1]=Math.sin(i)*t,n},cn.transformMat2=function(n,t,i){var o=t[0],c=t[1];return n[0]=i[0]*o+i[2]*c,n[1]=i[1]*o+i[3]*c,n},cn.transformMat2d=function(n,t,i){var o=t[0],c=t[1];return n[0]=i[0]*o+i[2]*c+i[4],n[1]=i[1]*o+i[3]*c+i[5],n},cn.transformMat3=function(n,t,i){var o=t[0],c=t[1];return n[0]=i[0]*o+i[3]*c+i[6],n[1]=i[1]*o+i[4]*c+i[7],n},cn.transformMat4=function(n,t,i){var o=t[0],c=t[1];return n[0]=i[0]*o+i[4]*c+i[12],n[1]=i[1]*o+i[5]*c+i[13],n},cn.rotate=function(n,t,i,o){var c=t[0]-i[0],u=t[1]-i[1],d=Math.sin(o),p=Math.cos(o);return n[0]=c*p-u*d+i[0],n[1]=c*d+u*p+i[1],n},cn.angle=function(n,t){var i=n[0],o=n[1],c=t[0],u=t[1],d=Math.sqrt(i*i+o*o)*Math.sqrt(c*c+u*u);return Math.acos(Math.min(Math.max(d&&(i*c+o*u)/d,-1),1))},cn.zero=function(n){return n[0]=0,n[1]=0,n},cn.str=function(n){return"vec2("+n[0]+", "+n[1]+")"},cn.exactEquals=function(n,t){return n[0]===t[0]&&n[1]===t[1]},cn.equals=function(n,t){var i=n[0],o=n[1],c=t[0],u=t[1];return Math.abs(i-c)<=Nu.EPSILON*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(o-u)<=Nu.EPSILON*Math.max(1,Math.abs(o),Math.abs(u))},cn.forEach=cn.sqrLen=cn.sqrDist=cn.dist=cn.div=cn.mul=cn.sub=cn.len=void 0;var Nu=function(n,t){if(n&&n.__esModule)return n;if(n===null||rw(n)!=="object"&&typeof n!="function")return{default:n};var i=SD(void 0);if(i&&i.has(n))return i.get(n);var o={},c=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in n)if(u!=="default"&&Object.prototype.hasOwnProperty.call(n,u)){var d=c?Object.getOwnPropertyDescriptor(n,u):null;d&&(d.get||d.set)?Object.defineProperty(o,u,d):o[u]=n[u]}return o.default=n,i&&i.set(n,o),o}(yi);function SD(n){if(typeof WeakMap!="function")return null;var t=new WeakMap,i=new WeakMap;return(SD=function(o){return o?i:t})(n)}function TD(){var n=new Nu.ARRAY_TYPE(2);return Nu.ARRAY_TYPE!=Float32Array&&(n[0]=0,n[1]=0),n}function ED(n,t,i){return n[0]=t[0]-i[0],n[1]=t[1]-i[1],n}function MD(n,t,i){return n[0]=t[0]*i[0],n[1]=t[1]*i[1],n}function AD(n,t,i){return n[0]=t[0]/i[0],n[1]=t[1]/i[1],n}function CD(n,t){return Math.hypot(t[0]-n[0],t[1]-n[1])}function PD(n,t){var i=t[0]-n[0],o=t[1]-n[1];return i*i+o*o}function ID(n){return Math.hypot(n[0],n[1])}function kD(n){var t=n[0],i=n[1];return t*t+i*i}cn.len=ID,cn.sub=ED,cn.mul=MD,cn.div=AD,cn.dist=CD,cn.sqrDist=PD,cn.sqrLen=kD;var C9=function(){var n=TD();return function(t,i,o,c,u,d){var p,g;for(i||(i=2),o||(o=0),g=c?Math.min(c*i+o,t.length):t.length,p=o;p<g;p+=i)n[0]=t[p],n[1]=t[p+1],u(n,n,d),t[p]=n[0],t[p+1]=n[1];return t}}();function iw(n){return iw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iw(n)}cn.forEach=C9,Object.defineProperty(_i,"__esModule",{value:!0});var jn=_i.vec4=ct=_i.vec3=_i.vec2=_i.quat2=Fi=_i.quat=wt=_i.mat4=bs=_i.mat3=_i.mat2d=ad=_i.mat2=_i.glMatrix=void 0,P9=Ma(yi);_i.glMatrix=P9;var I9=Ma(gr),ad=_i.mat2=I9,k9=Ma(vr);_i.mat2d=k9;var D9=Ma(Hn),bs=_i.mat3=D9,R9=Ma(rn),wt=_i.mat4=R9,O9=Ma(Je),Fi=_i.quat=O9,L9=Ma(xn);_i.quat2=L9;var z9=Ma(cn);_i.vec2=z9;var N9=Ma(nn),ct=_i.vec3=N9,F9=Ma(mn);function DD(n){if(typeof WeakMap!="function")return null;var t=new WeakMap,i=new WeakMap;return(DD=function(o){return o?i:t})(n)}function Ma(n,t){if(!t&&n&&n.__esModule)return n;if(n===null||iw(n)!=="object"&&typeof n!="function")return{default:n};var i=DD(t);if(i&&i.has(n))return i.get(n);var o={},c=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in n)if(u!=="default"&&Object.prototype.hasOwnProperty.call(n,u)){var d=c?Object.getOwnPropertyDescriptor(n,u):null;d&&(d.get||d.set)?Object.defineProperty(o,u,d):o[u]=n[u]}return o.default=n,i&&i.set(n,o),o}jn=_i.vec4=F9;const B9=Rn([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:S_}=B9,RD=Rn([{name:"a_pos_3",components:3,type:"Int16"}]);var cc=Rn([{name:"a_pos",type:"Int16",components:2}]),OD={};(function(n,t){(function(i){function o(u,d,p){var g=c(256*u,256*(d=Math.pow(2,p)-d-1),p),_=c(256*(u+1),256*(d+1),p);return g[0]+","+g[1]+","+_[0]+","+_[1]}function c(u,d,p){var g=2*Math.PI*6378137/256/Math.pow(2,p);return[u*g-2*Math.PI*6378137/2,d*g-2*Math.PI*6378137/2]}i.getURL=function(u,d,p,g,_,v){return v=v||{},u+"?"+["bbox="+o(p,g,_),"format="+(v.format||"image/png"),"service="+(v.service||"WMS"),"version="+(v.version||"1.1.1"),"request="+(v.request||"GetMap"),"srs="+(v.srs||"EPSG:3857"),"width="+(v.width||256),"height="+(v.height||256),"layers="+d].join("&")},i.getTileBBox=o,i.getMercCoords=c,Object.defineProperty(i,"__esModule",{value:!0})})(t)})(0,OD);var j9=OD;class Mo{constructor(t,i,o){this.z=t,this.x=i,this.y=o,this.key=rp(0,t,t,i,o)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,i){const o=j9.getTileBBox(this.x,this.y,this.z),c=function(u,d,p){let g,_="";for(let v=u;v>0;v--)g=1<<v-1,_+=(d&g?1:0)+(p&g?2:0);return _}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(i==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",c).replace("{bbox-epsg-3857}",o)}toString(){return`${this.z}/${this.x}/${this.y}`}}class sw{constructor(t,i){this.wrap=t,this.canonical=i,this.key=rp(t,i.z,i.z,i.x,i.y)}}class Pn{constructor(t,i,o,c,u){this.overscaledZ=t,this.wrap=i,this.canonical=new Mo(o,+c,+u),this.key=i===0&&t===o?this.canonical.key:rp(i,t,o,c,u)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){const i=this.canonical.z-t;return t>this.canonical.z?new Pn(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Pn(t,this.wrap,t,this.canonical.x>>i,this.canonical.y>>i)}calculateScaledKey(t,i=!0){if(this.overscaledZ===t&&i)return this.key;if(t>this.canonical.z)return rp(this.wrap*+i,t,this.canonical.z,this.canonical.x,this.canonical.y);{const o=this.canonical.z-t;return rp(this.wrap*+i,t,t,this.canonical.x>>o,this.canonical.y>>o)}}isChildOf(t){if(t.wrap!==this.wrap)return!1;const i=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.z<this.canonical.z&&t.canonical.x===this.canonical.x>>i&&t.canonical.y===this.canonical.y>>i}children(t){if(this.overscaledZ>=t)return[new Pn(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const i=this.canonical.z+1,o=2*this.canonical.x,c=2*this.canonical.y;return[new Pn(i,this.wrap,i,o,c),new Pn(i,this.wrap,i,o+1,c),new Pn(i,this.wrap,i,o,c+1),new Pn(i,this.wrap,i,o+1,c+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new Pn(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new Pn(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new sw(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function rp(n,t,i,o,c){const u=1<<Math.min(i,22);let d=u*(c%u)+o%u;return n&&i<22&&(d+=u*u*((n<0?-2*n-1:2*n)%(1<<2*(22-i)))),16*(32*d+i)+(t-i)}const LD=[n=>{let t=n.canonical.x-1,i=n.wrap;return t<0&&(t=(1<<n.canonical.z)-1,i--),new Pn(n.overscaledZ,i,n.canonical.z,t,n.canonical.y)},n=>{let t=n.canonical.x+1,i=n.wrap;return t===1<<n.canonical.z&&(t=0,i++),new Pn(n.overscaledZ,i,n.canonical.z,t,n.canonical.y)},n=>new Pn(n.overscaledZ,n.wrap,n.canonical.z,n.canonical.x,(n.canonical.y===0?1<<n.canonical.z:n.canonical.y)-1),n=>new Pn(n.overscaledZ,n.wrap,n.canonical.z,n.canonical.x,n.canonical.y===(1<<n.canonical.z)-1?0:n.canonical.y+1)];Se(Mo,"CanonicalTileID"),Se(Pn,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});class T_{constructor(t,i){this.pos=t,this.dir=i}intersectsPlane(t,i,o){const c=ct.dot(i,this.dir);if(Math.abs(c)<1e-6)return!1;const u=((t[0]-this.pos[0])*i[0]+(t[1]-this.pos[1])*i[1]+(t[2]-this.pos[2])*i[2])/c;return o[0]=this.pos[0]+this.dir[0]*u,o[1]=this.pos[1]+this.dir[1]*u,o[2]=this.pos[2]+this.dir[2]*u,!0}closestPointOnSphere(t,i,o){if(ct.equals(this.pos,t)||i===0)return o[0]=o[1]=o[2]=0,!1;const[c,u,d]=this.dir,p=this.pos[0]-t[0],g=this.pos[1]-t[1],_=this.pos[2]-t[2],v=c*c+u*u+d*d,b=2*(p*c+g*u+_*d),S=b*b-4*v*(p*p+g*g+_*_-i*i);if(S<0){const E=Math.max(-b/2,0),A=p+c*E,C=g+u*E,P=_+d*E,k=Math.hypot(A,C,P);return o[0]=A*i/k,o[1]=C*i/k,o[2]=P*i/k,!1}{const E=(-b-Math.sqrt(S))/(2*v);if(E<0){const A=Math.hypot(p,g,_);return o[0]=p*i/A,o[1]=g*i/A,o[2]=_*i/A,!1}return o[0]=p+c*E,o[1]=g+u*E,o[2]=_+d*E,!0}}}class ow{constructor(t,i,o,c,u){this.TL=t,this.TR=i,this.BR=o,this.BL=c,this.horizon=u}static fromInvProjectionMatrix(t,i,o){const c=[-1,1,1],u=[1,1,1],d=[1,-1,1],p=[-1,-1,1],g=ct.transformMat4(c,c,t),_=ct.transformMat4(u,u,t),v=ct.transformMat4(d,d,t),b=ct.transformMat4(p,p,t);return new ow(g,_,v,b,i/o)}}function ip(n,t,i){let o=1/0,c=-1/0;const u=[];for(const d of n){ct.sub(u,d,t);const p=ct.dot(u,i);o=Math.min(o,p),c=Math.max(c,p)}return[o,c]}function zD(n,t){let i=!0;for(let o=0;o<n.planes.length;o++){const c=n.planes[o];let u=0;for(let d=0;d<t.length;d++)u+=ct.dot(c,t[d])+c[3]>=0;if(u===0)return 0;u!==t.length&&(i=!1)}return i?2:1}function ND(n,t){for(const i of n.projections){const o=ip(t,n.points[0],i.axis);if(i.projection[1]<o[0]||i.projection[0]>o[1])return 0}return 1}function FD(n,t){let i=0;const o=[0,0,0,0];for(let c=0;c<n.length;c++)o[0]=n[c][0],o[1]=n[c][1],o[2]=n[c][2],o[3]=1,jn.dot(o,t)>=0&&i++;return i}class hl{constructor(t,i){this.points=t||new Array(8).fill([0,0,0]),this.planes=i||new Array(6).fill([0,0,0,0]),this.bounds=nr.fromPoints(this.points),this.projections=[],this.frustumEdges=[ct.sub([],this.points[2],this.points[3]),ct.sub([],this.points[0],this.points[3]),ct.sub([],this.points[4],this.points[0]),ct.sub([],this.points[5],this.points[1]),ct.sub([],this.points[6],this.points[2]),ct.sub([],this.points[7],this.points[3])];for(const o of this.frustumEdges){const c=[0,-o[2],o[1]],u=[o[2],0,-o[0]];this.projections.push({axis:c,projection:ip(this.points,this.points[0],c)}),this.projections.push({axis:u,projection:ip(this.points,this.points[0],u)})}}static fromInvProjectionMatrix(t,i,o,c){const u=Math.pow(2,o),d=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(_=>{const v=jn.transformMat4([],_,t),b=1/v[3]/i*u;return jn.mul(v,v,[b,b,c?1/v[3]:b,b])}),p=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(_=>{const v=ct.sub([],d[_[0]],d[_[1]]),b=ct.sub([],d[_[2]],d[_[1]]),S=ct.normalize([],ct.cross([],v,b)),E=-ct.dot(S,d[_[1]]);return S.concat(E)}),g=[];for(let _=0;_<d.length;_++)g.push([d[_][0],d[_][1],d[_][2]]);return new hl(g,p)}intersectsPrecise(t,i,o){for(let c=0;c<i.length;c++)if(!FD(t,i[c]))return 0;for(let c=0;c<this.planes.length;c++)if(!FD(t,this.planes[c]))return 0;for(const c of o)for(const u of this.frustumEdges){const d=ct.cross([],c,u),p=ct.length(d);if(p===0)continue;ct.scale(d,d,1/p);const g=ip(this.points,this.points[0],d),_=ip(t,this.points[0],d);if(g[0]>_[1]||_[0]>g[1])return 0}return 1}}class nr{static fromPoints(t){const i=[1/0,1/0,1/0],o=[-1/0,-1/0,-1/0];for(const c of t)ct.min(i,i,c),ct.max(o,o,c);return new nr(i,o)}static fromTileIdAndHeight(t,i,o){const c=1<<t.canonical.z,u=t.canonical.x,d=t.canonical.y;return new nr([u/c,d/c,i],[(u+1)/c,(d+1)/c,o])}static applyTransform(t,i){const o=t.getCorners();for(let c=0;c<o.length;++c)ct.transformMat4(o[c],o[c],i);return nr.fromPoints(o)}static projectAabbCorners(t,i){const o=t.getCorners();for(let c=0;c<o.length;++c)ct.transformMat4(o[c],o[c],i);return o}constructor(t,i){this.min=t,this.max=i,this.center=ct.scale([],ct.add([],this.min,this.max),.5)}quadrant(t){const i=[t%2==0,t<2],o=ct.clone(this.min),c=ct.clone(this.max);for(let u=0;u<i.length;u++)o[u]=i[u]?this.min[u]:this.center[u],c[u]=i[u]?this.center[u]:this.max[u];return c[2]=this.max[2],new nr(o,c)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}distanceZ(t){return Math.max(Math.min(this.max[2],t[2]),this.min[2])-t[2]}getCorners(){const t=this.min,i=this.max;return[[t[0],t[1],t[2]],[i[0],t[1],t[2]],[i[0],i[1],t[2]],[t[0],i[1],t[2]],[t[0],t[1],i[2]],[i[0],t[1],i[2]],[i[0],i[1],i[2]],[t[0],i[1],i[2]]]}intersects(t){return this.intersectsAabb(t.bounds)?zD(t,this.getCorners()):0}intersectsFlat(t){return this.intersectsAabb(t.bounds)?zD(t,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(t,i){return i||this.intersects(t)?ND(t,this.getCorners()):0}intersectsPreciseFlat(t,i){return i||this.intersectsFlat(t)?ND(t,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(t){for(let i=0;i<3;++i)if(this.min[i]>t.max[i]||t.min[i]>this.max[i])return!1;return!0}intersectsAabbXY(t){return!(this.min[0]>t.max[0]||t.min[0]>this.max[0]||this.min[1]>t.max[1]||t.min[1]>this.max[1])}encapsulate(t){for(let i=0;i<3;i++)this.min[i]=Math.min(this.min[i],t.min[i]),this.max[i]=Math.max(this.max[i],t.max[i])}encapsulatePoint(t){for(let i=0;i<3;i++)this.min[i]=Math.min(this.min[i],t[i]),this.max[i]=Math.max(this.max[i],t[i])}closestPoint(t){return[Math.max(Math.min(this.max[0],t[0]),this.min[0]),Math.max(Math.min(this.max[1],t[1]),this.min[1]),Math.max(Math.min(this.max[2],t[2]),this.min[2])]}}Se(nr,"Aabb");const sp=5,uc=6,as=Dt/Math.PI/2,V9=16383,ld=64,aw=[ld,32,16],Ao=-as,Co=as,U9=[new nr([Ao,Ao,Ao],[Co,Co,Co]),new nr([Ao,Ao,Ao],[0,0,Co]),new nr([0,Ao,Ao],[Co,0,Co]),new nr([Ao,0,Ao],[0,Co,Co]),new nr([0,0,Ao],[Co,Co,Co])];function E_(n){return n*as/ud}function BD(n,t,i,o=!0){const c=ct.scale([],n._camera.position,n.worldSize),u=[t,i,1,1];jn.transformMat4(u,u,n.pixelMatrixInverse),jn.scale(u,u,1/u[3]);const d=ct.sub([],u,c),p=ct.normalize([],d),g=n.globeMatrix,_=[g[12],g[13],g[14]],v=ct.sub([],_,c),b=ct.length(v),S=ct.normalize([],v),E=n.worldSize/(2*Math.PI),A=ct.dot(S,p),C=Math.asin(E/b);if(C<Math.acos(A)){if(!o)return null;const rt=[],it=[];ct.scale(rt,p,b/A),ct.normalize(it,ct.sub(it,rt,v)),ct.normalize(p,ct.add(p,v,ct.scale(p,it,Math.tan(C)*b)))}const P=[];new T_(c,p).closestPointOnSphere(_,E,P);const k=ct.normalize([],or(g,0)),L=ct.normalize([],or(g,1)),j=ct.normalize([],or(g,2)),V=ct.dot(k,P),F=ct.dot(L,P),U=ct.dot(j,P),q=St(Math.asin(-F/E));let Z=St(Math.atan2(V,U));Z=n.center.lng+function(rt,it){const ut=(it-rt+180)%360-180;return ut<-180?ut+360:ut}(n.center.lng,Z);const X=ti(Z),J=Ot(ui(q),0,1);return new vn(X,J)}class $9{constructor(t,i,o){this.a=ct.sub([],t,o),this.b=ct.sub([],i,o),this.center=o;const c=ct.normalize([],this.a),u=ct.normalize([],this.b);this.angle=Math.acos(ct.dot(c,u))}}function lw(n,t){if(n.angle===0)return null;let i;return i=n.a[t]===0?1/n.angle*.5*Math.PI:1/n.angle*Math.atan(n.b[t]/n.a[t]/Math.sin(n.angle)-1/Math.tan(n.angle)),i<0||i>1?null:function(o,c,u,d){const p=Math.sin(u);return o*(Math.sin((1-d)*u)/p)+c*(Math.sin(d*u)/p)}(n.a[t],n.b[t],n.angle,Ot(i,0,1))+n.center[t]}function no(n){if(n.z<=1)return U9[n.z+2*n.y+n.x];const t=uw(M_(n));return nr.fromPoints(t)}function dl(n,t,i){return ct.scale(n,n,1-i),ct.scaleAndAdd(n,n,t,i)}function jD(n,t){const i=vi(t.zoom);if(i===0)return no(n);const o=M_(n),c=uw(o),u=ti(o.getWest())*t.worldSize,d=ti(o.getEast())*t.worldSize,p=ui(o.getNorth())*t.worldSize,g=ui(o.getSouth())*t.worldSize,_=[u,p,0],v=[d,p,0],b=[u,g,0],S=[d,g,0],E=wt.invert([],t.globeMatrix);return ct.transformMat4(_,_,E),ct.transformMat4(v,v,E),ct.transformMat4(b,b,E),ct.transformMat4(S,S,E),c[0]=dl(c[0],b,i),c[1]=dl(c[1],S,i),c[2]=dl(c[2],v,i),c[3]=dl(c[3],_,i),nr.fromPoints(c)}function VD(n,t,i){for(const o of n)ct.transformMat4(o,o,t),ct.scale(o,o,i)}function cw(n,t,i,o){const c=t/n.worldSize,u=n.globeMatrix;if(i.z<=1){const X=no(i).getCorners();return VD(X,u,c),nr.fromPoints(X)}const d=M_(i,o),p=uw(d);VD(p,u,c);const g=Number.MAX_VALUE,_=[-g,-g,-g],v=[g,g,g];if(d.contains(n.center)){for(const rt of p)ct.min(v,v,rt),ct.max(_,_,rt);_[2]=0;const X=n.point,J=[X.x*c,X.y*c,0];return ct.min(v,v,J),ct.max(_,_,J),new nr(v,_)}const b=[u[12]*c,u[13]*c,u[14]*c],S=d.getCenter(),E=Ot(n.center.lat,-Ir,Ir),A=Ot(S.lat,-Ir,Ir),C=ti(n.center.lng),P=ui(E);let k=C-ti(S.lng);const L=P-ui(A);k>.5?k-=1:k<-.5&&(k+=1);let j=0;if(Math.abs(k)>Math.abs(L))j=k>=0?1:3;else{j=L>=0?0:2;const X=[u[4]*c,u[5]*c,u[6]*c],J=-Math.sin(st(L>=0?d.getSouth():d.getNorth()))*as;ct.scaleAndAdd(b,b,X,J)}const V=p[j],F=p[(j+1)%4],U=new $9(V,F,b),q=[lw(U,0)||V[0],lw(U,1)||V[1],lw(U,2)||V[2]],Z=vi(n.zoom);if(Z>0){const X=function({x:rt,y:it,z:ut},tt,dt,gt,xt){const ht=1/(1<<ut);let pt=rt*ht,Et=pt+ht,At=it*ht,Mt=At+ht,Lt=0;const Nt=(pt+Et)/2-gt;return Nt>.5?Lt=-1:Nt<-.5&&(Lt=1),pt=((pt+Lt)*tt-(gt*=tt))*dt+gt,Et=((Et+Lt)*tt-gt)*dt+gt,At=(At*tt-(xt*=tt))*dt+xt,Mt=(Mt*tt-xt)*dt+xt,[[pt,Mt,0],[Et,Mt,0],[Et,At,0],[pt,At,0]]}(i,t,n._pixelsPerMercatorPixel,C,P);for(let rt=0;rt<p.length;rt++)dl(p[rt],X[rt],Z);const J=ct.add([],X[j],X[(j+1)%4]);ct.scale(J,J,.5),dl(q,J,Z)}for(const X of p)ct.min(v,v,X),ct.max(_,_,X);return v[2]=Math.min(V[2],F[2]),ct.min(v,v,q),ct.max(_,_,q),new nr(v,_)}function M_({x:n,y:t,z:i},o=!1){const c=1/(1<<i),u=new Ze(Ls(n*c),t===(1<<i)-1&&o?-90:qr((t+1)*c)),d=new Ze(Ls((n+1)*c),t===0&&o?90:qr(t*c));return new Os(u,d)}function uw(n){const t=st(n.getNorth()),i=st(n.getSouth()),o=Math.cos(t),c=Math.cos(i),u=Math.sin(t),d=Math.sin(i),p=n.getWest(),g=n.getEast();return[cd(c,d,p),cd(c,d,g),cd(o,u,g),cd(o,u,p)]}function cd(n,t,i,o=as){return i=st(i),[n*Math.sin(i)*o,-t*o,n*Math.cos(i)*o]}function ws(n,t,i){return cd(Math.cos(st(n)),Math.sin(st(n)),t,i)}function op(n,t,i,o){const c=1<<i.z,u=(n/Dt+i.x)/c;return ws(qr((t/Dt+i.y)/c),Ls(u),o)}function A_({min:n,max:t}){return V9/Math.max(t[0]-n[0],t[1]-n[1],t[2]-n[2])}const UD=new Float64Array(16);function hc(n){const t=A_(n),i=wt.fromScaling(UD,[t,t,t]);return wt.translate(i,i,ct.negate([],n.min))}function hw(n){const t=wt.fromTranslation(UD,n.min),i=1/A_(n);return wt.scale(t,t,[i,i,i])}function dw(n){const t=Dt/(2*Math.PI);return n/(2*Math.PI)/t}function $D(n,t){return Dt/(512*Math.pow(2,n))*A_(no(t))}function GD(n,t,i,o,c){const u=dw(i),d=[n,t,-i/(2*Math.PI)],p=wt.identity(new Float64Array(16));return wt.translate(p,p,d),wt.scale(p,p,[u,u,u]),wt.rotateX(p,p,st(-c)),wt.rotateY(p,p,st(-o)),p}function WD(n){const t=n.pixelsPerMeter,i=t/$n(1,n.center.lat),o=wt.identity(new Float64Array(16));return wt.translate(o,o,[n.point.x,n.point.y,0]),wt.scale(o,o,[i,i,t]),Float32Array.from(o)}function vi(n){return Me(sp,uc,n)}function HD(n,t,i){const o=wt.identity(new Float64Array(16)),c=(t/(1<<n)-.5)*Math.PI*2;return wt.rotateY(o,i.globeMatrix,c),Float32Array.from(o)}function qD(n,t,i){const o=vi(i.zoom),c=n.style.map._antialias,u=t.options.extStandardDerivativesForceOff||n.terrain&&n.terrain.exaggeration()>0;return o===0&&!c&&!u}function ZD(n,t,i,o){const c=t.getNorth(),u=t.getSouth(),d=t.getWest(),p=t.getEast(),g=1<<n.z,_=p-d,v=c-u,b=_/ld,S=-v/aw[i],E=[0,b,0,S,0,0,c,d,0];if(n.z>0){const A=180/o;bs.multiply(E,E,[A/_+1,0,0,0,A/v+1,0,-.5*A/b,.5*A/S,1])}return E[2]=g,E[5]=n.x,E[8]=n.y,E}function G9(n){const t=Ir-5;n=Ot(n,-t,t)/t*90;const i=Math.pow(Math.abs(Math.sin(st(n))),3);return Math.round(i*(aw.length-1))}function XD(n){const t=[0,0,0],i=wt.identity(new Float64Array(16));return wt.multiply(i,n.pixelMatrix,n.globeMatrix),ct.transformMat4(t,t,i),new W(t[0],t[1])}function YD(n,t){const i=ws(t.lat,t.lng),o=function(u){const d=ws(u._center.lat,u._center.lng),p=ct.fromValues(0,1,0);let g=ct.cross([],p,d);const _=wt.fromRotation([],-u.angle,d);g=ct.transformMat4(g,g,_),wt.fromRotation(_,-u._pitch,g);const v=ct.normalize([],d);return ct.scale(v,v,E_(u.cameraToCenterDistance/u.pixelsPerMeter)),ct.transformMat4(v,v,_),ct.add([],d,v)}(n),c=ct.subtract([],o,i);return ct.angle(c,i)}function C_(n,t){return YD(n,t)>Math.PI/2*1.01}const KD=st(85),W9=Math.cos(KD),H9=Math.sin(KD);class q9{constructor(t){this._createGrid(t),this._createPoles(t)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const t of this._poleSegments)t.destroy();for(const t of this._gridSegments)t.withSkirts.destroy(),t.withoutSkirts.destroy()}_fillGridMeshWithLods(t,i){const o=new Ds,c=new Hr,u=[],d=t+1+2,p=i[0]+1,g=i[0]+1+(1+i.length),_=(v,b,S)=>{let E=v===d-1?v-2:v===0?v:v-1;return E+=S?24575:0,[E,b]};for(let v=0;v<d;++v)o.emplaceBack(..._(v,0,!0));for(let v=0;v<p;++v)for(let b=0;b<d;++b)o.emplaceBack(..._(b,v,(b===0||b===d-1)&&!0));for(let v=0;v<i.length;++v){const b=i[v];for(let S=0;S<d;++S)o.emplaceBack(..._(S,b,!0))}for(let v=0;v<i.length;++v){const b=c.length,S=i[v]+1+2,E=new Hr;for(let P=0;P<S-1;P++){const k=P===S-2,L=k?d*(g-i.length+v-P):d;for(let j=0;j<d-1;j++){const V=P*d+j;P===0||k||j===0||j===d-2?(E.emplaceBack(V+1,V,V+L),E.emplaceBack(V+L,V+L+1,V+1)):(c.emplaceBack(V+1,V,V+L),c.emplaceBack(V+L,V+L+1,V+1))}}const A=Bn.simpleSegment(0,b,o.length,c.length-b);for(let P=0;P<E.uint16.length;P+=3)c.emplaceBack(E.uint16[P],E.uint16[P+1],E.uint16[P+2]);const C=Bn.simpleSegment(0,b,o.length,c.length-b);u.push({withoutSkirts:A,withSkirts:C})}return{vertices:o,indices:c,segments:u}}_createGrid(t){const i=this._fillGridMeshWithLods(ld,aw);this._gridSegments=i.segments,this._gridBuffer=t.createVertexBuffer(i.vertices,cc.members),this._gridIndexBuffer=t.createIndexBuffer(i.indices,!0)}_createPoles(t){const i=new Hr;for(let p=0;p<=ld;p++)i.emplaceBack(0,p+1,p+2);this._poleIndexBuffer=t.createIndexBuffer(i,!0);const o=new Ru,c=new Ru,u=new Ru,d=new Ru;this._poleSegments=[];for(let p=0,g=0;p<sp;p++){const _=360/(1<<p);o.emplaceBack(0,-as,0,.5,0),c.emplaceBack(0,-as,0,.5,1),u.emplaceBack(0,-as,0,.5,.5),d.emplaceBack(0,-as,0,.5,.5);for(let v=0;v<=ld;v++){let b=v/ld,S=0;const E=qe(0,_,b),[A,C,P]=cd(W9,H9,E,as);o.emplaceBack(A,C,P,b,S),c.emplaceBack(A,C,P,b,1-S);const k=st(E);b=.5+.5*Math.sin(k),S=.5+.5*Math.cos(k),u.emplaceBack(A,C,P,b,S),d.emplaceBack(A,C,P,b,1-S)}this._poleSegments.push(Bn.simpleSegment(g,0,66,64)),g+=66}this._poleNorthVertexBuffer=t.createVertexBuffer(o,S_,!1),this._poleSouthVertexBuffer=t.createVertexBuffer(c,S_,!1),this._texturedPoleNorthVertexBuffer=t.createVertexBuffer(u,S_,!1),this._texturedPoleSouthVertexBuffer=t.createVertexBuffer(d,S_,!1)}getGridBuffers(t,i){return[this._gridBuffer,this._gridIndexBuffer,i?this._gridSegments[t].withSkirts:this._gridSegments[t].withoutSkirts]}getPoleBuffers(t,i){return[i?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,i?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[t]]}}const ud=63710088e-1,fw=2*Math.PI*ud;class dc{constructor(t,i){if(isNaN(t)||isNaN(i))throw new Error(`Invalid LngLat object: (${t}, ${i})`);if(this.lng=+t,this.lat=+i,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new dc(me(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const i=Math.PI/180,o=this.lat*i,c=t.lat*i,u=Math.sin(o)*Math.sin(c)+Math.cos(o)*Math.cos(c)*Math.cos((t.lng-this.lng)*i);return ud*Math.acos(Math.min(u,1))}toBounds(t=0){const i=360*t/40075017,o=i/Math.cos(Math.PI/180*this.lat);return new Os(new dc(this.lng-o,this.lat-i),new dc(this.lng+o,this.lat+i))}toEcef(t){const i=E_(t);return ws(this.lat,this.lng,as+i)}static convert(t){if(t instanceof dc)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new dc(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new dc(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var Ze=dc;const Z9=0,X9=25.5;function P_(n){return fw*Math.cos(n*Math.PI/180)}function ti(n){return(180+n)/360}function ui(n){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n*Math.PI/360)))/360}function $n(n,t){return n/P_(t)}function Ls(n){return 360*n-180}function qr(n){return 360/Math.PI*Math.atan(Math.exp((180-360*n)*Math.PI/180))-90}function JD(n,t){return n*P_(qr(t))}const Ir=85.051129;function QD(n){return Math.cos(st(Ot(n,-Ir,Ir)))}function fc(n,t){const i=Ot(t,Z9,X9),o=Math.pow(2,i);return QD(n)*fw/(512*o)}function pw(n){return 1/Math.cos(n*Math.PI/180)}function ap(n,t=0){const i=Math.exp(Math.PI*(1-(n.y+t/Dt)/(1<<n.z)*2));return 80150034*i/(i*i+1)/Dt/(1<<n.z)}class vn{constructor(t,i,o=0){this.x=+t,this.y=+i,this.z=+o}static fromLngLat(t,i=0){const o=Ze.convert(t);return new vn(ti(o.lng),ui(o.lat),$n(i,o.lat))}toLngLat(){return new Ze(Ls(this.x),qr(this.y))}toAltitude(){return JD(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/fw*pw(qr(this.y))}}function mw(n,t,i,o,c,u,d,p,g){const _=(t+o)/2,v=(i+c)/2,b=new W(_,v);p(b),function(S,E,A,C,P,k){const L=A-P,j=C-k;return Math.abs((C-E)*L-(A-S)*j)/Math.hypot(L,j)}(b.x,b.y,u.x,u.y,d.x,d.y)>=g?(mw(n,t,i,_,v,u,b,p,g),mw(n,_,v,o,c,b,d,p,g)):n.push(d)}function tR(n,t,i){let o=n[0],c=o.x,u=o.y;t(o);const d=[o];for(let p=1;p<n.length;p++){const g=n[p],{x:_,y:v}=g;t(g),mw(d,c,u,_,v,o,g,t,i),c=_,u=v,o=g}return d}function gw(n,t,i,o){if(o(t,i)){const c=t.add(i)._mult(.5);gw(n,t,c,o),gw(n,c,i,o)}else n.push(i)}function Y9(n,t){let i=n[0];const o=[i];for(let c=1;c<n.length;c++){const u=n[c];gw(o,i,u,t),i=u}return o}const _w=Math.pow(2,14)-1,eR=-_w-1;function K9(n,t){const i=Math.round(n.x*t),o=Math.round(n.y*t);return n.x=Ot(i,eR,_w),n.y=Ot(o,eR,_w),(i<n.x||i>n.x+1||o<n.y||o>n.y+1)&&_t("Geometry exceeds allowed extent, reduce your vector tile buffer size"),n}function Aa(n,t,i){const o=n.loadGeometry(),c=n.extent,u=Dt/c;if(t&&i&&i.projection.isReprojectedInTileSpace){const d=1<<t.z,{scale:p,x:g,y:_,projection:v}=i,b=S=>{const E=Ls((t.x+S.x/c)/d),A=qr((t.y+S.y/c)/d),C=v.project(E,A);S.x=(C.x*p-g)*c,S.y=(C.y*p-_)*c};for(let S=0;S<o.length;S++)if(n.type!==1)o[S]=tR(o[S],b,1);else{const E=[];for(const A of o[S])A.x<0||A.x>=c||A.y<0||A.y>=c||(b(A),E.push(A));o[S]=E}}for(const d of o)for(const p of d)K9(p,u);return o}function pc(n,t){return{type:n.type,id:n.id,properties:n.properties,geometry:t?Aa(n):[]}}function I_(n,t,i,o,c){n.emplaceBack(2*t+(o+1)/2,2*i+(c+1)/2)}function k_(n,t,i){n.emplaceBack(t.x,t.y,t.z,i[0]*16384,i[1]*16384,i[2]*16384)}class yw{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(i=>i.fqid),this.index=t.index,this.hasPattern=!1,this.projection=t.projection,this.layoutVertexArray=new Ds,this.indexArray=new Hr,this.segments=new Bn,this.programConfigurations=new ac(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(t,i,o,c){const u=this.layers[0],d=[];let p=null;u.type==="circle"&&(p=u.layout.get("circle-sort-key"));for(const{feature:_,id:v,index:b,sourceLayerIndex:S}of t){const E=this.layers[0]._featureFilter.needGeometry,A=pc(_,E);if(!this.layers[0]._featureFilter.filter(new pr(this.zoom),A,o))continue;const C=p?p.evaluate(A,{},o):void 0,P={id:v,properties:_.properties,type:_.type,sourceLayerIndex:S,index:b,geometry:E?A.geometry:Aa(_,o,c),patterns:{},sortKey:C};d.push(P)}p&&d.sort((_,v)=>_.sortKey-v.sortKey);let g=null;c.projection.name==="globe"&&(this.globeExtVertexArray=new m_,g=c.projection);for(const _ of d){const{geometry:v,index:b,sourceLayerIndex:S}=_,E=t[b].feature;this.addFeature(_,v,b,i.availableImages,o,g,i.brightness),i.featureIndex.insert(E,v,b,S,this.index)}}update(t,i,o,c,u){const d=Object.keys(t).length!==0;d&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(t,i,d?this.stateDependentLayers:this.layers,o,c,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,a9.members),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,l9.members))),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(t,i,o,c,u,d,p){for(const g of i)for(const _ of g){const v=_.x,b=_.y;if(v<0||v>=Dt||b<0||b>=Dt)continue;if(d){const A=d.projectTilePoint(v,b,u),C=d.upVector(u,v,b),P=this.globeExtVertexArray;k_(P,A,C),k_(P,A,C),k_(P,A,C),k_(P,A,C)}const S=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),E=S.vertexLength;I_(this.layoutVertexArray,v,b,-1,-1),I_(this.layoutVertexArray,v,b,1,-1),I_(this.layoutVertexArray,v,b,1,1),I_(this.layoutVertexArray,v,b,-1,1),this.indexArray.emplaceBack(E,E+1,E+2),this.indexArray.emplaceBack(E,E+2,E+3),S.vertexLength+=4,S.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,o,{},c,u,p)}}function nR(n,t){for(let i=0;i<n.length;i++)if(mc(t,n[i]))return!0;for(let i=0;i<t.length;i++)if(mc(n,t[i]))return!0;return!!vw(n,t)}function J9(n,t,i){return!!mc(n,t)||!!xw(t,n,i)}function rR(n,t){if(n.length===1)return sR(t,n[0]);for(let i=0;i<t.length;i++){const o=t[i];for(let c=0;c<o.length;c++)if(mc(n,o[c]))return!0}for(let i=0;i<n.length;i++)if(sR(t,n[i]))return!0;for(let i=0;i<t.length;i++)if(vw(n,t[i]))return!0;return!1}function Q9(n,t,i){if(n.length>1){if(vw(n,t))return!0;for(let o=0;o<t.length;o++)if(xw(t[o],n,i))return!0}for(let o=0;o<n.length;o++)if(xw(n[o],t,i))return!0;return!1}function vw(n,t){if(n.length===0||t.length===0)return!1;for(let i=0;i<n.length-1;i++){const o=n[i],c=n[i+1];for(let u=0;u<t.length-1;u++)if(tG(o,c,t[u],t[u+1]))return!0}return!1}function tG(n,t,i,o){return Ut(n,i,o)!==Ut(t,i,o)&&Ut(n,t,i)!==Ut(n,t,o)}function xw(n,t,i){const o=i*i;if(t.length===1)return n.distSqr(t[0])<o;for(let c=1;c<t.length;c++)if(iR(n,t[c-1],t[c])<o)return!0;return!1}function iR(n,t,i){const o=t.distSqr(i);if(o===0)return n.distSqr(t);const c=((n.x-t.x)*(i.x-t.x)+(n.y-t.y)*(i.y-t.y))/o;return n.distSqr(c<0?t:c>1?i:i.sub(t)._mult(c)._add(t))}function sR(n,t){let i,o,c,u=!1;for(let d=0;d<n.length;d++){i=n[d];for(let p=0,g=i.length-1;p<i.length;g=p++)o=i[p],c=i[g],o.y>t.y!=c.y>t.y&&t.x<(c.x-o.x)*(t.y-o.y)/(c.y-o.y)+o.x&&(u=!u)}return u}function mc(n,t){let i=!1;for(let o=0,c=n.length-1;o<n.length;c=o++){const u=n[o],d=n[c];u.y>t.y!=d.y>t.y&&t.x<(d.x-u.x)*(t.y-u.y)/(d.y-u.y)+u.x&&(i=!i)}return i}function oR(n,t,i,o,c){for(const d of n)if(t<=d.x&&i<=d.y&&o>=d.x&&c>=d.y)return!0;const u=[new W(t,i),new W(t,c),new W(o,c),new W(o,i)];if(n.length>2){for(const d of u)if(mc(n,d))return!0}for(let d=0;d<n.length-1;d++)if(eG(n[d],n[d+1],u))return!0;return!1}function eG(n,t,i){const o=i[0],c=i[2];if(n.x<o.x&&t.x<o.x||n.x>c.x&&t.x>c.x||n.y<o.y&&t.y<o.y||n.y>c.y&&t.y>c.y)return!1;const u=Ut(n,t,i[0]);return u!==Ut(n,t,i[1])||u!==Ut(n,t,i[2])||u!==Ut(n,t,i[3])}function hd(n,t,i,o,c,u){let d=t.y-n.y,p=n.x-t.x;if(u=u||0){const g=d*d+p*p;if(g===0)return!0;const _=Math.sqrt(g);d/=_,p/=_}return!((i.x-n.x)*d+(i.y-n.y)*p-u<0||(o.x-n.x)*d+(o.y-n.y)*p-u<0||(c.x-n.x)*d+(c.y-n.y)*p-u<0)}function bw(n,t,i,o,c,u,d){return!(hd(n,t,o,c,u,d)||hd(t,i,o,c,u,d)||hd(i,n,o,c,u,d)||hd(o,c,n,t,i,d)||hd(c,u,n,t,i,d)||hd(u,o,n,t,i,d))}function dd(n,t,i){const o=t.paint.get(n).value;return o.kind==="constant"?o.value:i.programConfigurations.get(t.id).getMaxValue(n)}function D_(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function aR(n,t,i,o,c){if(!t[0]&&!t[1])return n;const u=W.convert(t)._mult(c);i==="viewport"&&u._rotate(-o);const d=[];for(let p=0;p<n.length;p++)d.push(n[p].sub(u));return d}function lR(n,t,i,o){const c=W.convert(n)._mult(o);return t==="viewport"&&c._rotate(-i),c}Se(yw,"CircleBucket",{omit:["layers"]});const nG=new Tr({"circle-sort-key":new ze(vt.layout_circle["circle-sort-key"]),visibility:new te(vt.layout_circle.visibility)});var rG={paint:new Tr({"circle-radius":new ze(vt.paint_circle["circle-radius"]),"circle-color":new ze(vt.paint_circle["circle-color"]),"circle-blur":new ze(vt.paint_circle["circle-blur"]),"circle-opacity":new ze(vt.paint_circle["circle-opacity"]),"circle-translate":new te(vt.paint_circle["circle-translate"]),"circle-translate-anchor":new te(vt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new te(vt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new te(vt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ze(vt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ze(vt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ze(vt.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new te(vt.paint_circle["circle-emissive-strength"])}),layout:nG};const iG=wt.create(),sG=(n,t,i,o,c,u)=>{const d=n.transform,p=d.projection.name==="globe";let g;if(u.paint.get("circle-pitch-alignment")==="map")if(p){const v=$D(d.zoom,t.canonical)*d._pixelsPerMercatorPixel;g=Float32Array.from([v,0,0,v])}else g=d.calculatePixelsToTileUnitsMatrix(i);else g=new Float32Array([d.pixelsToGLUnits[0],0,0,d.pixelsToGLUnits[1]]);const _={u_camera_to_center_distance:n.transform.getCameraToCenterDistance(d.projection),u_matrix:n.translatePosMatrix(t.projMatrix,i,u.paint.get("circle-translate"),u.paint.get("circle-translate-anchor")),u_device_pixel_ratio:Be.devicePixelRatio,u_extrude_scale:g,u_inv_rot_matrix:iG,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:u.paint.get("circle-emissive-strength")};if(p){_.u_inv_rot_matrix=o,_.u_merc_center=c,_.u_tile_id=[t.canonical.x,t.canonical.y,1<<t.canonical.z],_.u_zoom_transition=vi(d.zoom);const v=c[0]*Dt,b=c[1]*Dt;_.u_up_dir=d.projection.upVector(new Mo(0,0,0),v,b)}return _},cR=n=>{const t=[];return n.paint.get("circle-pitch-alignment")==="map"&&t.push("PITCH_WITH_MAP"),n.paint.get("circle-pitch-scale")==="map"&&t.push("SCALE_WITH_MAP"),t};function uR(n,t,i,o,c,u,d,p,g){if(u&&n.queryGeometry.isAboveHorizon)return!1;u&&(g*=n.pixelToTileUnitsFactor);const _=n.tileID.canonical,v=i.projection.upVectorScale(_,i.center.lat,i.worldSize).metersToTile;for(const b of t)for(const S of b){const E=S.add(p),A=c&&i.elevation?i.elevation.exaggeration()*c.getElevationAt(E.x,E.y,!0):0,C=i.projection.projectTilePoint(E.x,E.y,_);if(A>0){const j=i.projection.upVector(_,E.x,E.y);C.x+=j[0]*v*A,C.y+=j[1]*v*A,C.z+=j[2]*v*A}const P=u?E:oG(C.x,C.y,C.z,o),k=u?n.tilespaceRays.map(j=>lG(j,A)):n.queryGeometry.screenGeometry,L=jn.transformMat4([],[C.x,C.y,C.z,1],o);if(!d&&u?g*=L[3]/i.cameraToCenterDistance:d&&!u&&(g*=i.cameraToCenterDistance/L[3]),u){const j=qr((S.y/Dt+_.y)/(1<<_.z));g/=i.projection.pixelsPerMeter(j,1)/$n(1,j)}if(J9(k,P,g))return!0}return!1}function oG(n,t,i,o){const c=jn.transformMat4([],[n,t,i,1],o);return new W(c[0]/c[3],c[1]/c[3])}const hR=ct.fromValues(0,0,0),aG=ct.fromValues(0,0,1);function lG(n,t){const i=ct.create();return hR[2]=t,n.intersectsPlane(hR,aG,i),new W(i[0],i[1])}class dR extends yw{}function fR(n,{width:t,height:i},o,c){if(c){if(c instanceof Uint8ClampedArray)c=new Uint8Array(c.buffer);else if(c.length!==t*i*o)throw new RangeError("mismatched image size")}else c=new Uint8Array(t*i*o);return n.width=t,n.height=i,n.data=c,n}function pR(n,t,i){const{width:o,height:c}=t;o===n.width&&c===n.height||(ww(n,t,{x:0,y:0},{x:0,y:0},{width:Math.min(n.width,o),height:Math.min(n.height,c)},i),n.width=o,n.height=c,n.data=t.data)}function ww(n,t,i,o,c,u){if(c.width===0||c.height===0)return t;if(c.width>n.width||c.height>n.height||i.x>n.width-c.width||i.y>n.height-c.height)throw new RangeError("out of range source coordinates for image copy");if(c.width>t.width||c.height>t.height||o.x>t.width-c.width||o.y>t.height-c.height)throw new RangeError("out of range destination coordinates for image copy");const d=n.data,p=t.data;for(let g=0;g<c.height;g++){const _=((i.y+g)*n.width+i.x)*u,v=((o.y+g)*t.width+o.x)*u;for(let b=0;b<c.width*u;b++)p[v+b]=d[_+b]}return t}Se(dR,"HeatmapBucket",{omit:["layers"]});class fl{constructor(t,i){fR(this,t,1,i)}resize(t){pR(this,new fl(t),1)}clone(){return new fl({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,i,o,c,u){ww(t,i,o,c,u,1)}}class Fr{constructor(t,i){fR(this,t,4,i)}resize(t){pR(this,new Fr(t),4)}replace(t,i){i?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new Fr({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,i,o,c,u){ww(t,i,o,c,u,4)}}class mR{constructor(t,i){this.width=t.width,this.height=t.height,this.data=i instanceof Uint8Array?new Float32Array(i.buffer):i}}Se(fl,"AlphaImage"),Se(Fr,"RGBAImage");const cG=new Tr({visibility:new te(vt.layout_heatmap.visibility)});var uG={paint:new Tr({"heatmap-radius":new ze(vt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ze(vt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new te(vt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Kf(vt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new te(vt.paint_heatmap["heatmap-opacity"])}),layout:cG};function R_(n){const t={},i=n.resolution||256,o=n.clips?n.clips.length:1,c=n.image||new Fr({width:i,height:o}),u=(d,p,g)=>{t[n.evaluationKey]=g;const _=n.expression.evaluate(t);_&&(c.data[d+p+0]=Math.floor(255*_.r/_.a),c.data[d+p+1]=Math.floor(255*_.g/_.a),c.data[d+p+2]=Math.floor(255*_.b/_.a),c.data[d+p+3]=Math.floor(255*_.a))};if(n.clips)for(let d=0,p=0;d<o;++d,p+=4*i)for(let g=0,_=0;g<i;g++,_+=4){const v=g/(i-1),{start:b,end:S}=n.clips[d];u(p,_,b*(1-v)+S*v)}else for(let d=0,p=0;d<i;d++,p+=4)u(0,p,d/(i-1));return c}const hG=new Tr({visibility:new te(vt.layout_hillshade.visibility)});var dG={paint:new Tr({"hillshade-illumination-direction":new te(vt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new te(vt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new te(vt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new te(vt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new te(vt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new te(vt.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new te(vt.paint_hillshade["hillshade-emissive-strength"])}),layout:hG};const fG=Rn([{name:"a_pos",components:2,type:"Int16"}],4),{members:pG}=fG;var Sw={exports:{}};function O_(n,t,i){i=i||2;var o,c,u,d,p,g,_,v=t&&t.length,b=v?t[0]*i:n.length,S=gR(n,0,b,i,!0),E=[];if(!S||S.next===S.prev)return E;if(v&&(S=function(C,P,k,L){var j,V,F,U=[];for(j=0,V=P.length;j<V;j++)(F=gR(C,P[j]*L,j<V-1?P[j+1]*L:C.length,L,!1))===F.next&&(F.steiner=!0),U.push(wG(F));for(U.sort(vG),j=0;j<U.length;j++)k=xG(U[j],k);return k}(n,t,S,i)),n.length>80*i){o=u=n[0],c=d=n[1];for(var A=i;A<b;A+=i)(p=n[A])<o&&(o=p),(g=n[A+1])<c&&(c=g),p>u&&(u=p),g>d&&(d=g);_=(_=Math.max(u-o,d-c))!==0?32767/_:0}return lp(S,E,i,o,c,_,0),E}function gR(n,t,i,o,c){var u,d;if(c===Mw(n,t,i,o)>0)for(u=t;u<i;u+=o)d=vR(u,n[u],n[u+1],d);else for(u=i-o;u>=t;u-=o)d=vR(u,n[u],n[u+1],d);return d&&L_(d,d.next)&&(up(d),d=d.next),d}function Fu(n,t){if(!n)return n;t||(t=n);var i,o=n;do if(i=!1,o.steiner||!L_(o,o.next)&&ei(o.prev,o,o.next)!==0)o=o.next;else{if(up(o),(o=t=o.prev)===o.next)break;i=!0}while(i||o!==t);return t}function lp(n,t,i,o,c,u,d){if(n){!d&&u&&function(v,b,S,E){var A=v;do A.z===0&&(A.z=Tw(A.x,A.y,b,S,E)),A.prevZ=A.prev,A.nextZ=A.next,A=A.next;while(A!==v);A.prevZ.nextZ=null,A.prevZ=null,function(C){var P,k,L,j,V,F,U,q,Z=1;do{for(k=C,C=null,V=null,F=0;k;){for(F++,L=k,U=0,P=0;P<Z&&(U++,L=L.nextZ);P++);for(q=Z;U>0||q>0&&L;)U!==0&&(q===0||!L||k.z<=L.z)?(j=k,k=k.nextZ,U--):(j=L,L=L.nextZ,q--),V?V.nextZ=j:C=j,j.prevZ=V,V=j;k=L}V.nextZ=null,Z*=2}while(F>1)}(A)}(n,o,c,u);for(var p,g,_=n;n.prev!==n.next;)if(p=n.prev,g=n.next,u?gG(n,o,c,u):mG(n))t.push(p.i/i|0),t.push(n.i/i|0),t.push(g.i/i|0),up(n),n=g.next,_=g.next;else if((n=g)===_){d?d===1?lp(n=_G(Fu(n),t,i),t,i,o,c,u,2):d===2&&yG(n,t,i,o,c,u):lp(Fu(n),t,i,o,c,u,1);break}}}function mG(n){var t=n.prev,i=n,o=n.next;if(ei(t,i,o)>=0)return!1;for(var c=t.x,u=i.x,d=o.x,p=t.y,g=i.y,_=o.y,v=c<u?c<d?c:d:u<d?u:d,b=p<g?p<_?p:_:g<_?g:_,S=c>u?c>d?c:d:u>d?u:d,E=p>g?p>_?p:_:g>_?g:_,A=o.next;A!==t;){if(A.x>=v&&A.x<=S&&A.y>=b&&A.y<=E&&fd(c,p,u,g,d,_,A.x,A.y)&&ei(A.prev,A,A.next)>=0)return!1;A=A.next}return!0}function gG(n,t,i,o){var c=n.prev,u=n,d=n.next;if(ei(c,u,d)>=0)return!1;for(var p=c.x,g=u.x,_=d.x,v=c.y,b=u.y,S=d.y,E=p<g?p<_?p:_:g<_?g:_,A=v<b?v<S?v:S:b<S?b:S,C=p>g?p>_?p:_:g>_?g:_,P=v>b?v>S?v:S:b>S?b:S,k=Tw(E,A,t,i,o),L=Tw(C,P,t,i,o),j=n.prevZ,V=n.nextZ;j&&j.z>=k&&V&&V.z<=L;){if(j.x>=E&&j.x<=C&&j.y>=A&&j.y<=P&&j!==c&&j!==d&&fd(p,v,g,b,_,S,j.x,j.y)&&ei(j.prev,j,j.next)>=0||(j=j.prevZ,V.x>=E&&V.x<=C&&V.y>=A&&V.y<=P&&V!==c&&V!==d&&fd(p,v,g,b,_,S,V.x,V.y)&&ei(V.prev,V,V.next)>=0))return!1;V=V.nextZ}for(;j&&j.z>=k;){if(j.x>=E&&j.x<=C&&j.y>=A&&j.y<=P&&j!==c&&j!==d&&fd(p,v,g,b,_,S,j.x,j.y)&&ei(j.prev,j,j.next)>=0)return!1;j=j.prevZ}for(;V&&V.z<=L;){if(V.x>=E&&V.x<=C&&V.y>=A&&V.y<=P&&V!==c&&V!==d&&fd(p,v,g,b,_,S,V.x,V.y)&&ei(V.prev,V,V.next)>=0)return!1;V=V.nextZ}return!0}function _G(n,t,i){var o=n;do{var c=o.prev,u=o.next.next;!L_(c,u)&&_R(c,o,o.next,u)&&cp(c,u)&&cp(u,c)&&(t.push(c.i/i|0),t.push(o.i/i|0),t.push(u.i/i|0),up(o),up(o.next),o=n=u),o=o.next}while(o!==n);return Fu(o)}function yG(n,t,i,o,c,u){var d=n;do{for(var p=d.next.next;p!==d.prev;){if(d.i!==p.i&&SG(d,p)){var g=yR(d,p);return d=Fu(d,d.next),g=Fu(g,g.next),lp(d,t,i,o,c,u,0),void lp(g,t,i,o,c,u,0)}p=p.next}d=d.next}while(d!==n)}function vG(n,t){return n.x-t.x}function xG(n,t){var i=function(c,u){var d,p=u,g=c.x,_=c.y,v=-1/0;do{if(_<=p.y&&_>=p.next.y&&p.next.y!==p.y){var b=p.x+(_-p.y)*(p.next.x-p.x)/(p.next.y-p.y);if(b<=g&&b>v&&(v=b,d=p.x<p.next.x?p:p.next,b===g))return d}p=p.next}while(p!==u);if(!d)return null;var S,E=d,A=d.x,C=d.y,P=1/0;p=d;do g>=p.x&&p.x>=A&&g!==p.x&&fd(_<C?g:v,_,A,C,_<C?v:g,_,p.x,p.y)&&(S=Math.abs(_-p.y)/(g-p.x),cp(p,c)&&(S<P||S===P&&(p.x>d.x||p.x===d.x&&bG(d,p)))&&(d=p,P=S)),p=p.next;while(p!==E);return d}(n,t);if(!i)return t;var o=yR(i,n);return Fu(o,o.next),Fu(i,i.next)}function bG(n,t){return ei(n.prev,n,t.prev)<0&&ei(t.next,n,n.next)<0}function Tw(n,t,i,o,c){return(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-i)*c|0)|n<<8))|n<<4))|n<<2))|n<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-o)*c|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function wG(n){var t=n,i=n;do(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next;while(t!==n);return i}function fd(n,t,i,o,c,u,d,p){return(c-d)*(t-p)>=(n-d)*(u-p)&&(n-d)*(o-p)>=(i-d)*(t-p)&&(i-d)*(u-p)>=(c-d)*(o-p)}function SG(n,t){return n.next.i!==t.i&&n.prev.i!==t.i&&!function(i,o){var c=i;do{if(c.i!==i.i&&c.next.i!==i.i&&c.i!==o.i&&c.next.i!==o.i&&_R(c,c.next,i,o))return!0;c=c.next}while(c!==i);return!1}(n,t)&&(cp(n,t)&&cp(t,n)&&function(i,o){var c=i,u=!1,d=(i.x+o.x)/2,p=(i.y+o.y)/2;do c.y>p!=c.next.y>p&&c.next.y!==c.y&&d<(c.next.x-c.x)*(p-c.y)/(c.next.y-c.y)+c.x&&(u=!u),c=c.next;while(c!==i);return u}(n,t)&&(ei(n.prev,n,t.prev)||ei(n,t.prev,t))||L_(n,t)&&ei(n.prev,n,n.next)>0&&ei(t.prev,t,t.next)>0)}function ei(n,t,i){return(t.y-n.y)*(i.x-t.x)-(t.x-n.x)*(i.y-t.y)}function L_(n,t){return n.x===t.x&&n.y===t.y}function _R(n,t,i,o){var c=N_(ei(n,t,i)),u=N_(ei(n,t,o)),d=N_(ei(i,o,n)),p=N_(ei(i,o,t));return c!==u&&d!==p||!(c!==0||!z_(n,i,t))||!(u!==0||!z_(n,o,t))||!(d!==0||!z_(i,n,o))||!(p!==0||!z_(i,t,o))}function z_(n,t,i){return t.x<=Math.max(n.x,i.x)&&t.x>=Math.min(n.x,i.x)&&t.y<=Math.max(n.y,i.y)&&t.y>=Math.min(n.y,i.y)}function N_(n){return n>0?1:n<0?-1:0}function cp(n,t){return ei(n.prev,n,n.next)<0?ei(n,t,n.next)>=0&&ei(n,n.prev,t)>=0:ei(n,t,n.prev)<0||ei(n,n.next,t)<0}function yR(n,t){var i=new Ew(n.i,n.x,n.y),o=new Ew(t.i,t.x,t.y),c=n.next,u=t.prev;return n.next=t,t.prev=n,i.next=c,c.prev=i,o.next=i,i.prev=o,u.next=o,o.prev=u,o}function vR(n,t,i,o){var c=new Ew(n,t,i);return o?(c.next=o.next,c.prev=o,o.next.prev=c,o.next=c):(c.prev=c,c.next=c),c}function up(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function Ew(n,t,i){this.i=n,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Mw(n,t,i,o){for(var c=0,u=t,d=i-o;u<i;u+=o)c+=(n[d]-n[u])*(n[u+1]+n[d+1]),d=u;return c}Sw.exports=O_,Sw.exports.default=O_,O_.deviation=function(n,t,i,o){var c=t&&t.length,u=Math.abs(Mw(n,0,c?t[0]*i:n.length,i));if(c)for(var d=0,p=t.length;d<p;d++)u-=Math.abs(Mw(n,t[d]*i,d<p-1?t[d+1]*i:n.length,i));var g=0;for(d=0;d<o.length;d+=3){var _=o[d]*i,v=o[d+1]*i,b=o[d+2]*i;g+=Math.abs((n[_]-n[b])*(n[v+1]-n[_+1])-(n[_]-n[v])*(n[b+1]-n[_+1]))}return u===0&&g===0?0:Math.abs((g-u)/u)},O_.flatten=function(n){for(var t=n[0][0].length,i={vertices:[],holes:[],dimensions:t},o=0,c=0;c<n.length;c++){for(var u=0;u<n[c].length;u++)for(var d=0;d<t;d++)i.vertices.push(n[c][u][d]);c>0&&i.holes.push(o+=n[c-1].length)}return i};var F_=H(Sw.exports);function Aw(n,t){const i=n.length;if(i<=1)return[n];const o=[];let c,u;for(let d=0;d<i;d++){const p=Ht(n[d]);p!==0&&(n[d].area=Math.abs(p),u===void 0&&(u=p<0),u===p<0?(c&&o.push(c),c=[n[d]]):c.push(n[d]))}if(c&&o.push(c),t>1)for(let d=0;d<o.length;d++)o[d].length<=t||(o7(o[d],t,1,o[d].length-1,TG),o[d]=o[d].slice(0,t));return o}function TG(n,t){return t.area-n.area}function Cw(n,t,i){const o=i.patternDependencies;let c=!1;for(const u of t){const d=u.paint.get(`${n}-pattern`);d.isConstant()||(c=!0);const p=d.constantOr(null);p&&(c=!0,o[p]=!0)}return c}function Pw(n,t,i,o,c){const u=c.patternDependencies;for(const d of t){const p=d.paint.get(`${n}-pattern`).value;if(p.kind!=="constant"){let g=p.evaluate({zoom:o},i,{},c.availableImages);g=g&&g.name?g.name:g,u[g]=!0,i.patterns[d.id]=g}}return i}class B_{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(i=>i.fqid),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ds,this.indexArray=new Hr,this.indexArray2=new sc,this.programConfigurations=new ac(t.layers,t.zoom),this.segments=new Bn,this.segments2=new Bn,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.projection=t.projection}populate(t,i,o,c){this.hasPattern=Cw("fill",this.layers,i);const u=this.layers[0].layout.get("fill-sort-key"),d=[];for(const{feature:p,id:g,index:_,sourceLayerIndex:v}of t){const b=this.layers[0]._featureFilter.needGeometry,S=pc(p,b);if(!this.layers[0]._featureFilter.filter(new pr(this.zoom),S,o))continue;const E=u?u.evaluate(S,{},o,i.availableImages):void 0,A={id:g,properties:p.properties,type:p.type,sourceLayerIndex:v,index:_,geometry:b?S.geometry:Aa(p,o,c),patterns:{},sortKey:E};d.push(A)}u&&d.sort((p,g)=>p.sortKey-g.sortKey);for(const p of d){const{geometry:g,index:_,sourceLayerIndex:v}=p;if(this.hasPattern){const b=Pw("fill",this.layers,p,this.zoom,i);this.patternFeatures.push(b)}else this.addFeature(p,g,_,o,{},i.availableImages,i.brightness);i.featureIndex.insert(t[_].feature,g,_,v,this.index)}}update(t,i,o,c,u){const d=Object.keys(t).length!==0;d&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(t,i,d?this.stateDependentLayers:this.layers,o,c,u)}addFeatures(t,i,o,c,u,d){for(const p of this.patternFeatures)this.addFeature(p,p.geometry,p.index,i,o,c,d)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,pG),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,i,o,c,u,d=[],p){for(const g of Aw(i,500)){let _=0;for(const C of g)_+=C.length;const v=this.segments.prepareSegment(_,this.layoutVertexArray,this.indexArray),b=v.vertexLength,S=[],E=[];for(const C of g){if(C.length===0)continue;C!==g[0]&&E.push(S.length/2);const P=this.segments2.prepareSegment(C.length,this.layoutVertexArray,this.indexArray2),k=P.vertexLength;this.layoutVertexArray.emplaceBack(C[0].x,C[0].y),this.indexArray2.emplaceBack(k+C.length-1,k),S.push(C[0].x),S.push(C[0].y);for(let L=1;L<C.length;L++)this.layoutVertexArray.emplaceBack(C[L].x,C[L].y),this.indexArray2.emplaceBack(k+L-1,k+L),S.push(C[L].x),S.push(C[L].y);P.vertexLength+=C.length,P.primitiveLength+=C.length}const A=F_(S,E);for(let C=0;C<A.length;C+=3)this.indexArray.emplaceBack(b+A[C],b+A[C+1],b+A[C+2]);v.vertexLength+=_,v.primitiveLength+=A.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,o,u,d,c,p)}}Se(B_,"FillBucket",{omit:["layers","patternFeatures"]});const EG=new Tr({"fill-sort-key":new ze(vt.layout_fill["fill-sort-key"]),visibility:new te(vt.layout_fill.visibility)});var MG={paint:new Tr({"fill-antialias":new te(vt.paint_fill["fill-antialias"]),"fill-opacity":new ze(vt.paint_fill["fill-opacity"]),"fill-color":new ze(vt.paint_fill["fill-color"]),"fill-outline-color":new ze(vt.paint_fill["fill-outline-color"]),"fill-translate":new te(vt.paint_fill["fill-translate"]),"fill-translate-anchor":new te(vt.paint_fill["fill-translate-anchor"]),"fill-pattern":new ze(vt.paint_fill["fill-pattern"]),"fill-emissive-strength":new te(vt.paint_fill["fill-emissive-strength"])}),layout:EG};const AG=Rn([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),CG=Rn([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),PG=Rn([{name:"a_centroid_pos",components:2,type:"Uint16"}]),IG=Rn([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),kG=Rn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:DG}=AG;var j_={},RG=et,xR=pd;function pd(n,t,i,o,c){this.properties={},this.extent=i,this.type=0,this._pbf=n,this._geometry=-1,this._keys=o,this._values=c,n.readFields(OG,this,t)}function OG(n,t,i){n==1?t.id=i.readVarint():n==2?function(o,c){for(var u=o.readVarint()+o.pos;o.pos<u;){var d=c._keys[o.readVarint()],p=c._values[o.readVarint()];c.properties[d]=p}}(i,t):n==3?t.type=i.readVarint():n==4&&(t._geometry=i.pos)}function LG(n){for(var t,i,o=0,c=0,u=n.length,d=u-1;c<u;d=c++)o+=((i=n[d]).x-(t=n[c]).x)*(t.y+i.y);return o}pd.types=["Unknown","Point","LineString","Polygon"],pd.prototype.loadGeometry=function(){var n=this._pbf;n.pos=this._geometry;for(var t,i=n.readVarint()+n.pos,o=1,c=0,u=0,d=0,p=[];n.pos<i;){if(c<=0){var g=n.readVarint();o=7&g,c=g>>3}if(c--,o===1||o===2)u+=n.readSVarint(),d+=n.readSVarint(),o===1&&(t&&p.push(t),t=[]),t.push(new RG(u,d));else{if(o!==7)throw new Error("unknown command "+o);t&&t.push(t[0].clone())}}return t&&p.push(t),p},pd.prototype.bbox=function(){var n=this._pbf;n.pos=this._geometry;for(var t=n.readVarint()+n.pos,i=1,o=0,c=0,u=0,d=1/0,p=-1/0,g=1/0,_=-1/0;n.pos<t;){if(o<=0){var v=n.readVarint();i=7&v,o=v>>3}if(o--,i===1||i===2)(c+=n.readSVarint())<d&&(d=c),c>p&&(p=c),(u+=n.readSVarint())<g&&(g=u),u>_&&(_=u);else if(i!==7)throw new Error("unknown command "+i)}return[d,g,p,_]},pd.prototype.toGeoJSON=function(n,t,i){var o,c,u=this.extent*Math.pow(2,i),d=this.extent*n,p=this.extent*t,g=this.loadGeometry(),_=pd.types[this.type];function v(E){for(var A=0;A<E.length;A++){var C=E[A];E[A]=[360*(C.x+d)/u-180,360/Math.PI*Math.atan(Math.exp((180-360*(C.y+p)/u)*Math.PI/180))-90]}}switch(this.type){case 1:var b=[];for(o=0;o<g.length;o++)b[o]=g[o][0];v(g=b);break;case 2:for(o=0;o<g.length;o++)v(g[o]);break;case 3:for(g=function(E){var A=E.length;if(A<=1)return[E];for(var C,P,k=[],L=0;L<A;L++){var j=LG(E[L]);j!==0&&(P===void 0&&(P=j<0),P===j<0?(C&&k.push(C),C=[E[L]]):C.push(E[L]))}return C&&k.push(C),k}(g),o=0;o<g.length;o++)for(c=0;c<g[o].length;c++)v(g[o][c])}g.length===1?g=g[0]:_="Multi"+_;var S={type:"Feature",geometry:{type:_,coordinates:g},properties:this.properties};return"id"in this&&(S.id=this.id),S};var zG=xR,bR=wR;function wR(n,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=n,this._keys=[],this._values=[],this._features=[],n.readFields(NG,this,t),this.length=this._features.length}function NG(n,t,i){n===15?t.version=i.readVarint():n===1?t.name=i.readString():n===5?t.extent=i.readVarint():n===2?t._features.push(i.pos):n===3?t._keys.push(i.readString()):n===4&&t._values.push(function(o){for(var c=null,u=o.readVarint()+o.pos;o.pos<u;){var d=o.readVarint()>>3;c=d===1?o.readString():d===2?o.readFloat():d===3?o.readDouble():d===4?o.readVarint64():d===5?o.readVarint():d===6?o.readSVarint():d===7?o.readBoolean():null}return c}(i))}wR.prototype.feature=function(n){if(n<0||n>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[n];var t=this._pbf.readVarint()+this._pbf.pos;return new zG(this._pbf,t,this.extent,this._keys,this._values)};var FG=bR;function BG(n,t,i){if(n===3){var o=new FG(i,i.readVarint()+i.pos);o.length&&(t[o.name]=o)}}var Iw=j_.VectorTile=function(n,t){this.layers=n.readFields(BG,{},t)},V_=j_.VectorTileFeature=xR;function U_(n,t,i,o){const c=[],u=o===0?(d,p,g,_,v,b)=>{d.push(new W(b,g+(b-p)/(_-p)*(v-g)))}:(d,p,g,_,v,b)=>{d.push(new W(p+(b-g)/(v-g)*(_-p),b))};for(const d of n){const p=[];for(const g of d){if(g.length<=2)continue;const _=[];for(let S=0;S<g.length-1;S++){const E=g[S].x,A=g[S].y,C=g[S+1].x,P=g[S+1].y,k=o===0?E:A,L=o===0?C:P;k<t?L>t&&u(_,E,A,C,P,t):k>i?L<i&&u(_,E,A,C,P,i):_.push(g[S]),L<t&&k>=t&&u(_,E,A,C,P,t),L>i&&k<=i&&u(_,E,A,C,P,i)}let v=g[g.length-1];const b=o===0?v.x:v.y;b>=t&&b<=i&&_.push(v),_.length&&(v=_[_.length-1],_[0].x===v.x&&_[0].y===v.y||_.push(_[0]),p.push(_))}p.length&&c.push(p)}return c}j_.VectorTileLayer=bR;class SR{constructor(t){this._stringToNumber={},this._numberToString=[];for(let i=0;i<t.length;i++){const o=t[i];this._stringToNumber[o]=i,this._numberToString[i]=o}}encode(t){return this._stringToNumber[t]}decode(t){return this._numberToString[t]}}var jG={read:function(n,t,i,o,c){var u,d,p=8*c-o-1,g=(1<<p)-1,_=g>>1,v=-7,b=i?c-1:0,S=i?-1:1,E=n[t+b];for(b+=S,u=E&(1<<-v)-1,E>>=-v,v+=p;v>0;u=256*u+n[t+b],b+=S,v-=8);for(d=u&(1<<-v)-1,u>>=-v,v+=o;v>0;d=256*d+n[t+b],b+=S,v-=8);if(u===0)u=1-_;else{if(u===g)return d?NaN:1/0*(E?-1:1);d+=Math.pow(2,o),u-=_}return(E?-1:1)*d*Math.pow(2,u-o)},write:function(n,t,i,o,c,u){var d,p,g,_=8*u-c-1,v=(1<<_)-1,b=v>>1,S=c===23?Math.pow(2,-24)-Math.pow(2,-77):0,E=o?0:u-1,A=o?1:-1,C=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(p=isNaN(t)?1:0,d=v):(d=Math.floor(Math.log(t)/Math.LN2),t*(g=Math.pow(2,-d))<1&&(d--,g*=2),(t+=d+b>=1?S/g:S*Math.pow(2,1-b))*g>=2&&(d++,g/=2),d+b>=v?(p=0,d=v):d+b>=1?(p=(t*g-1)*Math.pow(2,c),d+=b):(p=t*Math.pow(2,b-1)*Math.pow(2,c),d=0));c>=8;n[i+E]=255&p,E+=A,p/=256,c-=8);for(d=d<<c|p,_+=c;_>0;n[i+E]=255&d,E+=A,d/=256,_-=8);n[i+E-A]|=128*C}},TR=hr,$_=jG;function hr(n){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(n)?n:new Uint8Array(n||0),this.pos=0,this.type=0,this.length=this.buf.length}hr.Varint=0,hr.Fixed64=1,hr.Bytes=2,hr.Fixed32=5;var kw=4294967296,ER=1/kw,MR=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function pl(n){return n.type===hr.Bytes?n.readVarint()+n.pos:n.pos+1}function md(n,t,i){return i?4294967296*t+(n>>>0):4294967296*(t>>>0)+(n>>>0)}function AR(n,t,i){var o=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));i.realloc(o);for(var c=i.pos-1;c>=n;c--)i.buf[c+o]=i.buf[c]}function VG(n,t){for(var i=0;i<n.length;i++)t.writeVarint(n[i])}function UG(n,t){for(var i=0;i<n.length;i++)t.writeSVarint(n[i])}function $G(n,t){for(var i=0;i<n.length;i++)t.writeFloat(n[i])}function GG(n,t){for(var i=0;i<n.length;i++)t.writeDouble(n[i])}function WG(n,t){for(var i=0;i<n.length;i++)t.writeBoolean(n[i])}function HG(n,t){for(var i=0;i<n.length;i++)t.writeFixed32(n[i])}function qG(n,t){for(var i=0;i<n.length;i++)t.writeSFixed32(n[i])}function ZG(n,t){for(var i=0;i<n.length;i++)t.writeFixed64(n[i])}function XG(n,t){for(var i=0;i<n.length;i++)t.writeSFixed64(n[i])}function G_(n,t){return(n[t]|n[t+1]<<8|n[t+2]<<16)+16777216*n[t+3]}function gd(n,t,i){n[i]=t,n[i+1]=t>>>8,n[i+2]=t>>>16,n[i+3]=t>>>24}function CR(n,t){return(n[t]|n[t+1]<<8|n[t+2]<<16)+(n[t+3]<<24)}hr.prototype={destroy:function(){this.buf=null},readFields:function(n,t,i){for(i=i||this.length;this.pos<i;){var o=this.readVarint(),c=o>>3,u=this.pos;this.type=7&o,n(c,t,this),this.pos===u&&this.skip(o)}return t},readMessage:function(n,t){return this.readFields(n,t,this.readVarint()+this.pos)},readFixed32:function(){var n=G_(this.buf,this.pos);return this.pos+=4,n},readSFixed32:function(){var n=CR(this.buf,this.pos);return this.pos+=4,n},readFixed64:function(){var n=G_(this.buf,this.pos)+G_(this.buf,this.pos+4)*kw;return this.pos+=8,n},readSFixed64:function(){var n=G_(this.buf,this.pos)+CR(this.buf,this.pos+4)*kw;return this.pos+=8,n},readFloat:function(){var n=$_.read(this.buf,this.pos,!0,23,4);return this.pos+=4,n},readDouble:function(){var n=$_.read(this.buf,this.pos,!0,52,8);return this.pos+=8,n},readVarint:function(n){var t,i,o=this.buf;return t=127&(i=o[this.pos++]),i<128?t:(t|=(127&(i=o[this.pos++]))<<7,i<128?t:(t|=(127&(i=o[this.pos++]))<<14,i<128?t:(t|=(127&(i=o[this.pos++]))<<21,i<128?t:function(c,u,d){var p,g,_=d.buf;if(p=(112&(g=_[d.pos++]))>>4,g<128||(p|=(127&(g=_[d.pos++]))<<3,g<128)||(p|=(127&(g=_[d.pos++]))<<10,g<128)||(p|=(127&(g=_[d.pos++]))<<17,g<128)||(p|=(127&(g=_[d.pos++]))<<24,g<128)||(p|=(1&(g=_[d.pos++]))<<31,g<128))return md(c,p,u);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(i=o[this.pos]))<<28,n,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var n=this.readVarint();return n%2==1?(n+1)/-2:n/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var n=this.readVarint()+this.pos,t=this.pos;return this.pos=n,n-t>=12&&MR?function(i,o,c){return MR.decode(i.subarray(o,c))}(this.buf,t,n):function(i,o,c){for(var u="",d=o;d<c;){var p,g,_,v=i[d],b=null,S=v>239?4:v>223?3:v>191?2:1;if(d+S>c)break;S===1?v<128&&(b=v):S===2?(192&(p=i[d+1]))==128&&(b=(31&v)<<6|63&p)<=127&&(b=null):S===3?(g=i[d+2],(192&(p=i[d+1]))==128&&(192&g)==128&&((b=(15&v)<<12|(63&p)<<6|63&g)<=2047||b>=55296&&b<=57343)&&(b=null)):S===4&&(g=i[d+2],_=i[d+3],(192&(p=i[d+1]))==128&&(192&g)==128&&(192&_)==128&&((b=(15&v)<<18|(63&p)<<12|(63&g)<<6|63&_)<=65535||b>=1114112)&&(b=null)),b===null?(b=65533,S=1):b>65535&&(b-=65536,u+=String.fromCharCode(b>>>10&1023|55296),b=56320|1023&b),u+=String.fromCharCode(b),d+=S}return u}(this.buf,t,n)},readBytes:function(){var n=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,n);return this.pos=n,t},readPackedVarint:function(n,t){if(this.type!==hr.Bytes)return n.push(this.readVarint(t));var i=pl(this);for(n=n||[];this.pos<i;)n.push(this.readVarint(t));return n},readPackedSVarint:function(n){if(this.type!==hr.Bytes)return n.push(this.readSVarint());var t=pl(this);for(n=n||[];this.pos<t;)n.push(this.readSVarint());return n},readPackedBoolean:function(n){if(this.type!==hr.Bytes)return n.push(this.readBoolean());var t=pl(this);for(n=n||[];this.pos<t;)n.push(this.readBoolean());return n},readPackedFloat:function(n){if(this.type!==hr.Bytes)return n.push(this.readFloat());var t=pl(this);for(n=n||[];this.pos<t;)n.push(this.readFloat());return n},readPackedDouble:function(n){if(this.type!==hr.Bytes)return n.push(this.readDouble());var t=pl(this);for(n=n||[];this.pos<t;)n.push(this.readDouble());return n},readPackedFixed32:function(n){if(this.type!==hr.Bytes)return n.push(this.readFixed32());var t=pl(this);for(n=n||[];this.pos<t;)n.push(this.readFixed32());return n},readPackedSFixed32:function(n){if(this.type!==hr.Bytes)return n.push(this.readSFixed32());var t=pl(this);for(n=n||[];this.pos<t;)n.push(this.readSFixed32());return n},readPackedFixed64:function(n){if(this.type!==hr.Bytes)return n.push(this.readFixed64());var t=pl(this);for(n=n||[];this.pos<t;)n.push(this.readFixed64());return n},readPackedSFixed64:function(n){if(this.type!==hr.Bytes)return n.push(this.readSFixed64());var t=pl(this);for(n=n||[];this.pos<t;)n.push(this.readSFixed64());return n},skip:function(n){var t=7&n;if(t===hr.Varint)for(;this.buf[this.pos++]>127;);else if(t===hr.Bytes)this.pos=this.readVarint()+this.pos;else if(t===hr.Fixed32)this.pos+=4;else{if(t!==hr.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(n,t){this.writeVarint(n<<3|t)},realloc:function(n){for(var t=this.length||16;t<this.pos+n;)t*=2;if(t!==this.length){var i=new Uint8Array(t);i.set(this.buf),this.buf=i,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(n){this.realloc(4),gd(this.buf,n,this.pos),this.pos+=4},writeSFixed32:function(n){this.realloc(4),gd(this.buf,n,this.pos),this.pos+=4},writeFixed64:function(n){this.realloc(8),gd(this.buf,-1&n,this.pos),gd(this.buf,Math.floor(n*ER),this.pos+4),this.pos+=8},writeSFixed64:function(n){this.realloc(8),gd(this.buf,-1&n,this.pos),gd(this.buf,Math.floor(n*ER),this.pos+4),this.pos+=8},writeVarint:function(n){(n=+n||0)>268435455||n<0?function(t,i){var o,c;if(t>=0?(o=t%4294967296|0,c=t/4294967296|0):(c=~(-t/4294967296),4294967295^(o=~(-t%4294967296))?o=o+1|0:(o=0,c=c+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),function(u,d,p){p.buf[p.pos++]=127&u|128,u>>>=7,p.buf[p.pos++]=127&u|128,u>>>=7,p.buf[p.pos++]=127&u|128,u>>>=7,p.buf[p.pos++]=127&u|128,p.buf[p.pos]=127&(u>>>=7)}(o,0,i),function(u,d){var p=(7&u)<<4;d.buf[d.pos++]|=p|((u>>>=3)?128:0),u&&(d.buf[d.pos++]=127&u|((u>>>=7)?128:0),u&&(d.buf[d.pos++]=127&u|((u>>>=7)?128:0),u&&(d.buf[d.pos++]=127&u|((u>>>=7)?128:0),u&&(d.buf[d.pos++]=127&u|((u>>>=7)?128:0),u&&(d.buf[d.pos++]=127&u)))))}(c,i)}(n,this):(this.realloc(4),this.buf[this.pos++]=127&n|(n>127?128:0),n<=127||(this.buf[this.pos++]=127&(n>>>=7)|(n>127?128:0),n<=127||(this.buf[this.pos++]=127&(n>>>=7)|(n>127?128:0),n<=127||(this.buf[this.pos++]=n>>>7&127))))},writeSVarint:function(n){this.writeVarint(n<0?2*-n-1:2*n)},writeBoolean:function(n){this.writeVarint(!!n)},writeString:function(n){n=String(n),this.realloc(4*n.length),this.pos++;var t=this.pos;this.pos=function(o,c,u){for(var d,p,g=0;g<c.length;g++){if((d=c.charCodeAt(g))>55295&&d<57344){if(!p){d>56319||g+1===c.length?(o[u++]=239,o[u++]=191,o[u++]=189):p=d;continue}if(d<56320){o[u++]=239,o[u++]=191,o[u++]=189,p=d;continue}d=p-55296<<10|d-56320|65536,p=null}else p&&(o[u++]=239,o[u++]=191,o[u++]=189,p=null);d<128?o[u++]=d:(d<2048?o[u++]=d>>6|192:(d<65536?o[u++]=d>>12|224:(o[u++]=d>>18|240,o[u++]=d>>12&63|128),o[u++]=d>>6&63|128),o[u++]=63&d|128)}return u}(this.buf,n,this.pos);var i=this.pos-t;i>=128&&AR(t,i,this),this.pos=t-1,this.writeVarint(i),this.pos+=i},writeFloat:function(n){this.realloc(4),$_.write(this.buf,n,this.pos,!0,23,4),this.pos+=4},writeDouble:function(n){this.realloc(8),$_.write(this.buf,n,this.pos,!0,52,8),this.pos+=8},writeBytes:function(n){var t=n.length;this.writeVarint(t),this.realloc(t);for(var i=0;i<t;i++)this.buf[this.pos++]=n[i]},writeRawMessage:function(n,t){this.pos++;var i=this.pos;n(t,this);var o=this.pos-i;o>=128&&AR(i,o,this),this.pos=i-1,this.writeVarint(o),this.pos+=o},writeMessage:function(n,t,i){this.writeTag(n,hr.Bytes),this.writeRawMessage(t,i)},writePackedVarint:function(n,t){t.length&&this.writeMessage(n,VG,t)},writePackedSVarint:function(n,t){t.length&&this.writeMessage(n,UG,t)},writePackedBoolean:function(n,t){t.length&&this.writeMessage(n,WG,t)},writePackedFloat:function(n,t){t.length&&this.writeMessage(n,$G,t)},writePackedDouble:function(n,t){t.length&&this.writeMessage(n,GG,t)},writePackedFixed32:function(n,t){t.length&&this.writeMessage(n,HG,t)},writePackedSFixed32:function(n,t){t.length&&this.writeMessage(n,qG,t)},writePackedFixed64:function(n,t){t.length&&this.writeMessage(n,ZG,t)},writePackedSFixed64:function(n,t){t.length&&this.writeMessage(n,XG,t)},writeBytesField:function(n,t){this.writeTag(n,hr.Bytes),this.writeBytes(t)},writeFixed32Field:function(n,t){this.writeTag(n,hr.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(n,t){this.writeTag(n,hr.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(n,t){this.writeTag(n,hr.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(n,t){this.writeTag(n,hr.Fixed64),this.writeSFixed64(t)},writeVarintField:function(n,t){this.writeTag(n,hr.Varint),this.writeVarint(t)},writeSVarintField:function(n,t){this.writeTag(n,hr.Varint),this.writeSVarint(t)},writeStringField:function(n,t){this.writeTag(n,hr.Bytes),this.writeString(t)},writeFloatField:function(n,t){this.writeTag(n,hr.Fixed32),this.writeFloat(t)},writeDoubleField:function(n,t){this.writeTag(n,hr.Fixed64),this.writeDouble(t)},writeBooleanField:function(n,t){this.writeVarintField(n,!!t)}};var W_=H(TR);const YG=["tile","layer","source","sourceLayer","state"];class PR{constructor(t,i,o,c,u){this.type="Feature",this._vectorTileFeature=t,this._z=i,this._x=o,this._y=c,this.properties=t.properties,this.id=u}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};this.id!==void 0&&(t.id=this.id);for(const i of YG)this[i]!==void 0&&(t[i]=this[i]);return t}}class KG{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,i,o){const c=String(i);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][c]=this.stateChanges[t][c]||{},Ct(this.stateChanges[t][c],o),this.deletedStates[t]===null){this.deletedStates[t]={};for(const u in this.state[t])u!==c&&(this.deletedStates[t][u]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][c]===null){this.deletedStates[t][c]={};for(const u in this.state[t][c])o[u]||(this.deletedStates[t][c][u]=null)}else for(const u in o)this.deletedStates[t]&&this.deletedStates[t][c]&&this.deletedStates[t][c][u]===null&&delete this.deletedStates[t][c][u]}removeFeatureState(t,i,o){if(this.deletedStates[t]===null)return;const c=String(i);if(this.deletedStates[t]=this.deletedStates[t]||{},o&&i!==void 0)this.deletedStates[t][c]!==null&&(this.deletedStates[t][c]=this.deletedStates[t][c]||{},this.deletedStates[t][c][o]=null);else if(i!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][c])for(o in this.deletedStates[t][c]={},this.stateChanges[t][c])this.deletedStates[t][c][o]=null;else this.deletedStates[t][c]=null;else this.deletedStates[t]=null}getState(t,i){const o=String(i),c=Ct({},(this.state[t]||{})[o],(this.stateChanges[t]||{})[o]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const u=this.deletedStates[t][i];if(u===null)return{};for(const d in u)delete c[d]}return c}initializeTileState(t,i){t.setFeatureState(this.state,i)}coalesceChanges(t,i){const o={};for(const c in this.stateChanges){this.state[c]=this.state[c]||{};const u={};for(const d in this.stateChanges[c])this.state[c][d]||(this.state[c][d]={}),Ct(this.state[c][d],this.stateChanges[c][d]),u[d]=this.state[c][d];o[c]=u}for(const c in this.deletedStates){this.state[c]=this.state[c]||{};const u={};if(this.deletedStates[c]===null)for(const d in this.state[c])u[d]={},this.state[c][d]={};else for(const d in this.deletedStates[c]){if(this.deletedStates[c][d]===null)this.state[c][d]={};else if(this.state[c][d])for(const p of Object.keys(this.deletedStates[c][d]))delete this.state[c][d][p];u[d]=this.state[c][d]}o[c]=o[c]||{},Ct(o[c],u)}if(this.stateChanges={},this.deletedStates={},Object.keys(o).length!==0)for(const c in t)t[c].setFeatureState(o,i)}}class IR{constructor(t){this.size=t,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(t,i){const o=this.toIdx(t,i);return{min:this.minimums[o],max:this.maximums[o]}}isLeaf(t,i){return this.leaves[this.toIdx(t,i)]}toIdx(t,i){return i*this.size+t}}function kR(n,t,i,o){let c=0,u=Number.MAX_VALUE;for(let d=0;d<3;d++)if(Math.abs(o[d])<1e-15){if(i[d]<n[d]||i[d]>t[d])return null}else{const p=1/o[d];let g=(n[d]-i[d])*p,_=(t[d]-i[d])*p;if(g>_){const v=g;g=_,_=v}if(g>c&&(c=g),_<u&&(u=_),c>u)return null}return c}function DR(n,t,i,o,c,u,d,p,g,_,v){const b=o-n,S=c-t,E=u-i,A=d-n,C=p-t,P=g-i,k=v[1]*P-v[2]*C,L=v[2]*A-v[0]*P,j=v[0]*C-v[1]*A,V=b*k+S*L+E*j;if(Math.abs(V)<1e-15)return null;const F=1/V,U=_[0]-n,q=_[1]-t,Z=_[2]-i,X=(U*k+q*L+Z*j)*F;if(X<0||X>1)return null;const J=q*E-Z*S,rt=Z*b-U*E,it=U*S-q*b,ut=(v[0]*J+v[1]*rt+v[2]*it)*F;return ut<0||X+ut>1?null:(A*J+C*rt+P*it)*F}function RR(n,t,i){return(n-t)/(i-t)}function OR(n,t,i,o,c,u,d,p,g){const _=1<<i,v=u-o,b=d-c,S=(n+1)/_*v+o,E=(t+0)/_*b+c,A=(t+1)/_*b+c;p[0]=(n+0)/_*v+o,p[1]=E,g[0]=S,g[1]=A}class LR{constructor(t){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=t,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const i=function(u){const d=Math.ceil(Math.log2(u.dim/8)),p=[];let g=Math.ceil(Math.pow(2,d));const _=1/g,v=(E,A,C,P,k)=>{const L=P?1:0,j=(E+1)*C-L,V=A*C,F=(A+1)*C-L;k[0]=E*C,k[1]=V,k[2]=j,k[3]=F};let b=new IR(g);const S=[];for(let E=0;E<g*g;E++){v(E%g,Math.floor(E/g),_,!1,S);const A=gc(S[0],S[1],u),C=gc(S[2],S[1],u),P=gc(S[2],S[3],u),k=gc(S[0],S[3],u);b.minimums.push(Math.min(A,C,P,k)),b.maximums.push(Math.max(A,C,P,k)),b.leaves.push(1)}for(p.push(b),g/=2;g>=1;g/=2){const E=p[p.length-1];b=new IR(g);for(let A=0;A<g*g;A++){v(A%g,Math.floor(A/g),2,!0,S);const C=E.getElevation(S[0],S[1]),P=E.getElevation(S[2],S[1]),k=E.getElevation(S[2],S[3]),L=E.getElevation(S[0],S[3]),j=E.isLeaf(S[0],S[1]),V=E.isLeaf(S[2],S[1]),F=E.isLeaf(S[2],S[3]),U=E.isLeaf(S[0],S[3]),q=Math.min(C.min,P.min,k.min,L.min),Z=Math.max(C.max,P.max,k.max,L.max),X=j&&V&&F&&U;b.maximums.push(Z),b.minimums.push(q),b.leaves.push(Z-q<=5&&X?1:0)}p.push(b)}return p}(this.dem),o=i.length-1,c=i[o];this._addNode(c.minimums[0],c.maximums[0],c.leaves[0]),this._construct(i,0,0,o,0)}raycastRoot(t,i,o,c,u,d,p=1){return kR([t,i,-100],[o,c,this.maximums[0]*p],u,d)}raycast(t,i,o,c,u,d,p=1){if(!this.nodeCount)return null;const g=this.raycastRoot(t,i,o,c,u,d,p);if(g==null)return null;const _=[],v=[],b=[],S=[],E=[{idx:0,t:g,nodex:0,nodey:0,depth:0}];for(;E.length>0;){const{idx:A,t:C,nodex:P,nodey:k,depth:L}=E.pop();if(this.leaves[A]){OR(P,k,L,t,i,o,c,b,S);const V=1<<L,F=(P+0)/V,U=(P+1)/V,q=(k+0)/V,Z=(k+1)/V,X=gc(F,q,this.dem)*p,J=gc(U,q,this.dem)*p,rt=gc(U,Z,this.dem)*p,it=gc(F,Z,this.dem)*p,ut=DR(b[0],b[1],X,S[0],b[1],J,S[0],S[1],rt,u,d),tt=DR(S[0],S[1],rt,b[0],S[1],it,b[0],b[1],X,u,d),dt=Math.min(ut!==null?ut:Number.MAX_VALUE,tt!==null?tt:Number.MAX_VALUE);if(dt!==Number.MAX_VALUE)return dt;{const gt=ct.scaleAndAdd([],u,d,C);if(zR(X,J,it,rt,RR(gt[0],b[0],S[0]),RR(gt[1],b[1],S[1]))>=gt[2])return C}continue}let j=0;for(let V=0;V<this._siblingOffset.length;V++){OR((P<<1)+this._siblingOffset[V][0],(k<<1)+this._siblingOffset[V][1],L+1,t,i,o,c,b,S),b[2]=-100,S[2]=this.maximums[this.childOffsets[A]+V]*p;const F=kR(b,S,u,d);if(F!=null){const U=F;_[V]=U;let q=!1;for(let Z=0;Z<j&&!q;Z++)U>=_[v[Z]]&&(v.splice(Z,0,V),q=!0);q||(v[j]=V),j++}}for(let V=0;V<j;V++){const F=v[V];E.push({idx:this.childOffsets[A]+F,t:_[F],nodex:(P<<1)+this._siblingOffset[F][0],nodey:(k<<1)+this._siblingOffset[F][1],depth:L+1})}}return null}_addNode(t,i,o){return this.minimums.push(t),this.maximums.push(i),this.leaves.push(o),this.childOffsets.push(0),this.nodeCount++}_construct(t,i,o,c,u){if(t[c].isLeaf(i,o)===1)return;this.childOffsets[u]||(this.childOffsets[u]=this.nodeCount);const d=c-1,p=t[d];let g=0,_=0;for(let v=0;v<this._siblingOffset.length;v++){const b=2*i+this._siblingOffset[v][0],S=2*o+this._siblingOffset[v][1],E=p.getElevation(b,S),A=p.isLeaf(b,S),C=this._addNode(E.min,E.max,A);A&&(g|=1<<v),_||(_=C)}for(let v=0;v<this._siblingOffset.length;v++)g&1<<v||this._construct(t,2*i+this._siblingOffset[v][0],2*o+this._siblingOffset[v][1],d,_+v)}}function zR(n,t,i,o,c,u){return qe(qe(n,i,u),qe(t,o,u),c)}function gc(n,t,i){const o=i.dim,c=Ot(n*o-.5,0,o-1),u=Ot(t*o-.5,0,o-1),d=Math.floor(c),p=Math.floor(u),g=Math.min(d+1,o-1),_=Math.min(p+1,o-1);return zR(i.get(d,p),i.get(g,p),i.get(d,_),i.get(g,_),c-d,u-p)}const JG={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function QG(n,t,i){return(256*n*256+256*t+i)/10-1e4}function tW(n,t,i){return 256*n+t+i/256-32768}class H_{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(t,i,o,c=!1){if(this.uid=t,i.height!==i.width)throw new RangeError("DEM tiles must be square");if(o&&o!=="mapbox"&&o!=="terrarium")return _t(`"${o}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=i.height;const u=this.dim=i.height-2,d=new Uint32Array(i.data.buffer);if(this.pixels=new Uint8Array(i.data.buffer),this.floatView=new Float32Array(i.data.buffer),this.borderReady=c,this._modifiedForSources={},!c){for(let g=0;g<u;g++)d[this._idx(-1,g)]=d[this._idx(0,g)],d[this._idx(u,g)]=d[this._idx(u-1,g)],d[this._idx(g,-1)]=d[this._idx(g,0)],d[this._idx(g,u)]=d[this._idx(g,u-1)];d[this._idx(-1,-1)]=d[this._idx(0,0)],d[this._idx(u,-1)]=d[this._idx(u-1,0)],d[this._idx(-1,u)]=d[this._idx(0,u-1)],d[this._idx(u,u)]=d[this._idx(u-1,u-1)]}const p=o==="terrarium"?tW:QG;for(let g=0;g<d.length;++g){const _=4*g;this.floatView[g]=p(this.pixels[_],this.pixels[_+1],this.pixels[_+2])}this._timestamp=Be.now()}_buildQuadTree(){this._tree=new LR(this)}get(t,i,o=!1){o&&(t=Ot(t,-1,this.dim),i=Ot(i,-1,this.dim));const c=this._idx(t,i);return this.floatView[c]}set(t,i,o){const c=this._idx(t,i),u=this.floatView[c];return this.floatView[c]=o,o-u}static getUnpackVector(t){return JG[t]}_idx(t,i){if(t<-1||t>=this.dim+1||i<-1||i>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(i+1)*this.stride+(t+1)}static pack(t,i){const o=[0,0,0,0],c=H_.getUnpackVector(i);let u=Math.floor((t+c[3])/c[2]);return o[2]=u%256,u=Math.floor(u/256),o[1]=u%256,u=Math.floor(u/256),o[0]=u,o}getPixels(){return new mR({width:this.stride,height:this.stride},this.pixels)}backfillBorder(t,i,o){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let c=i*this.dim,u=i*this.dim+this.dim,d=o*this.dim,p=o*this.dim+this.dim;switch(i){case-1:c=u-1;break;case 1:u=c+1}switch(o){case-1:d=p-1;break;case 1:p=d+1}const g=-i*this.dim,_=-o*this.dim;for(let v=d;v<p;v++)for(let b=c;b<u;b++){const S=4*this._idx(b,v),E=4*this._idx(b+g,v+_);this.pixels[S+0]=t.pixels[E+0],this.pixels[S+1]=t.pixels[E+1],this.pixels[S+2]=t.pixels[E+2],this.pixels[S+3]=t.pixels[E+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}Se(H_,"DEMData"),Se(LR,"DemMinMaxQuadTree",{omit:["dem"]});class eW{isDataAvailableAtPoint(t){const i=this._source();if(this.isUsingMockSource()||!i||t.y<0||t.y>1)return!1;const o=i.getSource().maxzoom,c=1<<o,u=Math.floor(t.x),d=Math.floor((t.x-u)*c),p=Math.floor(t.y*c),g=this.findDEMTileFor(new Pn(o,u,o,d,p));return!(!g||!g.dem)}getAtPointOrZero(t,i=0){return this.getAtPoint(t,i)||0}getAtPoint(t,i,o=!0){if(this.isUsingMockSource())return null;i==null&&(i=null);const c=this._source();if(!c||t.y<0||t.y>1)return i;const u=c.getSource().maxzoom,d=1<<u,p=Math.floor(t.x),g=t.x-p,_=new Pn(u,p,u,Math.floor(g*d),Math.floor(t.y*d)),v=this.findDEMTileFor(_);if(!v||!v.dem)return i;const b=v.dem,S=1<<v.tileID.canonical.z,E=(g*S-v.tileID.canonical.x)*b.dim,A=(t.y*S-v.tileID.canonical.y)*b.dim,C=Math.floor(E),P=Math.floor(A);return(o?this.exaggeration():1)*qe(qe(b.get(C,P),b.get(C,P+1),A-P),qe(b.get(C+1,P),b.get(C+1,P+1),A-P),E-C)}getAtTileOffset(t,i,o){const c=1<<t.canonical.z;return this.getAtPointOrZero(new vn(t.wrap+(t.canonical.x+i/Dt)/c,(t.canonical.y+o/Dt)/c))}getAtTileOffsetFunc(t,i,o,c){return u=>{const d=this.getAtTileOffset(t,u.x,u.y),p=c.upVector(t.canonical,u.x,u.y),g=c.upVectorScale(t.canonical,i,o).metersToTile;return ct.scale(p,p,d*g),p}}getForTilePoints(t,i,o,c){if(this.isUsingMockSource())return!1;const u=_d.create(this,t,c);return!!u&&(i.forEach(d=>{d[2]=this.exaggeration()*u.getElevationAt(d[0],d[1],o)}),!0)}getMinMaxForTile(t){if(this.isUsingMockSource())return null;const i=this.findDEMTileFor(t);if(!i||!i.dem)return null;const o=i.dem.tree,c=i.tileID,u=1<<t.canonical.z-c.canonical.z;let d=t.canonical.x/u-c.canonical.x,p=t.canonical.y/u-c.canonical.y,g=0;for(let _=0;_<t.canonical.z-c.canonical.z&&!o.leaves[g];_++){d*=2,p*=2;const v=2*Math.floor(p)+Math.floor(d);g=o.childOffsets[g]+v,d%=1,p%=1}return{min:this.exaggeration()*o.minimums[g],max:this.exaggeration()*o.maximums[g]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(t,i,o){throw new Error("Pure virtual method called.")}pointCoordinate(t){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(t){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const t=this.visibleDemTiles;if(t.length===0)return null;let i=!1,o=Number.MAX_VALUE,c=Number.MIN_VALUE;for(const u of t){const d=this.getMinMaxForTile(u.tileID);d&&(o=Math.min(o,d.min),c=Math.max(c,d.max),i=!0)}return i?{min:o,max:c}:null}}class _d{constructor(t,i,o){this._demTile=t,this._dem=this._demTile.dem,this._scale=i,this._offset=o}static create(t,i,o){const c=o||t.findDEMTileFor(i);if(!c||!c.dem)return;const u=c.dem,d=c.tileID,p=1<<i.canonical.z-d.canonical.z;return new _d(c,u.dim/Dt/p,[(i.canonical.x/p-d.canonical.x)*u.dim,(i.canonical.y/p-d.canonical.y)*u.dim])}tileCoordToPixel(t,i){const o=i*this._scale+this._offset[1],c=Math.floor(t*this._scale+this._offset[0]),u=Math.floor(o);return new W(c,u)}getElevationAt(t,i,o,c){const u=t*this._scale+this._offset[0],d=i*this._scale+this._offset[1],p=Math.floor(u),g=Math.floor(d),_=this._dem;return c=!!c,o?qe(qe(_.get(p,g,c),_.get(p,g+1,c),d-g),qe(_.get(p+1,g,c),_.get(p+1,g+1,c),d-g),u-p):_.get(p,g,c)}getElevationAtPixel(t,i,o){return this._dem.get(t,i,!!o)}getMeterToDEM(t){return(1<<this._demTile.tileID.canonical.z)*$n(1,t)*this._dem.stride}}class Dw{constructor(t,i){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new ed(Dt,16,0),this.featureIndexArray=new dk,this.promoteId=i}insert(t,i,o,c,u,d=0){const p=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(o,c,u,d);const g=this.grid;for(let _=0;_<i.length;_++){const v=i[_],b=[1/0,1/0,-1/0,-1/0];for(let S=0;S<v.length;S++){const E=v[S];b[0]=Math.min(b[0],E.x),b[1]=Math.min(b[1],E.y),b[2]=Math.max(b[2],E.x),b[3]=Math.max(b[3],E.y)}b[0]<Dt&&b[1]<Dt&&b[2]>=0&&b[3]>=0&&g.insert(p,b[0],b[1],b[2],b[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Iw(new W_(this.rawTileData)).layers,this.sourceLayerCoder=new SR(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const t in this.vtLayers)this.vtFeatures[t]=[]}return this.vtLayers}query(t,i,o,c){this.loadVTLayers();const u=t.params||{},d=i_(u.filter),p=t.tileResult,g=t.transform,_=p.bufferedTilespaceBounds,v=this.grid.query(_.min.x,_.min.y,_.max.x,_.max.y,(A,C,P,k)=>oR(p.bufferedTilespaceGeometry,A,C,P,k));v.sort(nW);let b=null;g.elevation&&v.length>0&&(b=_d.create(g.elevation,this.tileID));const S={};let E;for(let A=0;A<v.length;A++){const C=v[A];if(C===E)continue;E=C;const P=this.featureIndexArray.get(C);let k=null;this.loadMatchingFeature(S,P,d,u.layers,u.availableImages,i,o,c,(L,j,V,F=0)=>(k||(k=Aa(L,this.tileID.canonical,t.tileTransform)),j.queryIntersectsFeature(p,L,V,k,this.z,t.transform,t.pixelPosMatrix,b,F)))}return S}loadMatchingFeature(t,i,o,c,u,d,p,g,_){const{featureIndex:v,bucketIndex:b,sourceLayerIndex:S,layoutVertexArrayOffset:E}=i,A=this.bucketLayerIDs[b];if(c&&!function(L,j){for(let V=0;V<L.length;V++)if(j.indexOf(L[V])>=0)return!0;return!1}(c,A))return;const C=this.sourceLayerCoder.decode(S),P=this.vtLayers[C].feature(v);if(o.needGeometry){const L=pc(P,!0);if(!o.filter(new pr(this.tileID.overscaledZ),L,this.tileID.canonical))return}else if(!o.filter(new pr(this.tileID.overscaledZ),P))return;const k=this.getId(P,C);for(let L=0;L<A.length;L++){const j=A[L];if(c&&c.indexOf(j)<0)continue;const V=d[j];if(!V)continue;let F={};k!==void 0&&g&&(F=g.getState(V.sourceLayer||"_geojsonTileLayer",k));const U=Ct({},p[j]);U.paint=NR(U.paint,V.paint,P,F,u),U.layout=NR(U.layout,V.layout,P,F,u);const q=!_||_(P,V,F,E);if(!q)continue;const Z=new PR(P,this.z,this.x,this.y,k);Z.layer=U;let X=t[j];X===void 0&&(X=t[j]=[]),X.push({featureIndex:v,feature:Z,intersectionZ:q})}}lookupSymbolFeatures(t,i,o,c,u,d,p,g){const _={};this.loadVTLayers();const v=i_(u);for(const b of t)this.loadMatchingFeature(_,{bucketIndex:o,sourceLayerIndex:c,featureIndex:b,layoutVertexArrayOffset:0},v,d,p,g,i);return _}loadFeature(t){const{featureIndex:i,sourceLayerIndex:o}=t;this.loadVTLayers();const c=this.sourceLayerCoder.decode(o),u=this.vtFeatures[c];if(u[i])return u[i];const d=this.vtLayers[c].feature(i);return u[i]=d,d}hasLayer(t){for(const i of this.bucketLayerIDs)for(const o of i)if(t===o)return!0;return!1}getId(t,i){let o=t.id;if(this.promoteId){const c=typeof this.promoteId=="string"?this.promoteId:this.promoteId[i];c!=null&&(o=t.properties[c]),typeof o=="boolean"&&(o=Number(o))}return o}}function NR(n,t,i,o,c){return _n(n,(u,d)=>{const p=t instanceof Yf?t.get(d):null;return p&&p.evaluate?p.evaluate(i,o,c):p})}function nW(n,t){return t-n}Se(Dw,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const rW=Rn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),iW=Rn([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),sW=Rn([{name:"a_projected_pos",components:4,type:"Float32"}],4);Rn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const oW=Rn([{name:"a_z_offset",components:1,type:"Float32"}],4),aW=Rn([{name:"a_texb",components:2,type:"Uint16"}]),lW=Rn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),cW=Rn([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_z_offset",components:1,type:"Float32"}]);Rn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const FR=Rn([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),uW=Rn([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Rn([{name:"triangle",components:3,type:"Uint16"}]),Rn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Rn([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),Rn([{type:"Float32",name:"offsetX"}]),Rn([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var xi=24;const Ko=128;function Rw(n,t){const{expression:i}=t;if(i.kind==="constant")return{kind:"constant",layoutSize:i.evaluate(new pr(n+1))};if(i.kind==="source")return{kind:"source"};{const{zoomStops:o,interpolationType:c}=i;let u=0;for(;u<o.length&&o[u]<=n;)u++;u=Math.max(0,u-1);let d=u;for(;d<o.length&&o[d]<n+1;)d++;d=Math.min(o.length-1,d);const p=o[u],g=o[d];return i.kind==="composite"?{kind:"composite",minZoom:p,maxZoom:g,interpolationType:c}:{kind:"camera",minZoom:p,maxZoom:g,minSize:i.evaluate(new pr(p)),maxSize:i.evaluate(new pr(g)),interpolationType:c}}}function hp(n,{uSize:t,uSizeT:i},{lowerSize:o,upperSize:c}){return n.kind==="source"?o/Ko:n.kind==="composite"?qe(o/Ko,c/Ko,i):t}function Ca(n,t){let i=0,o=0;if(n.kind==="constant")o=n.layoutSize;else if(n.kind!=="source"){const{interpolationType:c,minZoom:u,maxZoom:d}=n,p=c?Ot(Sa.interpolationFactor(c,t,u,d),0,1):0;n.kind==="camera"?o=qe(n.minSize,n.maxSize,p):i=p}return{uSizeT:i,uSize:o}}var hW=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Ko,evaluateSizeForFeature:hp,evaluateSizeForZoom:Ca,getSizeData:Rw});function dW(n,t,i){return n.sections.forEach(o=>{o.text=function(c,u,d){const p=u.layout.get("text-transform").evaluate(d,{});return p==="uppercase"?c=c.toLocaleUpperCase():p==="lowercase"&&(c=c.toLocaleLowerCase()),To.applyArabicShaping&&(c=To.applyArabicShaping(c)),c}(o.text,t,i)}),n}const dp={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function fW(n){return n===""||n===""||n===""||n===""||n===""||n===""||n===""||n===""||n===""||n===""||n===""||n===""||n===""||n===""||n===""||n===""||n===""}function pW(n){return n===""||n===""||n===""||n===""||n===""||n===""||n===""||n===""||n===""||n===""}const Ow=3;function mW(n,t,i){t.glyphs=[],n===1&&i.readMessage(gW,t)}function gW(n,t,i){if(n===3){const{id:o,bitmap:c,width:u,height:d,left:p,top:g,advance:_}=i.readMessage(_W,{});t.glyphs.push({id:o,bitmap:new fl({width:u+2*Ow,height:d+2*Ow},c),metrics:{width:u,height:d,left:p,top:g,advance:_}})}else n===4?t.ascender=i.readSVarint():n===5&&(t.descender=i.readSVarint())}function _W(n,t,i){n===1?t.id=i.readVarint():n===2?t.bitmap=i.readBytes():n===3?t.width=i.readVarint():n===4?t.height=i.readVarint():n===5?t.left=i.readSVarint():n===6?t.top=i.readSVarint():n===7&&(t.advance=i.readVarint())}const BR=Ow,dr={horizontal:1,vertical:2,horizontalOnly:3},jR=-17;class fp{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,i){const o=new fp;return o.scale=t||1,o.fontStack=i,o}static forImage(t){const i=new fp;return i.imageName=t,i}}class yd{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,i){const o=new yd;for(let c=0;c<t.sections.length;c++){const u=t.sections[c];u.image?o.addImageSection(u):o.addTextSection(u,i)}return o}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSections(){return this.sections}getSectionIndex(t){return this.sectionIndex[t]}getCodePoint(t){return this.text.codePointAt(t)}verticalizePunctuation(t){this.text=function(i,o){let c="";for(let u=0;u<i.length;u++){const d=i.charCodeAt(u+1)||null,p=i.charCodeAt(u-1)||null;c+=!o&&(d&&XI(d)&&!dp[i[u+1]]||p&&XI(p)&&!dp[i[u-1]])||!dp[i[u]]?i[u]:dp[i[u]]}return c}(this.text,t)}trim(){let t=0;for(let o=0;o<this.text.length&&q_[this.text.charCodeAt(o)];o++)t++;let i=this.text.length;for(let o=this.text.length-1;o>=0&&o>=t&&q_[this.text.charCodeAt(o)];o--)i--;this.text=this.text.substring(t,i),this.sectionIndex=this.sectionIndex.slice(t,i)}substring(t,i){const o=new yd;return o.text=this.text.substring(t,i),o.sectionIndex=this.sectionIndex.slice(t,i),o.sections=this.sections,o}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,i)=>Math.max(t,this.sections[i].scale),0)}addTextSection(t,i){this.text+=t.text,this.sections.push(fp.forText(t.scale,t.fontStack||i));const o=this.sections.length-1;for(let c=0;c<t.text.length;++c)this.sectionIndex.push(o)}addImageSection(t){const i=t.image?t.image.namePrimary:"";if(i.length===0)return void _t("Can't add FormattedSection with an empty image.");const o=this.getNextImageSectionCharCode();o?(this.text+=String.fromCodePoint(o),this.sections.push(fp.forImage(i)),this.sectionIndex.push(this.sections.length-1)):_t("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Lw(n,t,i,o,c,u,d,p,g,_,v,b,S,E,A){const C=yd.fromFeature(n,c);b===dr.vertical&&C.verticalizePunctuation(S);let P=[];const k=function(U,q,Z,X,J,rt){if(!U)return[];const it=[],ut=function(xt,ht,pt,Et,At,Mt){let Lt=0;for(let Nt=0;Nt<xt.length();Nt++){const jt=xt.getSection(Nt);Lt+=VR(xt.getCodePoint(Nt),jt,Et,At,ht,Mt)}return Lt/Math.max(1,Math.ceil(Lt/pt))}(U,q,Z,X,J,rt),tt=U.text.indexOf("")>=0;let dt=0;for(let xt=0;xt<U.length();xt++){const ht=U.getSection(xt),pt=U.getCodePoint(xt);if(q_[pt]||(dt+=VR(pt,ht,X,J,q,rt)),xt<U.length()-1){const Et=!((gt=pt)<11904||!(Ce["Bopomofo Extended"](gt)||Ce.Bopomofo(gt)||Ce["CJK Compatibility Forms"](gt)||Ce["CJK Compatibility Ideographs"](gt)||Ce["CJK Compatibility"](gt)||Ce["CJK Radicals Supplement"](gt)||Ce["CJK Strokes"](gt)||Ce["CJK Symbols and Punctuation"](gt)||Ce["CJK Unified Ideographs Extension A"](gt)||Ce["CJK Unified Ideographs"](gt)||Ce["Enclosed CJK Letters and Months"](gt)||Ce["Halfwidth and Fullwidth Forms"](gt)||Ce.Hiragana(gt)||Ce["Ideographic Description Characters"](gt)||Ce["Kangxi Radicals"](gt)||Ce["Katakana Phonetic Extensions"](gt)||Ce.Katakana(gt)||Ce["Vertical Forms"](gt)||Ce["Yi Radicals"](gt)||Ce["Yi Syllables"](gt)));(yW[pt]||Et||ht.imageName)&&it.push($R(xt+1,dt,ut,it,vW(pt,U.getCodePoint(xt+1),Et&&tt),!1))}}var gt;return GR($R(U.length(),dt,ut,it,0,!0))}(C,_,u,t,o,E),{processBidirectionalText:L,processStyledBidirectionalText:j}=To;if(L&&C.sections.length===1){const U=L(C.toString(),k);for(const q of U){const Z=new yd;Z.text=q,Z.sections=C.sections;for(let X=0;X<q.length;X++)Z.sectionIndex.push(0);P.push(Z)}}else if(j){const U=j(C.text,C.sectionIndex,k);for(const q of U){const Z=new yd;Z.text=q[0],Z.sectionIndex=q[1],Z.sections=C.sections,P.push(Z)}}else P=function(U,q){const Z=[],X=U.text;let J=0;for(const rt of q)Z.push(U.substring(J,rt)),J=rt;return J<X.length&&Z.push(U.substring(J,X.length)),Z}(C,k);const V=[],F={positionedLines:V,text:C.toString(),top:v[1],bottom:v[1],left:v[0],right:v[0],writingMode:b,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(U,q,Z,X,J,rt,it,ut,tt,dt,gt,xt){let ht=0,pt=0,Et=0;const At=ut==="right"?1:ut==="left"?0:.5;let Mt=!1;for(const ce of J){const ue=ce.getSections();for(const ye of ue){if(ye.imageName)continue;const be=q[ye.fontStack];if(be&&(Mt=be.ascender!==void 0&&be.descender!==void 0,!Mt))break}if(!Mt)break}let Lt=0;for(const ce of J){ce.trim();const ue=ce.getMaxScale(),ye=(ue-1)*xi,be={positionedGlyphs:[],lineOffset:0};U.positionedLines[Lt]=be;const We=be.positionedGlyphs;let Pe=0;if(!ce.length()){pt+=rt,++Lt;continue}let Tn=0,fn=0;for(let Ue=0;Ue<ce.length();Ue++){const Re=ce.getSection(Ue),gn=ce.getSectionIndex(Ue),bn=ce.getCodePoint(Ue);let sn=Re.scale,Gn=null,kr=null,Vn=null,rr=xi,Or=0;const Dr=!(tt===dr.horizontal||!gt&&!mb(bn)||gt&&(q_[bn]||(Nt=bn,Ce.Arabic(Nt)||Ce["Arabic Supplement"](Nt)||Ce["Arabic Extended-A"](Nt)||Ce["Arabic Presentation Forms-A"](Nt)||Ce["Arabic Presentation Forms-B"](Nt))));if(Re.imageName){const lr=X[Re.imageName];if(!lr)continue;Vn=Re.imageName,U.iconsInText=U.iconsInText||!0,kr=lr.paddedRect;const zn=lr.displaySize;sn=sn*xi/xt,Gn={width:zn[0],height:zn[1],left:0,top:-BR,advance:Dr?zn[1]:zn[0],localGlyph:!1},Or=Mt?-Gn.height*sn:jR+ue*xi-zn[1]*sn,rr=Gn.advance;const Pi=(Dr?zn[0]:zn[1])*sn-xi*ue;Pi>0&&Pi>Pe&&(Pe=Pi)}else{const lr=Z[Re.fontStack];if(!lr)continue;lr[bn]&&(kr=lr[bn]);const zn=q[Re.fontStack];if(!zn)continue;const Pi=zn.glyphs[bn];if(!Pi)continue;if(Gn=Pi.metrics,rr=bn!==8203?xi:0,Mt){const Oa=zn.ascender!==void 0?Math.abs(zn.ascender):0,gl=zn.descender!==void 0?Math.abs(zn.descender):0,_l=(Oa+gl)*sn;Tn<_l&&(Tn=_l,fn=(Oa-gl)/2*sn),Or=-Oa*sn}else Or=jR+(ue-sn)*xi}Dr?(U.verticalizable=!0,We.push({glyph:bn,imageName:Vn,x:ht,y:pt+Or,vertical:Dr,scale:sn,localGlyph:Gn.localGlyph,fontStack:Re.fontStack,sectionIndex:gn,metrics:Gn,rect:kr}),ht+=rr*sn+dt):(We.push({glyph:bn,imageName:Vn,x:ht,y:pt+Or,vertical:Dr,scale:sn,localGlyph:Gn.localGlyph,fontStack:Re.fontStack,sectionIndex:gn,metrics:Gn,rect:kr}),ht+=Gn.advance*sn+dt)}We.length!==0&&(Et=Math.max(ht-dt,Et),Mt?WR(We,At,Pe,fn,rt*ue/2):WR(We,At,Pe,0,rt/2)),ht=0;const He=rt*ue+Pe;be.lineOffset=Math.max(Pe,ye),pt+=He,++Lt}var Nt;const jt=pt,{horizontalAlign:It,verticalAlign:Gt}=Z_(it);(function(ce,ue,ye,be,We,Pe){const Tn=(ue-ye)*We,fn=-Pe*be;for(const He of ce)for(const Ue of He.positionedGlyphs)Ue.x+=Tn,Ue.y+=fn})(U.positionedLines,At,It,Gt,Et,jt),U.top+=-Gt*jt,U.bottom=U.top+jt,U.left+=-It*Et,U.right=U.left+Et,U.hasBaseline=Mt}(F,t,i,o,P,d,p,g,b,_,S,A),!function(U){for(const q of U)if(q.positionedGlyphs.length!==0)return!1;return!0}(V)&&F}const q_={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},yW={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function VR(n,t,i,o,c,u){if(t.imageName){const d=o[t.imageName];return d?d.displaySize[0]*t.scale*xi/u+c:0}{const d=i[t.fontStack],p=d&&d.glyphs[n];return p?p.metrics.advance*t.scale+c:0}}function UR(n,t,i,o){const c=Math.pow(n-t,2);return o?n<t?c/2:2*c:c+Math.abs(i)*i}function vW(n,t,i){let o=0;return n===10&&(o-=1e4),i&&(o+=150),n!==40&&n!==65288||(o+=50),t!==41&&t!==65289||(o+=50),o}function $R(n,t,i,o,c,u){let d=null,p=UR(t,i,c,u);for(const g of o){const _=UR(t-g.x,i,c,u)+g.badness;_<=p&&(d=g,p=_)}return{index:n,x:t,priorBreak:d,badness:p}}function GR(n){return n?GR(n.priorBreak).concat(n.index):[]}function Z_(n){let t=.5,i=.5;switch(n){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(n){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:t,verticalAlign:i}}function WR(n,t,i,o,c){if(!(t||i||o||c))return;const u=n.length-1,d=n[u],p=(d.x+d.metrics.advance*d.scale)*t;for(let g=0;g<=u;g++)n[g].x-=p,n[g].y+=i+o+c}function xW(n,t,i,o){const{horizontalAlign:c,verticalAlign:u}=Z_(o),d=i[0]-n.displaySize[0]*c,p=i[1]-n.displaySize[1]*u;return{imagePrimary:n,imageSecondary:t,top:p,bottom:p+n.displaySize[1],left:d,right:d+n.displaySize[0]}}function HR(n,t,i,o,c,u){const d=n.imagePrimary;let p;if(d.content){const P=d.content,k=d.pixelRatio||1;p=[P[0]/k,P[1]/k,d.displaySize[0]-P[2]/k,d.displaySize[1]-P[3]/k]}const g=t.left*u,_=t.right*u;let v,b,S,E;i==="width"||i==="both"?(E=c[0]+g-o[3],b=c[0]+_+o[1]):(E=c[0]+(g+_-d.displaySize[0])/2,b=E+d.displaySize[0]);const A=t.top*u,C=t.bottom*u;return i==="height"||i==="both"?(v=c[1]+A-o[0],S=c[1]+C+o[2]):(v=c[1]+(A+C-d.displaySize[1])/2,S=v+d.displaySize[1]),{imagePrimary:d,imageSecondary:void 0,top:v,right:b,bottom:S,left:E,collisionPadding:p}}class ml extends W{constructor(t,i,o,c,u){super(t,i),this.angle=c,this.z=o,u!==void 0&&(this.segment=u)}clone(){return new ml(this.x,this.y,this.z,this.angle,this.segment)}}function qR(n,t,i,o,c){if(t.segment===void 0)return!0;let u=t,d=t.segment+1,p=0;for(;p>-i/2;){if(d--,d<0)return!1;p-=n[d].dist(u),u=n[d]}p+=n[d].dist(n[d+1]),d++;const g=[];let _=0;for(;p<i/2;){const v=n[d],b=n[d+1];if(!b)return!1;let S=n[d-1].angleTo(v)-v.angleTo(b);for(S=Math.abs((S+3*Math.PI)%(2*Math.PI)-Math.PI),g.push({distance:p,angleDelta:S}),_+=S;p-g[0].distance>o;)_-=g.shift().angleDelta;if(_>c)return!1;d++,p+=v.dist(b)}return!0}function ZR(n){let t=0;for(let i=0;i<n.length-1;i++)t+=n[i].dist(n[i+1]);return t}function XR(n,t,i){return n?.6*t*i:0}function YR(n,t){return Math.max(n?n.right-n.left:0,t?t.right-t.left:0)}function bW(n,t,i,o,c,u){const d=XR(i,c,u),p=YR(i,o)*u;let g=0;const _=ZR(n)/2;for(let v=0;v<n.length-1;v++){const b=n[v],S=n[v+1],E=b.dist(S);if(g+E>_){const A=(_-g)/E,C=qe(b.x,S.x,A),P=qe(b.y,S.y,A),k=new ml(C,P,0,S.angleTo(b),v);return!d||qR(n,k,p,d,t)?k:void 0}g+=E}}function wW(n,t,i,o,c,u,d,p,g){const _=XR(o,u,d),v=YR(o,c),b=v*d,S=n[0].x===0||n[0].x===g||n[0].y===0||n[0].y===g;return t-b<t/4&&(t=b+t/4),KR(n,S?t/2*p%t:(v/2+2*u)*d*p%t,t,_,i,b,S,!1,g)}function KR(n,t,i,o,c,u,d,p,g){const _=u/2,v=ZR(n);let b=0,S=t-i,E=[];for(let A=0;A<n.length-1;A++){const C=n[A],P=n[A+1],k=C.dist(P),L=P.angleTo(C);for(;S+i<b+k;){S+=i;const j=(S-b)/k,V=qe(C.x,P.x,j),F=qe(C.y,P.y,j);if(V>=0&&V<g&&F>=0&&F<g&&S-_>=0&&S+_<=v){const U=new ml(V,F,0,L,A);o&&!qR(n,U,u,o,c)||E.push(U)}}b+=k}return p||E.length||d||(E=KR(n,b/2,i,o,c,u,d,!0,g)),E}function JR(n,t,i,o,c){const u=[];for(let d=0;d<n.length;d++){const p=n[d];let g;for(let _=0;_<p.length-1;_++){let v=p[_],b=p[_+1];v.x<t&&b.x<t||(v.x<t?v=new W(t,v.y+(t-v.x)/(b.x-v.x)*(b.y-v.y))._round():b.x<t&&(b=new W(t,v.y+(t-v.x)/(b.x-v.x)*(b.y-v.y))._round()),v.y<i&&b.y<i||(v.y<i?v=new W(v.x+(i-v.y)/(b.y-v.y)*(b.x-v.x),i)._round():b.y<i&&(b=new W(v.x+(i-v.y)/(b.y-v.y)*(b.x-v.x),i)._round()),v.x>=o&&b.x>=o||(v.x>=o?v=new W(o,v.y+(o-v.x)/(b.x-v.x)*(b.y-v.y))._round():b.x>=o&&(b=new W(o,v.y+(o-v.x)/(b.x-v.x)*(b.y-v.y))._round()),v.y>=c&&b.y>=c||(v.y>=c?v=new W(v.x+(c-v.y)/(b.y-v.y)*(b.x-v.x),c)._round():b.y>=c&&(b=new W(v.x+(c-v.y)/(b.y-v.y)*(b.x-v.x),c)._round()),g&&v.equals(g[g.length-1])||(g=[v],u.push(g)),g.push(b)))))}}return u}function zw(n){let t=0,i=0;for(const d of n)t+=d.w*d.h,i=Math.max(i,d.w);n.sort((d,p)=>p.h-d.h);const o=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),i),h:1/0}];let c=0,u=0;for(const d of n)for(let p=o.length-1;p>=0;p--){const g=o[p];if(!(d.w>g.w||d.h>g.h)){if(d.x=g.x,d.y=g.y,u=Math.max(u,d.y+d.h),c=Math.max(c,d.x+d.w),d.w===g.w&&d.h===g.h){const _=o.pop();p<o.length&&(o[p]=_)}else d.h===g.h?(g.x+=d.w,g.w-=d.w):d.w===g.w?(g.y+=d.h,g.h-=d.h):(o.push({x:g.x+d.w,y:g.y,w:g.w-d.w,h:d.h}),g.y+=d.h,g.h-=d.h);break}}return{w:c,h:u,fill:t/(c*u)||0}}Se(ml,"Anchor");const zs=1;class Nw{constructor(t,{pixelRatio:i,version:o,stretchX:c,stretchY:u,content:d}){this.paddedRect=t,this.pixelRatio=i,this.stretchX=c,this.stretchY=u,this.content=d,this.version=o}get tl(){return[this.paddedRect.x+zs,this.paddedRect.y+zs]}get br(){return[this.paddedRect.x+this.paddedRect.w-zs,this.paddedRect.y+this.paddedRect.h-zs]}get displaySize(){return[(this.paddedRect.w-2*zs)/this.pixelRatio,(this.paddedRect.h-2*zs)/this.pixelRatio]}}class QR{constructor(t,i){const o={},c={};this.haveRenderCallbacks=[];const u=[];this.addImages(t,o,u),this.addImages(i,c,u);const{w:d,h:p}=zw(u),g=new Fr({width:d||1,height:p||1});for(const _ in t){const v=t[_],b=o[_].paddedRect;Fr.copy(v.data,g,{x:0,y:0},{x:b.x+zs,y:b.y+zs},v.data)}for(const _ in i){const v=i[_],b=c[_].paddedRect,S=b.x+zs,E=b.y+zs,A=v.data.width,C=v.data.height;Fr.copy(v.data,g,{x:0,y:0},{x:S,y:E},v.data),Fr.copy(v.data,g,{x:0,y:C-1},{x:S,y:E-1},{width:A,height:1}),Fr.copy(v.data,g,{x:0,y:0},{x:S,y:E+C},{width:A,height:1}),Fr.copy(v.data,g,{x:A-1,y:0},{x:S-1,y:E},{width:1,height:C}),Fr.copy(v.data,g,{x:0,y:0},{x:S+A,y:E},{width:1,height:C})}this.image=g,this.iconPositions=o,this.patternPositions=c}addImages(t,i,o){for(const c in t){const u=t[c],d={x:0,y:0,w:u.data.width+2*zs,h:u.data.height+2*zs};o.push(d),i[c]=new Nw(d,u),u.hasRenderCallback&&this.haveRenderCallbacks.push(c)}}patchUpdatedImages(t,i,o){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(c=>t.hasImage(c,o)),t.dispatchRenderCallbacks(this.haveRenderCallbacks,o);for(const c in t.getUpdatedImages(o))this.patchUpdatedImage(this.iconPositions[c],t.getImage(c,o),i),this.patchUpdatedImage(this.patternPositions[c],t.getImage(c,o),i)}patchUpdatedImage(t,i,o){if(!t||!i||t.version===i.version)return;t.version=i.version;const[c,u]=t.tl;o.update(i.data,void 0,{x:c,y:u})}}Se(Nw,"ImagePosition"),Se(QR,"ImageAtlas");const pp=1e20;function tO(n,t,i,o,c,u,d,p,g){for(let _=t;_<t+o;_++)eO(n,i*u+_,u,c,d,p,g);for(let _=i;_<i+c;_++)eO(n,_*u+t,1,o,d,p,g)}function eO(n,t,i,o,c,u,d){u[0]=0,d[0]=-pp,d[1]=pp,c[0]=n[t];for(let p=1,g=0,_=0;p<o;p++){c[p]=n[t+p*i];const v=p*p;do{const b=u[g];_=(c[p]-c[b]+v-b*b)/(p-b)/2}while(_<=d[g]&&--g>-1);g++,u[g]=p,d[g]=_,d[g+1]=pp}for(let p=0,g=0;p<o;p++){for(;d[g+1]<p;)g++;const _=u[g],v=p-_;n[t+p*i]=c[_]+v*v}}const Jo=2;class vd{constructor(t,i,o){this.requestManager=t,this.localGlyphMode=i,this.localFontFamily=o,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(t,i){this.urls[i]=t}getGlyphs(t,i,o){const c=[],u=this.urls[i]||I.GLYPHS_URL;for(const d in t)for(const p of t[d])c.push({stack:d,id:p});kt(c,({stack:d,id:p},g)=>{let _=this.entries[d];_||(_=this.entries[d]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let v=_.glyphs[p];if(v!==void 0)return void g(null,{stack:d,id:p,glyph:v});if(v=this._tinySDF(_,d,p),v)return _.glyphs[p]=v,void g(null,{stack:d,id:p,glyph:v});const b=Math.floor(p/256);if(256*b>65535)return void g(new Error("glyphs > 65535 not supported"));if(_.ranges[b])return void g(null,{stack:d,id:p,glyph:v});let S=_.requests[b];S||(S=_.requests[b]=[],vd.loadGlyphRange(d,b,u,this.requestManager,(E,A)=>{if(A){_.ascender=A.ascender,_.descender=A.descender;for(const C in A.glyphs)this._doesCharSupportLocalGlyph(+C)||(_.glyphs[+C]=A.glyphs[+C]);_.ranges[b]=!0}for(const C of S)C(E,A);delete _.requests[b]})),S.push((E,A)=>{E?g(E):A&&g(null,{stack:d,id:p,glyph:A.glyphs[p]||null})})},(d,p)=>{if(d)o(d);else if(p){const g={};for(const{stack:_,id:v,glyph:b}of p)g[_]===void 0&&(g[_]={}),g[_].glyphs===void 0&&(g[_].glyphs={}),g[_].glyphs[v]=b&&{id:b.id,bitmap:b.bitmap.clone(),metrics:b.metrics},g[_].ascender=this.entries[_].ascender,g[_].descender=this.entries[_].descender;o(null,g)}})}_doesCharSupportLocalGlyph(t){return this.localGlyphMode!==0&&(this.localGlyphMode===2?!!this.localFontFamily:!!this.localFontFamily&&(Ce["CJK Unified Ideographs"](t)||Ce["Hangul Syllables"](t)||Ce.Hiragana(t)||Ce.Katakana(t)||Ce["CJK Symbols and Punctuation"](t)||Ce["CJK Unified Ideographs Extension A"](t)||Ce["CJK Unified Ideographs Extension B"](t)))}_tinySDF(t,i,o){const c=this.localFontFamily;if(!c||!this._doesCharSupportLocalGlyph(o))return;let u=t.tinySDF;if(!u){let C="400";/bold/i.test(i)?C="900":/medium/i.test(i)?C="500":/light/i.test(i)&&(C="200"),u=t.tinySDF=new vd.TinySDF({fontFamily:c,fontWeight:C,fontSize:24*Jo,buffer:3*Jo,radius:8*Jo}),u.fontWeight=C}if(this.localGlyphs[u.fontWeight][o])return this.localGlyphs[u.fontWeight][o];const d=String.fromCodePoint(o),{data:p,width:g,height:_,glyphWidth:v,glyphHeight:b,glyphLeft:S,glyphTop:E,glyphAdvance:A}=u.draw(d);return this.localGlyphs[u.fontWeight][o]={id:o,bitmap:new fl({width:g,height:_},p),metrics:{width:v/Jo,height:b/Jo,left:S/Jo,top:E/Jo-27,advance:A/Jo,localGlyph:!0}}}}vd.loadGlyphRange=function(n,t,i,o,c){const u=256*t,d=u+255,p=o.transformRequest(o.normalizeGlyphsURL(i).replace("{fontstack}",n).replace("{range}",`${u}-${d}`),zt.Glyphs);oe(p,(g,_)=>{if(g)c(g);else if(_){const v={},b=function(S){return new W_(S).readFields(mW,{})}(_);for(const S of b.glyphs)v[S.id]=S;c(null,{glyphs:v,ascender:b.ascender,descender:b.descender})}})},vd.TinySDF=class{constructor({fontSize:n=24,buffer:t=3,radius:i=8,cutoff:o=.25,fontFamily:c="sans-serif",fontWeight:u="normal",fontStyle:d="normal"}={}){this.buffer=t,this.cutoff=o,this.radius=i;const p=this.size=n+4*t,g=this._createCanvas(p),_=this.ctx=g.getContext("2d",{willReadFrequently:!0});_.font=`${d} ${u} ${n}px ${c}`,_.textBaseline="alphabetic",_.textAlign="left",_.fillStyle="black",this.gridOuter=new Float64Array(p*p),this.gridInner=new Float64Array(p*p),this.f=new Float64Array(p),this.z=new Float64Array(p+1),this.v=new Uint16Array(p)}_createCanvas(n){const t=document.createElement("canvas");return t.width=t.height=n,t}draw(n){const{width:t,actualBoundingBoxAscent:i,actualBoundingBoxDescent:o,actualBoundingBoxLeft:c,actualBoundingBoxRight:u}=this.ctx.measureText(n),d=Math.ceil(i),p=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(u-c))),g=Math.min(this.size-this.buffer,d+Math.ceil(o)),_=p+2*this.buffer,v=g+2*this.buffer,b=Math.max(_*v,0),S=new Uint8ClampedArray(b),E={data:S,width:_,height:v,glyphWidth:p,glyphHeight:g,glyphTop:d,glyphLeft:0,glyphAdvance:t};if(p===0||g===0)return E;const{ctx:A,buffer:C,gridInner:P,gridOuter:k}=this;A.clearRect(C,C,p,g),A.fillText(n,C,C+d);const L=A.getImageData(C,C,p,g);k.fill(pp,0,b),P.fill(0,0,b);for(let j=0;j<g;j++)for(let V=0;V<p;V++){const F=L.data[4*(j*p+V)+3]/255;if(F===0)continue;const U=(j+C)*_+V+C;if(F===1)k[U]=0,P[U]=pp;else{const q=.5-F;k[U]=q>0?q*q:0,P[U]=q<0?q*q:0}}tO(k,0,0,_,v,_,this.f,this.v,this.z),tO(P,C,C,p,g,_,this.f,this.v,this.z);for(let j=0;j<b;j++){const V=Math.sqrt(k[j])-Math.sqrt(P[j]);S[j]=Math.round(255-255*(V/this.radius+this.cutoff))}return E}};const _c=zs;function nO(n,t,i,o){const c=[],u=n.imagePrimary,d=u.pixelRatio,p=u.paddedRect.w-2*_c,g=u.paddedRect.h-2*_c,_=n.right-n.left,v=n.bottom-n.top,b=u.stretchX||[[0,p]],S=u.stretchY||[[0,g]],E=(rt,it)=>rt+it[1]-it[0],A=b.reduce(E,0),C=S.reduce(E,0),P=p-A,k=g-C;let L=0,j=A,V=0,F=C,U=0,q=P,Z=0,X=k;if(u.content&&o){const rt=u.content;L=X_(b,0,rt[0]),V=X_(S,0,rt[1]),j=X_(b,rt[0],rt[2]),F=X_(S,rt[1],rt[3]),U=rt[0]-L,Z=rt[1]-V,q=rt[2]-rt[0]-j,X=rt[3]-rt[1]-F}const J=(rt,it,ut,tt)=>{const dt=Y_(rt.stretch-L,j,_,n.left),gt=K_(rt.fixed-U,q,rt.stretch,A),xt=Y_(it.stretch-V,F,v,n.top),ht=K_(it.fixed-Z,X,it.stretch,C),pt=Y_(ut.stretch-L,j,_,n.left),Et=K_(ut.fixed-U,q,ut.stretch,A),At=Y_(tt.stretch-V,F,v,n.top),Mt=K_(tt.fixed-Z,X,tt.stretch,C),Lt=new W(dt,xt),Nt=new W(pt,xt),jt=new W(pt,At),It=new W(dt,At),Gt=new W(gt/d,ht/d),ce=new W(Et/d,Mt/d),ue=t*Math.PI/180;if(ue){const fn=Math.sin(ue),He=Math.cos(ue),Ue=[He,-fn,fn,He];Lt._matMult(Ue),Nt._matMult(Ue),It._matMult(Ue),jt._matMult(Ue)}const ye=rt.stretch+rt.fixed,be=ut.stretch+ut.fixed,We=it.stretch+it.fixed,Pe=tt.stretch+tt.fixed,Tn=n.imageSecondary;return{tl:Lt,tr:Nt,bl:It,br:jt,texPrimary:{x:u.paddedRect.x+_c+ye,y:u.paddedRect.y+_c+We,w:be-ye,h:Pe-We},texSecondary:Tn?{x:Tn.paddedRect.x+_c+ye,y:Tn.paddedRect.y+_c+We,w:be-ye,h:Pe-We}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Gt,pixelOffsetBR:ce,minFontScaleX:q/d/_,minFontScaleY:X/d/v,isSDF:i}};if(o&&(u.stretchX||u.stretchY)){const rt=rO(b,P,A),it=rO(S,k,C);for(let ut=0;ut<rt.length-1;ut++){const tt=rt[ut],dt=rt[ut+1];for(let gt=0;gt<it.length-1;gt++)c.push(J(tt,it[gt],dt,it[gt+1]))}}else c.push(J({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:p+1},{fixed:0,stretch:g+1}));return c}function X_(n,t,i){let o=0;for(const c of n)o+=Math.max(t,Math.min(i,c[1]))-Math.max(t,Math.min(i,c[0]));return o}function rO(n,t,i){const o=[{fixed:-_c,stretch:0}];for(const[c,u]of n){const d=o[o.length-1];o.push({fixed:c-d.stretch,stretch:d.stretch}),o.push({fixed:c-d.stretch,stretch:d.stretch+(u-c)})}return o.push({fixed:t+_c,stretch:i}),o}function Y_(n,t,i,o){return n/t*i+o}function K_(n,t,i,o){return n-t*i/o}function SW(n,t,i,o){const c=t+n.positionedLines[o].lineOffset;return o===0?i+c/2:i+(c+(t+n.positionedLines[o-1].lineOffset))/2}function TW(n,t=1,i=!1){let o=1/0,c=1/0,u=-1/0,d=-1/0;const p=n[0];for(let E=0;E<p.length;E++){const A=p[E];(!E||A.x<o)&&(o=A.x),(!E||A.y<c)&&(c=A.y),(!E||A.x>u)&&(u=A.x),(!E||A.y>d)&&(d=A.y)}const g=Math.min(u-o,d-c);let _=g/2;const v=new P1([],EW);if(g===0)return new W(o,c);for(let E=o;E<u;E+=g)for(let A=c;A<d;A+=g)v.push(new xd(E+_,A+_,_,n));let b=function(E){let A=0,C=0,P=0;const k=E[0];for(let L=0,j=k.length,V=j-1;L<j;V=L++){const F=k[L],U=k[V],q=F.x*U.y-U.x*F.y;C+=(F.x+U.x)*q,P+=(F.y+U.y)*q,A+=3*q}return new xd(C/A,P/A,0,E)}(n),S=v.length;for(;v.length;){const E=v.pop();(E.d>b.d||!b.d)&&(b=E,i&&console.log("found best %d after %d probes",Math.round(1e4*E.d)/1e4,S)),E.max-b.d<=t||(_=E.h/2,v.push(new xd(E.p.x-_,E.p.y-_,_,n)),v.push(new xd(E.p.x+_,E.p.y-_,_,n)),v.push(new xd(E.p.x-_,E.p.y+_,_,n)),v.push(new xd(E.p.x+_,E.p.y+_,_,n)),S+=4)}return i&&(console.log(`num probes: ${S}`),console.log(`best distance: ${b.d}`)),b.p}function EW(n,t){return t.max-n.max}class xd{constructor(t,i,o,c){this.p=new W(t,i),this.h=o,this.d=function(u,d){let p=!1,g=1/0;for(let _=0;_<d.length;_++){const v=d[_];for(let b=0,S=v.length,E=S-1;b<S;E=b++){const A=v[b],C=v[E];A.y>u.y!=C.y>u.y&&u.x<(C.x-A.x)*(u.y-A.y)/(C.y-A.y)+A.x&&(p=!p),g=Math.min(g,iR(u,A,C))}}return(p?1:-1)*Math.sqrt(g)}(this.p,c),this.max=this.d+this.h*Math.SQRT2}}const bd=7,Fw=Number.POSITIVE_INFINITY,MW=Math.sqrt(2);function Bw(n,[t,i]){let o=0,c=0;if(i===Fw){t<0&&(t=0);const u=t/MW;switch(n){case"top-right":case"top-left":c=u-bd;break;case"bottom-right":case"bottom-left":c=-u+bd;break;case"bottom":c=-t+bd;break;case"top":c=t-bd}switch(n){case"top-right":case"bottom-right":o=-u;break;case"top-left":case"bottom-left":o=u;break;case"left":o=t;break;case"right":o=-t}}else{switch(t=Math.abs(t),i=Math.abs(i),n){case"top-right":case"top-left":case"top":c=i-bd;break;case"bottom-right":case"bottom-left":case"bottom":c=-i+bd}switch(n){case"top-right":case"bottom-right":case"right":o=-t;break;case"top-left":case"bottom-left":case"left":o=t}}return[o,c]}function AW(n,t,i,o,c,u,d,p,g,_,v){n.createArrays(),n.tilePixelRatio=Dt/(512*n.overscaling),n.compareText={},n.iconsNeedLinear=!1;const b=n.layers[0].layout,S=n.layers[0]._unevaluatedLayout._values,E={};if(n.textSizeData.kind==="composite"){const{minZoom:k,maxZoom:L}=n.textSizeData;E.compositeTextSizes=[S["text-size"].possiblyEvaluate(new pr(k),p),S["text-size"].possiblyEvaluate(new pr(L),p)]}if(n.iconSizeData.kind==="composite"){const{minZoom:k,maxZoom:L}=n.iconSizeData;E.compositeIconSizes=[S["icon-size"].possiblyEvaluate(new pr(k),p),S["icon-size"].possiblyEvaluate(new pr(L),p)]}E.layoutTextSize=S["text-size"].possiblyEvaluate(new pr(g+1),p),E.layoutIconSize=S["icon-size"].possiblyEvaluate(new pr(g+1),p),E.textMaxSize=S["text-size"].possiblyEvaluate(new pr(18),p);const A=b.get("text-rotation-alignment")==="map"&&b.get("symbol-placement")!=="point",C=b.get("text-size");let P=!1;for(const k of n.features)if(k.icon&&k.icon.nameSecondary){P=!0;break}for(const k of n.features){const L=b.get("text-font").evaluate(k,{},p).join(","),j=C.evaluate(k,{},p),V=E.layoutTextSize.evaluate(k,{},p),F=(E.layoutIconSize.evaluate(k,{},p),{horizontal:{},vertical:void 0}),U=k.text;let q,Z=[0,0];if(U){const rt=U.toString(),it=b.get("text-letter-spacing").evaluate(k,{},p)*xi,ut=b.get("text-line-height").evaluate(k,{},p)*xi,tt=t9(rt)?it:0,dt=b.get("text-anchor").evaluate(k,{},p),gt=b.get("text-variable-anchor");if(!gt){const At=b.get("text-radial-offset").evaluate(k,{},p);Z=At?Bw(dt,[At*xi,Fw]):b.get("text-offset").evaluate(k,{},p).map(Mt=>Mt*xi)}let xt=A?"center":b.get("text-justify").evaluate(k,{},p);const ht=b.get("symbol-placement")==="point",pt=ht?b.get("text-max-width").evaluate(k,{},p)*xi:1/0,Et=At=>{n.allowVerticalPlacement&&pb(rt)&&(F.vertical=Lw(U,t,i,c,L,pt,ut,dt,At,tt,Z,dr.vertical,!0,V,j))};if(!A&&gt){const At=xt==="auto"?gt.map(Lt=>jw(Lt)):[xt];let Mt=!1;for(let Lt=0;Lt<At.length;Lt++){const Nt=At[Lt];if(!F.horizontal[Nt])if(Mt)F.horizontal[Nt]=F.horizontal[0];else{const jt=Lw(U,t,i,c,L,pt,ut,"center",Nt,tt,Z,dr.horizontal,!1,V,j);jt&&(F.horizontal[Nt]=jt,Mt=jt.positionedLines.length===1)}}Et("left")}else{if(xt==="auto"&&(xt=jw(dt)),ht||b.get("text-writing-mode").indexOf("horizontal")>=0||!pb(rt)){const At=Lw(U,t,i,c,L,pt,ut,dt,xt,tt,Z,dr.horizontal,!1,V,j);At&&(F.horizontal[xt]=At)}Et(ht?"left":xt)}}let X=!1;if(k.icon&&k.icon.namePrimary){const rt=o[k.icon.namePrimary];rt&&(q=xW(c[k.icon.namePrimary],k.icon.nameSecondary?c[k.icon.nameSecondary]:void 0,b.get("icon-offset").evaluate(k,{},p),b.get("icon-anchor").evaluate(k,{},p)),X=rt.sdf,n.sdfIcons===void 0?n.sdfIcons=rt.sdf:n.sdfIcons!==rt.sdf&&_t("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(rt.pixelRatio!==n.pixelRatio||b.get("icon-rotate").constantOr(1)!==0)&&(n.iconsNeedLinear=!0))}const J=sO(F.horizontal)||F.vertical;n.iconsInText||(n.iconsInText=!!J&&J.iconsInText),(J||q)&&CW(n,k,F,q,o,E,V,0,Z,X,d,p,_,v,P)}u&&n.generateCollisionDebugBuffers(g,n.collisionBoxArray)}function jw(n){switch(n){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function CW(n,t,i,o,c,u,d,p,g,_,v,b,S,E,A){let C=u.textMaxSize.evaluate(t,{},b);C===void 0&&(C=d);const P=n.layers[0].layout,k=P.get("icon-offset").evaluate(t,{},b),L=sO(i.horizontal)||i.vertical,j=S.name==="globe",V=xi,F=d/V,U=n.tilePixelRatio*C/V,q=(dt=n.overscaling,n.zoom>18&&dt>2&&(dt>>=1),Math.max(Dt/(512*dt),1)*P.get("symbol-spacing")),Z=P.get("text-padding")*n.tilePixelRatio,X=P.get("icon-padding")*n.tilePixelRatio,J=st(P.get("text-max-angle")),rt=P.get("text-rotation-alignment")==="map"&&P.get("symbol-placement")!=="point",it=P.get("icon-rotation-alignment")==="map"&&P.get("symbol-placement")!=="point",ut=P.get("symbol-placement"),tt=q/2;var dt;const gt=P.get("icon-text-fit").evaluate(t,{},b),xt=P.get("icon-text-fit-padding").evaluate(t,{},b),ht=gt!=="none";let pt;n.hasAnyIconTextFit===!1&&ht&&(n.hasAnyIconTextFit=!0),o&&ht&&(n.allowVerticalPlacement&&i.vertical&&(pt=HR(o,i.vertical,gt,xt,k,F)),L&&(o=HR(o,L,gt,xt,k,F)));const Et=(At,Mt,Lt)=>{if(Mt.x<0||Mt.x>=Dt||Mt.y<0||Mt.y>=Dt)return;let Nt=null;if(j){const{x:jt,y:It,z:Gt}=S.projectTilePoint(Mt.x,Mt.y,Lt);Nt={anchor:new ml(jt,It,Gt,0,void 0),up:S.upVector(Lt,Mt.x,Mt.y)}}(function(jt,It,Gt,ce,ue,ye,be,We,Pe,Tn,fn,He,Ue,Re,gn,bn,sn,Gn,kr,Vn,rr,Or,Dr,lr,zn,Pi,Oa){const gl=jt.addToLineVertexArray(It,ce);let _l,zp,Np,Hy,hz,dz,fz,pz=0,mz=0,gz=0,_z=0,jS=-1,VS=-1;const La={};let yz=Bb("");const qu=Gt?Gt.anchor:It,US=Pe.layout.get("icon-text-fit").evaluate(rr,{},zn)!=="none";let $S=0,GS=0;if(Pe._unevaluatedLayout.getValue("text-radial-offset")===void 0?[$S,GS]=Pe.layout.get("text-offset").evaluate(rr,{},zn).map(Fs=>Fs*xi):($S=Pe.layout.get("text-radial-offset").evaluate(rr,{},zn)*xi,GS=Fw),jt.allowVerticalPlacement&&ue.vertical){const Fs=ue.vertical;if(gn)dz=Vw(Fs),We&&(fz=Vw(We));else{const Bs=Pe.layout.get("text-rotate").evaluate(rr,{},zn)+90;Np=J_(Tn,qu,It,fn,He,Ue,Fs,Re,Bs,bn),We&&(Hy=J_(Tn,qu,It,fn,He,Ue,We,Gn,Bs))}}if(ye){const Fs=Pe.layout.get("icon-rotate").evaluate(rr,{},zn),Bs=nO(ye,Fs,Dr,US),Dd=We?nO(We,Fs,Dr,US):void 0;zp=J_(Tn,qu,It,fn,He,Ue,ye,Gn,Fs),pz=4*Bs.length;const vz=jt.iconSizeData;let Zu=null;vz.kind==="source"?(Zu=[Ko*Pe.layout.get("icon-size").evaluate(rr,{},zn)],Zu[0]>yc&&_t(`${jt.layerIds[0]}: Value for "icon-size" is >= ${mp}. Reduce your "icon-size".`)):vz.kind==="composite"&&(Zu=[Ko*Or.compositeIconSizes[0].evaluate(rr,{},zn),Ko*Or.compositeIconSizes[1].evaluate(rr,{},zn)],(Zu[0]>yc||Zu[1]>yc)&&_t(`${jt.layerIds[0]}: Value for "icon-size" is >= ${mp}. Reduce your "icon-size".`)),jt.addSymbols(jt.icon,Bs,Zu,Vn,kr,rr,!1,Gt,It,gl.lineStartIndex,gl.lineLength,-1,lr,zn,Pi,Oa),jS=jt.icon.placedSymbolArray.length-1,Dd&&(mz=4*Dd.length,jt.addSymbols(jt.icon,Dd,Zu,Vn,kr,rr,dr.vertical,Gt,It,gl.lineStartIndex,gl.lineLength,-1,lr,zn,Pi,Oa),VS=jt.icon.placedSymbolArray.length-1)}for(const Fs in ue.horizontal){const Bs=ue.horizontal[Fs];_l||(yz=Bb(Bs.text),gn?hz=Vw(Bs):_l=J_(Tn,qu,It,fn,He,Ue,Bs,Re,Pe.layout.get("text-rotate").evaluate(rr,{},zn),bn));const Dd=Bs.positionedLines.length===1;if(gz+=iO(jt,Gt,It,Bs,be,Pe,gn,rr,bn,gl,ue.vertical?dr.horizontal:dr.horizontalOnly,Dd?Object.keys(ue.horizontal):[Fs],La,jS,Or,lr,zn,Pi),Dd)break}ue.vertical&&(_z+=iO(jt,Gt,It,ue.vertical,be,Pe,gn,rr,bn,gl,dr.vertical,["vertical"],La,VS,Or,lr,zn,Pi));let Mc=-1;const WS=(Fs,Bs)=>Fs?Math.max(Fs,Bs):Bs;Mc=WS(hz,Mc),Mc=WS(dz,Mc),Mc=WS(fz,Mc);const dY=Mc>-1?1:0;jt.glyphOffsetArray.length>=xp.MAX_GLYPHS&&_t("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),rr.sortKey!==void 0&&jt.addToSortKeyRanges(jt.symbolInstances.length,rr.sortKey),jt.symbolInstances.emplaceBack(It.x,It.y,qu.x,qu.y,qu.z,La.right>=0?La.right:-1,La.center>=0?La.center:-1,La.left>=0?La.left:-1,La.vertical>=0?La.vertical:-1,jS,VS,yz,_l!==void 0?_l:jt.collisionBoxArray.length,_l!==void 0?_l+1:jt.collisionBoxArray.length,Np!==void 0?Np:jt.collisionBoxArray.length,Np!==void 0?Np+1:jt.collisionBoxArray.length,zp!==void 0?zp:jt.collisionBoxArray.length,zp!==void 0?zp+1:jt.collisionBoxArray.length,Hy||jt.collisionBoxArray.length,Hy?Hy+1:jt.collisionBoxArray.length,fn,gz,_z,pz,mz,dY,0,$S,GS,Mc,0,US?1:0)})(n,Mt,Nt,At,i,o,c,pt,n.layers[0],n.collisionBoxArray,t.index,t.sourceLayerIndex,n.index,Z,rt,g,0,X,it,k,t,u,_,v,b,E,A)};if(ut==="line")for(const At of JR(t.geometry,0,0,Dt,Dt)){const Mt=wW(At,q,J,i.vertical||L,o,V,U,n.overscaling,Dt);for(const Lt of Mt)L&&PW(n,L.text,tt,Lt)||Et(At,Lt,b)}else if(ut==="line-center"){for(const At of t.geometry)if(At.length>1){const Mt=bW(At,J,i.vertical||L,o,V,U);Mt&&Et(At,Mt,b)}}else if(t.type==="Polygon")for(const At of Aw(t.geometry,0)){const Mt=TW(At,16);Et(At[0],new ml(Mt.x,Mt.y,0,0,void 0),b)}else if(t.type==="LineString")for(const At of t.geometry)Et(At,new ml(At[0].x,At[0].y,0,0,void 0),b);else if(t.type==="Point")for(const At of t.geometry)for(const Mt of At)Et([Mt],new ml(Mt.x,Mt.y,0,0,void 0),b)}const mp=255,yc=mp*Ko;function iO(n,t,i,o,c,u,d,p,g,_,v,b,S,E,A,C,P,k){const L=function(F,U,q,Z,X,J,rt,it){const ut=[];if(U.positionedLines.length===0)return ut;const tt=Z.layout.get("text-rotate").evaluate(J,{})*Math.PI/180,dt=function(Et){const At=Et[0],Mt=Et[1],Lt=At*Mt;return Lt>0?[At,-Mt]:Lt<0?[-At,Mt]:At===0?[Mt,At]:[Mt,-At]}(q);let gt=Math.abs(U.top-U.bottom);for(const Et of U.positionedLines)gt-=Et.lineOffset;const xt=U.positionedLines.length,ht=gt/xt;let pt=U.top-q[1];for(let Et=0;Et<xt;++Et){const At=U.positionedLines[Et];pt=SW(U,ht,pt,Et);for(const Mt of At.positionedGlyphs){if(!Mt.rect)continue;const Lt=Mt.rect||{};let Nt=BR+1,jt=!0,It=1,Gt=0;if(Mt.imageName){const Vn=rt[Mt.imageName];if(!Vn)continue;if(Vn.sdf){_t("SDF images are not supported in formatted text and will be ignored.");continue}jt=!1,It=Vn.pixelRatio,Nt=zs/It}const ce=(X||it)&&Mt.vertical,ue=Mt.metrics.advance*Mt.scale/2,ye=Mt.metrics,be=Mt.rect;if(be===null)continue;it&&U.verticalizable&&(Gt=Mt.imageName?ue-Mt.metrics.width*Mt.scale/2:0);const We=X?[Mt.x+ue,Mt.y]:[0,0];let Pe=[0,0],Tn=[0,0],fn=!1;X||(ce?(Tn=[Mt.x+ue+dt[0],Mt.y+dt[1]-Gt],fn=!0):Pe=[Mt.x+ue+q[0],Mt.y+q[1]-Gt]);const He=be.w*Mt.scale/(It*(Mt.localGlyph?Jo:1)),Ue=be.h*Mt.scale/(It*(Mt.localGlyph?Jo:1));let Re,gn,bn,sn;if(ce){const Vn=Mt.y-pt,rr=new W(-ue,ue-Vn),Or=-Math.PI/2,Dr=new W(...Tn);Re=new W(-ue+Pe[0],Pe[1]),Re._rotateAround(Or,rr)._add(Dr),Re.x+=-Vn+ue,Re.y-=(ye.left-Nt)*Mt.scale;const lr=Mt.imageName?ye.advance*Mt.scale:xi*Mt.scale,zn=String.fromCodePoint(Mt.glyph);fW(zn)?Re.x+=(1-Nt)*Mt.scale:pW(zn)?Re.x+=lr-ye.height*Mt.scale+(-Nt-1)*Mt.scale:Re.x+=Mt.imageName||ye.width+2*Nt===be.w&&ye.height+2*Nt===be.h?(lr-Ue)/2:(lr-(ye.height+2*Nt)*Mt.scale)/2,gn=new W(Re.x,Re.y-He),bn=new W(Re.x+Ue,Re.y),sn=new W(Re.x+Ue,Re.y-He)}else{const Vn=(ye.left-Nt)*Mt.scale-ue+Pe[0],rr=(-ye.top-Nt)*Mt.scale+Pe[1],Or=Vn+He,Dr=rr+Ue;Re=new W(Vn,rr),gn=new W(Or,rr),bn=new W(Vn,Dr),sn=new W(Or,Dr)}if(tt){let Vn;Vn=X?new W(0,0):fn?new W(dt[0],dt[1]):new W(q[0],q[1]),Re._rotateAround(tt,Vn),gn._rotateAround(tt,Vn),bn._rotateAround(tt,Vn),sn._rotateAround(tt,Vn)}const Gn=new W(0,0),kr=new W(0,0);ut.push({tl:Re,tr:gn,bl:bn,br:sn,texPrimary:Lt,texSecondary:void 0,writingMode:U.writingMode,glyphOffset:We,sectionIndex:Mt.sectionIndex,isSDF:jt,pixelOffsetTL:Gn,pixelOffsetBR:kr,minFontScaleX:0,minFontScaleY:0})}}return ut}(0,o,g,u,d,p,c,n.allowVerticalPlacement),j=n.textSizeData;let V=null;j.kind==="source"?(V=[Ko*u.layout.get("text-size").evaluate(p,{},P)],V[0]>yc&&_t(`${n.layerIds[0]}: Value for "text-size" is >= ${mp}. Reduce your "text-size".`)):j.kind==="composite"&&(V=[Ko*A.compositeTextSizes[0].evaluate(p,{},P),Ko*A.compositeTextSizes[1].evaluate(p,{},P)],(V[0]>yc||V[1]>yc)&&_t(`${n.layerIds[0]}: Value for "text-size" is >= ${mp}. Reduce your "text-size".`)),n.addSymbols(n.text,L,V,g,d,p,v,t,i,_.lineStartIndex,_.lineLength,E,C,P,k,!1);for(const F of b)S[F]=n.text.placedSymbolArray.length-1;return 4*L.length}function sO(n){for(const t in n)return n[t];return null}function J_(n,t,i,o,c,u,d,p,g,_){let v=d.top,b=d.bottom,S=d.left,E=d.right;const A=d.collisionPadding;if(A&&(S-=A[0],v-=A[1],E+=A[2],b+=A[3]),g){const C=new W(S,v),P=new W(E,v),k=new W(S,b),L=new W(E,b),j=st(g);let V=new W(0,0);_&&(V=new W(_[0],_[1])),C._rotateAround(j,V),P._rotateAround(j,V),k._rotateAround(j,V),L._rotateAround(j,V),S=Math.min(C.x,P.x,k.x,L.x),E=Math.max(C.x,P.x,k.x,L.x),v=Math.min(C.y,P.y,k.y,L.y),b=Math.max(C.y,P.y,k.y,L.y)}return n.emplaceBack(t.x,t.y,t.z,i.x,i.y,S,v,E,b,p,o,c,u),n.length-1}function Vw(n){n.collisionPadding&&(n.top-=n.collisionPadding[1],n.bottom+=n.collisionPadding[3]);const t=n.bottom-n.top;return t>0?Math.max(10,t):null}function PW(n,t,i,o){const c=n.compareText;if(t in c){const u=c[t];for(let d=u.length-1;d>=0;d--)if(o.dist(u[d])<i)return!0}else c[t]=[];return c[t].push(o),!1}function oO(n,t){const i=n.fovAboveCenter,o=n.elevation?n.elevation.getMinElevationBelowMSL()*t:0,c=(n._camera.position[2]*n.worldSize-o)/Math.cos(n._pitch),u=Math.sin(i)*c/Math.sin(Math.max(Math.PI/2-n._pitch-i,.01)),d=Math.sin(n._pitch)*u+c;return Math.min(1.01*d,c*(1/n._horizonShift))}function Bu(n,t){if(!t.isReprojectedInTileSpace)return{scale:1<<n.z,x:n.x,y:n.y,x2:n.x+1,y2:n.y+1,projection:t};const i=Math.pow(2,-n.z),o=n.x*i,c=(n.x+1)*i,u=n.y*i,d=(n.y+1)*i,p=Ls(o),g=Ls(c),_=qr(u),v=qr(d),b=t.project(p,_),S=t.project(g,_),E=t.project(g,v),A=t.project(p,v);let C=Math.min(b.x,S.x,E.x,A.x),P=Math.min(b.y,S.y,E.y,A.y),k=Math.max(b.x,S.x,E.x,A.x),L=Math.max(b.y,S.y,E.y,A.y);const j=i/16;function V(U,q,Z,X,J,rt){const it=(Z+J)/2,ut=(X+rt)/2,tt=t.project(Ls(it),qr(ut)),dt=Math.max(0,C-tt.x,P-tt.y,tt.x-k,tt.y-L);C=Math.min(C,tt.x),k=Math.max(k,tt.x),P=Math.min(P,tt.y),L=Math.max(L,tt.y),dt>j&&(V(U,tt,Z,X,it,ut),V(tt,q,it,ut,J,rt))}V(b,S,o,u,c,u),V(S,E,c,u,c,d),V(E,A,c,d,o,d),V(A,b,o,d,o,u),C-=j,P-=j,k+=j,L+=j;const F=1/Math.max(k-C,L-P);return{scale:F,x:C*F,y:P*F,x2:k*F,y2:L*F,projection:t}}function aO(n,t,i,o,c,u,d,p,g){if(g.name==="globe")return cw(n,t,new Mo(i,o,c),!1);const _=Bu({z:i,x:o,y:c},g);return new nr([(u+_.x/_.scale)*t,t*(_.y/_.scale),d],[(u+_.x2/_.scale)*t,t*(_.y2/_.scale),p])}function lO(n,{x:t,y:i},o=0){return new W(((t-o)*n.scale-n.x)*Dt,(i*n.scale-n.y)*Dt)}function cO(n,t,i=0){return ct.fromValues(((t.x-i)*n.scale-n.x)*Dt,(t.y*n.scale-n.y)*Dt,JD(t.z,t.y))}const IW=wt.identity(new Float32Array(16));class vc{constructor(t){this.spec=t,this.name=t.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(t,i){return{x:0,y:0,z:0}}unproject(t,i){return new Ze(0,0)}projectTilePoint(t,i,o){return{x:t,y:i,z:0}}locationPoint(t,i,o=!0){return t._coordinatePoint(t.locationCoordinate(i),o)}pixelsPerMeter(t,i){return $n(1,t)*i}pixelSpaceConversion(t,i,o){return 1}farthestPixelDistance(t){return oO(t,t.pixelsPerMeter)}pointCoordinate(t,i,o,c){const u=t.horizonLineFromTop(!1),d=new W(i,Math.max(u,o));return t.rayIntersectionCoordinate(t.pointRayIntersection(d,c))}pointCoordinate3D(t,i,o){const c=new W(i,o);if(t.elevation)return t.elevation.pointCoordinate(c);{const u=this.pointCoordinate(t,c.x,c.y,0);return[u.x,u.y,u.z]}}isPointAboveHorizon(t,i){if(t.elevation)return!this.pointCoordinate3D(t,i.x,i.y);const o=t.horizonLineFromTop();return i.y<o}createInversionMatrix(t,i){return IW}createTileMatrix(t,i,o){let c,u,d;const p=o.canonical,g=wt.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const _=Bu(p,this);c=1,u=_.x+o.wrap*_.scale,d=_.y,wt.scale(g,g,[c/_.scale,c/_.scale,t.pixelsPerMeter/i])}else c=i/t.zoomScale(p.z),u=(p.x+Math.pow(2,p.z)*o.wrap)*c,d=p.y*c;return wt.translate(g,g,[u,d,0]),wt.scale(g,g,[c/Dt,c/Dt,1]),g}upVector(t,i,o){return[0,0,1]}upVectorScale(t,i,o){return{metersToTile:1}}}class kW extends vc{constructor(t){super(t),this.range=[4,7],this.center=t.center||[-96,37.5];const[i,o]=this.parallels=t.parallels||[29.5,45.5],c=Math.sin(st(i));this.n=(c+Math.sin(st(o)))/2,this.c=1+c*(2*this.n-c),this.r0=Math.sqrt(this.c)/this.n}project(t,i){const{n:o,c,r0:u}=this,d=st(t-this.center[0]),p=st(i),g=Math.sqrt(c-2*o*Math.sin(p))/o;return{x:g*Math.sin(d*o),y:g*Math.cos(d*o)-u,z:0}}unproject(t,i){const{n:o,c,r0:u}=this,d=u+i;let p=Math.atan2(t,Math.abs(d))*Math.sign(d);d*o<0&&(p-=Math.PI*Math.sign(t)*Math.sign(d));const g=st(this.center[0])*o;p=me(p,-Math.PI-g,Math.PI-g);const _=Ot(St(p/o)+this.center[0],-180,180),v=Math.asin(Ot((c-(t*t+d*d)*o*o)/(2*o),-1,1)),b=Ot(St(v),-Ir,Ir);return new Ze(_,b)}}const gp=1.340264,_p=-.081106,yp=893e-6,vp=.003796,Q_=Math.sqrt(3)/2;class DW extends vc{project(t,i){i=i/180*Math.PI,t=t/180*Math.PI;const o=Math.asin(Q_*Math.sin(i)),c=o*o,u=c*c*c;return{x:.5*(t*Math.cos(o)/(Q_*(gp+3*_p*c+u*(7*yp+9*vp*c)))/Math.PI+.5),y:1-.5*(o*(gp+_p*c+u*(yp+vp*c))/Math.PI+1),z:0}}unproject(t,i){t=(2*t-.5)*Math.PI;let o=i=(2*(1-i)-1)*Math.PI,c=o*o,u=c*c*c;for(let v,b,S,E=0;E<12&&(b=o*(gp+_p*c+u*(yp+vp*c))-i,S=gp+3*_p*c+u*(7*yp+9*vp*c),v=b/S,o=Ot(o-v,-Math.PI/3,Math.PI/3),c=o*o,u=c*c*c,!(Math.abs(v)<1e-12));++E);const d=Q_*t*(gp+3*_p*c+u*(7*yp+9*vp*c))/Math.cos(o),p=Math.asin(Math.sin(o)/Q_),g=Ot(180*d/Math.PI,-180,180),_=Ot(180*p/Math.PI,-Ir,Ir);return new Ze(g,_)}}class RW extends vc{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0}project(t,i){return{x:.5+t/360,y:.5-i/360,z:0}}unproject(t,i){const o=360*(t-.5),c=Ot(360*(.5-i),-Ir,Ir);return new Ze(o,c)}}const wd=Math.PI/2;function ty(n){return Math.tan((wd+n)/2)}class OW extends vc{constructor(t){super(t),this.center=t.center||[0,30];const[i,o]=this.parallels=t.parallels||[30,30];let c=st(i),u=st(o);this.southernCenter=c+u<0,this.southernCenter&&(c=-c,u=-u);const d=Math.cos(c),p=ty(c);this.n=c===u?Math.sin(c):Math.log(d/Math.cos(u))/Math.log(ty(u)/p),this.f=d*Math.pow(ty(c),this.n)/this.n}project(t,i){i=st(i),this.southernCenter&&(i=-i),t=st(t-this.center[0]);const o=1e-6,{n:c,f:u}=this;u>0?i<-wd+o&&(i=-wd+o):i>wd-o&&(i=wd-o);const d=u/Math.pow(ty(i),c);let p=d*Math.sin(c*t),g=u-d*Math.cos(c*t);return p=.5*(p/Math.PI+.5),g=.5*(g/Math.PI+.5),{x:p,y:this.southernCenter?g:1-g,z:0}}unproject(t,i){t=(2*t-.5)*Math.PI,this.southernCenter&&(i=1-i),i=(2*(1-i)-.5)*Math.PI;const{n:o,f:c}=this,u=c-i,d=Math.sign(u),p=Math.sign(o)*Math.sqrt(t*t+u*u);let g=Math.atan2(t,Math.abs(u))*d;u*o<0&&(g-=Math.PI*Math.sign(t)*d);const _=Ot(St(g/o)+this.center[0],-180,180),v=Ot(St(2*Math.atan(Math.pow(c/p,1/o))-wd),-Ir,Ir);return new Ze(_,this.southernCenter?-v:v)}}class uO extends vc{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(t,i){return{x:ti(t),y:ui(i),z:0}}unproject(t,i){const o=Ls(t),c=qr(i);return new Ze(o,c)}}const hO=st(Ir);class LW extends vc{project(t,i){const o=(i=st(i))*i,c=o*o;return{x:.5*((t=st(t))*(.8707-.131979*o+c*(c*(.003971*o-.001529*c)-.013791))/Math.PI+.5),y:1-.5*(i*(1.007226+o*(.015085+c*(.028874*o-.044475-.005916*c)))/Math.PI+1),z:0}}unproject(t,i){t=(2*t-.5)*Math.PI;let o=i=(2*(1-i)-1)*Math.PI,c=25,u=0,d=o*o;do{d=o*o;const _=d*d;u=(o*(1.007226+d*(.015085+_*(.028874*d-.044475-.005916*_)))-i)/(1.007226+d*(.045255+_*(.259866*d-.311325-.005916*11*_))),o=Ot(o-u,-hO,hO)}while(Math.abs(u)>1e-6&&--c>0);d=o*o;const p=Ot(St(t/(.8707+d*(d*(d*d*d*(.003971-.001529*d)-.013791)-.131979))),-180,180),g=St(o);return new Ze(p,g)}}const dO=st(Ir);class zW extends vc{project(t,i){i=st(i),t=st(t);const o=Math.cos(i),c=2/Math.PI,u=Math.acos(o*Math.cos(t/2)),d=Math.sin(u)/u,p=.5*(t*c+2*o*Math.sin(t/2)/d)||0,g=.5*(i+Math.sin(i)/d)||0;return{x:.5*(p/Math.PI+.5),y:1-.5*(g/Math.PI+1),z:0}}unproject(t,i){let o=t=(2*t-.5)*Math.PI,c=i=(2*(1-i)-1)*Math.PI,u=25;const d=1e-6;let p=0,g=0;do{const _=Math.cos(c),v=Math.sin(c),b=2*v*_,S=v*v,E=_*_,A=Math.cos(o/2),C=Math.sin(o/2),P=2*A*C,k=C*C,L=1-E*A*A,j=L?1/L:0,V=L?Math.acos(_*A)*Math.sqrt(1/L):0,F=.5*(2*V*_*C+2*o/Math.PI)-t,U=.5*(V*v+c)-i,q=.5*j*(E*k+V*_*A*S)+1/Math.PI,Z=j*(P*b/4-V*v*C),X=.125*j*(b*C-V*v*E*P),J=.5*j*(S*A+V*k*_)+.5,rt=Z*X-J*q;p=(U*Z-F*J)/rt,g=(F*X-U*q)/rt,o=Ot(o-p,-Math.PI,Math.PI),c=Ot(c-g,-dO,dO)}while((Math.abs(p)>d||Math.abs(g)>d)&&--u>0);return new Ze(St(o),St(c))}}class fO extends vc{constructor(t){super(t),this.center=t.center||[0,0],this.parallels=t.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(st(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(t,i){const{scale:o,cosPhi:c}=this;return{x:st(t)*c*o+.5,y:-Math.sin(st(i))/c*o+.5,z:0}}unproject(t,i){const{scale:o,cosPhi:c}=this,u=-(i-.5)/o,d=Ot(St((t-.5)/o)/c,-180,180),p=Math.asin(Ot(u*c,-1,1)),g=Ot(St(p),-Ir,Ir);return new Ze(d,g)}}class NW extends uO{constructor(t){super(t),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(t,i,o){const c=op(t,i,o),u=hc(no(o));return ct.transformMat4(c,c,u),{x:c[0],y:c[1],z:c[2]}}locationPoint(t,i){const o=ws(i.lat,i.lng),c=ct.normalize([],o),u=t.elevation?t.elevation.getAtPointOrZero(t.locationCoordinate(i),t._centerAltitude):t._centerAltitude,d=$n(1,0)*Dt*u;ct.scaleAndAdd(o,o,c,d);const p=wt.identity(new Float64Array(16));return wt.multiply(p,t.pixelMatrix,t.globeMatrix),ct.transformMat4(o,o,p),new W(o[0],o[1])}pixelsPerMeter(t,i){return $n(1,0)*i}pixelSpaceConversion(t,i,o){const c=$n(1,t)*i,u=qe($n(1,45)*i,c,o);return this.pixelsPerMeter(t,i)/u}createTileMatrix(t,i,o){const c=hw(no(o.canonical));return wt.multiply(new Float64Array(16),t.globeMatrix,c)}createInversionMatrix(t,i){const{center:o}=t,c=hc(no(i));return wt.rotateY(c,c,st(o.lng)),wt.rotateX(c,c,st(o.lat)),wt.scale(c,c,[t._pixelsPerMercatorPixel,t._pixelsPerMercatorPixel,1]),Float32Array.from(c)}pointCoordinate(t,i,o,c){return BD(t,i,o,!0)||new vn(0,0)}pointCoordinate3D(t,i,o){const c=this.pointCoordinate(t,i,o,0);return[c.x,c.y,c.z]}isPointAboveHorizon(t,i){return!BD(t,i.x,i.y,!1)}farthestPixelDistance(t){const i=function(c,u){const d=c.cameraToCenterDistance,p=c._centerAltitude*u,g=c._camera,_=c._camera.forward(),v=ct.add([],ct.scale([],_,-d),[0,0,p]),b=c.worldSize/(2*Math.PI),S=[0,0,-b],E=c.width/c.height,A=Math.tan(c.fovAboveCenter),C=ct.scale([],g.up(),A),P=ct.scale([],g.right(),A*E),k=ct.normalize([],ct.add([],ct.add([],_,C),P)),L=[];let j;if(new T_(v,k).closestPointOnSphere(S,b,L)){const V=ct.add([],L,S),F=ct.sub([],V,v);j=Math.cos(c.fovAboveCenter)*ct.length(F)}else{const V=ct.sub([],v,S),F=ct.sub([],S,v);ct.normalize(F,F);const U=ct.length(V)-b;j=Math.sqrt(U*(U+2*b));const q=Math.acos(j/(b+U))-Math.acos(ct.dot(_,F));j*=Math.cos(q)}return 1.01*j}(t,this.pixelsPerMeter(t.center.lat,t.worldSize)),o=vi(t.zoom);if(o>0){const c=oO(t,$n(1,t.center.lat)*t.worldSize),u=t.worldSize/(2*Math.PI),d=Math.max(t.width,t.height)/t.worldSize*Math.PI;return qe(i,c+u*(1-Math.cos(d)),Math.pow(o,10))}return i}upVector(t,i,o){return op(i,o,t,1)}upVectorScale(t){return{metersToTile:E_(A_(no(t)))}}}function ey(n){const t=n.parallels,i=!!t&&Math.abs(t[0]+t[1])<.01;switch(n.name){case"mercator":return new uO(n);case"equirectangular":return new RW(n);case"naturalEarth":return new LW(n);case"equalEarth":return new DW(n);case"winkelTripel":return new zW(n);case"albers":return i?new fO(n):new kW(n);case"lambertConformalConic":return i?new fO(n):new OW(n);case"globe":return new NW(n)}throw new Error(`Invalid projection name: ${n.name}`)}const FW=new Tr({"symbol-placement":new te(vt.layout_symbol["symbol-placement"]),"symbol-spacing":new te(vt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new te(vt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ze(vt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new te(vt.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new te(vt.layout_symbol["symbol-z-elevate"]),"icon-allow-overlap":new te(vt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new te(vt.layout_symbol["icon-ignore-placement"]),"icon-optional":new te(vt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new te(vt.layout_symbol["icon-rotation-alignment"]),"icon-size":new ze(vt.layout_symbol["icon-size"]),"icon-text-fit":new ze(vt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ze(vt.layout_symbol["icon-text-fit-padding"]),"icon-image":new ze(vt.layout_symbol["icon-image"]),"icon-rotate":new ze(vt.layout_symbol["icon-rotate"]),"icon-padding":new te(vt.layout_symbol["icon-padding"]),"icon-keep-upright":new te(vt.layout_symbol["icon-keep-upright"]),"icon-offset":new ze(vt.layout_symbol["icon-offset"]),"icon-anchor":new ze(vt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new te(vt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new te(vt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new te(vt.layout_symbol["text-rotation-alignment"]),"text-field":new ze(vt.layout_symbol["text-field"]),"text-font":new ze(vt.layout_symbol["text-font"]),"text-size":new ze(vt.layout_symbol["text-size"]),"text-max-width":new ze(vt.layout_symbol["text-max-width"]),"text-line-height":new ze(vt.layout_symbol["text-line-height"]),"text-letter-spacing":new ze(vt.layout_symbol["text-letter-spacing"]),"text-justify":new ze(vt.layout_symbol["text-justify"]),"text-radial-offset":new ze(vt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new te(vt.layout_symbol["text-variable-anchor"]),"text-anchor":new ze(vt.layout_symbol["text-anchor"]),"text-max-angle":new te(vt.layout_symbol["text-max-angle"]),"text-writing-mode":new te(vt.layout_symbol["text-writing-mode"]),"text-rotate":new ze(vt.layout_symbol["text-rotate"]),"text-padding":new te(vt.layout_symbol["text-padding"]),"text-keep-upright":new te(vt.layout_symbol["text-keep-upright"]),"text-transform":new ze(vt.layout_symbol["text-transform"]),"text-offset":new ze(vt.layout_symbol["text-offset"]),"text-allow-overlap":new te(vt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new te(vt.layout_symbol["text-ignore-placement"]),"text-optional":new te(vt.layout_symbol["text-optional"]),visibility:new te(vt.layout_symbol.visibility)});var Uw={paint:new Tr({"icon-opacity":new ze(vt.paint_symbol["icon-opacity"]),"icon-emissive-strength":new ze(vt.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new ze(vt.paint_symbol["text-emissive-strength"]),"icon-color":new ze(vt.paint_symbol["icon-color"]),"icon-halo-color":new ze(vt.paint_symbol["icon-halo-color"]),"icon-halo-width":new ze(vt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ze(vt.paint_symbol["icon-halo-blur"]),"icon-translate":new te(vt.paint_symbol["icon-translate"]),"icon-translate-anchor":new te(vt.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new ze(vt.paint_symbol["icon-image-cross-fade"]),"text-opacity":new ze(vt.paint_symbol["text-opacity"]),"text-color":new ze(vt.paint_symbol["text-color"],{runtimeType:qi,getOverride:n=>n.textColor,hasOverride:n=>!!n.textColor}),"text-halo-color":new ze(vt.paint_symbol["text-halo-color"]),"text-halo-width":new ze(vt.paint_symbol["text-halo-width"]),"text-halo-blur":new ze(vt.paint_symbol["text-halo-blur"]),"text-translate":new te(vt.paint_symbol["text-translate"]),"text-translate-anchor":new te(vt.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new te(vt.paint_symbol["icon-color-saturation"])}),layout:FW};class pO{constructor(t){this.type=t.property.overrides?t.property.overrides.runtimeType:ys,this.defaultValue=t}evaluate(t){if(t.formattedSection){const i=this.defaultValue.property.overrides;if(i&&i.hasOverride(t.formattedSection))return i.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Se(pO,"FormatSectionOverride",{omit:["defaultValue"]});class ny extends Qs{constructor(t,i){super(t,Uw,i)}recalculate(t,i){super.recalculate(t,i),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const o=this.layout.get("text-writing-mode");if(o){const c=[];for(const u of o)c.indexOf(u)<0&&c.push(u);this.layout._values["text-writing-mode"]=c}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(t,i,o,c){const u=this.layout.get(t).evaluate(i,{},o,c),d=this._unevaluatedLayout._values[t];return d.isDataDriven()||t_(d.value)||!u?u:function(p,g){return g.replace(/{([^{}]+)}/g,(_,v)=>v in p?String(p[v]):"")}(i.properties,u)}createBucket(t){return new xp(t)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const t of Uw.paint.overridableProperties){if(!ny.hasPaintOverride(this.layout,t))continue;const i=this.paint.get(t),o=new pO(i),c=new ab(o,i.property.specification);let u=null;u=i.value.kind==="constant"||i.value.kind==="source"?new lb("source",c):new ec("composite",c,i.value.zoomStops,i.value._interpolationType),this.paint._values[t]=new id(i.property,u,i.parameters)}}_handleOverridablePaintPropertyUpdate(t,i,o){return!(!this.layout||i.isDataDriven()||o.isDataDriven())&&ny.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,i){const o=t.get("text-field"),c=Uw.paint.properties[i];let u=!1;const d=p=>{for(const g of p)if(c.overrides&&c.overrides.hasOverride(g))return void(u=!0)};if(o.value.kind==="constant"&&o.value.value instanceof Is)d(o.value.value.sections);else if(o.value.kind==="source"){const p=_=>{u||(_ instanceof Nf&&gi(_.value)===je?d(_.value.sections):_ instanceof Ff?d(_.sections):_.eachChild(p))},g=o.value;g._styleExpression&&p(g._styleExpression.expression)}return u}getProgramIds(){const t=this.paint.get("icon-opacity").constantOr(1)!==0,i=this.paint.get("text-opacity").constantOr(1)!==0,o=[];return t&&o.push("symbolIcon"),i&&o.push("symbolSDF"),o}getDefaultProgramParams(t,i){return{config:new Lu(this,i),overrideFog:!1}}}const BW=V_.types,jW=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function ry(n,t,i,o,c,u,d,p,g,_,v,b,S){const E=p?Math.min(yc,Math.round(p[0])):0,A=p?Math.min(yc,Math.round(p[1])):0;n.emplaceBack(t,i,Math.round(32*o),Math.round(32*c),u,d,(E<<1)+(g?1:0),A,16*_,16*v,256*b,256*S)}function iy(n,t,i){n.emplaceBack(t,i)}function sy(n,t,i,o,c,u,d){n.emplaceBack(t,i,o,c,u,d)}function oy(n,t,i,o,c){const u=5*t+2;n.float32[u+0]=i,n.float32[u+1]=o,n.float32[u+2]=c}function Sd(n,t,i,o,c){n.emplaceBack(t,i,o,c),n.emplaceBack(t,i,o,c),n.emplaceBack(t,i,o,c),n.emplaceBack(t,i,o,c)}function VW(n){for(const t of n.sections)if(r9(t.text))return!0;return!1}class $w{constructor(t){this.layoutVertexArray=new Mb,this.indexArray=new Hr,this.programConfigurations=t,this.segments=new Bn,this.dynamicLayoutVertexArray=new il,this.opacityVertexArray=new Cb,this.placedSymbolArray=new ok,this.iconTransitioningVertexArray=new sc,this.globeExtVertexArray=new Ab,this.zOffsetVertexArray=new Jf}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(t,i,o,c,u){this.isEmpty()||(o&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,rW.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,i),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,sW.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,jW,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=t.createVertexBuffer(this.iconTransitioningVertexArray,aW.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,iW.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||u)&&(this.zOffsetVertexBuffer=t.createVertexBuffer(this.zOffsetVertexArray,oW.members,!0)),this.opacityVertexBuffer.itemSize=1),(o||c)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}Se($w,"SymbolBuffers");class Gw{constructor(t,i,o){this.layoutVertexArray=new t,this.layoutAttributes=i,this.indexArray=new o,this.segments=new Bn,this.collisionVertexArray=new kb,this.collisionVertexArrayExt=new il}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,lW.members,!0),this.collisionVertexBufferExt=t.createVertexBuffer(this.collisionVertexArrayExt,cW.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Se(Gw,"CollisionBuffers");class ay{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(d=>d.fqid),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=wt.identity([]),this.placementViewportMatrix=wt.identity([]);const i=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Rw(this.zoom,i["text-size"]),this.iconSizeData=Rw(this.zoom,i["icon-size"]);const o=this.layers[0].layout,c=o.get("symbol-sort-key"),u=o.get("symbol-z-order");this.canOverlap=o.get("text-allow-overlap")||o.get("icon-allow-overlap")||o.get("text-ignore-placement")||o.get("icon-ignore-placement"),this.sortFeaturesByKey=u!=="viewport-y"&&c.constantOr(1)!==void 0,this.sortFeaturesByY=(u==="viewport-y"||u==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=o.get("text-writing-mode").map(d=>dr[d]),this.stateDependentLayerIds=this.layers.filter(d=>d.isStateDependent()).map(d=>d.id),this.sourceID=t.sourceID,this.projection=t.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=o.get("symbol-z-elevate")}createArrays(){this.text=new $w(new ac(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new $w(new ac(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new ck,this.lineVertexArray=new uk,this.symbolInstances=new lk}calculateGlyphDependencies(t,i,o,c,u){for(let d=0;d<t.length;d++){const p=t.codePointAt(d);if(p===void 0)break;if(i[p]=!0,c&&u&&p<=65535){const g=dp[t.charAt(d)];g&&(i[g.charCodeAt(0)]=!0)}}}populate(t,i,o,c){const u=this.layers[0],d=u.layout,p=this.projection.name==="globe",g=d.get("text-font"),_=d.get("text-field"),v=d.get("icon-image"),b=(_.value.kind!=="constant"||_.value.value instanceof Is&&!_.value.value.isEmpty()||_.value.value.toString().length>0)&&(g.value.kind!=="constant"||g.value.value.length>0),S=v.value.kind!=="constant"||!!v.value.value||Object.keys(v.parameters).length>0,E=d.get("symbol-sort-key");if(this.features=[],!b&&!S)return;const A=i.iconDependencies,C=i.glyphDependencies,P=i.availableImages,k=new pr(this.zoom);for(const{feature:L,id:j,index:V,sourceLayerIndex:F}of t){const U=u._featureFilter.needGeometry,q=pc(L,U);if(!u._featureFilter.filter(k,q,o))continue;if(U||(q.geometry=Aa(L,o,c)),p&&L.type!==1&&o.z<=5){const rt=q.geometry,it=.98078528056,ut=(tt,dt)=>{const gt=op(tt.x,tt.y,o,1),xt=op(dt.x,dt.y,o,1);return ct.dot(gt,xt)<it};for(let tt=0;tt<rt.length;tt++)rt[tt]=Y9(rt[tt],ut)}let Z,X;if(b){const rt=u.getValueAndResolveTokens("text-field",q,o,P),it=Is.factory(rt);VW(it)&&(this.hasRTLText=!0),(!this.hasRTLText||wb()==="unavailable"||this.hasRTLText&&To.isParsed())&&(Z=dW(it,u,q))}if(S){const rt=u.getValueAndResolveTokens("icon-image",q,o,P);X=rt instanceof wo?rt:wo.fromString(rt)}if(!Z&&!X)continue;const J=this.sortFeaturesByKey?E.evaluate(q,{},o):void 0;if(this.features.push({id:j,text:Z,icon:X,index:V,sourceLayerIndex:F,geometry:q.geometry,properties:L.properties,type:BW[L.type],sortKey:J}),X&&(A[X.namePrimary]=!0,X.nameSecondary&&(A[X.nameSecondary]=!0)),Z){const rt=g.evaluate(q,{},o).join(","),it=d.get("text-rotation-alignment")==="map"&&d.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(dr.vertical)>=0;for(const ut of Z.sections)if(ut.image)A[ut.image.namePrimary]=!0;else{const tt=pb(Z.toString()),dt=ut.fontStack||rt,gt=C[dt]=C[dt]||{};this.calculateGlyphDependencies(ut.text,gt,it,this.allowVerticalPlacement,tt)}}}d.get("symbol-placement")==="line"&&(this.features=function(L){const j={},V={},F=[];let U=0;function q(rt){F.push(L[rt]),U++}function Z(rt,it,ut){const tt=V[rt];return delete V[rt],V[it]=tt,F[tt].geometry[0].pop(),F[tt].geometry[0]=F[tt].geometry[0].concat(ut[0]),tt}function X(rt,it,ut){const tt=j[it];return delete j[it],j[rt]=tt,F[tt].geometry[0].shift(),F[tt].geometry[0]=ut[0].concat(F[tt].geometry[0]),tt}function J(rt,it,ut){const tt=ut?it[0][it[0].length-1]:it[0][0];return`${rt}:${tt.x}:${tt.y}`}for(let rt=0;rt<L.length;rt++){const it=L[rt],ut=it.geometry,tt=it.text?it.text.toString():null;if(!tt){q(rt);continue}const dt=J(tt,ut),gt=J(tt,ut,!0);if(dt in V&&gt in j&&V[dt]!==j[gt]){const xt=X(dt,gt,ut),ht=Z(dt,gt,F[xt].geometry);delete j[dt],delete V[gt],V[J(tt,F[ht].geometry,!0)]=ht,F[xt].geometry=null}else dt in V?Z(dt,gt,ut):gt in j?X(dt,gt,ut):(q(rt),j[dt]=U-1,V[gt]=U-1)}return F.filter(rt=>rt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((L,j)=>L.sortKey-j.sortKey)}update(t,i,o,c,u){const d=Object.keys(t).length!==0;if(d&&!this.stateDependentLayers.length)return;const p=d?this.stateDependentLayers:this.layers;this.text.programConfigurations.updatePaintArrays(t,i,p,o,c,u),this.icon.programConfigurations.updatePaintArrays(t,i,p,o,c,u)}updateZOffset(){const t=(u,d,p)=>{o+=d,o>u.length&&u.resize(o);for(let g=-d;g<0;g++)u.emplace(g+o,p)},i=(u,d,p)=>{c+=d,c>u.length&&u.resize(c);for(let g=-d;g<0;g++)u.emplace(g+c,p)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let o=0,c=0;for(let u=0;u<this.symbolInstances.length;u++){const d=this.symbolInstances.get(u),{numHorizontalGlyphVertices:p,numVerticalGlyphVertices:g,numIconVertices:_}=d,v=d.zOffset,b=_>0;if((p>0||g>0)&&(t(this.text.zOffsetVertexArray,p,v),t(this.text.zOffsetVertexArray,g,v)),b){const{placedIconSymbolIndex:S,verticalPlacedIconSymbolIndex:E}=d;S>=0&&i(this.icon.zOffsetVertexArray,_,v),E>=0&&i(this.icon.zOffsetVertexArray,d.numVerticalIconVertices,v)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=ey(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,i){const o=this.lineVertexArray.length;if(t.segment!==void 0)for(const{x:c,y:u}of i)this.lineVertexArray.emplaceBack(c,u);return{lineStartIndex:o,lineLength:this.lineVertexArray.length-o}}addSymbols(t,i,o,c,u,d,p,g,_,v,b,S,E,A,C,P){const k=t.indexArray,L=t.layoutVertexArray,j=t.globeExtVertexArray,V=t.segments.prepareSegment(4*i.length,L,k,this.canOverlap?d.sortKey:void 0),F=this.glyphOffsetArray.length,U=V.vertexLength,q=this.allowVerticalPlacement&&p===dr.vertical?Math.PI/2:0,Z=d.text&&d.text.sections;for(let J=0;J<i.length;J++){const{tl:rt,tr:it,bl:ut,br:tt,texPrimary:dt,texSecondary:gt,pixelOffsetTL:xt,pixelOffsetBR:ht,minFontScaleX:pt,minFontScaleY:Et,glyphOffset:At,isSDF:Mt,sectionIndex:Lt}=i[J],Nt=V.vertexLength,jt=At[1];if(ry(L,_.x,_.y,rt.x,jt+rt.y,dt.x,dt.y,o,Mt,xt.x,xt.y,pt,Et),ry(L,_.x,_.y,it.x,jt+it.y,dt.x+dt.w,dt.y,o,Mt,ht.x,xt.y,pt,Et),ry(L,_.x,_.y,ut.x,jt+ut.y,dt.x,dt.y+dt.h,o,Mt,xt.x,ht.y,pt,Et),ry(L,_.x,_.y,tt.x,jt+tt.y,dt.x+dt.w,dt.y+dt.h,o,Mt,ht.x,ht.y,pt,Et),g){const{x:It,y:Gt,z:ce}=g.anchor,[ue,ye,be]=g.up;sy(j,It,Gt,ce,ue,ye,be),sy(j,It,Gt,ce,ue,ye,be),sy(j,It,Gt,ce,ue,ye,be),sy(j,It,Gt,ce,ue,ye,be),Sd(t.dynamicLayoutVertexArray,It,Gt,ce,q)}else Sd(t.dynamicLayoutVertexArray,_.x,_.y,_.z,q);if(P){const It=gt||dt;iy(t.iconTransitioningVertexArray,It.x,It.y),iy(t.iconTransitioningVertexArray,It.x+It.w,It.y),iy(t.iconTransitioningVertexArray,It.x,It.y+It.h),iy(t.iconTransitioningVertexArray,It.x+It.w,It.y+It.h)}k.emplaceBack(Nt,Nt+1,Nt+2),k.emplaceBack(Nt+1,Nt+2,Nt+3),V.vertexLength+=4,V.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(At[0]),J!==i.length-1&&Lt===i[J+1].sectionIndex||t.programConfigurations.populatePaintArrays(L.length,d,d.index,{},E,A,C,Z&&Z[Lt])}const X=g?g.anchor:_;t.placedSymbolArray.emplaceBack(X.x,X.y,X.z,_.x,_.y,F,this.glyphOffsetArray.length-F,U,v,b,_.segment,o?o[0]:0,o?o[1]:0,c[0],c[1],p,0,!1,0,S,0)}_commitLayoutVertex(t,i,o,c,u,d,p){t.emplaceBack(i,o,c,u,d,Math.round(p.x),Math.round(p.y))}_addCollisionDebugVertices(t,i,o,c,u,d,p){const g=o.segments.prepareSegment(4,o.layoutVertexArray,o.indexArray),_=g.vertexLength,v=p.tileAnchorX,b=p.tileAnchorY;for(let E=0;E<4;E++)o.collisionVertexArray.emplaceBack(0,0,0,0);this._commitDebugCollisionVertexUpdate(o.collisionVertexArrayExt,i,t.padding,p.zOffset),this._commitLayoutVertex(o.layoutVertexArray,c,u,d,v,b,new W(t.x1,t.y1)),this._commitLayoutVertex(o.layoutVertexArray,c,u,d,v,b,new W(t.x2,t.y1)),this._commitLayoutVertex(o.layoutVertexArray,c,u,d,v,b,new W(t.x2,t.y2)),this._commitLayoutVertex(o.layoutVertexArray,c,u,d,v,b,new W(t.x1,t.y2)),g.vertexLength+=4;const S=o.indexArray;S.emplaceBack(_,_+1),S.emplaceBack(_+1,_+2),S.emplaceBack(_+2,_+3),S.emplaceBack(_+3,_),g.primitiveLength+=4}_addTextDebugCollisionBoxes(t,i,o,c,u,d){for(let p=c;p<u;p++){const g=o.get(p),_=this.getSymbolInstanceTextSize(t,d,i,p);this._addCollisionDebugVertices(g,_,this.textCollisionBox,g.projectedAnchorX,g.projectedAnchorY,g.projectedAnchorZ,d)}}_addIconDebugCollisionBoxes(t,i,o,c,u,d){for(let p=c;p<u;p++){const g=o.get(p),_=this.getSymbolInstanceIconSize(t,i,d.placedIconSymbolIndex);this._addCollisionDebugVertices(g,_,this.iconCollisionBox,g.projectedAnchorX,g.projectedAnchorY,g.projectedAnchorZ,d)}}generateCollisionDebugBuffers(t,i){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Gw(g_,FR.members,sc),this.iconCollisionBox=new Gw(g_,FR.members,sc);const o=Ca(this.iconSizeData,t),c=Ca(this.textSizeData,t);for(let u=0;u<this.symbolInstances.length;u++){const d=this.symbolInstances.get(u);this._addTextDebugCollisionBoxes(c,t,i,d.textBoxStartIndex,d.textBoxEndIndex,d),this._addTextDebugCollisionBoxes(c,t,i,d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d),this._addIconDebugCollisionBoxes(o,t,i,d.iconBoxStartIndex,d.iconBoxEndIndex,d),this._addIconDebugCollisionBoxes(o,t,i,d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex,d)}}getSymbolInstanceTextSize(t,i,o,c){const u=this.text.placedSymbolArray.get(i.rightJustifiedTextSymbolIndex>=0?i.rightJustifiedTextSymbolIndex:i.centerJustifiedTextSymbolIndex>=0?i.centerJustifiedTextSymbolIndex:i.leftJustifiedTextSymbolIndex>=0?i.leftJustifiedTextSymbolIndex:i.verticalPlacedTextSymbolIndex>=0?i.verticalPlacedTextSymbolIndex:c),d=hp(this.textSizeData,t,u)/xi;return this.tilePixelRatio*d}getSymbolInstanceIconSize(t,i,o){const c=this.icon.placedSymbolArray.get(o),u=hp(this.iconSizeData,t,c);return this.tilePixelRatio*u}_commitDebugCollisionVertexUpdate(t,i,o,c){t.emplaceBack(i,-o,-o,c),t.emplaceBack(i,o,-o,c),t.emplaceBack(i,o,o,c),t.emplaceBack(i,-o,o,c)}_updateTextDebugCollisionBoxes(t,i,o,c,u,d){for(let p=c;p<u;p++){const g=o.get(p),_=this.getSymbolInstanceTextSize(t,d,i,p);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,_,g.padding,d.zOffset)}}_updateIconDebugCollisionBoxes(t,i,o,c,u,d){for(let p=c;p<u;p++){const g=o.get(p),_=this.getSymbolInstanceIconSize(t,i,d.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,_,g.padding,d.zOffset)}}updateCollisionDebugBuffers(t,i){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const o=Ca(this.iconSizeData,t),c=Ca(this.textSizeData,t);for(let u=0;u<this.symbolInstances.length;u++){const d=this.symbolInstances.get(u);this._updateTextDebugCollisionBoxes(c,t,i,d.textBoxStartIndex,d.textBoxEndIndex,d),this._updateTextDebugCollisionBoxes(c,t,i,d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d),this._updateIconDebugCollisionBoxes(o,t,i,d.iconBoxStartIndex,d.iconBoxEndIndex,d),this._updateIconDebugCollisionBoxes(o,t,i,d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex,d)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(t,i,o,c,u,d,p,g,_){const v={};if(i<o){const{x1:b,y1:S,x2:E,y2:A,padding:C,projectedAnchorX:P,projectedAnchorY:k,projectedAnchorZ:L,tileAnchorX:j,tileAnchorY:V,featureIndex:F}=t.get(i);v.textBox={x1:b,y1:S,x2:E,y2:A,padding:C,projectedAnchorX:P,projectedAnchorY:k,projectedAnchorZ:L,tileAnchorX:j,tileAnchorY:V},v.textFeatureIndex=F}if(c<u){const{x1:b,y1:S,x2:E,y2:A,padding:C,projectedAnchorX:P,projectedAnchorY:k,projectedAnchorZ:L,tileAnchorX:j,tileAnchorY:V,featureIndex:F}=t.get(c);v.verticalTextBox={x1:b,y1:S,x2:E,y2:A,padding:C,projectedAnchorX:P,projectedAnchorY:k,projectedAnchorZ:L,tileAnchorX:j,tileAnchorY:V},v.verticalTextFeatureIndex=F}if(d<p){const{x1:b,y1:S,x2:E,y2:A,padding:C,projectedAnchorX:P,projectedAnchorY:k,projectedAnchorZ:L,tileAnchorX:j,tileAnchorY:V,featureIndex:F}=t.get(d);v.iconBox={x1:b,y1:S,x2:E,y2:A,padding:C,projectedAnchorX:P,projectedAnchorY:k,projectedAnchorZ:L,tileAnchorX:j,tileAnchorY:V},v.iconFeatureIndex=F}if(g<_){const{x1:b,y1:S,x2:E,y2:A,padding:C,projectedAnchorX:P,projectedAnchorY:k,projectedAnchorZ:L,tileAnchorX:j,tileAnchorY:V,featureIndex:F}=t.get(g);v.verticalIconBox={x1:b,y1:S,x2:E,y2:A,padding:C,projectedAnchorX:P,projectedAnchorY:k,projectedAnchorZ:L,tileAnchorX:j,tileAnchorY:V},v.verticalIconFeatureIndex=F}return v}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let i=0;i<this.symbolInstances.length;i++){const o=this.symbolInstances.get(i);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,o.textBoxStartIndex,o.textBoxEndIndex,o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o.iconBoxStartIndex,o.iconBoxEndIndex,o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(t,i){const o=t.placedSymbolArray.get(i),c=o.vertexStartIndex+4*o.numGlyphs;for(let u=o.vertexStartIndex;u<c;u+=4)t.indexArray.emplaceBack(u,u+1,u+2),t.indexArray.emplaceBack(u+1,u+2,u+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const i=Math.sin(t),o=Math.cos(t),c=[],u=[],d=[];for(let p=0;p<this.symbolInstances.length;++p){d.push(p);const g=this.symbolInstances.get(p);c.push(0|Math.round(i*g.tileAnchorX+o*g.tileAnchorY)),u.push(g.featureIndex)}return d.sort((p,g)=>c[p]-c[g]||u[g]-u[p]),d}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let t=0;t<this.symbolInstances.length;++t)this.symbolInstanceIndexesSortedZOffset.push(t)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((t,i)=>this.symbolInstances.get(i).zOffset-this.symbolInstances.get(t).zOffset)}addToSortKeyRanges(t,i){const o=this.sortKeyRanges[this.sortKeyRanges.length-1];o&&o.sortKey===i?o.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:i,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const i of this.symbolInstanceIndexes){const o=this.symbolInstances.get(i);this.featureSortOrder.push(o.featureIndex);const{rightJustifiedTextSymbolIndex:c,centerJustifiedTextSymbolIndex:u,leftJustifiedTextSymbolIndex:d,verticalPlacedTextSymbolIndex:p,placedIconSymbolIndex:g,verticalPlacedIconSymbolIndex:_}=o;c>=0&&this.addIndicesForPlacedSymbol(this.text,c),u>=0&&u!==c&&this.addIndicesForPlacedSymbol(this.text,u),d>=0&&d!==u&&d!==c&&this.addIndicesForPlacedSymbol(this.text,d),p>=0&&this.addIndicesForPlacedSymbol(this.text,p),g>=0&&this.addIndicesForPlacedSymbol(this.icon,g),_>=0&&this.addIndicesForPlacedSymbol(this.icon,_)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Se(ay,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),ay.MAX_GLYPHS=65535,ay.addDynamicAttributes=Sd;var xp=ay;const UW=Rn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:$W}=UW,GW=Rn([{name:"a_packed",components:4,type:"Float32"}]),{members:WW}=GW,HW=V_.types,qW=Math.cos(Math.PI/180*37.5);class ly{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(i=>i.fqid),this.index=t.index,this.projection=t.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(i=>{this.gradients[i.id]={}}),this.layoutVertexArray=new Eb,this.layoutVertexArray2=new il,this.indexArray=new Hr,this.programConfigurations=new ac(t.layers,t.zoom),this.segments=new Bn,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(t,i,o,c){this.hasPattern=Cw("line",this.layers,i);const u=this.layers[0].layout.get("line-sort-key"),d=[];for(const{feature:v,id:b,index:S,sourceLayerIndex:E}of t){const A=this.layers[0]._featureFilter.needGeometry,C=pc(v,A);if(!this.layers[0]._featureFilter.filter(new pr(this.zoom),C,o))continue;const P=u?u.evaluate(C,{},o):void 0,k={id:b,properties:v.properties,type:v.type,sourceLayerIndex:E,index:S,geometry:A?C.geometry:Aa(v,o,c),patterns:{},sortKey:P};d.push(k)}u&&d.sort((v,b)=>v.sortKey-b.sortKey);const{lineAtlas:p,featureIndex:g}=i,_=this.addConstantDashes(p);for(const v of d){const{geometry:b,index:S,sourceLayerIndex:E}=v;if(_&&this.addFeatureDashes(v,p),this.hasPattern){const A=Pw("line",this.layers,v,this.zoom,i);this.patternFeatures.push(A)}else this.addFeature(v,b,S,o,p.positions,i.availableImages,i.brightness);g.insert(t[S].feature,b,S,E,this.index)}}addConstantDashes(t){let i=!1;for(const o of this.layers){const c=o.paint.get("line-dasharray").value,u=o.layout.get("line-cap").value;if(c.kind!=="constant"||u.kind!=="constant")i=!0;else{const d=u.value,p=c.value;if(!p)continue;t.addDash(p,d)}}return i}addFeatureDashes(t,i){const o=this.zoom;for(const c of this.layers){const u=c.paint.get("line-dasharray").value,d=c.layout.get("line-cap").value;if(u.kind==="constant"&&d.kind==="constant")continue;let p,g;if(u.kind==="constant"){if(p=u.value,!p)continue}else p=u.evaluate({zoom:o},t);g=d.kind==="constant"?d.value:d.evaluate({zoom:o},t),i.addDash(p,g),t.patterns[c.id]=i.getKey(p,g)}}update(t,i,o,c,u){const d=Object.keys(t).length!==0;d&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(t,i,d?this.stateDependentLayers:this.layers,o,c,u)}addFeatures(t,i,o,c,u,d){for(const p of this.patternFeatures)this.addFeature(p,p.geometry,p.index,i,o,c,d)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,WW)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,$W),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,i,o,c,u,d,p){const g=this.layers[0].layout,_=g.get("line-join").evaluate(t,{}),v=g.get("line-cap").evaluate(t,{}),b=g.get("line-miter-limit"),S=g.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const E of i)this.addLine(E,t,_,v,b,S);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,o,u,d,c,p)}addLine(t,i,o,c,u,d){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let k=0;k<t.length-1;k++)this.totalDistance+=t[k].dist(t[k+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const p=HW[i.type]==="Polygon";let g=t.length;for(;g>=2&&t[g-1].equals(t[g-2]);)g--;let _=0;for(;_<g-1&&t[_].equals(t[_+1]);)_++;if(g<(p?3:2))return;o==="bevel"&&(u=1.05);const v=this.overscaling<=16?15*Dt/(512*this.overscaling):0,b=this.segments.prepareSegment(10*g,this.layoutVertexArray,this.indexArray);let S,E,A,C,P;this.e1=this.e2=-1,p&&(S=t[g-2],P=t[_].sub(S)._unit()._perp());for(let k=_;k<g;k++){if(A=k===g-1?p?t[_+1]:void 0:t[k+1],A&&t[k].equals(A))continue;P&&(C=P),S&&(E=S),S=t[k],P=A?A.sub(S)._unit()._perp():C,C=C||P;let L=C.add(P);L.x===0&&L.y===0||L._unit();const j=C.x*P.x+C.y*P.y,V=L.x*P.x+L.y*P.y,F=V!==0?1/V:1/0,U=2*Math.sqrt(2-2*V),q=V<qW&&E&&A,Z=C.x*P.y-C.y*P.x>0;if(q&&k>_){const rt=S.dist(E);if(rt>2*v){const it=S.sub(S.sub(E)._mult(v/rt)._round());this.updateDistance(E,it),this.addCurrentVertex(it,C,0,0,b),E=it}}const X=E&&A;let J=X?o:p?"butt":c;if(X&&J==="round"&&(F<d?J="miter":F<=2&&(J="fakeround")),J==="miter"&&F>u&&(J="bevel"),J==="bevel"&&(F>2&&(J="flipbevel"),F<u&&(J="miter")),E&&this.updateDistance(E,S),J==="miter")L._mult(F),this.addCurrentVertex(S,L,0,0,b);else if(J==="flipbevel"){if(F>100)L=P.mult(-1);else{const rt=F*C.add(P).mag()/C.sub(P).mag();L._perp()._mult(rt*(Z?-1:1))}this.addCurrentVertex(S,L,0,0,b),this.addCurrentVertex(S,L.mult(-1),0,0,b)}else if(J==="bevel"||J==="fakeround"){const rt=-Math.sqrt(F*F-1),it=Z?rt:0,ut=Z?0:rt;if(E&&this.addCurrentVertex(S,C,it,ut,b),J==="fakeround"){const tt=Math.round(180*U/Math.PI/20);for(let dt=1;dt<tt;dt++){let gt=dt/tt;if(gt!==.5){const ht=gt-.5;gt+=gt*ht*(gt-1)*((1.0904+j*(j*(3.55645-1.43519*j)-3.2452))*ht*ht+(.848013+j*(.215638*j-1.06021)))}const xt=P.sub(C)._mult(gt)._add(C)._unit()._mult(Z?-1:1);this.addHalfVertex(S,xt.x,xt.y,!1,Z,0,b)}}A&&this.addCurrentVertex(S,P,-it,-ut,b)}else if(J==="butt")this.addCurrentVertex(S,L,0,0,b);else if(J==="square"){const rt=E?1:-1;E||this.addCurrentVertex(S,L,rt,rt,b),this.addCurrentVertex(S,L,0,0,b),E&&this.addCurrentVertex(S,L,rt,rt,b)}else J==="round"&&(E&&(this.addCurrentVertex(S,C,0,0,b),this.addCurrentVertex(S,C,1,1,b,!0)),A&&(this.addCurrentVertex(S,P,-1,-1,b,!0),this.addCurrentVertex(S,P,0,0,b)));if(q&&k<g-1){const rt=S.dist(A);if(rt>2*v){const it=S.add(A.sub(S)._mult(v/rt)._round());this.updateDistance(S,it),this.addCurrentVertex(it,P,0,0,b),S=it}}}}addCurrentVertex(t,i,o,c,u,d=!1){const p=i.y*c-i.x,g=-i.y-i.x*c;this.addHalfVertex(t,i.x+i.y*o,i.y-i.x*o,d,!1,o,u),this.addHalfVertex(t,p,g,d,!0,-c,u)}addHalfVertex({x:t,y:i},o,c,u,d,p,g){this.layoutVertexArray.emplaceBack((t<<1)+(u?1:0),(i<<1)+(d?1:0),Math.round(63*o)+128,Math.round(63*c)+128,1+(p===0?0:p<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const _=g.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,_),g.primitiveLength++),d?this.e2=_:this.e1=_}updateScaledDistance(){if(this.lineClips){const t=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=t*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(t,i){this.distance+=t.dist(i),this.updateScaledDistance()}}Se(ly,"LineBucket",{omit:["layers","patternFeatures"]});class _r{constructor(t,i,o,c){this.context=t,this.format=o,this.texture=t.gl.createTexture(),this.update(i,c)}update(t,i,o){const{width:c,height:u}=t,{context:d}=this,{gl:p}=d,{HTMLImageElement:g,HTMLCanvasElement:_,HTMLVideoElement:v,ImageData:b,ImageBitmap:S}=w;if(p.bindTexture(p.TEXTURE_2D,this.texture),d.pixelStoreUnpackFlipY.set(!1),d.pixelStoreUnpack.set(1),d.pixelStoreUnpackPremultiplyAlpha.set(this.format===p.RGBA&&(!i||i.premultiply!==!1)),o||this.size&&this.size[0]===c&&this.size[1]===u){const{x:E,y:A}=o||{x:0,y:0};if(t instanceof g||t instanceof _||t instanceof v||t instanceof b||S&&t instanceof S)p.texSubImage2D(p.TEXTURE_2D,0,E,A,p.RGBA,p.UNSIGNED_BYTE,t);else{let C=this.format,P=p.UNSIGNED_BYTE;this.format===p.R32F&&(C=p.RED,P=p.FLOAT),p.texSubImage2D(p.TEXTURE_2D,0,E,A,c,u,C,P,t.data)}}else if(this.size=[c,u],t instanceof g||t instanceof _||t instanceof v||t instanceof b||S&&t instanceof S){let E=this.format;this.format===p.R8&&(E=p.RED),p.texImage2D(p.TEXTURE_2D,0,this.format,E,p.UNSIGNED_BYTE,t)}else{let E=this.format,A=this.format,C=p.UNSIGNED_BYTE;this.format===p.DEPTH_COMPONENT&&(E=p.DEPTH_COMPONENT16,C=p.UNSIGNED_SHORT),this.format===p.R32F&&(C=p.FLOAT,A=p.RED),p.texImage2D(p.TEXTURE_2D,0,E,c,u,0,A,C,t.data)}this.useMipmap=!!(i&&i.useMipmap),this.useMipmap&&p.generateMipmap(p.TEXTURE_2D)}bind(t,i){const{context:o}=this,{gl:c}=o;c.bindTexture(c.TEXTURE_2D,this.texture),t!==this.minFilter&&(c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,t),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,this.useMipmap?t===c.NEAREST?c.NEAREST_MIPMAP_NEAREST:c.LINEAR_MIPMAP_NEAREST:t),this.minFilter=t),i!==this.wrapS&&(c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,i),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,i),this.wrapS=i)}bindExtraParam(t,i,o,c){const{context:u}=this,{gl:d}=u;d.bindTexture(d.TEXTURE_2D,this.texture),i!==this.magFilter&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,i),this.magFilter=i),t!==this.minFilter&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,this.useMipmap?t===d.NEAREST?d.NEAREST_MIPMAP_NEAREST:d.LINEAR_MIPMAP_NEAREST:t),this.minFilter=t),o!==this.wrapS&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,o),this.wrapS=o),c!==this.wrapT&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,c),this.wrapT=c)}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class cy{constructor(t,i){this.context=t,this.texture=i}bind(t,i){const{context:o}=this,{gl:c}=o;c.bindTexture(c.TEXTURE_2D,this.texture),t!==this.minFilter&&(c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,t),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,t),this.minFilter=t),i!==this.wrapS&&(c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,i),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,i),this.wrapS=i)}}const Po=32,Pa=33,xc=new Uint16Array(8184);for(let n=0;n<2046;n++){let t=n+2,i=0,o=0,c=0,u=0,d=0,p=0;for(1&t?c=u=d=Po:i=o=p=Po;(t>>=1)>1;){const _=i+c>>1,v=o+u>>1;1&t?(c=i,u=o,i=d,o=p):(i=c,o=u,c=d,u=p),d=_,p=v}const g=4*n;xc[g+0]=i,xc[g+1]=o,xc[g+2]=c,xc[g+3]=u}const Ia=new Uint16Array(2178),bc=new Uint8Array(1089),uy=new Uint16Array(1089);function mO(n){return n===0?-.03125:n===32?.03125:0}var Ww=Rn([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const gO={type:2,extent:Dt,loadGeometry:()=>[[new W(0,0),new W(Dt+1,0),new W(Dt+1,Dt+1),new W(0,Dt+1),new W(0,0)]]};class bp{constructor(t,i,o,c,u){this.tileID=t,this.uid=Fe(),this.uses=0,this.tileSize=i,this.tileZoom=o,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=u,c&&c.style&&(this._lastUpdatedBrightness=c.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",c&&c.transform&&(this.projection=c.transform.projection)}registerFadeDuration(t){const i=t+this.timeAdded;i<Be.now()||this.fadeEndTime&&i<this.fadeEndTime||(this.fadeEndTime=i)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=Bu(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(t,i,o){if(this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(c,u){const d={};if(!u)return d;for(const p of c){const g=p.layerIds.map(_=>u.getLayer(_)).filter(Boolean);if(g.length!==0){p.layers=g,p.stateDependentLayerIds&&(p.stateDependentLayers=p.stateDependentLayerIds.map(_=>g.filter(v=>v.id===_)[0]));for(const _ of g)d[_.fqid]=p}}return d}(t.buckets,i.style),this.hasSymbolBuckets=!1;for(const c in this.buckets){const u=this.buckets[c];if(u instanceof xp){if(this.hasSymbolBuckets=!0,!o)break;u.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const c in this.buckets){const u=this.buckets[c];if(u instanceof xp&&u.hasRTLText){this.hasRTLText=!0,To.isLoading()||To.isLoaded()||wb()!=="deferred"||JI();break}}this.queryPadding=0;for(const c in this.buckets){const u=this.buckets[c],d=i.style.getOwnLayer(c);if(!d)continue;const p=d.queryRadius(u);this.queryPadding=Math.max(this.queryPadding,p)}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage),t.lineAtlas&&(this.lineAtlas=t.lineAtlas),this._lastUpdatedBrightness=t.brightness}else this.collisionBoxArray=new Fb}unloadVectorData(){if(this.hasData()){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(t){return this.buckets[t.fqid]}upload(t){for(const o in this.buckets){const c=this.buckets[o];c.uploadPending()&&c.upload(t)}const i=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new _r(t,this.imageAtlas.image,i.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new _r(t,this.glyphAtlasImage,i.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new _r(t,this.lineAtlas.image,i.ALPHA),this.lineAtlas.uploaded=!0)}prepare(t,i,o){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture,o),!i||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const c=i.style.getBrightness();(this._lastUpdatedBrightness||c)&&(this._lastUpdatedBrightness&&c&&Math.abs(this._lastUpdatedBrightness-c)<.001||(this._lastUpdatedBrightness=c,this.updateBuckets(void 0,i)))}queryRenderedFeatures(t,i,o,c,u,d,p,g){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:c,pixelPosMatrix:p,transform:d,params:u,tileTransform:this.tileTransform},t,i,o):{}}querySourceFeatures(t,i){const o=this.latestFeatureIndex;if(!o||!o.rawTileData)return;const c=o.loadVTLayers(),u=i?i.sourceLayer:"",d=c._geojsonTileLayer||c[u];if(!d)return;const p=i_(i&&i.filter),{z:g,x:_,y:v}=this.tileID.canonical,b={z:g,x:_,y:v};for(let S=0;S<d.length;S++){const E=d.feature(S);if(p.needGeometry){const P=pc(E,!0);if(!p.filter(new pr(this.tileID.overscaledZ),P,this.tileID.canonical))continue}else if(!p.filter(new pr(this.tileID.overscaledZ),E))continue;const A=o.getId(E,u),C=new PR(E,g,_,v,A);C.tile=b,t.push(C)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}bucketsLoaded(){for(const t in this.buckets)if(this.buckets[t].uploadPending())return!1;return!0}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const i=this.expirationTime;if(t.cacheControl){const o=ke(t.cacheControl);o["max-age"]&&(this.expirationTime=Date.now()+1e3*o["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const o=Date.now();let c=!1;if(this.expirationTime>o)c=!1;else if(i)if(this.expirationTime<i)c=!0;else{const u=this.expirationTime-i;u?this.expirationTime=o+Math.max(u,3e4):c=!0}else c=!0;c?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,i){this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(t).length!==0&&i&&this.updateBuckets(t,i)}updateBuckets(t,i){if(!this.latestFeatureIndex)return;const o=this.latestFeatureIndex.loadVTLayers(),c=i.style.listImages(),u=i.style.getBrightness();for(const d in this.buckets){if(!i.style.hasLayer(d))continue;const p=this.buckets[d],g=p.layers[0].sourceLayer||"_geojsonTileLayer",_=o[g];let v={};if(t&&(v=t[g],!_||!v||Object.keys(v).length===0))continue;if(p.update(v,_,c,this.imageAtlas&&this.imageAtlas.patternPositions||{},u),p instanceof ly||p instanceof B_){const S=i.style.getOwnSourceCache(p.layers[0].source);i._terrain&&i._terrain.enabled&&S&&p.programConfigurations.needsUpload&&i._terrain._clearRenderCacheForTile(S.id,this.tileID)}const b=i&&i.style&&i.style.getOwnLayer(d);b&&(this.queryPadding=Math.max(this.queryPadding,b.queryRadius(p)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Be.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=Be.now()+t}setTexture(t,i){const o=i.context,c=o.gl;this.texture=this.texture||i.getTileTexture(t.width),this.texture&&this.texture instanceof _r?this.texture.update(t,{useMipmap:!0}):(this.texture=new _r(o,t,c.RGBA,{useMipmap:!0}),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE))}setDependencies(t,i){const o={};for(const c of i)o[c]=!0;this.dependencies[t]=o}hasDependency(t,i){for(const o of t){const c=this.dependencies[o];if(c){for(const u of i)if(c[u])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(t,i){if(!i||i.name==="mercator"||this._tileDebugBuffer)return;const o=Aa(gO,this.tileID.canonical,this.tileTransform)[0],c=new Ds,u=new Qf;for(let d=0;d<o.length;d++){const{x:p,y:g}=o[d];c.emplaceBack(p,g),u.emplaceBack(d)}u.emplaceBack(0),this._tileDebugIndexBuffer=t.createIndexBuffer(u),this._tileDebugBuffer=t.createVertexBuffer(c,cc.members),this._tileDebugSegments=Bn.simpleSegment(0,0,c.length,u.length)}_makeTileBoundsBuffers(t,i){if(this._tileBoundsBuffer||!i||i.name==="mercator")return;const o=Aa(gO,this.tileID.canonical,this.tileTransform)[0];let c,u;if(this.isRaster){const d=function(p,g){const _=Bu(p,g),v=Math.pow(2,p.z);for(let P=0;P<Pa;P++)for(let k=0;k<Pa;k++){const L=Ls((p.x+(k+mO(k))/Po)/v),j=qr((p.y+(P+mO(P))/Po)/v),V=g.project(L,j),F=P*Pa+k;Ia[2*F+0]=Math.round((V.x*_.scale-_.x)*Dt),Ia[2*F+1]=Math.round((V.y*_.scale-_.y)*Dt)}bc.fill(0),uy.fill(0);for(let P=2045;P>=0;P--){const k=4*P,L=xc[k+0],j=xc[k+1],V=xc[k+2],F=xc[k+3],U=L+V>>1,q=j+F>>1,Z=U+q-j,X=q+L-U,J=j*Pa+L,rt=F*Pa+V,it=q*Pa+U,ut=Math.hypot((Ia[2*J+0]+Ia[2*rt+0])/2-Ia[2*it+0],(Ia[2*J+1]+Ia[2*rt+1])/2-Ia[2*it+1])>=16;bc[it]=bc[it]||(ut?1:0),P<1022&&(bc[it]=bc[it]||bc[(j+X>>1)*Pa+(L+Z>>1)]||bc[(F+X>>1)*Pa+(V+Z>>1)])}const b=new Du,S=new Hr;let E=0;function A(P,k){const L=k*Pa+P;return uy[L]===0&&(b.emplaceBack(Ia[2*L+0],Ia[2*L+1],P*Dt/Po,k*Dt/Po),uy[L]=++E),uy[L]-1}function C(P,k,L,j,V,F){const U=P+L>>1,q=k+j>>1;if(Math.abs(P-V)+Math.abs(k-F)>1&&bc[q*Pa+U])C(V,F,P,k,U,q),C(L,j,V,F,U,q);else{const Z=A(P,k),X=A(L,j),J=A(V,F);S.emplaceBack(Z,X,J)}}return C(0,0,Po,Po,Po,0),C(Po,Po,0,0,0,Po),{vertices:b,indices:S}}(this.tileID.canonical,i);c=d.vertices,u=d.indices}else{c=new Du,u=new Hr;for(const{x:p,y:g}of o)c.emplaceBack(p,g,0,0);const d=F_(c.int16,void 0,4);for(let p=0;p<d.length;p+=3)u.emplaceBack(d[p],d[p+1],d[p+2])}this._tileBoundsBuffer=t.createVertexBuffer(c,Ww.members),this._tileBoundsIndexBuffer=t.createIndexBuffer(u),this._tileBoundsSegments=Bn.simpleSegment(0,0,c.length,u.length)}_makeGlobeTileDebugBuffers(t,i){const o=i.projection;if(!o||o.name!=="globe"||i.freezeTileCoverage)return;const c=this.tileID.canonical,u=hc(jD(c,i)),d=vi(i.zoom);let p;d>0&&(p=wt.invert(new Float64Array(16),i.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(t,c,i,u,p,d),this._makeGlobeTileDebugTextBuffer(t,c,i,u,p,d)}_globePoint(t,i,o,c,u,d,p){let g=op(t,i,o);if(d){const _=1<<o.z,v=ti(c.center.lng),b=ui(c.center.lat),S=(o.x+.5)/_-v;let E=0;S>.5?E=-1:S<-.5&&(E=1);let A=(t/Dt+o.x)/_+E,C=(i/Dt+o.y)/_;A=(A-v)*c._pixelsPerMercatorPixel+v,C=(C-b)*c._pixelsPerMercatorPixel+b;const P=[A*c.worldSize,C*c.worldSize,0];ct.transformMat4(P,P,d),g=dl(g,P,p)}return ct.transformMat4(g,g,u)}_makeGlobeTileDebugBorderBuffer(t,i,o,c,u,d){const p=new Ds,g=new Qf,_=new f_,v=(S,E,A,C,P)=>{const k=(A-S)/(P-1),L=(C-E)/(P-1),j=p.length;for(let V=0;V<P;V++){const F=S+V*k,U=E+V*L;p.emplaceBack(F,U);const q=this._globePoint(F,U,i,o,c,u,d);_.emplaceBack(q[0],q[1],q[2]),g.emplaceBack(j+V)}},b=Dt;v(0,0,b,0,16),v(b,0,b,b,16),v(b,b,0,b,16),v(0,b,0,0,16),this._tileDebugIndexBuffer=t.createIndexBuffer(g),this._tileDebugBuffer=t.createVertexBuffer(p,cc.members),this._globeTileDebugBorderBuffer=t.createVertexBuffer(_,RD.members),this._tileDebugSegments=Bn.simpleSegment(0,0,p.length,g.length)}_makeGlobeTileDebugTextBuffer(t,i,o,c,u,d){const p=Dt/4,g=new Ds,_=new Hr,v=new f_,b=25;_.reserve(32),g.reserve(b),v.reserve(b);const S=(E,A)=>b*E+A;for(let E=0;E<b;E++){const A=E*p;for(let C=0;C<b;C++){const P=C*p;g.emplaceBack(P,A);const k=this._globePoint(P,A,i,o,c,u,d);v.emplaceBack(k[0],k[1],k[2])}}for(let E=0;E<4;E++)for(let A=0;A<4;A++){const C=S(E,A),P=S(E,A+1),k=S(E+1,A),L=S(E+1,A+1);_.emplaceBack(C,P,k),_.emplaceBack(k,P,L)}this._tileDebugTextIndexBuffer=t.createIndexBuffer(_),this._tileDebugTextBuffer=t.createVertexBuffer(g,cc.members),this._globeTileDebugTextBuffer=t.createVertexBuffer(v,RD.members),this._tileDebugTextSegments=Bn.simpleSegment(0,0,b,32)}destroy(t=!1){for(const i in this.buckets)this.buckets[i].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!t&&this.texture&&this.texture instanceof _r&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.latestFeatureIndex=null,this.state="unloaded"}}class ZW{constructor(t,i){this.max=t,this.onRemove=i,this.reset()}reset(){for(const t in this.data)for(const i of this.data[t])i.timeout&&clearTimeout(i.timeout),this.onRemove(i.value);return this.data={},this.order=[],this}add(t,i,o){const c=t.wrapped().key;this.data[c]===void 0&&(this.data[c]=[]);const u={value:i,timeout:void 0};if(o!==void 0&&(u.timeout=setTimeout(()=>{this.remove(t,u)},o)),this.data[c].push(u),this.order.push(c),this.order.length>this.max){const d=this._getAndRemoveByKey(this.order[0]);d&&this.onRemove(d)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const i=this.data[t].shift();return i.timeout&&clearTimeout(i.timeout),this.data[t].length===0&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),i.value}getByKey(t){const i=this.data[t];return i?i[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,i){if(!this.has(t))return this;const o=t.wrapped().key,c=i===void 0?0:this.data[o].indexOf(i),u=this.data[o][c];return this.data[o].splice(c,1),u.timeout&&clearTimeout(u.timeout),this.data[o].length===0&&delete this.data[o],this.onRemove(u.value),this.order.splice(this.order.indexOf(o),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const i=this._getAndRemoveByKey(this.order[0]);i&&this.onRemove(i)}return this}filter(t){const i=[];for(const o in this.data)for(const c of this.data[o])t(c.value)||i.push(c);for(const o of i)this.remove(o.value.tileID,o)}}class wc{constructor(t,i,o,c){this.id=wc.uniqueIdxCounter,wc.uniqueIdxCounter++,this.context=t;const u=t.gl;this.buffer=u.createBuffer(),this.dynamicDraw=!!o,this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),u.bufferData(u.ELEMENT_ARRAY_BUFFER,i.arrayBuffer,this.dynamicDraw?u.DYNAMIC_DRAW:u.STATIC_DRAW),this.dynamicDraw||c||i.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){this.id=wc.uniqueIdxCounter,wc.uniqueIdxCounter++;const i=this.context.gl;this.context.unbindVAO(),this.bind(),i.bufferSubData(i.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}wc.uniqueIdxCounter=0;const XW={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class YW{constructor(t,i,o,c,u,d){this.length=i.length,this.attributes=o,this.itemSize=i.bytesPerElement,this.dynamicDraw=c,this.instanceCount=d,this.context=t;const p=t.gl;this.buffer=p.createBuffer(),t.bindVertexBuffer.set(this.buffer),p.bufferData(p.ARRAY_BUFFER,i.arrayBuffer,this.dynamicDraw?p.DYNAMIC_DRAW:p.STATIC_DRAW),this.dynamicDraw||u||i.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){const i=this.context.gl;this.bind(),i.bufferSubData(i.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,i){for(let o=0;o<this.attributes.length;o++){const c=i.attributes[this.attributes[o].name];c!==void 0&&t.enableVertexAttribArray(c)}}setVertexAttribPointers(t,i,o){for(let c=0;c<this.attributes.length;c++){const u=this.attributes[c],d=i.attributes[u.name];d!==void 0&&t.vertexAttribPointer(d,u.components,t[XW[u.type]],!1,this.itemSize,u.offset+this.itemSize*(o||0))}}setVertexAttribDivisor(t,i,o){for(let c=0;c<this.attributes.length;c++){const u=i.attributes[this.attributes[c].name];u!==void 0&&this.instanceCount&&this.instanceCount>0&&t.vertexAttribDivisor(u,o)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class ar{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class KW extends ar{getDefault(){return tn.transparent}set(t){const i=this.current;(t.r!==i.r||t.g!==i.g||t.b!==i.b||t.a!==i.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class JW extends ar{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class QW extends ar{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class tH extends ar{getDefault(){return[!0,!0,!0,!0]}set(t){const i=this.current;(t[0]!==i[0]||t[1]!==i[1]||t[2]!==i[2]||t[3]!==i[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class eH extends ar{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class nH extends ar{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class rH extends ar{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const i=this.current;(t.func!==i.func||t.ref!==i.ref||t.mask!==i.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class iH extends ar{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const i=this.current;(t[0]!==i[0]||t[1]!==i[1]||t[2]!==i[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class sH extends ar{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const i=this.gl;t?i.enable(i.STENCIL_TEST):i.disable(i.STENCIL_TEST),this.current=t,this.dirty=!1}}class oH extends ar{getDefault(){return[0,1]}set(t){const i=this.current;(t[0]!==i[0]||t[1]!==i[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class aH extends ar{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const i=this.gl;t?i.enable(i.DEPTH_TEST):i.disable(i.DEPTH_TEST),this.current=t,this.dirty=!1}}class lH extends ar{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class cH extends ar{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const i=this.gl;t?i.enable(i.BLEND):i.disable(i.BLEND),this.current=t,this.dirty=!1}}class uH extends ar{getDefault(){const t=this.gl;return[t.ONE,t.ZERO,t.ONE,t.ZERO]}set(t){const i=this.current;(t[0]!==i[0]||t[1]!==i[1]||t[2]!==i[2]||t[3]!==i[3]||this.dirty)&&(this.gl.blendFuncSeparate(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class hH extends ar{getDefault(){return tn.transparent}set(t){const i=this.current;(t.r!==i.r||t.g!==i.g||t.b!==i.b||t.a!==i.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class dH extends ar{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(t,t),this.current=t,this.dirty=!1)}}class fH extends ar{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const i=this.gl;t?i.enable(i.CULL_FACE):i.disable(i.CULL_FACE),this.current=t,this.dirty=!1}}class pH extends ar{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class mH extends ar{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}let gH=class extends ar{getDefault(){return null}set(n){(n!==this.current||this.dirty)&&(this.gl.useProgram(n),this.current=n,this.dirty=!1)}};class _H extends ar{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class yH extends ar{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const i=this.current;(t[0]!==i[0]||t[1]!==i[1]||t[2]!==i[2]||t[3]!==i[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class vH extends ar{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const i=this.gl;i.bindFramebuffer(i.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class xH extends ar{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const i=this.gl;i.bindRenderbuffer(i.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class bH extends ar{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const i=this.gl;i.bindTexture(i.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class wH extends ar{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const i=this.gl;i.bindBuffer(i.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class SH extends ar{getDefault(){return null}set(t){const i=this.gl;i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class TH extends ar{getDefault(){return null}set(t){this.gl&&(t!==this.current||this.dirty)&&(this.gl.bindVertexArray(t),this.current=t,this.dirty=!1)}}class EH extends ar{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const i=this.gl;i.pixelStorei(i.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class MH extends ar{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const i=this.gl;i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class AH extends ar{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const i=this.gl;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class Hw extends ar{constructor(t,i){super(t),this.context=t,this.parent=i}getDefault(){return null}}class CH extends Hw{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const i=this.gl;i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class _O extends Hw{attachment(){return this.gl.DEPTH_ATTACHMENT}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const i=this.gl;i.framebufferRenderbuffer(i.FRAMEBUFFER,this.attachment(),i.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class PH extends Hw{attachment(){return this.gl.DEPTH_ATTACHMENT}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const i=this.gl;i.framebufferTexture2D(i.FRAMEBUFFER,this.attachment(),i.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class IH extends _O{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class kH{constructor(t,i,o,c,u){this.context=t,this.width=i,this.height=o;const d=this.framebuffer=t.gl.createFramebuffer();c&&(this.colorAttachment=new CH(t,d)),u&&(this.depthAttachmentType=u,this.depthAttachment=u==="renderbuffer"?new _O(t,d):new PH(t,d))}destroy(){const t=this.context.gl;if(this.colorAttachment){const i=this.colorAttachment.get();i&&t.deleteTexture(i)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const i=this.depthAttachment.get();i&&t.deleteRenderbuffer(i)}else{const i=this.depthAttachment.get();i&&t.deleteTexture(i)}t.deleteFramebuffer(this.framebuffer)}}class Ge{constructor(t,i,o){this.func=t,this.mask=i,this.range=o}}Ge.ReadOnly=!1,Ge.ReadWrite=!0,Ge.disabled=new Ge(519,Ge.ReadOnly,[0,1]);const qw=7680;class an{constructor(t,i,o,c,u,d){this.test=t,this.ref=i,this.mask=o,this.fail=c,this.depthFail=u,this.pass=d}}an.disabled=new an({func:519,mask:0},0,0,qw,qw,qw);const hy=771;class Cn{constructor(t,i,o,c){this.blendFunction=t,this.blendColor=i,this.mask=o,this.blendEquation=c}}Cn.Replace=[1,0,1,0],Cn.disabled=new Cn(Cn.Replace,tn.transparent,[!1,!1,!1,!1]),Cn.unblended=new Cn(Cn.Replace,tn.transparent,[!0,!0,!0,!0]),Cn.alphaBlended=new Cn([1,hy,1,hy],tn.transparent,[!0,!0,!0,!0]),Cn.multiply=new Cn([774,0,774,0],tn.transparent,[!0,!0,!0,!0]);const Zw=1029,Xw=2305;class un{constructor(t,i,o){this.enable=t,this.mode=i,this.frontFace=o}}un.disabled=new un(!1,Zw,Xw),un.backCCW=new un(!0,Zw,Xw),un.backCW=new un(!0,Zw,2304),un.frontCW=new un(!0,1028,2304),un.frontCCW=new un(!0,1028,Xw);class DH{constructor(t,i){this.gl=t,this.clearColor=new KW(this),this.clearDepth=new JW(this),this.clearStencil=new QW(this),this.colorMask=new tH(this),this.depthMask=new eH(this),this.stencilMask=new nH(this),this.stencilFunc=new rH(this),this.stencilOp=new iH(this),this.stencilTest=new sH(this),this.depthRange=new oH(this),this.depthTest=new aH(this),this.depthFunc=new lH(this),this.blend=new cH(this),this.blendFunc=new uH(this),this.blendColor=new hH(this),this.blendEquation=new dH(this),this.cullFace=new fH(this),this.cullFaceSide=new pH(this),this.frontFace=new mH(this),this.program=new gH(this),this.activeTexture=new _H(this),this.viewport=new yH(this),this.bindFramebuffer=new vH(this),this.bindRenderbuffer=new xH(this),this.bindTexture=new bH(this),this.bindVertexBuffer=new wH(this),this.bindElementBuffer=new SH(this),this.bindVertexArrayOES=new TH(this),this.pixelStoreUnpack=new EH(this),this.pixelStoreUnpackPremultiplyAlpha=new MH(this),this.pixelStoreUnpackFlipY=new AH(this),this.options=i?{...i}:{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=t.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=t.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=t.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=t.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=t.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=t.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,i,o){return new wc(this,t,i,o)}createVertexBuffer(t,i,o,c,u){return new YW(this,t,i,o,c,u)}createRenderbuffer(t,i,o){const c=this.gl,u=c.createRenderbuffer();return this.bindRenderbuffer.set(u),c.renderbufferStorage(c.RENDERBUFFER,t,i,o),this.bindRenderbuffer.set(null),u}createFramebuffer(t,i,o,c){return new kH(this,t,i,o,c)}clear({color:t,depth:i,stencil:o,colorMask:c}){const u=this.gl;let d=0;t&&(d|=u.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set(c||[!0,!0,!0,!0])),i!==void 0&&(d|=u.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(i),this.depthMask.set(!0)),o!==void 0&&(d|=u.STENCIL_BUFFER_BIT,this.clearStencil.set(o),this.stencilMask.set(255)),u.clear(d)}setCullFace(t){t.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){Q(t.blendFunction,Cn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor),t.blendEquation?this.blendEquation.set(t.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(t.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}class Qo extends Mn{constructor(t,i,o){super(),this.id=t,this._onlySymbols=o,i.on("data",c=>{c.dataType==="source"&&c.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&c.dataType==="source"&&c.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),i.on("error",()=>{this._sourceErrored=!0}),this._source=i,this._tiles={},this._cache=new ZW(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=i.minTileCacheSize,this._maxTileCacheSize=i.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this._coveredTiles={},this._shadowCasterTiles={},this._state=new KG,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(t){this.map=t,this._minTileCacheSize=this._minTileCacheSize===void 0&&t?t._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&t?t._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const t in this._tiles){const i=this._tiles[t];if(i.state!=="errored"&&(i.state!=="loaded"||!i.bucketsLoaded()))return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(t,i){return t.isSymbolTile=this._onlySymbols,t.isExtraShadowCaster=this._shadowCasterTiles[t.tileID.key],this._source.loadTile(t,i)}_unloadTile(t){if(this._source.unloadTile)return this._source.unloadTile(t,()=>{})}_abortTile(t){if(this._source.abortTile)return this._source.abortTile(t,()=>{})}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const i in this._tiles){const o=this._tiles[i];o.upload(t),o.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return Wt(this._tiles).map(t=>t.tileID).sort(yO).map(t=>t.key)}getRenderableIds(t,i){const o=[];for(const c in this._tiles)this._isIdRenderable(+c,t,i)&&o.push(this._tiles[c]);return t?o.sort((c,u)=>{const d=c.tileID,p=u.tileID,g=new W(d.canonical.x,d.canonical.y)._rotate(this.transform.angle),_=new W(p.canonical.x,p.canonical.y)._rotate(this.transform.angle);return d.overscaledZ-p.overscaledZ||_.y-g.y||_.x-g.x}).map(c=>c.tileID.key):o.map(c=>c.tileID).sort(yO).map(c=>c.key)}hasRenderableParent(t){const i=this.findLoadedParent(t,0);return!!i&&this._isIdRenderable(i.tileID.key)}_isIdRenderable(t,i,o){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(i||!this._tiles[t].holdingForFade())&&(o||!this._shadowCasterTiles[t])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)this._tiles[t].state!=="errored"&&this._reloadTile(+t,"reloading")}}_reloadTile(t,i){const o=this._tiles[t];o&&(o.state!=="loading"&&(o.state=i),this._loadTile(o,this._tileLoaded.bind(this,o,t,i)))}_tileLoaded(t,i,o,c){if(c)if(t.state="errored",c.status!==404)this._source.fire(new xe(c,{tile:t}));else{if(!(t.tileID.key in this._loadedParentTiles))return void this._source.fire(new Bt("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id}));if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const u=this.map.painter.terrain;this.update(this.transform,u.getScaledDemTileSize(),!0),u.resetTileLookupCache(this.id)}else this.update(this.transform)}else t.timeAdded=Be.now(),o==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(i,t),this._source.type==="raster-dem"&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),this._source.fire(new Bt("data",{dataType:"source",tile:t,coord:t.tileID,sourceCacheId:this.id}))}_backfillDEM(t){const i=this.getRenderableIds();for(let c=0;c<i.length;c++){const u=i[c];if(t.neighboringTiles&&t.neighboringTiles[u]){const d=this.getTileByID(u);o(t,d),o(d,t)}}function o(c,u){if(!c.dem||c.dem.borderReady)return;c.needsHillshadePrepare=!0,c.needsDEMTextureUpload=!0;let d=u.tileID.canonical.x-c.tileID.canonical.x;const p=u.tileID.canonical.y-c.tileID.canonical.y,g=Math.pow(2,c.tileID.canonical.z),_=u.tileID.key;d===0&&p===0||Math.abs(p)>1||(Math.abs(d)>1&&(Math.abs(d+g)===1?d+=g:Math.abs(d-g)===1&&(d-=g)),u.dem&&c.dem&&(c.dem.backfillBorder(u.dem,d,p),c.neighboringTiles&&c.neighboringTiles[_]&&(c.neighboringTiles[_].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,i,o,c){for(const u in this._tiles){let d=this._tiles[u];if(c[u]||!d.hasData()||d.tileID.overscaledZ<=i||d.tileID.overscaledZ>o)continue;let p=d.tileID;for(;d&&d.tileID.overscaledZ>i+1;){const _=d.tileID.scaledTo(d.tileID.overscaledZ-1);d=this._tiles[_.key],d&&d.hasData()&&(p=_)}let g=p;for(;g.overscaledZ>i;)if(g=g.scaledTo(g.overscaledZ-1),t[g.key]){c[p.key]=p;break}}}findLoadedParent(t,i){if(t.key in this._loadedParentTiles){const o=this._loadedParentTiles[t.key];return o&&o.tileID.overscaledZ>=i?o:null}for(let o=t.overscaledZ-1;o>=i;o--){const c=t.scaledTo(o),u=this._getLoadedTile(c);if(u)return u}}_getLoadedTile(t){const i=this._tiles[t.key];return i&&i.hasData()?i:this._cache.getByKey(this._source.reparseOverscaled?t.wrapped().key:t.canonical.key)}updateCacheSize(t,i){i=i||this._source.tileSize;const o=Math.ceil(t.width/i)+1,c=Math.ceil(t.height/i)+1,u=Math.floor(o*c*5),d=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,u):u,p=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,d):d;this._cache.setMaxSize(p)}handleWrapJump(t){const i=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);if(this._prevLng=t,i){const o={};for(const c in this._tiles){const u=this._tiles[c];u.tileID=u.tileID.unwrapTo(u.tileID.wrap+i),o[u.tileID.key]=u}this._tiles=o;for(const c in this._timers)clearTimeout(this._timers[c]),delete this._timers[c];for(const c in this._tiles)this._setTileReloadTimer(+c,this._tiles[c])}}update(t,i,o,c){if(this.transform=t,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!o)return;let u;if(this.updateCacheSize(t,i),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?u=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(g=>new Pn(g.canonical.z,g.wrap,g.canonical.z,g.canonical.x,g.canonical.y)):(u=t.coveringTiles({tileSize:i||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!o,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(u=u.filter(g=>this._source.hasTile(g)))):u=[],u.length>0&&this.castsShadows&&c&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!Yw(this._source.type)){const g=t.coveringZoomLevel({tileSize:i||this._source.tileSize,roundZoom:this._source.roundZoom&&!o}),_=Math.min(g,this._source.maxzoom),v=t.extendTileCoverForShadows(u,c,_);for(const b of v)this._shadowCasterTiles[b.key]=!0,u.push(b)}const d=this._updateRetainedTiles(u);if(Yw(this._source.type)&&u.length!==0){const g={},_={},v=Object.keys(d);for(const S of v){const E=d[S],A=this._tiles[S];if(!A||A.fadeEndTime&&A.fadeEndTime<=Be.now())continue;const C=this.findLoadedParent(E,Math.max(E.overscaledZ-Qo.maxOverzooming,this._source.minzoom));C&&(this._addTile(C.tileID),g[C.tileID.key]=C.tileID),_[S]=E}const b=u[u.length-1].overscaledZ;for(const S in this._tiles){const E=this._tiles[S];if(d[S]||!E.hasData())continue;let A=E.tileID;for(;A.overscaledZ>b;){A=A.scaledTo(A.overscaledZ-1);const C=this._tiles[A.key];if(C&&C.hasData()&&_[A.key]){d[S]=E.tileID;break}}}for(const S in g)d[S]||(this._coveredTiles[S]=!0,d[S]=g[S])}for(const g in d)this._tiles[g].clearFadeHold();const p=function(g,_){const v=[];for(const b in g)b in _||v.push(b);return v}(this._tiles,d);for(const g of p){const _=this._tiles[g];_.hasSymbolBuckets&&!_.holdingForFade()?_.setHoldDuration(this.map._fadeDuration):_.hasSymbolBuckets&&!_.symbolFadeFinished()||this._removeTile(+g)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(+t)}_updateRetainedTiles(t){const i={};if(t.length===0)return i;const o={},c=t.reduce((_,v)=>Math.min(_,v.overscaledZ),1/0),u=t[0].overscaledZ,d=Math.max(u-Qo.maxOverzooming,this._source.minzoom),p=Math.max(u+Qo.maxUnderzooming,this._source.minzoom),g={};for(const _ of t){const v=this._addTile(_);i[_.key]=_,v.hasData()||c<this._source.maxzoom&&(g[_.key]=_)}this._retainLoadedChildren(g,c,p,i);for(const _ of t){let v=this._tiles[_.key];if(v.hasData())continue;if(_.canonical.z>=this._source.maxzoom){const S=_.children(this._source.maxzoom)[0],E=this.getTile(S);if(E&&E.hasData()){i[S.key]=S;continue}}else{const S=_.children(this._source.maxzoom);if(i[S[0].key]&&i[S[1].key]&&i[S[2].key]&&i[S[3].key])continue}let b=v.wasRequested();for(let S=_.overscaledZ-1;S>=d;--S){const E=_.scaledTo(S);if(o[E.key]||(o[E.key]=!0,v=this.getTile(E),!v&&b&&(v=this._addTile(E)),v&&(i[E.key]=E,b=v.wasRequested(),v.hasData())))break}}return i}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const i=[];let o,c=this._tiles[t].tileID;for(;c.overscaledZ>0;){if(c.key in this._loadedParentTiles){o=this._loadedParentTiles[c.key];break}i.push(c.key);const u=c.scaledTo(c.overscaledZ-1);if(o=this._getLoadedTile(u),o)break;c=u}for(const u of i)this._loadedParentTiles[u]=o}}_addTile(t){let i=this._tiles[t.key];if(i)return i.isExtraShadowCaster!==!0||this._shadowCasterTiles[t.key]||this._reloadTile(t.key,"reloading"),i;i=this._cache.getAndRemove(t),i&&(this._setTileReloadTimer(t.key,i),i.tileID=t,this._state.initializeTileState(i,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,i)));const o=!!i;if(!o){const c=this.map?this.map.painter:null;i=new bp(t,this._source.tileSize*t.overscaleFactor(),this.transform.tileZoom,c,this._isRaster),this._loadTile(i,this._tileLoaded.bind(this,i,t.key,i.state))}return i?(i.uses++,this._tiles[t.key]=i,o||this._source.fire(new Bt("dataloading",{tile:i,coord:i.tileID,dataType:"source"})),i):null}_setTileReloadTimer(t,i){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const o=i.getExpiryTimeout();o&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},o))}_removeTile(t){const i=this._tiles[t];i&&(i.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),i.uses>0||(i.hasData()&&i.state!=="reloading"?this._cache.add(i.tileID,i,i.getExpiryTimeout()):(i.aborted=!0,this._abortTile(i),this._unloadTile(i))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(+t);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(t,i,o){const c=[],u=this.transform;if(!u)return c;const d=u.projection.name==="globe",p=ti(u.center.lng);for(const g in this._tiles){const _=this._tiles[g];if(o&&_.clearQueryDebugViz(),_.holdingForFade())continue;let v;if(d){const b=_.tileID.canonical;if(b.z===0){const S=[Math.abs(Ot(p,...wp(b,-1))-p),Math.abs(Ot(p,...wp(b,1))-p)];v=[0,2*S.indexOf(Math.min(...S))-1]}else{const S=[Math.abs(Ot(p,...wp(b,-1))-p),Math.abs(Ot(p,...wp(b,0))-p),Math.abs(Ot(p,...wp(b,1))-p)];v=[S.indexOf(Math.min(...S))-1]}}else v=[0];for(const b of v){const S=t.containsTile(_,u,i,b);S&&c.push(S)}}return c}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(t){return this._getRenderableCoordinates(t)}_getRenderableCoordinates(t,i){const o=this.getRenderableIds(t,i).map(u=>this._tiles[u].tileID),c=this.transform.projection.name==="globe";for(const u of o)u.projMatrix=this.transform.calculateProjMatrix(u.toUnwrapped()),u.expandedProjMatrix=c?this.transform.calculateProjMatrix(u.toUnwrapped(),!1,!0):u.projMatrix;return o}sortCoordinatesByDistance(t){const i=t.slice(),o=this.transform._camera.position,c=this.transform._camera.forward(),u={};for(const d of i){const p=1/(1<<d.canonical.z);u[d.key]=((d.canonical.x+.5)*p+d.wrap-o[0])*c[0]+((d.canonical.y+.5)*p-o[1])*c[1]-o[2]*c[2]}return i.sort((d,p)=>u[d.key]-u[p.key]),i}hasTransition(){if(this._source.hasTransition())return!0;if(Yw(this._source.type))for(const t in this._tiles){const i=this._tiles[t];if(i.fadeEndTime!==void 0&&i.fadeEndTime>=Be.now())return!0}return!1}setFeatureState(t,i,o){this._state.updateState(t=t||"_geojsonTileLayer",i,o)}removeFeatureState(t,i,o){this._state.removeFeatureState(t=t||"_geojsonTileLayer",i,o)}getFeatureState(t,i){return this._state.getState(t=t||"_geojsonTileLayer",i)}setDependencies(t,i,o){const c=this._tiles[t];c&&c.setDependencies(i,o)}reloadTilesForDependencies(t,i){for(const o in this._tiles)this._tiles[o].hasDependency(t,i)&&this._reloadTile(+o,"reloading");this._cache.filter(o=>!o.hasDependency(t,i))}_preloadTiles(t,i){if(!this._sourceLoaded){const p=()=>{this._sourceLoaded&&(this._source.off("data",p),this._preloadTiles(t,i))};return void this._source.on("data",p)}const o=new Map,c=Array.isArray(t)?t:[t],u=this.map.painter.terrain,d=this.usedForTerrain&&u?u.getScaledDemTileSize():this._source.tileSize;for(const p of c){const g=p.coveringTiles({tileSize:d,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const _ of g)o.set(_.key,_);this.usedForTerrain&&p.updateElevation(!1)}kt(Array.from(o.values()),(p,g)=>{const _=new bp(p,this._source.tileSize*p.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(_,v=>{this._source.type==="raster-dem"&&_.dem&&this._backfillDEM(_),g(v,_)})},i)}}function yO(n,t){const i=Math.abs(2*n.wrap)-+(n.wrap<0),o=Math.abs(2*t.wrap)-+(t.wrap<0);return n.overscaledZ-t.overscaledZ||o-i||t.canonical.y-n.canonical.y||t.canonical.x-n.canonical.x}function Yw(n){return n==="raster"||n==="image"||n==="video"||n==="custom"}function wp(n,t){const i=1<<n.z;return[n.x/i+t,(n.x+1)/i+t]}Qo.maxOverzooming=10,Qo.maxUnderzooming=3;const RH=Rn([{name:"a_pos_3f",components:3,type:"Float32"}]),OH=Rn([{name:"a_color_3f",components:3,type:"Float32"}]),LH=Rn([{name:"a_color_4f",components:4,type:"Float32"}]),zH=Rn([{name:"a_uv_2f",components:2,type:"Float32"}]),NH=Rn([{name:"a_normal_3f",components:3,type:"Float32"}]),FH=Rn([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),BH=Rn([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]);class Kw{constructor(t=0,i=0,o=0,c=0){if(isNaN(t)||t<0||isNaN(i)||i<0||isNaN(o)||o<0||isNaN(c)||c<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=i,this.left=o,this.right=c}interpolate(t,i,o){return i.top!=null&&t.top!=null&&(this.top=qe(t.top,i.top,o)),i.bottom!=null&&t.bottom!=null&&(this.bottom=qe(t.bottom,i.bottom,o)),i.left!=null&&t.left!=null&&(this.left=qe(t.left,i.left,o)),i.right!=null&&t.right!=null&&(this.right=qe(t.right,i.right,o)),this}getCenter(t,i){const o=Ot((this.left+t-this.right)/2,0,t),c=Ot((this.top+i-this.bottom)/2,0,i);return new W(o,c)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new Kw(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function vO(n,t){const i=or(n,3);wt.fromQuat(n,t),Mr(n,3,i)}function Jw(n,t){const i=Fi.identity([]);return Fi.rotateZ(i,i,-t),Fi.rotateX(i,i,-n),i}function xO(n,t){const i=[n[0],n[1],0],o=[t[0],t[1],0];if(ct.length(i)>=1e-15){const d=ct.normalize([],i);ct.scale(o,d,ct.dot(o,d)),t[0]=o[0],t[1]=o[1]}const c=ct.cross([],t,n);if(ct.len(c)<1e-15)return null;const u=Math.atan2(-c[1],c[0]);return Jw(Math.atan2(Math.sqrt(n[0]*n[0]+n[1]*n[1]),-n[2]),u)}class bO{constructor(t,i){this.position=t,this.orientation=i}get position(){return this._position}set position(t){if(t){const i=t instanceof vn?t:new vn(t[0],t[1],t[2]);this._renderWorldCopies&&(i.x=me(i.x,0,1)),this._position=i}else this._position=null}lookAtPoint(t,i){if(this.orientation=null,!this.position)return;const o=this.position,c=this._elevation?this._elevation.getAtPointOrZero(vn.fromLngLat(t)):0,u=vn.fromLngLat(t,c),d=[u.x-o.x,u.y-o.y,u.z-o.z];i||(i=[0,0,1]),i[2]=Math.abs(i[2]),this.orientation=xO(d,i)}setPitchBearing(t,i){this.orientation=Jw(st(t),st(-i))}}class dy{constructor(t,i){this._transform=wt.identity([]),this.orientation=i,this.position=t}get mercatorPosition(){const t=this.position;return new vn(t[0],t[1],t[2])}get position(){const t=or(this._transform,3);return[t[0],t[1],t[2]]}set position(t){var i;t&&Mr(this._transform,3,[(i=t)[0],i[1],i[2],1])}get orientation(){return this._orientation}set orientation(t){this._orientation=t||Fi.identity([]),t&&vO(this._transform,this._orientation)}getPitchBearing(){const t=this.forward(),i=this.right();return{bearing:Math.atan2(-i[1],i[0]),pitch:Math.atan2(Math.sqrt(t[0]*t[0]+t[1]*t[1]),-t[2])}}setPitchBearing(t,i){this._orientation=Jw(t,i),vO(this._transform,this._orientation)}forward(){const t=or(this._transform,2);return[-t[0],-t[1],-t[2]]}up(){const t=or(this._transform,1);return[-t[0],-t[1],-t[2]]}right(){const t=or(this._transform,0);return[t[0],t[1],t[2]]}getCameraToWorld(t,i){const o=new Float64Array(16);return wt.invert(o,this.getWorldToCamera(t,i)),o}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(t,i,o){const c=this.position;ct.scale(c,c,-t);const u=new Float64Array(16);return wt.fromScaling(u,[o,o,o]),wt.translate(u,u,c),u[10]*=i,u}getWorldToCamera(t,i){const o=new Float64Array(16),c=new Float64Array(4),u=this.position;return Fi.conjugate(c,this._orientation),ct.scale(u,u,-t),wt.fromQuat(o,c),wt.translate(o,o,u),o[1]*=-1,o[5]*=-1,o[9]*=-1,o[13]*=-1,o[8]*=i,o[9]*=i,o[10]*=i,o[11]*=i,o}getCameraToClipPerspective(t,i,o,c){const u=new Float64Array(16);return wt.perspective(u,t,i,o,c),u}getCameraToClipOrthographic(t,i,o,c,u,d){const p=new Float64Array(16);return wt.ortho(p,t,i,o,c,u,d),p}getDistanceToElevation(t,i=!1){const o=t===0?0:$n(t,i?qr(this.position[1]):this.position[1]),c=this.forward();return(o-this.position[2])/c[2]}clone(){return new dy([...this.position],[...this.orientation])}}function wO(n,t){const i=Sp(n.projection,n.zoom,n.width,n.height),o=function(u,d,p,g,_){const v=new Ze(p.lng-180*Sc,p.lat),b=new Ze(p.lng+180*Sc,p.lat),S=u.project(v.lng,v.lat),E=u.project(b.lng,b.lat),A=-Math.atan2(E.y-S.y,E.x-S.x),C=vn.fromLngLat(p);C.y=Ot(C.y,-1+Sc,1-Sc);const P=C.toLngLat(),k=u.project(P.lng,P.lat),L=vn.fromLngLat(P);L.x+=Sc;const j=L.toLngLat(),V=u.project(j.lng,j.lat),F=EO(V.x-k.x,V.y-k.y,A),U=vn.fromLngLat(P);U.y+=Sc;const q=U.toLngLat(),Z=u.project(q.lng,q.lat),X=EO(Z.x-k.x,Z.y-k.y,A),J=Math.abs(F.x)/Math.abs(X.y),rt=wt.identity([]);wt.rotateZ(rt,rt,-A*(1-(_?0:g)));const it=wt.identity([]);return wt.scale(it,it,[1,1-(1-J)*g,1]),it[4]=-X.x/X.y*g,wt.rotateZ(it,it,A),wt.multiply(it,rt,it),it}(n.projection,0,n.center,i,t),c=SO(n);return wt.scale(o,o,[c,c,1]),o}function SO(n){const t=n.projection,i=Sp(n.projection,n.zoom,n.width,n.height),o=TO(t,n.center),c=TO(t,Ze.convert(t.center));return Math.pow(2,o*i+(1-i)*c)}function Sp(n,t,i,o,c=1/0){const u=n.range;if(!u)return 0;const d=Math.min(c,Math.max(i,o)),p=Math.log(d/1024)/Math.LN2;return Me(u[0]+p,u[1]+p,t)}const Sc=1/4e4;function TO(n,t){const i=Ot(t.lat,-Ir,Ir),o=new Ze(t.lng-180*Sc,i),c=new Ze(t.lng+180*Sc,i),u=n.project(o.lng,i),d=n.project(c.lng,i),p=vn.fromLngLat(o),g=vn.fromLngLat(c),_=d.x-u.x,v=d.y-u.y,b=g.x-p.x,S=g.y-p.y,E=Math.sqrt((b*b+S*S)/(_*_+v*v));return Math.log(E)/Math.LN2}function EO(n,t,i){const o=Math.cos(i),c=Math.sin(i);return{x:n*o-t*c,y:n*c+t*o}}function ju(n,t,i){return t*(Dt/(n.tileSize*Math.pow(2,i-n.tileID.overscaledZ)))}const Td={unknown:0,flipRequired:1,flipNotRequired:2},jH=Math.tan(85*Math.PI/180);function fy(n,t,i,o,c,u,d){const p=wt.create();if(i)if(u.name==="globe"){const g=function(_,v){const{x:b,y:S}=_.point,E=GD(b,S,_.worldSize/_._pixelsPerMercatorPixel,0,0);return wt.multiply(E,E,hw(no(v)))}(c,t);wt.multiply(p,p,g)}else{const g=ad.invert([],d);p[0]=g[0],p[1]=g[1],p[4]=g[2],p[5]=g[3],o||wt.rotateZ(p,p,c.angle)}else wt.multiply(p,c.labelPlaneMatrix,n);return p}function MO(n,t,i,o,c,u,d){const p=fy(n,t,i,o,c,u,d);return u.name==="globe"&&i||(p[2]=p[6]=p[10]=p[14]=0),p}function AO(n,t,i,o,c,u,d){if(i){if(u.name==="globe"){const p=fy(n,t,i,o,c,u,d);return wt.invert(p,p),wt.multiply(p,n,p),p}{const p=wt.clone(n),g=wt.identity([]);return g[0]=d[0],g[1]=d[1],g[4]=d[2],g[5]=d[3],wt.multiply(p,p,g),o||wt.rotateZ(p,p,-c.angle),p}}return c.glCoordMatrix}function ta(n,t,i,o){const c=[n,t,i,1];i?jn.transformMat4(c,c,o):OO(c,c,o);const u=c[3];return c[0]/=u,c[1]/=u,c[2]/=u,c}function CO(n,t){return Math.min(.5+n/t*.5,1.5)}function VH(n,t){const i=n[0]/n[3],o=n[1]/n[3];return i>=-t[0]&&i<=t[0]&&o>=-t[1]&&o<=t[1]}function UH(n,t,i,o,c,u,d,p,g,_){const v=i.transform,b=o?n.textSizeData:n.iconSizeData,S=Ca(b,i.transform.zoom),E=v.projection.name==="globe",A=[256/i.width*2+1,256/i.height*2+1],C=o?n.text.dynamicLayoutVertexArray:n.icon.dynamicLayoutVertexArray;C.clear();let P=null;E&&(P=o?n.text.globeExtVertexArray:n.icon.globeExtVertexArray);const k=n.lineVertexArray,L=o?n.text.placedSymbolArray:n.icon.placedSymbolArray,j=i.transform.width/i.transform.height;let V,F=!1;for(let U=0;U<L.length;U++){const q=L.get(U),{numGlyphs:Z,writingMode:X}=q;if(X!==dr.vertical||F||V===dr.horizontal||(F=!0),V=X,(q.hidden||X===dr.vertical)&&!F){Ed(Z,C);continue}F=!1;const J=new W(q.tileAnchorX,q.tileAnchorY);let{x:rt,y:it,z:ut}=v.projection.projectTilePoint(J.x,J.y,_.canonical);if(g){const[Lt,Nt,jt]=g(J);rt+=Lt,it+=Nt,ut+=jt}const tt=[rt,it,ut,1];if(jn.transformMat4(tt,tt,t),!VH(tt,A)){Ed(Z,C);continue}const dt=tt[3],gt=CO(i.transform.getCameraToCenterDistance(v.projection),dt),xt=hp(b,S,q),ht=d?xt/gt:xt*gt,pt=ta(rt,it,ut,c);if(pt[3]<=0){Ed(Z,C);continue}let Et={};const At=d?null:g,Mt=kO(q,ht,!1,p,t,c,u,n.glyphOffsetArray,k,C,P,pt,J,Et,j,At,v.projection,_,d);F=Mt.useVertical,At&&Mt.needsFlipping&&(Et={}),(Mt.notEnoughRoom||F||Mt.needsFlipping&&kO(q,ht,!0,p,t,c,u,n.glyphOffsetArray,k,C,P,pt,J,Et,j,At,v.projection,_,d).notEnoughRoom)&&Ed(Z,C)}o?(n.text.dynamicLayoutVertexBuffer.updateData(C),P&&n.text.globeExtVertexBuffer&&n.text.globeExtVertexBuffer.updateData(P)):(n.icon.dynamicLayoutVertexBuffer.updateData(C),P&&n.icon.globeExtVertexBuffer&&n.icon.globeExtVertexBuffer.updateData(P))}function PO(n,t,i,o,c,u,d,p,g,_,v,b,S,E,A,C){const{lineStartIndex:P,glyphStartIndex:k,segment:L}=p,j=k+p.numGlyphs,V=P+p.lineLength,F=t.getoffsetX(k),U=t.getoffsetX(j-1),q=py(n*F,i,o,c,u,d,L,P,V,g,_,v,b,S,!0,E,A,C);if(!q)return null;const Z=py(n*U,i,o,c,u,d,L,P,V,g,_,v,b,S,!0,E,A,C);return Z?{first:q,last:Z}:null}function IO(n,t,i,o){return n===dr.horizontal&&Math.abs(o)>Math.abs(i)?{useVertical:!0}:n===dr.vertical?o>0?{needsFlipping:!0}:null:t!==Td.unknown&&function(c,u){return c===0||Math.abs(u/c)>jH}(i,o)?t===Td.flipRequired?{needsFlipping:!0}:null:i<0?{needsFlipping:!0}:null}function kO(n,t,i,o,c,u,d,p,g,_,v,b,S,E,A,C,P,k,L){const j=t/24,V=n.lineOffsetX*j,F=n.lineOffsetY*j,{lineStartIndex:U,glyphStartIndex:q,numGlyphs:Z,segment:X,writingMode:J,flipState:rt}=n,it=U+n.lineLength,ut=tt=>{if(v){const[ht,pt,Et]=tt.up,At=_.length;oy(v,At+0,ht,pt,Et),oy(v,At+1,ht,pt,Et),oy(v,At+2,ht,pt,Et),oy(v,At+3,ht,pt,Et)}const[dt,gt,xt]=tt.point;Sd(_,dt,gt,xt,tt.angle)};if(Z>1){const tt=PO(j,p,V,F,i,b,S,n,g,u,E,C,!1,P,k,L);if(!tt)return{notEnoughRoom:!0};if(o&&!i){let[dt,gt,xt]=tt.first.point,[ht,pt,Et]=tt.last.point;[dt,gt]=ta(dt,gt,xt,d),[ht,pt]=ta(ht,pt,Et,d);const At=IO(J,rt,(ht-dt)*A,pt-gt);if(n.flipState=At&&At.needsFlipping?Td.flipRequired:Td.flipNotRequired,At)return At}ut(tt.first);for(let dt=q+1;dt<q+Z-1;dt++){const gt=py(j*p.getoffsetX(dt),V,F,i,b,S,X,U,it,g,u,E,C,!1,!1,P,k,L);if(!gt)return _.length-=4*(dt-q),{notEnoughRoom:!0};ut(gt)}ut(tt.last)}else{if(o&&!i){const dt=ta(S.x,S.y,0,c),gt=U+X+1,xt=new W(g.getx(gt),g.gety(gt)),ht=ta(xt.x,xt.y,0,c),pt=ht[3]>0?ht:RO(S,xt,dt,1,c,void 0,P,k.canonical),Et=IO(J,rt,(pt[0]-dt[0])*A,pt[1]-dt[1]);if(n.flipState=Et&&Et.needsFlipping?Td.flipRequired:Td.flipNotRequired,Et)return Et}const tt=py(j*p.getoffsetX(q),V,F,i,b,S,X,U,it,g,u,E,C,!1,!1,P,k,L);if(!tt)return{notEnoughRoom:!0};ut(tt)}return{}}function DO(n,t,i,o,c){const{x:u,y:d,z:p}=o.projectTilePoint(n.x,n.y,t);if(!c)return ta(u,d,p,i);const[g,_,v]=c(n);return ta(u+g,d+_,p+v,i)}function RO(n,t,i,o,c,u,d,p){const g=DO(n.sub(t)._unit()._add(n),p,c,d,u);return ct.sub(g,i,g),ct.normalize(g,g),ct.scaleAndAdd(g,i,g,o)}function py(n,t,i,o,c,u,d,p,g,_,v,b,S,E,A,C,P,k){const L=o?n-t:n+t;let j=L>0?1:-1,V=0;o&&(j*=-1,V=Math.PI),j<0&&(V+=Math.PI);let F=p+d+(j>0?0:1)|0,U=c,q=c,Z=0,X=0;const J=Math.abs(L),rt=[],it=[];let ut=u,tt=ut;const dt=()=>RO(tt,ut,q,J-Z+1,v,S,C,P.canonical);for(;Z+X<=J;){if(F+=j,F<p||F>=g)return null;if(q=U,tt=ut,rt.push(q),E&&it.push(tt),ut=new W(_.getx(F),_.gety(F)),U=b[F],!U){const Nt=DO(ut,P.canonical,v,C,S);U=Nt[3]>0?b[F]=Nt:dt()}Z+=X,X=ct.distance(q,U)}A&&S&&(b[F]&&(U=dt(),X=ct.distance(q,U)),b[F]=U);const gt=(J-Z)/X,xt=ut.sub(tt)._mult(gt)._add(tt),ht=ct.sub([],U,q),pt=ct.scaleAndAdd([],q,ht,gt);let Et=[0,0,1],At=ht[0],Mt=ht[1];if(k&&(Et=C.upVector(P.canonical,xt.x,xt.y),Et[0]!==0||Et[1]!==0||Et[2]!==1)){const Nt=[Et[2],0,-Et[0]],jt=ct.cross([],Et,Nt);ct.normalize(Nt,Nt),ct.normalize(jt,jt),At=ct.dot(ht,Nt),Mt=ct.dot(ht,jt)}if(i){const Nt=ct.cross([],Et,ht);ct.normalize(Nt,Nt),ct.scaleAndAdd(pt,pt,Nt,i*j)}const Lt=V+Math.atan2(Mt,At);return rt.push(pt),E&&it.push(xt),{point:pt,angle:Lt,path:rt,tilePath:it,up:Et}}function Ed(n,t){const i=t.length,o=i+4*n;t.resize(o),t.float32.fill(-1/0,4*i,4*o)}function OO(n,t,i){const o=t[0],c=t[1];return n[0]=i[0]*o+i[4]*c+i[12],n[1]=i[1]*o+i[5]*c+i[13],n[3]=i[3]*o+i[7]*c+i[15],n}const LO=(n,t,i)=>(1-i)*n+i*t,zO=n=>n*n*n*n*n;class Qw{constructor(t,i,o,c,u,d,p){this.tileSize=512,this._renderWorldCopies=u===void 0||u,this._minZoom=t||0,this._maxZoom=i||22,this._minPitch=o??0,this._maxPitch=c??60,this.setProjection(d),this.setMaxBounds(p),this.width=0,this.height=0,this._center=new Ze(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Kw,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new dy,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const t=new Qw(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return t._elevation=this._elevation,t._centerAltitude=this._centerAltitude,t._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,t.tileSize=this.tileSize,t.mercatorFromTransition=this.mercatorFromTransition,t.width=this.width,t.height=this.height,t.cameraElevationReference=this.cameraElevationReference,t._center=this._center,t._setZoom(this.zoom),t._seaLevelZoom=this._seaLevelZoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._nearZ=this._nearZ,t._farZ=this._farZ,t._averageElevation=this._averageElevation,t._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,t._unmodified=this._unmodified,t._edgeInsets=this._edgeInsets.clone(),t._camera=this._camera.clone(),t._calcMatrices(),t.freezeTileCoverage=this.freezeTileCoverage,t.frustumCorners=this.frustumCorners,t}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(t){this._elevation!==t&&(this._elevation=t,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(t,i=!1){const o=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||o)&&this._updateCameraOnTerrain(),(t||o)&&this._constrainCamera(i),this._calcMatrices()}getProjection(){return Ae(this.projection,["name","center","parallels"])}setProjection(t){this.projectionOptions=t||{name:"mercator"};const i=this.projection?this.getProjection():void 0;this.projection=ey(this.projectionOptions);const o=!Q(i,this.getProjection());return o&&this._calcMatrices(),this.mercatorFromTransition=!1,o}setOrthographicProjectionAtLowPitch(t){return this._orthographicProjectionAtLowPitch!==t&&(this._orthographicProjectionAtLowPitch=t,this._calcMatrices(),!0)}setMercatorFromTransition(){const t=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=ey({name:"mercator"});const i=t!==this.projection.name;return i&&this._calcMatrices(),i}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const t=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(t))}get cameraWorldSize(){const t=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(t))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return $n(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new W(this.width,this.height)}get bearing(){return me(this.rotation,-180,180)}set bearing(t){this.rotation=t}get rotation(){return-this.angle/Math.PI*180}set rotation(t){const i=-t*Math.PI/180;this.angle!==i&&(this._unmodified=!1,this.angle=i,this._calcMatrices(),this.rotationMatrix=ad.create(),ad.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(t){const i=Ot(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==i&&(this._unmodified=!1,this._pitch=i,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const t=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/t)}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=st(t),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(t){this._averageElevation=t,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(t){const i=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==i&&(this._unmodified=!1,this._setZoom(i),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(t){this._zoom=t,this.scale=this.zoomScale(t),this.tileZoom=Math.floor(t),this.zoomFraction=t-this.tileZoom}_updateCameraOnTerrain(){const t=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,i=this.elevation&&t===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||t===Number.NEGATIVE_INFINITY&&(!i||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const o=this._elevation;i||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&o.exaggeration()&&this._centerAltitudeValidForExaggeration!==o.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*o.exaggeration(),this._centerAltitudeValidForExaggeration=o.exaggeration()):(this._centerAltitude=t||0,this._centerAltitudeValidForExaggeration=o.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const t=this._elevation,i=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],o=this.horizonLineFromTop();let c=0,u=0;for(let d=0;d<i.length;d++){const p=new W(i[d][0]*this.width,o+i[d][1]*(this.height-o)),g=t.pointCoordinate(p);if(!g)continue;const _=1/Math.hypot(g[0]-this._camera.position[0],g[1]-this._camera.position[1]);c+=g[3]*_,u+=_}return u===0?NaN:c/u}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const t=this._seaLevelZoom,i=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),o=this.pixelsPerMeter/this.worldSize*i,c=this._mercatorZfromZoom(t),u=this._mercatorZfromZoom(this._maxZoom),d=Math.max(c-o,u);this._setZoom(this._zoomFromMercatorZ(d))}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}computeZoomRelativeTo(t){const i=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,t.toAltitude()));let o;o=t.z<this._camera.position[2]?[i.x,i.y,i.z]:[t.x,t.y,t.z];const c=ct.length(ct.sub([],this._camera.position,o));return Ot(this._zoomFromMercatorZ(c),this._minZoom,this._maxZoom)}setFreeCameraOptions(t){if(!this.height||!t.position&&!t.orientation)return;this._updateCameraState();let i=!1;if(t.orientation&&!Fi.exactEquals(t.orientation,this._camera.orientation)&&(i=this._setCameraOrientation(t.orientation)),t.position){const o=[t.position.x,t.position.y,t.position.z];ct.exactEquals(o,this._camera.position)||(this._setCameraPosition(o),i=!0)}i&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const t=this._camera.position,i=new bO;return i.position=new vn(t[0],t[1],t[2]),i.orientation=this._camera.orientation,i._elevation=this.elevation,i._renderWorldCopies=this.renderWorldCopies,i}_setCameraOrientation(t){if(!Fi.length(t))return!1;Fi.normalize(t,t);const i=ct.transformQuat([],[0,0,-1],t),o=ct.transformQuat([],[0,-1,0],t);if(o[2]<0)return!1;const c=xO(i,o);return!!c&&(this._camera.orientation=c,!0)}_setCameraPosition(t){const i=this.zoomScale(this.minZoom)*this.tileSize,o=this.zoomScale(this.maxZoom)*this.tileSize,c=this.cameraToCenterDistance;t[2]=Ot(t[2],c/o,c/i),this._camera.position=t}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,i,o){this._unmodified=!1,this._edgeInsets.interpolate(t,i,o),this._constrain(),this._calcMatrices()}coveringZoomLevel(t){const i=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,i)}getVisibleUnwrappedCoordinates(t){const i=[new sw(0,t)];if(this.renderWorldCopies){const o=this.pointCoordinate(new W(0,0)),c=this.pointCoordinate(new W(this.width,0)),u=this.pointCoordinate(new W(this.width,this.height)),d=this.pointCoordinate(new W(0,this.height)),p=Math.floor(Math.min(o.x,c.x,u.x,d.x)),g=Math.floor(Math.max(o.x,c.x,u.x,d.x)),_=1;for(let v=p-_;v<=g+_;v++)v!==0&&i.push(new sw(v,t))}return i}isLODDisabled(t){return(!t||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCoverForShadows(t,i,o){let c=[];if(i[0]===0&&i[1]===0)return c;for(const d of t){const p=d.canonical,g=d.overscaledZ,_=d.wrap,v=1<<p.z,b=p.x+1<v,S=p.x>0,E=p.y+1<v,A=p.y>0,C=d.wrap-(S?0:1),P=d.wrap+(b?0:1),k=S?p.x-1:v-1,L=b?p.x+1:0;i[0]<0?(c.push(new Pn(g,P,p.z,L,p.y)),i[1]<0&&E&&(c.push(new Pn(g,_,p.z,p.x,p.y+1)),c.push(new Pn(g,P,p.z,L,p.y+1))),i[1]>0&&A&&(c.push(new Pn(g,_,p.z,p.x,p.y-1)),c.push(new Pn(g,P,p.z,L,p.y-1)))):i[0]>0?(c.push(new Pn(g,C,p.z,k,p.y)),i[1]<0&&E&&(c.push(new Pn(g,_,p.z,p.x,p.y+1)),c.push(new Pn(g,C,p.z,k,p.y+1))),i[1]>0&&A&&(c.push(new Pn(g,_,p.z,p.x,p.y-1)),c.push(new Pn(g,C,p.z,k,p.y-1)))):i[1]<0&&E?c.push(new Pn(g,_,p.z,p.x,p.y+1)):A&&c.push(new Pn(g,_,p.z,p.x,p.y-1))}if(c.length>1){c.sort((g,_)=>g.overscaledZ-_.overscaledZ||g.wrap-_.wrap||g.canonical.z-_.canonical.z||g.canonical.x-_.canonical.x||g.canonical.y-_.canonical.y);let d=0,p=0;for(;p<c.length;)c[p].equals(c[d])?++p:c[++d]=c[p++];c.length=d+1}const u=[];for(const d of c)c.some(p=>d.isChildOf(p))||u.push(d);return c=u.filter(d=>!t.some(p=>!!(d.overscaledZ<o&&p.isChildOf(d))||d.equals(p)||d.isChildOf(p))),c}coveringTiles(t){let i=this.coveringZoomLevel(t);const o=i,c=this.elevation&&this.elevation.exaggeration(),u=c&&!t.isTerrainDEM,d=this.projection.name==="mercator";if(t.minzoom!==void 0&&i<t.minzoom)return[];t.maxzoom!==void 0&&i>t.maxzoom&&(i=t.maxzoom);const p=this.locationCoordinate(this.center),g=this.center.lat,_=1<<i,v=[_*p.x,_*p.y,0],b=this.projection.name==="globe",S=!b,E=hl.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,i,S),A=b?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),C=_*$n(1,this.center.lat),P=this._camera.position[2]/$n(1,this.center.lat),k=[_*A.x,_*A.y,P*(S?1:C)],L=b||c,j=this.cameraToCenterDistance/t.tileSize*(t.roundZoom?1:.502),V=this.isLODDisabled(!0)?i:0;let F;if(this._elevation&&t.isTerrainDEM)F=1e4*this._elevation.exaggeration();else if(this._elevation){const ht=this._elevation.getMinMaxForVisibleTiles();F=ht?ht.max:this._centerAltitude}else F=this._centerAltitude;const U=t.isTerrainDEM?-F:this._elevation?this._elevation.getMinElevationBelowMSL():0,q=this.projection.isReprojectedInTileSpace?SO(this):1,Z=ht=>{const Et=new vn(ht.x+25e-6,ht.y,ht.z),At=new vn(ht.x,ht.y+25e-6,ht.z),Mt=ht.toLngLat(),Lt=Et.toLngLat(),Nt=At.toLngLat(),jt=this.locationCoordinate(Mt),It=this.locationCoordinate(Lt),Gt=this.locationCoordinate(Nt),ce=Math.hypot(It.x-jt.x,It.y-jt.y),ue=Math.hypot(Gt.x-jt.x,Gt.y-jt.y);return Math.sqrt(ce*ue)*q/25e-6},X=ht=>{const pt=F,Et=U;return{aabb:aO(this,_,0,0,0,ht,Et,pt,this.projection),zoom:0,x:0,y:0,minZ:Et,maxZ:pt,wrap:ht,fullyVisible:!1}},J=[];let rt=[];const it=i,ut=t.reparseOverscaled?o:i,tt=ht=>ht*ht,dt=tt((P-this._centerAltitude)*C),gt=ht=>{if(!this._elevation||!ht.tileID||!d)return;const pt=this._elevation.getMinMaxForTile(ht.tileID),Et=ht.aabb;pt?(Et.min[2]=pt.min,Et.max[2]=pt.max,Et.center[2]=(Et.min[2]+Et.max[2])/2):(ht.shouldSplit=xt(ht),ht.shouldSplit||(Et.min[2]=Et.max[2]=Et.center[2]=this._centerAltitude))},xt=ht=>{if(ht.zoom<V)return!0;if(ht.zoom===it)return!1;if(ht.shouldSplit!=null)return ht.shouldSplit;const pt=ht.aabb.distanceX(k),Et=ht.aabb.distanceY(k);let At=dt,Mt=1;if(b){At=tt(ht.aabb.distanceZ(k));const jt=Math.pow(2,ht.zoom),It=qr((ht.y+1)/jt),Gt=qr(ht.y/jt),ce=Math.min(Math.max(g,It),Gt),ue=P_(ce)/P_(g);if(Mt=ce===g?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,ue/this._mercatorScaleRatio),this.zoom<=sp&&ht.zoom===it-1&&ue>=.9)return!0}else if(u&&(At=tt(ht.aabb.distanceZ(k)*C)),this.projection.isReprojectedInTileSpace&&o<=5){const jt=Math.pow(2,ht.zoom),It=Z(new vn((ht.x+.5)/jt,(ht.y+.5)/jt));Mt=It>.85?1:It}const Lt=pt*pt+Et*Et+At,Nt=tt((1<<it-ht.zoom)*j*Mt*((jt,It)=>{if(It*tt(.707)<jt)return 1;const Gt=Math.sqrt(It/jt);return Gt/(1.4144271570014144+(Math.pow(1.1,Gt-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(At,dt),Lt));return Lt<Nt};if(this.renderWorldCopies)for(let ht=1;ht<=3;ht++)J.push(X(-ht)),J.push(X(ht));for(J.push(X(0));J.length>0;){const ht=J.pop(),pt=ht.x,Et=ht.y;let At=ht.fullyVisible;const Mt=()=>this.projection.name==="globe"&&(ht.y===0||ht.y===(1<<ht.zoom)-1);if(!At){let Lt=L?ht.aabb.intersects(E):ht.aabb.intersectsFlat(E);if(Lt===0&&Mt()){const Nt=new Mo(ht.zoom,pt,Et);Lt=cw(this,_,Nt,!0).intersects(E)}if(Lt===0)continue;At=Lt===2}if(ht.zoom!==it&&xt(ht))for(let Lt=0;Lt<4;Lt++){const Nt=(pt<<1)+Lt%2,jt=(Et<<1)+(Lt>>1),It={aabb:d?ht.aabb.quadrant(Lt):aO(this,_,ht.zoom+1,Nt,jt,ht.wrap,ht.minZ,ht.maxZ,this.projection),zoom:ht.zoom+1,x:Nt,y:jt,wrap:ht.wrap,fullyVisible:At,tileID:void 0,shouldSplit:void 0,minZ:ht.minZ,maxZ:ht.maxZ};u&&!b&&(It.tileID=new Pn(ht.zoom+1===it?ut:ht.zoom+1,ht.wrap,ht.zoom+1,Nt,jt),gt(It)),J.push(It)}else{const Lt=ht.zoom===it?ut:ht.zoom;if(t.minzoom&&t.minzoom>Lt)continue;if(!At){let Gt=L?ht.aabb.intersectsPrecise(E):ht.aabb.intersectsPreciseFlat(E);if(Gt===0&&Mt()){const ce=new Mo(ht.zoom,pt,Et);Gt=cw(this,_,ce,!0).intersectsPrecise(E)}if(Gt===0)continue}const Nt=v[0]-(.5+pt+(ht.wrap<<ht.zoom))*(1<<i-ht.zoom),jt=v[1]-.5-Et,It=ht.tileID?ht.tileID:new Pn(Lt,ht.wrap,ht.zoom,pt,Et);rt.push({tileID:It,distanceSq:Nt*Nt+jt*jt})}}if(this.fogCullDistSq){const ht=this.fogCullDistSq,pt=this.horizonLineFromTop();rt=rt.filter(Et=>{const At=[0,0,0,1],Mt=[Dt,Dt,0,1],Lt=this.calculateFogTileMatrix(Et.tileID.toUnwrapped());jn.transformMat4(At,At,Lt),jn.transformMat4(Mt,Mt,Lt);const Nt=function(Gt,ce,ue){let ye=0;for(let be=0;be<2;++be)Gt[be]>0&&(ye+=(Gt[be]-0)*(Gt[be]-0)),ce[be]<0&&(ye+=(0-ce[be])*(0-ce[be]));return ye}(jn.min([],At,Mt),jn.max([],At,Mt));if(Nt===0)return!0;let jt=!1;const It=this._elevation;if(It&&Nt>ht&&pt!==0){const Gt=this.calculateProjMatrix(Et.tileID.toUnwrapped());let ce;t.isTerrainDEM||(ce=It.getMinMaxForTile(Et.tileID)),ce||(ce={min:U,max:F});const ue=function(be){const We=Math.round((be+45+360)%360/90)%4;return Rt[We]}(this.rotation),ye=[ue[0]*Dt,ue[1]*Dt,ce.max];ct.transformMat4(ye,ye,Gt),jt=(1-ye[1])*this.height*.5<pt}return Nt<ht||jt})}return rt.sort((ht,pt)=>ht.distanceSq-pt.distanceSq).map(ht=>ht.tileID)}resize(t,i){this.width=t,this.height=i,this.pixelsToGLUnits=[2/t,-2/i],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(t){const i=Ot(t.lat,-Ir,Ir),o=this.projection.project(t.lng,i);return new W(o.x*this.worldSize,o.y*this.worldSize)}unproject(t){return this.projection.unproject(t.x/this.worldSize,t.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/$n(1,this.center.lat)/this.worldSize}setLocationAtPoint(t,i){let o,c;const u=this.centerPoint;if(this.projection.name==="globe"){const p=this.worldSize;o=(i.x-u.x)/p,c=(i.y-u.y)/p}else{const p=this.pointCoordinate(i),g=this.pointCoordinate(u);o=p.x-g.x,c=p.y-g.y}const d=this.locationCoordinate(t);this.setLocation(new vn(d.x-o,d.y-c))}setLocation(t){this.center=this.coordinateLocation(t),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(t){return this.projection.locationPoint(this,t)}locationPoint3D(t){return this.projection.locationPoint(this,t,!0)}pointLocation(t){return this.coordinateLocation(this.pointCoordinate(t))}pointLocation3D(t){return this.coordinateLocation(this.pointCoordinate3D(t))}locationCoordinate(t,i){const o=i?$n(i,t.lat):void 0,c=this.projection.project(t.lng,t.lat);return new vn(c.x,c.y,o)}coordinateLocation(t){return this.projection.unproject(t.x,t.y)}pointRayIntersection(t,i){const o=i??this._centerAltitude,c=[t.x,t.y,0,1],u=[t.x,t.y,1,1];jn.transformMat4(c,c,this.pixelMatrixInverse),jn.transformMat4(u,u,this.pixelMatrixInverse);const d=u[3];jn.scale(c,c,1/c[3]),jn.scale(u,u,1/d);const p=c[2],g=u[2];return{p0:c,p1:u,t:p===g?0:(o-p)/(g-p)}}screenPointToMercatorRay(t){const i=[t.x,t.y,0,1],o=[t.x,t.y,1,1];return jn.transformMat4(i,i,this.pixelMatrixInverse),jn.transformMat4(o,o,this.pixelMatrixInverse),jn.scale(i,i,1/i[3]),jn.scale(o,o,1/o[3]),i[2]=$n(i[2],this._center.lat)*this.worldSize,o[2]=$n(o[2],this._center.lat)*this.worldSize,jn.scale(i,i,1/this.worldSize),jn.scale(o,o,1/this.worldSize),new T_([i[0],i[1],i[2]],ct.normalize([],ct.sub([],o,i)))}rayIntersectionCoordinate(t){const{p0:i,p1:o,t:c}=t,u=$n(i[2],this._center.lat),d=$n(o[2],this._center.lat);return new vn(qe(i[0],o[0],c)/this.worldSize,qe(i[1],o[1],c)/this.worldSize,qe(u,d,c))}pointCoordinate(t,i=this._centerAltitude){return this.projection.pointCoordinate(this,t.x,t.y,i)}pointCoordinate3D(t){if(!this.elevation)return this.pointCoordinate(t);let i=this.projection.pointCoordinate3D(this,t.x,t.y);if(i)return new vn(i[0],i[1],i[2]);let o=0,c=this.horizonLineFromTop();if(t.y>c)return this.pointCoordinate(t);const u=.02*c,d=t.clone();for(let p=0;p<10&&c-o>u;p++){d.y=qe(o,c,.66);const g=this.projection.pointCoordinate3D(this,d.x,d.y);g?(c=d.y,i=g):o=d.y}return i?new vn(i[0],i[1],i[2]):this.pointCoordinate(t)}isPointAboveHorizon(t){return this.projection.isPointAboveHorizon(this,t)}isPointOnSurface(t){if(t.y<0||t.y>this.height||t.x<0||t.x>this.width)return!1;if(this.elevation||this.zoom>=uc)return!this.isPointAboveHorizon(t);const i=this.pointCoordinate(t);return i.y>=0&&i.y<=1}_coordinatePoint(t,i){const o=i&&this.elevation?this.elevation.getAtPointOrZero(t,this._centerAltitude):this._centerAltitude,c=[t.x*this.worldSize,t.y*this.worldSize,o+t.toAltitude(),1];return jn.transformMat4(c,c,this.pixelMatrix),c[3]>0?new W(c[0]/c[3],c[1]/c[3]):new W(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:t,left:i}=this._edgeInsets,o=this.height-this._edgeInsets.bottom,c=this.width-this._edgeInsets.right,u=this.pointLocation3D(new W(i,t)),d=this.pointLocation3D(new W(c,t)),p=this.pointLocation3D(new W(c,o)),g=this.pointLocation3D(new W(i,o));let _=Math.min(u.lng,d.lng,p.lng,g.lng),v=Math.max(u.lng,d.lng,p.lng,g.lng),b=Math.min(u.lat,d.lat,p.lat,g.lat),S=Math.max(u.lat,d.lat,p.lat,g.lat);const E=Math.pow(2,-this.zoom)/16*270,A=this.projection.name==="globe"?1:4,C=(P,k,L,j,V)=>{const F=(P+L)/2,U=(k+j)/2,q=new W(F,U),{lng:Z,lat:X}=this.pointLocation3D(q),J=Math.max(0,_-Z,b-X,Z-v,X-S);_=Math.min(_,Z),v=Math.max(v,Z),b=Math.min(b,X),S=Math.max(S,X),(V<A||J>E)&&(C(P,k,F,U,V+1),C(F,U,L,j,V+1))};if(C(i,t,c,t,1),C(c,t,c,o,1),C(c,o,i,o,1),C(i,o,i,t,1),this.projection.name==="globe"){const[P,k]=function(L){const j=wt.identity(new Float64Array(16));wt.multiply(j,L.pixelMatrix,L.globeMatrix);const V=[0,Ao,0],F=[0,Co,0];return ct.transformMat4(V,V,j),ct.transformMat4(F,F,j),[V[0]>0&&V[0]<=L.width&&V[1]>0&&V[1]<=L.height&&!C_(L,new Ze(L.center.lat,90)),F[0]>0&&F[0]<=L.width&&F[1]>0&&F[1]<=L.height&&!C_(L,new Ze(L.center.lat,-90))]}(this);P?(S=90,v=180,_=-180):k&&(b=-90,v=180,_=-180)}return new Os(new Ze(_,b),new Ze(v,S))}_getBoundsRectangular(t,i){const{top:o,left:c}=this._edgeInsets,u=this.height-this._edgeInsets.bottom,d=this.width-this._edgeInsets.right,p=new W(c,o),g=new W(d,o),_=new W(d,u),v=new W(c,u);let b=this.pointCoordinate(p,t),S=this.pointCoordinate(g,t);const E=this.pointCoordinate(_,i),A=this.pointCoordinate(v,i),C=(P,k)=>(k.y-P.y)/(k.x-P.x);return b.y>1&&S.y>=0?b=new vn((1-A.y)/C(A,b)+A.x,1):b.y<0&&S.y<=1&&(b=new vn(-A.y/C(A,b)+A.x,0)),S.y>1&&b.y>=0?S=new vn((1-E.y)/C(E,S)+E.x,1):S.y<0&&b.y<=1&&(S=new vn(-E.y/C(E,S)+E.x,0)),new Os().extend(this.coordinateLocation(b)).extend(this.coordinateLocation(S)).extend(this.coordinateLocation(A)).extend(this.coordinateLocation(E))}_getBoundsRectangularTerrain(){const t=this.elevation;if(!t.visibleDemTiles.length||t.isUsingMockSource())return this._getBoundsRectangular(0,0);const i=t.visibleDemTiles.reduce((o,c)=>{if(c.dem){const u=c.dem.tree;o.min=Math.min(o.min,u.minimums[0]),o.max=Math.max(o.max,u.maximums[0])}return o},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(i.min*t.exaggeration(),i.max*t.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(t=!0){const i=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,o=this.height/2-i*(1-this._horizonShift);return t?Math.max(0,o):o}getMaxBounds(){return this.maxBounds}setMaxBounds(t){this.maxBounds=t,this.minLat=-Ir,this.maxLat=Ir,this.minLng=-180,this.maxLng=180,t&&(this.minLat=t.getSouth(),this.maxLat=t.getNorth(),this.minLng=t.getWest(),this.maxLng=t.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=ti(this.minLng)*this.tileSize,this.worldMaxX=ti(this.maxLng)*this.tileSize,this.worldMinY=ui(this.maxLat)*this.tileSize,this.worldMaxY=ui(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(t,i){return this.projection.createTileMatrix(this,i,t)}calculateDistanceTileData(t){const i=t.key,o=this._distanceTileDataCache;if(o[i])return o[i];const c=t.canonical,u=1/this.height,d=this.cameraWorldSize,p=d/this.zoomScale(c.z),g=(c.x+Math.pow(2,c.z)*t.wrap)*p,_=c.y*p,v=this.point;v.x*=d/this.worldSize,v.y*=d/this.worldSize;const b=this.angle,S=Math.sin(-b),E=-Math.cos(-b);return o[i]={bearing:[S,E],center:[(v.x-g)*u,(v.y-_)*u],scale:p/Dt*u},o[i]}calculateFogTileMatrix(t){const i=t.key,o=this._fogTileMatrixCache;if(o[i])return o[i];const c=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,t);return wt.multiply(c,this.worldToFogMatrix,c),o[i]=new Float32Array(c),o[i]}calculateProjMatrix(t,i=!1,o=!1){const c=t.key;let u;if(u=o?this._expandedProjMatrixCache:i?this._alignedProjMatrixCache:this._projMatrixCache,u[c])return u[c];const d=this.calculatePosMatrix(t,this.worldSize);let p;return p=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:o?this.expandedFarZProjMatrix:i?this.alignedProjMatrix:this.projMatrix,wt.multiply(d,p,d),u[c]=new Float32Array(d),u[c]}calculatePixelsToTileUnitsMatrix(t){const i=t.tileID.key,o=this._pixelsToTileUnitsCache;if(o[i])return o[i];const c=function(u,d){const{scale:p}=u.tileTransform,g=p*Dt/(u.tileSize*Math.pow(2,d.zoom-u.tileID.overscaledZ+u.tileID.canonical.z));return ad.scale(new Float32Array(4),d.inverseAdjustmentMatrix,[g,g])}(t,this);return o[i]=c,o[i]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const t=1/this.worldSize,i=wt.fromScaling([],[t,t,t]);return wt.multiply(i,i,this.globeMatrix),i}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const t=this._elevation;this._updateCameraState();const i=$n(1,this._center.lat)*this.worldSize,o=this._computeCameraPosition(i),c=this._camera.forward(),u=$n(1,this._center.lat);o[2]/=u,c[2]/=u,ct.normalize(c,c);const d=t.raycast(o,c,t.exaggeration());if(d){const p=ct.scaleAndAdd([],o,c,d),g=new vn(p[0],p[1],$n(p[2],qr(p[1]))),_=(g.z+ct.length([g.x-o[0],g.y-o[1],g.z-o[2]*u]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(_),this._centerAltitude=g.toAltitude(),this._center=this.coordinateLocation(g),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(t=!1){if(!this._elevation)return;const i=this._elevation,o=$n(1,this._center.lat)*this.worldSize,c=this._computeCameraPosition(o),u=i.getAtPointOrZero(new vn(...c)),d=this.pixelsPerMeter/this.worldSize*u,p=this._minimumHeightOverTerrain(),g=c[2]-d;if(g<=p)if(g<0||t){const _=this.locationCoordinate(this._center,this._centerAltitude),v=[c[0],c[1],_.z-c[2]],b=ct.length(v);v[2]-=(p-g)/this._pixelsPerMercatorPixel;const S=ct.length(v);if(S===0)return;ct.scale(v,v,b/S*this._pixelsPerMercatorPixel),this._camera.position=[c[0],c[1],_.z*this._pixelsPerMercatorPixel-v[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const t=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||t){const S=this.center;return S.lat=Ot(S.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!t)&&(S.lng=Ot(S.lng,this.minLng,this.maxLng)),this.center=S,void(this._constraining=!1)}const i=this._unmodified,{x:o,y:c}=this.point;let u=0,d=o,p=c;const g=this.width/2,_=this.height/2,v=this.worldMinY*this.scale,b=this.worldMaxY*this.scale;if(c-_<v&&(p=v+_),c+_>b&&(p=b-_),b-v<this.height&&(u=Math.max(u,this.height/(b-v)),p=(b+v)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const S=this.worldMinX*this.scale,E=this.worldMaxX*this.scale,A=this.worldSize/2-(S+E)/2;d=(o+A+this.worldSize)%this.worldSize-A,d-g<S&&(d=S+g),d+g>E&&(d=E-g),E-S<this.width&&(u=Math.max(u,this.width/(E-S)),d=(E+S)/2)}d===o&&p===c||(this.center=this.unproject(new W(d,p))),u&&(this.zoom+=this.scaleZoom(u)),this._constrainCamera(),this._unmodified=i,this._constraining=!1}_minZoomForBounds(){let t=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(t=Math.max(t,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),t}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const t=this.centerOffset,i=this.projection.name==="globe",o=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=$n(1,this.center.lat)/$n(1,45));const c=Sp(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,c),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const u=this.projection.zAxisUnit==="meters"?o:1,d=this._camera.getWorldToCamera(this.worldSize,u);let p;const g=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(g[8]=2*-t.x/this.width,g[9]=2*t.y/this.height,this.isOrthographic){let X=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),J=X*this.aspect,rt=-J,it=-X;J-=t.x,rt-=t.x,X+=t.y,it+=t.y,p=this._camera.getCameraToClipOrthographic(rt,J,it,X,this._nearZ,this._farZ),((ut,tt,dt,gt)=>{for(let xt=0;xt<16;xt++)ut[xt]=LO(tt[xt],dt[xt],gt)})(p,p,g,zO(this.pitch>=15?1:this.pitch/15))}else p=g;const _=wt.mul([],g,d);let v=wt.mul([],p,d);if(this.projection.isReprojectedInTileSpace){const X=this.locationCoordinate(this.center),J=wt.identity([]);wt.translate(J,J,[X.x*this.worldSize,X.y*this.worldSize,0]),wt.multiply(J,J,wO(this)),wt.translate(J,J,[-X.x*this.worldSize,-X.y*this.worldSize,0]),wt.multiply(v,v,J),wt.multiply(_,_,J),this.inverseAdjustmentMatrix=function(rt){const it=wO(rt,!0);return ad.invert([],[it[0],it[1],it[4],it[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=wt.scale([],v,[this.worldSize,this.worldSize,this.worldSize/u,1]),this.projMatrix=v,this.invProjMatrix=wt.invert(new Float64Array(16),this.projMatrix),i){const X=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);X[8]=2*-t.x/this.width,X[9]=2*t.y/this.height,this.expandedFarZProjMatrix=wt.mul([],X,d)}else this.expandedFarZProjMatrix=this.projMatrix;const b=wt.invert([],p);this.frustumCorners=ow.fromInvProjectionMatrix(b,this.horizonLineFromTop(),this.height),this.cameraFrustum=hl.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!i);const S=new Float32Array(16);wt.identity(S),wt.scale(S,S,[1,-1,1]),wt.rotateX(S,S,this._pitch),wt.rotateZ(S,S,this.angle);const E=wt.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=wt.clone(E);const A=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;E[8]=2*-t.x/this.width,E[9]=2*(t.y+A)/this.height,this.skyboxMatrix=wt.multiply(S,E,S);const C=this.point,P=C.x,k=C.y,L=this.width%2/2,j=this.height%2/2,V=Math.cos(this.angle),F=Math.sin(this.angle),U=P-Math.round(P)+V*L+F*j,q=k-Math.round(k)+V*j+F*L,Z=new Float64Array(v);if(wt.translate(Z,Z,[U>.5?U-1:U,q>.5?q-1:q,0]),this.alignedProjMatrix=Z,v=wt.create(),wt.scale(v,v,[this.width/2,-this.height/2,1]),wt.translate(v,v,[1,-1,0]),this.labelPlaneMatrix=v,v=wt.create(),wt.scale(v,v,[1,-1,1]),wt.translate(v,v,[-1,-1,0]),wt.scale(v,v,[2/this.width,2/this.height,1]),this.glCoordMatrix=v,this.pixelMatrix=wt.multiply(new Float64Array(16),this.labelPlaneMatrix,_),this._calcFogMatrices(),this._distanceTileDataCache={},v=wt.invert(new Float64Array(16),this.pixelMatrix),!v)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=v,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=function(J){const{x:rt,y:it}=J.point,{lng:ut,lat:tt}=J._center;return GD(rt,it,J.worldSize,ut,tt)}(this);const X=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=ct.transformMat4(X,X,d),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=v;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const t=this.cameraWorldSizeForFog,i=this.cameraPixelsPerMeter,o=this._camera.position,c=1/this.height/this._pixelsPerMercatorPixel,u=[t,t,i];ct.scale(u,u,c),ct.scale(o,o,-1),ct.multiply(o,o,u);const d=wt.create();wt.translate(d,d,o),wt.scale(d,d,u),this.mercatorFogMatrix=d,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(t,i,c)}_computeCameraPosition(t){const i=(t=t||this.pixelsPerMeter)/this.pixelsPerMeter,o=this._camera.forward(),c=this.point,u=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*i-t/this.worldSize*this._centerAltitude;return[c.x/this.worldSize-o[0]*u,c.y/this.worldSize-o[1]*u,t/this.worldSize*this._centerAltitude-o[2]*u]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(t){const i=this._maxCameraBoundsDistance()*Math.cos(this._pitch),o=this._camera.position[2],c=t[2];let u=1;this.projection.wrap&&(this.center=this.center.wrap()),c>0&&(u=Math.min((i-o)/c,1)),this._camera.position=ct.scaleAndAdd([],this._camera.position,t,u),this._updateStateFromCamera()}_updateStateFromCamera(){const t=this._camera.position,i=this._camera.forward(),{pitch:o,bearing:c}=this._camera.getPitchBearing(),u=$n(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,d=this._mercatorZfromZoom(this._maxZoom)*Math.cos(st(this._maxPitch)),p=Math.max((t[2]-u)/Math.cos(o),d),g=this._zoomFromMercatorZ(p);ct.scaleAndAdd(t,t,i,p),this._pitch=Ot(o,st(this.minPitch),st(this.maxPitch)),this.angle=me(c,-Math.PI,Math.PI),this._setZoom(Ot(g,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new vn(t[0],t[1],t[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(t){return Math.pow(2,t)*this.tileSize}_mercatorZfromZoom(t){return this.cameraToCenterDistance/this._worldSizeFromZoom(t)}_minimumHeightOverTerrain(){const t=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(t)}_zoomFromMercatorZ(t){return this.scaleZoom(this.cameraToCenterDistance/(t*this.tileSize))}zoomFromMercatorZAdjusted(t){let i=0,o=uc,c=0,u=1/0;for(;o-i>1e-6&&o>i;){const d=i+.5*(o-i),p=this.tileSize*Math.pow(2,d),g=this.getCameraToCenterDistance(this.projection,d,p),_=this.scaleZoom(g/(t*this.tileSize)),v=Math.abs(d-_);v<u&&(u=v,c=d),d<_?i=d:o=d}return c}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(_t("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(t,i){const o=Math.min(t.x,i.x),c=Math.max(t.x,i.x),u=Math.min(t.y,i.y),d=Math.max(t.y,i.y);if(u<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const p=[new W(o,u),new W(c,d),new W(o,d),new W(c,u)],g=this.renderWorldCopies?-3:0,_=this.renderWorldCopies?4:1;for(const v of p){const b=this.pointRayIntersection(v);if(b.t<0)return!0;const S=this.rayIntersectionCoordinate(b);if(S.x<g||S.y<0||S.x>_||S.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+St(this.fovAboveCenter)>88||this.anyCornerOffEdge(new W(0,0),new W(this.width,this.height))}zoomDeltaToMovement(t,i){const o=ct.length(ct.sub([],this._camera.position,t)),c=this._zoomFromMercatorZ(o)+i;return o-this._mercatorZfromZoom(c)}getCameraPoint(){if(this.projection.name==="globe"){const t=function([i,o,c],u){const d=[i,o,c,1];jn.transformMat4(d,d,u);const p=d[3]=Math.max(d[3],1e-6);return d[0]/=p,d[1]/=p,d[2]/=p,d}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new W(t[0],t[1])}{const t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new W(0,t))}}getCameraToCenterDistance(t,i=this.zoom,o=this.worldSize){const c=Sp(t,i,this.width,this.height,1024),u=t.pixelSpaceConversion(this.center.lat,o,c);let d=.5/Math.tan(.5*this._fov)*this.height*u;return this.isOrthographic&&(d=LO(1,d,zO(this.pitch>=15?1:this.pitch/15))),d}getWorldToCameraMatrix(){const t=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&wt.multiply(t,t,this.globeMatrix),t}getFrustum(t){return hl.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,t,this.projection.zAxisUnit==="meters")}}function NO(n,t,i){wt.identity(n),wt.rotateZ(n,n,st(t[2])),wt.rotateX(n,n,st(t[0])),wt.rotateY(n,n,st(t[1])),wt.scale(n,n,i),wt.multiply(n,n,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function my(n,t,i,o,c,u,d,p){const g=[i[0]-t[0],i[1]-t[1],0],_=[o[0]-t[0],o[1]-t[1],0];if(ct.length(g)<1e-12||ct.length(_)<1e-12)return Fi.identity(n);const v=ct.cross([],g,_);ct.normalize(v,v),ct.subtract(_,o,t),g[2]=(u-c)*p,_[2]=(d-c)*p;const b=g;return ct.cross(b,g,_),ct.normalize(b,b),Fi.rotationTo(n,v,b)}function FO(n,t,i=!1){const o=vi(t.zoom),c=function(u,d,p){const g=d.worldSize,_=[u[12],u[13],u[14]],v=qr(_[1]/g),b=Ls(_[0]/g),S=wt.identity([]),E=$n(1,v)*g,A=$n(1,0)*g*fc(v,d.zoom),C=1/dw(g);let P=A*C;if(p){const V=Sp(d.projection,d.zoom,d.width,d.height,1024);P=C*d.projection.pixelSpaceConversion(d.center.lat,g,V)}const k=ws(v,b);ct.add(k,k,ct.scale([],ct.normalize([],k),E*P*_[2]));const L=function(V){const F=[V[0],V[1],V[2]];let U=[0,1,0];const q=ct.cross([],U,F);return ct.cross(U,F,q),ct.squaredLength(U)===0&&(U=[0,1,0],ct.cross(q,F,U)),ct.normalize(q,q),ct.normalize(U,U),ct.normalize(F,F),[q[0],q[1],q[2],0,U[0],U[1],U[2],0,F[0],F[1],F[2],0,V[0],V[1],V[2],1]}(k);wt.scale(S,S,[P,P,P*E]),wt.translate(S,S,[-_[0],-_[1],-_[2]]);const j=wt.multiply([],d.globeMatrix,L);return wt.multiply(j,j,S),wt.multiply(j,j,u),j}(n,t,i);if(o>0){const u=function(d,p){const g=p.worldSize,_=$n(1,0)*g*fc(p.center.lat,p.zoom)/dw(g),v=$n(1,p.center.lat)*g,b=wt.identity([]);return wt.rotateY(b,b,st(p.center.lng)),wt.rotateX(b,b,st(p.center.lat)),wt.translate(b,b,[0,0,as]),wt.scale(b,b,[_,_,_*v]),wt.translate(b,b,[p.point.x-.5*g,p.point.y-.5*g,0]),wt.multiply(b,b,d),wt.multiply(b,p.globeMatrix,b)}(n,t);return function(d,p,g){const _=(A,C,P)=>{const k=ct.length(A),L=ct.length(C),j=dl(A,C,P);return ct.scale(j,j,1/ct.length(j)*qe(k,L,P))},v=_([d[0],d[1],d[2]],[p[0],p[1],p[2]],g),b=_([d[4],d[5],d[6]],[p[4],p[5],p[6]],g),S=_([d[8],d[9],d[10]],[p[8],p[9],p[10]],g),E=dl([d[12],d[13],d[14]],[p[12],p[13],p[14]],g);return[v[0],v[1],v[2],0,b[0],b[1],b[2],0,S[0],S[1],S[2],0,E[0],E[1],E[2],1]}(c,u,o)}return c}const Vu=64,$H=[1,1,1];class BO{constructor(t,i,o,c){this.id=t,this.position=i!=null?new Ze(i[0],i[1]):new Ze(0,0),this.orientation=o??[0,0,0],this.nodes=c,this.uploaded=!1,this.aabb=new nr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(t,i){if(wt.multiply(t.matrix,i,t.matrix),t.meshes)for(const o of t.meshes){const c=nr.applyTransform(o.aabb,t.matrix);this.aabb.encapsulate(c)}if(t.children)for(const o of t.children)this._applyTransformations(o,t.matrix)}computeBoundsAndApplyParent(){const t=wt.identity([]);for(const i of this.nodes)this._applyTransformations(i,t)}_positionModelOnTerrain(t,i){const o=t.elevation;if(!o)return 0;const c=nr.projectAabbCorners(this.aabb,this.matrix),u=$n(1,this.position.lat)*t.worldSize,d=function(k,L){const j=[0,0,1],V=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const F of V){const U=k[F.corners[0]],q=k[F.corners[1]],Z=k[F.corners[2]],X=[q[0]-U[0],q[1]-U[1],L*(q[2]-U[2])],J=ct.cross(X,X,[Z[0]-U[0],Z[1]-U[1],L*(Z[2]-U[2])]);ct.normalize(J,J),F.dotProductWithUp=ct.dot(J,j)}return V.sort((F,U)=>F.dotProductWithUp-U.dotProductWithUp),V[0].corners}(c,u),p=c[d[0]],g=c[d[1]],_=c[d[2]],v=c[d[3]],b=o.getAtPointOrZero(new vn(p[0]/t.worldSize,p[1]/t.worldSize),0),S=o.getAtPointOrZero(new vn(g[0]/t.worldSize,g[1]/t.worldSize),0),E=o.getAtPointOrZero(new vn(_[0]/t.worldSize,_[1]/t.worldSize),0),A=o.getAtPointOrZero(new vn(v[0]/t.worldSize,v[1]/t.worldSize),0),C=(b+A)/2,P=(S+E)/2;return C>P?S<E?my(i,g,v,p,S,A,b,u):my(i,_,p,v,E,b,A,u):b<A?my(i,p,g,_,b,S,E,u):my(i,v,_,g,A,E,S,u),Math.max(C,P)}computeModelMatrix(t,i,o,c,u,d,p=!1){const g=t.transform,_=g.zoom,v=g.project(this.position),b=fc(this.position.lat,_),S=1/b;wt.identity(this.matrix),wt.translate(this.matrix,this.matrix,[v.x+c[0]*S,v.y+c[1]*S,c[2]]);let E=1,A=1;const C=g.worldSize;if(p){if(g.projection.name==="mercator"){let j=0;g.elevation&&(j=g.elevation.getAtPointOrZero(new vn(v.x/C,v.y/C),0));const V=jn.transformMat4([],[v.x,v.y,j,1],g.projMatrix)[3]/g.cameraToCenterDistance;E=V,A=V*fc(g.center.lat,_)}else if(g.projection.name==="globe"){const j=FO(this.matrix,g),V=wt.multiply([],g.projMatrix,j),F=[0,0,0,1];jn.transformMat4(F,F,V);const U=F[3]/g.cameraToCenterDistance,q=vi(_),Z=g.projection.pixelsPerMeter(this.position.lat,C)*fc(this.position.lat,_),X=g.projection.pixelsPerMeter(g.center.lat,C)*fc(g.center.lat,_);E=U/qe(Z,QD(g.center.lat),q),A=U*b/Z,E*=X,A*=X}}else E=S;wt.scale(this.matrix,this.matrix,[E,E,A]);const P=[...this.matrix],k=this.orientation,L=[];if(NO(L,[k[0]+i[0],k[1]+i[1],k[2]+i[2]],o),wt.multiply(this.matrix,P,L),u&&g.elevation){let j=0;const V=[];if(d&&g.elevation){j=this._positionModelOnTerrain(g,V);const F=wt.fromQuat([],V),U=wt.multiply([],F,L);wt.multiply(this.matrix,P,U)}else j=g.elevation.getAtPointOrZero(new vn(v.x/C,v.y/C),0);j!==0&&(this.matrix[14]+=j)}}upload(t){if(!this.uploaded){for(const i of this.nodes)tS(i,t);for(const i of this.nodes)gy(i);this.uploaded=!0}}destroy(){for(const t of this.nodes)_y(t)}}function Tp(n,t,i=!1){n.uploaded||(n.gfxTexture=new _r(t,n.image,i?t.gl.R8:t.gl.RGBA,{useMipmap:n.sampler.minFilter>=t.gl.NEAREST_MIPMAP_NEAREST}),n.uploaded=!0,n.image=null)}function GH(n,t,i){n.indexBuffer=t.createIndexBuffer(n.indexArray,!1,!0),n.vertexBuffer=t.createVertexBuffer(n.vertexArray,RH.members,!1,!0),n.normalArray&&(n.normalBuffer=t.createVertexBuffer(n.normalArray,NH.members,!1,!0)),n.texcoordArray&&(n.texcoordBuffer=t.createVertexBuffer(n.texcoordArray,zH.members,!1,!0)),n.colorArray&&(n.colorBuffer=t.createVertexBuffer(n.colorArray,(n.colorArray.bytesPerElement===12?OH:LH).members,!1,!0)),n.featureArray&&(n.pbrBuffer=t.createVertexBuffer(n.featureArray,BH.members,!0)),n.segments=Bn.simpleSegment(0,0,n.vertexArray.length,n.indexArray.length);const o=n.material;o.pbrMetallicRoughness.baseColorTexture&&Tp(o.pbrMetallicRoughness.baseColorTexture,t),o.pbrMetallicRoughness.metallicRoughnessTexture&&Tp(o.pbrMetallicRoughness.metallicRoughnessTexture,t),o.normalTexture&&Tp(o.normalTexture,t),o.occlusionTexture&&Tp(o.occlusionTexture,t,i),o.emissionTexture&&Tp(o.emissionTexture,t)}function tS(n,t,i){if(n.meshes)for(const o of n.meshes)GH(o,t,i);if(n.children)for(const o of n.children)tS(o,t,i)}function gy(n){if(n.meshes)for(const t of n.meshes)t.indexArray.destroy(),t.vertexArray.destroy(),t.colorArray&&t.colorArray.destroy(),t.normalArray&&t.normalArray.destroy(),t.texcoordArray&&t.texcoordArray.destroy(),t.featureArray&&t.featureArray.destroy();if(n.children)for(const t of n.children)gy(t)}function _y(n){if(n.meshes)for(const i of n.meshes)i.vertexBuffer&&(i.vertexBuffer.destroy(),i.indexBuffer.destroy(),i.normalBuffer&&i.normalBuffer.destroy(),i.texcoordBuffer&&i.texcoordBuffer.destroy(),i.colorBuffer&&i.colorBuffer.destroy(),i.pbrBuffer&&i.pbrBuffer.destroy(),i.segments.destroy(),i.material&&((t=i.material).pbrMetallicRoughness.baseColorTexture&&t.pbrMetallicRoughness.baseColorTexture.gfxTexture&&t.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),t.pbrMetallicRoughness.metallicRoughnessTexture&&t.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&t.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),t.normalTexture&&t.normalTexture.gfxTexture&&t.normalTexture.gfxTexture.destroy(),t.emissionTexture&&t.emissionTexture.gfxTexture&&t.emissionTexture.gfxTexture.destroy(),t.occlusionTexture&&t.occlusionTexture.gfxTexture&&t.occlusionTexture.gfxTexture.destroy()));var t;if(n.children)for(const i of n.children)_y(i)}class jO{constructor(t,i){this.feature=t,this.instancedDataOffset=i,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class VO{constructor(){this.instancedDataArray=new zb,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class UO{constructor(t){this.zoom=t.zoom,this.canonical=t.canonical,this.layers=t.layers,this.layerIds=this.layers.map(i=>i.fqid),this.projection=t.projection,this.index=t.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0}}populate(t,i,o,c){this.tileToMeter=ap(o);const u=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:d,id:p,index:g,sourceLayerIndex:_}of t){const v=pc(d,u);if(!this.layers[0]._featureFilter.filter(new pr(this.zoom),v,o))continue;const b={id:p,sourceLayerIndex:_,index:g,geometry:u?v.geometry:Aa(d,o,c),properties:d.properties,type:d.type,patterns:{}},S=this.addFeature(b,b.geometry,v);S&&i.featureIndex.insert(d,b.geometry,g,_,this.index,this.instancesPerModel[S].instancedDataArray.length)}this.lookup=null}update(t,i,o,c){for(const u in this.instancesPerModel){const d=this.instancesPerModel[u];for(const p in t)d.idToFeaturesIndex.hasOwnProperty(p)&&this.evaluate(d.features[d.idToFeaturesIndex[p]],t[p],d,!0)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let t=!1;for(const i in this.instancesPerModel){const o=this.instancesPerModel[i];for(const c of o.features){const u=this.layers[0],d=c.feature,p=this.canonical,g=u.paint.get("model-rotation").evaluate(d,{},p),_=u.paint.get("model-scale").evaluate(d,{},p),v=u.paint.get("model-translation").evaluate(d,{},p);ct.exactEquals(c.rotation,g)&&ct.exactEquals(c.scale,_)&&ct.exactEquals(c.translation,v)||(this.evaluate(c,c.featureStates,o,!0),t=!0)}}return t}isEmpty(){for(const t in this.instancesPerModel)if(this.instancesPerModel[t].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(t){if(!this.uploaded)for(const i in this.instancesPerModel){const o=this.instancesPerModel[i];o.instancedDataArray.length<0||o.instancedDataArray.length===0||(o.instancedDataBuffer?o.instancedDataBuffer.updateData(o.instancedDataArray):o.instancedDataBuffer=t.createVertexBuffer(o.instancedDataArray,FH.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const t in this.instancesPerModel){const i=this.instancesPerModel[t];i.instancedDataArray.length!==0&&i.instancedDataBuffer&&i.instancedDataBuffer.destroy()}}addFeature(t,i,o){const c=this.layers[0],u=c.layout.get("model-id").evaluate(o,{},this.canonical);if(!u)return _t(`modelId is not evaluated for layer ${c.id} and it is not going to get rendered.`),u;this.instancesPerModel[u]||(this.instancesPerModel[u]=new VO);const d=this.instancesPerModel[u],p=d.instancedDataArray,g=new jO(o,p.length);for(const _ of i)for(const v of _){if(v.x<0||v.x>=Dt||v.y<0||v.y>=Dt)continue;const b=(this.lookupDim-1)/Dt,S=this.lookupDim*(v.y*b|0)+v.x*b|0;if(this.lookup){if(this.lookup[S]!==0)continue;this.lookup[S]=1}this.instanceCount++;const E=p.length;p.resize(E+1),d.instancesEvaluatedElevation.push(0),p.float32[16*E]=v.x,p.float32[16*E+1]=v.y}return g.instancedDataCount=d.instancedDataArray.length-g.instancedDataOffset,g.instancedDataCount>0&&(t.id&&(d.idToFeaturesIndex[t.id]=d.features.length),d.features.push(g),this.evaluate(g,{},d,!1)),u}evaluate(t,i,o,c){const u=this.layers[0],d=t.feature,p=this.canonical,g=t.rotation=u.paint.get("model-rotation").evaluate(d,i,p),_=t.scale=u.paint.get("model-scale").evaluate(d,i,p),v=t.translation=u.paint.get("model-translation").evaluate(d,i,p),b=u.paint.get("model-color").evaluate(d,i,p);b.a=u.paint.get("model-color-mix-intensity").evaluate(d,i,p);const S=[];this.maxVerticalOffset<v[2]&&(this.maxVerticalOffset=v[2]),this.maxScale=Math.max(Math.max(this.maxScale,_[0]),Math.max(_[1],_[2])),NO(S,g,_);const E=Math.round(100*b.a)+b.b/1.05;for(let A=0;A<t.instancedDataCount;++A){const C=t.instancedDataOffset+A,P=16*C,k=o.instancedDataArray.float32;let L=0;c&&(L=k[P+6]-o.instancesEvaluatedElevation[C]);const j=0|k[P+1];k[P]=(0|k[P])+b.r/1.05,k[P+1]=j+b.g/1.05,k[P+2]=E,k[P+3]=1/(p.z>10?this.tileToMeter:ap(p,j)),k[P+4]=v[0],k[P+5]=v[1],k[P+6]=v[2]+L,k[P+7]=S[0],k[P+8]=S[1],k[P+9]=S[2],k[P+10]=S[4],k[P+11]=S[5],k[P+12]=S[6],k[P+13]=S[8],k[P+14]=S[9],k[P+15]=S[10],o.instancesEvaluatedElevation[C]=v[2]}}}Se(UO,"ModelBucket",{omit:["layers"]}),Se(VO,"PerModelAttributes"),Se(jO,"ModelFeature");const WH=new Tr({visibility:new te(vt.layout_model.visibility),"model-id":new ze(vt.layout_model["model-id"])});var HH={paint:new Tr({"model-opacity":new te(vt.paint_model["model-opacity"]),"model-rotation":new ze(vt.paint_model["model-rotation"]),"model-scale":new ze(vt.paint_model["model-scale"]),"model-translation":new ze(vt.paint_model["model-translation"]),"model-color":new ze(vt.paint_model["model-color"]),"model-color-mix-intensity":new ze(vt.paint_model["model-color-mix-intensity"]),"model-type":new te(vt.paint_model["model-type"]),"model-cast-shadows":new te(vt.paint_model["model-cast-shadows"]),"model-receive-shadows":new te(vt.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new te(vt.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new ze(vt.paint_model["model-emissive-strength"]),"model-roughness":new ze(vt.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new ze(vt.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new te(vt.paint_model["model-cutoff-fade-range"])}),layout:WH};const eS=new Float32Array(262144),Uu=new Uint8Array(262144);function $O(n){let t=0;if(n.meshes)for(const i of n.meshes)t=Math.max(t,i.aabb.max[2]);if(n.children)for(const i of n.children)t=Math.max(t,$O(i));return t}const GO=["","wall","door","roof","window","lamp","logo"];class WO{constructor(t){this.node=t,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.feature={type:"Point",id:t.id,geometry:[],properties:{height:$O(t)}}}}class HO{constructor(t,i,o,c){this.nodes=t,this.id=i,this.modelTraits|=1,this.uploaded=!1,this.hasPattern=!1,o&&(this.modelTraits|=4),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=c,this.dirty=!0,this.needsUpload=!1}update(){console.log("Update 3D model bucket")}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(t){if(!this.needsUpload)return;const i=this.getNodesInfo();for(const o of i){const c=o.node;this.uploaded?this.updatePbrBuffer(c):tS(c,t,!0)}for(const o of i)gy(o.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(t){let i=!1;if(!t.meshes)return i;for(const o of t.meshes)o.pbrBuffer&&(o.pbrBuffer.updateData(o.featureArray),i=!0);return i}needsReEvaluation(t,i,o){const c=t.transform.projectionOptions,u=t.style.getBrightness(),d=this.brightness!==u;return!!(!this.uploaded||this.dirty||c.name!==this.projection.name||Ep(o.paint.get("model-color").value,d)||Ep(o.paint.get("model-color-mix-intensity").value,d)||Ep(o.paint.get("model-roughness").value,d)||Ep(o.paint.get("model-emissive-strength").value,d)||Ep(o.paint.get("model-height-based-emissive-strength-multiplier").value,d))&&(this.projection=c,this.brightness=u,!0)}evaluateScale(t,i){if(t.transform.zoom===this.zoom)return;this.zoom=t.transform.zoom;const o=this.getNodesInfo(),c=this.id.canonical;for(const u of o){const d=u.feature;u.evaluatedScale=i.paint.get("model-scale").evaluate(d,{},c)}}evaluate(t){const i=this.getNodesInfo();for(const o of i){if(!o.node.meshes)continue;const c=o.feature,u=o.node.meshes&&o.node.meshes[0].featureData,d=o.evaluatedColor[2],p=o.evaluatedRMEA[2],g=this.id.canonical;if(o.hasTranslucentParts=!1,u){for(let _=0;_<GO.length;_++){const v=GO[_];v.length&&(c.properties.part=v);const b=t.paint.get("model-color").evaluate(c,{},g),S=t.paint.get("model-color-mix-intensity").evaluate(c,{},g);o.evaluatedColor[_]=[b.r,b.g,b.b,S],o.evaluatedRMEA[_][0]=t.paint.get("model-roughness").evaluate(c,{},g),o.evaluatedRMEA[_][2]=t.paint.get("model-emissive-strength").evaluate(c,{},g),o.evaluatedRMEA[_][3]=b.a,o.emissionHeightBasedParams[_]=t.paint.get("model-height-based-emissive-strength-multiplier").evaluate(c,{},g),!o.hasTranslucentParts&&b.a<1&&(o.hasTranslucentParts=!0)}delete c.properties.part,ZH(o,d!==o.evaluatedColor[2]||p!==o.evaluatedRMEA[2])}o.evaluatedScale=t.paint.get("model-scale").evaluate(c,{},g),this.updatePbrBuffer(o.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(t,i,o,c){const u=t.findDEMTileFor(o);if(u&&(u.tileID.canonical!==this.terrainTile||i!==this.terrainExaggeration)){if(u.dem&&u.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=u.tileID.overscaledZ;const d=_d.create(t,o,u);if(!d)return;4&this.modelTraits&&this.updateDEM(t,d,o,c);for(const p of this.getNodesInfo()){const g=p.node;if(!g.footprint||!g.footprint.vertices||!g.footprint.vertices.length)continue;const _=g.footprint.vertices;let v=d.getElevationAt(_[0].x,_[0].y,!0,!0);for(let b=1;b<_.length;b++)v=Math.min(v,d.getElevationAt(_[b].x,_[b].y,!0,!0));g.elevation=v}}this.terrainTile=u.tileID.canonical,this.terrainExaggeration=i}}updateDEM(t,i,o,c){let u=i._dem._modifiedForSources[c];if(u===void 0&&(i._dem._modifiedForSources[c]=[],u=i._dem._modifiedForSources[c]),u.includes(o.canonical))return;const d=i._dem.dim;u.push(o.canonical);let p=!1;for(const g of this.getNodesInfo()){const _=g.node;if(!_.footprint||!_.footprint.grid)continue;const v=_.footprint.grid,b=i.tileCoordToPixel(v.min.x,v.min.y),S=i.tileCoordToPixel(v.max.x,v.max.y),E=Math.min(Math.min(d-S.y,b.x),Math.min(b.y,d-S.x));if(E<0)continue;const A=Ot(E,2,5);let C=Math.max(0,b.x-A),P=Math.max(0,b.y-A),k=Math.min(S.x+A,d-1),L=Math.min(S.y+A,d-1);for(let U=P;U<=L;++U)for(let q=C;q<=k;++q)Uu[U*d+q]=255;let j=0,V=0;for(let U=0;U<v.cellsY;++U)for(let q=0;q<v.cellsX;++q){if(!v.cells[U*v.cellsX+q])continue;const Z=i.tileCoordToPixel(v.min.x+q/v.xScale,v.min.y+U/v.yScale),X=i.tileCoordToPixel(v.min.x+(q+1)/v.xScale,v.min.y+(U+1)/v.yScale);for(let J=Z.y;J<=Math.min(X.y+1,d-1);++J)for(let rt=Z.x;rt<=Math.min(X.x+1,d-1);++rt)Uu[J*d+rt]===255&&(Uu[J*d+rt]=0,j+=i.getElevationAtPixel(rt,J),V++)}const F=j/V;C=Math.max(1,b.x-A),P=Math.max(1,b.y-A),k=Math.min(S.x+A,d-2),L=Math.min(S.y+A,d-2),p=!0;for(let U=P;U<=L;++U)for(let q=C;q<=k;++q)Uu[U*d+q]===0&&(eS[U*d+q]=i._dem.set(q,U,F));for(let U=1;U<A;++U){C=Math.max(1,b.x-U),P=Math.max(1,b.y-U),k=Math.min(S.x+U,d-2),L=Math.min(S.y+U,d-2);for(let q=P;q<=L;++q)for(let Z=C;Z<=k;++Z){const X=q*d+Z;if(Uu[X]===255){let J=0,rt=0,it=-1,ut=-1;for(let tt=-1;tt<=1;++tt)for(let dt=-1;dt<=1;++dt){const gt=(q+tt)*d+Z+dt;if(Uu[gt]>=U)continue;const xt=eS[gt],ht=Math.abs(xt);ht>rt&&(J=xt,rt=ht,it=dt,ut=tt)}if(rt>.1){const tt=1-(U+.5*Math.abs(it*ut))/A;let dt=i._dem.get(Z,q)+J*tt;const gt=i._dem.get(Z+it,q+ut),xt=i._dem.get(Z-it,q-ut,!0);(dt-gt)*(dt-xt)>0&&(dt=(gt+xt)/2),eS[X]=i._dem.set(Z,q,dt),Uu[X]=U}}}}}p&&(i._demTile.needsDEMTextureUpload=!0,i._dem._timestamp=Be.now())}getNodesInfo(){if(!this.nodesInfo){this.nodesInfo=[];for(const t of this.nodes)this.nodesInfo.push(new WO(t));this.freeNodes()}return this.nodesInfo}freeNodes(){if(this.nodes){for(const t of this.nodes)_y(t);this.nodes.splice(0,this.nodes.length)}}destroy(){this.freeNodes();const t=this.getNodesInfo();for(const i of t)gy(i.node),_y(i.node)}isEmpty(){return!this.nodes.length}updateReplacement(t,i){if(i.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=i.updateTime;const o=i.getReplacementRegionsForTile(t.toUnwrapped()),c=this.getNodesInfo();for(let u=0;u<this.nodesInfo.length;u++){const d=c[u].node;c[u].hiddenByReplacement=!!d.footprint&&!o.find(p=>p.footprint===d.footprint)}}getHeightAtTileCoord(t,i){const o=this.getNodesInfo(),c=[];for(let u=0;u<this.nodesInfo.length;u++){const d=o[u],p=d.node.meshes[0];if(t<p.aabb.min[0]||i<p.aabb.min[1]||t>p.aabb.max[0]||i>p.aabb.max[1])continue;const g=(t-p.aabb.min[0])/(p.aabb.max[0]-p.aabb.min[0])*Vu|0,_=Math.min(63,(i-p.aabb.min[1])/(p.aabb.max[1]-p.aabb.min[1])*Vu|0)*Vu+Math.min(63,g);if(!(p.heightmap[_]<0&&d.node.footprint))return d.hiddenByReplacement?void 0:{height:p.heightmap[_],maxHeight:d.feature.properties.height,hidden:!1,verticalScale:d.evaluatedScale[2]};if(d.node.footprint.grid.query(new W(t,i),new W(t,i),c),c.length>0)return{height:void 0,maxHeight:d.feature.properties.height,hidden:d.hiddenByReplacement,verticalScale:d.evaluatedScale[2]}}}}function Ep(n,t){return!n.isLightConstant&&t}function qH(n,t,i,o,c,u,d,p){let g=(61440&t|(61440&t)>>4)>>8,_=(3840&t|(3840&t)>>4)>>4,v=240&t|(240&t)>>4;i[3]>0&&(g=qe(g,255*i[0],i[3]),_=qe(_,255*i[1],i[3]),v=qe(v,255*i[2],i[3]));const b=g<<8|_,S=v<<8|Math.floor(255*o[3]),E=function(U){const q=Ot(U,0,2);return Math.min(Math.round(.5*q*255),255)}(o[2])<<8|15*o[0]<<4|15*o[1],A=Ot(c[0],0,1),C=Ot(c[1],0,1),P=Ot(c[2],0,1),k=Ot(c[3],0,1);let L,j,V,F;if(A!==C&&d!==u&&C!==A){const U=d-u;j=1/(U*(C-A)),V=-(u+U*A)/(U*(C-A));const q=Ot(c[4],-1,1);F=Math.pow(10,q),L=255*P<<8|255*k}else L=65535,j=0,V=1,F=1;if(n.emplaceBack(b,S,E,L,j,V,F),p){const U=p.length;p.clear();for(let q=0;q<U;q++)p.emplaceBack(b,S,E,L,j,V,F)}}function ZH(n,t){const i=n.node;let o=0;for(const c of i.meshes){if(i.lights&&i.lightMeshIndex===o||!c.featureData)continue;c.featureArray=new __,c.featureArray.reserve(c.featureData.length);let u=t;for(const d of c.featureData){let p;const g=65535&d,_=(15&g)<8?15&g:0,v=d>>16&65535,b=n.evaluatedRMEA[_],S=n.evaluatedColor[_],E=n.emissionHeightBasedParams[_];if(u&&_===2&&i.lights&&(p=new __,p.resize(10*i.lights.length)),qH(c.featureArray,v,S,b,E,c.aabb.min[2],c.aabb.max[2],p),p&&u){u=!1;const A=i.meshes[i.lightMeshIndex];A.featureArray=p,A.featureArray._trim()}}c.featureArray._trim(),o++}}Se(HO,"Tiled3dModelBucket",{omit:["layers"]}),Se(WO,"Tiled3dModelFeature");class XH{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[]}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(t){const i=XO(new W(0,0),new W(Dt,Dt),t),o=[];for(const c of this._activeRegions){if(c.hiddenByOverlap||!ZO(i,c))continue;const u=YH(c.min,c.max,t);o.push({min:u.min,max:u.max,sourceId:this._sourceIds[c.priority],footprint:c.footprint,footprintTileId:c.tileId})}return o}setSources(t){this._setSources(t.map(i=>({getSourceId:()=>i.cache.id,getFootprints:()=>{const o=[];for(const c of i.cache.getVisibleCoordinates()){const u=i.cache.getTile(c).buckets[i.layer];if(u)for(const d of u.getNodesInfo()){const p=d.node;p.footprint&&o.push({footprint:p.footprint,id:c.toUnwrapped()})}}return o}})))}_addSource(t){const i=t.getFootprints();if(i.length!==0){for(const o of i){if(!o.footprint)continue;const c=XO(o.footprint.min,o.footprint.max,o.id);this._activeRegions.push({min:c.min,max:c.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:o.id,footprint:o.footprint})}this._sourceIds.push(t.getSourceId())}}_computeReplacement(){this._activeRegions.sort((i,o)=>i.priority-o.priority||yy(i.min,o.min)||yy(i.max,o.max));let t=this._activeRegions.length!==this._prevRegions.length;if(!t){let i=0,o=0;for(;!t&&i!==this._activeRegions.length;){const c=this._activeRegions[i],u=this._prevRegions[o];t=c.priority!==u.priority||!qO(c,u),++i,++o}}if(t){++this._updateTime;const i=o=>{const c=this._activeRegions;if(o>=c.length)return o;const u=c[o].priority;for(;o<c.length&&c[o].priority===u;)++o;return o};if(this._sourceIds.length>1){let o=0,c=i(o);for(;o!==c;){let u=o;const d=o;for(;u!==c;){const p=this._activeRegions[u];p.hiddenByOverlap=!1;for(let g=0;g<d;g++){const _=this._activeRegions[g];if(!_.hiddenByOverlap&&ZO(p,_)&&(p.hiddenByOverlap=KO(p.footprint,p.tileId,_.footprint,_.tileId),p.hiddenByOverlap))break}++u}o=c,c=i(o)}}}}_setSources(t){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let i=t.length-1;i>=0;i--)this._addSource(t[i]);this._computeReplacement()}}function yy(n,t){return n.x-t.x||n.y-t.y}function qO(n,t){return yy(n.min,t.min)===0&&yy(n.max,t.max)===0}function ZO(n,t){return!(n.min.x>t.max.x||n.max.x<t.min.x||n.min.y>t.max.y||n.max.y<t.min.y)}function XO(n,t,i){const o=1/Dt,c=1/(1<<i.canonical.z),u=(t.x*o+i.canonical.x)*c+i.wrap,d=(t.y*o+i.canonical.y)*c;return{min:new W((n.x*o+i.canonical.x)*c+i.wrap,(n.y*o+i.canonical.y)*c),max:new W(u,d)}}function YH(n,t,i){const o=1<<i.canonical.z,c=((t.x-i.wrap)*o-i.canonical.x)*Dt,u=(t.y*o-i.canonical.y)*Dt;return{min:new W(((n.x-i.wrap)*o-i.canonical.x)*Dt,(n.y*o-i.canonical.y)*Dt),max:new W(c,u)}}function YO(n,t,i,o,c,u,d){const p=n.indices,g=n.vertices,_=[];for(let v=o;v<o+c;v+=3){const b=t[i[v+0]+u],S=t[i[v+1]+u],E=t[i[v+2]+u],A=Math.min(b.x,S.x,E.x),C=Math.max(b.x,S.x,E.x),P=Math.min(b.y,S.y,E.y),k=Math.max(b.y,S.y,E.y);_.length=0,n.grid.query(new W(A,P),new W(C,k),_);for(let L=0;L<_.length;L++){const j=_[L];if(bw(g[p[3*j+0]],g[p[3*j+1]],g[p[3*j+2]],b,S,E,d))return!0}}return!1}function KO(n,t,i,o){if(!n||!i)return!1;let c=n.vertices;if(!t.canonical.equals(o.canonical)||t.wrap!==o.wrap){if(i.vertices.length<n.vertices.length)return KO(i,o,n,t);const u=t.canonical,d=o.canonical,p=Math.pow(2,d.z-u.z);c=n.vertices.map(g=>new W(g.x*u.x*Dt*p-d.x*Dt,g.y*u.y*Dt*p-d.y*Dt))}return YO(i,c,n.indices,0,n.indices.length,0,0)}const KH=V_.types,JH=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius"],QH=["fill-extrusion-flood-light-ground-radius"],tq=Math.pow(2,13),eq=Math.pow(2,15)-1,JO=new W(0,1),ka=2147483648;function Mp(n,t,i,o,c,u,d,p){n.emplaceBack((t<<1)+d,(i<<1)+u,(Math.floor(o*tq)<<1)+c,Math.round(p))}function vy(n,t,i,o,c,u){n.emplaceBack(t.x,t.y,(i.x<<1)+o,(i.y<<1)+c,u)}function Ap(n,t,i){n.emplaceBack(t.x,t.y,t.z,i[0]*16384,i[1]*16384,i[2]*16384)}class QO{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class tL{constructor(){this.centroidXY=new W(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new W(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new W(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new W(this.max.x-this.min.x,this.max.y-this.min.y)}}class eL{constructor(){this.acc=new W(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(t,i){t.min.x===Number.MAX_VALUE&&(t.min.x=t.max.x=i.x,t.min.y=t.max.y=i.y)}appendEdge(t,i,o){this.accCount++,this.acc._add(i);let c=!!this.borders;i.x<t.min.x?(t.min.x=i.x,c=!0):i.x>t.max.x&&(t.max.x=i.x,c=!0),i.y<t.min.y?(t.min.y=i.y,c=!0):i.y>t.max.y&&(t.max.y=i.y,c=!0),((i.x===0||i.x===Dt)&&i.x===o.x)!=((i.y===0||i.y===Dt)&&i.y===o.y)&&this.processBorderOverlap(i,o),c&&this.checkBorderIntersection(i,o)}checkBorderIntersection(t,i){i.x<0!=t.x<0&&this.addBorderIntersection(0,qe(i.y,t.y,(0-i.x)/(t.x-i.x))),i.x>Dt!=t.x>Dt&&this.addBorderIntersection(1,qe(i.y,t.y,(Dt-i.x)/(t.x-i.x))),i.y<0!=t.y<0&&this.addBorderIntersection(2,qe(i.x,t.x,(0-i.y)/(t.y-i.y))),i.y>Dt!=t.y>Dt&&this.addBorderIntersection(3,qe(i.x,t.x,(Dt-i.y)/(t.y-i.y)))}addBorderIntersection(t,i){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const o=this.borders[t];i<o[0]&&(o[0]=i),i>o[1]&&(o[1]=i)}processBorderOverlap(t,i){if(t.x===i.x){if(t.y===i.y)return;const o=t.x===0?0:1;this.addBorderIntersection(o,i.y),this.addBorderIntersection(o,t.y)}else{const o=t.y===0?2:3;this.addBorderIntersection(o,i.x),this.addBorderIntersection(o,t.x)}}centroid(){return this.accCount===0?new W(0,0):new W(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((t,i)=>t+ +(i[0]!==Number.MAX_VALUE),0):0}}function nL(n,t){const i=n.add(t)._unit(),o=Ot(n.x*i.x+n.y*i.y,-1,1);var c,u,d;return c=Math.acos(o),Math.min(4,Math.max(-4,Math.tan(c)))/4*eq*((u=n).x*(d=t).y-u.y*d.x<0?-1:1)}const nq=[n=>n.x<0,n=>n.x>Dt,n=>n.y<0,n=>n.y>Dt];function rq(n,t,i,o){const c=[4];if(o===0)return c;i._mult(o);const u=n.sub(i),d=t.sub(i),p=[n,t,u,d];for(let g=0;g<4;g++)for(const _ of p)if(nq[g](_)){c.push(g);break}return c}class rL{constructor(t){this.vertexArray=new Tb,this.indexArray=new Hr,this.programConfigurations=new ac(t.layers,t.zoom,i=>QH.includes(i)),this._segments=new Bn,this.hiddenByLandmarkVertexArray=new Nb,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new Bn}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(t,i,o,c=!1){const u=t.length;if(u>2){let d=Math.max(0,this._segments.get().length-1);const p=this._segments._prepareSegment(4*u,this.vertexArray.length,2*this._segmentToGroundQuads[d].length);let g;d!==this._segments.get().length-1&&(d++,this._segmentToGroundQuads[d]=[],this._segmentToRegionTriCounts[d]=[0,0,0,0,0]);{const _=t[0],v=t[1];g=nL(_.sub(t[u-1])._perp()._unit(),v.sub(_)._perp()._unit())}for(let _=0;_<u;_++){const v=_===u-1?0:_+1,b=t[_],S=t[v],E=t[v===u-1?0:v+1],A=S.sub(b)._perp()._unit(),C=nL(A,E.sub(S)._perp()._unit()),P=g,k=C;if(nS(b,S,i)||c&&oL(b,i)&&oL(S,i)){g=C;continue}const L=p.vertexLength;vy(this.vertexArray,b,S,1,1,P),vy(this.vertexArray,b,S,1,0,P),vy(this.vertexArray,b,S,0,1,k),vy(this.vertexArray,b,S,0,0,k),p.vertexLength+=4;const j=rq(b,S,A,o);for(const V of j)this._segmentToGroundQuads[d].push({id:L,region:V}),this._segmentToRegionTriCounts[d][V]+=2,p.primitiveLength+=2;g=C}}}prepareBorderSegments(){if(!this.hasData())return;const t=this._segments.get(),i=t.length;for(let o=0;o<i;o++)this._segmentToGroundQuads[o].sort((c,u)=>c.region-u.region);for(let o=0;o<i;o++){const c=this._segmentToGroundQuads[o],u=t[o],d=this._segmentToRegionTriCounts[o];d.reduce((g,_)=>g+_,0);let p=0;for(let g=0;g<=4;g++){const _=d[g];if(_!==0){let v=this.regionSegments[g];v||(v=this.regionSegments[g]=new Bn);const b={vertexOffset:u.vertexOffset,primitiveOffset:u.primitiveOffset+p,vertexLength:u.vertexLength,primitiveLength:_};v.get().push(b)}p+=_}for(let g=0;g<c.length;g++){const _=c[g].id;this.indexArray.emplaceBack(_,_+1,_+3),this.indexArray.emplaceBack(_,_+3,_+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(t,i,o,c,u,d){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,t,i,o,c,u,d)}upload(t){this.hasData()&&(this.vertexBuffer=t.createVertexBuffer(this.vertexArray,CG.members),this.indexBuffer=t.createIndexBuffer(this.indexArray))}uploadPaintProperties(t){this.hasData()&&this.programConfigurations.upload(t)}update(t,i,o,c,u,d){this.hasData()&&this.programConfigurations.updatePaintArrays(t,i,o,c,u,d)}updateHiddenByLandmark(t){if(!this.hasData())return;const i=t.groundVertexCount+t.groundVertexArrayOffset;if(t.groundVertexCount===0)return;const o=t.flags&ka?1:0;for(let c=t.groundVertexArrayOffset;c<i;++c)this.hiddenByLandmarkVertexArray.emplace(c,o);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(t){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=t.createVertexBuffer(this.hiddenByLandmarkVertexArray,IG.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let t=0;t<=4;t++){const i=this.regionSegments[t];i&&i.destroy()}}}}class Cp{constructor(t){this.zoom=t.zoom,this.canonical=t.canonical,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(i=>i.fqid),this.index=t.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=t.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new Hr,this.footprintVertices=new Ds,this.footprintSegments=[],this.layoutVertexArray=new Du,this.centroidVertexArray=new fk,this.indexArray=new Hr,this.programConfigurations=new ac(t.layers,t.zoom,i=>JH.includes(i)),this.segments=new Bn,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.groundEffect=new rL(t),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}populate(t,i,o,c){this.features=[],this.hasPattern=Cw("fill-extrusion",this.layers,i),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=ap(o),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:u,id:d,index:p,sourceLayerIndex:g}of t){const _=this.layers[0]._featureFilter.needGeometry,v=pc(u,_);if(!this.layers[0]._featureFilter.filter(new pr(this.zoom),v,o))continue;const b={id:d,sourceLayerIndex:g,index:p,geometry:_?v.geometry:Aa(u,o,c),properties:u.properties,type:u.type,patterns:{}},S=this.layoutVertexArray.length;this.hasPattern?this.features.push(Pw("fill-extrusion",this.layers,b,this.zoom,i)):this.addFeature(b,b.geometry,p,o,{},i.availableImages,c,i.brightness),i.featureIndex.insert(u,b.geometry,p,g,this.index,S)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(t,i,o,c,u,d){for(const p of this.features){const{geometry:g}=p;this.addFeature(p,g,p.index,i,o,c,u,d)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(t,i,o,c,u){const d=Object.keys(t).length!==0;if(d&&!this.stateDependentLayers.length)return;const p=d?this.stateDependentLayers:this.layers;this.programConfigurations.updatePaintArrays(t,i,p,o,c,u),this.groundEffect.update(t,i,p,o,c,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,DG),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=t.createVertexBuffer(this.layoutVertexExtArray,kG.members,!0)),this.groundEffect.upload(t)),this.groundEffect.uploadPaintProperties(t),this.programConfigurations.upload(t),this.uploaded=!0}uploadCentroid(t){this.groundEffect.uploadHiddenByLandmark(t),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,PG.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,i,o,c,u,d,p,g){const _=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(t,{})/this.tileToMeter,v=[new W(0,0),new W(Dt,Dt)],b=p.projection,S=b.name==="globe",E=KH[t.type]==="Polygon",A=new eL;A.centroidDataIndex=this.centroidData.length;const C=new tL,P=this.layers[0].paint.get("fill-extrusion-base").evaluate(t,{},c)<=0,k=this.layers[0].paint.get("fill-extrusion-height").evaluate(t,{},c);C.height=k,C.vertexArrayOffset=this.layoutVertexArray.length,C.groundVertexArrayOffset=this.groundEffect.vertexArray.length,S&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new m_);const L=Aw(i,500);for(let Z=L.length-1;Z>=0;Z--){const X=L[Z];(X.length===0||(j=X[0]).every(J=>J.x<=0)||j.every(J=>J.x>=Dt)||j.every(J=>J.y<=0)||j.every(J=>J.y>=Dt))&&L.splice(Z,1)}var j;let V;if(S)V=uL(L,v,c);else{V=[];for(const Z of L)V.push({polygon:Z,bounds:v})}const F=E?this.edgeRadius:0,U=F>0&&this.zoom<17,q=(Z,X)=>{if(Z.length===0)return!1;const J=Z[Z.length-1];return X.x===J.x&&X.y===J.y};for(const{polygon:Z,bounds:X}of V){let J=0,rt=0;for(const dt of Z)E&&!dt[0].equals(dt[dt.length-1])&&dt.push(dt[0]),rt+=E?dt.length-1:dt.length;const it=this.segments.prepareSegment((E?5:4)*rt,this.layoutVertexArray,this.indexArray);C.footprintSegIdx<0&&(C.footprintSegIdx=this.footprintSegments.length),C.polygonSegIdx<0&&(C.polygonSegIdx=this.polygonSegments.length);const ut={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},tt=new QO;if(tt.vertexOffset=this.footprintVertices.length,tt.indexOffset=3*this.footprintIndices.length,tt.ringIndices=[],E){const dt=[],gt=[];J=it.vertexLength;for(let ht=0;ht<Z.length;ht++){const pt=Z[ht];pt.length&&ht!==0&&gt.push(dt.length/2);const Et=[];let At,Mt;At=pt[1].sub(pt[0])._perp()._unit(),tt.ringIndices.push(pt.length-1);for(let Lt=1;Lt<pt.length;Lt++){const Nt=pt[Lt],jt=pt[Lt===pt.length-1?1:Lt+1],It=Nt.clone();if(F){Mt=jt.sub(Nt)._perp()._unit();const Gt=At.add(Mt)._unit(),ce=F*Math.min(4,1/(At.x*Gt.x+At.y*Gt.y));It.x+=ce*Gt.x,It.y+=ce*Gt.y,It.x=Math.round(It.x),It.y=Math.round(It.y),At=Mt}!P||F!==0&&!U||q(Et,It)||Et.push(It),Mp(this.layoutVertexArray,It.x,It.y,0,0,1,1,0),it.vertexLength++,this.footprintVertices.emplaceBack(Nt.x,Nt.y),dt.push(Nt.x,Nt.y),S&&Ap(this.layoutVertexExtArray,b.projectTilePoint(It.x,It.y,c),b.upVector(c,It.x,It.y))}P&&(F===0||U)&&(Et.length!==0&&q(Et,Et[0])&&Et.pop(),this.groundEffect.addData(Et,X,_))}const xt=F_(dt,gt);for(let ht=0;ht<xt.length;ht+=3)this.footprintIndices.emplaceBack(tt.vertexOffset+xt[ht+0],tt.vertexOffset+xt[ht+1],tt.vertexOffset+xt[ht+2]),this.indexArray.emplaceBack(J+xt[ht],J+xt[ht+2],J+xt[ht+1]),it.primitiveLength++;tt.indexCount+=xt.length,tt.vertexCount+=this.footprintVertices.length-tt.vertexOffset}for(let dt=0;dt<Z.length;dt++){const gt=Z[dt];A.startRing(C,gt[0]);let xt=gt.length>4&&aL(gt[gt.length-2],gt[0],gt[1]),ht=F?iq(gt[gt.length-2],gt[0],gt[1],F):0;const pt=[];let Et,At,Mt;At=gt[1].sub(gt[0])._perp()._unit();let Lt=!0;for(let Nt=1,jt=0;Nt<gt.length;Nt++){let It=gt[Nt-1],Gt=gt[Nt];const ce=gt[Nt===gt.length-1?1:Nt+1];if(A.appendEdge(C,Gt,It),nS(Gt,It,X)){F&&(At=ce.sub(Gt)._perp()._unit(),Lt=!Lt);continue}const ue=Gt.sub(It)._perp(),ye=ue.x/(Math.abs(ue.x)+Math.abs(ue.y)),be=ue.y>0?1:0,We=It.dist(Gt);if(jt+We>32768&&(jt=0),F){Mt=ce.sub(Gt)._perp()._unit();let He=sL(It,Gt,ce,iL(At,Mt),F);isNaN(He)&&(He=0);const Ue=Gt.sub(It)._unit();It=It.add(Ue.mult(ht))._round(),Gt=Gt.add(Ue.mult(-He))._round(),ht=He,At=Mt,P&&this.zoom>=17&&(q(pt,It)||pt.push(It),q(pt,Gt)||pt.push(Gt))}const Pe=it.vertexLength,Tn=gt.length>4&&aL(It,Gt,ce);let fn=lL(jt,xt,Lt);if(Mp(this.layoutVertexArray,It.x,It.y,ye,be,0,0,fn),Mp(this.layoutVertexArray,It.x,It.y,ye,be,0,1,fn),jt+=We,fn=lL(jt,Tn,!Lt),xt=Tn,Mp(this.layoutVertexArray,Gt.x,Gt.y,ye,be,0,0,fn),Mp(this.layoutVertexArray,Gt.x,Gt.y,ye,be,0,1,fn),it.vertexLength+=4,this.indexArray.emplaceBack(Pe+0,Pe+1,Pe+2),this.indexArray.emplaceBack(Pe+1,Pe+3,Pe+2),it.primitiveLength+=2,F){const He=J+(Nt===1?gt.length-2:Nt-2),Ue=Nt===1?J:He+1;if(this.indexArray.emplaceBack(Pe+1,He,Pe+3),this.indexArray.emplaceBack(He,Ue,Pe+3),it.primitiveLength+=2,Et===void 0&&(Et=Pe),!nS(ce,gt[Nt],X)){const Re=Nt===gt.length-1?Et:it.vertexLength;this.indexArray.emplaceBack(Pe+2,Pe+3,Re),this.indexArray.emplaceBack(Pe+3,Re+1,Re),this.indexArray.emplaceBack(Pe+3,Ue,Re+1),it.primitiveLength+=3}Lt=!Lt}if(S){const He=this.layoutVertexExtArray,Ue=b.projectTilePoint(It.x,It.y,c),Re=b.projectTilePoint(Gt.x,Gt.y,c),gn=b.upVector(c,It.x,It.y),bn=b.upVector(c,Gt.x,Gt.y);Ap(He,Ue,gn),Ap(He,Ue,gn),Ap(He,Re,bn),Ap(He,Re,bn)}}E&&(J+=gt.length-1),P&&F&&this.zoom>=17&&(pt.length!==0&&q(pt,pt[0])&&pt.pop(),this.groundEffect.addData(pt,X,_,F>0))}this.footprintSegments.push(tt),ut.triangleCount=this.indexArray.length-ut.triangleArrayOffset,this.polygonSegments.push(ut),++C.footprintSegLen,++C.polygonSegLen}if(C.vertexCount=this.layoutVertexArray.length-C.vertexArrayOffset,C.groundVertexCount=this.groundEffect.vertexArray.length-C.groundVertexArrayOffset,C.vertexCount!==0){if(C.centroidXY=A.borders?JO:this.encodeCentroid(A,C),this.centroidData.push(C),A.borders){this.featuresOnBorder.push(A);const Z=this.featuresOnBorder.length-1;for(let X=0;X<A.borders.length;X++)A.borders[X][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[X].push(Z)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,o,u,d,c,g),this.groundEffect.addPaintPropertiesData(t,o,u,d,c,g),this.maxHeight=Math.max(this.maxHeight,k)}}sortBorders(){for(let t=0;t<this.borderFeatureIndices.length;t++)this.borderFeatureIndices[t].sort((i,o)=>this.featuresOnBorder[i].borders[t][0]-this.featuresOnBorder[o].borders[t][0])}splitToSubtiles(){const t=[];for(let p=0;p<this.centroidData.length;p++){const g=this.centroidData[p],_=+(g.min.y+g.max.y>Dt),v=2*_+(+(g.min.x+g.max.x>Dt)^_);for(let b=0;b<g.polygonSegLen;b++){const S=g.polygonSegIdx+b;t.push({centroidIdx:p,subtile:v,polygonSegmentIdx:S,triangleSegmentIdx:this.polygonSegments[S].triangleSegIdx})}}const i=new Hr;t.sort((p,g)=>p.triangleSegmentIdx===g.triangleSegmentIdx?p.subtile-g.subtile:p.triangleSegmentIdx-g.triangleSegmentIdx);let o=0,c=0,u=0;for(const p of t){if(p.triangleSegmentIdx!==o)break;u++}const d=t.length;for(;c!==t.length;){o=t[c].triangleSegmentIdx;let p=0,g=c,_=c;for(let v=g;v<u&&t[v].subtile===p;v++)_++;for(;g!==u;){const v=t[g];p=v.subtile;const b=this.centroidData[v.centroidIdx].min.clone(),S=this.centroidData[v.centroidIdx].max.clone(),E={vertexOffset:this.segments.segments[o].vertexOffset,primitiveOffset:i.length,vertexLength:this.segments.segments[o].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let A=g;A<_;A++){const C=t[A],P=this.polygonSegments[C.polygonSegmentIdx],k=this.centroidData[C.centroidIdx].min,L=this.centroidData[C.centroidIdx].max,j=this.indexArray.uint16;for(let V=P.triangleArrayOffset;V<P.triangleArrayOffset+P.triangleCount;V++)i.emplaceBack(j[3*V],j[3*V+1],j[3*V+2]);E.primitiveLength+=P.triangleCount,b.x=Math.min(b.x,k.x),b.y=Math.min(b.y,k.y),S.x=Math.max(S.x,L.x),S.y=Math.max(S.y,L.y)}E.primitiveLength>0&&this.triangleSubSegments.push({segment:E,min:b,max:S}),g=_;for(let A=g;A<u&&t[A].subtile===t[g].subtile;A++)_++}c=u;for(let v=c;v<d&&t[v].triangleSegmentIdx===t[c].triangleSegmentIdx;v++)u++}i._trim(),this.indexArray=i}getVisibleSegments(t,i,o){let c=0,u=0;const d=1<<t.canonical.z;if(i){const C=i.getMinMaxForTile(t);C&&(c=C.min,u=C.max)}u+=this.maxHeight;const p=t.toUnwrapped();let g;const _=[p.canonical.x/d+p.wrap,p.canonical.y/d],v=[(p.canonical.x+1)/d+p.wrap,(p.canonical.y+1)/d],b=new Bn,S=(C,P,k)=>[C[0]*(1-k[0])+P[0]*k[0],C[1]*(1-k[1])+P[1]*k[1]],E=[],A=[];for(const C of this.triangleSubSegments){E[0]=C.min.x/Dt,E[1]=C.min.y/Dt,A[0]=C.max.x/Dt,A[1]=C.max.y/Dt;const P=S(_,v,E),k=S(_,v,A);if(new nr([P[0],P[1],c],[k[0],k[1],u]).intersectsPrecise(o)===0){g&&(b.segments.push(g),g=void 0);continue}const L=C.segment;g&&g.vertexOffset!==L.vertexOffset&&(b.segments.push(g),g=void 0),g?(g.vertexLength+=L.vertexLength,g.primitiveLength+=L.primitiveLength):g={vertexOffset:L.vertexOffset,primitiveLength:L.primitiveLength,vertexLength:L.vertexLength,primitiveOffset:L.primitiveOffset,sortKey:void 0,vaos:{}}}return g&&b.segments.push(g),b}encodeCentroid(t,i){const o=t.centroid(),c=i.span(),u=Math.min(7,Math.round(c.x*this.tileToMeter/10)),d=Math.min(7,Math.round(c.y*this.tileToMeter/10));return new W(Ot(o.x,1,Dt-1)<<3|u,Ot(o.y,1,Dt-1)<<3|d)}showCentroid(t){const i=this.centroidData[t.centroidDataIndex];i.flags&=ka,i.centroidXY.x=0,i.centroidXY.y=0,this.writeCentroidToBuffer(i)}writeCentroidToBuffer(t){this.groundEffect.updateHiddenByLandmark(t);const i=t.vertexArrayOffset,o=t.vertexCount+t.vertexArrayOffset,c=t.flags&ka?JO:t.centroidXY,u=this.centroidVertexArray.geta_centroid_pos0(i);if(this.centroidVertexArray.geta_centroid_pos1(i)!==c.y||u!==c.x){for(let d=i;d<o;++d)this.centroidVertexArray.emplace(d,c.x,c.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const t of this.centroidData)this.writeCentroidToBuffer(t)}updateReplacement(t,i){if(i.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=i.updateTime;const o=i.getReplacementRegionsForTile(t.toUnwrapped());if(function(u,d){if(u.length!==d.length)return!1;for(let p=0;p<u.length;p++)if(u[p].sourceId!==d[p].sourceId||!qO(u[p],d[p]))return!1;return!0}(this.activeReplacements,o))return;if(this.activeReplacements=o,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const u of this.centroidData)u.flags&=2147483647;const c=[];for(const u of this.activeReplacements){const d=Math.pow(2,u.footprintTileId.canonical.z-t.canonical.z);for(const p of this.centroidData)if(!(p.flags&ka||u.min.x>p.max.x||p.min.x>u.max.x||u.min.y>p.max.y||p.min.y>u.max.y))for(let g=0;g<p.footprintSegLen;g++){const _=this.footprintSegments[p.footprintSegIdx+g];if(c.length=0,sq(this.footprintVertices,_.vertexOffset,_.vertexCount,u.footprintTileId.canonical,t.canonical,c),YO(u.footprint,c,this.footprintIndices.uint16,_.indexOffset,_.indexCount,-_.vertexOffset,-d)){p.flags|=ka;break}}}for(const u of this.centroidData)this.writeCentroidToBuffer(u);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(t,i,o){let c=!1;for(let u=0;u<o.footprintSegLen;u++){const d=this.footprintSegments[o.footprintSegIdx+u];let p=0;for(const g of d.ringIndices){for(let _=p,v=g+p-1;_<g+p;v=_++){const b=this.footprintVertices.int16[2*(_+d.vertexOffset)+0],S=this.footprintVertices.int16[2*(_+d.vertexOffset)+1],E=this.footprintVertices.int16[2*(v+d.vertexOffset)+1];S>i!=E>i&&t<(this.footprintVertices.int16[2*(v+d.vertexOffset)+0]-b)*(i-S)/(E-S)+b&&(c=!c)}p=g}}return c}getHeightAtTileCoord(t,i){let o=Number.NEGATIVE_INFINITY,c=!0;const u=4*(t+Dt)*Dt+(i+Dt);if(this.partLookup.hasOwnProperty(u)){const d=this.partLookup[u];return d?{height:d.height,hidden:!!(d.flags&ka)}:void 0}for(const d of this.centroidData)t>d.max.x||d.min.x>t||i>d.max.y||d.min.y>i||this.footprintContainsPoint(t,i,d)&&d&&d.height>o&&(o=d.height,this.partLookup[u]=d,c=!!(d.flags&ka));if(o!==Number.NEGATIVE_INFINITY)return{height:o,hidden:c};this.partLookup[u]=void 0}}function iL(n,t){const i=n.add(t)._unit();return n.x*i.x+n.y*i.y}function iq(n,t,i,o){const c=t.sub(n)._perp()._unit(),u=i.sub(t)._perp()._unit();return sL(n,t,i,iL(c,u),o)}function sL(n,t,i,o,c){const u=Math.sqrt(1-o*o);return Math.min(n.dist(t)/3,t.dist(i)/3,c*u/o)}function nS(n,t,i){return n.x<i[0].x&&t.x<i[0].x||n.x>i[1].x&&t.x>i[1].x||n.y<i[0].y&&t.y<i[0].y||n.y>i[1].y&&t.y>i[1].y}function oL(n,t){return n.x<t[0].x||n.x>t[1].x||n.y<t[0].y||n.y>t[1].y}function aL(n,t,i){if(n.x<0||n.x>=Dt||t.x<0||t.x>=Dt||i.x<0||i.x>=Dt)return!1;const o=i.sub(t),c=o.perp(),u=n.sub(t);return(o.x*u.x+o.y*u.y)/Math.sqrt((o.x*o.x+o.y*o.y)*(u.x*u.x+u.y*u.y))>-.866&&c.x*u.x+c.y*u.y<0}function lL(n,t,i){const o=t?2|n:-3&n;return i?1|o:-2&o}function cL(){const n=Math.PI/32,t=Math.tan(n),i=ud;return i*Math.sqrt(1+2*t*t)-i}function uL(n,t,i){const o=1<<i.z,c=Ls(i.x/o),u=Ls((i.x+1)/o),d=qr(i.y/o),p=qr((i.y+1)/o);return function(g,_,v,b,S=0,E){const A=[];if(!g.length||!v||!b)return A;const C=(U,q)=>{for(const Z of U)A.push({polygon:Z,bounds:q})},P=Math.ceil(Math.log2(v)),k=Math.ceil(Math.log2(b)),L=P-k,j=[];for(let U=0;U<Math.abs(L);U++)j.push(L>0?0:1);for(let U=0;U<Math.min(P,k);U++)j.push(0),j.push(1);let V=g;if(V=U_(V,_[0].y-S,_[1].y+S,1),V=U_(V,_[0].x-S,_[1].x+S,0),!V.length)return A;const F=[];for(j.length?F.push({polygons:V,bounds:_,depth:0}):C(V,_);F.length;){const U=F.pop(),q=U.depth,Z=j[q],X=U.bounds[0],J=U.bounds[1],rt=Z===0?X.x:X.y,it=Z===0?J.x:J.y,ut=E?E(Z,rt,it):.5*(rt+it),tt=U_(U.polygons,rt-S,ut+S,Z),dt=U_(U.polygons,ut-S,it+S,Z);if(tt.length){const gt=[X,new W(Z===0?ut:J.x,Z===1?ut:J.y)];j.length>q+1?F.push({polygons:tt,bounds:gt,depth:q+1}):C(tt,gt)}if(dt.length){const gt=[new W(Z===0?ut:X.x,Z===1?ut:X.y),J];j.length>q+1?F.push({polygons:dt,bounds:gt,depth:q+1}):C(dt,gt)}}return A}(n,t,Math.ceil((u-c)/11.25),Math.ceil((d-p)/11.25),1,(g,_,v)=>{if(g===0)return .5*(_+v);{const b=qr((i.y+_/Dt)/o);return(ui(.5*(qr((i.y+v/Dt)/o)+b))*o-i.y)*Dt}})}function sq(n,t,i,o,c,u){const d=Math.pow(2,o.z-c.z);for(let p=0;p<i;p++){let g=n.int16[2*(p+t)+0],_=n.int16[2*(p+t)+1];g=(g+c.x*Dt)*d-o.x*Dt,_=(_+c.y*Dt)*d-o.y*Dt,u.push(new W(g,_))}}Se(Cp,"FillExtrusionBucket",{omit:["layers","features"]}),Se(tL,"PartData"),Se(QO,"FootprintSegment"),Se(eL,"BorderCentroidData"),Se(rL,"GroundEffect");const oq=new Tr({visibility:new te(vt["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new te(vt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var aq={paint:new Tr({"fill-extrusion-opacity":new te(vt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ze(vt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new te(vt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new te(vt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ze(vt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ze(vt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ze(vt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new te(vt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new te(vt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new te(vt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new te(vt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new te(vt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new te(vt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new te(vt["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new te(vt["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new ze(vt["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new ze(vt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new te(vt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new te(vt["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new te(vt["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new te(vt["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new te(vt["paint_fill-extrusion"]["fill-extrusion-emissive-strength"])}),layout:oq};class Md extends W{constructor(t,i,o){super(t,i),this.z=o}}function Pp(n,t){return n.x*t.x+n.y*t.y}function hL(n,t){if(n.length===1){let i=0;const o=t[i++];let c;for(;!c||o.equals(c);)if(c=t[i++],!c)return 1/0;for(;i<t.length;i++){const u=t[i],d=n[0],p=c.sub(o),g=u.sub(o),_=d.sub(o),v=Pp(p,p),b=Pp(p,g),S=Pp(g,g),E=Pp(_,p),A=Pp(_,g),C=v*S-b*b,P=(S*E-b*A)/C,k=(v*A-b*E)/C,L=o.z*(1-P-k)+c.z*P+u.z*k;if(isFinite(L))return L}return 1/0}{let i=1/0;for(const o of t)i=Math.min(i,o.z);return i}}function dL(n,t,i,o,c,u,d,p){const g=d*c.getElevationAt(n,t,!0,!0),_=u[0]!==0,v=_?u[1]===0?d*(u[0]/7-450):d*function(b,S,E){const A=Math.floor(S[0]/8),C=Math.floor(S[1]/8),P=10*(S[0]-8*A),k=10*(S[1]-8*C),L=b.getElevationAt(A,C,!0,!0),j=b.getMeterToDEM(E),V=Math.floor(.5*(P*j-1)),F=Math.floor(.5*(k*j-1)),U=b.tileCoordToPixel(A,C),q=2*V+1,Z=2*F+1,X=function(dt,gt,xt,ht,pt){return[dt.getElevationAtPixel(gt,xt,!0),dt.getElevationAtPixel(gt+pt,xt,!0),dt.getElevationAtPixel(gt,xt+pt,!0),dt.getElevationAtPixel(gt+ht,xt+pt,!0)]}(b,U.x-V,U.y-F,q,Z),J=Math.abs(X[0]-X[1]),rt=Math.abs(X[2]-X[3]),it=Math.abs(X[0]-X[2])+Math.abs(X[1]-X[3]),ut=Math.min(.25,.5*j*(J+rt)/q),tt=Math.min(.25,.5*j*it/Z);return L+Math.max(ut*P,tt*k)}(c,u,p):g;return{base:g+(i===0)?-1:i,top:_?Math.max(v+o,g+i+2):g+o}}const lq=new Tr({"line-cap":new ze(vt.layout_line["line-cap"]),"line-join":new ze(vt.layout_line["line-join"]),"line-miter-limit":new te(vt.layout_line["line-miter-limit"]),"line-round-limit":new te(vt.layout_line["line-round-limit"]),"line-sort-key":new ze(vt.layout_line["line-sort-key"]),visibility:new te(vt.layout_line.visibility)});var fL={paint:new Tr({"line-opacity":new ze(vt.paint_line["line-opacity"]),"line-color":new ze(vt.paint_line["line-color"]),"line-translate":new te(vt.paint_line["line-translate"]),"line-translate-anchor":new te(vt.paint_line["line-translate-anchor"]),"line-width":new ze(vt.paint_line["line-width"]),"line-gap-width":new ze(vt.paint_line["line-gap-width"]),"line-offset":new ze(vt.paint_line["line-offset"]),"line-blur":new ze(vt.paint_line["line-blur"]),"line-dasharray":new ze(vt.paint_line["line-dasharray"]),"line-pattern":new ze(vt.paint_line["line-pattern"]),"line-gradient":new Kf(vt.paint_line["line-gradient"]),"line-trim-offset":new te(vt.paint_line["line-trim-offset"]),"line-emissive-strength":new te(vt.paint_line["line-emissive-strength"]),"line-border-width":new ze(vt.paint_line["line-border-width"]),"line-border-color":new ze(vt.paint_line["line-border-color"])}),layout:lq};const cq=(n,t,i,o,c,u,d)=>{const p=n.transform,g=p.calculatePixelsToTileUnitsMatrix(t);return{u_matrix:mL(n,t,i,o),u_pixels_to_tile_units:g,u_device_pixel_ratio:u,u_units_to_pixels:[1/p.pixelsToGLUnits[0],1/p.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:c,u_texsize:_L(i)&&t.lineAtlasTexture?t.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:pL(t,n.transform),u_alpha_discard_threshold:0,u_trim_offset:d,u_emissive_strength:i.paint.get("line-emissive-strength")}},uq=(n,t,i,o,c)=>{const u=n.transform;return{u_matrix:mL(n,t,i,o),u_texsize:t.imageAtlasTexture?t.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:u.calculatePixelsToTileUnitsMatrix(t),u_device_pixel_ratio:c,u_image:0,u_tile_units_to_pixels:pL(t,u),u_units_to_pixels:[1/u.pixelsToGLUnits[0],1/u.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function pL(n,t){return 1/ju(n,1,t.tileZoom)}function mL(n,t,i,o){return n.translatePosMatrix(o||t.tileID.projMatrix,t,i.paint.get("line-translate"),i.paint.get("line-translate-anchor"))}const gL=n=>{const t=[];_L(n)&&t.push("RENDER_LINE_DASH"),n.paint.get("line-gradient")&&t.push("RENDER_LINE_GRADIENT");const i=n.paint.get("line-trim-offset");return i[0]===0&&i[1]===0||t.push("RENDER_LINE_TRIM_OFFSET"),n.paint.get("line-border-width").constantOr(1)!==0&&t.push("RENDER_LINE_BORDER"),t};function _L(n){const t=n.paint.get("line-dasharray").value;return t.value||t.kind!=="constant"}const yL=new class extends ze{possiblyEvaluate(n,t){return t=new pr(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,transition:t.transition}),super.possiblyEvaluate(n,t)}evaluate(n,t,i,o){return t=Ct({},t,{zoom:Math.floor(t.zoom)}),super.evaluate(n,t,i,o)}}(fL.paint.properties["line-width"].specification);function vL(n,t){return t>0?t+2*n:n}yL.useIntegerZoom=!0;const hq=new Tr({visibility:new te(vt.layout_background.visibility)});var dq={paint:new Tr({"background-color":new te(vt.paint_background["background-color"]),"background-pattern":new te(vt.paint_background["background-pattern"]),"background-opacity":new te(vt.paint_background["background-opacity"]),"background-emissive-strength":new te(vt.paint_background["background-emissive-strength"])}),layout:hq};const fq=new Tr({visibility:new te(vt.layout_raster.visibility)});var pq={paint:new Tr({"raster-opacity":new te(vt.paint_raster["raster-opacity"]),"raster-color":new Kf(vt.paint_raster["raster-color"]),"raster-color-mix":new te(vt.paint_raster["raster-color-mix"]),"raster-color-range":new te(vt.paint_raster["raster-color-range"]),"raster-hue-rotate":new te(vt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new te(vt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new te(vt.paint_raster["raster-brightness-max"]),"raster-saturation":new te(vt.paint_raster["raster-saturation"]),"raster-contrast":new te(vt.paint_raster["raster-contrast"]),"raster-resampling":new te(vt.paint_raster["raster-resampling"]),"raster-fade-duration":new te(vt.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new te(vt.paint_raster["raster-emissive-strength"]),"raster-array-band":new te(vt.paint_raster["raster-array-band"]),"raster-elevation":new te(vt.paint_raster["raster-elevation"])}),layout:fq};function xL(n,t,i,o,c,u,d,p){const g=[n,i,c,t,o,u,1,1,1],_=[d,p,1],v=bs.adjoint([],g),[b,S,E]=ct.transformMat3(_,_,bs.transpose(v,v));return bs.multiply(g,[b,0,0,0,S,0,0,0,E],g)}class Io extends Mn{constructor(t,i,o,c){super(),this.id=t,this.dispatcher=o,this.coordinates=i.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(c),this.options=i,this._dirty=!1}load(t,i){if(this._loaded=i||!1,this.fire(new Bt("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return t&&(this.coordinates=t),this._loaded=!0,void this._finishLoading();this._imageRequest=Ye(this.map._requestManager.transformRequest(this.url,zt.Image),(o,c)=>{if(this._imageRequest=null,this._loaded=!0,o)this.fire(new xe(o));else if(c){const{HTMLImageElement:u}=w;this.image=c instanceof u?Be.getImageData(c):c,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,t&&(this.coordinates=t),this._finishLoading()}})}loaded(){return this._loaded}updateImage(t){return t.url?(this._imageRequest&&t.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=t.url,this.load(t.coordinates,this._loaded),this):this}setTexture(t){if(!(t.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new cy(this.map.painter.context,t.handle),this.width=t.dimensions[0],this.height=t.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new Bt("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof cy||this.texture.destroy()}setCoordinates(t){if(this.coordinates=t,this._boundsArray=void 0,!t.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let i=t[0][1],o=t[0][1];for(const u of t)u[1]>o&&(o=u[1]),u[1]<i&&(i=u[1]);const c=(o+i)/2;if(c>Ir?this.onNorthPole=!0:c<-Ir&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const u=t.map(vn.fromLngLat);this.tileID=function(d){let p=1/0,g=1/0,_=-1/0,v=-1/0;for(const A of d)p=Math.min(p,A.x),g=Math.min(g,A.y),_=Math.max(_,A.x),v=Math.max(v,A.y);const b=Math.max(_-p,v-g),S=Math.max(0,Math.floor(-Math.log(b)/Math.LN2)),E=Math.pow(2,S);return new Mo(S,Math.floor((p+_)/2*E),Math.floor((g+v)/2*E))}(u),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new Bt("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(t){for(const g in this.tiles){const _=this.tiles[g];_.state!=="loaded"&&(_.state="loaded",_.texture=this.texture)}if(this._boundsArray)return;const i=Bu(this.tileID,this.map.transform.projection),[o,c,u,d]=this.coordinates.map(g=>{const _=i.projection.project(g[0],g[1]);return lO(i,_)._round()});this.perspectiveTransform=function(g,_,v,b,S,E,A,C,P,k){const L=xL(0,0,g,0,0,_,g,_),j=xL(v,b,S,E,A,C,P,k);return bs.multiply(j,bs.adjoint(L,L),j),[j[6]/j[8]*g/Dt,j[7]/j[8]*_/Dt]}(this.width,this.height,o.x,o.y,c.x,c.y,d.x,d.y,u.x,u.y);const p=this._boundsArray=new Du;p.emplaceBack(o.x,o.y,0,0),p.emplaceBack(c.x,c.y,Dt,0),p.emplaceBack(d.x,d.y,0,Dt),p.emplaceBack(u.x,u.y,Dt,Dt),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=t.createVertexBuffer(p,Ww.members),this.boundsSegments=Bn.simpleSegment(0,0,4,2)}prepare(){const t=Object.keys(this.tiles).length!==0;if(this.tileID&&!t)return;const i=this.map.painter.context,o=i.gl;!this._dirty||this.texture instanceof cy||(this.texture?this.texture.update(this.image):(this.texture=new _r(i,this.image,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE)),this._dirty=!1),t&&this._prepareData(i)}loadTile(t,i){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},i(null)):(t.state="errored",i(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class mq extends Qs{constructor(t){super(t,{}),this.implementation=t,t.slot&&(this.slot=t.slot)}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(t){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(t){this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)}onRemove(t){this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)}}const gq=new Tr({visibility:new te(vt.layout_sky.visibility)});var _q={paint:new Tr({"sky-type":new te(vt.paint_sky["sky-type"]),"sky-atmosphere-sun":new te(vt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new te(vt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new te(vt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new te(vt.paint_sky["sky-gradient-radius"]),"sky-gradient":new Kf(vt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new te(vt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new te(vt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new te(vt.paint_sky["sky-opacity"])}),layout:gq};function rS(n,t,i){const o=[0,0,1],c=Fi.identity([]);return Fi.rotateY(c,c,i?-st(n)+Math.PI:st(n)),Fi.rotateX(c,c,-st(t)),ct.transformQuat(o,o,c),ct.normalize(o,o)}var yq={paint:new Tr({})};const vq={circle:class extends Qs{constructor(n,t){super(n,rG,t)}createBucket(n){return new yw(n)}queryRadius(n){const t=n;return dd("circle-radius",this,t)+dd("circle-stroke-width",this,t)+D_(this.paint.get("circle-translate"))}queryIntersectsFeature(n,t,i,o,c,u,d,p){const g=lR(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),u.angle,n.pixelToTileUnitsFactor),_=this.paint.get("circle-radius").evaluate(t,i)+this.paint.get("circle-stroke-width").evaluate(t,i);return uR(n,o,u,d,p,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",g,_)}getProgramIds(){return["circle"]}getDefaultProgramParams(n,t){const i=cR(this);return{config:new Lu(this,t),defines:i,overrideFog:!1}}},heatmap:class extends Qs{createBucket(n){return new dR(n)}constructor(n,t){super(n,uG,t),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(n){n==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=R_({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(n){return dd("heatmap-radius",this,n)}queryIntersectsFeature(n,t,i,o,c,u,d,p){const g=this.paint.get("heatmap-radius").evaluate(t,i);return uR(n,o,u,d,p,!0,!0,new W(0,0),g)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(n,t){return n==="heatmap"?{config:new Lu(this,t),overrideFog:!1}:{}}},hillshade:class extends Qs{constructor(n,t){super(n,dG,t)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(n,t){return{overrideFog:!1}}},fill:class extends Qs{constructor(n,t){super(n,MG,t)}getProgramIds(){const n=this.paint.get("fill-pattern"),t=n&&n.constantOr(1),i=[t?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&i.push(t&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),i}getDefaultProgramParams(n,t){return{config:new Lu(this,t),overrideFog:!1}}recalculate(n,t){super.recalculate(n,t);const i=this.paint._values["fill-outline-color"];i.value.kind==="constant"&&i.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(n){return new B_(n)}queryRadius(){return D_(this.paint.get("fill-translate"))}queryIntersectsFeature(n,t,i,o,c,u){return!n.queryGeometry.isAboveHorizon&&rR(aR(n.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),u.angle,n.pixelToTileUnitsFactor),o)}isTileClipped(){return!0}},"fill-extrusion":class extends Qs{constructor(n,t){super(n,aq,t),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(n){return new Cp(n)}queryRadius(){return D_(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return!0}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(n,t,i,o,c,u,d,p,g){const _=lR(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),u.angle,n.pixelToTileUnitsFactor),v=this.paint.get("fill-extrusion-height").evaluate(t,i),b=this.paint.get("fill-extrusion-base").evaluate(t,i),S=[0,0],E=p&&u.elevation,A=u.elevation?u.elevation.exaggeration():1,C=n.tile.getBucket(this);if(E&&C instanceof Cp){const V=C.centroidVertexArray,F=g+1;F<V.length&&(S[0]=V.geta_centroid_pos0(F),S[1]=V.geta_centroid_pos1(F))}if(S[0]===0&&S[1]===1)return!1;u.projection.name==="globe"&&(o=uL([o],[new W(0,0),new W(Dt,Dt)],n.tileID.canonical).map(V=>V.polygon).flat());const P=E?p:null,[k,L]=function(V,F,U,q,Z,X,J,rt,it,ut,tt){return V.projection.name==="globe"?function(dt,gt,xt,ht,pt,Et,At,Mt,Lt,Nt,jt){const It=[],Gt=[],ce=dt.projection.upVectorScale(jt,dt.center.lat,dt.worldSize).metersToTile,ue=[0,0,0,1],ye=[0,0,0,1],be=(Pe,Tn,fn,He)=>{Pe[0]=Tn,Pe[1]=fn,Pe[2]=He,Pe[3]=1},We=cL();xt>0&&(xt+=We),ht+=We;for(const Pe of gt){const Tn=[],fn=[];for(const He of Pe){const Ue=He.x+pt.x,Re=He.y+pt.y,gn=dt.projection.projectTilePoint(Ue,Re,jt),bn=dt.projection.upVector(jt,He.x,He.y);let sn=xt,Gn=ht;if(At){const kr=dL(Ue,Re,xt,ht,At,Mt,Lt,Nt);sn+=kr.base,Gn+=kr.top}xt!==0?be(ue,gn.x+bn[0]*ce*sn,gn.y+bn[1]*ce*sn,gn.z+bn[2]*ce*sn):be(ue,gn.x,gn.y,gn.z),be(ye,gn.x+bn[0]*ce*Gn,gn.y+bn[1]*ce*Gn,gn.z+bn[2]*ce*Gn),ct.transformMat4(ue,ue,Et),ct.transformMat4(ye,ye,Et),Tn.push(new Md(ue[0],ue[1],ue[2])),fn.push(new Md(ye[0],ye[1],ye[2]))}It.push(Tn),Gt.push(fn)}return[It,Gt]}(V,F,U,q,Z,X,J,rt,it,ut,tt):J?function(dt,gt,xt,ht,pt,Et,At,Mt,Lt){const Nt=[],jt=[],It=[0,0,0,1];for(const Gt of dt){const ce=[],ue=[];for(const ye of Gt){const be=ye.x+ht.x,We=ye.y+ht.y,Pe=dL(be,We,gt,xt,Et,At,Mt,Lt);It[0]=be,It[1]=We,It[2]=Pe.base,It[3]=1,jn.transformMat4(It,It,pt),It[3]=Math.max(It[3],1e-5);const Tn=new Md(It[0]/It[3],It[1]/It[3],It[2]/It[3]);It[0]=be,It[1]=We,It[2]=Pe.top,It[3]=1,jn.transformMat4(It,It,pt),It[3]=Math.max(It[3],1e-5);const fn=new Md(It[0]/It[3],It[1]/It[3],It[2]/It[3]);ce.push(Tn),ue.push(fn)}Nt.push(ce),jt.push(ue)}return[Nt,jt]}(F,U,q,Z,X,J,rt,it,ut):function(dt,gt,xt,ht,pt){const Et=[],At=[],Mt=pt[8]*gt,Lt=pt[9]*gt,Nt=pt[10]*gt,jt=pt[11]*gt,It=pt[8]*xt,Gt=pt[9]*xt,ce=pt[10]*xt,ue=pt[11]*xt;for(const ye of dt){const be=[],We=[];for(const Pe of ye){const Tn=Pe.x+ht.x,fn=Pe.y+ht.y,He=pt[0]*Tn+pt[4]*fn+pt[12],Ue=pt[1]*Tn+pt[5]*fn+pt[13],Re=pt[2]*Tn+pt[6]*fn+pt[14],gn=pt[3]*Tn+pt[7]*fn+pt[15],bn=He+Mt,sn=Ue+Lt,Gn=Re+Nt,kr=Math.max(gn+jt,1e-5),Vn=He+It,rr=Ue+Gt,Or=Re+ce,Dr=Math.max(gn+ue,1e-5);be.push(new Md(bn/kr,sn/kr,Gn/kr)),We.push(new Md(Vn/Dr,rr/Dr,Or/Dr))}Et.push(be),At.push(We)}return[Et,At]}(F,U,q,Z,X)}(u,o,b,v,_,d,P,S,A,u.center.lat,n.tileID.canonical),j=n.queryGeometry;return function(V,F,U){let q=1/0;rR(U,F)&&(q=hL(U,F[0]));for(let Z=0;Z<F.length;Z++){const X=F[Z],J=V[Z];for(let rt=0;rt<X.length-1;rt++){const it=X[rt],ut=[it,X[rt+1],J[rt+1],J[rt],it];nR(U,ut)&&(q=Math.min(q,hL(U,ut)))}}return q!==1/0&&q}(k,L,j.isPointQuery()?j.screenBounds:j.screenGeometry)}},line:class extends Qs{constructor(n,t){super(n,fL,t),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(n){if(n==="line-gradient"){const t=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=t._styleExpression&&t._styleExpression.expression instanceof $1,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(n,t){super.recalculate(n,t),this.paint._values["line-floorwidth"]=yL.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,n)}createBucket(n){return new ly(n)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(n,t){const i=gL(this);return{config:new Lu(this,t),defines:i,overrideFog:!1}}queryRadius(n){const t=n,i=vL(dd("line-width",this,t),dd("line-gap-width",this,t)),o=dd("line-offset",this,t);return i/2+Math.abs(o)+D_(this.paint.get("line-translate"))}queryIntersectsFeature(n,t,i,o,c,u){if(n.queryGeometry.isAboveHorizon)return!1;const d=aR(n.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),u.angle,n.pixelToTileUnitsFactor),p=n.pixelToTileUnitsFactor/2*vL(this.paint.get("line-width").evaluate(t,i),this.paint.get("line-gap-width").evaluate(t,i)),g=this.paint.get("line-offset").evaluate(t,i);return g&&(o=function(_,v){const b=[],S=new W(0,0);for(let E=0;E<_.length;E++){const A=_[E],C=[];for(let P=0;P<A.length;P++){const k=A[P],L=A[P+1],j=P===0?S:k.sub(A[P-1])._unit()._perp(),V=P===A.length-1?S:L.sub(k)._unit()._perp(),F=j._add(V)._unit();F._mult(1/(F.x*V.x+F.y*V.y)),C.push(F._mult(v)._add(k))}b.push(C)}return b}(o,g*n.pixelToTileUnitsFactor)),function(_,v,b){for(let S=0;S<v.length;S++){const E=v[S];if(_.length>=3){for(let A=0;A<E.length;A++)if(mc(_,E[A]))return!0}if(Q9(_,E,b))return!0}return!1}(d,o,p)}isTileClipped(){return!0}},symbol:ny,background:class extends Qs{constructor(n,t){super(n,dq,t)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(n,t){return{overrideFog:!1}}},raster:class extends Qs{constructor(n,t){super(n,pq,t),this._updateColorRamp()}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}isLayerDraped(n){return!(n&&n._source instanceof Io)||!n._source.onNorthPole&&!n._source.onSouthPole&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(n){n!=="raster-color"&&n!=="raster-color-range"||this._updateColorRamp()}_updateColorRamp(){if(!this.hasColorMap())return;const n=this._transitionablePaint._values["raster-color"].value.expression,[t,i]=this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0});this.colorRamp=R_({expression:n,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:t,end:i}],resolution:256}),this.colorRampTexture=null}},sky:class extends Qs{constructor(n,t){super(n,_q,t),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(n){n==="sky-gradient"?this._updateColorRamp():n!=="sky-atmosphere-sun"&&n!=="sky-atmosphere-halo-color"&&n!=="sky-atmosphere-color"&&n!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=R_({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(n){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const t=n.style.light.properties.get("position");return this._lightPosition.azimuthal!==t.azimuthal||this._lightPosition.polar!==t.polar}return!1}getCenter(n,t){if(this.paint.get("sky-type")==="atmosphere"){const o=this.paint.get("sky-atmosphere-sun"),c=!o,u=n.style.light,d=u.properties.get("position");return c&&u.properties.get("anchor")==="viewport"&&_t("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),c?rS(d.azimuthal,90-d.polar,t):rS(o[0],90-o[1],t)}const i=this.paint.get("sky-gradient-center");return rS(i[0],90-i[1],t)}isSky(){return!0}markSkyboxValid(n){this._skyboxInvalidated=!1,this._lightPosition=n.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const n=this.paint.get("sky-type");return n==="atmosphere"?["skyboxCapture","skybox"]:n==="gradient"?["skyboxGradient"]:null}},slot:class extends Qs{constructor(n,t){super(n,yq)}},model:class extends Qs{constructor(n,t){super(n,HH,t)}createBucket(n){return new UO(n)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(){return 0}queryIntersectsFeature(){return!1}_handleOverridablePaintPropertyUpdate(n,t,i){return!(!this.layout||t.isDataDriven()||i.isDataDriven()||n!=="model-color"&&n!=="model-color-mix-intensity"&&n!=="model-rotation"&&n!=="model-scale"&&n!=="model-translation"&&n!=="model-emissive-strength")}_isPropertyZoomDependent(n){const t=this._transitionablePaint._values[n];return t!=null&&t.value!=null&&t.value.expression!=null&&t.value.expression instanceof ec}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}}};function xy(n,t){return n.type==="custom"?new mq(n):new vq[n.type](n,t)}function xq(n){const{userImage:t}=n;return!!(t&&t.render&&t.render())&&(n.data.replace(new Uint8Array(t.data.buffer)),!0)}class bq extends Mn{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0}createScope(t){this.images[t]={},this.loaded[t]=!1,this.updatedImages[t]={},this.patterns[t]={},this.callbackDispatchedThisFrame[t]={},this.atlasImage[t]=new Fr({width:1,height:1})}isLoaded(){for(const t in this.loaded)if(!this.loaded[t])return!1;return!0}setLoaded(t,i){if(this.loaded[i]!==t&&(this.loaded[i]=t,t)){for(const{ids:o,callback:c}of this.requestors)this._notify(o,i,c);this.requestors=[]}}hasImage(t,i){return!!this.getImage(t,i)}getImage(t,i){return this.images[i][t]}addImage(t,i,o){this._validate(t,o)&&(this.images[i][t]=o)}_validate(t,i){let o=!0;return this._validateStretch(i.stretchX,i.data&&i.data.width)||(this.fire(new xe(new Error(`Image "${t}" has invalid "stretchX" value`))),o=!1),this._validateStretch(i.stretchY,i.data&&i.data.height)||(this.fire(new xe(new Error(`Image "${t}" has invalid "stretchY" value`))),o=!1),this._validateContent(i.content,i)||(this.fire(new xe(new Error(`Image "${t}" has invalid "content" value`))),o=!1),o}_validateStretch(t,i){if(!t)return!0;let o=0;for(const c of t){if(c[0]<o||c[1]<c[0]||i<c[1])return!1;o=c[1]}return!0}_validateContent(t,i){return!(t&&(t.length!==4||t[0]<0||i.data.width<t[0]||t[1]<0||i.data.height<t[1]||t[2]<0||i.data.width<t[2]||t[3]<0||i.data.height<t[3]||t[2]<t[0]||t[3]<t[1]))}updateImage(t,i,o){o.version=this.images[i][t].version+1,this.images[i][t]=o,this.updatedImages[i][t]=!0}removeImage(t,i){const o=this.images[i][t];delete this.images[i][t],delete this.patterns[i][t],o.userImage&&o.userImage.onRemove&&o.userImage.onRemove()}listImages(t){return Object.keys(this.images[t])}getImages(t,i,o){let c=!0;const u=!!this.loaded[i];if(!u)for(const d of t)this.images[i][d]||(c=!1);u||c?this._notify(t,i,o):this.requestors.push({ids:t,scope:i,callback:o})}getUpdatedImages(t){return this.updatedImages[t]}_notify(t,i,o){const c={};for(const u of t){this.images[i][u]||this.fire(new Bt("styleimagemissing",{id:u}));const d=this.images[i][u];d?c[u]={data:d.data.clone(),pixelRatio:d.pixelRatio,sdf:d.sdf,version:d.version,stretchX:d.stretchX,stretchY:d.stretchY,content:d.content,hasRenderCallback:!!(d.userImage&&d.userImage.render)}:_t(`Image "${u}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}o(null,c)}getPixelSize(t){const{width:i,height:o}=this.atlasImage[t];return{width:i,height:o}}getPattern(t,i){const o=this.patterns[i][t],c=this.getImage(t,i);if(!c)return null;if(o&&o.position.version===c.version)return o.position;if(o)o.position.version=c.version;else{const u={w:c.data.width+2,h:c.data.height+2,x:0,y:0},d=new Nw(u,c);this.patterns[i][t]={bin:u,position:d}}return this._updatePatternAtlas(i),this.patterns[i][t].position}bind(t,i){const o=t.gl;let c=this.atlasTexture[i];c?this.dirty&&(c.update(this.atlasImage[i]),this.dirty=!1):(c=new _r(t,this.atlasImage[i],o.RGBA),this.atlasTexture[i]=c),c.bind(o.LINEAR,o.CLAMP_TO_EDGE)}_updatePatternAtlas(t){const i=[];for(const d in this.patterns[t])i.push(this.patterns[t][d].bin);const{w:o,h:c}=zw(i),u=this.atlasImage[t];u.resize({width:o||1,height:c||1});for(const d in this.patterns[t]){const{bin:p}=this.patterns[t][d],g=p.x+1,_=p.y+1,v=this.images[t][d].data,b=v.width,S=v.height;Fr.copy(v,u,{x:0,y:0},{x:g,y:_},{width:b,height:S}),Fr.copy(v,u,{x:0,y:S-1},{x:g,y:_-1},{width:b,height:1}),Fr.copy(v,u,{x:0,y:0},{x:g,y:_+S},{width:b,height:1}),Fr.copy(v,u,{x:b-1,y:0},{x:g-1,y:_},{width:1,height:S}),Fr.copy(v,u,{x:0,y:0},{x:g+b,y:_},{width:1,height:S})}this.dirty=!0}beginFrame(){for(const t in this.images)this.callbackDispatchedThisFrame[t]={}}dispatchRenderCallbacks(t,i){for(const o of t){if(this.callbackDispatchedThisFrame[i][o])continue;this.callbackDispatchedThisFrame[i][o]=!0;const c=this.images[i][o];xq(c)&&this.updateImage(o,i,c)}}}const wq=new Tr({anchor:new te(vt.light.anchor),position:new class{constructor(n){this.specification=n}possiblyEvaluate(n,t){return ge(n.expression.evaluate(t))}interpolate(n,t,i){return{x:qe(n.x,t.x,i),y:qe(n.y,t.y,i),z:qe(n.z,t.z,i),azimuthal:qe(n.azimuthal,t.azimuthal,i),polar:qe(n.polar,t.polar,i)}}}(vt.light.position),color:new te(vt.light.color),intensity:new te(vt.light.intensity)});class bL extends Mn{constructor(t,i="flat"){super(),this._transitionable=new Xf(wq),this.setLight(t,i),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,i,o={}){this._validate(W7,t,o)||(this._transitionable.setTransitionOrValue(t),this.id=i)}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,i,o){return(!o||o.validate!==!1)&&a_(this,t.call(td,Ct({value:i,style:{glyphs:!0,sprite:!0},styleSpec:vt})))}}const Sq=new Tr({source:new te(vt.terrain.source),exaggeration:new te(vt.terrain.exaggeration)});let Tq=class extends Mn{constructor(n,t,i,o){super(),this.scope=i,this._transitionable=new Xf(Sq,o),this._transitionable.setTransitionOrValue(n,o),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=t}get(){return this._transitionable.serialize()}set(n,t){this._transitionable.setTransitionOrValue(n,t)}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}getExaggeration(n){return this._transitioning.possiblyEvaluate(new pr(n)).get("exaggeration")}isZoomDependent(){const n=this._transitionable._values.exaggeration;return n!=null&&n.value!=null&&n.value.expression!=null&&n.value.expression instanceof ec}};const wL=45,SL=65,$u=.05;function by(n,t,i,o){const c=Me(wL,SL,i),[u,d]=TL(n,o);let p=1-Math.min(1,Math.exp((t-u)/(d-u)*-6));return p*=p*p,p=Math.min(1,1.00747*p),p*c*n.alpha}function TL(n,t){const i=.5/Math.tan(.5*t);return[n.range[0]+i,n.range[1]+i]}function EL(n,t,i,o,c){const u=ct.transformMat4([],[t,i,o],c.mercatorFogMatrix);return by(n,ct.length(u),c.pitch,c._fov)}function ML(n,t,i,o,c,u,d){const p=[[i,o,0],[c,o,0],[c,u,0],[i,u,0]];let g=Number.MAX_VALUE,_=-Number.MAX_VALUE;for(const v of p){const b=ct.transformMat4([],v,t),S=ct.length(b);g=Math.min(g,S),_=Math.max(_,S)}return[by(n,g,d.pitch,d._fov),by(n,_,d.pitch,d._fov)]}const Eq=new Tr({range:new te(vt.fog.range),color:new te(vt.fog.color),"high-color":new te(vt.fog["high-color"]),"space-color":new te(vt.fog["space-color"]),"horizon-blend":new te(vt.fog["horizon-blend"]),"star-intensity":new te(vt.fog["star-intensity"]),"vertical-range":new te(vt.fog["vertical-range"])});class Mq extends Mn{constructor(t,i){super(),this._transitionable=new Xf(Eq),this.set(t),this._transitioning=this._transitionable.untransitioned(),this._transform=i}get state(){const t=this._transform,i=t.projection.name==="globe",o=vi(t.zoom),c=this.properties.get("range"),u=[.5,3];return{range:i?[qe(u[0],c[0],o),qe(u[1],c[1],o)]:c,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(t,i={}){if(this._validate(Z7,t,i))return;const o=Ct({},t);for(const c of Object.keys(vt.fog))o[c]===void 0&&(o[c]=vt.fog[c].default);this._transitionable.setTransitionOrValue(o)}getOpacity(t){if(!this._transform.projection.supportsFog)return 0;const i=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:Me(wL,SL,t))*i.a}getOpacityAtLatLng(t,i){return this._transform.projection.supportsFog?function(o,c,u){const d=vn.fromLngLat(c),p=u.elevation?u.elevation.getAtPointOrZero(d):0;return EL(o,d.x,d.y,p,u)}(this.state,t,i):0}getOpacityForTile(t){if(!this._transform.projection.supportsFog)return[1,1];const i=this._transform.calculateFogTileMatrix(t.toUnwrapped());return ML(this.state,i,0,0,Dt,Dt,this._transform)}getOpacityForBounds(t,i,o,c,u){return this._transform.projection.supportsFog?ML(this.state,t,i,o,c,u,this._transform):[1,1]}getFovAdjustedRange(t){return this._transform.projection.supportsFog?TL(this.state,t):[0,1]}isVisibleOnFrustum(t){if(!this._transform.projection.supportsFog)return!1;const i=[4,5,6,7];for(const o of i){const c=t.points[o];let u;if(c[2]>=0)u=c;else{const d=t.points[o-4];u=tI(d,c,d[2]/(d[2]-c[2]))}if(EL(this.state,u[0],u[1],0,this._transform)>=$u)return!0}return!1}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,i,o){return(!o||o.validate!==!1)&&a_(this,t.call(td,Ct({value:i,style:{glyphs:!0,sprite:!0},styleSpec:vt})))}}class Aq{constructor(t){this._callback=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class Cq{constructor(){this.tasks={},this.taskQueue=[],Ne(["process"],this),this.invoker=new Aq(this.process),this.nextId=0}add(t,i){const o=this.nextId++,c=function({type:u,isSymbolTile:d,zoom:p}){return p=p||0,u==="message"?0:u!=="maybePrepare"||d?u!=="parseTile"||d?u==="parseTile"&&d?300-p:u==="maybePrepare"&&d?400-p:500:200-p:100-p}(i);if(c===0){qt();try{t()}finally{}return{cancel:()=>{}}}return this.tasks[o]={fn:t,metadata:i,priority:c,id:o},this.taskQueue.push(o),this.invoker.trigger(),{cancel:()=>{delete this.tasks[o]}}}process(){qt();try{if(this.taskQueue=this.taskQueue.filter(o=>!!this.tasks[o]),!this.taskQueue.length)return;const t=this.pick();if(t===null)return;const i=this.tasks[t];if(delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),!i)return;i.fn()}finally{}}pick(){let t=null,i=1/0;for(let c=0;c<this.taskQueue.length;c++){const u=this.tasks[this.taskQueue[c]];u.priority<i&&(i=u.priority,t=c)}if(t===null)return null;const o=this.taskQueue[t];return this.taskQueue.splice(t,1),o}remove(){this.invoker.remove()}}class AL{constructor(t,i,o){this.target=t,this.parent=i,this.mapId=o,this.callbacks={},this.cancelCallbacks={},Ne(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new Cq}send(t,i,o,c,u=!1,d){const p=Math.round(1e18*Math.random()).toString(36).substring(0,10);o&&(o.metadata=d,this.callbacks[p]=o);const g=new Set;return this.target.postMessage({id:p,type:t,hasCallback:!!o,targetMapId:c,mustQueue:u,sourceMapId:this.mapId,data:nd(i,g)},g),{cancel:()=>{o&&delete this.callbacks[p],this.target.postMessage({id:p,type:"<cancel>",targetMapId:c,sourceMapId:this.mapId})}}}receive(t){const i=t.data,o=i.id;if(o&&(!i.targetMapId||this.mapId===i.targetMapId))if(i.type==="<cancel>"){const c=this.cancelCallbacks[o];delete this.cancelCallbacks[o],c&&c.cancel()}else if(i.mustQueue||qt()){const c=this.callbacks[o];this.cancelCallbacks[o]=this.scheduler.add(()=>this.processTask(o,i),c&&c.metadata||{type:"message"})}else this.processTask(o,i)}processTask(t,i){if(i.type==="<response>"){const o=this.callbacks[t];delete this.callbacks[t],o&&(i.error?o(rd(i.error)):o(null,rd(i.data)))}else{const o=new Set,c=i.hasCallback?(d,p)=>{delete this.cancelCallbacks[t],this.target.postMessage({id:t,type:"<response>",sourceMapId:this.mapId,error:d?nd(d):null,data:nd(p,o)},o)}:d=>{},u=rd(i.data);if(this.parent[i.type])this.parent[i.type](i.sourceMapId,u,c);else if(this.parent.getWorkerSource){const d=i.type.split(".");this.parent.getWorkerSource(i.sourceMapId,d[0],u.source,u.scope)[d[1]](u,c)}else c(new Error(`Could not find function ${i.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}class Gu{constructor(t,i){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=Fe();const o=this.workerPool.acquire(this.id);for(let c=0;c<o.length;c++){const u=new Gu.Actor(o[c],i,this.id);u.name=`Worker ${c}`,this.actors.push(u)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(t,i,o){kt(this.actors,(c,u)=>{c.send(t,i,u)},o=o||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(t=>{t.remove()}),this.actors=[],this.workerPool.release(this.id)}}Gu.Actor=AL;class CL extends Mn{constructor(t,i,o,c){super(),this.scope=o,this._options=t,this.properties=new Yf(i),this._transitionable=new Xf(i,new Map(c)),this._transitionable.setTransitionOrValue(t.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(t){this._transitionable.setTransitionOrValue(this._options.properties,new Map(t))}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(t,i){this._options=t,this._transitionable.setTransitionOrValue(t.properties,i)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}const Pq=new Tr({color:new te(vt.properties_light_ambient.color),intensity:new te(vt.properties_light_ambient.intensity)}),Iq=new Tr({direction:new class{constructor(n){this.specification=n}possiblyEvaluate(n,t){return function([i,o]){const c=ge([1,i,o]);return{x:c.x,y:c.y,z:c.z}}(n.expression.evaluate(t))}interpolate(n,t,i){return{x:qe(n.x,t.x,i),y:qe(n.y,t.y,i),z:qe(n.z,t.z,i)}}}(vt.properties_light_directional.direction),color:new te(vt.properties_light_directional.color),intensity:new te(vt.properties_light_directional.intensity),"cast-shadows":new te(vt.properties_light_directional["cast-shadows"]),"shadow-intensity":new te(vt.properties_light_directional["shadow-intensity"])});class iS{constructor(t,i,o,c){this.screenBounds=t,this.cameraPoint=i,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=o,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,c)}static createFromScreenPoints(t,i){let o,c;if(t instanceof W||typeof t[0]=="number"){const u=W.convert(t);o=[u],c=i.isPointAboveHorizon(u)}else{const u=W.convert(t[0]),d=W.convert(t[1]);o=[u,d],c=$t(u,d).every(p=>i.isPointAboveHorizon(p))}return new iS(o,i.getCameraPoint(),c,i)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(t){return $t(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],t)}bufferedCameraGeometry(t){const i=this.screenBounds[0],o=this.screenBounds.length===1?this.screenBounds[0].add(new W(1,1)):this.screenBounds[1],c=$t(i,o,0,!1);return this.cameraPoint.y>o.y&&(this.cameraPoint.x>i.x&&this.cameraPoint.x<o.x?c.splice(3,0,this.cameraPoint):this.cameraPoint.x>=o.x?c[2]=this.cameraPoint:this.cameraPoint.x<=i.x&&(c[3]=this.cameraPoint)),function(u,d){const p=[];for(let g=0;g<u.length;g++){const _=me(g-1,-1,u.length-1),v=me(g+1,-1,u.length-1),b=u[g],S=u[v],E=u[_].sub(b).unit(),A=S.sub(b).unit(),C=A.angleWithSep(E.x,E.y),P=E.add(A).unit().mult(-1*d/Math.sin(C/2));p.push(b.add(P))}return p}(c,t)}bufferedCameraGeometryGlobe(t){const i=this.screenBounds[0],o=this.screenBounds.length===1?this.screenBounds[0].add(new W(1,1)):this.screenBounds[1],c=$t(i,o,t),u=this.cameraPoint.clone();switch(3*((u.y>i.y)+(u.y>o.y))+((u.x>i.x)+(u.x>o.x))){case 0:c[0]=u,c[4]=u.clone();break;case 1:c.splice(1,0,u);break;case 2:c[1]=u;break;case 3:c.splice(4,0,u);break;case 5:c.splice(2,0,u);break;case 6:c[3]=u;break;case 7:c.splice(3,0,u);break;case 8:c[2]=u}return c}containsTile(t,i,o,c=0){const u=t.queryPadding/i._pixelsPerMercatorPixel+1,d=o?this._bufferedCameraMercator(u,i):this._bufferedScreenMercator(u,i);let p=t.tileID.wrap+(d.unwrapped?c:0);const g=d.polygon.map(P=>lO(t.tileTransform,P,p));if(!oR(g,0,0,Dt,Dt))return;p=t.tileID.wrap+(this.screenGeometryMercator.unwrapped?c:0);const _=this.screenGeometryMercator.polygon.map(P=>cO(t.tileTransform,P,p)),v=_.map(P=>new W(P[0],P[1])),b=i.getFreeCameraOptions().position||new vn(0,0,0),S=cO(t.tileTransform,b,p),E=_.map(P=>{const k=ct.sub(P,P,S);return ct.normalize(k,k),new T_(S,k)}),A=ju(t,1,i.zoom)*i._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:v,tilespaceRays:E,bufferedTilespaceGeometry:g,bufferedTilespaceBounds:(C=Ft(g),C.min.x=Ot(C.min.x,0,Dt),C.min.y=Ot(C.min.y,0,Dt),C.max.x=Ot(C.max.x,0,Dt),C.max.y=Ot(C.max.y,0,Dt),C),tile:t,tileID:t.tileID,pixelToTileUnitsFactor:A};var C}_bufferedScreenMercator(t,i){const o=PL(t);if(this._screenRaycastCache[o])return this._screenRaycastCache[o];{let c;return c=i.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(t),i):{polygon:this.bufferedScreenGeometry(t).map(u=>i.pointCoordinate3D(u)),unwrapped:!0},this._screenRaycastCache[o]=c,c}}_bufferedCameraMercator(t,i){const o=PL(t);if(this._cameraRaycastCache[o])return this._cameraRaycastCache[o];{let c;return c=i.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(t),i):{polygon:this.bufferedCameraGeometry(t).map(u=>i.pointCoordinate3D(u)),unwrapped:!0},this._cameraRaycastCache[o]=c,c}}_projectAndResample(t,i){const o=function(u,d){const p=wt.multiply([],d.pixelMatrix,d.globeMatrix),g=[0,-as,0,1],_=[0,as,0,1],v=[0,0,0,1];jn.transformMat4(g,g,p),jn.transformMat4(_,_,p),jn.transformMat4(v,v,p);const b=new W(g[0]/g[3],g[1]/g[3]),S=new W(_[0]/_[3],_[1]/_[3]),E=mc(u,b)&&g[3]<v[3],A=mc(u,S)&&_[3]<v[3];if(!E&&!A)return null;const C=function(q,Z,X){for(let J=1;J<q.length;J++){const rt=Ip(Z.pointCoordinate3D(q[J-1]).x),it=Ip(Z.pointCoordinate3D(q[J]).x);if(X<0){if(rt<it)return{idx:J,t:-rt/(it-1-rt)}}else if(it<rt)return{idx:J,t:(1-rt)/(it+1-rt)}}return null}(u,d,E?-1:1);if(!C)return null;const{idx:P,t:k}=C;let L=P>1?sS(u.slice(0,P),d):[],j=P<u.length?sS(u.slice(P),d):[];L=L.map(q=>new W(Ip(q.x),q.y)),j=j.map(q=>new W(Ip(q.x),q.y));const V=[...L];V.length===0&&V.push(j[j.length-1]);const F=qe(V[V.length-1].y,(j.length===0?L[0]:j[0]).y,k);let U;return U=E?[new W(0,F),new W(0,0),new W(1,0),new W(1,F)]:[new W(1,F),new W(1,1),new W(0,1),new W(0,F)],V.push(...U),j.length===0?V.push(L[0]):V.push(...j),{polygon:V.map(q=>new vn(q.x,q.y)),unwrapped:!1}}(t,i);if(o)return o;const c=function(u,d){let p=!1,g=-1/0,_=0;for(let b=0;b<u.length-1;b++)u[b].x>g&&(g=u[b].x,_=b);for(let b=0;b<u.length-1;b++){const S=(_+b)%(u.length-1),E=u[S],A=u[S+1];Math.abs(E.x-A.x)>.5&&(E.x<A.x?(E.x+=1,S===0&&(u[u.length-1].x+=1)):(A.x+=1,S+1===u.length-1&&(u[0].x+=1)),p=!0)}const v=ti(d.center.lng);return p&&v<Math.abs(v-1)&&u.forEach(b=>{b.x-=1}),{polygon:u,unwrapped:p}}(sS(t,i).map(u=>new W(Ip(u.x),u.y)),i);return{polygon:c.polygon.map(u=>new vn(u.x,u.y)),unwrapped:c.unwrapped}}}function sS(n,t){return tR(n,i=>{const o=t.pointCoordinate3D(i);i.x=o.x,i.y=o.y},1/256)}function Ip(n){return n<0?1+n%1:n%1}function PL(n){return 100*n|0}function oS(n,t,i,o,c){const u=function(d,p){if(d)return c(d);if(p){n.url&&p.tiles&&n.tiles&&delete n.tiles;const g=Ae(Ct(p,n),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);p.vector_layers&&(g.vectorLayers=p.vector_layers,g.vectorLayerIds=g.vectorLayers.map(_=>_.id)),g.tiles=t.canonicalizeTileset(g,n.url),c(null,g)}};return n.url?Kt(t.transformRequest(t.normalizeSourceURL(n.url,null,i,o),zt.Source),u):Be.frame(()=>u(null,n))}class wy{constructor(t,i,o){this.bounds=Os.convert(this.validateBounds(t)),this.minzoom=i||0,this.maxzoom=o||24}validateBounds(t){return Array.isArray(t)&&t.length===4?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const i=Math.pow(2,t.z),o=Math.floor(ti(this.bounds.getWest())*i),c=Math.floor(ui(this.bounds.getNorth())*i),u=Math.ceil(ti(this.bounds.getEast())*i),d=Math.ceil(ui(this.bounds.getSouth())*i);return t.x>=o&&t.x<u&&t.y>=c&&t.y<d}}class IL{constructor(t,i){this.width=t,this.height=i,this.nextRow=0,this.image=new fl({width:t,height:i}),this.positions={},this.uploaded=!1}getDash(t,i){const o=this.getKey(t,i);return this.positions[o]}trim(){const t=this.width,i=this.height=Qe(this.nextRow);this.image.resize({width:t,height:i})}getKey(t,i){return t.join(",")+i}getDashRanges(t,i,o){const c=[];let u=t.length%2==1?-t[t.length-1]*o:0,d=t[0]*o,p=!0;c.push({left:u,right:d,isDash:p,zeroLength:t[0]===0});let g=t[0];for(let _=1;_<t.length;_++){p=!p;const v=t[_];u=g*o,g+=v,d=g*o,c.push({left:u,right:d,isDash:p,zeroLength:v===0})}return c}addRoundDash(t,i,o){const c=i/2;for(let u=-o;u<=o;u++){const d=this.width*(this.nextRow+o+u);let p=0,g=t[p];for(let _=0;_<this.width;_++){_/g.right>1&&(g=t[++p]);const v=Math.abs(_-g.left),b=Math.abs(_-g.right),S=Math.min(v,b);let E;const A=u/o*(c+1);if(g.isDash){const C=c-Math.abs(A);E=Math.sqrt(S*S+C*C)}else E=c-Math.sqrt(S*S+A*A);this.image.data[d+_]=Math.max(0,Math.min(255,E+128))}}}addRegularDash(t,i){for(let g=t.length-1;g>=0;--g){const _=t[g],v=t[g+1];_.zeroLength?t.splice(g,1):v&&v.isDash===_.isDash&&(v.left=_.left,t.splice(g,1))}const o=t[0],c=t[t.length-1];o.isDash===c.isDash&&(o.left=c.left-this.width,c.right=o.right+this.width);const u=this.width*this.nextRow;let d=0,p=t[d];for(let g=0;g<this.width;g++){g/p.right>1&&(p=t[++d]);const _=Math.abs(g-p.left),v=Math.abs(g-p.right),b=Math.min(_,v);this.image.data[u+g]=Math.max(0,Math.min(255,(p.isDash?b:-b)+i+128))}}addDash(t,i){const o=this.getKey(t,i);if(this.positions[o])return this.positions[o];const c=i==="round",u=c?7:0,d=2*u+1;if(this.nextRow+d>this.height)return _t("LineAtlas out of space"),null;t.length===0&&t.push(1);let p=0;for(let v=0;v<t.length;v++)t[v]<0&&(_t("Negative value is found in line dasharray, replacing values with 0"),t[v]=0),p+=t[v];if(p!==0){const v=this.width/p,b=this.getDashRanges(t,this.width,v);c?this.addRoundDash(b,v,u):this.addRegularDash(b,i==="square"?.5*v:0)}const g=this.nextRow+u;this.nextRow+=d;const _={tl:[g,u],br:[p,0]};return this.positions[o]=_,_}}Se(IL,"LineAtlas");const kL=1*Jo;class DL{constructor(t){const i={},o=[];for(const p in t){const g=t[p],_=i[p]={};for(const v in g.glyphs){const b=g.glyphs[+v];if(!b||b.bitmap.width===0||b.bitmap.height===0)continue;const S=b.metrics.localGlyph?kL:1,E={x:0,y:0,w:b.bitmap.width+2*S,h:b.bitmap.height+2*S};o.push(E),_[v]=E}}const{w:c,h:u}=zw(o),d=new fl({width:c||1,height:u||1});for(const p in t){const g=t[p];for(const _ in g.glyphs){const v=g.glyphs[+_];if(!v||v.bitmap.width===0||v.bitmap.height===0)continue;const b=i[p][_],S=v.metrics.localGlyph?kL:1;fl.copy(v.bitmap,d,{x:0,y:0},{x:b.x+S,y:b.y+S},v.bitmap)}}this.image=d,this.positions=i}}Se(DL,"GlyphAtlas");class kq{constructor(t){this.tileID=new Pn(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.tileZoom=t.tileZoom,this.uid=t.uid,this.zoom=t.zoom,this.canonical=t.tileID.canonical,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.scope=t.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.collectResourceTiming,this.promoteId=t.promoteId,this.isSymbolTile=t.isSymbolTile,this.tileTransform=Bu(t.tileID.canonical,t.projection),this.projection=t.projection,this.brightness=t.brightness,this.extraShadowCaster=!!t.extraShadowCaster}parse(t,i,o,c,u){this.status="parsing",this.data=t,this.collisionBoxArray=new Fb;const d=new SR(Object.keys(t.layers).sort()),p=new Dw(this.tileID,this.promoteId);p.bucketLayerIDs=[];const g={},_=new IL(256,256),v={featureIndex:p,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:_,availableImages:o,brightness:this.brightness},b=i.familiesBySource[this.source];for(const L in b){const j=t.layers[L];if(!j)continue;let V=!1,F=!1,U=!1;for(const X of b[L])X[0].type==="symbol"?V=!0:F=!0,X[0].is3D()&&X[0].type!=="model"&&(U=!0);if(this.extraShadowCaster&&!U||this.isSymbolTile===!0&&!V||this.isSymbolTile===!1&&!F)continue;j.version===1&&_t(`Vector tile source "${this.source}" layer "${L}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const q=d.encode(L),Z=[];for(let X=0;X<j.length;X++){const J=j.feature(X),rt=p.getId(J,L);Z.push({feature:J,id:rt,index:X,sourceLayerIndex:q})}for(const X of b[L]){const J=X[0];(!this.extraShadowCaster||J.is3D()&&J.type!=="model")&&(this.isSymbolTile!==void 0&&J.type==="symbol"!==this.isSymbolTile||J.minzoom&&this.zoom<Math.floor(J.minzoom)||J.maxzoom&&this.zoom>=J.maxzoom||J.visibility!=="none"&&(aS(X,this.zoom,v.brightness,o),(g[J.id]=J.createBucket({index:p.bucketLayerIDs.length,layers:X,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:q,sourceID:this.source,projection:this.projection.spec})).populate(Z,v,this.tileID.canonical,this.tileTransform),p.bucketLayerIDs.push(X.map(rt=>rt.id))))}}let S,E,A,C;_.trim();const P={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},k=()=>{if(S)return this.status="done",u(S);if(this.extraShadowCaster)this.status="done",u(null,{buckets:Wt(g).filter(L=>!L.isEmpty()),featureIndex:p,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:v.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(E&&A&&C){const L=new DL(E),j=new QR(A,C);for(const V in g){const F=g[V];F instanceof xp?(aS(F.layers,this.zoom,v.brightness,o),AW(F,E,L.positions,A,j.iconPositions,this.showCollisionBoxes,o,this.tileID.canonical,this.tileZoom,this.projection,this.brightness)):F.hasPattern&&(F instanceof ly||F instanceof B_||F instanceof Cp)&&(aS(F.layers,this.zoom,v.brightness,o),F.addFeatures(v,this.tileID.canonical,j.patternPositions,o,this.tileTransform,this.brightness))}this.status="done",u(null,{buckets:Wt(g).filter(V=>!V.isEmpty()),featureIndex:p,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:L.image,lineAtlas:_,imageAtlas:j,brightness:v.brightness})}};if(!this.extraShadowCaster){const L=_n(v.glyphDependencies,F=>Object.keys(F).map(Number));Object.keys(L).length?c.send("getGlyphs",{uid:this.uid,stacks:L,scope:this.scope},(F,U)=>{S||(S=F,E=U,k())},void 0,!1,P):E={};const j=Object.keys(v.iconDependencies);j.length?c.send("getImages",{icons:j,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(F,U)=>{S||(S=F,A=U,k())},void 0,!1,P):A={};const V=Object.keys(v.patternDependencies);V.length?c.send("getImages",{icons:V,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(F,U)=>{S||(S=F,C=U,k())},void 0,!1,P):C={}}k()}}function aS(n,t,i,o){const c=new pr(t,{brightness:i});for(const u of n)u.recalculate(c,o)}class RL{constructor(t){this.entries={},this.scheduler=t}request(t,i,o,c){const u=this.entries[t]=this.entries[t]||{callbacks:[]};if(u.result){const[d,p]=u.result;return this.scheduler?this.scheduler.add(()=>{c(d,p)},i):c(d,p),()=>{}}return u.callbacks.push(c),u.cancel||(u.cancel=o((d,p)=>{u.result=[d,p];for(const g of u.callbacks)this.scheduler?this.scheduler.add(()=>{g(d,p)},i):g(d,p);setTimeout(()=>delete this.entries[t],3e3)})),()=>{u.result||(u.callbacks=u.callbacks.filter(d=>d!==c),u.callbacks.length||(u.cancel(),delete this.entries[t]))}}}function OL(n,t,i){const o=JSON.stringify(n.request);return n.data&&(this.deduped.entries[o]={result:[null,n.data]}),this.deduped.request(o,{type:"parseTile",isSymbolTile:n.isSymbolTile,zoom:n.tileZoom},c=>{const u=oe(n.request,(d,p,g,_)=>{d?c(d):p&&c(null,{vectorTile:i?void 0:new Iw(new W_(p)),rawData:p,cacheControl:g,expires:_})});return()=>{u.cancel(),c()}},t)}class LL extends Mn{constructor(t,i,o,c){if(super(),this.id=t,this.dispatcher=o,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,Ct(this,Ae(i,["url","scheme","tileSize","promoteId"])),this._options=Ct({type:"vector"},i),this._collectResourceTiming=!!i.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(c),this._tileWorkers={},this._deduped=new RL}load(t){this._loaded=!1,this.fire(new Bt("dataloading",{dataType:"source"}));const i=Array.isArray(this.map._language)?this.map._language.join():this.map._language,o=this.map._worldview;this._tileJSONRequest=oS(this._options,this.map._requestManager,i,o,(c,u)=>{this._tileJSONRequest=null,this._loaded=!0,c?(i&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${i}`),o&&o.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${o}`),this.fire(new xe(c))):u&&(Ct(this,u),u.bounds&&(this.tileBounds=new wy(u.bounds,this.minzoom,this.maxzoom)),bu(u.tiles,this.map._requestManager._customAccessToken),this.fire(new Bt("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new Bt("data",{dataType:"source",sourceDataType:"content"}))),t&&t(c)})}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}reload(){this.cancelTileJSONRequest();const t=Xi(this.id,this.scope);this.load(()=>this.map.style.clearSource(t))}setTiles(t){return this._options.tiles=t,this.reload(),this}setUrl(t){return this.url=t,this._options.url=t,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return Ct({},this._options)}loadTile(t,i){const o=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme)),c={request:this.map._requestManager.transformRequest(o,zt.Tile),data:void 0,uid:t.uid,tileID:t.tileID,tileZoom:t.tileZoom,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:Be.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:t.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:t.isExtraShadowCaster};if(c.request.collectResourceTiming=this._collectResourceTiming,t.actor&&t.state!=="expired")t.state==="loading"?t.reloadCallback=i:t.request=t.actor.send("reloadTile",c,u.bind(this));else if(t.actor=this._tileWorkers[o]=this._tileWorkers[o]||this.dispatcher.getActor(),this.dispatcher.ready)t.request=t.actor.send("loadTile",c,u.bind(this),void 0,!0);else{const d=OL.call({deduped:this._deduped},c,(p,g)=>{p||!g?u.call(this,p):(c.data={cacheControl:g.cacheControl,expires:g.expires,rawData:g.rawData.slice(0)},t.actor&&t.actor.send("loadTile",c,u.bind(this),void 0,!0))},!0);t.request={cancel:d}}function u(d,p){return delete t.request,t.aborted?i(null):d&&d.status!==404?i(d):(p&&p.resourceTiming&&(t.resourceTiming=p.resourceTiming),this.map._refreshExpiredTiles&&p&&t.setExpiryData(p),t.loadVectorData(p,this.map.painter),rs(this.dispatcher),i(null),void(t.reloadCallback&&(this.loadTile(t,t.reloadCallback),t.reloadCallback=null)))}}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.actor&&t.actor.send("abortTile",{uid:t.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(t){t.actor&&t.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id,scope:this.scope}),t.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class lS extends Mn{constructor(t,i,o,c){super(),this.id=t,this.dispatcher=o,this.setEventedParent(c),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=Ct({type:"raster"},i),Ct(this,Ae(i,["url","scheme","tileSize"]))}load(t){this._loaded=!1,this.fire(new Bt("dataloading",{dataType:"source"})),this._tileJSONRequest=oS(this._options,this.map._requestManager,null,null,(i,o)=>{this._tileJSONRequest=null,this._loaded=!0,i?this.fire(new xe(i)):o&&(Ct(this,o),o.bounds&&(this.tileBounds=new wy(o.bounds,this.minzoom,this.maxzoom)),bu(o.tiles),this.fire(new Bt("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new Bt("data",{dataType:"source",sourceDataType:"content"}))),t&&t(i)})}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}reload(){this.cancelTileJSONRequest();const t=Xi(this.id,this.scope);this.load(()=>this.map.style.clearSource(t))}setTiles(t){return this._options.tiles=t,this.reload(),this}setUrl(t){return this.url=t,this._options.url=t,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return Ct({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t,i){const o=Be.devicePixelRatio>=2,c=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),o,this.tileSize);t.request=Ye(this.map._requestManager.transformRequest(c,zt.Tile),(u,d,p,g)=>(delete t.request,t.aborted?(t.state="unloaded",i(null)):u?(t.state="errored",i(u)):d?(this.map._refreshExpiredTiles&&t.setExpiryData({cacheControl:p,expires:g}),t.setTexture(d,this.map.painter),t.state="loaded",rs(this.dispatcher),void i(null)):i(null)))}abortTile(t,i){t.request&&(t.request.cancel(),delete t.request),i()}unloadTile(t,i){t.texture&&t.texture instanceof _r?(t.destroy(!0),t.texture&&t.texture instanceof _r&&this.map.painter.saveTileTexture(t.texture)):t.destroy(),i()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function Dq(){return Wy.workerClass!=null?new Wy.workerClass:new w.Worker(Wy.workerUrl)}const cS="mapboxgl_preloaded_worker_pool";class Ad{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<Ad.workerCount;)this.workers.push(new Dq);return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.workers&&this.numActive()===0&&(this.workers.forEach(i=>{i.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[cS]}numActive(){return Object.keys(this.active).length}}let kp;function Dp(){return kp||(kp=new Ad),kp}Ad.workerCount=2;let Sy,uS,ea,hS=null;function zL(){return qt()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:uS||I.DRACO_URL}const dS=5123,fS=5126,pS={5120:Int8Array,5121:Uint8Array,5122:Int16Array,[dS]:Uint16Array,5125:Uint32Array,[fS]:Float32Array},Rq={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",[dS]:"DT_UINT16",5125:"DT_UINT32",[fS]:"DT_FLOAT32"},mS={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function NL(n,t,i){const o=i.json.bufferViews.length,c=i.buffers.length;t.bufferView=o,i.json.bufferViews[o]={buffer:c,byteLength:n.byteLength},i.buffers[c]=n}const gS="KHR_draco_mesh_compression";function Oq(n,t){const i=n.extensions&&n.extensions[gS];if(!i)return;const o=new ea.Decoder,c=VL(t,i.bufferView),u=new ea.Mesh;if(!o.DecodeArrayToMesh(c,c.byteLength,u))throw new Error("Failed to decode Draco mesh");const d=t.json.accessors[n.indices],p=pS[d.componentType],g=d.count*p.BYTES_PER_ELEMENT,_=ea._malloc(g);p===Uint16Array?o.GetTrianglesUInt16Array(u,g,_):o.GetTrianglesUInt32Array(u,g,_),NL(ea.memory.buffer.slice(_,_+g),d,t),ea._free(_);for(const v of Object.keys(i.attributes)){const b=o.GetAttributeByUniqueId(u,i.attributes[v]),S=t.json.accessors[n.attributes[v]],E=Rq[S.componentType],A=S.count*mS[S.type]*pS[S.componentType].BYTES_PER_ELEMENT,C=ea._malloc(A);o.GetAttributeDataArrayForAllPoints(u,b,ea[E],A,C),NL(ea.memory.buffer.slice(C,C+A),S,t),ea._free(C)}o.destroy(),u.destroy(),delete n.extensions[gS]}const FL=1179937895,BL=new TextDecoder("utf8");function jL(n,t){return new URL(n,t).href}function Lq(n,t,i,o){return fetch(jL(n.uri,o)).then(c=>c.arrayBuffer()).then(c=>{t.buffers[i]=c})}function VL(n,t){const i=n.json.bufferViews[t];return new Uint8Array(n.buffers[i.buffer],i.byteOffset||0,i.byteLength)}function zq(n,t,i,o){if(n.uri){const c=jL(n.uri,o);return fetch(c).then(u=>u.blob()).then(u=>w.createImageBitmap(u)).then(u=>{t.images[i]=u})}if(n.bufferView!==void 0){const c=VL(t,n.bufferView),u=new w.Blob([c],{type:n.mimeType});return w.createImageBitmap(u).then(d=>{t.images[i]=d})}}function UL(n,t=0,i){const o={json:null,images:[],buffers:[]};if(new Uint32Array(n,t,1)[0]===FL){const _=new Uint32Array(n,t);let v=2;const b=(_[v++]>>2)-3,S=_[v++]>>2;if(v++,o.json=JSON.parse(BL.decode(_.subarray(v,v+S))),v+=S,v<b){const E=_[v++];v++;const A=t+(v<<2);o.buffers[0]=n.slice(A,A+E)}}else o.json=JSON.parse(BL.decode(new Uint8Array(n,t)));const{buffers:c,images:u,meshes:d,extensionsUsed:p}=o.json;let g=Promise.resolve();if(c){const _=[];for(let v=0;v<c.length;v++){const b=c[v];b.uri?_.push(Lq(b,o,v,i)):o.buffers[v]||(o.buffers[v]=null)}g=Promise.all(_)}return g.then(()=>{const _=[],v=p&&p.includes(gS);if(v&&_.push(function(){if(!ea)return Sy||(Sy=function(b){let S,E=null;function A(){S=new Uint8Array(E.buffer)}function C(){throw new Error("Unexpected Draco error.")}const P={a:{a:C,d:function(k,L,j){return S.copyWithin(k,L,L+j)},c:function(k){const L=S.length,j=Math.max(k>>>0,Math.ceil(1.2*L)),V=Math.ceil((j-L)/65536);try{return E.grow(V),A(),!0}catch{return!1}},b:C}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(b,P):b.then(k=>k.arrayBuffer()).then(k=>WebAssembly.instantiate(k,P))).then(k=>{const{Rb:L,Qb:j,P:V,T:F,X:U,Ja:q,La:Z,Qa:X,Va:J,Wa:rt,eb:it,jb:ut,f:tt,e:dt,yb:gt,zb:xt,Ab:ht,Bb:pt,Db:Et,Gb:At}=k.instance.exports;E=dt;const Mt=(()=>{let Lt=0,Nt=0,jt=0,It=0;return Gt=>{jt&&(L(It),L(Lt),Nt+=jt,jt=Lt=0),Lt||(Nt+=128,Lt=j(Nt));const ce=Gt.length+7&-8;let ue=Lt;ce>=Nt&&(jt=ce,ue=It=j(ce));for(let ye=0;ye<Gt.length;ye++)S[ue+ye]=Gt[ye];return ue}})();return A(),tt(),{memory:dt,_free:L,_malloc:j,Mesh:class{constructor(){this.ptr=V()}destroy(){F(this.ptr)}},Decoder:class{constructor(){this.ptr=q()}destroy(){ut(this.ptr)}DecodeArrayToMesh(Lt,Nt,jt){const It=Mt(Lt),Gt=Z(this.ptr,It,Nt,jt.ptr);return!!U(Gt)}GetAttributeByUniqueId(Lt,Nt){return{ptr:X(this.ptr,Lt.ptr,Nt)}}GetTrianglesUInt16Array(Lt,Nt,jt){J(this.ptr,Lt.ptr,Nt,jt)}GetTrianglesUInt32Array(Lt,Nt,jt){rt(this.ptr,Lt.ptr,Nt,jt)}GetAttributeDataArrayForAllPoints(Lt,Nt,jt,It,Gt){it(this.ptr,Lt.ptr,Nt.ptr,jt,It,Gt)}},DT_INT8:gt(),DT_UINT8:xt(),DT_INT16:ht(),DT_UINT16:pt(),DT_UINT32:Et(),DT_FLOAT32:At()}})}(fetch(zL())),Sy.then(b=>{ea=b,Sy=void 0}))}()),u)for(let b=0;b<u.length;b++)_.push(zq(u[b],o,b,i));return(_.length?Promise.all(_):Promise.resolve()).then(()=>{if(v&&d)for(const{primitives:b}of d)for(const S of b)Oq(S,o);return o})})}function $L(n){return fetch(n).then(t=>t.arrayBuffer()).then(t=>UL(t,0,n))}class GL{constructor(t,i,o){if(this.triangleCount=i.length/3,this.min=new W(0,0),this.max=new W(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||t.length===0||o===0)return;const c=t.map(v=>v.x),u=t.map(v=>v.y);this.min=new W(Math.min(...c),Math.min(...u)),this.max=new W(Math.max(...c),Math.max(...u));const d=this.max.sub(this.min);d.x=Math.max(d.x,1),d.y=Math.max(d.y,1);const p=Math.max(d.x,d.y)/o;this.cellsX=Math.max(1,Math.ceil(d.x/p)),this.cellsY=Math.max(1,Math.ceil(d.y/p)),this.xScale=1/p,this.yScale=1/p;const g=[];for(let v=0;v<this.triangleCount;v++){const b=t[i[3*v+0]].sub(this.min),S=t[i[3*v+1]].sub(this.min),E=t[i[3*v+2]].sub(this.min),A=Tc(Math.floor(Math.min(b.x,S.x,E.x)),this.xScale,this.cellsX),C=Tc(Math.floor(Math.max(b.x,S.x,E.x)),this.xScale,this.cellsX),P=Tc(Math.floor(Math.min(b.y,S.y,E.y)),this.yScale,this.cellsY),k=Tc(Math.floor(Math.max(b.y,S.y,E.y)),this.yScale,this.cellsY),L=new W(0,0),j=new W(0,0),V=new W(0,0),F=new W(0,0);for(let U=P;U<=k;++U){L.y=j.y=U*p,V.y=F.y=(U+1)*p;for(let q=A;q<=C;++q)L.x=V.x=q*p,j.x=F.x=(q+1)*p,(bw(b,S,E,L,j,F)||bw(b,S,E,L,F,V))&&g.push({cellIdx:U*this.cellsX+q,triIdx:v})}}if(g.length===0)return;g.sort((v,b)=>v.cellIdx-b.cellIdx||v.triIdx-b.triIdx);let _=0;for(;_<g.length;){const v=g[_].cellIdx,b={start:this.payload.length,len:0};for(;_<g.length&&g[_].cellIdx===v;)++b.len,this.payload.push(g[_++].triIdx);this.cells[v]=b}}query(t,i,o){if(this.triangleCount===0||this.cells.length===0||t.x>this.max.x||this.min.x>i.x||t.y>this.max.y||this.min.y>i.y)return;this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8)));for(let g=0;g<this.lookup.length;g++)this.lookup[g]=0;const c=Tc(t.x-this.min.x,this.xScale,this.cellsX),u=Tc(i.x-this.min.x,this.xScale,this.cellsX),d=Tc(t.y-this.min.y,this.yScale,this.cellsY),p=Tc(i.y-this.min.y,this.yScale,this.cellsY);for(let g=d;g<=p;g++)for(let _=c;_<=u;_++){const v=this.cells[g*this.cellsX+_];if(v)for(let b=0;b<v.len;b++){const S=this.payload[v.start+b],E=Math.floor(S/8),A=1<<S%8;if(!(this.lookup[E]&A)&&(this.lookup[E]|=A,o.push(S),o.length===this.triangleCount))return}}}}function Tc(n,t,i){return Math.max(0,Math.min(i-1,Math.floor(n*t)))}function Wu(n,t){const i=n.json.bufferViews[t.bufferView];return new pS[t.componentType](n.buffers[i.buffer],(t.byteOffset||0)+(i.byteOffset||0),t.count*mS[t.type])}function Nq(n,t,i){const o=n.indices,c=n.attributes,u={};u.indexArray=new Hr;const d=t.json.accessors[o],p=d.count/3;u.indexArray.reserve(p);const g=Wu(t,d);for(let S=0;S<p;S++)u.indexArray.emplaceBack(g[3*S],g[3*S+1],g[3*S+2]);u.indexArray._trim(),u.vertexArray=new Ou;const _=t.json.accessors[c.POSITION];u.vertexArray.reserve(_.count);const v=Wu(t,_);for(let S=0;S<_.count;S++)u.vertexArray.emplaceBack(v[3*S],v[3*S+1],v[3*S+2]);if(u.vertexArray._trim(),u.aabb=new nr(_.min,_.max),u.centroid=function(S,E){const A=[0,0,0],C=S.length;if(C>0){for(let P=0;P<C;P++){const k=3*S[P];A[0]+=E[k],A[1]+=E[k+1],A[2]+=E[k+2]}A[0]/=C,A[1]/=C,A[2]/=C}return A}(g,v),c.COLOR_0!==void 0){const S=t.json.accessors[c.COLOR_0],E=mS[S.type];if(S.componentType===fS){u.colorArray=E===3?new Ou:new il,u.colorArray.reserve(S.count);const A=Wu(t,S);if(E===3)for(let C=0;C<S.count;C++)u.colorArray.emplaceBack(A[3*C],A[3*C+1],A[3*C+2]);else for(let C=0;C<S.count;C++)u.colorArray.emplaceBack(A[4*C],A[4*C+1],A[4*C+2],A[4*C+3]);u.colorArray._trim()}else if(S.componentType===dS&&E===4){u.colorArray=new il,u.colorArray.resize(S.count);const A=Wu(t,S),C=1/65535,P=u.colorArray.float32;for(let k=0;k<4*A.length;++k)P[k]=A[k]*C}else _t(`glTF color buffer parsing for accessor ${JSON.stringify(S)} is not supported`)}if(c.NORMAL!==void 0){u.normalArray=new Ou;const S=t.json.accessors[c.NORMAL];u.normalArray.reserve(S.count);const E=Wu(t,S);for(let A=0;A<S.count;A++)u.normalArray.emplaceBack(E[3*A],E[3*A+1],E[3*A+2]);u.normalArray._trim()}if(c.TEXCOORD_0!==void 0&&i.length>0){u.texcoordArray=new tp;const S=t.json.accessors[c.TEXCOORD_0];u.texcoordArray.reserve(S.count);const E=Wu(t,S);for(let A=0;A<S.count;A++)u.texcoordArray.emplaceBack(E[2*A],E[2*A+1]);u.texcoordArray._trim()}const b=n.material;return u.material=function(S,E){const{emissiveFactor:A=[0,0,0],alphaMode:C="OPAQUE",alphaCutoff:P=.5,normalTexture:k,occlusionTexture:L,emissiveTexture:j,doubleSided:V}=S,{baseColorFactor:F=[1,1,1,1],metallicFactor:U=1,roughnessFactor:q=1,baseColorTexture:Z,metallicRoughnessTexture:X}=S.pbrMetallicRoughness||{};return{pbrMetallicRoughness:{baseColorFactor:new tn(...F),metallicFactor:U,roughnessFactor:q,baseColorTexture:Z?E[Z.index]:void 0,metallicRoughnessTexture:X?E[X.index]:void 0},doubleSided:V,emissiveFactor:A,alphaMode:C,alphaCutoff:P,normalTexture:k?E[k.index]:void 0,occlusionTexture:L?E[L.index]:void 0,emissionTexture:j?E[j.index]:void 0,defined:S.defined===void 0}}(b!==void 0?t.json.materials[b]:{defined:!1},i),c._FEATURE_RGBA4444!==void 0&&(u.featureData=new Uint32Array(Wu(t,t.json.accessors[c._FEATURE_RGBA4444]).buffer)),u}function WL(n,t,i){const{matrix:o,rotation:c,translation:u,scale:d,mesh:p,extras:g,children:_}=n,v={};if(v.matrix=o||wt.fromRotationTranslationScale([],c||[0,0,0,1],u||[0,0,0],d||[1,1,1]),p!==void 0){v.meshes=i[p];const b=v.anchor=[0,0];for(const S of v.meshes){const{min:E,max:A}=S.aabb;b[0]+=E[0]+A[0],b[1]+=E[1]+A[1]}b[0]=Math.floor(b[0]/v.meshes.length/2),b[1]=Math.floor(b[1]/v.meshes.length/2)}if(g&&(g.id&&(v.id=g.id),g.lights&&(v.lights=function(b){if(!b.length)return[];const S=function(k){const L=atob(k),j=new Uint8Array(L.length);for(let V=0;V<L.length;V++)j[V]=L.codePointAt(V);return j}(b),E=[],A=S.length/24,C=new Uint16Array(S.buffer),P=new Float32Array(S.buffer);for(let k=0;k<A;k++){const L=C[2*k*6]/30,j=C[2*k*6+1]/30,V=C[2*k*6+10]/100,F=P[6*k+1],U=P[6*k+2],q=P[6*k+3],Z=P[6*k+4],X=q-F,J=Z-U,rt=Math.hypot(X,J);E.push({pos:[F+.5*X,U+.5*J,j],normal:[J/rt,-X/rt,0],width:rt,height:L,depth:V,points:[F,U,q,Z]})}return E}(g.lights))),_){const b=[];for(const S of _)b.push(WL(t.json.nodes[S],t,i));v.children=b}return v}function Fq(n){if(n.vertices.length===0||n.indices.length===0)return null;const[t,i]=[n.vertices[0].clone(),n.vertices[0].clone()];for(let d=1;d<n.vertices.length;++d){const p=n.vertices[d];t.x=Math.min(t.x,p.x),t.y=Math.min(t.y,p.y),i.x=Math.max(i.x,p.x),i.y=Math.max(i.y,p.y)}const o=Math.ceil(Math.max(i.x-t.x,i.y-t.y)/256),c=Math.max(8,o),u=new GL(n.vertices,n.indices,c);return{vertices:n.vertices,indices:n.indices,grid:u,min:t,max:i}}function Bq(n){if(!n.extras||!n.extras.ground)return null;const t=n.extras.ground;if(!t||!Array.isArray(t)||t.length===0)return null;const i=t[0];if(!i||!Array.isArray(i)||i.length===0)return null;const o=[];for(const d of i){if(!Array.isArray(d)||d.length!==2)continue;const p=d[0],g=d[1];typeof p=="number"&&typeof g=="number"&&o.push(new W(p,g))}if(o.length<3)return null;o.length>1&&o[o.length-1].equals(o[0])&&o.pop();let c=0;for(let d=0;d<o.length;d++){const p=o[d],g=o[(d+1)%o.length],_=o[(d+2)%o.length];c+=(p.x-g.x)*(_.y-g.y)-(_.x-g.x)*(p.y-g.y)}c>0&&o.reverse();const u=F_(o.flatMap(d=>[d.x,d.y]),[]);return u.length===0?null:{vertices:o,indices:u}}function jq(n){const t=[],i=[];let o=0;for(const c of n){o=t.length;const u=c.vertexArray.float32,d=c.indexArray.uint16;for(let p=0;p<c.vertexArray.length;p++)t.push(new W(u[3*p+0],u[3*p+1]));for(let p=0;p<3*c.indexArray.length;p++)i.push(d[p]+o)}if(i.length%3!=0)return null;for(let c=0;c<i.length;c+=3){const u=t[i[c+0]],d=t[i[c+1]],p=t[i[c+2]];(u.x-d.x)*(p.y-d.y)-(p.x-d.x)*(u.y-d.y)>0&&([i[c+1],i[c+2]]=[i[c+2],i[c+1]])}return{vertices:t,indices:i}}function _S(n){const t=function(g,_){const v=[],b=w.WebGL2RenderingContext;if(g.json.textures)for(const S of g.json.textures){const E={magFilter:b.LINEAR,minFilter:b.NEAREST,wrapS:b.REPEAT,wrapT:b.REPEAT};S.sampler!==void 0&&Object.assign(E,g.json.samplers[S.sampler]),v.push({image:_[S.source],sampler:E,uploaded:!1})}return v}(n,n.images),i=function(g,_){const v=[];for(const b of g.json.meshes){const S=[];for(const E of b.primitives)S.push(Nq(E,g,_));v.push(S)}return v}(n,t),{scenes:o,scene:c,nodes:u}=n.json,d=o?o[c||0].nodes:u,p=[];for(const g of d)p.push(WL(u[g],n,i));return function(g,_,v){const b={},S=new Set;for(let E=0;E<g.length;E++){const A=v[_[E]];if(!A.extras)continue;const C=A.extras["mapbox:footprint:version"],P=A.extras["mapbox:footprint:id"];(C||P)&&S.add(E),C==="1.0.0"&&P&&(b[P]=E)}for(let E=0;E<g.length;E++){if(S.has(E))continue;const A=g[E],C=v[_[E]];if(!C.extras)continue;let P=null;A.id in b&&(P=jq(g[b[A.id]].meshes)),P||(P=Bq(C)),P&&(A.footprint=Fq(P))}if(S.size>0){const E=Array.from(S.values()).sort((A,C)=>A-C);for(let A=E.length-1;A>=0;A--)g.splice(E[A],1)}}(p,d,n.json.nodes),p}function Vq(n){n.heightmap=new Float32Array(4096),n.heightmap.fill(-1);const t=n.vertexArray.float32,i=n.aabb.min[0]-1,o=n.aabb.min[1]-1,c=Vu/(n.aabb.max[0]-i+2),u=Vu/(n.aabb.max[1]-o+2);for(let d=0;d<t.length;d+=3){const p=t[d+2],g=(t[d+0]-i)*c|0,_=(t[d+1]-o)*u|0;p>n.heightmap[_*Vu+g]&&(n.heightmap[_*Vu+g]=p)}}function Uq(n,t){const i={};i.indexArray=new Hr,i.indexArray.reserve(4*n.length),i.vertexArray=new Ou,i.vertexArray.reserve(10*n.length),i.colorArray=new il,i.vertexArray.reserve(10*n.length);let o=0;for(const d of n){const p=Math.min(10,Math.max(4,1.3*d.height))*t,g=[-d.normal[1],d.normal[0],0],_=Math.min(.29,.1*d.width/d.depth),v=d.width-2*d.depth*t*(_+.01),b=ct.scaleAndAdd([],d.pos,g,v/2),S=ct.scaleAndAdd([],d.pos,g,-v/2),E=[b[0],b[1],b[2]+d.height],A=[S[0],S[1],S[2]+d.height],C=ct.scaleAndAdd([],d.normal,g,_);ct.scale(C,C,p);const P=ct.scaleAndAdd([],d.normal,g,-_);ct.scale(P,P,p),ct.add(C,b,C),ct.add(P,S,P),b[2]+=.1,S[2]+=.1,i.vertexArray.emplaceBack(C[0],C[1],C[2]),i.vertexArray.emplaceBack(P[0],P[1],P[2]),i.vertexArray.emplaceBack(b[0],b[1],b[2]),i.vertexArray.emplaceBack(S[0],S[1],S[2]),i.vertexArray.emplaceBack(E[0],E[1],E[2]),i.vertexArray.emplaceBack(A[0],A[1],A[2]),i.vertexArray.emplaceBack(b[0],b[1],b[2]),i.vertexArray.emplaceBack(S[0],S[1],S[2]),i.vertexArray.emplaceBack(C[0],C[1],C[2]),i.vertexArray.emplaceBack(P[0],P[1],P[2]);const k=v/p/2;i.colorArray.emplaceBack(-k-_,-1,k,.8),i.colorArray.emplaceBack(k+_,-1,k,.8),i.colorArray.emplaceBack(-k,0,k,1.3),i.colorArray.emplaceBack(k,0,k,1.3),i.colorArray.emplaceBack(k+_,-.8,k,.7),i.colorArray.emplaceBack(k+_,-.8,k,.7),i.colorArray.emplaceBack(0,0,k,1.3),i.colorArray.emplaceBack(0,0,k,1.3),i.colorArray.emplaceBack(k+_,-1.2,k,.8),i.colorArray.emplaceBack(k+_,-1.2,k,.8),i.indexArray.emplaceBack(6+o,4+o,8+o),i.indexArray.emplaceBack(7+o,9+o,5+o),i.indexArray.emplaceBack(0+o,1+o,2+o),i.indexArray.emplaceBack(1+o,3+o,2+o),o+=10}const c={defined:!0,emissiveFactor:[0,0,0]},u={};return u.baseColorFactor=tn.white,c.pbrMetallicRoughness=u,i.material=c,i.aabb=new nr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),i}Se(GL,"TriangleGridIndex");const yS={vector:LL,raster:lS,"raster-dem":class extends lS{constructor(n,t,i,o){super(n,t,i,o),this.type="raster-dem",this.maxzoom=22,this._options=Ct({type:"raster-dem"},t),this.encoding=t.encoding||"mapbox"}loadTile(n,t){const i=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function o(c,u){c&&(n.state="errored",t(c)),u&&(n.dem=u,n.dem.onDeserialize(),n.needsHillshadePrepare=!0,n.needsDEMTextureUpload=!0,n.state="loaded",t(null))}n.request=Ye(this.map._requestManager.transformRequest(i,zt.Tile),(function(c,u,d,p){if(delete n.request,n.aborted)n.state="unloaded",t(null);else if(c)n.state="errored",t(c);else if(u){this.map._refreshExpiredTiles&&n.setExpiryData({cacheControl:d,expires:p});const _=w.ImageBitmap&&u instanceof w.ImageBitmap&&va(),v=1-(u.width-((g=u.width)<=1?1:Math.pow(2,Math.floor(Math.log(g)/Math.LN2))))/2;v<1||n.neighboringTiles||(n.neighboringTiles=this._getNeighboringTiles(n.tileID));const b=_?u:Be.getImageData(u,v),S={uid:n.uid,coord:n.tileID,source:this.id,scope:this.scope,rawImageData:b,encoding:this.encoding,padding:v};n.actor&&n.state!=="expired"||(n.actor=this.dispatcher.getActor(),n.actor.send("loadDEMTile",S,o.bind(this),void 0,!0))}var g}).bind(this))}_getNeighboringTiles(n){const t=n.canonical,i=Math.pow(2,t.z),o=(t.x-1+i)%i,c=t.x===0?n.wrap-1:n.wrap,u=(t.x+1+i)%i,d=t.x+1===i?n.wrap+1:n.wrap,p={};return p[new Pn(n.overscaledZ,c,t.z,o,t.y).key]={backfilled:!1},p[new Pn(n.overscaledZ,d,t.z,u,t.y).key]={backfilled:!1},t.y>0&&(p[new Pn(n.overscaledZ,c,t.z,o,t.y-1).key]={backfilled:!1},p[new Pn(n.overscaledZ,n.wrap,t.z,t.x,t.y-1).key]={backfilled:!1},p[new Pn(n.overscaledZ,d,t.z,u,t.y-1).key]={backfilled:!1}),t.y+1<i&&(p[new Pn(n.overscaledZ,c,t.z,o,t.y+1).key]={backfilled:!1},p[new Pn(n.overscaledZ,n.wrap,t.z,t.x,t.y+1).key]={backfilled:!1},p[new Pn(n.overscaledZ,d,t.z,u,t.y+1).key]={backfilled:!1}),p}},geojson:class extends Mn{constructor(n,t,i,o){super(),this.id=n,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=i.getActor(),this.setEventedParent(o),this._data=t.data,this._options=Ct({},t),this._collectResourceTiming=t.collectResourceTiming,t.maxzoom!==void 0&&(this.maxzoom=t.maxzoom),t.type&&(this.type=t.type),t.attribution&&(this.attribution=t.attribution),this.promoteId=t.promoteId;const c=Dt/this.tileSize;this.workerOptions=Ct({source:this.id,scope:this.scope,cluster:t.cluster||!1,geojsonVtOptions:{buffer:(t.buffer!==void 0?t.buffer:128)*c,tolerance:(t.tolerance!==void 0?t.tolerance:.375)*c,extent:Dt,maxZoom:this.maxzoom,lineMetrics:t.lineMetrics||!1,generateId:t.generateId||!1},superclusterOptions:{maxZoom:t.clusterMaxZoom!==void 0?t.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,t.clusterMinPoints||2),extent:Dt,radius:(t.clusterRadius!==void 0?t.clusterRadius:50)*c,log:!1,generateId:t.generateId||!1},clusterProperties:t.clusterProperties,filter:t.filter},t.workerOptions)}onAdd(n){this.map=n,this.setData(this._data)}setData(n){return this._data=n,this._updateWorkerData(),this}getClusterExpansionZoom(n,t){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:n,source:this.id,scope:this.scope},t),this}getClusterChildren(n,t){return this.actor.send("geojson.getClusterChildren",{clusterId:n,source:this.id,scope:this.scope},t),this}getClusterLeaves(n,t,i,o){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:n,limit:t,offset:i},o),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new Bt("dataloading",{dataType:"source"})),this._loaded=!1;const n=Ct({},this.workerOptions);n.scope=this.scope;const t=this._data;typeof t=="string"?(n.request=this.map._requestManager.transformRequest(Be.resolveURL(t),zt.Source),n.request.collectResourceTiming=this._collectResourceTiming):n.data=JSON.stringify(t),this._pendingLoad=this.actor.send(`${this.type}.loadData`,n,(i,o)=>{if(this._loaded=!0,this._pendingLoad=null,i)this.fire(new xe(i));else{const c={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&o&&o.resourceTiming&&o.resourceTiming[this.id]&&(c.resourceTiming=o.resourceTiming[this.id]),this.fire(new Bt("data",c)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(n,t){const i=n.actor?"reloadTile":"loadTile";n.actor=this.actor;const o={type:this.type,uid:n.uid,tileID:n.tileID,tileZoom:n.tileZoom,zoom:n.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,scope:this.scope,pixelRatio:Be.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0};n.request=this.actor.send(i,o,(c,u)=>(delete n.request,n.destroy(),n.aborted?t(null):c?t(c):(n.loadVectorData(u,this.map.painter,i==="reloadTile"),t(null))),void 0,i==="loadTile")}abortTile(n){n.request&&(n.request.cancel(),delete n.request),n.aborted=!0}unloadTile(n){this.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id,scope:this.scope}),n.destroy()}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return Ct({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Io{constructor(n,t,i,o){super(n,t,i,o),this.roundZoom=!0,this.type="video",this.options=t}load(){this._loaded=!1;const n=this.options;this.urls=[];for(const t of n.urls)this.urls.push(this.map._requestManager.transformRequest(t,zt.Source).url);(function(t,i){const o=w.document.createElement("video");o.muted=!0,o.onloadstart=function(){i(null,o)};for(let c=0;c<t.length;c++){const u=w.document.createElement("source");fe(t[c])||(o.crossOrigin="Anonymous"),u.src=t[c],o.appendChild(u)}})(this.urls,(t,i)=>{this._loaded=!0,t?this.fire(new xe(t)):i&&(this.video=i,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(n){if(this.video){const t=this.video.seekable;n<t.start(0)||n>t.end(0)?this.fire(new xe(new ie(`sources.${this.id}`,null,`Playback for this video can be set only between the ${t.start(0)} and ${t.end(0)}-second mark.`))):this.video.currentTime=n}}getVideo(){return this.video}onAdd(n){this.map||(this.map=n,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const n=this.map.painter.context,t=n.gl;this.texture?this.video.paused||(this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE),t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,this.video)):(this.texture=new _r(n,this.video,t.RGBA),this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(n)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Io,model:class extends Mn{constructor(n,t,i,o){super(),this.id=n,this.type="model",this.models=[],this._loaded=!1,this._options=t}load(){const n=[];for(const t in this._options.models){const i=this._options.models[t],o=$L(this.map._requestManager.transformRequest(i.uri,zt.Model).url).then(c=>{if(!c)return;const u=_S(c),d=new BO(t,i.position,i.orientation,u);d.computeBoundsAndApplyParent(),this.models.push(d)}).catch(c=>{this.fire(new xe(new Error(`Could not load model ${t} from ${i.uri}: ${c.message}`)))});n.push(o)}return Promise.allSettled(n).then(()=>{this._loaded=!0,this.fire(new Bt("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(t=>{this.fire(new xe(new Error(`Could not load models: ${t.message}`)))})}onAdd(n){this.map=n,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(n,t){}serialize(){return{type:"model"}}},"batched-model":class extends Mn{constructor(n,t,i,o){super(),this.type="batched-model",this.id=n,this.tileSize=512,this._options=t,this.tiles=this._options.tiles,this.maxzoom=t.maxzoom||19,this.minzoom=t.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=i,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(o)}onAdd(n){this.map=n,this.load()}load(n){this._loaded=!1,this.fire(new Bt("dataloading",{dataType:"source"}));const t=Array.isArray(this.map._language)?this.map._language.join():this.map._language,i=this.map._worldview;this._tileJSONRequest=oS(this._options,this.map._requestManager,t,i,(o,c)=>{this._tileJSONRequest=null,this._loaded=!0,o?(t&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${t}`),i&&i.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${i}`),this.fire(new xe(o))):c&&(Ct(this,c),c.bounds&&(this.tileBounds=new wy(c.bounds,this.minzoom,this.maxzoom)),bu(c.tiles,this.map._requestManager._customAccessToken),this.fire(new Bt("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new Bt("data",{dataType:"source",sourceDataType:"content"}))),n&&n(o)})}hasTransition(){return!1}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}loaded(){return this._loaded}loadTile(n,t){const i=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme)),o={request:this.map._requestManager.transformRequest(i,zt.Tile),data:void 0,uid:n.uid,tileID:n.tileID,tileZoom:n.tileZoom,zoom:n.tileID.overscaledZ,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:n.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0};if(n.actor&&n.state!=="expired")if(n.state==="loading")n.reloadCallback=t;else{if(n.buckets){const u=Object.values(n.buckets);for(const d of u)d.dirty=!0;return void(n.state="loaded")}n.request=n.actor.send("reloadTile",o,c.bind(this))}else n.actor=this.dispatcher.getActor(),n.request=n.actor.send("loadTile",o,c.bind(this),void 0,!0);function c(u,d){return n.aborted?t(null):u&&u.status!==404?t(u):(d&&(d.resourceTiming&&(n.resourceTiming=d.resourceTiming),this.map._refreshExpiredTiles&&n.setExpiryData(d),n.buckets={...n.buckets,...d.buckets}),n.state="loaded",void t(null))}}serialize(){return Ct({},this._options)}},canvas:class extends Io{constructor(n,t,i,o){super(n,t,i,o),t.coordinates?Array.isArray(t.coordinates)&&t.coordinates.length===4&&!t.coordinates.some(c=>!Array.isArray(c)||c.length!==2||c.some(u=>typeof u!="number"))||this.fire(new xe(new ie(`sources.${n}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new xe(new ie(`sources.${n}`,null,'missing required property "coordinates"'))),t.animate&&typeof t.animate!="boolean"&&this.fire(new xe(new ie(`sources.${n}`,null,'optional "animate" property must be a boolean value'))),t.canvas?typeof t.canvas=="string"||t.canvas instanceof w.HTMLCanvasElement||this.fire(new xe(new ie(`sources.${n}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new xe(new ie(`sources.${n}`,null,'missing required property "canvas"'))),this.options=t,this.animate=t.animate===void 0||t.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof w.HTMLCanvasElement?this.options.canvas:w.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new xe(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(n){this.map=n,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let n=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,n=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,n=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const t=this.map.painter.context;this.texture?!n&&!this._playing||this.texture instanceof cy||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new _r(t,this.canvas,t.gl.RGBA,{premultiply:!0}),this._prepareData(t)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const n of[this.canvas.width,this.canvas.height])if(isNaN(n)||n<=0)return!0;return!1}},custom:class extends Mn{constructor(n,t,i,o){super(),this.id=n,this.type="custom",this._dataType="raster",this._dispatcher=i,this._implementation=t,this.setEventedParent(o),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new xe(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new xe(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new wy(this._implementation.bounds,this.minzoom,this.maxzoom)),t.update=this._update.bind(this),t.clearTiles=this._clearTiles.bind(this),t.coveringTiles=this._coveringTiles.bind(this),Ct(this,Ae(t,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return Ae(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new Bt("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new Bt("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(n){this._map=n,this._loaded=!1,this.fire(new Bt("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(n),this.load()}onRemove(n){this._implementation.onRemove&&this._implementation.onRemove(n)}hasTile(n){if(this._implementation.hasTile){const{x:t,y:i,z:o}=n.canonical;return this._implementation.hasTile({x:t,y:i,z:o})}return!this.tileBounds||this.tileBounds.contains(n.canonical)}loadTile(n,t){const{x:i,y:o,z:c}=n.tileID.canonical,u=new w.AbortController;n.request=Promise.resolve(this._implementation.loadTile({x:i,y:o,z:c},{signal:u.signal})).then((function(d){return delete n.request,n.aborted?(n.state="unloaded",t(null)):d===void 0?(n.state="errored",t(null)):d===null?(this.loadTileData(n,{width:this.tileSize,height:this.tileSize,data:null}),n.state="loaded",t(null)):function(p){return p instanceof w.ImageData||p instanceof w.HTMLCanvasElement||p instanceof w.ImageBitmap||p instanceof w.HTMLImageElement}(d)?(this.loadTileData(n,d),n.state="loaded",void t(null)):(n.state="errored",t(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(d=>{d.code!==20&&(n.state="errored",t(d))}),n.request.cancel=()=>u.abort()}loadTileData(n,t){n.setTexture(t,this._map.painter)}unloadTile(n,t){if(n.texture&&n.texture instanceof _r?(n.destroy(!0),n.texture&&n.texture instanceof _r&&this._map.painter.saveTileTexture(n.texture)):n.destroy(),this._implementation.unloadTile){const{x:i,y:o,z:c}=n.tileID.canonical;this._implementation.unloadTile({x:i,y:o,z:c})}t()}abortTile(n,t){n.request&&n.request.cancel&&(n.request.cancel(),delete n.request),t()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(n=>({x:n.canonical.x,y:n.canonical.y,z:n.canonical.z}))}_clearTiles(){const n=Xi(this.id,this.scope);this._map.style.clearSource(n)}_update(){this.fire(new Bt("data",{dataType:"source",sourceDataType:"content"}))}}},vS=function(n,t,i,o){const c=new yS[t.type](n,t,i,o);if(c.id!==n)throw new Error(`Expected Source id to be ${n} instead of ${c.id}`);return Ne(["load","abort","unload","serialize","prepare"],c),c};function $q(n,t){const i=wt.identity([]);return wt.scale(i,i,[.5*n.width,.5*-n.height,1]),wt.translate(i,i,[1,-1,0]),wt.multiply(i,i,n.calculateProjMatrix(t.toUnwrapped())),Float32Array.from(i)}function Gq(n,t,i,o,c,u,d,p=!1){const g=n.tilesIn(o,d,p);g.sort(HL);const _=[];for(const b of g)_.push({wrappedTileID:b.tile.tileID.wrapped().key,queryResults:b.tile.queryRenderedFeatures(t,i,n._state,b,c,u,$q(n.transform,b.tile.tileID),p)});const v=function(b){const S={},E={};for(const A of b){const C=A.queryResults,P=A.wrappedTileID,k=E[P]=E[P]||{};for(const L in C){const j=C[L],V=k[L]=k[L]||{},F=S[L]=S[L]||[];for(const U of j)V[U.featureIndex]||(V[U.featureIndex]=!0,F.push(U))}}return S}(_);for(const b in v)v[b].forEach(S=>{const E=S.feature,A=E.layer;A&&A.type!=="background"&&A.type!=="sky"&&A.type!=="slot"&&(E.source=A.source,A["source-layer"]&&(E.sourceLayer=A["source-layer"]),E.state=E.id!==void 0?n.getFeatureState(A["source-layer"],E.id):{})});return v}function Wq(n,t){const i=n.getRenderableIds().map(u=>n.getTileByID(u)),o=[],c={};for(let u=0;u<i.length;u++){const d=i[u],p=d.tileID.canonical.key;c[p]||(c[p]=!0,d.querySourceFeatures(o,t))}return o}function HL(n,t){const i=n.tileID,o=t.tileID;return i.overscaledZ-o.overscaledZ||i.canonical.y-o.canonical.y||i.wrap-o.wrap||i.canonical.x-o.canonical.x}class Hq{constructor(t){this.style=t}processLayersChanged(){this.layers=[];for(const t in this.style._mergedLayers){const i=this.style._mergedLayers[t];if(i.type==="fill-extrusion")this.layers.push(i);else if(i.type==="model"){const o=this.style.getLayerSource(i);o&&o.type==="batched-model"&&this.layers.push(i)}}}updateZOffset(t,i){this.currentBuildingBuckets=[];for(let c=0;c<this.layers.length;++c){const u=this.layers[c],d=this.style.getLayerSourceCache(u);let p=1;u.type==="fill-extrusion"&&(p=u.paint.get("fill-extrusion-opacity")>0?u.paint.get("fill-extrusion-vertical-scale"):0);let g=d?d.getTile(i):null;if(!g&&d&&i.canonical.z>d.getSource().minzoom){let _=i.scaledTo(Math.min(d.getSource().maxzoom,i.overscaledZ-1));for(;_.overscaledZ>=d.getSource().minzoom&&(g=d.getTile(_),!g&&_.overscaledZ!==0);)_=_.scaledTo(_.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:g?g.getBucket(u):null,tileID:g?g.tileID:i,verticalScale:p})}t.hasAnyZOffset=!1;let o=!1;for(let c=0;c<t.symbolInstances.length;c++){const u=t.symbolInstances.get(c),d=u.zOffset,p=this._getHeightAtTileOffset(i,u.tileAnchorX,u.tileAnchorY);u.zOffset=p!==-1?p:d,o||d===u.zOffset||(o=!0),t.hasAnyZOffset||u.zOffset===0||(t.hasAnyZOffset=!0)}o&&(t.zOffsetBuffersNeedUpload=!0,t.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(t,i,o,c){let u=i,d=o;if(t.canonical.z!==c.canonical.z){const p=c.canonical,g=1/(1<<t.canonical.z-p.z);u=(i+t.canonical.x*Dt)*g-p.x*Dt|0,d=(o+t.canonical.y*Dt)*g-p.y*Dt|0}return{tileX:u,tileY:d}}_getHeightAtTileOffset(t,i,o){let c;for(let u=0;u<this.layers.length;++u){if(this.layers[u].type!=="fill-extrusion")continue;const{bucket:d,tileID:p,verticalScale:g}=this.currentBuildingBuckets[u];if(!d)continue;const{tileX:_,tileY:v}=this._mapCoordToOverlappingTile(t,i,o,p),b=d.getHeightAtTileCoord(_,v);if(b&&b.height!==void 0){if(!b.hidden)return b.height*g;c=b.height}}for(let u=0;u<this.layers.length;++u){if(this.layers[u].type!=="model")continue;const{bucket:d,tileID:p}=this.currentBuildingBuckets[u];if(!d)continue;const{tileX:g,tileY:_}=this._mapCoordToOverlappingTile(t,i,o,p),v=d.getHeightAtTileCoord(g,_);if(v&&!v.hidden)return v.height===void 0&&c!==void 0?Math.min(v.maxHeight,c)*v.verticalScale:(v.height||0)*v.verticalScale}return-1}}var qL=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function qq(n,t){const i={};for(const o in n)o!=="ref"&&(i[o]=n[o]);return qL.forEach(o=>{o in t&&(i[o]=t[o])}),i}function ZL(n){n=n.slice();const t=Object.create(null);for(let i=0;i<n.length;i++)t[n[i].id]=n[i];for(let i=0;i<n.length;i++)"ref"in n[i]&&(n[i]=qq(n[i],t[n[i].ref]));return n}const Dn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",setImportUrl:"setImportUrl",setImportData:"setImportData",setImportConfig:"setImportConfig"};function XL(n,t,i){i.push({command:Dn.addSource,args:[n,t[n]]})}function YL(n,t,i){t.push({command:Dn.removeSource,args:[n]}),i[n]=!0}function Zq(n,t,i,o){YL(n,i,o),XL(n,t,i)}function Xq(n,t,i){let o;for(o in n[i])if(n[i].hasOwnProperty(o)&&o!=="data"&&!Q(n[i][o],t[i][o]))return!1;for(o in t[i])if(t[i].hasOwnProperty(o)&&o!=="data"&&!Q(n[i][o],t[i][o]))return!1;return!0}function Ty(n,t,i,o,c,u){let d;for(d in t=t||{},n=n||{})n.hasOwnProperty(d)&&(Q(n[d],t[d])||i.push({command:u,args:[o,d,t[d],c]}));for(d in t)t.hasOwnProperty(d)&&!n.hasOwnProperty(d)&&(Q(n[d],t[d])||i.push({command:u,args:[o,d,t[d],c]}))}function Ey(n){return n.id}function My(n,t){return n[t.id]=t,n}class Yq{constructor(t,i){this.reset(t,i)}reset(t,i){this.points=t||[],this._distances=[0];for(let o=1;o<this.points.length;o++)this._distances[o]=this._distances[o-1]+this.points[o].dist(this.points[o-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(i||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(this.points.length===1)return this.points[0];t=Ot(t,0,1);let i=1,o=this._distances[i];const c=t*this.paddedLength+this.padding;for(;o<c&&i<this._distances.length;)o=this._distances[++i];const u=i-1,d=this._distances[u],p=o-d,g=p>0?(c-d)/p:0;return this.points[u].mult(1-g).add(this.points[i].mult(g))}}class KL{constructor(t,i,o){const c=this.boxCells=[],u=this.circleCells=[];this.xCellCount=Math.ceil(t/o),this.yCellCount=Math.ceil(i/o);for(let d=0;d<this.xCellCount*this.yCellCount;d++)c.push([]),u.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=i,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/i,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,i,o,c,u){this._forEachCell(i,o,c,u,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(i),this.bboxes.push(o),this.bboxes.push(c),this.bboxes.push(u)}insertCircle(t,i,o,c){this._forEachCell(i-c,o-c,i+c,o+c,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(i),this.circles.push(o),this.circles.push(c)}_insertBoxCell(t,i,o,c,u,d){this.boxCells[u].push(d)}_insertCircleCell(t,i,o,c,u,d){this.circleCells[u].push(d)}_query(t,i,o,c,u,d){if(o<0||t>this.width||c<0||i>this.height)return!u&&[];const p=[];if(t<=0&&i<=0&&this.width<=o&&this.height<=c){if(u)return!0;for(let g=0;g<this.boxKeys.length;g++)p.push({key:this.boxKeys[g],x1:this.bboxes[4*g],y1:this.bboxes[4*g+1],x2:this.bboxes[4*g+2],y2:this.bboxes[4*g+3]});for(let g=0;g<this.circleKeys.length;g++){const _=this.circles[3*g],v=this.circles[3*g+1],b=this.circles[3*g+2];p.push({key:this.circleKeys[g],x1:_-b,y1:v-b,x2:_+b,y2:v+b})}return d?p.filter(d):p}return this._forEachCell(t,i,o,c,this._queryCell,p,{hitTest:u,seenUids:{box:{},circle:{}}},d),u?p.length>0:p}_queryCircle(t,i,o,c,u){const d=t-o,p=t+o,g=i-o,_=i+o;if(p<0||d>this.width||_<0||g>this.height)return!c&&[];const v=[];return this._forEachCell(d,g,p,_,this._queryCellCircle,v,{hitTest:c,circle:{x:t,y:i,radius:o},seenUids:{box:{},circle:{}}},u),c?v.length>0:v}query(t,i,o,c,u){return this._query(t,i,o,c,!1,u)}hitTest(t,i,o,c,u){return this._query(t,i,o,c,!0,u)}hitTestCircle(t,i,o,c){return this._queryCircle(t,i,o,!0,c)}_queryCell(t,i,o,c,u,d,p,g){const _=p.seenUids,v=this.boxCells[u];if(v!==null){const S=this.bboxes;for(const E of v)if(!_.box[E]){_.box[E]=!0;const A=4*E;if(t<=S[A+2]&&i<=S[A+3]&&o>=S[A+0]&&c>=S[A+1]&&(!g||g(this.boxKeys[E]))){if(p.hitTest)return d.push(!0),!0;d.push({key:this.boxKeys[E],x1:S[A],y1:S[A+1],x2:S[A+2],y2:S[A+3]})}}}const b=this.circleCells[u];if(b!==null){const S=this.circles;for(const E of b)if(!_.circle[E]){_.circle[E]=!0;const A=3*E;if(this._circleAndRectCollide(S[A],S[A+1],S[A+2],t,i,o,c)&&(!g||g(this.circleKeys[E]))){if(p.hitTest)return d.push(!0),!0;{const C=S[A],P=S[A+1],k=S[A+2];d.push({key:this.circleKeys[E],x1:C-k,y1:P-k,x2:C+k,y2:P+k})}}}}}_queryCellCircle(t,i,o,c,u,d,p,g){const _=p.circle,v=p.seenUids,b=this.boxCells[u];if(b!==null){const E=this.bboxes;for(const A of b)if(!v.box[A]){v.box[A]=!0;const C=4*A;if(this._circleAndRectCollide(_.x,_.y,_.radius,E[C+0],E[C+1],E[C+2],E[C+3])&&(!g||g(this.boxKeys[A])))return d.push(!0),!0}}const S=this.circleCells[u];if(S!==null){const E=this.circles;for(const A of S)if(!v.circle[A]){v.circle[A]=!0;const C=3*A;if(this._circlesCollide(E[C],E[C+1],E[C+2],_.x,_.y,_.radius)&&(!g||g(this.circleKeys[A])))return d.push(!0),!0}}}_forEachCell(t,i,o,c,u,d,p,g){const _=this._convertToXCellCoord(t),v=this._convertToYCellCoord(i),b=this._convertToXCellCoord(o),S=this._convertToYCellCoord(c);for(let E=_;E<=b;E++)for(let A=v;A<=S;A++)if(u.call(this,t,i,o,c,this.xCellCount*A+E,d,p,g))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,i,o,c,u,d){const p=c-t,g=u-i,_=o+d;return _*_>p*p+g*g}_circleAndRectCollide(t,i,o,c,u,d,p){const g=(d-c)/2,_=Math.abs(t-(c+g));if(_>g+o)return!1;const v=(p-u)/2,b=Math.abs(i-(u+v));if(b>v+o)return!1;if(_<=g||b<=v)return!0;const S=_-g,E=b-v;return S*S+E*E<=o*o}}const Da=100;class Kq{constructor(t,i,o=new KL(t.width+200,t.height+200,25),c=new KL(t.width+200,t.height+200,25)){this.transform=t,this.grid=o,this.ignoredGrid=c,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+Da,this.screenBottomBoundary=t.height+Da,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.fogState=i}placeCollisionBox(t,i,o,c,u,d,p,g){let _=o.projectedAnchorX,v=o.projectedAnchorY,b=o.projectedAnchorZ;const S=o.elevation,E=o.tileID,A=t.getProjection();if(S&&E){const[U,q,Z]=A.upVector(E.canonical,o.tileAnchorX,o.tileAnchorY),X=A.upVectorScale(E.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;_+=U*S*X,v+=q*S*X,b+=Z*S*X}const C=this.projectAndGetPerspectiveRatio(p,_,v,b,o.tileID,A.name==="globe"||!!S||this.transform.pitch>0,A),P=d*C.perspectiveRatio,k=(o.x1*i+c.x-o.padding)*P+C.point.x,L=(o.y1*i+c.y-o.padding)*P+C.point.y,j=(o.x2*i+c.x+o.padding)*P+C.point.x,V=(o.y2*i+c.y+o.padding)*P+C.point.y,F=C.perspectiveRatio<=.55||C.occluded;return!this.isInsideGrid(k,L,j,V)||!u&&this.grid.hitTest(k,L,j,V,g)||F?{box:[],offscreen:!1,occluded:C.occluded}:{box:[k,L,j,V],offscreen:this.isOffscreen(k,L,j,V),occluded:!1}}placeCollisionCircles(t,i,o,c,u,d,p,g,_,v,b,S,E,A,C){const P=[],k=this.transform.elevation,L=t.getProjection(),j=k?k.getAtTileOffsetFunc(C,this.transform.center.lat,this.transform.worldSize,L):null,V=new W(o.tileAnchorX,o.tileAnchorY);let{x:F,y:U,z:q}=L.projectTilePoint(V.x,V.y,C.canonical);if(j){const[xt,ht,pt]=j(V);F+=xt,U+=ht,q+=pt}const Z=L.name==="globe",X=this.projectAndGetPerspectiveRatio(p,F,U,q,C,Z||!!k||this.transform.pitch>0,L),{perspectiveRatio:J}=X,rt=(b?d/J:d*J)/xi,it=ta(F,U,q,g),ut=X.signedDistanceFromCamera>0?PO(rt,u,o.lineOffsetX*rt,o.lineOffsetY*rt,!1,it,V,o,c,g,{},k&&!b?j:null,b&&!!k,L,C,b):null;let tt=!1,dt=!1,gt=!0;if(ut&&!X.occluded){const xt=.5*E*J+A,ht=new W(-100,-100),pt=new W(this.screenRightBoundary,this.screenBottomBoundary),Et=new Yq,{first:At,last:Mt}=ut,Lt=At.path.length;let Nt=[];for(let Gt=Lt-1;Gt>=1;Gt--)Nt.push(At.path[Gt]);for(let Gt=1;Gt<Mt.path.length;Gt++)Nt.push(Mt.path[Gt]);const jt=2.5*xt;_&&(Nt=Nt.map(([Gt,ce,ue],ye)=>(j&&!Z&&(ue=j(ye<Lt-1?At.tilePath[Lt-1-ye]:Mt.tilePath[ye-Lt+2])[2]),ta(Gt,ce,ue,_))),Nt.some(Gt=>Gt[3]<=0)&&(Nt=[]));let It=[];if(Nt.length>0){let Gt=1/0,ce=-1/0,ue=1/0,ye=-1/0;for(const be of Nt)Gt=Math.min(Gt,be[0]),ue=Math.min(ue,be[1]),ce=Math.max(ce,be[0]),ye=Math.max(ye,be[1]);ce>=ht.x&&Gt<=pt.x&&ye>=ht.y&&ue<=pt.y&&(It=[Nt.map(be=>new W(be[0],be[1]))],(Gt<ht.x||ce>pt.x||ue<ht.y||ye>pt.y)&&(It=JR(It,ht.x,ht.y,pt.x,pt.y)))}for(const Gt of It){Et.reset(Gt,.25*xt);let ce=0;ce=Et.length<=.5*xt?1:Math.ceil(Et.paddedLength/jt)+1;for(let ue=0;ue<ce;ue++){const ye=ue/Math.max(ce-1,1),be=Et.lerp(ye),We=be.x+Da,Pe=be.y+Da;P.push(We,Pe,xt,0);const Tn=We-xt,fn=Pe-xt,He=We+xt,Ue=Pe+xt;if(gt=gt&&this.isOffscreen(Tn,fn,He,Ue),dt=dt||this.isInsideGrid(Tn,fn,He,Ue),!i&&this.grid.hitTestCircle(We,Pe,xt,S)&&(tt=!0,!v))return{circles:[],offscreen:!1,collisionDetected:tt,occluded:!1}}}}return{circles:!v&&tt||!dt?[]:P,offscreen:gt,collisionDetected:tt,occluded:X.occluded}}queryRenderedSymbols(t){if(t.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const i=[];let o=1/0,c=1/0,u=-1/0,d=-1/0;for(const v of t){const b=new W(v.x+Da,v.y+Da);o=Math.min(o,b.x),c=Math.min(c,b.y),u=Math.max(u,b.x),d=Math.max(d,b.y),i.push(b)}const p=this.grid.query(o,c,u,d).concat(this.ignoredGrid.query(o,c,u,d)),g={},_={};for(const v of p){const b=v.key;g[b.bucketInstanceId]===void 0&&(g[b.bucketInstanceId]={}),g[b.bucketInstanceId][b.featureIndex]||nR(i,[new W(v.x1,v.y1),new W(v.x2,v.y1),new W(v.x2,v.y2),new W(v.x1,v.y2)])&&(g[b.bucketInstanceId][b.featureIndex]=!0,_[b.bucketInstanceId]===void 0&&(_[b.bucketInstanceId]=[]),_[b.bucketInstanceId].push(b.featureIndex))}return _}insertCollisionBox(t,i,o,c,u){(i?this.ignoredGrid:this.grid).insert({bucketInstanceId:o,featureIndex:c,collisionGroupID:u},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,i,o,c,u){const d=i?this.ignoredGrid:this.grid,p={bucketInstanceId:o,featureIndex:c,collisionGroupID:u};for(let g=0;g<t.length;g+=4)d.insertCircle(p,t[g],t[g+1],t[g+2])}projectAndGetPerspectiveRatio(t,i,o,c,u,d,p){const g=[i,o,c,1];let _=!1;c||this.transform.pitch>0?(jn.transformMat4(g,g,t),this.fogState&&u&&p.name!=="globe"&&(_=function(S,E,A,C,P,k){const L=k.calculateFogTileMatrix(P),j=[E,A,C];return ct.transformMat4(j,j,L),by(S,ct.length(j),k.pitch,k._fov)}(this.fogState,i,o,c,u.toUnwrapped(),this.transform)>.9)):OO(g,g,t);const v=g[3];return{point:new W((g[0]/v+1)/2*this.transform.width+Da,(-g[1]/v+1)/2*this.transform.height+Da),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(p)/v*.5,1.5),signedDistanceFromCamera:v,occluded:d&&g[2]>v||_}}isOffscreen(t,i,o,c){return o<Da||t>=this.screenRightBoundary||c<Da||i>this.screenBottomBoundary}isInsideGrid(t,i,o,c){return o>=0&&t<this.gridRightBoundary&&c>=0&&i<this.gridBottomBoundary}getViewportMatrix(){const t=wt.identity([]);return wt.translate(t,t,[-100,-100,0]),t}}function xS(n,t,i){const o=t.createTileMatrix(n,n.worldSize,i.toUnwrapped());return wt.multiply(new Float32Array(16),n.projMatrix,o)}function Jq(n,t,i){if(t.projection.name===i.projection.name)return n.projMatrix;const o=i.clone();return o.setProjection(t.projection),xS(o,t.getProjection(),n)}function bS(n,t,i){return t.name===i.projection.name?n.projMatrix:xS(i,t,n)}class JL{constructor(t,i,o,c){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?i:-i))):c&&o?1:0,this.placed=o}isHidden(){return this.opacity===0&&!this.placed}}class Rp{constructor(t,i,o,c,u,d=!1){this.text=new JL(t?t.text:null,i,o,u),this.icon=new JL(t?t.icon:null,i,c,u),this.clipped=d}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class wS{constructor(t,i,o,c=!1){this.text=t,this.icon=i,this.skipFade=o,this.clipped=c}}class Qq{constructor(){this.invProjMatrix=wt.create(),this.viewportMatrix=wt.create(),this.circles=[]}}class tZ{constructor(t,i,o,c,u){this.bucketInstanceId=t,this.featureIndex=i,this.sourceLayerIndex=o,this.bucketIndex=c,this.tileID=u}}class eZ{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const i=++this.maxGroupID;this.collisionGroups[t]={ID:i,predicate:o=>o.collisionGroupID===i}}return this.collisionGroups[t]}}function QL(n,t,i,o,c){const{horizontalAlign:u,verticalAlign:d}=Z_(n),p=-(u-.5)*t,g=-(d-.5)*i,_=Bw(n,o);return new W(p+_[0]*c,g+_[1]*c)}function SS(n,t,i,o,c){const u=new W(n,t);return i&&u._rotate(o?c:-c),u}class nZ{constructor(t,i,o,c,u,d){this.transform=t.clone(),this.projection=t.projection.name,this.collisionIndex=new Kq(this.transform,u),this.buildingIndex=d,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=i,this.retainedQueryData={},this.collisionGroups=new eZ(o),this.collisionCircleArrays={},this.prevPlacement=c,c&&(c.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(t,i,o,c){const u=o.getBucket(i),d=o.latestFeatureIndex;if(!u||!d||i.fqid!==u.layerIds[0])return;const p=u.layers[0].layout,g=o.collisionBoxArray,_=Math.pow(2,this.transform.zoom-o.tileID.overscaledZ),v=o.tileSize/Dt,b=o.tileID.toUnwrapped();this.transform.setProjection(u.projection);const S=(E=o.tileID,A=u.getProjection(),C=this.transform,A.name===this.projection?C.calculateProjMatrix(E.toUnwrapped()):xS(C,A,E));var E,A,C;const P=p.get("text-pitch-alignment")==="map",k=p.get("text-rotation-alignment")==="map";i.compileFilter();const L=i.dynamicFilter(),j=i.dynamicFilterNeedsFeature(),V=this.transform.calculatePixelsToTileUnitsMatrix(o),F=MO(S,o.tileID.canonical,P,k,this.transform,u.getProjection(),V);let U=null;if(P){const X=AO(S,o.tileID.canonical,P,k,this.transform,u.getProjection(),V);U=wt.multiply([],this.transform.labelPlaneMatrix,X)}let q=null;L&&o.latestFeatureIndex&&(q={unwrappedTileID:b,dynamicFilter:L,dynamicFilterNeedsFeature:j,featureIndex:o.latestFeatureIndex}),this.retainedQueryData[u.bucketInstanceId]=new tZ(u.bucketInstanceId,d,u.sourceLayerIndex,u.index,o.tileID);const Z={bucket:u,layout:p,posMatrix:S,textLabelPlaneMatrix:F,labelToScreenMatrix:U,clippingData:q,scale:_,textPixelRatio:v,holdingForFade:o.holdingForFade(),collisionBoxArray:g,partiallyEvaluatedTextSize:Ca(u.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:Ca(u.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(u.sourceID)};if(c)for(const X of u.sortKeyRanges){const{sortKey:J,symbolInstanceStart:rt,symbolInstanceEnd:it}=X;t.push({sortKey:J,symbolInstanceStart:rt,symbolInstanceEnd:it,parameters:Z})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:u.symbolInstances.length,parameters:Z})}attemptAnchorPlacement(t,i,o,c,u,d,p,g,_,v,b,S,E,A,C,P,k,L){const{textOffset0:j,textOffset1:V,crossTileID:F}=S,U=[j,V],q=QL(t,o,c,U,u),Z=this.collisionIndex.placeCollisionBox(A,u,i,SS(q.x,q.y,d,p,this.transform.angle),b,g,_,v.predicate);if(P){const X=A.getSymbolInstanceIconSize(L,this.transform.zoom,S.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(A,X,P,SS(q.x,q.y,d,p,this.transform.angle),b,g,_,v.predicate).box.length===0)return}if(Z.box.length>0){let X;return this.prevPlacement&&this.prevPlacement.variableOffsets[F]&&this.prevPlacement.placements[F]&&this.prevPlacement.placements[F].text&&(X=this.prevPlacement.variableOffsets[F].anchor),this.variableOffsets[F]={textOffset:U,width:o,height:c,anchor:t,textScale:u,prevAnchor:X},this.markUsedJustification(A,t,S,C),A.allowVerticalPlacement&&(this.markUsedOrientation(A,C,S),this.placedOrientations[F]=C),{shift:q,placedGlyphBoxes:Z}}}placeLayerBucketPart(t,i,o,c){const{bucket:u,layout:d,posMatrix:p,textLabelPlaneMatrix:g,labelToScreenMatrix:_,clippingData:v,textPixelRatio:b,holdingForFade:S,collisionBoxArray:E,partiallyEvaluatedTextSize:A,partiallyEvaluatedIconSize:C,collisionGroup:P}=t.parameters,k=d.get("text-optional"),L=d.get("icon-optional"),j=d.get("text-allow-overlap"),V=d.get("icon-allow-overlap"),F=d.get("text-rotation-alignment")==="map",U=d.get("text-pitch-alignment")==="map",q=d.get("symbol-z-order")==="viewport-y",Z=d.get("symbol-z-elevate");this.transform.setProjection(u.projection);let X=j&&(V||!u.hasIconData()||L),J=V&&(j||!u.hasTextData()||k);!u.collisionArrays&&E&&u.deserializeCollisionBoxes(E),o&&c&&u.updateCollisionDebugBuffers(this.transform.zoom,E);const rt=(it,ut,tt)=>{const{crossTileID:dt,numVerticalGlyphVertices:gt}=it;if(v){const He={zoom:this.transform.zoom,pitch:this.transform.pitch};let Ue=null;if(v.dynamicFilterNeedsFeature){const Re=this.retainedQueryData[u.bucketInstanceId];Ue=v.featureIndex.loadFeature({featureIndex:it.featureIndex,bucketIndex:Re.bucketIndex,sourceLayerIndex:Re.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,v.dynamicFilter)(He,Ue,this.retainedQueryData[u.bucketInstanceId].tileID.canonical,new W(it.tileAnchorX,it.tileAnchorY),this.transform.calculateDistanceTileData(v.unwrappedTileID)))return this.placements[dt]=new wS(!1,!1,!1,!0),void i.add(dt)}if(i.has(dt))return;if(S)return void(this.placements[dt]=new wS(!1,!1,!1));let xt=!1,ht=!1,pt=!0,Et=!1,At=!1,Mt=null,Lt={box:null,offscreen:null,occluded:null},Nt={box:null,offscreen:null,occluded:null},jt=null,It=null,Gt=null,ce=0,ue=0,ye=0;tt.textFeatureIndex?ce=tt.textFeatureIndex:it.useRuntimeCollisionCircles&&(ce=it.featureIndex),tt.verticalTextFeatureIndex&&(ue=tt.verticalTextFeatureIndex);const be=He=>{He.tileID=this.retainedQueryData[u.bucketInstanceId].tileID;const Ue=this.transform.elevation;He.elevation=it.zOffset+(Ue?Ue.getAtTileOffset(He.tileID,He.tileAnchorX,He.tileAnchorY):0)},We=tt.textBox;if(We){be(We);const He=Re=>{let gn=dr.horizontal;if(u.allowVerticalPlacement&&!Re&&this.prevPlacement){const bn=this.prevPlacement.placedOrientations[dt];bn&&(this.placedOrientations[dt]=bn,gn=bn,this.markUsedOrientation(u,gn,it))}return gn},Ue=(Re,gn)=>{if(u.allowVerticalPlacement&&gt>0&&tt.verticalTextBox){for(const bn of u.writingModes)if(bn===dr.vertical?(Lt=gn(),Nt=Lt):Lt=Re(),Lt&&Lt.box&&Lt.box.length)break}else Lt=Re()};if(d.get("text-variable-anchor")){let Re=d.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[dt]){const sn=this.prevPlacement.variableOffsets[dt];Re.indexOf(sn.anchor)>0&&(Re=Re.filter(Gn=>Gn!==sn.anchor),Re.unshift(sn.anchor))}const gn=(sn,Gn,kr)=>{const Vn=u.getSymbolInstanceTextSize(A,it,this.transform.zoom,ut),rr=(sn.x2-sn.x1)*Vn+2*sn.padding,Or=(sn.y2-sn.y1)*Vn+2*sn.padding,Dr=it.hasIconTextFit&&!V?Gn:null;Dr&&be(Dr);let lr={box:[],offscreen:!1,occluded:!1};const zn=j?2*Re.length:Re.length;for(let Pi=0;Pi<zn;++Pi){const Oa=this.attemptAnchorPlacement(Re[Pi%Re.length],sn,rr,Or,Vn,F,U,b,p,P,Pi>=Re.length,it,ut,u,kr,Dr,A,C);if(Oa&&(lr=Oa.placedGlyphBoxes,lr&&lr.box&&lr.box.length)){xt=!0,Mt=Oa.shift;break}}return lr};Ue(()=>gn(We,tt.iconBox,dr.horizontal),()=>{const sn=tt.verticalTextBox;return sn&&be(sn),u.allowVerticalPlacement&&!(Lt&&Lt.box&&Lt.box.length)&&gt>0&&sn?gn(sn,tt.verticalIconBox,dr.vertical):{box:null,offscreen:null,occluded:null}}),Lt&&(xt=Lt.box,pt=Lt.offscreen,Et=Lt.occluded);const bn=He(!(!Lt||!Lt.box));if(!xt&&this.prevPlacement){const sn=this.prevPlacement.variableOffsets[dt];sn&&(this.variableOffsets[dt]=sn,this.markUsedJustification(u,sn.anchor,it,bn))}}else{const Re=(gn,bn)=>{const sn=u.getSymbolInstanceTextSize(A,it,this.transform.zoom,ut),Gn=this.collisionIndex.placeCollisionBox(u,sn,gn,new W(0,0),j,b,p,P.predicate);return Gn&&Gn.box&&Gn.box.length&&(this.markUsedOrientation(u,bn,it),this.placedOrientations[dt]=bn),Gn};Ue(()=>Re(We,dr.horizontal),()=>{const gn=tt.verticalTextBox;return u.allowVerticalPlacement&&gt>0&&gn?(be(gn),Re(gn,dr.vertical)):{box:null,offscreen:null,occluded:null}}),He(!!(Lt&&Lt.box&&Lt.box.length))}}if(jt=Lt,xt=jt&&jt.box&&jt.box.length>0,pt=jt&&jt.offscreen,Et=jt&&jt.occluded,it.useRuntimeCollisionCircles){const He=u.text.placedSymbolArray.get(it.centerJustifiedTextSymbolIndex>=0?it.centerJustifiedTextSymbolIndex:it.verticalPlacedTextSymbolIndex),Ue=hp(u.textSizeData,A,He),Re=d.get("text-padding");It=this.collisionIndex.placeCollisionCircles(u,j,He,u.lineVertexArray,u.glyphOffsetArray,Ue,p,g,_,o,U,P.predicate,it.collisionCircleDiameter*Ue/xi,Re,this.retainedQueryData[u.bucketInstanceId].tileID),xt=j||It.circles.length>0&&!It.collisionDetected,pt=pt&&It.offscreen,Et=It.occluded}if(tt.iconFeatureIndex&&(ye=tt.iconFeatureIndex),tt.iconBox){const He=Ue=>{be(Ue);const Re=it.hasIconTextFit&&Mt?SS(Mt.x,Mt.y,F,U,this.transform.angle):new W(0,0),gn=u.getSymbolInstanceIconSize(C,this.transform.zoom,it.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(u,gn,Ue,Re,V,b,p,P.predicate)};Nt&&Nt.box&&Nt.box.length&&tt.verticalIconBox?(Gt=He(tt.verticalIconBox),ht=Gt.box.length>0):(Gt=He(tt.iconBox),ht=Gt.box.length>0),pt=pt&&Gt.offscreen,At=Gt.occluded}const Pe=k||it.numHorizontalGlyphVertices===0&&gt===0,Tn=L||it.numIconVertices===0;if(Pe||Tn?Tn?Pe||(ht=ht&&xt):xt=ht&&xt:ht=xt=ht&&xt,xt&&jt&&jt.box&&this.collisionIndex.insertCollisionBox(jt.box,d.get("text-ignore-placement"),u.bucketInstanceId,Nt&&Nt.box&&ue?ue:ce,P.ID),ht&&Gt&&this.collisionIndex.insertCollisionBox(Gt.box,d.get("icon-ignore-placement"),u.bucketInstanceId,ye,P.ID),It&&(xt&&this.collisionIndex.insertCollisionCircles(It.circles,d.get("text-ignore-placement"),u.bucketInstanceId,ce,P.ID),o)){const He=u.bucketInstanceId;let Ue=this.collisionCircleArrays[He];Ue===void 0&&(Ue=this.collisionCircleArrays[He]=new Qq);for(let Re=0;Re<It.circles.length;Re+=4)Ue.circles.push(It.circles[Re+0]),Ue.circles.push(It.circles[Re+1]),Ue.circles.push(It.circles[Re+2]),Ue.circles.push(It.collisionDetected?1:0)}const fn=u.projection.name!=="globe";X=X&&(fn||!Et),J=J&&(fn||!At),this.placements[dt]=new wS(xt||X,ht||J,pt||u.justReloaded),i.add(dt)};if(Z&&this.buildingIndex&&(this.buildingIndex.updateZOffset(u,this.retainedQueryData[u.bucketInstanceId].tileID),u.updateZOffset()),q){const it=u.getSortedSymbolIndexes(this.transform.angle);for(let ut=it.length-1;ut>=0;--ut){const tt=it[ut];rt(u.symbolInstances.get(tt),tt,u.collisionArrays[tt])}u.hasAnyZOffset&&_t(`${u.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(u.hasAnyZOffset){const it=u.getSortedIndexesByZOffset();for(let ut=0;ut<it.length;++ut){const tt=it[ut];rt(u.symbolInstances.get(tt),tt,u.collisionArrays[tt])}}else for(let it=t.symbolInstanceStart;it<t.symbolInstanceEnd;it++)rt(u.symbolInstances.get(it),it,u.collisionArrays[it]);if(o&&u.bucketInstanceId in this.collisionCircleArrays){const it=this.collisionCircleArrays[u.bucketInstanceId];wt.invert(it.invProjMatrix,p),it.viewportMatrix=this.collisionIndex.getViewportMatrix()}u.justReloaded=!1}markUsedJustification(t,i,o,c){const{leftJustifiedTextSymbolIndex:u,centerJustifiedTextSymbolIndex:d,rightJustifiedTextSymbolIndex:p,verticalPlacedTextSymbolIndex:g,crossTileID:_}=o,v=jw(i),b=c===dr.vertical?g:v==="left"?u:v==="center"?d:v==="right"?p:-1;u>=0&&(t.text.placedSymbolArray.get(u).crossTileID=b>=0&&u!==b?0:_),d>=0&&(t.text.placedSymbolArray.get(d).crossTileID=b>=0&&d!==b?0:_),p>=0&&(t.text.placedSymbolArray.get(p).crossTileID=b>=0&&p!==b?0:_),g>=0&&(t.text.placedSymbolArray.get(g).crossTileID=b>=0&&g!==b?0:_)}markUsedOrientation(t,i,o){const c=i===dr.horizontal||i===dr.horizontalOnly?i:0,u=i===dr.vertical?i:0,{leftJustifiedTextSymbolIndex:d,centerJustifiedTextSymbolIndex:p,rightJustifiedTextSymbolIndex:g,verticalPlacedTextSymbolIndex:_}=o,v=t.text.placedSymbolArray;d>=0&&(v.get(d).placedOrientation=c),p>=0&&(v.get(p).placedOrientation=c),g>=0&&(v.get(g).placedOrientation=c),_>=0&&(v.get(_).placedOrientation=u)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const i=this.prevPlacement;let o=!1;this.prevZoomAdjustment=i?i.zoomAdjustment(this.transform.zoom):0;const c=i?i.symbolFadeChange(t):1,u=i?i.opacities:{},d=i?i.variableOffsets:{},p=i?i.placedOrientations:{};for(const g in this.placements){const _=this.placements[g],v=u[g];v?(this.opacities[g]=new Rp(v,c,_.text,_.icon,null,_.clipped),o=o||_.text!==v.text.placed||_.icon!==v.icon.placed):(this.opacities[g]=new Rp(null,c,_.text,_.icon,_.skipFade,_.clipped),o=o||_.text||_.icon)}for(const g in u){const _=u[g];if(!this.opacities[g]){const v=new Rp(_,c,!1,!1);v.isHidden()||(this.opacities[g]=v,o=o||_.text.placed||_.icon.placed)}}for(const g in d)this.variableOffsets[g]||!this.opacities[g]||this.opacities[g].isHidden()||(this.variableOffsets[g]=d[g]);for(const g in p)this.placedOrientations[g]||!this.opacities[g]||this.opacities[g].isHidden()||(this.placedOrientations[g]=p[g]);o?this.lastPlacementChangeTime=t:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=i?i.lastPlacementChangeTime:t)}updateLayerOpacities(t,i){const o=new Set;for(const c of i){const u=c.getBucket(t);u&&c.latestFeatureIndex&&t.fqid===u.layerIds[0]&&(this.updateBucketOpacities(u,o,c.collisionBoxArray),u.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(u,c.tileID),u.updateZOffset()))}}updateBucketOpacities(t,i,o){t.hasTextData()&&t.text.opacityVertexArray.clear(),t.hasIconData()&&t.icon.opacityVertexArray.clear(),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const c=t.layers[0].layout,u=!!t.layers[0].dynamicFilter(),d=new Rp(null,0,!1,!1,!0),p=c.get("text-allow-overlap"),g=c.get("icon-allow-overlap"),_=c.get("text-variable-anchor"),v=c.get("text-rotation-alignment")==="map",b=c.get("text-pitch-alignment")==="map",S=new Rp(null,0,p&&(g||!t.hasIconData()||c.get("icon-optional")),g&&(p||!t.hasTextData()||c.get("text-optional")),!0);!t.collisionArrays&&o&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(o);const E=(C,P,k)=>{for(let L=0;L<P/4;L++)C.opacityVertexArray.emplaceBack(k)};let A=0;for(let C=0;C<t.symbolInstances.length;C++){const P=t.symbolInstances.get(C),{numHorizontalGlyphVertices:k,numVerticalGlyphVertices:L,crossTileID:j,numIconVertices:V}=P,F=i.has(j);let U=this.opacities[j];F?U=d:U||(U=S,this.opacities[j]=U),i.add(j);const q=k>0||L>0,Z=V>0,X=this.placedOrientations[j],J=X===dr.vertical,rt=X===dr.horizontal||X===dr.horizontalOnly;if(!q&&!Z||U.isHidden()||A++,q){const it=t3(U.text);E(t.text,k,J?Cy:it),E(t.text,L,rt?Cy:it);const ut=U.text.isHidden(),{leftJustifiedTextSymbolIndex:tt,centerJustifiedTextSymbolIndex:dt,rightJustifiedTextSymbolIndex:gt,verticalPlacedTextSymbolIndex:xt}=P,ht=t.text.placedSymbolArray,pt=ut||J?1:0;tt>=0&&(ht.get(tt).hidden=pt),dt>=0&&(ht.get(dt).hidden=pt),gt>=0&&(ht.get(gt).hidden=pt),xt>=0&&(ht.get(xt).hidden=ut||rt?1:0);const Et=this.variableOffsets[j];Et&&this.markUsedJustification(t,Et.anchor,P,X);const At=this.placedOrientations[j];At&&(this.markUsedJustification(t,"left",P,At),this.markUsedOrientation(t,At,P))}if(Z){const it=t3(U.icon),{placedIconSymbolIndex:ut,verticalPlacedIconSymbolIndex:tt}=P,dt=t.icon.placedSymbolArray,gt=U.icon.isHidden()?1:0;ut>=0&&(E(t.icon,V,J?Cy:it),dt.get(ut).hidden=gt),tt>=0&&(E(t.icon,P.numVerticalIconVertices,rt?Cy:it),dt.get(tt).hidden=gt)}if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const it=t.collisionArrays[C];if(it){let ut=new W(0,0),tt=!0;if(it.textBox||it.verticalTextBox){if(_){const gt=this.variableOffsets[j];gt?(ut=QL(gt.anchor,gt.width,gt.height,gt.textOffset,gt.textScale),v&&ut._rotate(b?this.transform.angle:-this.transform.angle)):tt=!1}u&&(tt=!U.clipped),it.textBox&&Ay(t.textCollisionBox.collisionVertexArray,U.text.placed,!tt||J,ut.x,ut.y),it.verticalTextBox&&Ay(t.textCollisionBox.collisionVertexArray,U.text.placed,!tt||rt,ut.x,ut.y)}const dt=tt&&!!(!rt&&it.verticalIconBox);it.iconBox&&Ay(t.iconCollisionBox.collisionVertexArray,U.icon.placed,dt,P.hasIconTextFit?ut.x:0,P.hasIconTextFit?ut.y:0),it.verticalIconBox&&Ay(t.iconCollisionBox.collisionVertexArray,U.icon.placed,!dt,P.hasIconTextFit?ut.x:0,P.hasIconTextFit?ut.y:0)}}}if(t.fullyClipped=A===0,t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.bucketInstanceId in this.collisionCircleArrays){const C=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=C.invProjMatrix,t.placementViewportMatrix=C.viewportMatrix,t.collisionCircleArray=C.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}}symbolFadeChange(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,i){const o=this.zoomAtLastRecencyCheck===i?1-this.zoomAdjustment(i):1;return this.zoomAtLastRecencyCheck=i,this.commitTime+this.fadeDuration*o>t}setStale(){this.stale=!0}}function Ay(n,t,i,o,c){n.emplaceBack(t?1:0,i?1:0,o||0,c||0),n.emplaceBack(t?1:0,i?1:0,o||0,c||0),n.emplaceBack(t?1:0,i?1:0,o||0,c||0),n.emplaceBack(t?1:0,i?1:0,o||0,c||0)}const rZ=Math.pow(2,25),iZ=Math.pow(2,24),sZ=Math.pow(2,17),oZ=Math.pow(2,16),aZ=Math.pow(2,9),lZ=Math.pow(2,8),cZ=Math.pow(2,1);function t3(n){if(n.opacity===0&&!n.placed)return 0;if(n.opacity===1&&n.placed)return 4294967295;const t=n.placed?1:0,i=Math.floor(127*n.opacity);return i*rZ+t*iZ+i*sZ+t*oZ+i*aZ+t*lZ+i*cZ+t}const Cy=0;class uZ{constructor(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&t.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(t,i,o,c,u){const d=this._bucketParts;for(;this._currentTileIndex<t.length;)if(i.getBucketParts(d,c,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,u())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,d.sort((p,g)=>p.sortKey-g.sortKey));this._currentPartIndex<d.length;){const p=d[this._currentPartIndex];if(i.placeLayerBucketPart(p,this._seenCrossTileIDs,o,p.symbolInstanceStart===0),this._currentPartIndex++,u())return!0}return!1}}class hZ{constructor(t,i,o,c,u,d,p,g,_){this.placement=new nZ(t,u,d,p,g,_),this._currentPlacementIndex=i.length-1,this._forceFullPlacement=o,this._showCollisionBoxes=c,this._done=!1}isDone(){return this._done}continuePlacement(t,i,o,c){const u=Be.now(),d=()=>{const p=Be.now()-u;return!this._forceFullPlacement&&p>2};for(;this._currentPlacementIndex>=0;){const p=i[t[this._currentPlacementIndex]],g=this.placement.collisionIndex.transform.zoom;if(p.type==="symbol"&&(!p.minzoom||p.minzoom<=g)&&(!p.maxzoom||p.maxzoom>g)){const _=p,v=_.layout.get("symbol-z-elevate"),b=this._inProgressLayer=this._inProgressLayer||new uZ(_),S=Xi(p.source,p.scope);if(b.continuePlacement(v?c[S]:o[S],this.placement,this._showCollisionBoxes,p,d))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const e3=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Py{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[i,o]=new Uint8Array(t,0,2);if(i!==219)throw new Error("Data does not appear to be in a KDBush format.");const c=o>>4;if(c!==1)throw new Error(`Got v${c} data when expected v1.`);const u=e3[15&o];if(!u)throw new Error("Unrecognized array type.");const[d]=new Uint16Array(t,2,1),[p]=new Uint32Array(t,4,1);return new Py(p,d,u,t)}constructor(t,i=64,o=Float64Array,c){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+i,2),65535),this.ArrayType=o,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const u=e3.indexOf(this.ArrayType),d=2*t*this.ArrayType.BYTES_PER_ELEMENT,p=t*this.IndexArrayType.BYTES_PER_ELEMENT,g=(8-p%8)%8;if(u<0)throw new Error(`Unexpected typed array class: ${o}.`);c&&c instanceof ArrayBuffer?(this.data=c,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+p+g,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+d+p+g),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+p+g,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+u]),new Uint16Array(this.data,2,1)[0]=i,new Uint32Array(this.data,4,1)[0]=t)}add(t,i){const o=this._pos>>1;return this.ids[o]=o,this.coords[this._pos++]=t,this.coords[this._pos++]=i,o}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return TS(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,i,o,c){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:u,coords:d,nodeSize:p}=this,g=[0,u.length-1,0],_=[];for(;g.length;){const v=g.pop()||0,b=g.pop()||0,S=g.pop()||0;if(b-S<=p){for(let P=S;P<=b;P++){const k=d[2*P],L=d[2*P+1];k>=t&&k<=o&&L>=i&&L<=c&&_.push(u[P])}continue}const E=S+b>>1,A=d[2*E],C=d[2*E+1];A>=t&&A<=o&&C>=i&&C<=c&&_.push(u[E]),(v===0?t<=A:i<=C)&&(g.push(S),g.push(E-1),g.push(1-v)),(v===0?o>=A:c>=C)&&(g.push(E+1),g.push(b),g.push(1-v))}return _}within(t,i,o){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:c,coords:u,nodeSize:d}=this,p=[0,c.length-1,0],g=[],_=o*o;for(;p.length;){const v=p.pop()||0,b=p.pop()||0,S=p.pop()||0;if(b-S<=d){for(let P=S;P<=b;P++)r3(u[2*P],u[2*P+1],t,i)<=_&&g.push(c[P]);continue}const E=S+b>>1,A=u[2*E],C=u[2*E+1];r3(A,C,t,i)<=_&&g.push(c[E]),(v===0?t-o<=A:i-o<=C)&&(p.push(S),p.push(E-1),p.push(1-v)),(v===0?t+o>=A:i+o>=C)&&(p.push(E+1),p.push(b),p.push(1-v))}return g}}function TS(n,t,i,o,c,u){if(c-o<=i)return;const d=o+c>>1;n3(n,t,d,o,c,u),TS(n,t,i,o,d-1,1-u),TS(n,t,i,d+1,c,1-u)}function n3(n,t,i,o,c,u){for(;c>o;){if(c-o>600){const _=c-o+1,v=i-o+1,b=Math.log(_),S=.5*Math.exp(2*b/3),E=.5*Math.sqrt(b*S*(_-S)/_)*(v-_/2<0?-1:1);n3(n,t,i,Math.max(o,Math.floor(i-v*S/_+E)),Math.min(c,Math.floor(i+(_-v)*S/_+E)),u)}const d=t[2*i+u];let p=o,g=c;for(Op(n,t,o,i),t[2*c+u]>d&&Op(n,t,o,c);p<g;){for(Op(n,t,p,g),p++,g--;t[2*p+u]<d;)p++;for(;t[2*g+u]>d;)g--}t[2*o+u]===d?Op(n,t,o,g):(g++,Op(n,t,g,c)),g<=i&&(o=g+1),i<=g&&(c=g-1)}}function Op(n,t,i,o){ES(n,i,o),ES(t,2*i,2*o),ES(t,2*i+1,2*o+1)}function ES(n,t,i){const o=n[t];n[t]=n[i],n[i]=o}function r3(n,t,i,o){const c=n-i,u=t-o;return c*c+u*u}const MS=512/Dt/2;class dZ{constructor(t,i,o){this.tileID=t,this.bucketInstanceId=o,this.index=new Py(i.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const c=t.canonical.x*Dt,u=t.canonical.y*Dt;for(let d=0;d<i.length;d++){const{key:p,crossTileID:g,tileAnchorX:_,tileAnchorY:v}=i.get(d),b=Math.floor((c+_)*MS),S=Math.floor((u+v)*MS);this.index.add(b,S),this.keys.push(p),this.crossTileIDs.push(g)}this.index.finish()}findMatches(t,i,o){const c=this.tileID.canonical.z<i.canonical.z?1:Math.pow(2,this.tileID.canonical.z-i.canonical.z),u=MS/Math.pow(2,i.canonical.z-this.tileID.canonical.z),d=i.canonical.x*Dt,p=i.canonical.y*Dt;for(let g=0;g<t.length;g++){const _=t.get(g);if(_.crossTileID)continue;const{key:v,tileAnchorX:b,tileAnchorY:S}=_,E=Math.floor((d+b)*u),A=Math.floor((p+S)*u),C=this.index.range(E-c,A-c,E+c,A+c);for(const P of C){const k=this.crossTileIDs[P];if(this.keys[P]===v&&!o.has(k)){o.add(k),_.crossTileID=k;break}}}}}class fZ{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class pZ{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const i=Math.round((t-this.lng)/360);if(i!==0)for(const o in this.indexes){const c=this.indexes[o],u={};for(const d in c){const p=c[d];p.tileID=p.tileID.unwrapTo(p.tileID.wrap+i),u[p.tileID.key]=p}this.indexes[o]=u}this.lng=t}addBucket(t,i,o){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===i.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let u=0;u<i.symbolInstances.length;u++)i.symbolInstances.get(u).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]=new Set);const c=this.usedCrossTileIDs[t.overscaledZ];for(const u in this.indexes){const d=this.indexes[u];if(Number(u)>t.overscaledZ)for(const p in d){const g=d[p];g.tileID.isChildOf(t)&&g.findMatches(i.symbolInstances,t,c)}else{const p=d[t.scaledTo(Number(u)).key];p&&p.findMatches(i.symbolInstances,t,c)}}for(let u=0;u<i.symbolInstances.length;u++){const d=i.symbolInstances.get(u);d.crossTileID||(d.crossTileID=o.generate(),c.add(d.crossTileID))}return this.indexes[t.overscaledZ]===void 0&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new dZ(t,i.symbolInstances,i.bucketInstanceId),!0}removeBucketCrossTileIDs(t,i){for(const o of i.crossTileIDs)this.usedCrossTileIDs[t].delete(o)}removeStaleBuckets(t){let i=!1;for(const o in this.indexes){const c=this.indexes[o];for(const u in c)t[c[u].bucketInstanceId]||(this.removeBucketCrossTileIDs(o,c[u]),delete c[u],i=!0)}return i}}class mZ{constructor(){this.layerIndexes={},this.crossTileIDs=new fZ,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,i,o,c){let u=this.layerIndexes[t.fqid];u===void 0&&(u=this.layerIndexes[t.fqid]=new pZ);let d=!1;const p={};c.name!=="globe"&&u.handleWrapJump(o);for(const g of i){const _=g.getBucket(t);_&&t.fqid===_.layerIds[0]&&(_.bucketInstanceId||(_.bucketInstanceId=++this.maxBucketInstanceId),u.addBucket(g.tileID,_,this.crossTileIDs)&&(d=!0),p[_.bucketInstanceId]=!0)}return u.removeStaleBuckets(p)&&(d=!0),d}pruneUnusedLayers(t){const i={};t.forEach(o=>{i[o]=!0});for(const o in this.layerIndexes)i[o]||delete this.layerIndexes[o]}}var i3=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w-0.0001;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,s3="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",o3=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture(u_depth,uv-df.xz)),unpack_depth(texture(u_depth,uv+df.xz)),unpack_depth(texture(u_depth,uv-df.zy)),unpack_depth(texture(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,a3=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,l3=`highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}
#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {
#ifdef FOG_DITHERING
vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);
#else
return color;
#endif
}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,c3=`#ifdef RASTER_ARRAY
uniform sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);vec4 _raTexLinearCoord(vec2 texCoord,vec2 texResolution,out vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return (texCoord.xxyy+vec2(1.5,0.5).xyxy)/texResolution.xxyy;}vec2 _raTexLinearMix(vec2 fxy,vec4 colorMix,float colorOffset,vec4 t00,vec4 t10,vec4 t01,vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(vec2 texCoord,vec2 texResolution,vec4 colorMix,float colorOffset) {vec2 fxy;vec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texture(u_image0,c.yz),texture(u_image0,c.xz),texture(u_image0,c.yw),texture(u_image0,c.xw)
);}vec2 raTexture2D_image1_linear(vec2 texCoord,vec2 texResolution,vec4 colorMix,float colorOffset) {vec2 fxy;vec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texture(u_image1,c.yz),texture(u_image1,c.xz),texture(u_image1,c.yw),texture(u_image1,c.xw)
);}vec2 raTexture2D_image0_nearest(vec2 texCoord,vec2 texResolution,vec4 colorMix,float colorOffset) {vec4 t=texture(u_image0,texCoord);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(vec2 texCoord,vec2 texResolution,vec4 colorMix,float colorOffset) {vec4 t=texture(u_image1,texCoord);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,u3=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,h3=`#ifdef RENDER_SHADOWS
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef NATIVE
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const d3=[];Dy(i3,d3);const Iy={"_prelude_fog.vertex.glsl":a3,"_prelude_terrain.vertex.glsl":o3,"_prelude_shadow.vertex.glsl":u3,"_prelude_fog.fragment.glsl":l3,"_prelude_shadow.fragment.glsl":h3,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":c3},ky={};Ln("",o3),Ln(l3,a3),Ln(h3,u3),Ln(c3,"");const f3=Ln(`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec2 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color) {
#ifdef INDICATOR_CUTOUT
float holeMinOpacity=u_indicator_cutout_params.x;float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif`,`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`),p3=i3;var m3={background:Ln(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Ln(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Ln(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Ln("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Ln(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Ln(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Ln("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in float a_size_scale;in vec2 a_padding;in float a_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(a_z_offset+elevation(a_anchor_pos)),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Ln("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Ln("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Ln(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Ln(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
in vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;out vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Ln(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;in vec2 v_pos;in vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos;out vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Ln(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;in vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Ln(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
uniform float u_emissive_strength;in float v_height;void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,v_depth);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,u_emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef RENDER_CUTOFF
color*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
#ifdef RENDER_CUTOFF
invariant gl_Position;
#endif
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);v_flat=vec4(linearProduct(color.rgb,vec3(calculate_NdotL(normal))),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),fillExtrusionDepth:Ln(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_vertical_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base);pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:Ln(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
out vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:Ln(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;in float v_depth;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,v_depth));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0)).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);v_depth=gl_Position.w;
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:Ln(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;HANDLE_WIREFRAME_DEBUG;
#endif
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;
#ifdef FORCE_ABS_FL_GROUND_RADIUS
fl_ground_radius=abs(flood_light_ground_radius);
#endif
float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(1.0,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:Ln(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Ln(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Ln(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=(border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {    
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color.rgb=mix(border_color.rgb*border_color.a*trimmed,out_color.rgb,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Ln(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting_ground(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Ln(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform vec4 u_tl_br;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#elif defined(PROJECTION_GLOBE_VIEW)
in vec2 a_pos;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec2 globe_tl=vec2(u_tl_br.x,u_tl_br.y);vec2 globe_br=vec2(u_tl_br.z,u_tl_br.w);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=1.0-((mercatorY-globe_br.y)/(globe_tl.y-globe_br.y));float mercatorX=mercatorXfromLng(latLng[1]);float uvX=(mercatorX-globe_br.x)/(globe_tl.x-globe_br.x);vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);uv=vec2(uvX,uvY);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
uv=a_texture_pos/8192.0;
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),symbolIcon:Ln(`#include "_prelude_lighting.glsl"
uniform sampler2D u_texture;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
in float v_fade_opacity;in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
uniform mediump float u_icon_saturation;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float emissive_strength
lowp float alpha=opacity*v_fade_opacity;vec4 out_color;
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b)*alpha;
#else
out_color=texture(u_texture,v_tex_a)*alpha;
#endif
#ifdef SATURATION
vec3 luma=vec3(dot(out_color.rgb,vec3(0.2126,0.7152,0.0722)));out_color.rgb=mix(luma,out_color.rgb,u_icon_saturation);
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float emissive_strength
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
v_tex_a=a_tex/u_texsize;
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
v_fade_opacity=out_fade_opacity;}`),symbolSDF:Ln(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;in float v_draw_halo;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out float v_draw_halo;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,out_fade_opacity);}`),symbolTextAndIcon:Ln(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_halo;in float v_draw_halo;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out float v_draw_halo;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,out_fade_opacity,is_sdf);}`),terrainRaster:Ln(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;in float v_depth;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,v_depth,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:Ln("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:Ln(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,s3),skyboxGradient:Ln(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,s3),skyboxCapture:Ln(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Ln(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(raster.rgb*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Ln(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;
#ifndef NATIVE
c=dither(c,gl_FragCoord.xy+u_temporal_offset);
#endif
glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:Ln(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform sampler2D u_depthTexture;uniform vec2 u_inv_depth_size;bool isOccluded() {vec2 coord=gl_FragCoord.xy*u_inv_depth_size;highp float depth=unpack_depth(texture(u_depthTexture,coord));return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
texColor.rgb=sRGBToLinear(texColor.rgb);if(u_baseTextureIsAlpha) {if (texColor.w < 0.5) {discard;}albedo*=mix(vec4(texColor.rgb,texColor.a),vec4(texColor.a),float(u_baseTextureIsAlpha));} else {albedo*=texColor;}
#endif
return vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 diffuse=getDiffuseShadedColor(getBaseColor().rgb,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(diffuse,1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
ao=(texture(u_occlusionTexture,uv_2f).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);color=mix(color,v_color_mix.rgb,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=u_matrix*pos;pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 shadow_pos=local_pos;
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normalize(normal_3f));shadow_pos+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shadow_pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(shadow_pos,1);v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:Ln(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=u_matrix*pos;
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:Ln(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`)};function Dy(n,t){const i=n.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let o of i)if(o=o.trim(),o[0]==="#"&&o.includes("if")&&!o.includes("endif")){o=o.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const c=o.split(" ");for(const u of c)t.includes(u)||t.push(u)}}function Ln(n,t){const i=/#include\s+"([^"]+)"/g,o=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let c=t.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);c&&(c=c.map(_=>{const v=_.split(" ");return v[v.length-1]}),c=[...new Set(c)]);const u={},d=[],p=[];n=n.replace(i,(_,v)=>(p.push(v),"")),t=t.replace(i,(_,v)=>(d.push(v),""));let g=[...d3];Dy(n,g),Dy(t,g);for(const _ of[...d,...p])Iy[_]||console.error(`Undefined include: ${_}`),ky[_]||(ky[_]=[],Dy(Iy[_],ky[_])),g=[...g,...ky[_]];return{fragmentSource:n=n.replace(o,(_,v,b,S,E)=>(u[E]=!0,v==="define"?`
#ifndef HAS_UNIFORM_u_${E}
in ${b} ${S} ${E};
#else
uniform ${b} ${S} u_${E};
#endif
`:v==="initialize"?`
#ifdef HAS_UNIFORM_u_${E}
    ${b} ${S} ${E} = u_${E};
#endif
`:v==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${E}
    in ${b} ${S} ${E};
#endif
`:v==="initialize-attribute"?"":void 0)),vertexSource:t=t.replace(o,(_,v,b,S,E)=>{const A=S==="float"?"vec2":S,C=E.match(/color/)?"color":A;return v==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${E}
in ${b} ${S} a_${E};
#endif
`:u[E]?v==="define"?`
#ifndef HAS_UNIFORM_u_${E}
uniform lowp float u_${E}_t;
in ${b} ${A} a_${E};
out ${b} ${S} ${E};
#else
uniform ${b} ${S} u_${E};
#endif
`:v==="initialize"?C==="vec4"?`
#ifndef HAS_UNIFORM_u_${E}
    ${E} = a_${E};
#else
    ${b} ${S} ${E} = u_${E};
#endif
`:`
#ifndef HAS_UNIFORM_u_${E}
    ${E} = unpack_mix_${C}(a_${E}, u_${E}_t);
#else
    ${b} ${S} ${E} = u_${E};
#endif
`:v==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${E}
    in ${b} ${S} a_${E};
    out ${b} ${S} ${E};
#endif
`:v==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${E}
    ${E} = a_${E};
#endif
`:void 0:v==="define"?`
#ifndef HAS_UNIFORM_u_${E}
uniform lowp float u_${E}_t;
in ${b} ${A} a_${E};
#else
uniform ${b} ${S} u_${E};
#endif
`:v==="define-instanced"?C==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${E}0;
in vec4 a_${E}1;
in vec4 a_${E}2;
in vec4 a_${E}3;
#else
uniform ${b} ${S} u_${E};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${b} ${A} a_${E};
#else
uniform ${b} ${S} u_${E};
#endif
`:v==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${E}
    ${b} ${S} ${E} = a_${E};
#endif
`:C==="vec4"?`
#ifndef HAS_UNIFORM_u_${E}
    ${b} ${S} ${E} = a_${E};
#else
    ${b} ${S} ${E} = u_${E};
#endif
`:`
#ifndef HAS_UNIFORM_u_${E}
    ${b} ${S} ${E} = unpack_mix_${C}(a_${E}, u_${E}_t);
#else
    ${b} ${S} ${E} = u_${E};
#endif
`}),staticAttributes:c,usedDefines:g,vertexIncludes:d,fragmentIncludes:p}}class gZ{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(t,i,o,c,u,d,p,g){this.context=t;let _=this.boundPaintVertexBuffers.length!==c.length;for(let b=0;!_&&b<c.length;b++)this.boundPaintVertexBuffers[b]!==c[b]&&(_=!0);let v=this.boundDynamicVertexBuffers.length!==p.length;for(let b=0;!v&&b<p.length;b++)this.boundDynamicVertexBuffers[b]!==p[b]&&(v=!0);if(!this.vao||this.boundProgram!==i||this.boundLayoutVertexBuffer!==o||_||v||this.boundIndexBuffer!==u||this.boundVertexOffset!==d)this.freshBind(i,o,c,u,d,p,g);else{t.bindVertexArrayOES.set(this.vao);for(const b of p)b&&(b.bind(),g&&b.instanceCount&&b.setVertexAttribDivisor(t.gl,i,g));u&&u.dynamicDraw&&u.bind()}}freshBind(t,i,o,c,u,d,p){const g=t.numAttributes,_=this.context,v=_.gl;this.vao&&this.destroy(),this.vao=_.gl.createVertexArray(),_.bindVertexArrayOES.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=i,this.boundPaintVertexBuffers=o,this.boundIndexBuffer=c,this.boundVertexOffset=u,this.boundDynamicVertexBuffers=d,i.enableAttributes(v,t),i.bind(),i.setVertexAttribPointers(v,t,u);for(const b of o)b.enableAttributes(v,t),b.bind(),b.setVertexAttribPointers(v,t,u);for(const b of d)b&&(b.enableAttributes(v,t),b.bind(),b.setVertexAttribPointers(v,t,u),p&&b.instanceCount&&b.setVertexAttribDivisor(v,t,p));c&&c.bind(),_.currentNumAttributes=g}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function _Z(n,t){const i=Math.pow(2,t.canonical.z),o=t.canonical.y;return[new vn(0,o/i).toLngLat().lat,new vn(0,(o+1)/i).toLngLat().lat]}function yZ(n,t,i,o,c,u,d){const p=n.context,g=p.gl,_=i.hillshadeFBO;if(!_)return;n.prepareDrawTile();const v=n.isTileAffectedByFog(t),b=n.getOrCreateProgram("hillshade",{overrideFog:v});p.activeTexture.set(g.TEXTURE0),g.bindTexture(g.TEXTURE_2D,_.colorAttachment.get());const S=((P,k,L,j)=>{const V=L.paint.get("hillshade-shadow-color"),F=L.paint.get("hillshade-highlight-color"),U=L.paint.get("hillshade-accent-color"),q=L.paint.get("hillshade-emissive-strength");let Z=st(L.paint.get("hillshade-illumination-direction"));if(L.paint.get("hillshade-illumination-anchor")==="viewport")Z-=P.transform.angle;else if(P.style&&P.style.enable3dLights()&&P.style.directionalLight){const J=P.style.directionalLight.properties.get("direction");Z=st(Ee(J.x,J.y,J.z)[1])}const X=!P.options.moving;return{u_matrix:j||P.transform.calculateProjMatrix(k.tileID.toUnwrapped(),X),u_image:0,u_latrange:_Z(0,k.tileID),u_light:[L.paint.get("hillshade-exaggeration"),Z],u_shadow:V,u_highlight:F,u_emissive_strength:q,u_accent:U}})(n,i,o,n.terrain?t.projMatrix:null);n.uploadCommonUniforms(p,b,t.toUnwrapped());const{tileBoundsBuffer:E,tileBoundsIndexBuffer:A,tileBoundsSegments:C}=n.getTileBoundsBuffers(i);b.draw(n,g.TRIANGLES,c,u,d,un.disabled,S,o.id,E,A,C)}function g3(n,t,i){if(!t.needsDEMTextureUpload)return;const o=n.context,c=o.gl;o.pixelStoreUnpackPremultiplyAlpha.set(!1),t.demTexture=t.demTexture||n.getTileTexture(i.stride);const u=i.getPixels();t.demTexture?t.demTexture.update(u,{premultiply:!1}):t.demTexture=new _r(o,u,c.R32F,{premultiply:!1}),t.needsDEMTextureUpload=!1}function vZ(n,t,i){const o=n.context,c=o.gl;if(!t.dem)return;const u=t.dem;if(o.activeTexture.set(c.TEXTURE1),g3(n,t,u),!t.demTexture)return;t.demTexture.bind(c.NEAREST,c.CLAMP_TO_EDGE);const d=u.dim;o.activeTexture.set(c.TEXTURE0);let p=t.hillshadeFBO;if(!p){const S=new _r(o,{width:d,height:d,data:null},c.RGBA);S.bind(c.LINEAR,c.CLAMP_TO_EDGE),p=t.hillshadeFBO=o.createFramebuffer(d,d,!0,"renderbuffer"),p.colorAttachment.set(S.texture)}o.bindFramebuffer.set(p.framebuffer),o.viewport.set([0,0,d,d]);const{tileBoundsBuffer:g,tileBoundsIndexBuffer:_,tileBoundsSegments:v}=n.getMercatorTileBoundsBuffers(),b=[];n.linearFloatFilteringSupported()&&b.push("TERRAIN_DEM_FLOAT_FORMAT"),n.getOrCreateProgram("hillshadePrepare",{defines:b}).draw(n,c.TRIANGLES,Ge.disabled,an.disabled,Cn.unblended,un.disabled,((S,E)=>{const A=E.stride,C=wt.create();return wt.ortho(C,0,Dt,-Dt,0,0,1),wt.translate(C,C,[0,-Dt,0]),{u_matrix:C,u_image:1,u_dimension:[A,A],u_zoom:S.overscaledZ}})(t.tileID,u),i.id,g,_,v),t.needsHillshadePrepare=!1}const _3=n=>({u_matrix:new Ke(n),u_image0:new hn(n),u_skirt_height:new Xt(n),u_ground_shadow_factor:new en(n)}),y3=(n,t,i)=>({u_matrix:n,u_image0:0,u_skirt_height:t,u_ground_shadow_factor:i}),v3=(n,t,i,o,c,u,d,p,g,_,v,b,S,E,A)=>({u_proj_matrix:Float32Array.from(n),u_globe_matrix:t,u_normalize_matrix:Float32Array.from(o),u_merc_matrix:i,u_zoom_transition:c,u_merc_center:u,u_image0:0,u_frustum_tl:d,u_frustum_tr:p,u_frustum_br:g,u_frustum_bl:_,u_globe_pos:v,u_globe_radius:b,u_viewport:S,u_grid_matrix:A?Float32Array.from(A):new Float32Array(9),u_skirt_height:E}),Cd=(n,t)=>{if(t>0&&n.terrain&&_t("Cutoff is currently disabled on terrain"),t<=0||n.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,0]}};const i=n.transform,o=Math.max(Math.abs(i._zoom-(n.minCutoffZoom-1)),1),c=i.isLODDisabled(!1)?Me(60,45,i.pitch):Me(30,15,i.pitch),u=i._farZ-i._nearZ,d=t*i.height,p=((1-(g=c))*(.75*i.cameraToCenterDistance)+g*(i._farZ+d))*o;var g;return{shouldRenderCutoff:c<1,uniformValues:{u_cutoff_params:[i._nearZ,i._farZ,(p-i._nearZ)/u,(p-d-i._nearZ)/u]}}};function x3(n,t){return n!=null&&t!=null&&!(!n.hasData()||!t.hasData())&&n.demTexture!=null&&t.demTexture!=null&&n.tileID.key!==t.tileID.key}const Pd=new class{constructor(){this.operations={}}newMorphing(n,t,i,o,c){if(n in this.operations){const u=this.operations[n];u.to.tileID.key!==i.tileID.key&&(u.queued=i)}else this.operations[n]={startTime:o,phase:0,duration:c,from:t,to:i,queued:null}}getMorphValuesForProxy(n){if(!(n in this.operations))return null;const t=this.operations[n];return{from:t.from,to:t.to,phase:t.phase}}update(n){for(const t in this.operations){const i=this.operations[t];for(i.phase=(n-i.startTime)/i.duration;i.phase>=1||!this._validOp(i);)if(!this._nextOp(i,n)){delete this.operations[t];break}}}_nextOp(n,t){return!!n.queued&&(n.from=n.to,n.to=n.queued,n.queued=null,n.phase=0,n.startTime=t,!0)}_validOp(n){return n.from.hasData()&&n.to.hasData()}},b3={0:null,1:"TERRAIN_VERTEX_MORPHING"};function w3(n,t,i){if(t===0)return 0;const o=t<1&&i===514?.25/t:1;return 6*Math.pow(1.5,22-n)*Math.max(t,1)*o}function xZ(n,t){const i=1<<n.z;return!t&&(n.x===0||n.x===i-1)||n.y===0||n.y===i-1}const AS=n=>({u_matrix:n});function S3(n,t,i,o,c){if(c>0){const u=Be.now(),d=(u-n.timeAdded)/c,p=t?(u-t.timeAdded)/c:-1,g=i.getSource(),_=o.coveringZoomLevel({tileSize:g.tileSize,roundZoom:g.roundZoom}),v=!t||Math.abs(t.tileID.overscaledZ-_)>Math.abs(n.tileID.overscaledZ-_),b=v&&n.refreshedUponExpiration?1:Ot(v?d:1-p,0,1);return n.refreshedUponExpiration&&d>=1&&(n.refreshedUponExpiration=!1),t?{opacity:1,mix:1-b}:{opacity:b,mix:0}}return{opacity:1,mix:0}}class bZ extends Qo{constructor(t){const i={type:"raster-dem",maxzoom:t.transform.maxZoom},o=new Gu(Dp(),null),c=vS("mock-dem",i,o,t.style);super("mock-dem",c,!1),c.setEventedParent(this),this._sourceLoaded=!0}_loadTile(t,i){t.state="loaded",i(null)}}class wZ extends Qo{constructor(t){const i=vS("proxy",{type:"geojson",maxzoom:t.transform.maxZoom},new Gu(Dp(),null),t.style);super("proxy",i,!1),i.setEventedParent(this),this.map=this.getSource().map=t,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(t,i,o){if(t.freezeTileCoverage)return;this.transform=t;const c=t.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((u,d)=>{if(u[d.key]="",!this._tiles[d.key]){const p=new bp(d,this._source.tileSize*d.overscaleFactor(),t.tileZoom);p.state="loaded",this._tiles[d.key]=p}return u},{});for(const u in this._tiles)u in c||(this.freeFBO(u),this._tiles[u].unloadVectorData(),delete this._tiles[u])}freeFBO(t){const i=this.proxyCachedFBO[t];if(i!==void 0){const o=Object.values(i);this.renderCachePool.push(...o),delete this.proxyCachedFBO[t]}}deallocRenderCache(){this.renderCache.forEach(t=>t.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class T3 extends Pn{constructor(t,i,o){super(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y),this.proxyTileKey=i,this.projMatrix=o}}class SZ extends eW{constructor(t,i){super(),this.painter=t,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[o,c,u]=function(g){const _=new Ds,v=new Hr,b=131;_.reserve(17161),v.reserve(33800);const S=Dt/128,E=Dt+S/2,A=E+S;for(let P=-S;P<A;P+=S)for(let k=-S;k<A;k+=S){const L=k<0||k>E||P<0||P>E?24575:0,j=Ot(Math.round(k),0,Dt),V=Ot(Math.round(P),0,Dt);_.emplaceBack(j+L,V)}const C=(P,k)=>{const L=k*b+P;v.emplaceBack(L+1,L,L+b),v.emplaceBack(L+b,L+b+1,L+1)};for(let P=1;P<129;P++)for(let k=1;k<129;k++)C(k,P);return[0,129].forEach(P=>{for(let k=0;k<130;k++)C(k,P),C(P,k)}),[_,v,32768]}(),d=t.context;this.gridBuffer=d.createVertexBuffer(o,cc.members),this.gridIndexBuffer=d.createIndexBuffer(c),this.gridSegments=Bn.simpleSegment(0,0,o.length,c.length),this.gridNoSkirtSegments=Bn.simpleSegment(0,0,o.length,u),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new wZ(i.map),this.orthoMatrix=wt.create(),wt.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,Dt,0,Dt,0,1);const p=d.gl;this._overlapStencilMode=new an({func:p.GEQUAL,mask:255},0,255,p.KEEP,p.KEEP,p.REPLACE),this._previousZoom=t.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=i,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new bZ(i.map),this._pendingGroundEffectLayers=[]}set style(t){t.on("data",this._onStyleDataEvent.bind(this)),this._style=t,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(t,i,o){if(t&&t.terrain){this._style!==t&&(this.style=t,this._evaluationZoom=void 0);const c=t.terrain.properties,u=t.terrain.drapeRenderMode===0,d=t.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=Be.now();const p=t.terrain&&t.terrain.scope,g=c.get("source"),_=u?this._mockSourceCache:t.getSourceCache(g,p);if(!_)return void _t(`Couldn't find terrain source "${g}".`);if(this.sourceCache=_,this._exaggeration=d?this.calculateExaggeration(i):c.get("exaggeration"),!i.projection.requiresDraping&&d&&this._exaggeration===0)return void this._disable();this.enabled=!0;const v=()=>{this.sourceCache.used&&_t(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const b=this.getScaledDemTileSize();this.sourceCache.update(i,b,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,v(),this._initializing=!0),v(),i.updateElevation(!0,o),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(i),this._emptyDEMTextureDirty=!0,this._previousZoom=i.zoom}else this._disable()}calculateExaggeration(t){const i=this._previousCameraAltitude,o=t.getFreeCameraOptions().position.z/t.pixelsPerMeter*t.worldSize;this._previousCameraAltitude=o;const c=i!=null?o-i:Number.MAX_VALUE;if(Math.abs(c)<2)return this._exaggeration;const u=t.zoom,d=this._style.terrain;if(!this._previousUpdateTimestamp)return d.getExaggeration(u);let p=u-this._previousZoom;const g=this._previousUpdateTimestamp;let _=u;this._evaluationZoom!=null&&(_=this._evaluationZoom,Math.abs(u-_)>.5&&(p=.5*(u-_+p)),p*c<0&&(_+=p)),this._evaluationZoom=_;const v=d.getExaggeration(_),b=v===d.getExaggeration(Math.max(0,_-.1));if(b&&Math.abs(v-this._exaggeration)<.01)return v;let S=Math.min(.1,.00375*(this._updateTimestamp-g));return(b||v<.1||Math.abs(p)<1e-4)&&(S=Math.min(.2,4*S)),qe(this._exaggeration,v,S)}resetTileLookupCache(t){this._findCoveringTileCache[t]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(t){t.coord&&t.dataType==="source"?this._clearRenderCacheForTile(t.sourceCacheId,t.coord):t.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const t in this._style._mergedSourceCaches)this._style._mergedSourceCaches[t].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(t=>t.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const t=2*this.proxySourceCache.getSource().tileSize;return[t,t]}set useVertexMorphing(t){this._useVertexMorphing=t}updateTileBinding(t){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const i=this.proxySourceCache,o=this.painter.transform;this._initializing&&(this._initializing=o._centerAltitude===0&&this.getAtPointOrZero(vn.fromLngLat(o.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const c=this.proxyCoords=i.getIds().map(g=>{const _=i.getTileByID(g).tileID;return _.projMatrix=o.calculateProjMatrix(_.toUnwrapped()),_});(function(g,_){const v=_.transform.pointCoordinate(_.transform.getCameraPoint()),b=new W(v.x,v.y);g.sort((S,E)=>{if(E.overscaledZ-S.overscaledZ)return E.overscaledZ-S.overscaledZ;const A=new W(S.canonical.x+(1<<S.canonical.z)*S.wrap,S.canonical.y),C=new W(E.canonical.x+(1<<E.canonical.z)*E.wrap,E.canonical.y),P=b.mult(1<<S.canonical.z);return P.x-=.5,P.y-=.5,P.distSqr(A)-P.distSqr(C)})})(c,this.painter);const u=this.proxyToSource||{};this.proxyToSource={},c.forEach(g=>{this.proxyToSource[g.key]={}}),this.terrainTileForTile={};const d=this._style._mergedSourceCaches;for(const g in d){const _=d[g];if(!_.used||(_!==this.sourceCache&&this.resetTileLookupCache(_.id),this._setupProxiedCoordsForOrtho(_,t[g],u),_.usedForTerrain))continue;const v=t[g];_.getSource().reparseOverscaled&&this._assignTerrainTiles(v)}this.proxiedCoords[i.id]=c.map(g=>new T3(g,g.key,this.orthoMatrix)),this._assignTerrainTiles(c),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(u),this.renderingToTexture=!1;const p={};this._visibleDemTiles=[];for(const g of this.proxyCoords){const _=this.terrainTileForTile[g.key];if(!_)continue;const v=_.tileID.key;v in p||(this._visibleDemTiles.push(_),p[v]=v)}}_assignTerrainTiles(t){this._initializing||t.forEach(i=>{if(this.terrainTileForTile[i.key])return;const o=this._findTileCoveringTileID(i,this.sourceCache);o&&(this.terrainTileForTile[i.key]=o)})}_prepareDEMTextures(){const t=this.painter.context,i=t.gl;for(const o in this.terrainTileForTile){const c=this.terrainTileForTile[o],u=c.dem;!u||c.demTexture&&!c.needsDEMTextureUpload||(t.activeTexture.set(i.TEXTURE1),g3(this.painter,c,u))}}_prepareDemTileUniforms(t,i,o,c){if(!i||i.demTexture==null)return!1;const u=t.tileID.canonical,d=Math.pow(2,i.tileID.canonical.z-u.z),p=c||"";return o[`u_dem_tl${p}`]=[u.x*d%1,u.y*d%1],o[`u_dem_scale${p}`]=d,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const t=this.painter.context,i=t.gl;if(!this._emptyDepthBufferTexture){const o=new Fr({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new _r(t,o,i.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let t=0;const i=this._visibleDemTiles.reduce((o,c)=>{if(!c.dem)return o;const u=c.dem.tree.minimums[0];return u>0&&t++,o+u},0);return t?i/t:0}_updateEmptyDEMTexture(){const t=this.painter.context,i=t.gl;t.activeTexture.set(i.TEXTURE2);const o=this._getLoadedAreaMinimum(),[c,u]=(()=>{const p=new mR({width:1,height:1},new Float32Array([o]));return[i.R32F,p]})();this._emptyDEMTextureDirty=!1;let d=this._emptyDEMTexture;return d?d.update(u,{premultiply:!1}):d=this._emptyDEMTexture=new _r(t,u,c,{premultiply:!1}),d}setupElevationDraw(t,i,o){const c=this.painter.context,u=c.gl,d={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0};d.u_exaggeration=this.exaggeration();let p=null,g=null,_=1;if(o&&o.morphing&&this._useVertexMorphing){const S=o.morphing.srcDemTile,E=o.morphing.dstDemTile;_=o.morphing.phase,S&&E&&(this._prepareDemTileUniforms(t,S,d,"_prev")&&(g=S),this._prepareDemTileUniforms(t,E,d)&&(p=E))}const v=S=>S&&S.demTexture&&this.painter.linearFloatFilteringSupported()?u.LINEAR:u.NEAREST,b=S=>{d.u_dem_size=S.size[0]===1?1:S.size[0]-2};if(g&&p)c.activeTexture.set(u.TEXTURE2),p.demTexture.bind(v(p),u.CLAMP_TO_EDGE),c.activeTexture.set(u.TEXTURE4),g.demTexture.bind(v(g),u.CLAMP_TO_EDGE),p.demTexture&&b(p.demTexture),d.u_dem_lerp=_;else{p=this.terrainTileForTile[t.tileID.key],c.activeTexture.set(u.TEXTURE2);const S=this._prepareDemTileUniforms(t,p,d)?p.demTexture:this.emptyDEMTexture;S.bind(v(p),u.CLAMP_TO_EDGE),b(S)}if(c.activeTexture.set(u.TEXTURE3),o&&o.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(u.NEAREST,u.CLAMP_TO_EDGE),this._depthFBO&&(d.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(u.NEAREST,u.CLAMP_TO_EDGE),d.u_depth_size_inv=[1,1]),o&&o.useMeterToDem&&p){const S=(1<<p.tileID.canonical.z)*$n(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;d.u_meter_to_dem=S}if(o&&o.labelPlaneMatrixInv&&(d.u_label_plane_matrix_inv=o.labelPlaneMatrixInv),i.setTerrainUniformValues(c,d),this.painter.transform.projection.name==="globe"){const S=this.globeUniformValues(this.painter.transform,t.tileID.canonical,o&&o.useDenormalizedUpVectorScale);i.setGlobeUniformValues(c,S)}}globeUniformValues(t,i,o){const c=t.projection;return{u_tile_tl_up:c.upVector(i,0,0),u_tile_tr_up:c.upVector(i,Dt,0),u_tile_br_up:c.upVector(i,Dt,Dt),u_tile_bl_up:c.upVector(i,0,Dt),u_tile_up_scale:o?E_(1):c.upVectorScale(i,t.center.lat,t.worldSize).metersToTile}}renderToBackBuffer(t){const i=this.painter,o=this.painter.context;t.length!==0&&(o.bindFramebuffer.set(null),o.viewport.set([0,0,i.width,i.height]),i.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(c,u,d,p,g){if(c.transform.projection.name==="globe")(function(_,v,b,S,E){const A=_.context,C=A.gl;let P,k;const L=_.transform,j=qD(_,A,L),V=(ut,tt)=>{if(k===tt)return;const dt=[b3[tt],"PROJECTION_GLOBE_VIEW"];j&&dt.push("CUSTOM_ANTIALIASING");const gt=_.isTileAffectedByFog(ut);P=_.getOrCreateProgram("globeRaster",{defines:dt,overrideFog:gt}),k=tt},F=_.colorModeForRenderPass(),U=new Ge(C.LEQUAL,Ge.ReadWrite,_.depthRangeFor3D);Pd.update(E);const q=WD(L),Z=[ti(L.center.lng),ui(L.center.lat)],X=_.globeSharedBuffers,J=[L.width*Be.devicePixelRatio,L.height*Be.devicePixelRatio],rt=Float32Array.from(L.globeMatrix),it={useDenormalizedUpVectorScale:!0};{const ut=_.transform,tt=w3(ut.zoom,v.exaggeration(),v.sourceCache._source.tileSize);k=-1;const dt=C.TRIANGLES;for(const gt of S){const xt=b.getTile(gt),ht=an.disabled,pt=v.prevTerrainTileForTile[gt.key],Et=v.terrainTileForTile[gt.key];x3(pt,Et)&&Pd.newMorphing(gt.key,pt,Et,E,250),A.activeTexture.set(C.TEXTURE0),xt.texture&&xt.texture.bind(C.LINEAR,C.CLAMP_TO_EDGE);const At=Pd.getMorphValuesForProxy(gt.key),Mt=At?1:0;At&&Ar(it,{morphing:{srcDemTile:At.from,dstDemTile:At.to,phase:Zt(At.phase)}});const Lt=M_(gt.canonical),Nt=G9(Lt.getCenter().lat),jt=ZD(gt.canonical,Lt,Nt,ut.worldSize/ut._pixelsPerMercatorPixel),It=hc(no(gt.canonical)),Gt=v3(ut.expandedFarZProjMatrix,rt,q,It,vi(ut.zoom),Z,ut.frustumCorners.TL,ut.frustumCorners.TR,ut.frustumCorners.BR,ut.frustumCorners.BL,ut.globeCenterInViewSpace,ut.globeRadius,J,tt,jt);if(V(gt,Mt),P&&(v.setupElevationDraw(xt,P,it),_.uploadCommonUniforms(A,P,gt.toUnwrapped()),X)){const[ce,ue,ye]=X.getGridBuffers(Nt,tt!==0);P.draw(_,dt,U,ht,F,un.backCCW,Gt,"globe_raster",ce,ue,ye)}}}if(X&&(_.renderDefaultNorthPole||_.renderDefaultSouthPole)){const ut=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];j&&ut.push("CUSTOM_ANTIALIASING"),P=_.getOrCreateProgram("globeRaster",{defines:ut});for(const tt of S){const{x:dt,y:gt,z:xt}=tt.canonical,ht=gt===0,pt=gt===(1<<xt)-1,[Et,At,Mt,Lt]=X.getPoleBuffers(xt,!1);if(Lt&&(ht||pt)){const Nt=b.getTile(tt);A.activeTexture.set(C.TEXTURE0),Nt.texture&&Nt.texture.bind(C.LINEAR,C.CLAMP_TO_EDGE);let jt=HD(xt,dt,L);const It=hc(no(tt.canonical)),Gt=(ce,ue)=>ce.draw(_,C.TRIANGLES,U,an.disabled,F,un.disabled,v3(L.expandedFarZProjMatrix,jt,jt,It,0,Z,L.frustumCorners.TL,L.frustumCorners.TR,L.frustumCorners.BR,L.frustumCorners.BL,L.globeCenterInViewSpace,L.globeRadius,J,0),"globe_pole_raster",ue,Mt,Lt);v.setupElevationDraw(Nt,P,it),_.uploadCommonUniforms(A,P,tt.toUnwrapped()),ht&&_.renderDefaultNorthPole&&Gt(P,Et),pt&&_.renderDefaultSouthPole&&(jt=wt.scale(wt.create(),jt,[1,-1,1]),Gt(P,At))}}}})(c,u,d,p,g);else{const _=c.context,v=_.gl;let b,S;const E=c.shadowRenderer,A=Cd(c,c.longestCutoffRange),C=F=>{if(S===F)return;const U=[];U.push(b3[F]),A.shouldRenderCutoff&&U.push("RENDER_CUTOFF"),b=c.getOrCreateProgram("terrainRaster",{defines:U}),S=F},P=c.colorModeForRenderPass(),k=new Ge(v.LEQUAL,Ge.ReadWrite,c.depthRangeFor3D);Pd.update(g);const L=c.transform,j=w3(L.zoom,u.exaggeration(),u.sourceCache._source.tileSize);let V=[0,0,0];if(E){const F=c.style.directionalLight,U=c.style.ambientLight;F&&U&&(V=DS(F,U))}{S=-1;const F=v.TRIANGLES,[U,q]=[u.gridIndexBuffer,u.gridSegments];for(const Z of p){const X=d.getTile(Z),J=an.disabled,rt=u.prevTerrainTileForTile[Z.key],it=u.terrainTileForTile[Z.key];x3(rt,it)&&Pd.newMorphing(Z.key,rt,it,g,250),_.activeTexture.set(v.TEXTURE0),X.texture&&X.texture.bind(v.LINEAR,v.CLAMP_TO_EDGE);const ut=Pd.getMorphValuesForProxy(Z.key),tt=ut?1:0;let dt;ut&&(dt={morphing:{srcDemTile:ut.from,dstDemTile:ut.to,phase:Zt(ut.phase)}});const gt=y3(Z.projMatrix,xZ(Z.canonical,L.renderWorldCopies)?j/10:j,V);if(C(tt),!b)continue;u.setupElevationDraw(X,b,dt);const xt=Z.toUnwrapped();E&&E.setupShadows(xt,b),c.uploadCommonUniforms(_,b,xt,null,A),b.draw(c,F,k,J,P,un.backCCW,gt,"terrain_raster",u.gridBuffer,U,q)}}}}(i,this,this.proxySourceCache,t,this._updateTimestamp),this.renderingToTexture=!0,i.gpuTimingDeferredRenderEnd(),t.splice(0,t.length))}renderBatch(t){if(this._drapedRenderBatches.length===0)return t+1;this.renderingToTexture=!0;const i=this.painter,o=this.painter.context,c=this.proxySourceCache,u=this.proxiedCoords[c.id],d=this._drapedRenderBatches.shift(),p=i.style.order,g=[];let _=0;for(const v of u){const b=c.getTileByID(v.proxyTileKey),S=c.proxyCachedFBO[v.key]?c.proxyCachedFBO[v.key][t]:void 0,E=S!==void 0?c.renderCache[S]:this.pool[_++],A=S!==void 0;if(b.texture=E.tex,A&&!E.dirty){g.push(b.tileID);continue}let C;o.bindFramebuffer.set(E.fb.framebuffer),this.renderedToTile=!1,E.dirty&&(o.clear({color:tn.transparent,stencil:0}),E.dirty=!1);for(let P=d.start;P<=d.end;++P){const k=i.style._mergedLayers[p[P]];if(k.isHidden(i.transform.zoom))continue;const L=i.style.getLayerSourceCache(k),j=L?this.proxyToSource[v.key][L.id]:[v];if(!j)continue;const V=j;o.viewport.set([0,0,E.fb.width,E.fb.height]),C!==(L?L.id:null)&&(this._setupStencil(E,j,k,L),C=L?L.id:null),i.renderLayer(i,L,k,V)}if(this._drapedRenderBatches.length===0)for(const P of this._pendingGroundEffectLayers){const k=i.style._mergedLayers[p[P]];if(k.isHidden(i.transform.zoom))continue;const L=i.style.getLayerSourceCache(k),j=L?this.proxyToSource[v.key][L.id]:[v];if(!j)continue;const V=j;o.viewport.set([0,0,E.fb.width,E.fb.height]),C!==(L?L.id:null)&&(this._setupStencil(E,j,k,L),C=L?L.id:null),i.renderLayer(i,L,k,V)}this.renderedToTile?(E.dirty=!0,g.push(b.tileID)):A||--_,_===5&&(_=0,this.renderToBackBuffer(g))}return this.renderToBackBuffer(g),this.renderingToTexture=!1,o.bindFramebuffer.set(null),o.viewport.set([0,0,i.width,i.height]),d.end+1}postRender(){}isLayerOrderingCorrect(t){const i=t.order.length;let o=-1,c=i;for(let u=0;u<i;++u)this._style.isLayerDraped(t._mergedLayers[t.order[u]])?o=Math.max(o,u):c=Math.min(c,u);return c>o}getMinElevationBelowMSL(){let t=0;return this._visibleDemTiles.filter(i=>i.dem).forEach(i=>{t=Math.min(t,i.dem.tree.minimums[0])}),t===0?t:(t-30)*this._exaggeration}raycast(t,i,o){if(!this._visibleDemTiles)return null;const c=this._visibleDemTiles.filter(u=>u.dem).map(u=>{const d=u.tileID,p=1<<d.overscaledZ,{x:g,y:_}=d.canonical,v=g/p,b=(g+1)/p,S=_/p,E=(_+1)/p;return{minx:v,miny:S,maxx:b,maxy:E,t:u.dem.tree.raycastRoot(v,S,b,E,t,i,o),tile:u}});c.sort((u,d)=>(u.t!==null?u.t:Number.MAX_VALUE)-(d.t!==null?d.t:Number.MAX_VALUE));for(const u of c){if(u.t==null)return null;const d=u.tile.dem.tree.raycast(u.minx,u.miny,u.maxx,u.maxy,t,i,o);if(d!=null)return d}return null}_createFBO(){const t=this.painter.context,i=t.gl,o=this.drapeBufferSize;t.activeTexture.set(i.TEXTURE0);const c=new _r(t,{width:o[0],height:o[1],data:null},i.RGBA);c.bind(i.LINEAR,i.CLAMP_TO_EDGE);const u=t.createFramebuffer(o[0],o[1],!0,null);return u.colorAttachment.set(c.texture),u.depthAttachment=new IH(t,u.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=t.createRenderbuffer(t.gl.DEPTH_STENCIL,o[0],o[1]),this._stencilRef=0,u.depthAttachment.set(this._sharedDepthStencil),t.clear({stencil:0})):u.depthAttachment.set(this._sharedDepthStencil),t.extTextureFilterAnisotropic&&i.texParameterf(i.TEXTURE_2D,t.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,t.extTextureFilterAnisotropicMax),{fb:u,tex:c,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.hasLightTransitions())return!0;for(const t in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[t].hasTransition())return!0;return this._style.order.some(t=>{const i=this._style._mergedLayers[t],o=i.isHidden(this.painter.transform.zoom);return i.type==="custom"?!o&&i.shouldRedrape():!o&&i.hasTransition()})}_clearLineLayersFromRenderCache(){let t=!1;for(const o of this._style.getSources())if(o instanceof LL){t=!0;break}if(!t)return;const i={};for(let o=0;o<this._style.order.length;++o){const c=this._style._mergedLayers[this._style.order[o]],u=this._style.getLayerSourceCache(c);if(u&&!i[u.id]&&!c.isHidden(this.painter.transform.zoom)&&c.type==="line"&&c.widthExpression()instanceof ec){i[u.id]=!0;for(const d of this.proxyCoords){const p=this.proxyToSource[d.key][u.id];if(p)for(const g of p)this._clearRenderCacheForTile(u.id,g)}}}}_clearRasterLayersFromRenderCache(){let t=!1;for(const o in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[o]._source instanceof lS){t=!0;break}if(!t)return;const i={};for(let o=0;o<this._style.order.length;++o){const c=this._style._mergedLayers[this._style.order[o]],u=this._style.getLayerSourceCache(c);if(!u||i[u.id]||c.isHidden(this.painter.transform.zoom)||c.type!=="raster")continue;const d=c.paint.get("raster-fade-duration");for(const p of this.proxyCoords){const g=this.proxyToSource[p.key][u.id];if(g)for(const _ of g){const v=S3(u.getTile(_),u.findLoadedParent(_,0),u,this.painter.transform,d);(v.opacity!==1||v.mix!==0)&&this._clearRenderCacheForTile(u.id,_)}}}}_setupDrapedRenderBatches(){const t=this._style.order,i=t.length;if(i===0)return;const o=[];this._pendingGroundEffectLayers=[];let c,u=0,d=this._style._mergedLayers[t[u]];for(;!this._style.isLayerDraped(d)&&d.isHidden(this.painter.transform.zoom)&&++u<i;)d=this._style._mergedLayers[t[u]];for(;u<i;++u){const p=this._style._mergedLayers[t[u]];p.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(p)?c===void 0&&(c=u):(p.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(u),c!==void 0&&(o.push({start:c,end:u-1}),c=void 0)))}if(c!==void 0&&o.push({start:c,end:u-1}),o.length!==0){const p=o[o.length-1];this._pendingGroundEffectLayers.every(_=>_>p.end)||_t("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=o}_setupRenderCache(t){const i=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,i.renderCache.length>i.renderCachePool.length){const d=Object.values(i.proxyCachedFBO);i.proxyCachedFBO={};for(let p=0;p<d.length;++p){const g=Object.values(d[p]);i.renderCachePool.push(...g)}}return}this._clearRasterLayersFromRenderCache();const o=this.proxyCoords,c=this._tilesDirty;for(let d=o.length-1;d>=0;d--){const p=o[d];if(i.getTileByID(p.key),i.proxyCachedFBO[p.key]!==void 0){const g=t[p.key],_=this.proxyToSource[p.key];let v=0;for(const b in _){const S=_[b],E=g[b];if(!E||E.length!==S.length||S.some((A,C)=>A!==E[C]||c[b]&&c[b].hasOwnProperty(A.key))){v=-1;break}++v}for(const b in i.proxyCachedFBO[p.key])i.renderCache[i.proxyCachedFBO[p.key][b]].dirty=v<0||v!==Object.values(g).length}}const u=[...this._drapedRenderBatches];u.sort((d,p)=>p.end-p.start-(d.end-d.start));for(const d of u)for(const p of o){if(i.proxyCachedFBO[p.key])continue;let g=i.renderCachePool.pop();g===void 0&&i.renderCache.length<50&&(g=i.renderCache.length,i.renderCache.push(this._createFBO())),g!==void 0&&(i.proxyCachedFBO[p.key]={},i.proxyCachedFBO[p.key][d.start]=g,i.renderCache[g].dirty=!0)}this._tilesDirty={}}_setupStencil(t,i,o,c){if(!c||!this._sourceTilesOverlap[c.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const u=this.painter.context,d=u.gl;if(i.length<=1)return void(this._overlapStencilType=!1);let p;if(o.isTileClipped())p=i.length,this._overlapStencilMode.test={func:d.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(i[0].overscaledZ>i[i.length-1].overscaledZ))return void(this._overlapStencilType=!1);p=1,this._overlapStencilMode.test={func:d.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+p>255&&(u.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=p,this._overlapStencilMode.ref=this._stencilRef,o.isTileClipped()&&this._renderTileClippingMasks(i,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(t){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[t.key]),this._overlapStencilMode):an.disabled}_renderTileClippingMasks(t,i){const o=this.painter,c=this.painter.context,u=c.gl;o._tileClippingMaskIDs={},c.setColorMode(Cn.disabled),c.setDepthMode(Ge.disabled);const d=o.getOrCreateProgram("clippingMask");for(const p of t){const g=o._tileClippingMaskIDs[p.key]=--i;d.draw(o,u.TRIANGLES,Ge.disabled,new an({func:u.ALWAYS,mask:0},g,255,u.KEEP,u.KEEP,u.REPLACE),Cn.disabled,un.disabled,AS(p.projMatrix),"$clipping",o.tileExtentBuffer,o.quadTriangleIndexBuffer,o.tileExtentSegments)}}pointCoordinate(t){const i=this.painter.transform;if(t.x<0||t.x>i.width||t.y<0||t.y>i.height)return null;const o=[t.x,t.y,1,1];jn.transformMat4(o,o,i.pixelMatrixInverse),jn.scale(o,o,1/o[3]),o[0]/=i.worldSize,o[1]/=i.worldSize;const c=i._camera.position,u=$n(1,i.center.lat),d=[c[0],c[1],c[2]/u,0],p=ct.subtract([],o.slice(0,3),d);ct.normalize(p,p);const g=this.raycast(d,p,this._exaggeration);return g!==null&&g?(ct.scaleAndAdd(d,d,p,g),d[3]=d[2],d[2]*=u,d):null}drawDepth(){const t=this.painter,i=t.context,o=this.proxySourceCache,c=Math.ceil(t.width),u=Math.ceil(t.height);if(!this._depthFBO||this._depthFBO.width===c&&this._depthFBO.height===u||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const d=i.gl,p=i.createFramebuffer(c,u,!0,"renderbuffer");i.activeTexture.set(d.TEXTURE0);const g=new _r(i,{width:c,height:u,data:null},d.RGBA);g.bind(d.NEAREST,d.CLAMP_TO_EDGE),p.colorAttachment.set(g.texture);const _=i.createRenderbuffer(i.gl.DEPTH_COMPONENT16,c,u);p.depthAttachment.set(_),this._depthFBO=p,this._depthTexture=g}i.bindFramebuffer.set(this._depthFBO.framebuffer),i.viewport.set([0,0,c,u]),function(d,p,g,_){if(d.transform.projection.name==="globe")return;const v=d.context,b=v.gl;v.clear({depth:1});const S=d.getOrCreateProgram("terrainDepth"),E=new Ge(b.LESS,Ge.ReadWrite,d.depthRangeFor3D);for(const A of _){const C=g.getTile(A),P=y3(A.projMatrix,0,[0,0,0]);p.setupElevationDraw(C,S),S.draw(d,b.TRIANGLES,E,an.disabled,Cn.unblended,un.backCCW,P,"terrain_depth",p.gridBuffer,p.gridIndexBuffer,p.gridNoSkirtSegments)}}(t,this,o,this.proxyCoords)}_setupProxiedCoordsForOrtho(t,i,o){if(t.getSource()instanceof Io)return this._setupProxiedCoordsForImageSource(t,i,o);this._findCoveringTileCache[t.id]=this._findCoveringTileCache[t.id]||{};const c=this.proxiedCoords[t.id]=[],u=this.proxyCoords;for(let p=0;p<u.length;p++){const g=u[p],_=this._findTileCoveringTileID(g,t);if(_){const v=this._createProxiedId(g,_,o[g.key]&&o[g.key][t.id]);c.push(v),this.proxyToSource[g.key][t.id]=[v]}}let d=!1;for(let p=0;p<i.length;p++){const g=t.getTile(i[p]);if(!g||!g.hasData())continue;const _=this._findTileCoveringTileID(g.tileID,this.proxySourceCache);if(_&&_.tileID.canonical.z!==g.tileID.canonical.z){const v=this.proxyToSource[_.tileID.key][t.id],b=this._createProxiedId(_.tileID,g,o[_.tileID.key]&&o[_.tileID.key][t.id]);v?v.splice(v.length-1,0,b):this.proxyToSource[_.tileID.key][t.id]=[b],c.push(b),d=!0}}this._sourceTilesOverlap[t.id]=d}_setupProxiedCoordsForImageSource(t,i,o){if(!t.getSource().loaded())return;const c=this.proxiedCoords[t.id]=[],u=this.proxyCoords,d=t.getSource(),p=d.tileID;if(!p)return;const g=new W(p.x,p.y)._div(1<<p.z),_=d.coordinates.map(vn.fromLngLat).reduce((b,S)=>(b.min.x=Math.min(b.min.x,S.x-g.x),b.min.y=Math.min(b.min.y,S.y-g.y),b.max.x=Math.max(b.max.x,S.x-g.x),b.max.y=Math.max(b.max.y,S.y-g.y),b),{min:new W(Number.MAX_VALUE,Number.MAX_VALUE),max:new W(-Number.MAX_VALUE,-Number.MAX_VALUE)}),v=(b,S)=>{const E=b.wrap+b.canonical.x/(1<<b.canonical.z),A=b.canonical.y/(1<<b.canonical.z),C=Dt/(1<<b.canonical.z),P=S.wrap+S.canonical.x/(1<<S.canonical.z),k=S.canonical.y/(1<<S.canonical.z);return E+C<P+_.min.x||E>P+_.max.x||A+C<k+_.min.y||A>k+_.max.y};for(let b=0;b<u.length;b++){const S=u[b];for(let E=0;E<i.length;E++){const A=t.getTile(i[E]);if(!A||!A.hasData()||v(S,A.tileID))continue;const C=this._createProxiedId(S,A,o[S.key]&&o[S.key][t.id]),P=this.proxyToSource[S.key][t.id];P?P.push(C):this.proxyToSource[S.key][t.id]=[C],c.push(C)}}}_createProxiedId(t,i,o){let c=this.orthoMatrix;if(o){const u=o.find(d=>d.key===i.tileID.key);if(u)return u}if(i.tileID.key!==t.key){const u=t.canonical.z-i.tileID.canonical.z;let d,p,g;c=wt.create();const _=i.tileID.wrap-t.wrap<<t.overscaledZ;u>0?(d=Dt>>u,p=d*((i.tileID.canonical.x<<u)-t.canonical.x+_),g=d*((i.tileID.canonical.y<<u)-t.canonical.y)):(d=Dt<<-u,p=Dt*(i.tileID.canonical.x-(t.canonical.x+_<<-u)),g=Dt*(i.tileID.canonical.y-(t.canonical.y<<-u))),wt.ortho(c,0,d,0,d,0,1),wt.translate(c,c,[p,g,0])}return new T3(i.tileID,t.key,c)}_findTileCoveringTileID(t,i){let o=i.getTile(t);if(o&&o.hasData())return o;const c=this._findCoveringTileCache[i.id],u=c[t.key];if(o=u?i.getTileByID(u):null,o&&o.hasData()||u===null)return o;let d=o?o.tileID:t,p=d.overscaledZ;const g=i.getSource().minzoom,_=[];if(!u){const b=i.getSource().maxzoom;if(t.canonical.z>=b){const S=t.canonical.z-b;i.getSource().reparseOverscaled?(p=Math.max(t.canonical.z+2,i.transform.tileZoom),d=new Pn(p,t.wrap,b,t.canonical.x>>S,t.canonical.y>>S)):S!==0&&(p=b,d=new Pn(p,t.wrap,b,t.canonical.x>>S,t.canonical.y>>S))}d.key!==t.key&&(_.push(d.key),o=i.getTile(d))}const v=b=>{_.forEach(S=>{c[S]=b}),_.length=0};for(p-=1;p>=g&&(!o||!o.hasData());p--){o&&v(o.tileID.key);const b=d.calculateScaledKey(p);if(o=i.getTileByID(b),o&&o.hasData())break;const S=c[b];if(S===null)break;S===void 0?_.push(b):o=i.getTileByID(S)}return v(o?o.tileID.key:null),o&&o.hasData()?o:null}findDEMTileFor(t){return this.enabled?this._findTileCoveringTileID(t,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(t,i){let o=this._tilesDirty[t];o||(o=this._tilesDirty[t]={}),o[i.key]=!0}}function TZ(n,t,i){const o=function(p,g,_){const v=ct.dot(g,p),b=ct.dot(_,[.2126,.7152,.0722]),S=(A,C,P)=>(1-P)*A+P*C,E=S(1-.3*Math.min(b,1),1,Math.min(v+1,1));return S(.92,1,Math.asin(Ot(g[2],-1,1))/Math.PI+.5)*E}(n,[0,0,1],t),c=[0,0,0];ct.scale(c,i.slice(0,3),o);const u=[0,0,0];ct.scale(u,t.slice(0,3),n[2]);const d=[0,0,0];return ct.add(d,c,u),cr(d)}const EZ=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],MZ=["stars","fillExtrusion","fillExtrusionGroundEffect","model","symbolSDF","symbolIcon","symbolTextAndIcon"];class E3{static cacheKey(t,i,o,c){let u=`${i}${c?c.cacheKey:""}`;for(const d of o)t.usedDefines.includes(d)&&(u+=`/${d}`);return u}constructor(t,i,o,c,u,d){const p=t.gl;this.program=p.createProgram(),this.configuration=c,this.name=i,this.fixedDefines=[...d];const g=c?c.getBinderAttributes():[],_=(o.staticAttributes||[]).concat(g);let v=c?c.defines():[];v=v.concat(d.map(P=>`#define ${P}`));const b=`#version 300 es
`;let S=b+v.concat("precision mediump float;",p3,f3.fragmentSource).join(`
`);for(const P of o.fragmentIncludes)S+=`
${Iy[P]}`;S+=`
${o.fragmentSource}`;let E=b+v.concat("precision highp float;",p3,f3.vertexSource).join(`
`);for(const P of o.vertexIncludes)E+=`
${Iy[P]}`;E+=`
${o.vertexSource}`;const A=p.createShader(p.FRAGMENT_SHADER);if(p.isContextLost())return void(this.failedToCreate=!0);p.shaderSource(A,S),p.compileShader(A),p.attachShader(this.program,A);const C=p.createShader(p.VERTEX_SHADER);if(p.isContextLost())this.failedToCreate=!0;else{p.shaderSource(C,E),p.compileShader(C),p.attachShader(this.program,C),this.attributes={},this.numAttributes=_.length;for(let P=0;P<this.numAttributes;P++)if(_[P]){const k=_[P].startsWith("a_")?_[P]:`a_${_[P]}`;p.bindAttribLocation(this.program,P,k),this.attributes[k]=P}p.linkProgram(this.program),p.deleteShader(C),p.deleteShader(A),this.fixedUniforms=u(t),this.binderUniforms=c?c.getUniforms(t):[],d.includes("TERRAIN")&&(this.terrainUniforms=(P=>({u_dem:new hn(P),u_dem_prev:new hn(P),u_dem_tl:new dn(P),u_dem_scale:new Xt(P),u_dem_tl_prev:new dn(P),u_dem_scale_prev:new Xt(P),u_dem_size:new Xt(P),u_dem_lerp:new Xt(P),u_exaggeration:new Xt(P),u_depth:new hn(P),u_depth_size_inv:new dn(P),u_meter_to_dem:new Xt(P),u_label_plane_matrix_inv:new Ke(P)}))(t)),d.includes("GLOBE")&&(this.globeUniforms=(P=>({u_tile_tl_up:new en(P),u_tile_tr_up:new en(P),u_tile_br_up:new en(P),u_tile_bl_up:new en(P),u_tile_up_scale:new Xt(P)}))(t)),d.includes("FOG")&&(this.fogUniforms=(P=>({u_fog_matrix:new Ke(P),u_fog_range:new dn(P),u_fog_color:new Rs(P),u_fog_horizon_blend:new Xt(P),u_fog_vertical_limit:new dn(P),u_fog_temporal_offset:new Xt(P),u_frustum_tl:new en(P),u_frustum_tr:new en(P),u_frustum_br:new en(P),u_frustum_bl:new en(P),u_globe_pos:new en(P),u_globe_radius:new Xt(P),u_globe_transition:new Xt(P),u_is_globe:new hn(P),u_viewport:new dn(P)}))(t)),d.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(P=>({u_cutoff_params:new Rs(P)}))(t)),d.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(P=>({u_lighting_ambient_color:new en(P),u_lighting_directional_dir:new en(P),u_lighting_directional_color:new en(P),u_ground_radiance:new en(P)}))(t)),d.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(P=>({u_light_matrix_0:new Ke(P),u_light_matrix_1:new Ke(P),u_fade_range:new dn(P),u_shadow_normal_offset:new en(P),u_shadow_intensity:new Xt(P),u_shadow_texel_size:new Xt(P),u_shadow_map_resolution:new Xt(P),u_shadow_direction:new en(P),u_shadow_bias:new en(P),u_shadowmap_0:new hn(P),u_shadowmap_1:new hn(P)}))(t))}}setTerrainUniformValues(t,i){if(!this.terrainUniforms)return;const o=this.terrainUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const c in i)o[c]&&o[c].set(this.program,c,i[c])}}setGlobeUniformValues(t,i){if(!this.globeUniforms)return;const o=this.globeUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const c in i)o[c]&&o[c].set(this.program,c,i[c])}}setFogUniformValues(t,i){if(!this.fogUniforms)return;const o=this.fogUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const c in i)o[c].set(this.program,c,i[c])}}setCutoffUniformValues(t,i){if(!this.cutoffUniforms)return;const o=this.cutoffUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const c in i)o[c].set(this.program,c,i[c])}}setLightsUniformValues(t,i){if(!this.lightsUniforms)return;const o=this.lightsUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const c in i)o[c].set(this.program,c,i[c])}}setShadowUniformValues(t,i){if(this.failedToCreate||!this.shadowUniforms)return;const o=this.shadowUniforms;t.program.set(this.program);for(const c in i)o[c].set(this.program,c,i[c])}_drawDebugWireframe(t,i,o,c,u,d,p,g,_,v){const b=t.options.wireframe;if(b.terrain===!1&&b.layers2D===!1&&b.layers3D===!1)return;const S=t.context;if(!(!(!b.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!b.layers2D||t._terrain&&t._terrain.renderingToTexture||!EZ.includes(this.name))||!(!b.layers3D||!MZ.includes(this.name))))return;const E=S.gl,A=t.wireframeDebugCache.getLinesFromTrianglesBuffer(t.frameCounter,u,S);if(!A)return;const C=[...this.fixedDefines];C.push("DEBUG_WIREFRAME");const P=t.getOrCreateProgram(this.name,{config:this.configuration,defines:C});S.program.set(P.program);const k=(V,F,U)=>{if(F[V]&&U[V])for(const q in F[V])U[V][q]&&U[V][q].set(U.program,q,F[V][q].current)};_&&_.setUniforms(P.program,S,P.binderUniforms,p,{zoom:g}),k("fixedUniforms",this,P),k("terrainUniforms",this,P),k("globeUniforms",this,P),k("fogUniforms",this,P),k("lightsUniforms",this,P),k("shadowUniforms",this,P),A.bind(),S.setColorMode(new Cn([E.ONE,E.ONE_MINUS_SRC_ALPHA,E.ZERO,E.ONE],tn.transparent,[!0,!0,!0,!1])),S.setDepthMode(new Ge(i.func===E.LESS?E.LEQUAL:i.func,Ge.ReadOnly,i.range)),S.setStencilMode(an.disabled);const L=3*d.primitiveLength*2,j=3*d.primitiveOffset*2*2;v&&v>1?E.drawElementsInstanced(E.LINES,L,E.UNSIGNED_SHORT,j,v):E.drawElements(E.LINES,L,E.UNSIGNED_SHORT,j),u.bind(),S.program.set(this.program),S.setDepthMode(i),S.setStencilMode(o),S.setColorMode(c)}draw(t,i,o,c,u,d,p,g,_,v,b,S,E,A,C,P){const k=t.context,L=k.gl;if(this.failedToCreate)return;k.program.set(this.program),k.setDepthMode(o),k.setStencilMode(c),k.setColorMode(u),k.setCullFace(d);for(const F of Object.keys(this.fixedUniforms))this.fixedUniforms[F].set(this.program,F,p[F]);A&&A.setUniforms(this.program,k,this.binderUniforms,S,{zoom:E});const j={[L.LINES]:2,[L.TRIANGLES]:3,[L.LINE_STRIP]:1}[i],V=P&&P>0?1:void 0;for(const F of b.get()){const U=F.vaos||(F.vaos={});(U[g]||(U[g]=new gZ)).bind(k,this,_,A?A.getPaintVertexBuffers():[],v,F.vertexOffset,C||[],V),P&&P>1?L.drawElementsInstanced(i,F.primitiveLength*j,L.UNSIGNED_SHORT,F.primitiveOffset*j*2,P):L.drawElements(i,F.primitiveLength*j,L.UNSIGNED_SHORT,F.primitiveOffset*j*2),i===L.TRIANGLES&&this._drawDebugWireframe(t,o,c,u,v,F,S,E,A,P)}}}function M3(n,t){const i=Math.pow(2,t.tileID.overscaledZ),o=t.tileSize*Math.pow(2,n.transform.tileZoom)/i,c=o*(t.tileID.canonical.x+t.tileID.wrap*i),u=o*t.tileID.canonical.y;return{u_image:0,u_texsize:t.imageAtlasTexture?t.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/ju(t,1,n.transform.tileZoom),u_pixel_coord_upper:[c>>16,u>>16],u_pixel_coord_lower:[65535&c,65535&u]}}const AZ=wt.create(),A3=(n,t,i,o,c,u,d,p,g,_,v,b,S,E,A,C)=>{const P=t.style.light,k=P.properties.get("position"),L=[k.x,k.y,k.z],j=bs.create();P.properties.get("anchor")==="viewport"&&(bs.fromRotation(j,-t.transform.angle),ct.transformMat3(L,L,j));const V=P.properties.get("color"),F=t.transform,U={u_matrix:n,u_lightpos:L,u_lightintensity:P.properties.get("intensity"),u_lightcolor:[V.r,V.g,V.b],u_vertical_gradient:+i,u_opacity:o,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:AZ,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:c,u_edge_radius:u,u_flood_light_color:b,u_vertical_scale:S,u_flood_light_intensity:E,u_ground_shadow_factor:A,u_emissive_strength:C};return F.projection.name==="globe"&&(U.u_tile_id=[d.canonical.x,d.canonical.y,1<<d.canonical.z],U.u_zoom_transition=g,U.u_inv_rot_matrix=v,U.u_merc_center=_,U.u_up_dir=F.projection.upVector(new Mo(0,0,0),_[0]*Dt,_[1]*Dt),U.u_height_lift=p),U},CZ=(n,t,i)=>({u_matrix:n,u_edge_radius:t,u_vertical_scale:i}),PZ=(n,t,i,o,c,u,d,p,g,_,v,b,S,E)=>{const A=A3(n,t,i,o,c,u,d,g,_,v,b,S,E,1,[0,0,0],0),C={u_height_factor:-Math.pow(2,d.overscaledZ)/p.tileSize/8};return Ct(A,M3(t,p),C)},C3=(n,t)=>({u_matrix:n,u_emissive_strength:t}),P3=(n,t,i,o)=>Ct(C3(n,t),M3(i,o)),IZ=(n,t,i)=>({u_matrix:n,u_world:i,u_emissive_strength:t}),kZ=(n,t,i,o,c)=>Ct(P3(n,t,i,o),{u_world:c}),DZ=(n,t,i,o)=>{const c=Dt/i.tileSize;return{u_matrix:n,u_camera_to_center_distance:t.getCameraToCenterDistance(o),u_extrude_scale:[t.pixelsToGLUnits[0]/c,t.pixelsToGLUnits[1]/c]}},I3=(n,t,i=1)=>({u_matrix:n,u_color:t,u_overlay:0,u_overlay_scale:i}),RZ=wt.create(),OZ=(n,t,i,o,c,u,d)=>{const p=n.transform,g=p.projection.name==="globe",_=g?$D(p.zoom,t.canonical)*p._pixelsPerMercatorPixel:ju(i,1,u),v={u_matrix:t.projMatrix,u_extrude_scale:_,u_intensity:d,u_inv_rot_matrix:RZ,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(g){v.u_inv_rot_matrix=o,v.u_merc_center=c,v.u_tile_id=[t.canonical.x,t.canonical.y,1<<t.canonical.z],v.u_zoom_transition=vi(p.zoom);const b=c[0]*Dt,S=c[1]*Dt;v.u_up_dir=p.projection.upVector(new Mo(0,0,0),b,S)}return v},k3=(n,t,i,o,c,u,d,p,g,_,v,b,S,E,A,C,P,k,L,j,V,F)=>{return{u_matrix:n,u_normalize_matrix:t,u_globe_matrix:i,u_merc_matrix:o,u_grid_matrix:c,u_tl_parent:u,u_scale_parent:v,u_fade_t:b.mix,u_opacity:b.opacity*S.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:S.paint.get("raster-brightness-min"),u_brightness_high:S.paint.get("raster-brightness-max"),u_saturation_factor:(q=S.paint.get("raster-saturation"),q>0?1-1/(1.001-q):-q),u_contrast_factor:(U=S.paint.get("raster-contrast"),U>0?1/(1-U):1+U),u_spin_weights:LZ(S.paint.get("raster-hue-rotate")),u_perspective_transform:E,u_raster_elevation:A,u_tl_br:d,u_zoom_transition:p,u_merc_center:g,u_cutoff_params:_,u_colorization_mix:zZ(P,L),u_colorization_offset:NZ(k,L),u_color_ramp:C,u_texture_offset:[V/(j+2*V),j/(j+2*V)],u_texture_res:[j+2*V,j+2*V],u_emissive_strength:F};var U,q};function LZ(n){n*=Math.PI/180;const t=Math.sin(n),i=Math.cos(n);return[(2*i+1)/3,(-Math.sqrt(3)*t-i+1)/3,(Math.sqrt(3)*t-i+1)/3]}function zZ([n,t,i,o],[c,u]){if(c===u)return[0,0,0,0];const d=259/257/(u-c);return[n*d,t*d,i*d,o*d]}function NZ(n,[t,i]){return t===i?0:((n-t)/(i-t)*259-1)/257}const D3=wt.create(),R3=(n,t,i,o,c,u,d,p,g,_,v,b,S,E,A,C,P,k)=>{const L=c.transform,j={u_is_size_zoom_constant:+(n==="constant"||n==="source"),u_is_size_feature_constant:+(n==="constant"||n==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:L.getCameraToCenterDistance(C),u_rotate_symbol:+i,u_aspect_ratio:L.width/L.height,u_fade_change:c.options.fadeDuration?c.symbolFadeChange:1,u_matrix:u,u_label_plane_matrix:d,u_coord_matrix:p,u_is_text:+g,u_pitch_with_map:+o,u_texsize:_,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:D3,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:D3,u_up_vector:[0,-1,0],u_icon_transition:k||0,u_icon_saturation:P};return C.name==="globe"&&(j.u_tile_id=[v.canonical.x,v.canonical.y,1<<v.canonical.z],j.u_zoom_transition=b,j.u_inv_rot_matrix=E,j.u_merc_center=S,j.u_camera_forward=L._camera.forward(),j.u_ecef_origin=function(V,F){const U=[0,0,0],q=hc(no(F.canonical));return ct.transformMat4(U,U,q),ct.transformMat4(U,U,V),U}(L.globeMatrix,v.toUnwrapped()),j.u_tile_matrix=Float32Array.from(L.globeMatrix),j.u_up_vector=A),j},O3=(n,t,i,o,c,u,d,p,g,_,v,b,S,E,A,C,P)=>Ct(R3(n,t,i,o,c,u,d,p,g,_,b,S,E,A,C,P,1),{u_gamma_scale:o?c.transform.getCameraToCenterDistance(P)*Math.cos(c.terrain?0:c.transform._pitch):1,u_device_pixel_ratio:Be.devicePixelRatio,u_is_halo:+v,undefined:void 0}),FZ=(n,t,i,o,c,u,d,p,g,_,v,b,S,E,A,C)=>Ct(O3(n,t,i,o,c,u,d,p,!0,g,!0,v,b,S,E,A,C),{u_texsize_icon:_,u_texture_icon:1}),BZ=(n,t,i,o)=>({u_matrix:n,u_emissive_strength:t,u_opacity:i,u_color:o}),jZ=(n,t,i,o,c,u,d)=>Ct(function(p,g,_,v){const b=_.imageManager.getPattern(p.toString(),g),{width:S,height:E}=_.imageManager.getPixelSize(g),A=Math.pow(2,v.tileID.overscaledZ),C=v.tileSize*Math.pow(2,_.transform.tileZoom)/A,P=C*(v.tileID.canonical.x+v.tileID.wrap*A),k=C*v.tileID.canonical.y;return{u_image:0,u_pattern_tl:b.tl,u_pattern_br:b.br,u_texsize:[S,E],u_pattern_size:b.displaySize,u_tile_units_to_pixels:1/ju(v,1,_.transform.tileZoom),u_pixel_coord_upper:[P>>16,k>>16],u_pixel_coord_lower:[65535&P,65535&k]}}(c,u,o,d),{u_matrix:n,u_emissive_strength:t,u_opacity:i}),Ns={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,ShadowMap0:10},CS=(n,t,i,o,c,u,d,p,g,_,v,b,S=[0,0,0])=>{const E=o.style.light,A=E.properties.get("position"),C=[-A.x,-A.y,A.z],P=bs.create();E.properties.get("anchor")==="viewport"&&(bs.fromRotation(P,-o.transform.angle),ct.transformMat3(C,C,P));const k=_.alphaMode==="MASK",L=E.properties.get("color"),j=b.paint.get("model-ambient-occlusion-intensity"),V=b.paint.get("model-color").constantOr(tn.white),F=b.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:n,u_lighting_matrix:t,u_normal_matrix:i,u_lightpos:C,u_lightintensity:E.properties.get("intensity"),u_lightcolor:[L.r,L.g,L.b],u_camera_pos:S,u_opacity:c,u_baseTextureIsAlpha:0,u_alphaMask:+k,u_alphaCutoff:_.alphaCutoff,u_baseColorFactor:[u.r,u.g,u.b,u.a],u_emissiveFactor:[d[0],d[1],d[2],1],u_metallicFactor:p,u_roughnessFactor:g,u_baseColorTexture:Ns.BaseColor,u_metallicRoughnessTexture:Ns.MetallicRoughness,u_normalTexture:Ns.Normal,u_occlusionTexture:Ns.Occlusion,u_emissionTexture:Ns.Emission,u_color_mix:[V.r,V.g,V.b,F],u_aoIntensity:j,u_emissive_strength:v}},L3=new Float32Array(16),z3=(n,t=L3,i=L3)=>({u_matrix:n,u_instance:t,u_node_matrix:i}),VZ={fillExtrusion:n=>({u_matrix:new Ke(n),u_lightpos:new en(n),u_lightintensity:new Xt(n),u_lightcolor:new en(n),u_vertical_gradient:new Xt(n),u_opacity:new Xt(n),u_edge_radius:new Xt(n),u_ao:new dn(n),u_tile_id:new en(n),u_zoom_transition:new Xt(n),u_inv_rot_matrix:new Ke(n),u_merc_center:new dn(n),u_up_dir:new en(n),u_height_lift:new Xt(n),u_flood_light_color:new en(n),u_vertical_scale:new Xt(n),u_flood_light_intensity:new Xt(n),u_ground_shadow_factor:new en(n),u_emissive_strength:new Xt(n)}),fillExtrusionDepth:n=>({u_matrix:new Ke(n),u_edge_radius:new Xt(n),u_vertical_scale:new Xt(n)}),fillExtrusionPattern:n=>({u_matrix:new Ke(n),u_lightpos:new en(n),u_lightintensity:new Xt(n),u_lightcolor:new en(n),u_vertical_gradient:new Xt(n),u_height_factor:new Xt(n),u_edge_radius:new Xt(n),u_ao:new dn(n),u_tile_id:new en(n),u_zoom_transition:new Xt(n),u_inv_rot_matrix:new Ke(n),u_merc_center:new dn(n),u_up_dir:new en(n),u_height_lift:new Xt(n),u_image:new hn(n),u_texsize:new dn(n),u_pixel_coord_upper:new dn(n),u_pixel_coord_lower:new dn(n),u_tile_units_to_pixels:new Xt(n),u_opacity:new Xt(n)}),fillExtrusionGroundEffect:n=>({u_matrix:new Ke(n),u_opacity:new Xt(n),u_ao_pass:new Xt(n),u_meter_to_tile:new Xt(n),u_ao:new dn(n),u_flood_light_intensity:new Xt(n),u_flood_light_color:new en(n),u_attenuation:new Xt(n),u_edge_radius:new Xt(n),u_fb:new hn(n),u_fb_size:new Xt(n)}),fill:n=>({u_matrix:new Ke(n),u_emissive_strength:new Xt(n)}),fillPattern:n=>({u_matrix:new Ke(n),u_emissive_strength:new Xt(n),u_image:new hn(n),u_texsize:new dn(n),u_pixel_coord_upper:new dn(n),u_pixel_coord_lower:new dn(n),u_tile_units_to_pixels:new Xt(n)}),fillOutline:n=>({u_matrix:new Ke(n),u_emissive_strength:new Xt(n),u_world:new dn(n)}),fillOutlinePattern:n=>({u_matrix:new Ke(n),u_emissive_strength:new Xt(n),u_world:new dn(n),u_image:new hn(n),u_texsize:new dn(n),u_pixel_coord_upper:new dn(n),u_pixel_coord_lower:new dn(n),u_tile_units_to_pixels:new Xt(n)}),circle:n=>({u_camera_to_center_distance:new Xt(n),u_extrude_scale:new Ub(n),u_device_pixel_ratio:new Xt(n),u_matrix:new Ke(n),u_inv_rot_matrix:new Ke(n),u_merc_center:new dn(n),u_tile_id:new en(n),u_zoom_transition:new Xt(n),u_up_dir:new en(n),u_emissive_strength:new Xt(n)}),collisionBox:n=>({u_matrix:new Ke(n),u_camera_to_center_distance:new Xt(n),u_extrude_scale:new dn(n)}),collisionCircle:n=>({u_matrix:new Ke(n),u_inv_matrix:new Ke(n),u_camera_to_center_distance:new Xt(n),u_viewport_size:new dn(n)}),debug:n=>({u_color:new sd(n),u_matrix:new Ke(n),u_overlay:new hn(n),u_overlay_scale:new Xt(n)}),clippingMask:n=>({u_matrix:new Ke(n)}),heatmap:n=>({u_extrude_scale:new Xt(n),u_intensity:new Xt(n),u_matrix:new Ke(n),u_inv_rot_matrix:new Ke(n),u_merc_center:new dn(n),u_tile_id:new en(n),u_zoom_transition:new Xt(n),u_up_dir:new en(n)}),heatmapTexture:n=>({u_image:new hn(n),u_color_ramp:new hn(n),u_opacity:new Xt(n)}),hillshade:n=>({u_matrix:new Ke(n),u_image:new hn(n),u_latrange:new dn(n),u_light:new dn(n),u_shadow:new sd(n),u_highlight:new sd(n),u_emissive_strength:new Xt(n),u_accent:new sd(n)}),hillshadePrepare:n=>({u_matrix:new Ke(n),u_image:new hn(n),u_dimension:new dn(n),u_zoom:new Xt(n)}),line:n=>({u_matrix:new Ke(n),u_pixels_to_tile_units:new Ub(n),u_device_pixel_ratio:new Xt(n),u_units_to_pixels:new dn(n),u_dash_image:new hn(n),u_gradient_image:new hn(n),u_image_height:new Xt(n),u_texsize:new dn(n),u_tile_units_to_pixels:new Xt(n),u_alpha_discard_threshold:new Xt(n),u_trim_offset:new dn(n),u_emissive_strength:new Xt(n)}),linePattern:n=>({u_matrix:new Ke(n),u_texsize:new dn(n),u_pixels_to_tile_units:new Ub(n),u_device_pixel_ratio:new Xt(n),u_image:new hn(n),u_units_to_pixels:new dn(n),u_tile_units_to_pixels:new Xt(n),u_alpha_discard_threshold:new Xt(n)}),raster:n=>({u_matrix:new Ke(n),u_normalize_matrix:new Ke(n),u_globe_matrix:new Ke(n),u_merc_matrix:new Ke(n),u_grid_matrix:new Vb(n),u_tl_parent:new dn(n),u_scale_parent:new Xt(n),u_fade_t:new Xt(n),u_opacity:new Xt(n),u_image0:new hn(n),u_image1:new hn(n),u_brightness_low:new Xt(n),u_brightness_high:new Xt(n),u_saturation_factor:new Xt(n),u_contrast_factor:new Xt(n),u_spin_weights:new en(n),u_perspective_transform:new dn(n),u_raster_elevation:new Xt(n),u_tl_br:new Rs(n),u_zoom_transition:new Xt(n),u_merc_center:new dn(n),u_cutoff_params:new Rs(n),u_colorization_mix:new Rs(n),u_colorization_offset:new Xt(n),u_color_ramp:new hn(n),u_texture_offset:new dn(n),u_texture_res:new dn(n),u_emissive_strength:new Xt(n)}),symbolIcon:n=>({u_is_size_zoom_constant:new hn(n),u_is_size_feature_constant:new hn(n),u_size_t:new Xt(n),u_size:new Xt(n),u_camera_to_center_distance:new Xt(n),u_rotate_symbol:new hn(n),u_aspect_ratio:new Xt(n),u_fade_change:new Xt(n),u_matrix:new Ke(n),u_label_plane_matrix:new Ke(n),u_coord_matrix:new Ke(n),u_is_text:new hn(n),u_pitch_with_map:new hn(n),u_texsize:new dn(n),u_tile_id:new en(n),u_zoom_transition:new Xt(n),u_inv_rot_matrix:new Ke(n),u_merc_center:new dn(n),u_camera_forward:new en(n),u_tile_matrix:new Ke(n),u_up_vector:new en(n),u_ecef_origin:new en(n),u_texture:new hn(n),u_icon_transition:new Xt(n),u_icon_saturation:new Xt(n)}),symbolSDF:n=>({u_is_size_zoom_constant:new hn(n),u_is_size_feature_constant:new hn(n),u_size_t:new Xt(n),u_size:new Xt(n),u_camera_to_center_distance:new Xt(n),u_rotate_symbol:new hn(n),u_aspect_ratio:new Xt(n),u_fade_change:new Xt(n),u_matrix:new Ke(n),u_label_plane_matrix:new Ke(n),u_coord_matrix:new Ke(n),u_is_text:new hn(n),u_pitch_with_map:new hn(n),u_texsize:new dn(n),u_texture:new hn(n),u_gamma_scale:new Xt(n),u_device_pixel_ratio:new Xt(n),u_tile_id:new en(n),u_zoom_transition:new Xt(n),u_inv_rot_matrix:new Ke(n),u_merc_center:new dn(n),u_camera_forward:new en(n),u_tile_matrix:new Ke(n),u_up_vector:new en(n),u_ecef_origin:new en(n),u_is_halo:new hn(n)}),symbolTextAndIcon:n=>({u_is_size_zoom_constant:new hn(n),u_is_size_feature_constant:new hn(n),u_size_t:new Xt(n),u_size:new Xt(n),u_camera_to_center_distance:new Xt(n),u_rotate_symbol:new hn(n),u_aspect_ratio:new Xt(n),u_fade_change:new Xt(n),u_matrix:new Ke(n),u_label_plane_matrix:new Ke(n),u_coord_matrix:new Ke(n),u_is_text:new hn(n),u_pitch_with_map:new hn(n),u_texsize:new dn(n),u_texsize_icon:new dn(n),u_texture:new hn(n),u_texture_icon:new hn(n),u_gamma_scale:new Xt(n),u_device_pixel_ratio:new Xt(n),u_is_halo:new hn(n)}),background:n=>({u_matrix:new Ke(n),u_emissive_strength:new Xt(n),u_opacity:new Xt(n),u_color:new sd(n)}),backgroundPattern:n=>({u_matrix:new Ke(n),u_emissive_strength:new Xt(n),u_opacity:new Xt(n),u_image:new hn(n),u_pattern_tl:new dn(n),u_pattern_br:new dn(n),u_texsize:new dn(n),u_pattern_size:new dn(n),u_pixel_coord_upper:new dn(n),u_pixel_coord_lower:new dn(n),u_tile_units_to_pixels:new Xt(n)}),terrainRaster:_3,terrainDepth:_3,skybox:n=>({u_matrix:new Ke(n),u_sun_direction:new en(n),u_cubemap:new hn(n),u_opacity:new Xt(n),u_temporal_offset:new Xt(n)}),skyboxGradient:n=>({u_matrix:new Ke(n),u_color_ramp:new hn(n),u_center_direction:new en(n),u_radius:new Xt(n),u_opacity:new Xt(n),u_temporal_offset:new Xt(n)}),skyboxCapture:n=>({u_matrix_3f:new Vb(n),u_sun_direction:new en(n),u_sun_intensity:new Xt(n),u_color_tint_r:new Rs(n),u_color_tint_m:new Rs(n),u_luminance:new Xt(n)}),globeRaster:n=>({u_proj_matrix:new Ke(n),u_globe_matrix:new Ke(n),u_normalize_matrix:new Ke(n),u_merc_matrix:new Ke(n),u_zoom_transition:new Xt(n),u_merc_center:new dn(n),u_image0:new hn(n),u_grid_matrix:new Vb(n),u_skirt_height:new Xt(n),u_frustum_tl:new en(n),u_frustum_tr:new en(n),u_frustum_br:new en(n),u_frustum_bl:new en(n),u_globe_pos:new en(n),u_globe_radius:new Xt(n),u_viewport:new dn(n)}),globeAtmosphere:n=>({u_frustum_tl:new en(n),u_frustum_tr:new en(n),u_frustum_br:new en(n),u_frustum_bl:new en(n),u_horizon:new Xt(n),u_transition:new Xt(n),u_fadeout_range:new Xt(n),u_color:new Rs(n),u_high_color:new Rs(n),u_space_color:new Rs(n),u_temporal_offset:new Xt(n),u_horizon_angle:new Xt(n)}),model:n=>({u_matrix:new Ke(n),u_lighting_matrix:new Ke(n),u_normal_matrix:new Ke(n),u_lightpos:new en(n),u_lightintensity:new Xt(n),u_lightcolor:new en(n),u_camera_pos:new en(n),u_opacity:new Xt(n),u_baseColorFactor:new Rs(n),u_emissiveFactor:new Rs(n),u_metallicFactor:new Xt(n),u_roughnessFactor:new Xt(n),u_baseTextureIsAlpha:new hn(n),u_alphaMask:new hn(n),u_alphaCutoff:new Xt(n),u_baseColorTexture:new hn(n),u_metallicRoughnessTexture:new hn(n),u_normalTexture:new hn(n),u_occlusionTexture:new hn(n),u_emissionTexture:new hn(n),u_color_mix:new Rs(n),u_aoIntensity:new Xt(n),u_emissive_strength:new Xt(n)}),modelDepth:n=>({u_matrix:new Ke(n),u_instance:new Ke(n),u_node_matrix:new Ke(n)}),groundShadow:n=>({u_matrix:new Ke(n),u_ground_shadow_factor:new en(n)}),stars:n=>({u_matrix:new Ke(n),u_up:new en(n),u_right:new en(n),u_intensity_multiplier:new Xt(n)})};let Ry;function N3(n,t,i,o,c,u,d){const p=n.context,g=p.gl,_=n.transform,v=n.getOrCreateProgram("collisionBox"),b=[];let S=0,E=0;for(let V=0;V<o.length;V++){const F=o[V],U=t.getTile(F),q=U.getBucket(i);if(!q)continue;const Z=Jq(F,q,_);let X=Z;c[0]===0&&c[1]===0||(X=n.translatePosMatrix(Z,U,c,u));const J=d?q.textCollisionBox:q.iconCollisionBox,rt=q.collisionCircleArray;if(rt.length>0){const it=wt.create(),ut=X;wt.mul(it,q.placementInvProjMatrix,_.glCoordMatrix),wt.mul(it,it,q.placementViewportMatrix),b.push({circleArray:rt,circleOffset:E,transform:ut,invTransform:it,projection:q.getProjection()}),S+=rt.length/4,E=S}J&&(n.terrain&&n.terrain.setupElevationDraw(U,v),v.draw(n,g.LINES,Ge.disabled,an.disabled,n.colorModeForRenderPass(),un.disabled,DZ(X,_,U,q.getProjection()),i.id,J.layoutVertexBuffer,J.indexBuffer,J.segments,null,_.zoom,null,[J.collisionVertexBuffer,J.collisionVertexBufferExt]))}if(!d||!b.length)return;const A=n.getOrCreateProgram("collisionCircle"),C=new Ib;C.resize(4*S),C._trim();let P=0;for(const V of b)for(let F=0;F<V.circleArray.length/4;F++){const U=4*F,q=V.circleArray[U+0],Z=V.circleArray[U+1],X=V.circleArray[U+2],J=V.circleArray[U+3];C.emplace(P++,q,Z,X,J,0),C.emplace(P++,q,Z,X,J,1),C.emplace(P++,q,Z,X,J,2),C.emplace(P++,q,Z,X,J,3)}(!Ry||Ry.length<2*S)&&(Ry=function(V){const F=2*V,U=new Hr;U.resize(F),U._trim();for(let q=0;q<F;q++){const Z=6*q;U.uint16[Z+0]=4*q+0,U.uint16[Z+1]=4*q+1,U.uint16[Z+2]=4*q+2,U.uint16[Z+3]=4*q+2,U.uint16[Z+4]=4*q+3,U.uint16[Z+5]=4*q+0}return U}(S));const k=p.createIndexBuffer(Ry,!0),L=p.createVertexBuffer(C,uW.members,!0);for(const V of b){const F={u_matrix:V.transform,u_inv_matrix:V.invTransform,u_camera_to_center_distance:(j=_).getCameraToCenterDistance(V.projection),u_viewport_size:[j.width,j.height]};A.draw(n,g.TRIANGLES,Ge.disabled,an.disabled,n.colorModeForRenderPass(),un.disabled,F,i.id,L,k,Bn.simpleSegment(0,2*V.circleOffset,V.circleArray.length,V.circleArray.length/2),null,_.zoom)}var j;L.destroy(),k.destroy()}const F3=wt.create();function UZ({width:n,height:t,anchor:i,textOffset:o,textScale:c},u){const{horizontalAlign:d,verticalAlign:p}=Z_(i),g=-(d-.5)*n,_=-(p-.5)*t,v=Bw(i,o);return new W((g/c+v[0])*u,(_/c+v[1])*u)}function $Z(n,t,i,o,c,u,d,p,g,_,v){const b=n.text.placedSymbolArray,S=n.text.dynamicLayoutVertexArray,E=n.icon.dynamicLayoutVertexArray,A={},C=n.getProjection(),P=bS(p,C,u),k=u.elevation,L=C.upVectorScale(p.canonical,u.center.lat,u.worldSize).metersToTile;S.clear();for(let j=0;j<b.length;j++){const V=b.get(j),{tileAnchorX:F,tileAnchorY:U,numGlyphs:q}=V,Z=V.hidden||!V.crossTileID||n.allowVerticalPlacement&&!V.placedOrientation?null:o[V.crossTileID];if(Z){let X=0,J=0,rt=0;if(k){const Et=k?k.getAtTileOffset(p,F,U):0,[At,Mt,Lt]=C.upVector(p.canonical,F,U);X=Et*At*L,J=Et*Mt*L,rt=Et*Lt*L}let[it,ut,tt,dt]=ta(V.projectedAnchorX+X,V.projectedAnchorY+J,V.projectedAnchorZ+rt,i?P:d);const gt=CO(u.getCameraToCenterDistance(C),dt);let xt=c.evaluateSizeForFeature(n.textSizeData,_,V)*gt/xi;i&&(xt*=n.tilePixelRatio/g);const ht=UZ(Z,xt);i?({x:it,y:ut,z:tt}=C.projectTilePoint(F+ht.x,U+ht.y,p.canonical),[it,ut,tt]=ta(it+X,ut+J,tt+rt,d)):(t&&ht._rotate(-u.angle),it+=ht.x,ut+=ht.y,tt=0);const pt=n.allowVerticalPlacement&&V.placedOrientation===dr.vertical?Math.PI/2:0;for(let Et=0;Et<q;Et++)Sd(S,it,ut,tt,pt);v&&V.associatedIconIndex>=0&&(A[V.associatedIconIndex]={x:it,y:ut,z:tt,angle:pt})}else Ed(q,S)}if(v){E.clear();const j=n.icon.placedSymbolArray;for(let V=0;V<j.length;V++){const F=j.get(V),{numGlyphs:U}=F,q=A[V];if(F.hidden||!q)Ed(U,E);else{const{x:Z,y:X,z:J,angle:rt}=q;for(let it=0;it<U;it++)Sd(E,Z,X,J,rt)}}n.icon.dynamicLayoutVertexBuffer.updateData(E)}n.text.dynamicLayoutVertexBuffer.updateData(S)}function GZ(n,t,i){return i.iconsInText&&t?"symbolTextAndIcon":n?"symbolSDF":"symbolIcon"}function B3(n,t,i,o,c,u,d,p,g,_,v,b,S){const E=n.context,A=E.gl,C=n.transform,P=p==="map",k=g==="map",L=P&&i.layout.get("symbol-placement")!=="point",j=P&&!k&&!L,V=i.layout.get("symbol-sort-key").constantOr(1)!==void 0;let F=!1;const U=n.depthModeForSublayer(0,Ge.ReadOnly),q=[ti(C.center.lng),ui(C.center.lat)],Z=i.layout.get("text-variable-anchor"),X=C.projection.name==="globe",J=[],rt=[0,-1,0];let it=rt;!X&&!C.mercatorFromTransition||P||(it=function(ut){const tt=ut._camera.getWorldToCamera(ut.worldSize,1),dt=wt.multiply([],tt,ut.globeMatrix);wt.invert(dt,dt);const gt=[0,0,0],xt=[0,1,0,0];return jn.transformMat4(xt,xt,dt),gt[0]=xt[0],gt[1]=xt[1],gt[2]=xt[2],ct.normalize(gt,gt),gt}(C));for(const ut of o){const tt=t.getTile(ut),dt=tt.getBucket(i);if(!dt||dt.projection.name==="mercator"&&X)continue;const gt=c?dt.text:dt.icon;if(!gt||dt.fullyClipped||!gt.segments.get().length)continue;const xt=gt.programConfigurations.get(i.id),ht=c||dt.sdfIcons,pt=c?dt.textSizeData:dt.iconSizeData,Et=k||C.pitch!==0,At=Ca(pt,C.zoom);let Mt,Lt,Nt,jt,It=[0,0],Gt=null;if(c)Lt=tt.glyphAtlasTexture?tt.glyphAtlasTexture:null,Nt=A.LINEAR,Mt=tt.glyphAtlasTexture?tt.glyphAtlasTexture.size:[0,0],dt.iconsInText&&(It=tt.imageAtlasTexture?tt.imageAtlasTexture.size:[0,0],Gt=tt.imageAtlasTexture?tt.imageAtlasTexture:null,jt=Et||n.options.rotating||n.options.zooming||pt.kind==="composite"||pt.kind==="camera"?A.LINEAR:A.NEAREST);else{const lr=i.layout.get("icon-size").constantOr(0)!==1||dt.iconsNeedLinear;Lt=tt.imageAtlasTexture?tt.imageAtlasTexture:null,Nt=ht||n.options.rotating||n.options.zooming||lr||Et?A.LINEAR:A.NEAREST,Mt=tt.imageAtlasTexture?tt.imageAtlasTexture.size:[0,0]}const ce=dt.projection.name==="globe",ue=ce?it:rt,ye=ce?vi(C.zoom):0,be=bS(ut,dt.getProjection(),C),We=C.calculatePixelsToTileUnitsMatrix(tt),Pe=fy(be,tt.tileID.canonical,k,P,C,dt.getProjection(),We),Tn=n.terrain&&k&&L?wt.invert(wt.create(),Pe):F3,fn=AO(be,tt.tileID.canonical,k,P,C,dt.getProjection(),We),He=Z&&dt.hasTextData(),Ue=dt.hasIconTextFit()&&He&&dt.hasIconData();if(L){const lr=C.elevation,zn=lr?lr.getAtTileOffsetFunc(ut,C.center.lat,C.worldSize,dt.getProjection()):null,Pi=MO(be,tt.tileID.canonical,k,P,C,dt.getProjection(),We);UH(dt,be,n,c,Pi,fn,k,_,zn,ut)}const Re=L||c&&Z||Ue,gn=n.translatePosMatrix(be,tt,u,d),bn=Re?F3:Pe,sn=n.translatePosMatrix(fn,tt,u,d,!0),Gn=dt.getProjection().createInversionMatrix(C,ut.canonical),kr=i.paint.get("icon-image-cross-fade").constantOr(0),Vn=[];n.terrainRenderModeElevated()&&k&&Vn.push("PITCH_WITH_MAP_TERRAIN"),ce&&(Vn.push("PROJECTION_GLOBE_VIEW"),Re&&Vn.push("PROJECTED_POS_ON_VIEWPORT")),kr>0&&Vn.push("ICON_TRANSITION"),gt.zOffsetVertexBuffer&&Vn.push("Z_OFFSET");const rr=ht&&i.paint.get(c?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Or;ht?Or=dt.iconsInText?FZ(pt.kind,At,j,k,n,gn,bn,sn,Mt,It,ut,ye,q,Gn,ue,dt.getProjection()):O3(pt.kind,At,j,k,n,gn,bn,sn,c,Mt,!0,ut,ye,q,Gn,ue,dt.getProjection()):(v<1&&Vn.push("SATURATION"),Or=R3(pt.kind,At,j,k,n,gn,bn,sn,c,Mt,ut,ye,q,Gn,ue,dt.getProjection(),v,kr));const Dr={program:n.getOrCreateProgram(GZ(ht,c,dt),{config:xt,defines:Vn}),buffers:gt,uniformValues:Or,atlasTexture:Lt,atlasTextureIcon:Gt,atlasInterpolation:Nt,atlasInterpolationIcon:jt,isSDF:ht,hasHalo:rr,tile:tt,labelPlaneMatrixInv:Tn};if(V&&dt.canOverlap){F=!0;const lr=gt.segments.get();for(const zn of lr)J.push({segments:new Bn([zn]),sortKey:zn.sortKey,state:Dr})}else J.push({segments:gt.segments,sortKey:0,state:Dr})}F&&J.sort((ut,tt)=>ut.sortKey-tt.sortKey);for(const ut of J){const tt=ut.state;if(n.terrain&&n.terrain.setupElevationDraw(tt.tile,tt.program,{useDepthForOcclusion:C.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:tt.labelPlaneMatrixInv}),E.activeTexture.set(A.TEXTURE0),tt.atlasTexture&&tt.atlasTexture.bind(tt.atlasInterpolation,A.CLAMP_TO_EDGE),tt.atlasTextureIcon&&(E.activeTexture.set(A.TEXTURE1),tt.atlasTextureIcon&&tt.atlasTextureIcon.bind(tt.atlasInterpolationIcon,A.CLAMP_TO_EDGE)),n.uploadCommonLightUniforms(n.context,tt.program),tt.hasHalo){const dt=tt.uniformValues;dt.u_is_halo=1,PS(tt.buffers,ut.segments,i,n,tt.program,U,b,S,dt,2),dt.u_is_halo=0}else{if(tt.isSDF){const dt=tt.uniformValues;tt.hasHalo&&(dt.u_is_halo=1,PS(tt.buffers,ut.segments,i,n,tt.program,U,b,S,dt,1)),dt.u_is_halo=0}PS(tt.buffers,ut.segments,i,n,tt.program,U,b,S,tt.uniformValues,1)}}}function PS(n,t,i,o,c,u,d,p,g,_){const v=[n.dynamicLayoutVertexBuffer,n.opacityVertexBuffer,n.iconTransitioningVertexBuffer,n.globeExtVertexBuffer,n.zOffsetVertexBuffer];c.draw(o,o.context.gl.TRIANGLES,u,d,p,un.disabled,g,i.id,n.layoutVertexBuffer,n.indexBuffer,t,i.paint,o.transform.zoom,n.programConfigurations.get(i.id),v,_)}function j3(n,t,i,o,c,u,d){const p=n.context.gl,g=i.paint.get("fill-pattern"),_=g&&g.constantOr(1);let v,b,S,E,A;d?(b=_&&!i.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",v=p.LINES):(b=_?"fillPattern":"fill",v=p.TRIANGLES);for(const C of o){const P=t.getTile(C);if(_&&!P.patternsLoaded())continue;const k=P.getBucket(i);if(!k)continue;n.prepareDrawTile();const L=k.programConfigurations.get(i.id),j=n.isTileAffectedByFog(C),V=n.getOrCreateProgram(b,{config:L,overrideFog:j});_&&(n.context.activeTexture.set(p.TEXTURE0),P.imageAtlasTexture&&P.imageAtlasTexture.bind(p.LINEAR,p.CLAMP_TO_EDGE),L.updatePaintBuffers());const F=g.constantOr(null);if(F&&P.imageAtlas){const Z=P.imageAtlas.patternPositions[F.toString()];Z&&L.setConstantPatternPositions(Z)}const U=n.translatePosMatrix(C.projMatrix,P,i.paint.get("fill-translate"),i.paint.get("fill-translate-anchor")),q=i.paint.get("fill-emissive-strength");if(d){E=k.indexBuffer2,A=k.segments2;const Z=n.terrain&&n.terrain.renderingToTexture?n.terrain.drapeBufferSize:[p.drawingBufferWidth,p.drawingBufferHeight];S=b==="fillOutlinePattern"&&_?kZ(U,q,n,P,Z):IZ(U,q,Z)}else E=k.indexBuffer,A=k.segments,S=_?P3(U,q,n,P):C3(U,q);n.uploadCommonUniforms(n.context,V,C.toUnwrapped()),V.draw(n,v,c,n.stencilModeForClipping(C),u,un.disabled,S,i.id,k.layoutVertexBuffer,E,A,i.paint,n.transform.zoom,L,void 0)}}function Oy(n,t,i,o,c,u,d,p){i.resetLayerRenderingStats();const g=n.context,_=g.gl,v=n.transform,b=i.paint.get("fill-extrusion-pattern"),S=b.constantOr(1),E=i.paint.get("fill-extrusion-opacity"),A=n.style.enable3dLights(),C=i.paint.get(A&&!S?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),P=[i.paint.get("fill-extrusion-ambient-occlusion-intensity"),C],k=i.layout.get("fill-extrusion-edge-radius"),L=k>0&&!i.paint.get("fill-extrusion-rounded-roof"),j=L?0:k,V=v.projection.name==="globe"?cL():0,F=v.projection.name==="globe",U=F?vi(v.zoom):0,q=[ti(v.center.lng),ui(v.center.lat)],Z=i.paint.get("fill-extrusion-flood-light-color").toArray01().slice(0,3),X=i.paint.get("fill-extrusion-flood-light-intensity"),J=i.paint.get("fill-extrusion-vertical-scale"),rt=Cd(n,i.paint.get("fill-extrusion-cutoff-fade-range")),it=i.paint.get("fill-extrusion-emissive-strength"),ut=[];let tt;F&&ut.push("PROJECTION_GLOBE_VIEW"),P[0]>0&&ut.push("FAUX_AO"),L&&ut.push("ZERO_ROOF_RADIUS"),p&&ut.push("HAS_CENTROID"),X>0&&ut.push("FLOOD_LIGHT"),rt.shouldRenderCutoff&&ut.push("RENDER_CUTOFF");const dt=n.renderPass==="shadow",gt=n.shadowRenderer,xt=dt&&!!gt;n.shadowRenderer&&(n.shadowRenderer.useNormalOffset=!0);let ht=[0,0,0];if(gt){const At=n.style.directionalLight,Mt=n.style.ambientLight;At&&Mt&&(ht=DS(At,Mt)),tt=ut.concat(["SHADOWS_SINGLE_CASCADE"])}const pt=xt?"fillExtrusionDepth":S?"fillExtrusionPattern":"fillExtrusion",Et=i.getLayerRenderingStats();for(const At of o){const Mt=t.getTile(At),Lt=Mt.getBucket(i);if(!Lt||Lt.projection.name!==v.projection.name)continue;let Nt=!1;gt&&(Nt=gt.getMaxCascadeForTile(At.toUnwrapped())===0);const jt=n.isTileAffectedByFog(At),It=Lt.programConfigurations.get(i.id),Gt=n.getOrCreateProgram(pt,{config:It,defines:Nt?tt:ut,overrideFog:jt});if(n.terrain&&n.terrain.setupElevationDraw(Mt,Gt,{useMeterToDem:!0}),!Lt.centroidVertexBuffer){const Pe=Gt.attributes.a_centroid_pos;Pe!==void 0&&_.vertexAttrib2f(Pe,0,0)}!dt&&gt&&gt.setupShadows(Mt.tileID.toUnwrapped(),Gt,"vector-tile",Mt.tileID.overscaledZ),S&&(n.context.activeTexture.set(_.TEXTURE0),Mt.imageAtlasTexture&&Mt.imageAtlasTexture.bind(_.LINEAR,_.CLAMP_TO_EDGE),It.updatePaintBuffers());const ce=b.constantOr(null);if(ce&&Mt.imageAtlas){const Pe=Mt.imageAtlas.patternPositions[ce.toString()];Pe&&It.setConstantPatternPositions(Pe)}const ue=i.paint.get("fill-extrusion-vertical-gradient");let ye;if(dt&&gt){if(XZ(Mt.tileID,Lt,n))continue;const Pe=gt.calculateShadowPassMatrixFromTile(Mt.tileID.toUnwrapped());ye=CZ(Pe,j,J)}else{const Pe=n.translatePosMatrix(At.expandedProjMatrix,Mt,i.paint.get("fill-extrusion-translate"),i.paint.get("fill-extrusion-translate-anchor")),Tn=v.projection.createInversionMatrix(v,At.canonical);ye=S?PZ(Pe,n,ue,E,P,j,At,Mt,V,U,q,Tn,Z,J):A3(Pe,n,ue,E,P,j,At,V,U,q,Tn,Z,J,X,ht,it)}n.uploadCommonUniforms(g,Gt,At.toUnwrapped(),null,rt);let be=Lt.segments;if(v.projection.name==="mercator"&&!dt&&(be=Lt.getVisibleSegments(Mt.tileID,n.terrain,n.transform.getFrustum(0)),!be.get().length))continue;if(Et)if(dt)for(const Pe of be.get())Et.numRenderedVerticesInShadowPass+=Pe.primitiveLength;else for(const Pe of be.get())Et.numRenderedVerticesInTransparentPass+=Pe.primitiveLength;const We=[];(n.terrain||p)&&We.push(Lt.centroidVertexBuffer),F&&We.push(Lt.layoutVertexExtBuffer),Gt.draw(n,g.gl.TRIANGLES,c,u,d,un.backCCW,ye,i.id,Lt.layoutVertexBuffer,Lt.indexBuffer,be,i.paint,n.transform.zoom,It,We)}n.shadowRenderer&&(n.shadowRenderer.useNormalOffset=!1)}function Id(n,t,i,o,c,u,d,p,g,_,v,b,S,E,A,C,P,k,L){const j=n.context,V=j.gl,F=n.transform,U=n.transform.zoom,q=[],Z=Cd(n,i.paint.get("fill-extrusion-cutoff-fade-range"));_==="clear"?(q.push("CLEAR_SUBPASS"),L&&(q.push("CLEAR_FROM_TEXTURE"),j.activeTexture.set(V.TEXTURE0),L.bind(V.LINEAR,V.CLAMP_TO_EDGE))):_==="sdf"&&q.push("SDF_SUBPASS"),P&&q.push("HAS_CENTROID"),Z.shouldRenderCutoff&&q.push("RENDER_CUTOFF");const X=i.layout.get("fill-extrusion-edge-radius"),J=(rt,it,ut,tt,dt)=>{const gt=it.programConfigurations.get(i.id),xt=n.isTileAffectedByFog(rt),ht=n.getOrCreateProgram("fillExtrusionGroundEffect",{config:gt,defines:q,overrideFog:xt}),pt=((At,Mt,Lt,Nt,jt,It,Gt,ce,ue,ye,be)=>({u_matrix:Mt,u_opacity:Lt,u_ao_pass:Nt?1:0,u_meter_to_tile:jt,u_ao:It,u_flood_light_intensity:Gt,u_flood_light_color:ce,u_attenuation:ue,u_edge_radius:ye,u_fb:0,u_fb_size:be}))(0,tt,v,g,dt,[b,S*dt],E,A,C,U>=17?0:X*dt,L?L.size[0]:0),Et=[];P&&Et.push(it.hiddenByLandmarkVertexBuffer),n.uploadCommonUniforms(j,ht,rt.toUnwrapped(),null,Z),ht.draw(n,j.gl.TRIANGLES,c,u,d,p,pt,i.id,it.vertexBuffer,it.indexBuffer,ut,i.paint,U,gt,Et)};for(const rt of o){const it=t.getTile(rt),ut=it.getBucket(i);if(!ut||ut.projection.name!==F.projection.name||!ut.groundEffect||ut.groundEffect&&!ut.groundEffect.hasData())continue;const tt=ut.groundEffect,dt=1/ut.tileToMeter;{const gt=n.translatePosMatrix(rt.projMatrix,it,i.paint.get("fill-extrusion-translate"),i.paint.get("fill-extrusion-translate-anchor")),xt=tt.getDefaultSegment();J(rt,tt,xt,gt,dt)}if(k)for(let gt=0;gt<4;gt++){const xt=LD[gt](rt),ht=t.getTile(xt);if(!ht)continue;const pt=ht.getBucket(i);if(!pt||pt.projection.name!==F.projection.name||!pt.groundEffect||pt.groundEffect&&!pt.groundEffect.hasData())continue;const Et=pt.groundEffect;let At,Mt;gt===0?(At=[-Dt,0,0],Mt=1):gt===1?(At=[Dt,0,0],Mt=0):gt===2?(At=[0,-Dt,0],Mt=3):(At=[0,Dt,0],Mt=2);const Lt=Et.regionSegments[Mt];if(!Lt)continue;const Nt=new Float32Array(16);wt.translate(Nt,rt.projMatrix,At),J(rt,Et,Lt,n.translatePosMatrix(Nt,it,i.paint.get("fill-extrusion-translate"),i.paint.get("fill-extrusion-translate-anchor")),dt)}}}function WZ(n,t,i,o,c,u,d){o.centroidVertexArray.length===0&&o.createCentroidsBuffer();const p=u?u.findDEMTileFor(i):null;if(!(p&&p.dem||d))return;const g=k=>{const L=t.getSource().minzoom,j=F=>{const U=t.getTileByID(F);if(U&&U.hasData())return U.getBucket(c)},V=[0,-1,1];for(const F of V){if(k.overscaledZ+F<L)continue;const U=j(k.calculateScaledKey(k.overscaledZ+F));if(U)return U}},_=[0,0,0],v=(k,L)=>(_[0]=Math.min(k.min.y,L.min.y),_[1]=Math.max(k.max.y,L.max.y),_[2]=Dt-L.min.x>k.max.x?L.min.x-Dt:k.max.x,_),b=(k,L)=>(_[0]=Math.min(k.min.x,L.min.x),_[1]=Math.max(k.max.x,L.max.x),_[2]=Dt-L.min.y>k.max.y?L.min.y-Dt:k.max.y,_),S=[(k,L)=>v(k,L),(k,L)=>v(L,k),(k,L)=>b(k,L),(k,L)=>b(L,k)],E=(k,L,j,V,F,U,q)=>{if(!u)return 0;const Z=[[U?j:k,U?k:j,0],[U?j:L,U?L:j,0]],X=q<0?Dt+q:q,J=[U?X:(k+L)/2,U?(k+L)/2:X,0];return j===0&&q<0||j!==0&&q>0?u.getForTilePoints(F,[J],!0,V):Z.push(J),u.getForTilePoints(i,Z,!0,p),Math.max(Z[0][2],Z[1][2],J[2])/u.exaggeration()};for(let k=0;k<4;k++){const L=o.borderFeatureIndices[k];if(L.length===0)continue;const j=LD[k](i),V=g(j);if(!(V&&V instanceof Cp)||o.borderDoneWithNeighborZ[k]===V.canonical.z)continue;V.centroidVertexArray.length===0&&V.createCentroidsBuffer();const F=u?u.findDEMTileFor(j):null;if(!(F&&F.dem||d))continue;const U=(k<2?1:5)-k,q=V.borderDoneWithNeighborZ[U]!==o.canonical.z,Z=V.borderFeatureIndices[U];let X=0;if(o.canonical.z!==V.canonical.z){for(const J of L)o.showCentroid(o.featuresOnBorder[J]);if(q)for(const J of Z)V.showCentroid(V.featuresOnBorder[J]);o.borderDoneWithNeighborZ[k]=V.canonical.z,V.borderDoneWithNeighborZ[U]=o.canonical.z}for(const J of L){const rt=o.featuresOnBorder[J],it=o.centroidData[rt.centroidDataIndex],ut=rt.borders[k];let tt;for(;X<Z.length;){tt=V.featuresOnBorder[Z[X]];const dt=tt.borders[U];if(dt[1]>ut[0]+3||dt[0]>ut[0]-3)break;V.showCentroid(tt),X++}if(tt&&X<Z.length){const dt=X;let gt=0;for(;!(tt.borders[U][0]>ut[1]-3)&&(gt++,++X!==Z.length);)tt=V.featuresOnBorder[Z[X]];if(tt=V.featuresOnBorder[Z[dt]],gt>1){const pt=tt.borders[U];Math.abs(ut[0]-pt[0])<3&&Math.abs(ut[1]-pt[1])<3&&(gt=1,X=dt+1)}else if(gt===0){o.showCentroid(rt);continue}const xt=V.centroidData[tt.centroidDataIndex];d&&gt===1&&(((C=it).flags|(P=xt).flags)&ka?(C.flags|=ka,P.flags|=ka):(C.flags&=2147483647,P.flags&=2147483647));let ht=new W(0,0);if(gt>1)X=dt;else if(F&&F.dem&&!(rt.intersectsCount()>1||tt.intersectsCount()>1)){const pt=S[k](it,xt),Et=k%2?Dt-1:0;A=E(pt[0],Math.min(Dt-1,pt[1]),Et,F,j,k<2,pt[2]),ht=new W(Math.ceil(7*(A+450)),0)}it.centroidXY=xt.centroidXY=ht,o.writeCentroidToBuffer(it),V.writeCentroidToBuffer(xt)}else o.showCentroid(rt)}o.borderDoneWithNeighborZ[k]=V.canonical.z,V.borderDoneWithNeighborZ[U]=o.canonical.z}var A,C,P;(o.needsCentroidUpdate||!o.centroidVertexBuffer&&o.centroidVertexArray.length!==0)&&o.uploadCentroid(n)}const HZ=[1,0,0],qZ=[0,1,0],ZZ=[0,0,1];function XZ(n,t,i){const o=i.transform,c=i.shadowRenderer;if(!c)return!0;const u=n.toUnwrapped(),d=o.tileSize*c._cascades[i.currentShadowCascade].scale;let p=t.maxHeight;if(o.elevation){const C=o.elevation.getMinMaxForTile(n);C&&(p+=C.max)}const g=[...c.shadowDirection];g[2]=-g[2];const _=c.computeSimplifiedTileShadowVolume(u,p,d,g);if(!_)return!1;const v=[HZ,qZ,ZZ,g,[g[0],0,g[2]],[0,g[1],g[2]]],b=o.projection.name==="globe",S=o.scaleZoom(d),E=hl.fromInvProjectionMatrix(o.invProjMatrix,o.worldSize,S,!b),A=c.getCurrentCascadeFrustum();return E.intersectsPrecise(_.vertices,_.planes,v)===0||A.intersectsPrecise(_.vertices,_.planes,v)===0}function YZ(n){const t=n._nearZ,i=n.projection.farthestPixelDistance(n),o=i-t,c=.2*n.height,u=t+c;return[t,i,(u-c-t)/o,(u-t)/o]}const KZ=new tn(1,0,0,1),JZ=new tn(0,1,0,1),QZ=new tn(0,0,1,1),tX=new tn(1,0,1,1),eX=new tn(0,1,1,1);function nX(n,t,i){const o=n.context,c=n.transform,u=o.gl,d=c.projection.name==="globe",p=d?["PROJECTION_GLOBE_VIEW"]:[];let g=i.projMatrix;if(d&&vi(c.zoom)>0){const J=hw(jD(i.canonical,c));g=wt.multiply(new Float32Array(16),c.globeMatrix,J),wt.multiply(g,c.projMatrix,g)}const _=n.getOrCreateProgram("debug",{defines:p}),v=t.getTileByID(i.key);n.terrain&&n.terrain.setupElevationDraw(v,_);const b=Ge.disabled,S=an.disabled,E=n.colorModeForRenderPass(),A="$debug";o.activeTexture.set(u.TEXTURE0),n.emptyTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE),d?v._makeGlobeTileDebugBuffers(n.context,c):v._makeDebugTileBoundsBuffers(n.context,c.projection);const C=v._tileDebugBuffer||n.debugBuffer,P=v._tileDebugIndexBuffer||n.debugIndexBuffer,k=v._tileDebugSegments||n.debugSegments;_.draw(n,u.LINE_STRIP,b,S,E,un.disabled,I3(g,tn.red),A,C,P,k,null,null,null,[v._globeTileDebugBorderBuffer]);const L=v.latestRawTileData,j=Math.floor((L&&L.byteLength||0)/1024),V=t.getTile(i).tileSize,F=512/Math.min(V,512)*(i.overscaledZ/c.zoom)*.5;let U=i.canonical.toString();i.overscaledZ!==i.canonical.z&&(U+=` => ${i.overscaledZ}`),U+=` ${j}kb`,function(J,rt){J.initDebugOverlayCanvas();const it=J.debugOverlayCanvas,ut=J.context.gl,tt=J.debugOverlayCanvas.getContext("2d");tt.clearRect(0,0,it.width,it.height),tt.shadowColor="white",tt.shadowBlur=2,tt.lineWidth=1.5,tt.strokeStyle="white",tt.textBaseline="top",tt.font="bold 36px Open Sans, sans-serif",tt.fillText(rt,5,5),tt.strokeText(rt,5,5),J.debugOverlayTexture.update(it),J.debugOverlayTexture.bind(ut.LINEAR,ut.CLAMP_TO_EDGE)}(n,U);const q=v._tileDebugTextBuffer||n.debugBuffer,Z=v._tileDebugTextIndexBuffer||n.quadTriangleIndexBuffer,X=v._tileDebugTextSegments||n.debugSegments;_.draw(n,u.TRIANGLES,b,S,Cn.alphaBlended,un.disabled,I3(g,tn.transparent,F),A,q,Z,X,null,null,null,[v._globeTileDebugTextBuffer])}function V3(n,t,i,o){Ly(n,0,t+i/2,n.transform.width,i,o)}function U3(n,t,i,o){Ly(n,t-i/2,0,i,n.transform.height,o)}function Ly(n,t,i,o,c,u){const d=n.context,p=d.gl;p.enable(p.SCISSOR_TEST),p.scissor(t*Be.devicePixelRatio,i*Be.devicePixelRatio,o*Be.devicePixelRatio,c*Be.devicePixelRatio),d.clear({color:u}),p.disable(p.SCISSOR_TEST)}const rX=Rn([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:iX}=rX;function Ec(n,t,i,o){n.emplaceBack(t,i,o)}class $3{constructor(t){this.vertexArray=new Ou,this.indices=new Hr,Ec(this.vertexArray,-1,-1,1),Ec(this.vertexArray,1,-1,1),Ec(this.vertexArray,-1,1,1),Ec(this.vertexArray,1,1,1),Ec(this.vertexArray,-1,-1,-1),Ec(this.vertexArray,1,-1,-1),Ec(this.vertexArray,-1,1,-1),Ec(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=t.createVertexBuffer(this.vertexArray,iX),this.indexBuffer=t.createIndexBuffer(this.indices),this.segment=Bn.simpleSegment(0,0,36,12)}}function kd(n,t,i,o,c,u){const d=n.context.gl,p=t.paint.get("sky-atmosphere-color"),g=t.paint.get("sky-atmosphere-halo-color"),_=t.paint.get("sky-atmosphere-sun-intensity"),v=((b,S,E,A,C)=>({u_matrix_3f:b,u_sun_direction:S,u_sun_intensity:E,u_color_tint_r:[A.r,A.g,A.b,A.a],u_color_tint_m:[C.r,C.g,C.b,C.a],u_luminance:5e-5}))(bs.fromMat4(bs.create(),o),c,_,p,g);d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_CUBE_MAP_POSITIVE_X+u,t.skyboxTexture,0),i.draw(n,d.TRIANGLES,Ge.disabled,an.disabled,Cn.unblended,un.frontCW,v,"skyboxCapture",t.skyboxGeometry.vertexBuffer,t.skyboxGeometry.indexBuffer,t.skyboxGeometry.segment)}const sX=Rn([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class oX{constructor(t){const i=new Ru;i.emplaceBack(-1,1,1,0,0),i.emplaceBack(1,1,1,1,0),i.emplaceBack(1,-1,1,1,1),i.emplaceBack(-1,-1,1,0,1);const o=new Hr;o.emplaceBack(0,1,2),o.emplaceBack(2,3,0),this.vertexBuffer=t.createVertexBuffer(i,sX.members),this.indexBuffer=t.createIndexBuffer(o),this.segments=Bn.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const aX=Rn([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class lX{constructor(){this.colorModeAlphaBlendedWriteRGB=new Cn([1,hy,1,hy],tn.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new Cn([1,0,1,0],tn.transparent,[!1,!1,!1,!0])}update(t){const i=t.context;if(!this.atmosphereBuffer){this.atmosphereBuffer=new oX(i);const o=100,c=200,u=function(v){const b=rb(30),S=[];for(let E=0;E<16e3;++E){const A=2*Math.PI*b(),C=Math.acos(1-2*b())-.5*Math.PI;S.push(ct.fromValues(Math.cos(C)*Math.cos(A),Math.cos(C)*Math.sin(A),Math.sin(C)))}return S}(),d=rb(300),p=new Ob,g=new Hr;let _=0;for(let v=0;v<u.length;++v){const b=ct.scale([],u[v],200),S=Math.max(0,1+.01*o*(1*d()-.5)),E=Math.max(0,1+.01*c*(1*d()-.5));p.emplaceBack(b[0],b[1],b[2],-1,-1,S,E),p.emplaceBack(b[0],b[1],b[2],1,-1,S,E),p.emplaceBack(b[0],b[1],b[2],1,1,S,E),p.emplaceBack(b[0],b[1],b[2],-1,1,S,E),g.emplaceBack(_+0,_+1,_+2),g.emplaceBack(_+0,_+2,_+3),_+=4}this.starsVx=i.createVertexBuffer(p,aX.members),this.starsIdx=i.createIndexBuffer(g),this.starsSegments=Bn.simpleSegment(0,0,p.length,g.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(t,i){const o=t.context,c=o.gl,u=t.transform,d=new Ge(c.LEQUAL,Ge.ReadOnly,[0,1]),p=vi(u.zoom),g=i.properties.get("color").toArray01(),_=i.properties.get("high-color").toArray01(),v=i.properties.get("space-color").toArray01PremultipliedAlpha(),b=5e-4,S=Ot((i.properties.get("horizon-blend")-0)/1*.2495+b,5e-4,.25),E=qD(t,o,u)&&S===b?u.worldSize/(2*Math.PI*1.025)-1:u.globeRadius,A=t.frameCounter/1e3%1,C=ct.length(u.globeCenterInViewSpace),P=Math.sqrt(Math.pow(C,2)-Math.pow(E,2)),k=Math.acos(P/C),L=j=>{const V=u.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];j&&V.push("ALPHA_PASS");const F=t.getOrCreateProgram("globeAtmosphere",{defines:V}),U=((Z,X,J,rt,it,ut,tt,dt,gt,xt,ht,pt)=>({u_frustum_tl:Z,u_frustum_tr:X,u_frustum_br:J,u_frustum_bl:rt,u_horizon:it,u_transition:ut,u_fadeout_range:tt,u_color:dt,u_high_color:gt,u_space_color:xt,u_temporal_offset:ht,u_horizon_angle:pt}))(u.frustumCorners.TL,u.frustumCorners.TR,u.frustumCorners.BR,u.frustumCorners.BL,u.frustumCorners.horizon,p,S,g,_,v,A,k);t.uploadCommonUniforms(o,F);const q=this.atmosphereBuffer;q&&F.draw(t,c.TRIANGLES,d,an.disabled,j?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,un.backCW,U,j?"atmosphere_glow_alpha":"atmosphere_glow",q.vertexBuffer,q.indexBuffer,q.segments)};L(!1),L(!0)}drawStars(t,i){const o=Ot(i.properties.get("star-intensity"),0,1);if(o===0)return;const c=t.context,u=c.gl,d=t.transform,p=t.getOrCreateProgram("stars"),g=Fi.identity([]);Fi.rotateX(g,g,-d._pitch),Fi.rotateZ(g,g,-d.angle),Fi.rotateX(g,g,st(d._center.lat)),Fi.rotateY(g,g,-st(d._center.lng));const _=wt.fromQuat(new Float32Array(16),g),v=wt.multiply([],d.starsProjMatrix,_),b=bs.fromMat4([],_),S=bs.invert([],b),E=[0,1,0];ct.transformMat3(E,E,S),ct.scale(E,E,.15);const A=[1,0,0];ct.transformMat3(A,A,S),ct.scale(A,A,.15);const C=((P,k,L,j)=>({u_matrix:Float32Array.from(P),u_up:k,u_right:L,u_intensity_multiplier:j}))(v,E,A,o);t.uploadCommonUniforms(c,p),this.starsVx&&this.starsIdx&&p.draw(t,u.TRIANGLES,Ge.disabled,an.disabled,this.colorModeAlphaBlendedWriteRGB,un.disabled,C,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function G3(n,t){const i=[...n],o=t.cameraWorldSizeForFog/t.worldSize,c=wt.identity([]);return wt.scale(c,c,[o,o,1]),wt.multiply(i,c,i),wt.multiply(i,t.worldToFogMatrix,i),i}function IS(n,t,i,o){const c=i.material,u=o.context,{baseColorTexture:d,metallicRoughnessTexture:p}=c.pbrMetallicRoughness,{normalTexture:g,occlusionTexture:_,emissionTexture:v}=c;function b(S,E,A){if(S&&(n.push(E),u.activeTexture.set(u.gl.TEXTURE0+A),S.gfxTexture)){const{minFilter:C,magFilter:P,wrapS:k,wrapT:L}=S.sampler;S.gfxTexture.bindExtraParam(C,P,k,L)}}b(d,"HAS_TEXTURE_u_baseColorTexture",Ns.BaseColor),b(p,"HAS_TEXTURE_u_metallicRoughnessTexture",Ns.MetallicRoughness),b(g,"HAS_TEXTURE_u_normalTexture",Ns.Normal),b(_,"HAS_TEXTURE_u_occlusionTexture",Ns.Occlusion),b(v,"HAS_TEXTURE_u_emissionTexture",Ns.Emission),i.texcoordBuffer&&(n.push("HAS_ATTRIBUTE_a_uv_2f"),t.push(i.texcoordBuffer)),i.colorBuffer&&(n.push(i.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),t.push(i.colorBuffer)),i.normalBuffer&&(n.push("HAS_ATTRIBUTE_a_normal_3f"),t.push(i.normalBuffer)),i.pbrBuffer&&(n.push("HAS_ATTRIBUTE_a_pbr"),n.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),t.push(i.pbrBuffer)),c.alphaMode!=="OPAQUE"&&c.alphaMode!=="MASK"||n.push("UNPREMULT_TEXTURE_IN_SHADER"),c.defined||n.push("DIFFUSE_SHADED"),n.push("USE_STANDARD_DERIVATIVES")}function zy(n,t,i,o,c,u){const d=i.paint.get("model-opacity"),p=t.context,g=new Ge(t.context.gl.LEQUAL,Ge.ReadWrite,t.depthRangeFor3D),_=t.transform,v=n.mesh,b=v.material,S=b.pbrMetallicRoughness,E=t.style.fog;let A;A=t.transform.projection.zAxisUnit==="pixels"?[...n.nodeModelMatrix]:wt.multiply([],o.zScaleMatrix,n.nodeModelMatrix),wt.multiply(A,o.negCameraPosMatrix,A);const C=wt.invert([],A);wt.transpose(C,C);const P=i.paint.get("model-emissive-strength").constantOr(0),k=CS(new Float32Array(n.worldViewProjection),new Float32Array(A),new Float32Array(C),t,d,S.baseColorFactor,b.emissiveFactor,S.metallicFactor,S.roughnessFactor,b,P,i),L={defines:[]},j=[];IS(L.defines,j,v,t);const V=t.shadowRenderer;V&&(V.useNormalOffset=!1);let F=null;if(E){const Z=G3(n.nodeModelMatrix,t.transform);if(F=new Float32Array(Z),_.projection.name!=="globe"){const X=v.aabb.min,J=v.aabb.max,[rt,it]=E.getOpacityForBounds(Z,X[0],X[1],J[0],J[1]);L.overrideFog=rt>=$u||it>=$u}}const U=Cd(t,i.paint.get("model-cutoff-fade-range"));U.shouldRenderCutoff&&L.defines.push("RENDER_CUTOFF");const q=t.getOrCreateProgram("model",L);t.uploadCommonUniforms(p,q,null,F,U),t.renderPass!=="shadow"&&V&&V.setupShadowsFromMatrix(n.nodeModelMatrix,q),q.draw(t,p.gl.TRIANGLES,g,c,u,v.material.doubleSided?un.disabled:un.backCCW,k,i.id,v.vertexBuffer,v.indexBuffer,v.segments,i.paint,t.transform.zoom,void 0,j)}function W3(n,t,i,o,c,u,d){let p;p=n.projection.name==="globe"?FO(i,n):[...i],wt.multiply(p,p,t.matrix);const g=wt.multiply([],o,p);if(t.meshes)for(const _ of t.meshes){if(_.material.alphaMode!=="BLEND"){d.push({mesh:_,depth:0,modelIndex:c,worldViewProjection:g,nodeModelMatrix:p});continue}const v=ct.transformMat4([],_.centroid,g);v[2]>0&&u.push({mesh:_,depth:v[2],modelIndex:c,worldViewProjection:g,nodeModelMatrix:p})}if(t.children)for(const _ of t.children)W3(n,_,i,o,c,u,d)}function kS(n,t,i,o){const c=i.shadowRenderer;if(!c)return;const u=c.getShadowPassDepthMode(),d=c.getShadowPassColorMode(),p=c.calculateShadowPassMatrixFromMatrix(t),g=z3(p);i.getOrCreateProgram("modelDepth",{defines:["DEPTH_TEXTURE"]}).draw(i,i.context.gl.TRIANGLES,u,an.disabled,d,un.backCCW,g,o.id,n.vertexBuffer,n.indexBuffer,n.segments,o.paint,i.transform.zoom,void 0,void 0)}function cX(n,t,i){const o=t.updateZoomBasedPaintProperties(),c=function(u,d,p){let g,_,v,b=u.terrain?u.terrain.exaggeration():0;if(u.terrain&&b>0){const S=u.terrain,E=S.findDEMTileFor(p);E&&E.dem?g=_d.create(S,p,E):b=0}if(b===0&&(d.terrainElevationMin=0,d.terrainElevationMax=0),b===d.validForExaggeration&&(b===0||g&&g._demTile&&g._demTile.tileID===d.validForDEMTile.id&&g._dem._timestamp===d.validForDEMTile.timestamp))return!1;for(const S in d.instancesPerModel){const E=d.instancesPerModel[S];for(let A=0;A<E.instancedDataArray.length;++A){const C=(g?b*g.getElevationAt(0|E.instancedDataArray.float32[16*A],0|E.instancedDataArray.float32[16*A+1],!0,!0):0)+E.instancesEvaluatedElevation[A];E.instancedDataArray.float32[16*A+6]=C,_=_?Math.min(d.terrainElevationMin,C):C,v=v?Math.max(d.terrainElevationMax,C):C}}return d.terrainElevationMin=_||0,d.terrainElevationMax=v||0,d.validForExaggeration=b,d.validForDEMTile=g&&g._demTile?{id:g._demTile.tileID,timestamp:g._dem._timestamp}:{id:void 0,timestamp:0},!0}(n,t,i);(o||c)&&(t.uploaded=!1,t.upload(n.context))}const Ra={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new nr([0,0,0],[Dt,Dt,0])};function uX(n,t){const i=1<<n.canonical.z,o=t.getFreeCameraOptions().position,c=t.elevation,u=n.canonical.x/i,d=(n.canonical.x+1)/i,p=n.canonical.y/i,g=(n.canonical.y+1)/i;let _=t._centerAltitude;if(c){const E=c.getMinMaxForTile(n);E&&E.max>_&&(_=E.max)}const v=Ot(o.x,u,d)-o.x,b=Ot(o.y,p,g)-o.y,S=$n(_,t.center.lat)-o.z;return t._zoomFromMercatorZ(Math.sqrt(v*v+b*b+S*S))}function H3(n,t,i,o,c,u,d){const p=n.context,g=n.renderPass==="shadow",_=n.shadowRenderer,v=g&&_?_.getShadowPassDepthMode():new Ge(p.gl.LEQUAL,Ge.ReadWrite,n.depthRangeFor3D),b=n.isTileAffectedByFog(u);if(i.meshes)for(const S of i.meshes){const E=["MODEL_POSITION_ON_GPU"],A=[];let C,P,k;o.instancedDataArray.length>20&&E.push("INSTANCED_ARRAYS");const L=Cd(n,t.paint.get("model-cutoff-fade-range"));if(L.shouldRenderCutoff&&E.push("RENDER_CUTOFF"),g&&_)C=n.getOrCreateProgram("modelDepth",{defines:E}),P=z3(d.shadowTileMatrix,d.shadowTileMatrix,Float32Array.from(i.matrix)),k=_.getShadowPassColorMode();else{IS(E,A,S,n),C=n.getOrCreateProgram("model",{defines:E,overrideFog:b});const V=S.material,F=V.pbrMetallicRoughness,U=t.paint.get("model-opacity"),q=t.paint.get("model-emissive-strength").constantOr(0);P=CS(u.expandedProjMatrix,Float32Array.from(i.matrix),new Float32Array(16),n,U,F.baseColorFactor,V.emissiveFactor,F.metallicFactor,F.roughnessFactor,V,q,t,c),_&&(d.shadowUniformsInitialized?C.setShadowUniformValues(p,_.getShadowUniformValues()):(_.setupShadows(u.toUnwrapped(),C,"model-tile",u.overscaledZ),d.shadowUniformsInitialized=!0)),k=L.shouldRenderCutoff||U<1||V.alphaMode!=="OPAQUE"?Cn.alphaBlended:Cn.unblended}n.uploadCommonUniforms(p,C,u.toUnwrapped(),null,L);const j=S.material.doubleSided?un.disabled:un.backCCW;if(o.instancedDataArray.length>20)A.push(o.instancedDataBuffer),C.draw(n,p.gl.TRIANGLES,v,an.disabled,k,j,P,t.id,S.vertexBuffer,S.indexBuffer,S.segments,t.paint,n.transform.zoom,void 0,A,o.instancedDataArray.length);else{const V=g?"u_instance":"u_normal_matrix";for(let F=0;F<o.instancedDataArray.length;++F)P[V]=new Float32Array(o.instancedDataArray.arrayBuffer,64*F,16),C.draw(n,p.gl.TRIANGLES,v,an.disabled,k,j,P,t.id,S.vertexBuffer,S.indexBuffer,S.segments,t.paint,n.transform.zoom,void 0,A)}}if(i.children)for(const S of i.children)H3(n,t,S,o,c,u,d)}const hX=[1,-1,1];function dX(n,t,i,o){if(!i.modelManager)return!0;const c=i.modelManager;if(!i.shadowRenderer)return!0;const u=i.shadowRenderer,d=t.aabb;let p=!0,g=n.maxHeight;if(g===0){let v=0;for(const b in n.instancesPerModel){const S=c.getModel(b,o);S?v=Math.max(v,Math.max(Math.max(S.aabb.max[0],S.aabb.max[1]),S.aabb.max[2])):p=!1}g=n.maxScale*v*1.41+n.maxVerticalOffset,p&&(n.maxHeight=g)}d.max[2]=g,d.min[2]+=n.terrainElevationMin,d.max[2]+=n.terrainElevationMax,ct.transformMat4(d.min,d.min,t.tileMatrix),ct.transformMat4(d.max,d.max,t.tileMatrix);const _=d.intersects(u.getCurrentCascadeFrustum());return i.currentShadowCascade===0&&(n.isInsideFirstShadowMapFrustum=_===2),_===0}class fX{}class pX{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(t,i,o){{const b=this._storage.get(i.id);if(b)return b.lastUsedFrameIdx=t,b.buf}const c=o.gl,u=c.getBufferParameter(c.ELEMENT_ARRAY_BUFFER,c.BUFFER_SIZE),d=new ArrayBuffer(u),p=new Int16Array(d);c.getBufferSubData(c.ELEMENT_ARRAY_BUFFER,0,new Int16Array(d));const g=new sc;for(let b=0;b<u/2;b+=3){const S=p[b],E=p[b+1],A=p[b+2];g.emplaceBack(S,E),g.emplaceBack(E,A),g.emplaceBack(A,S)}const _=o.bindVertexArrayOES.current,v=new fX;return v.buf=new wc(o,g),v.lastUsedFrameIdx=t,this._storage.set(i.id,v),o.bindVertexArrayOES.set(_),v.buf}update(t){for(const[i,o]of this._storage)t-o.lastUsedFrameIdx>30&&(o.buf.destroy(),this._storage.delete(i))}destroy(){for(const[t,i]of this._storage)i.buf.destroy(),this._storage.delete(t)}}const q3={symbol:function(n,t,i,o,c){if(n.renderPass!=="translucent")return;const u=an.disabled,d=n.colorModeForRenderPass();i.layout.get("text-variable-anchor")&&function(p,g,_,v,b,S,E){const A=g.transform,C=b==="map",P=S==="map";for(const k of p){const L=v.getTile(k),j=L.getBucket(_);if(!j||!j.text||!j.text.segments.get().length)continue;const V=Ca(j.textSizeData,A.zoom),F=bS(k,j.getProjection(),A),U=A.calculatePixelsToTileUnitsMatrix(L),q=fy(F,L.tileID.canonical,P,C,A,j.getProjection(),U),Z=j.hasIconTextFit()&&j.hasIconData();if(V){const X=Math.pow(2,A.zoom-L.tileID.overscaledZ);$Z(j,C,P,E,hW,A,q,k,X,V,Z)}}}(o,n,i,t,i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),c),i.paint.get("icon-opacity").constantOr(1)!==0&&B3(n,t,i,o,!1,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),i.layout.get("icon-rotation-alignment"),i.layout.get("icon-pitch-alignment"),i.layout.get("icon-keep-upright"),i.paint.get("icon-color-saturation"),u,d),i.paint.get("text-opacity").constantOr(1)!==0&&B3(n,t,i,o,!0,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),i.layout.get("text-keep-upright"),i.paint.get("icon-color-saturation"),u,d),t.map.showCollisionBoxes&&(N3(n,t,i,o,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),!0),N3(n,t,i,o,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),!1))},circle:function(n,t,i,o){if(n.renderPass!=="translucent")return;const c=i.paint.get("circle-opacity"),u=i.paint.get("circle-stroke-width"),d=i.paint.get("circle-stroke-opacity"),p=i.layout.get("circle-sort-key").constantOr(1)!==void 0,g=i.paint.get("circle-emissive-strength");if(c.constantOr(1)===0&&(u.constantOr(1)===0||d.constantOr(1)===0))return;const _=n.context,v=_.gl,b=n.transform,S=n.depthModeForSublayer(0,Ge.ReadOnly),E=an.disabled,A=n.colorModeForDrapableLayerRenderPass(g),C=b.projection.name==="globe",P=[ti(b.center.lng),ui(b.center.lat)],k=[];for(let j=0;j<o.length;j++){const V=o[j],F=t.getTile(V),U=F.getBucket(i);if(!U||U.projection.name!==b.projection.name)continue;const q=U.programConfigurations.get(i.id),Z=cR(i),X=n.isTileAffectedByFog(V);C&&Z.push("PROJECTION_GLOBE_VIEW");const J=n.getOrCreateProgram("circle",{config:q,defines:Z,overrideFog:X}),rt=U.layoutVertexBuffer,it=U.globeExtVertexBuffer,ut=U.indexBuffer,tt=b.projection.createInversionMatrix(b,V.canonical),dt={programConfiguration:q,program:J,layoutVertexBuffer:rt,globeExtVertexBuffer:it,indexBuffer:ut,uniformValues:sG(n,V,F,tt,P,i),tile:F};if(p){const gt=U.segments.get();for(const xt of gt)k.push({segments:new Bn([xt]),sortKey:xt.sortKey,state:dt})}else k.push({segments:U.segments,sortKey:0,state:dt})}p&&k.sort((j,V)=>j.sortKey-V.sortKey);const L={useDepthForOcclusion:b.depthOcclusionForSymbolsAndCircles};for(const j of k){const{programConfiguration:V,program:F,layoutVertexBuffer:U,globeExtVertexBuffer:q,indexBuffer:Z,uniformValues:X,tile:J}=j.state,rt=j.segments;n.terrain&&n.terrain.setupElevationDraw(J,F,L),n.uploadCommonUniforms(_,F,J.tileID.toUnwrapped()),F.draw(n,v.TRIANGLES,S,E,A,un.disabled,X,i.id,U,Z,rt,i.paint,b.zoom,V,[q])}},heatmap:function(n,t,i,o){if(i.paint.get("heatmap-opacity")!==0)if(n.renderPass==="offscreen"){const c=n.context,u=c.gl,d=an.disabled,p=new Cn([u.ONE,u.ONE,u.ONE,u.ONE],tn.transparent,[!0,!0,!0,!0]);(function(E,A,C,P){const k=E.gl,L=A.width*P,j=A.height*P;E.activeTexture.set(k.TEXTURE1),E.viewport.set([0,0,L,j]);let V=C.heatmapFbo;if(!V||V&&(V.width!==L||V.height!==j)){V&&V.destroy();const F=k.createTexture();k.bindTexture(k.TEXTURE_2D,F),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_S,k.CLAMP_TO_EDGE),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_T,k.CLAMP_TO_EDGE),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MIN_FILTER,k.LINEAR),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MAG_FILTER,k.LINEAR),V=C.heatmapFbo=E.createFramebuffer(L,j,!0,null),function(U,q,Z,X,J,rt){const it=U.gl;it.texImage2D(it.TEXTURE_2D,0,U.extRenderToTextureHalfFloat?it.RGBA16F:it.RGBA,J,rt,0,it.RGBA,U.extRenderToTextureHalfFloat?it.HALF_FLOAT:it.UNSIGNED_BYTE,null),X.colorAttachment.set(Z)}(E,0,F,V,L,j)}else k.bindTexture(k.TEXTURE_2D,V.colorAttachment.get()),E.bindFramebuffer.set(V.framebuffer)})(c,n,i,n.transform.projection.name==="globe"?.5:.25),c.clear({color:tn.transparent});const g=n.transform,_=g.projection.name==="globe",v=_?["PROJECTION_GLOBE_VIEW"]:[],b=_?un.frontCCW:un.disabled,S=[ti(g.center.lng),ui(g.center.lat)];for(let E=0;E<o.length;E++){const A=o[E];if(t.hasRenderableParent(A))continue;const C=t.getTile(A),P=C.getBucket(i);if(!P||P.projection.name!==g.projection.name)continue;const k=n.isTileAffectedByFog(A),L=P.programConfigurations.get(i.id),j=n.getOrCreateProgram("heatmap",{config:L,defines:v,overrideFog:k}),{zoom:V}=n.transform;n.terrain&&n.terrain.setupElevationDraw(C,j),n.uploadCommonUniforms(c,j,A.toUnwrapped());const F=g.projection.createInversionMatrix(g,A.canonical);j.draw(n,u.TRIANGLES,Ge.disabled,d,p,b,OZ(n,A,C,F,S,V,i.paint.get("heatmap-intensity")),i.id,P.layoutVertexBuffer,P.indexBuffer,P.segments,i.paint,n.transform.zoom,L,_?[P.globeExtVertexBuffer]:null)}c.viewport.set([0,0,n.width,n.height])}else n.renderPass==="translucent"&&(n.context.setColorMode(n.colorModeForRenderPass()),function(c,u){const d=c.context,p=d.gl,g=u.heatmapFbo;if(!g)return;d.activeTexture.set(p.TEXTURE0),p.bindTexture(p.TEXTURE_2D,g.colorAttachment.get()),d.activeTexture.set(p.TEXTURE1);let _=u.colorRampTexture;_||(_=u.colorRampTexture=new _r(d,u.colorRamp,p.RGBA)),_.bind(p.LINEAR,p.CLAMP_TO_EDGE),c.getOrCreateProgram("heatmapTexture").draw(c,p.TRIANGLES,Ge.disabled,an.disabled,c.colorModeForRenderPass(),un.disabled,((v,b,S,E)=>({u_image:0,u_color_ramp:1,u_opacity:b.paint.get("heatmap-opacity")}))(0,u),u.id,c.viewportBuffer,c.quadTriangleIndexBuffer,c.viewportSegments,u.paint,c.transform.zoom)}(n,i))},line:function(n,t,i,o){if(n.renderPass!=="translucent")return;const c=i.paint.get("line-opacity"),u=i.paint.get("line-width");if(c.constantOr(1)===0||u.constantOr(1)===0)return;const d=i.paint.get("line-emissive-strength"),p=n.depthModeForSublayer(0,Ge.ReadOnly),g=n.colorModeForDrapableLayerRenderPass(d),_=n.terrain&&n.terrain.renderingToTexture?1:Be.devicePixelRatio,v=i.paint.get("line-dasharray"),b=v.constantOr(1),S=i.layout.get("line-cap"),E=i.paint.get("line-pattern"),A=E.constantOr(1),C=i.paint.get("line-pattern").constantOr(1),P=i.paint.get("line-opacity").constantOr(1)!==1;let k=!C&&P;const L=i.paint.get("line-gradient"),j=A?"linePattern":"line",V=n.context,F=V.gl,U=gL(i);n.terrain&&n.terrain.clipOrMaskOverlapStencilType()&&(k=!1);for(const q of o){const Z=t.getTile(q);if(A&&!Z.patternsLoaded())continue;const X=Z.getBucket(i);if(!X)continue;n.prepareDrawTile();const J=X.programConfigurations.get(i.id),rt=n.isTileAffectedByFog(q),it=n.getOrCreateProgram(j,{config:J,defines:U,overrideFog:rt}),ut=E.constantOr(null);if(ut&&Z.imageAtlas){const At=Z.imageAtlas.patternPositions[ut.toString()];At&&J.setConstantPatternPositions(At)}const tt=v.constantOr(null),dt=S.constantOr(null);if(!A&&tt&&dt&&Z.lineAtlas){const At=Z.lineAtlas.getDash(tt,dt);At&&J.setConstantPatternPositions(At)}let[gt,xt]=i.paint.get("line-trim-offset");(dt==="round"||dt==="square")&&gt!==xt&&(gt===0&&(gt-=1),xt===1&&(xt+=1));const ht=n.terrain?q.projMatrix:null,pt=A?uq(n,Z,i,ht,_):cq(n,Z,i,ht,X.lineClipsArray.length,_,[gt,xt]);if(L){const At=X.gradients[i.id];let Mt=At.texture;if(i.gradientVersion!==At.version){let Lt=256;if(i.stepInterpolant){const Nt=t.getSource().maxzoom,jt=q.canonical.z===Nt?Math.ceil(1<<n.transform.maxZoom-q.canonical.z):1;Lt=Ot(Qe(X.maxLineLength/Dt*1024*jt),256,V.maxTextureSize)}At.gradient=R_({expression:i.gradientExpression(),evaluationKey:"lineProgress",resolution:Lt,image:At.gradient||void 0,clips:X.lineClipsArray}),At.texture?At.texture.update(At.gradient):At.texture=new _r(V,At.gradient,F.RGBA),At.version=i.gradientVersion,Mt=At.texture}V.activeTexture.set(F.TEXTURE1),Mt.bind(i.stepInterpolant?F.NEAREST:F.LINEAR,F.CLAMP_TO_EDGE)}b&&(V.activeTexture.set(F.TEXTURE0),Z.lineAtlasTexture&&Z.lineAtlasTexture.bind(F.LINEAR,F.REPEAT),J.updatePaintBuffers()),A&&(V.activeTexture.set(F.TEXTURE0),Z.imageAtlasTexture&&Z.imageAtlasTexture.bind(F.LINEAR,F.CLAMP_TO_EDGE),J.updatePaintBuffers()),n.uploadCommonUniforms(V,it,q.toUnwrapped());const Et=At=>{it.draw(n,F.TRIANGLES,p,At,g,un.disabled,pt,i.id,X.layoutVertexBuffer,X.indexBuffer,X.segments,i.paint,n.transform.zoom,J,[X.layoutVertexBuffer2])};if(k){const At=n.stencilModeForClipping(q).ref;At===0&&n.terrain&&V.clear({stencil:0});const Mt={func:F.EQUAL,mask:255};pt.u_alpha_discard_threshold=.8,Et(new an(Mt,At,255,F.KEEP,F.KEEP,F.INVERT)),pt.u_alpha_discard_threshold=0,Et(new an(Mt,At,255,F.KEEP,F.KEEP,F.KEEP))}else Et(n.stencilModeForClipping(q))}k&&(n.resetStencilClippingMasks(),n.terrain&&V.clear({stencil:0}))},fill:function(n,t,i,o){const c=i.paint.get("fill-color"),u=i.paint.get("fill-opacity");if(u.constantOr(1)===0)return;const d=i.paint.get("fill-emissive-strength"),p=n.colorModeForDrapableLayerRenderPass(d),g=i.paint.get("fill-pattern"),_=n.opaquePassEnabledForLayer()&&!g.constantOr(1)&&c.constantOr(tn.transparent).a===1&&u.constantOr(0)===1?"opaque":"translucent";if(n.renderPass===_){const v=n.depthModeForSublayer(1,n.renderPass==="opaque"?Ge.ReadWrite:Ge.ReadOnly);j3(n,t,i,o,v,p,!1)}if(n.renderPass==="translucent"&&i.paint.get("fill-antialias")){const v=n.depthModeForSublayer(i.getPaintProperty("fill-outline-color")?2:0,Ge.ReadOnly);j3(n,t,i,o,v,p,!0)}},"fill-extrusion":function(n,t,i,o){const c=i.paint.get("fill-extrusion-opacity"),u=n.context,d=u.gl,p=n.terrain,g=p&&p.renderingToTexture,_=i.paint.get("fill-extrusion-cutoff-fade-range");if(c===0)return;const v=n.conflationActive&&n.layerUsedInConflation(i,t.getSource());if(v&&function(b,S,E,A){for(const C of A){const P=S.getTile(C).getBucket(E);P&&(P.updateReplacement(C,b.replacementSource),P.uploadCentroid(b.context))}}(n,t,i,o),p||v)for(const b of o){const S=t.getTile(b).getBucket(i);S&&WZ(n.context,t,b,S,i,p,v)}if(n.renderPass==="shadow"&&n.shadowRenderer){const b=n.shadowRenderer;if(p&&c<.65&&i._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof ec)return;const S=b.getShadowPassDepthMode(),E=b.getShadowPassColorMode();Oy(n,t,i,o,S,an.disabled,E,v)}else if(n.renderPass==="translucent"){const b=!i.paint.get("fill-extrusion-pattern").constantOr(1);if(!g){const S=new Ge(n.context.gl.LEQUAL,Ge.ReadWrite,n.depthRangeFor3D);_===0&&c===1&&b?Oy(n,t,i,o,S,an.disabled,Cn.unblended,v):(Oy(n,t,i,o,S,an.disabled,Cn.disabled,v),Oy(n,t,i,o,S,n.stencilModeFor3D(),n.colorModeForRenderPass(),v),n.resetStencilClippingMasks())}if(n.style.enable3dLights()&&b&&(!p&&n.transform.projection.name!=="globe"||g)){const S=i.paint.get("fill-extrusion-opacity"),E=i.paint.get("fill-extrusion-ambient-occlusion-intensity"),A=i.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),C=i.paint.get("fill-extrusion-flood-light-intensity"),P=i.paint.get("fill-extrusion-flood-light-color").toArray01().slice(0,3),k=E>0&&A>0,L=C>0,j=(F,U,q)=>(1-q)*F+q*U,V=F=>{const U=n.depthModeForSublayer(1,Ge.ReadOnly,d.LEQUAL,!0),q=i.paint.get(F?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),Z=j(.1,3,q),X=n._showOverdrawInspector;if(!X){const J=new an({func:d.ALWAYS,mask:255},255,255,d.KEEP,d.KEEP,d.REPLACE),rt=new Cn([d.ONE,d.ONE,d.ONE,d.ONE],tn.transparent,[!1,!1,!1,!0],d.MIN);Id(n,t,i,o,U,J,rt,un.disabled,F,"sdf",S,E,A,C,P,Z,v,!1)}{const J=X?an.disabled:new an({func:d.EQUAL,mask:255},255,255,d.KEEP,d.DECR,d.DECR),rt=X?n.colorModeForRenderPass():new Cn([d.ONE_MINUS_DST_ALPHA,d.DST_ALPHA,d.ONE,d.ONE],tn.transparent,[!0,!0,!0,!0]);Id(n,t,i,o,U,J,rt,un.disabled,F,"color",S,E,A,C,P,Z,v,!1)}};if(g){const F=(U,q,Z)=>{const X=n.depthModeForSublayer(1,Ge.ReadOnly,d.LEQUAL,!1),J=i.paint.get(U?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),rt=j(.1,3,J);{const it=new Cn([d.ONE,d.ONE,d.ONE,d.ONE],tn.transparent,[!1,!1,!1,!0]);Id(n,t,i,o,X,an.disabled,it,un.disabled,U,"clear",S,E,A,C,P,rt,v,q)}{const it=new an({func:d.ALWAYS,mask:255},255,255,d.KEEP,d.KEEP,d.REPLACE),ut=new Cn([d.ONE,d.ONE,d.ONE,d.ONE],tn.transparent,[!1,!1,!1,!0],d.MIN);Id(n,t,i,o,X,it,ut,un.disabled,U,"sdf",S,E,A,C,P,rt,v,q)}{const it=U?d.ZERO:d.ONE_MINUS_DST_ALPHA,ut=new an({func:d.EQUAL,mask:255},255,255,d.KEEP,d.DECR,d.DECR),tt=new Cn([it,d.DST_ALPHA,d.ONE_MINUS_DST_ALPHA,d.ZERO],tn.transparent,[!0,!0,!0,!0]);Id(n,t,i,o,X,ut,tt,un.disabled,U,"color",S,E,A,C,P,rt,v,q)}{const it=new Cn([d.ONE,d.ONE,d.ONE,U?d.ZERO:d.ONE],tn.transparent,[!1,!1,!1,!0],U?d.FUNC_ADD:d.MAX);Id(n,t,i,o,X,an.disabled,it,un.disabled,U,"clear",S,E,A,C,P,rt,v,q,Z)}};if(k||L){let U;if(n.prepareDrawTile(),p){const q=p.drapeBufferSize[0],Z=p.drapeBufferSize[1];U=p.framebufferCopyTexture,U&&(!U||U.size[0]===q&&U.size[1]===Z)||(U&&U.destroy(),U=p.framebufferCopyTexture=new _r(u,new Fr({width:q,height:Z}),d.RGBA)),U.bind(d.LINEAR,d.CLAMP_TO_EDGE),d.copyTexImage2D(d.TEXTURE_2D,0,d.RGBA,0,0,q,Z,0)}k&&F(!0,!1,U),L&&F(!1,!0,U)}}else k&&V(!0),L&&V(!1)}}},hillshade:function(n,t,i,o){if(n.renderPass!=="offscreen"&&n.renderPass!=="translucent"||n.style.disableElevatedTerrain)return;const c=n.context,u=n.terrain&&n.terrain.renderingToTexture,[d,p]=n.renderPass!=="translucent"||u?[{},o]:n.stencilConfigForOverlap(o);for(const g of p){const _=t.getTile(g);if(_.needsHillshadePrepare&&n.renderPass==="offscreen")vZ(n,_,i);else if(n.renderPass==="translucent"){const v=n.depthModeForSublayer(0,Ge.ReadOnly),b=i.paint.get("hillshade-emissive-strength"),S=n.colorModeForDrapableLayerRenderPass(b),E=u&&n.terrain?n.terrain.stencilModeForRTTOverlap(g):d[g.overscaledZ];yZ(n,g,_,i,v,E,S)}}c.viewport.set([0,0,n.width,n.height]),n.resetStencilClippingMasks()},raster:function(n,t,i,o,c,u){if(n.renderPass!=="translucent"||i.paint.get("raster-opacity")===0)return;const d=n.context,p=d.gl,g=t.getSource(),_=function(q,Z,X){const J=q.paint.get("raster-color"),rt=[],it=q.paint.get("raster-resampling"),ut=q.paint.get("raster-color-mix"),tt=q.paint.get("raster-color-range"),dt=[ut[0],ut[1],ut[2],0],gt=ut[3],xt=it==="nearest"?X.NEAREST:X.LINEAR;if(J&&rt.push("RASTER_COLOR"),J){Z.activeTexture.set(X.TEXTURE2);let ht=q.colorRampTexture;ht||(ht=q.colorRampTexture=new _r(Z,q.colorRamp,X.RGBA)),ht.bind(X.LINEAR,X.CLAMP_TO_EDGE)}return{mix:dt,range:tt,offset:gt,defines:rt,resampling:xt}}(i,d,p),v=_.defines,b=n.transform.projection.name==="globe";let S=!1;if(g instanceof Io&&!o.length){if(!b)return;if(g.onNorthPole)S=!0,v.push("GLOBE_POLES");else{if(!g.onSouthPole)return;S=!0,v.push("GLOBE_POLES")}}const E=i.paint.get("raster-emissive-strength"),A=n.colorModeForDrapableLayerRenderPass(E),C=n.terrain&&n.terrain.renderingToTexture,P=g instanceof Io&&i.paint.get("raster-elevation")!==0,k=!n.options.moving,L=i.paint.get("raster-resampling")==="nearest"?p.NEAREST:p.LINEAR;if(S){const q=t.getSource();if(!(q instanceof Io))return;const Z=q.texture;if(!Z)return;const X=n.globeSharedBuffers;if(!X)return;const J=new Ge(p.LEQUAL,Ge.ReadWrite,n.depthRangeFor3D),rt=Float32Array.from(n.transform.expandedFarZProjMatrix);let it=HD(0,0,n.transform);const ut=Float32Array.from(hc(no(new Mo(0,0,0)))),tt={opacity:1,mix:0};n.terrain&&n.terrain.prepareDrawTile(),d.activeTexture.set(p.TEXTURE0),Z.bind(L,p.CLAMP_TO_EDGE),d.activeTexture.set(p.TEXTURE1),Z.bind(L,p.CLAMP_TO_EDGE),Z.useMipmap&&d.extTextureFilterAnisotropic&&n.transform.pitch>20&&p.texParameterf(p.TEXTURE_2D,d.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,d.extTextureFilterAnisotropicMax);const[dt,gt,xt,ht]=X.getPoleBuffers(0,!0);let pt;q.onNorthPole?(pt=dt,n.renderDefaultNorthPole=!1):(it=wt.scale(wt.create(),it,[1,-1,1]),pt=gt,n.renderDefaultSouthPole=!1);const Et=((Mt,Lt,Nt,jt,It,Gt,ce,ue,ye,be,We,Pe)=>k3(Mt,Lt,Nt,new Float32Array(16),new Float32Array(9),[0,0],[0,0,0,0],0,[0,0],[0,0,0,0],1,jt,It,Gt||[0,0],ce,2,ye,be,We,1,0,Pe))(rt,ut,it,tt,i,q.perspectiveTransform||[0,0],i.paint.get("raster-elevation"),0,_.mix,_.offset,_.range,E),At=n.getOrCreateProgram("raster",{defines:_.defines});return n.uploadCommonUniforms(d,At,null),void At.draw(n,p.TRIANGLES,J,an.disabled,A,un.disabled,Et,i.id,pt,xt,ht)}if(!o.length)return;const[j,V]=g instanceof Io||C?[{},o]:n.stencilConfigForOverlap(o),F=V[V.length-1].overscaledZ,U=P&&b;U&&_.defines.push("PROJECTION_GLOBE_VIEW"),P&&_.defines.push("RENDER_CUTOFF");for(const q of V){const Z=q.toUnwrapped(),X=t.getTile(q);if(C&&(!X||!X.hasData())||!X.texture)continue;let J,rt;C?(J=Ge.disabled,rt=q.projMatrix):P?(J=new Ge(p.LEQUAL,Ge.ReadWrite,n.depthRangeFor3D),rt=b?Float32Array.from(n.transform.expandedFarZProjMatrix):n.transform.calculateProjMatrix(Z,k)):(J=n.depthModeForSublayer(q.overscaledZ-F,i.paint.get("raster-opacity")===1?Ge.ReadWrite:Ge.ReadOnly,p.LESS),rt=n.transform.calculateProjMatrix(Z,k));const it=n.terrain&&C?n.terrain.stencilModeForRTTOverlap(q):j[q.overscaledZ],ut=u?0:i.paint.get("raster-fade-duration");X.registerFadeDuration(ut);const tt=t.findLoadedParent(q,0),dt=S3(X,tt,t,n.transform,ut);let gt,xt;n.terrain&&n.terrain.prepareDrawTile(),d.activeTexture.set(p.TEXTURE0),X.texture&&X.texture.bind(L,p.CLAMP_TO_EDGE),d.activeTexture.set(p.TEXTURE1),tt?(tt.texture&&tt.texture.bind(L,p.CLAMP_TO_EDGE),gt=Math.pow(2,tt.tileID.overscaledZ-X.tileID.overscaledZ),xt=[X.tileID.canonical.x*gt%1,X.tileID.canonical.y*gt%1]):X.texture&&X.texture.bind(L,p.CLAMP_TO_EDGE),X.texture&&X.texture.useMipmap&&d.extTextureFilterAnisotropic&&n.transform.pitch>20&&p.texParameterf(p.TEXTURE_2D,d.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,d.extTextureFilterAnisotropicMax);const ht=n.transform,pt=g instanceof Io?g.perspectiveTransform:[0,0],Et=P?YZ(ht):[0,0,0,0];let At,Mt,Lt,Nt,jt,It;if(U&&g instanceof Io&&g.coordinates.length>3){At=Float32Array.from(hc(no(new Mo(0,0,0)))),Mt=Float32Array.from(ht.globeMatrix),Lt=Float32Array.from(WD(ht)),Nt=[ti(ht.center.lng),ui(ht.center.lat)],It=[ti(g.coordinates[1][0]),ui(g.coordinates[1][1]),ti(g.coordinates[3][0]),ui(g.coordinates[3][1])];const ye=new Os(g.coordinates[1],g.coordinates[3]);jt=Float32Array.from(ZD(new Mo(0,0,0),ye,0,ht.worldSize/n.transform._pixelsPerMercatorPixel))}else At=new Float32Array(16),Mt=new Float32Array(9),Lt=new Float32Array(16),Nt=[0,0],jt=new Float32Array(16),It=[0,0,0,0];const Gt=k3(rt,At,Mt,Lt,jt,xt||[0,0],It,vi(n.transform.zoom),Nt,Et,gt||1,dt,i,pt,P?i.paint.get("raster-elevation"):0,2,_.mix,_.offset,_.range,1,0,E),ce=n.isTileAffectedByFog(q),ue=n.getOrCreateProgram("raster",{defines:_.defines,overrideFog:ce});if(n.uploadCommonUniforms(d,ue,Z),g instanceof Io){if(C||!b)g.boundsBuffer&&g.boundsSegments&&ue.draw(n,p.TRIANGLES,J,an.disabled,A,un.disabled,Gt,i.id,g.boundsBuffer,n.quadTriangleIndexBuffer,g.boundsSegments);else if(n.globeSharedBuffers){const[ye,be,We]=n.globeSharedBuffers.getGridBuffers(0,!1);ue.draw(n,p.TRIANGLES,J,an.disabled,A,un.frontCCW,Gt,i.id,ye,be,We),ue.draw(n,p.TRIANGLES,J,an.disabled,A,un.backCCW,Gt,i.id,ye,be,We)}}else{const{tileBoundsBuffer:ye,tileBoundsIndexBuffer:be,tileBoundsSegments:We}=n.getTileBoundsBuffers(X);ue.draw(n,p.TRIANGLES,J,it,A,un.disabled,Gt,i.id,ye,be,We)}}n.resetStencilClippingMasks()},background:function(n,t,i,o){const c=i.paint.get("background-color"),u=i.paint.get("background-opacity"),d=i.paint.get("background-emissive-strength");if(u===0)return;const p=n.context,g=p.gl,_=n.transform,v=_.tileSize,b=i.paint.get("background-pattern");if(n.isPatternMissing(b,i.scope))return;const S=!b&&c.a===1&&u===1&&n.opaquePassEnabledForLayer()?"opaque":"translucent";if(n.renderPass!==S)return;const E=an.disabled,A=n.depthModeForSublayer(0,S==="opaque"?Ge.ReadWrite:Ge.ReadOnly),C=n.colorModeForDrapableLayerRenderPass(d),P=b?"backgroundPattern":"background";let k,L=o;L||(k=n.getBackgroundTiles(),L=Object.values(k).map(j=>j.tileID)),b&&(p.activeTexture.set(g.TEXTURE0),n.imageManager.bind(n.context,i.scope));for(const j of L){const V=n.isTileAffectedByFog(j),F=n.getOrCreateProgram(P,{overrideFog:V}),U=j.toUnwrapped(),q=o?j.projMatrix:n.transform.calculateProjMatrix(U);n.prepareDrawTile();const Z=t?t.getTile(j):k?k[j.key]:new bp(j,v,_.zoom,n),X=b?jZ(q,d,u,n,b,i.scope,{tileID:j,tileSize:v}):BZ(q,d,u,c);n.uploadCommonUniforms(p,F,U);const{tileBoundsBuffer:J,tileBoundsIndexBuffer:rt,tileBoundsSegments:it}=n.getTileBoundsBuffers(Z);F.draw(n,g.TRIANGLES,A,E,C,un.disabled,X,i.id,J,rt,it)}},sky:function(n,t,i){const o=n._atmosphere?vi(n.transform.zoom):1,c=i.paint.get("sky-opacity")*o;if(c===0)return;const u=n.context,d=i.paint.get("sky-type"),p=new Ge(u.gl.LEQUAL,Ge.ReadOnly,[0,1]),g=n.frameCounter/1e3%1;d==="atmosphere"?n.renderPass==="offscreen"?i.needsSkyboxCapture(n)&&(function(_,v,b,S){const E=_.context,A=E.gl;let C=v.skyboxFbo;if(!C){C=v.skyboxFbo=E.createFramebuffer(32,32,!0,null),v.skyboxGeometry=new $3(E),v.skyboxTexture=E.gl.createTexture(),A.bindTexture(A.TEXTURE_CUBE_MAP,v.skyboxTexture),A.texParameteri(A.TEXTURE_CUBE_MAP,A.TEXTURE_WRAP_S,A.CLAMP_TO_EDGE),A.texParameteri(A.TEXTURE_CUBE_MAP,A.TEXTURE_WRAP_T,A.CLAMP_TO_EDGE),A.texParameteri(A.TEXTURE_CUBE_MAP,A.TEXTURE_MIN_FILTER,A.LINEAR),A.texParameteri(A.TEXTURE_CUBE_MAP,A.TEXTURE_MAG_FILTER,A.LINEAR);for(let j=0;j<6;++j)A.texImage2D(A.TEXTURE_CUBE_MAP_POSITIVE_X+j,0,A.RGBA,32,32,0,A.RGBA,A.UNSIGNED_BYTE,null)}E.bindFramebuffer.set(C.framebuffer),E.viewport.set([0,0,32,32]);const P=v.getCenter(_,!0),k=_.getOrCreateProgram("skyboxCapture"),L=new Float64Array(16);wt.identity(L),wt.rotateY(L,L,.5*-Math.PI),kd(_,v,k,L,P,0),wt.identity(L),wt.rotateY(L,L,.5*Math.PI),kd(_,v,k,L,P,1),wt.identity(L),wt.rotateX(L,L,.5*-Math.PI),kd(_,v,k,L,P,2),wt.identity(L),wt.rotateX(L,L,.5*Math.PI),kd(_,v,k,L,P,3),wt.identity(L),kd(_,v,k,L,P,4),wt.identity(L),wt.rotateY(L,L,Math.PI),kd(_,v,k,L,P,5),E.viewport.set([0,0,_.width,_.height])}(n,i),i.markSkyboxValid(n)):n.renderPass==="sky"&&function(_,v,b,S,E){const A=_.context,C=A.gl,P=_.transform,k=_.getOrCreateProgram("skybox");A.activeTexture.set(C.TEXTURE0),C.bindTexture(C.TEXTURE_CUBE_MAP,v.skyboxTexture);const L=((j,V,F,U,q)=>({u_matrix:j,u_sun_direction:V,u_cubemap:0,u_opacity:U,u_temporal_offset:q}))(P.skyboxMatrix,v.getCenter(_,!1),0,S,E);_.uploadCommonUniforms(A,k),k.draw(_,C.TRIANGLES,b,an.disabled,_.colorModeForRenderPass(),un.backCW,L,"skybox",v.skyboxGeometry.vertexBuffer,v.skyboxGeometry.indexBuffer,v.skyboxGeometry.segment)}(n,i,p,c,g):d==="gradient"&&n.renderPass==="sky"&&function(_,v,b,S,E){const A=_.context,C=A.gl,P=_.transform,k=_.getOrCreateProgram("skyboxGradient");v.skyboxGeometry||(v.skyboxGeometry=new $3(A)),A.activeTexture.set(C.TEXTURE0);let L=v.colorRampTexture;L||(L=v.colorRampTexture=new _r(A,v.colorRamp,C.RGBA)),L.bind(C.LINEAR,C.CLAMP_TO_EDGE);const j=((V,F,U,q,Z)=>({u_matrix:V,u_color_ramp:0,u_center_direction:F,u_radius:st(U),u_opacity:q,u_temporal_offset:Z}))(P.skyboxMatrix,v.getCenter(_,!1),v.paint.get("sky-gradient-radius"),S,E);_.uploadCommonUniforms(A,k),k.draw(_,C.TRIANGLES,b,an.disabled,_.colorModeForRenderPass(),un.backCW,j,"skyboxGradient",v.skyboxGeometry.vertexBuffer,v.skyboxGeometry.indexBuffer,v.skyboxGeometry.segment)}(n,i,p,c,g)},debug:function(n,t,i){for(let o=0;o<i.length;o++)nX(n,t,i[o])},custom:function(n,t,i,o){const c=n.context,u=i.implementation;if(!n.transform.projection.unsupportedLayers||!n.transform.projection.unsupportedLayers.includes("custom")||n.terrain&&(n.terrain.renderingToTexture||n.renderPass==="offscreen")&&i.isLayerDraped(t)){if(n.renderPass==="offscreen"){const d=u.prerender;if(d){if(n.setCustomLayerDefaults(),c.setColorMode(n.colorModeForRenderPass()),n.transform.projection.name==="globe"){const p=n.transform.pointMerc;d.call(u,c.gl,n.transform.customLayerMatrix(),n.transform.getProjection(),n.transform.globeToMercatorMatrix(),vi(n.transform.zoom),[p.x,p.y],n.transform.pixelsPerMeterRatio)}else d.call(u,c.gl,n.transform.customLayerMatrix());c.setDirty(),n.setBaseState()}}else if(n.renderPass==="translucent"){if(n.terrain&&n.terrain.renderingToTexture){const p=u.renderToTile;if(p){const g=o[0].canonical,_=new vn(g.x+o[0].wrap*(1<<g.z),g.y,g.z);c.setDepthMode(Ge.disabled),c.setStencilMode(an.disabled),c.setColorMode(n.colorModeForRenderPass()),n.setCustomLayerDefaults(),p.call(u,c.gl,_),c.setDirty(),n.setBaseState()}return}n.setCustomLayerDefaults(),c.setColorMode(n.colorModeForRenderPass()),c.setStencilMode(an.disabled);const d=u.renderingMode==="3d"?new Ge(n.context.gl.LEQUAL,Ge.ReadWrite,n.depthRangeFor3D):n.depthModeForSublayer(0,Ge.ReadOnly);if(c.setDepthMode(d),n.transform.projection.name==="globe"){const p=n.transform.pointMerc;u.render(c.gl,n.transform.customLayerMatrix(),n.transform.getProjection(),n.transform.globeToMercatorMatrix(),vi(n.transform.zoom),[p.x,p.y],n.transform.pixelsPerMeterRatio)}else u.render(c.gl,n.transform.customLayerMatrix());c.setDirty(),n.setBaseState(),c.bindFramebuffer.set(null)}}else _t("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(n,t,i,o){if(n.renderPass==="opaque")return;const c=i.paint.get("model-opacity");if(c===0)return;const u=i.paint.get("model-cast-shadows");if(n.renderPass==="shadow"&&(!u||n.terrain&&c<.65&&i._transitionablePaint._values["model-opacity"].value.expression instanceof ec))return;const d=n.shadowRenderer,p=i.paint.get("model-receive-shadows");d&&(d.useNormalOffset=!0,p||(d.enabled=!1));const g=()=>{d&&(d.useNormalOffset=!0,p||(d.enabled=!0))},_=t.getSource();if(n.renderPass==="light-beam"&&_.type!=="batched-model")return;if(_.type==="vector"||_.type==="geojson")return function(k,L,j,V){const F=k.transform;if(F.projection.name!=="mercator")return void _t(`Drawing 3D models for ${F.projection.name} projection is not yet implemented`);const U=F.getFreeCameraOptions().position;if(!k.modelManager)return;const q=k.modelManager,Z=k.shadowRenderer;if(!j._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const X=j._unevaluatedLayout._values["model-id"],J={...j.layout.get("model-id").parameters};for(const rt of V){const it=L.getTile(rt).getBucket(j);if(!it||it.projection.name!==F.projection.name)continue;const ut=uX(rt,F);J.zoom=ut;const tt=X.possiblyEvaluate(J);if(cX(k,it,rt),Ra.shadowUniformsInitialized=!1,Ra.useSingleShadowCascade=!!Z&&Z.getMaxCascadeForTile(rt.toUnwrapped())===0,k.renderPass==="shadow"&&Z){if(k.currentShadowCascade===1&&it.isInsideFirstShadowMapFrustum)continue;const xt=F.calculatePosMatrix(rt.toUnwrapped(),F.worldSize);if(Ra.tileMatrix.set(xt),Ra.shadowTileMatrix=Float32Array.from(Z.calculateShadowPassMatrixFromMatrix(xt)),Ra.aabb.min.fill(0),Ra.aabb.max[0]=Ra.aabb.max[1]=Dt,Ra.aabb.max[2]=0,dX(it,Ra,k,j.scope))continue}const dt=1<<rt.canonical.z,gt=[((U.x-rt.wrap)*dt-rt.canonical.x)*Dt,(U.y*dt-rt.canonical.y)*Dt,U.z*dt*Dt];for(let xt in it.instancesPerModel){const ht=it.instancesPerModel[xt];ht.features.length>0&&(xt=tt.evaluate(ht.features[0].feature,{}));const pt=q.getModel(xt,j.scope);if(pt&&pt.uploaded)for(const Et of pt.nodes)H3(k,j,Et,ht,gt,rt,Ra)}}}(n,t,i,o),void g();if(!_.loaded())return;if(_.type==="batched-model")return function(k,L,j,V){const F=k.context,U=k.transform,q=k.style.fog,Z=k.shadowRenderer;if(U.projection.name!=="mercator")return void _t(`Drawing 3D landmark models for ${U.projection.name} projection is not yet implemented`);const X=k.transform.getFreeCameraOptions().position,J=ct.scale([],[X.x,X.y,X.z],k.transform.worldSize);ct.negate(J,J);const rt=wt.identity([]),it=fc(U.center.lat,U.zoom),ut=wt.fromScaling([],[1,1,1/it]);wt.translate(rt,rt,J);const tt=j.paint.get("model-opacity"),dt=new Ge(F.gl.LEQUAL,Ge.ReadWrite,k.depthRangeFor3D),gt=new Ge(F.gl.LEQUAL,Ge.ReadOnly,k.depthRangeFor3D),xt=function(ht,pt){for(const Et of V){const At=L.getTile(Et).getBucket(j);if(!At||!At.uploaded)continue;let Mt=!1;Z&&(Mt=Z.getMaxCascadeForTile(Et.toUnwrapped())===0);const Lt=U.calculatePosMatrix(Et.toUnwrapped(),U.worldSize),Nt=At.modelTraits;for(const jt of At.getNodesInfo()){if(jt.hiddenByReplacement||!jt.node.meshes)continue;const It=jt.node,Gt=k.renderPass==="light-beam",ce=[...Lt],ue=jt.evaluatedScale;let ye=0;k.terrain&&It.elevation&&(ye=It.elevation*k.terrain.exaggeration()),wt.translate(ce,ce,[(It.anchor?It.anchor[0]:0)*(ue[0]-1),(It.anchor?It.anchor[1]:0)*(ue[1]-1),ye]),ue!==$H&&wt.scale(ce,ce,ue),wt.multiply(ce,ce,It.matrix);const be=wt.multiply([],ut,ce);wt.multiply(be,rt,be);const We=wt.invert([],be);wt.transpose(We,We),wt.scale(We,We,hX);const Pe=wt.multiply([],U.expandedFarZProjMatrix,ce);for(let Tn=0;Tn<It.meshes.length;++Tn){const fn=It.meshes[Tn],He=Tn===It.lightMeshIndex;if(He){if(!Gt&&!k.terrain&&k.shadowRenderer){k.currentLayer<k.firstLightBeamLayer&&(k.firstLightBeamLayer=k.currentLayer);continue}}else if(Gt)continue;const Ue={defines:[]},Re=[];IS(Ue.defines,Re,fn,k),4&Nt||Ue.defines.push("DIFFUSE_SHADED"),Mt&&Ue.defines.push("SHADOWS_SINGLE_CASCADE");const gn=k.renderPass==="shadow";if(gn){kS(fn,ce,k,j);continue}let bn=null;if(q){const Or=G3(ce,k.transform);if(bn=new Float32Array(Or),U.projection.name!=="globe"){const Dr=fn.aabb.min,lr=fn.aabb.max,[zn,Pi]=q.getOpacityForBounds(Or,Dr[0],Dr[1],lr[0],lr[1]);Ue.overrideFog=zn>=$u||Pi>=$u}}const sn=k.getOrCreateProgram("model",Ue);!gn&&Z&&(Z.useNormalOffset=!!fn.normalBuffer,Z.setupShadowsFromMatrix(ce,sn,Z.useNormalOffset)),k.uploadCommonUniforms(F,sn,Et.toUnwrapped(),bn);const Gn=fn.material,kr=Gn.pbrMetallicRoughness;kr.metallicFactor=.9,kr.roughnessFactor=.5;const Vn=0,rr=CS(new Float32Array(Pe),new Float32Array(be),new Float32Array(We),k,tt,kr.baseColorFactor,Gn.emissiveFactor,kr.metallicFactor,kr.roughnessFactor,Gn,Vn,j);sn.draw(k,F.gl.TRIANGLES,pt&&!He?dt:gt,an.disabled,ht?He||tt<1||jt.hasTranslucentParts?Cn.alphaBlended:Cn.unblended:Cn.disabled,un.backCCW,rr,j.id,fn.vertexBuffer,fn.indexBuffer,fn.segments,j.paint,k.transform.zoom,void 0,Re)}}}};(function(ht,pt,Et,At){const Mt=ht.terrain?ht.terrain.exaggeration():0,Lt=ht.transform.zoom;for(const Nt of At){const jt=pt.getTile(Nt).getBucket(Et);jt&&(ht.conflationActive&&jt.updateReplacement(Nt,ht.replacementSource),jt.evaluateScale(ht,Et),ht.terrain&&Mt>0&&jt.elevationUpdate(ht.terrain,Mt,Nt,Et.source),jt.needsReEvaluation(ht,Lt,Et)&&jt.evaluate(Et))}})(k,L,j,V),tt===1?xt(!0,!0):(xt(!1,!0),xt(!0,!1))}(n,t,i,o),void g();const v=_.getModels(),b=[],S=n.transform.getFreeCameraOptions().position,E=ct.scale([],[S.x,S.y,S.z],n.transform.worldSize);ct.negate(E,E);const A=[],C=[];let P=0;for(const k of v){const L=i.paint.get("model-rotation").constantOr(null),j=i.paint.get("model-scale").constantOr(null),V=i.paint.get("model-translation").constantOr(null);k.computeModelMatrix(n,L,j,V,!0,!0,!1);const F=wt.identity([]),U=fc(k.position.lat,n.transform.zoom),q=wt.fromScaling([],[1,1,1/U]);wt.translate(F,F,E),b.push({zScaleMatrix:q,negCameraPosMatrix:F});for(const Z of k.nodes)W3(n.transform,Z,k.matrix,n.transform.expandedFarZProjMatrix,P,A,C);P++}if(A.sort((k,L)=>L.depth-k.depth),n.renderPass!=="shadow"){if(c===1)for(const k of C)zy(k,n,i,b[k.modelIndex],an.disabled,n.colorModeForRenderPass());else{for(const k of C)zy(k,n,i,b[k.modelIndex],an.disabled,Cn.disabled);for(const k of C)zy(k,n,i,b[k.modelIndex],n.stencilModeFor3D(),n.colorModeForRenderPass());n.resetStencilClippingMasks()}for(const k of A)zy(k,n,i,b[k.modelIndex],an.disabled,n.colorModeForRenderPass());g()}else{for(const k of C)kS(k.mesh,k.nodeModelMatrix,n,i);for(const k of A)kS(k.mesh,k.nodeModelMatrix,n,i);g()}}},Z3={modelUpload:function(n,t,i){const o=t.getSource();if(!o.loaded())return;if(o.type==="vector"||o.type==="geojson")return void(n.modelManager&&n.modelManager.upload(n,i));if(o.type==="batched-model")return;const c=o.getModels();for(const u of c)u.upload(n.context)}};class mX{constructor(t,i,o){this.context=new DH(t,i),this.transform=o,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=Qo.maxUnderzooming+Qo.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new XH,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new yX(this),this._wireframeDebugCache=new pX,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0}updateTerrain(t,i){const o=!!t&&!!t.terrain&&this.transform.projection.supportsTerrain;if(!(o||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new SZ(this,t));const c=this._terrain;this.transform.elevation=o?c:null,c.update(t,this.transform,i),this.transform.elevation&&!c.enabled&&(this.transform.elevation=null)}_updateFog(t){const i=t.fog;if(!i||this.transform.projection.name==="globe"||i.getOpacity(this.transform.pitch)<1||i.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[o,c]=i.getFovAdjustedRange(this.transform._fov);if(o>c)return void(this.transform.fogCullDistSq=null);const u=o+.78*(c-o);this.transform.fogCullDistSq=u*u}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(t,i){if(this.width=t*Be.devicePixelRatio,this.height=i*Be.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const o of this.style.order)this.style._mergedLayers[o].resize()}setup(){const t=this.context,i=new Ds;i.emplaceBack(0,0),i.emplaceBack(Dt,0),i.emplaceBack(0,Dt),i.emplaceBack(Dt,Dt),this.tileExtentBuffer=t.createVertexBuffer(i,cc.members),this.tileExtentSegments=Bn.simpleSegment(0,0,4,2);const o=new Ds;o.emplaceBack(0,0),o.emplaceBack(Dt,0),o.emplaceBack(0,Dt),o.emplaceBack(Dt,Dt),this.debugBuffer=t.createVertexBuffer(o,cc.members),this.debugSegments=Bn.simpleSegment(0,0,4,5);const c=new Ds;c.emplaceBack(-1,-1),c.emplaceBack(1,-1),c.emplaceBack(-1,1),c.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(c,cc.members),this.viewportSegments=Bn.simpleSegment(0,0,4,2);const u=new Du;u.emplaceBack(0,0,0,0),u.emplaceBack(Dt,0,Dt,0),u.emplaceBack(0,Dt,0,Dt),u.emplaceBack(Dt,Dt,Dt,Dt),this.mercatorBoundsBuffer=t.createVertexBuffer(u,Ww.members),this.mercatorBoundsSegments=Bn.simpleSegment(0,0,4,2);const d=new Hr;d.emplaceBack(0,1,2),d.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(d);const p=new Qf;for(const _ of[0,1,3,2,0])p.emplaceBack(_);this.debugIndexBuffer=t.createIndexBuffer(p),this.emptyTexture=new _r(t,new Fr({width:1,height:1},Uint8Array.of(0,0,0,0)),t.gl.RGBA),this.identityMat=wt.create();const g=this.context.gl;this.stencilClearMode=new an({func:g.ALWAYS,mask:0},0,255,g.ZERO,g.ZERO,g.ZERO),this.loadTimeStamps.push(w.performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(t){return t._makeTileBoundsBuffers(this.context,this.transform.projection),t._tileBoundsBuffer?{tileBoundsBuffer:t._tileBoundsBuffer,tileBoundsIndexBuffer:t._tileBoundsIndexBuffer,tileBoundsSegments:t._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const t=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,t.TRIANGLES,Ge.disabled,this.stencilClearMode,Cn.disabled,un.disabled,AS(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(t,i,o){if(!i||this.currentStencilSource===i.id||!t.isTileClipped()||!o||o.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let p=!1;for(const g of o)if(this._tileClippingMaskIDs[g.key]===void 0){p=!0;break}if(!p)return}this.currentStencilSource=i.id;const c=this.context,u=c.gl;this.nextStencilID+o.length>256&&this.clearStencil(),c.setColorMode(Cn.disabled),c.setDepthMode(Ge.disabled);const d=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const p of o){const g=i.getTile(p),_=this._tileClippingMaskIDs[p.key]=this.nextStencilID++,{tileBoundsBuffer:v,tileBoundsIndexBuffer:b,tileBoundsSegments:S}=this.getTileBoundsBuffers(g);d.draw(this,u.TRIANGLES,Ge.disabled,new an({func:u.ALWAYS,mask:0},_,255,u.KEEP,u.KEEP,u.REPLACE),Cn.disabled,un.disabled,AS(p.projMatrix),"$clipping",v,b,S)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,i=this.context.gl;return new an({func:i.NOTEQUAL,mask:255},t,255,i.KEEP,i.KEEP,i.REPLACE)}stencilModeForClipping(t){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(t);const i=this.context.gl;return new an({func:i.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,i.KEEP,i.KEEP,i.REPLACE)}stencilConfigForOverlap(t){const i=this.context.gl,o=t.sort((d,p)=>p.overscaledZ-d.overscaledZ),c=o[o.length-1].overscaledZ,u=o[0].overscaledZ-c+1;if(u>1){this.currentStencilSource=void 0,this.nextStencilID+u>256&&this.clearStencil();const d={};for(let p=0;p<u;p++)d[p+c]=new an({func:i.GEQUAL,mask:255},p+this.nextStencilID,255,i.KEEP,i.KEEP,i.REPLACE);return this.nextStencilID+=u,[d,o]}return[{[c]:an.disabled},o]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new Cn([t.CONSTANT_COLOR,t.ONE,t.CONSTANT_COLOR,t.ONE],new tn(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Cn.unblended:Cn.alphaBlended}colorModeForDrapableLayerRenderPass(t){const i=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new Cn([i.ONE,i.ONE_MINUS_SRC_ALPHA,i.CONSTANT_ALPHA,i.ONE_MINUS_SRC_ALPHA],new tn(0,0,0,t===void 0?0:t),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(t,i,o,c=!1){if(!this.opaquePassEnabledForLayer()&&!c)return Ge.disabled;const u=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new Ge(o||this.context.gl.LEQUAL,i,[u,u])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,i){this._wireframeDebugCache.update(this.frameCounter),this.style=t,this.options=i;const o=this.style._mergedLayers,c=this.style.order,u=c.map(F=>o[F]),d=this.style._mergedSourceCaches;this.imageManager=t.imageManager,this.modelManager=t.modelManager,this.symbolFadeChange=t.placement.symbolFadeChange(Be.now()),this.imageManager.beginFrame();let p=0,g=!1;for(const F in d){const U=d[F];U.used&&(U.prepare(this.context),U.getSource().usedInConflation&&++p)}const _={},v={},b={},S={},E={};for(const F in d){const U=d[F];_[F]=U.getVisibleCoordinates(),v[F]=_[F].slice().reverse(),b[F]=U.getVisibleCoordinates(!0).reverse(),S[F]=U.getShadowCasterCoordinates(),E[F]=U.sortCoordinatesByDistance(_[F])}const A=F=>{const U=this.style.getLayerSourceCache(F);return U&&U.used?U.getSource():null};if(p){const F=[];for(const U of u)this.layerUsedInConflation(U,A(U))&&F.push(U);if(F&&F.length>1){const U=[];for(const q of F){const Z=this.style.getLayerSourceCache(q);Z&&Z.used&&Z.getSource().usedInConflation&&U.push({layer:q.fqid,cache:Z})}this.replacementSource.setSources(U),g=!0}}g||this.replacementSource.clear(),this.conflationActive=g,this.minCutoffZoom=0,this.longestCutoffRange=0;for(const F of u){const U=F.cutoffRange();if(this.longestCutoffRange=Math.max(U,this.longestCutoffRange),U>0){const q=A(F);q&&(this.minCutoffZoom=Math.max(q.minzoom,this.minCutoffZoom)),F.minzoom&&(this.minCutoffZoom=Math.max(F.minzoom,this.minCutoffZoom))}}this.opaquePassCutoff=1/0;for(let F=0;F<u.length;F++)if(u[F].is3D()){this.opaquePassCutoff=F;break}const C=this.style&&this.style.fog;C?(this._fogVisible=C.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=C.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(b),this.opaquePassCutoff=0);const P=this._shadowRenderer;if(P){P.updateShadowParameters(this.transform,this.style.directionalLight);for(const F in d)for(const U of _[F]){let q={min:0,max:0};this.terrain&&(q=this.terrain.getMinMaxForTile(U)||q),P.addShadowReceiver(U.toUnwrapped(),q.min,q.max)}}this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new q9(this.context));for(const F of u){if(F.isHidden(this.transform.zoom))continue;const U=t.getLayerSourceCache(F);this.uploadLayer(this,F,U)}if(this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new lX),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),!Ya.has(this.context.gl))return;this.renderPass="offscreen";for(const F of u){const U=t.getLayerSourceCache(F);if(!F.hasOffscreenPass()||F.isHidden(this.transform.zoom))continue;const q=U?v[U.id]:void 0;(F.type==="custom"||F.type==="raster"||F.isSky()||q&&q.length)&&this.renderLayer(this,U,F,q)}this.depthRangeFor3D=[0,1-(u.length+2)*this.numSublayers*this.depthEpsilon];const k=this.terrain;k&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&!this.transform.isOrthographic&&k.drawDepth(),this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,S)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const L=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),j=(()=>{if(i.showOverdrawInspector)return tn.black;if(this.style.fog&&this.transform.projection.supportsFog&&!L){const F=this.style.fog.properties.get("color").toArray01();return new tn(...F)}if(this.style.fog&&this.transform.projection.supportsFog&&L){const F=this.style.fog.properties.get("space-color").toArray01();return new tn(...F)}return tn.transparent})();if(this.context.clear({color:j,depth:1}),this.clearStencil(),this._showOverdrawInspector=i.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&L&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=c.length-1;this.currentLayer>=0;this.currentLayer--){const F=u[this.currentLayer],U=t.getLayerSourceCache(F);if(F.isSky())continue;const q=U?(F.is3D()?E:v)[U.id]:void 0;this._renderTileClippingMasks(F,U,q),this.renderLayer(this,U,F,q)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&L&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||vi(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<c.length;this.currentLayer++){const F=u[this.currentLayer],U=t.getLayerSourceCache(F);F.isSky()&&this.renderLayer(this,U,F,U?v[U.id]:void 0)}this.renderPass="translucent",this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let V=0;for(P&&(V=P.getShadowCastingLayerCount());this.currentLayer<c.length;){const F=u[this.currentLayer],U=t.getLayerSourceCache(F);if(F.isSky()){++this.currentLayer;continue}if(k&&this.style.isLayerDraped(F)){if(F.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=k.renderBatch(this.currentLayer);continue}let q;if(U&&(q=(F.type==="symbol"?b:F.is3D()?E:v)[U.id]),this._renderTileClippingMasks(F,U,U?_[U.id]:void 0),this.renderLayer(this,U,F,q),!k&&P&&V>0&&F.hasShadowPass()&&--V==0&&(P.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const Z=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=Z;this.currentLayer++){const X=u[this.currentLayer];if(!X.hasLightBeamPass())continue;const J=t.getLayerSourceCache(X);this.renderLayer(this,J,X,J?v[J.id]:void 0)}this.currentLayer=Z,this.renderPass="translucent"}++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let F=null;u.forEach(U=>{const q=t.getLayerSourceCache(U);q&&!U.isHidden(this.transform.zoom)&&q.getVisibleCoordinates().length&&(!F||F.getSource().maxzoom<q.getSource().maxzoom)&&(F=q)}),F&&this.options.showTileBoundaries&&q3.debug(this,F,F.getVisibleCoordinates())}this.options.showPadding&&function(F){const U=F.transform.padding;V3(F,F.transform.height-(U.top||0),3,KZ),V3(F,U.bottom||0,3,JZ),U3(F,U.left||0,3,QZ),U3(F,F.transform.width-(U.right||0),3,tX);const q=F.transform.centerPoint;(function(Z,X,J,rt){Ly(Z,X-1,J-10,2,20,rt),Ly(Z,X-10,J-1,20,2,rt)})(F,q.x,F.transform.height-q.y,eX)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(w.performance.now()),this.saveCanvasCopy()),g||(this.conflationActive=!1)}uploadLayer(t,i,o){this.gpuTimingStart(i),(!t.transform.projection.unsupportedLayers||!t.transform.projection.unsupportedLayers.includes(i.type)||t.terrain&&i.type==="custom")&&Z3[`${i.type}Upload`]&&Z3[`${i.type}Upload`](t,o,i.scope),this.gpuTimingEnd()}renderLayer(t,i,o,c){o.isHidden(this.transform.zoom)||(o.type==="background"||o.type==="sky"||o.type==="custom"||o.type==="model"||o.type==="raster"||c&&c.length)&&(this.id=o.id,this.gpuTimingStart(o),(!t.transform.projection.unsupportedLayers||!t.transform.projection.unsupportedLayers.includes(o.type)||t.terrain&&o.type==="custom")&&q3[o.type](t,i,o,c,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(t){if(!this.options.gpuTiming)return;const i=this.context.extTimerQuery,o=this.context.gl;let c=this.gpuTimers[t.id];c||(c=this.gpuTimers[t.id]={calls:0,cpuTime:0,query:o.createQuery()}),c.calls++,o.beginQuery(i.TIME_ELAPSED_EXT,c.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const t=this.context.extTimerQuery,i=this.context.gl,o=i.createQuery();this.deferredRenderGpuTimeQueries.push(o),i.beginQuery(t.TIME_ELAPSED_EXT,o)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const t=this.gpuTimers;return this.gpuTimers={},t}collectDeferredRenderGpuQueries(){const t=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],t}queryGpuTimers(t){const i={};for(const o in t){const c=t[o],u=this.context.extTimerQuery,d=u.getQueryParameter(c.query,this.context.gl.QUERY_RESULT)/1e6;u.deleteQueryEXT(c.query),i[o]=d}return i}queryGpuTimeDeferredRender(t){if(!this.options.gpuTimingDeferredRender)return 0;const i=this.context.extTimerQuery,o=this.context.gl;let c=0;for(const u of t)c+=i.getQueryParameter(u,o.QUERY_RESULT)/1e6,i.deleteQueryEXT(u);return c}translatePosMatrix(t,i,o,c,u){if(!o[0]&&!o[1])return t;const d=u?c==="map"?this.transform.angle:0:c==="viewport"?-this.transform.angle:0;if(d){const _=Math.sin(d),v=Math.cos(d);o=[o[0]*v-o[1]*_,o[0]*_+o[1]*v]}const p=[u?o[0]:ju(i,o[0],this.transform.zoom),u?o[1]:ju(i,o[1],this.transform.zoom),0],g=new Float32Array(16);return wt.translate(g,t,p),g}saveTileTexture(t){const i=t.size[0],o=this._tileTextures[i];o?o.push(t):this._tileTextures[i]=[t]}getTileTexture(t){const i=this._tileTextures[t];return i&&i.length>0?i.pop():null}isPatternMissing(t,i){return t===null||t!==void 0&&!this.imageManager.getPattern(t.toString(),i)}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(t,i,o){const c=o===void 0?this.terrain&&this.terrain.renderingToTexture:o,u=this.terrain&&this.terrain.exaggeration()===0,d=[];return this.style&&this.style.enable3dLights()&&(t==="globeRaster"||t==="terrainRaster"?(d.push("LIGHTING_3D_MODE"),d.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):c||d.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"?this._shadowMapDebug||d.push("DEPTH_TEXTURE"):this.shadowRenderer&&(this.shadowRenderer.useNormalOffset?d.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"):d.push("RENDER_SHADOWS","DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(d.push("TERRAIN"),this.linearFloatFilteringSupported()&&d.push("TERRAIN_DEM_FLOAT_FORMAT"),u&&d.push("ZERO_EXAGGERATION")),this.transform.projection.name==="globe"&&d.push("GLOBE"),!this._fogVisible||c||i!==void 0&&!i||d.push("FOG","FOG_DITHERING"),c&&d.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&d.push("OVERDRAW_INSPECTOR"),d}getOrCreateProgram(t,i){this.cache=this.cache||{};const o=i&&i.defines||[],c=i&&i.config,u=this.currentGlobalDefines(t,i&&i.overrideFog,i&&i.overrideRtt).concat(o),d=E3.cacheKey(m3[t],t,u,c);return this.cache[d]||(this.cache[d]=new E3(this.context,t,m3[t],c,VZ[t],u)),this.cache[d]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=w.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new _r(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(t,i){if(this.style.enable3dLights()){const o=this.style.directionalLight,c=this.style.ambientLight;if(o&&c){const u=((d,p)=>{const g=d.properties.get("direction"),_=d.properties.get("color").toArray01(),v=d.properties.get("intensity"),b=p.properties.get("color").toArray01(),S=p.properties.get("intensity"),E=[g.x,g.y,g.z],A=Jn(b,S),C=Jn(_,v);return{u_lighting_ambient_color:A,u_lighting_directional_dir:E,u_lighting_directional_color:C,u_ground_radiance:TZ(E,C,A)}})(o,c);i.setLightsUniformValues(t,u)}}}uploadCommonUniforms(t,i,o,c,u){if(this.uploadCommonLightUniforms(t,i),this.terrain&&this.terrain.renderingToTexture)return;const d=this.style.fog;if(d){const p=d.getOpacity(this.transform.pitch),g=((_,v,b,S,E,A,C,P,k,L,j,V)=>{const F=_.transform,U=v.properties.get("color").toArray01();U[3]=S;const q=_.frameCounter/1e3%1,[Z,X]=v.properties.get("vertical-range");return{u_fog_matrix:b?F.calculateFogTileMatrix(b):V||_.identityMat,u_fog_range:v.getFovAdjustedRange(F._fov),u_fog_color:U,u_fog_horizon_blend:v.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(Z,X),X],u_fog_temporal_offset:q,u_frustum_tl:E,u_frustum_tr:A,u_frustum_br:C,u_frustum_bl:P,u_globe_pos:k,u_globe_radius:L,u_viewport:j,u_globe_transition:vi(F.zoom),u_is_globe:+(F.projection.name==="globe")}})(this,d,o,p,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*Be.devicePixelRatio,this.transform.height*Be.devicePixelRatio],c);i.setFogUniformValues(t,g)}u&&i.setCutoffUniformValues(t,u.uniformValues)}setTileLoadedFlag(t){this.tileLoaded=t}saveCanvasCopy(){const t=this.canvasCopy();t&&(this.frameCopies.push(t),this.tileLoaded=!1)}canvasCopy(){const t=this.context.gl,i=t.createTexture();return t.bindTexture(t.TEXTURE_2D,i),t.copyTexImage2D(t.TEXTURE_2D,0,t.RGBA,0,0,t.drawingBufferWidth,t.drawingBufferHeight,0),i}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const t=this.style&&this.style.fog;return!!t&&t.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const t=this._backgroundTiles,i=this._backgroundTiles={},o=this.transform.coveringTiles({tileSize:512});for(const c of o)i[c.key]=t[c.key]||new bp(c,512,this.transform.tileZoom,this);return i}clearBackgroundTiles(){this._backgroundTiles={}}layerUsedInConflation(t,i){return!(!t.is3D()||t.minzoom&&t.minzoom>this.transform.zoom||t.sourceLayer!=="building"&&(!i||i.type!=="batched-model"))}isTileAffectedByFog(t){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let i=this._cachedTileFogOpacities[t.key];return i||(this._cachedTileFogOpacities[t.key]=i=this.style.fog.getOpacityForTile(t)),i[0]>=$u||i[1]>=$u}}const Hu=2048;class gX{constructor(t,i){this.aabb=t,this.lastCascade=i}}class _X{add(t,i){const o=this.receivers[t.key];o!==void 0?(o.aabb.min[0]=Math.min(o.aabb.min[0],i.min[0]),o.aabb.min[1]=Math.min(o.aabb.min[1],i.min[1]),o.aabb.min[2]=Math.min(o.aabb.min[2],i.min[2]),o.aabb.max[0]=Math.max(o.aabb.max[0],i.max[0]),o.aabb.max[1]=Math.max(o.aabb.max[1],i.max[1]),o.aabb.max[2]=Math.max(o.aabb.max[2],i.max[2])):this.receivers[t.key]=new gX(i,null)}clear(){this.receivers={}}get(t){return this.receivers[t.key]}computeRequiredCascades(t,i,o){const c=nr.fromPoints(t.points);let u=0;for(const d in this.receivers){const p=this.receivers[d];if(!p||!c.intersectsAabb(p.aabb))continue;p.aabb.min=c.closestPoint(p.aabb.min),p.aabb.max=c.closestPoint(p.aabb.max);const g=p.aabb.getCorners();for(let _=0;_<o.length;_++){let v=!0;for(const b of g){const S=[b[0]*i,b[1]*i,b[2]];if(ct.transformMat4(S,S,o[_].matrix),S[0]<-1||S[0]>1||S[1]<-1||S[1]>1){v=!1;break}}if(p.lastCascade=_,u=Math.max(u,_),v)break}}return u+1}}class yX{constructor(t){this.painter=t,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new _X,this._depthMode=new Ge(t.context.gl.LEQUAL,Ge.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this.useNormalOffset=!1}destroy(){for(const t of this._cascades)t.texture.destroy(),t.framebuffer.destroy();this._cascades=[]}updateShadowParameters(t,i){const o=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!i||!i.properties)return;const c=i.properties.get("shadow-intensity");if(!i.shadowsEnabled()||c<=0||(this._shadowLayerCount=o.style.order.reduce((E,A)=>{const C=o.style._mergedLayers[A];return E+(C.hasShadowPass()&&!C.isHidden(t.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this._enabled))return;const u=o.context,d=Hu,p=Hu;if(this._cascades.length===0)for(let E=0;E<2;++E){const A=o._shadowMapDebug,C=u.gl,P=u.createFramebuffer(d,p,A,"texture"),k=new _r(u,{width:d,height:p,data:null},C.DEPTH_COMPONENT);if(P.depthAttachment.set(k.texture),A){const L=new _r(u,{width:d,height:p,data:null},C.RGBA);P.colorAttachment.set(L.texture)}this._cascades.push({framebuffer:P,texture:k,matrix:[],far:0,boundingSphereRadius:0,frustum:new hl,scale:0})}this.shadowDirection=X3(i);let g=0;if(t.elevation){const E=t.elevation,A=[1e4,-1e4];E.visibleDemTiles.filter(C=>C.dem).forEach(C=>{const P=C.dem.tree;A[0]=Math.min(A[0],P.minimums[0]),A[1]=Math.max(A[1],P.maximums[0])}),A[0]!==1e4&&(g=(A[1]-A[0])*E.exaggeration())}const _=1.5*t.cameraToCenterDistance,v=3*_,b=new Float64Array(16);for(let E=0;E<2;++E){const A=this._cascades[E];let C=t.height/50,P=1;E===0?P=_:(C=_,P=v);const[k,L]=vX(t,this.shadowDirection,C,P,Hu,g);A.scale=t.scale,A.matrix=k,A.boundingSphereRadius=L,wt.invert(b,A.matrix),A.frustum=hl.fromInvProjectionMatrix(b,1,0,!0),A.far=P}this._uniformValues.u_fade_range=[.75*this._cascades[1].far,this._cascades[1].far],this._uniformValues.u_shadow_intensity=c,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=.00048828125,this._uniformValues.u_shadow_map_resolution=Hu,this._uniformValues.u_shadowmap_0=Ns.ShadowMap0,this._uniformValues.u_shadowmap_1=Ns.ShadowMap0+1,this._groundShadowTiles=o.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const S=o.transform.elevation;for(const E of this._groundShadowTiles){let A={min:0,max:0};if(S){const C=S.getMinMaxForTile(E);C&&(A=C)}this.addShadowReceiver(E.toUnwrapped(),A.min,A.max)}}get enabled(){return this._enabled}set enabled(t){this._enabled=t}drawShadowPass(t,i){if(!this._enabled)return;const o=this.painter,c=o.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(o.transform.getFrustum(0),o.transform.worldSize,this._cascades),c.viewport.set([0,0,Hu,Hu]);for(let u=0;u<this._numCascadesToRender;++u){o.currentShadowCascade=u,c.bindFramebuffer.set(this._cascades[u].framebuffer.framebuffer),c.clear({color:tn.white,depth:1});for(const d of t.order){const p=t._mergedLayers[d];if(!p.hasShadowPass()||p.isHidden(o.transform.zoom))continue;const g=t.getLayerSourceCache(p),_=g?i[g.id]:void 0;(p.type==="model"||_&&_.length)&&o.renderLayer(o,g,p,_)}}o.currentShadowCascade=0}drawGroundShadows(){if(!this._enabled)return;const t=this.painter,i=t.style,o=t.context,c=i.directionalLight,u=i.ambientLight;if(!c||!u)return;const d=[],p=Cd(t,t.longestCutoffRange);p.shouldRenderCutoff&&d.push("RENDER_CUTOFF");const g=DS(c,u),_=new Ge(o.gl.LEQUAL,Ge.ReadOnly,t.depthRangeFor3D);for(const v of this._groundShadowTiles){const b=v.toUnwrapped(),S=t.isTileAffectedByFog(v),E=t.getOrCreateProgram("groundShadow",{defines:d,overrideFog:S});this.setupShadows(b,E),t.uploadCommonUniforms(o,E,b,null,p);const A={u_matrix:t.transform.calculateProjMatrix(b),u_ground_shadow_factor:g};E.draw(t,o.gl.TRIANGLES,_,an.disabled,Cn.multiply,un.disabled,A,"ground_shadow",t.tileExtentBuffer,t.quadTriangleIndexBuffer,t.tileExtentSegments,{},t.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?Cn.unblended:Cn.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(t){const i=this.painter.transform,o=i.calculatePosMatrix(t,i.worldSize);return wt.multiply(o,this._cascades[this.painter.currentShadowCascade].matrix,o),Float32Array.from(o)}calculateShadowPassMatrixFromMatrix(t){return wt.multiply(t,this._cascades[this.painter.currentShadowCascade].matrix,t),Float32Array.from(t)}setupShadows(t,i,o,c=0){if(!this._enabled)return;const u=this.painter.transform,d=this.painter.context,p=d.gl,g=this._uniformValues,_=new Float64Array(16),v=u.calculatePosMatrix(t,u.worldSize);for(let b=0;b<2;b++)wt.multiply(_,this._cascades[b].matrix,v),g[b===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(_),d.activeTexture.set(p.TEXTURE0+Ns.ShadowMap0+b),this._cascades[b].texture.bind(p.NEAREST,p.CLAMP_TO_EDGE);if(this.useNormalOffset=!!o,this.useNormalOffset){const b=ap(t.canonical),S=2/u.tileSize*Dt/Hu,E=S*this._cascades[0].boundingSphereRadius,A=S*this._cascades[1].boundingSphereRadius,C=(o==="vector-tile"?1:3)/Math.pow(2,c-t.canonical.z-(1-u.zoom+Math.floor(u.zoom)));g.u_shadow_normal_offset=[b,E*C,A*C],g.u_shadow_bias=[6e-5,.0012,.012]}else g.u_shadow_bias=[36e-5,.0012,.012];i.setShadowUniformValues(d,g)}setupShadowsFromMatrix(t,i,o=!1){if(!this._enabled)return;const c=this.painter.context,u=c.gl,d=this._uniformValues,p=new Float64Array(16);for(let g=0;g<2;g++)wt.multiply(p,this._cascades[g].matrix,t),d[g===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(p),c.activeTexture.set(u.TEXTURE0+Ns.ShadowMap0+g),this._cascades[g].texture.bind(u.NEAREST,u.CLAMP_TO_EDGE);this.useNormalOffset=o,o?(d.u_shadow_normal_offset=[1,5,5],d.u_shadow_bias=[6e-5,.0012,.012]):d.u_shadow_bias=[36e-5,.0012,.012],i.setShadowUniformValues(c,d)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(t,i,o,c){if(c[2]>=0)return{};const u=function(g,_,v){const b=v/(1<<g.canonical.z);return new nr([g.canonical.x*b+g.wrap*v,g.canonical.y*b+g.wrap*v,0],[(g.canonical.x+1)*b+g.wrap*v,(g.canonical.y+1)*b+g.wrap*v,_])}(t,i,o).getCorners(),d=i/-c[2];c[0]<0?(ct.add(u[0],u[0],[c[0]*d,0,0]),ct.add(u[3],u[3],[c[0]*d,0,0])):c[0]>0&&(ct.add(u[1],u[1],[c[0]*d,0,0]),ct.add(u[2],u[2],[c[0]*d,0,0])),c[1]<0?(ct.add(u[0],u[0],[0,c[1]*d,0]),ct.add(u[1],u[1],[0,c[1]*d,0])):c[1]>0&&(ct.add(u[2],u[2],[0,c[1]*d,0]),ct.add(u[3],u[3],[0,c[1]*d,0]));const p={};return p.vertices=u,p.planes=[Ny(u[1],u[0],u[4]),Ny(u[2],u[1],u[5]),Ny(u[3],u[2],u[6]),Ny(u[0],u[3],u[7])],p}addShadowReceiver(t,i,o){this._receivers.add(t,nr.fromTileIdAndHeight(t,i,o))}getMaxCascadeForTile(t){const i=this._receivers.get(t);return i&&i.lastCascade?i.lastCascade:0}}function Ny(n,t,i){const o=ct.sub([],i,t),c=ct.sub([],n,t),u=ct.cross([],o,c),d=ct.length(u);return d===0?[0,0,1,0]:(ct.scale(u,u,1/d),[u[0],u[1],u[2],-ct.dot(u,t)])}function X3(n){const t=n.properties.get("direction"),i=Ee(t.x,t.y,t.z);i[2]=Ot(i[2],0,75);const o=ge([i[0],i[1],i[2]]);return ct.fromValues(o.x,o.y,o.z)}function DS(n,t){const i=n.properties.get("color"),o=n.properties.get("intensity"),c=n.properties.get("direction"),u=[c.x,c.y,c.z],d=t.properties.get("color"),p=t.properties.get("intensity"),g=Math.max(ct.dot([0,0,1],u),0),_=[0,0,0];ct.scale(_,d.toArray01Linear().slice(0,3),p);const v=[0,0,0];return ct.scale(v,i.toArray01Linear().slice(0,3),g*o),cr([_[0]>0?_[0]/(_[0]+v[0]):0,_[1]>0?_[1]/(_[1]+v[1]):0,_[2]>0?_[2]/(_[2]+v[2]):0])}function vX(n,t,i,o,c,u){const d=n.zoom,p=n.scale,g=n.worldSize,_=1/g,v=n.aspect,b=Math.sqrt(1+v*v)*Math.tan(.5*n.fovX),S=b*b,E=o-i,A=o+i;let C,P;S>E/A?(C=o,P=o*b):(C=.5*A*(1+S),P=.5*Math.sqrt(E*E+2*(o*o+i*i)*S+A*A*S*S));const k=n.projection.pixelsPerMeter(n.center.lat,g),L=n._camera.getCameraToWorldMercator(),j=[0,0,-C*_];ct.transformMat4(j,j,L);let V=P*_;const F=n._edgeInsets;if(!(F.left===0&&F.top===0&&F.right===0&&F.bottom===0||F.left===F.right&&F.top===F.bottom)){const At=n._camera.getWorldToCamera(n.worldSize,n.projection.zAxisUnit==="meters"?k:1),Mt=n._camera.getCameraToClipPerspective(n._fov,n.width/n.height,i,o);Mt[8]=2*-n.centerOffset.x/n.width,Mt[9]=2*n.centerOffset.y/n.height;const Lt=new Float64Array(16);wt.mul(Lt,Mt,At);const Nt=new Float64Array(16);wt.invert(Nt,Lt);const jt=hl.fromInvProjectionMatrix(Nt,g,d,!0);for(const It of jt.points){const Gt=((U=It)[0]/=p,U[1]/=p,U[2]=$n(U[2],n._center.lat),U);V=Math.max(V,ct.len(ct.subtract([],j,Gt)))}}var U;V*=c/(c-1);const q=Math.acos(t[2]),Z=Math.atan2(-t[0],-t[1]),X=new dy;X.position=j,X.setPitchBearing(q,Z);const J=X.getWorldToCamera(g,k),rt=V*g,it=Math.min(n._mercatorZfromZoom(17)*g*-2,-2*rt),ut=X.getCameraToClipOrthographic(-rt,rt,-rt,rt,it,(rt+u*k)/t[2]),tt=new Float64Array(16);wt.multiply(tt,ut,J);const dt=ct.fromValues(Math.floor(1e6*j[0])/1e6*g,Math.floor(1e6*j[1])/1e6*g,0),gt=.5*c,xt=[0,0,0];ct.transformMat4(xt,dt,tt),ct.scale(xt,xt,gt);const ht=[Math.floor(xt[0]),Math.floor(xt[1]),Math.floor(xt[2])],pt=[0,0,0];ct.sub(pt,xt,ht),ct.scale(pt,pt,-1/gt);const Et=new Float64Array(16);return wt.identity(Et),wt.translate(Et,Et,pt),wt.multiply(tt,Et,tt),[tt,rt]}class xX extends Mn{constructor(t){super(),this.requestManager=t,this.models={"":{}},this.numModelsLoading={}}loadModel(t,i){return $L(this.requestManager.transformRequest(i,zt.Model).url).then(o=>{if(!o)return;const c=_S(o),u=new BO(t,void 0,void 0,c);return u.computeBoundsAndApplyParent(),u}).catch(o=>{this.fire(new xe(new Error(`Could not load model ${t} from ${i}: ${o.message}`)))})}load(t,i){this.models[i]||(this.models[i]={});const o=Object.keys(t);this.numModelsLoading[i]=(this.numModelsLoading[i]||0)+o.length;const c=[];for(const u of o)c.push(this.loadModel(u,t[u]));Promise.allSettled(c).then(u=>{for(let d=0;d<u.length;d++){const{status:p,value:g}=u[d];p==="fulfilled"&&g&&(this.models[i][o[d]]=g)}this.numModelsLoading[i]-=o.length,this.fire(new Bt("data",{dataType:"style"}))}).catch(u=>{this.fire(new xe(new Error(`Could not load models: ${u.message}`)))})}isLoaded(){for(const t in this.numModelsLoading)if(this.numModelsLoading[t]>0)return!1;return!0}hasModel(t,i){return!!this.getModel(t,i)}getModel(t,i){return this.models[i]||(this.models[i]={}),this.models[i][t]}addModel(t,i,o){this.models[o]||(this.models[o]={}),this.hasModel(t,o)&&this.removeModel(t,o),this.load({[t]:this.requestManager.normalizeModelURL(i)},o)}addModels(t,i){const o={};for(const c in t)o[c]=this.requestManager.normalizeModelURL(t[c]);this.load(o,i)}removeModel(t,i){this.models[i]||(this.models[i]={});const o=this.models[i][t];delete this.models[i][t],o.destroy()}listModels(t){return this.models[t]||(this.models[t]={}),Object.keys(this.models[t])}upload(t,i){this.models[i]||(this.models[i]={});for(const o in this.models[i])this.models[i][o].upload(t.context)}}const Lp=(n,t)=>a_(n,t&&t.filter(i=>i.identifier!=="source.canvas")),bX=Ae(Dn,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection","setCamera","addImport","removeImport","setImportUrl","setImportData","setImportConfig"]),wX=Ae(Dn,["setCenter","setZoom","setBearing","setPitch"]),Y3={version:8,layers:[],sources:{}},K3={duration:300,delay:0},SX=new Set(["fill","line","background","hillshade","raster"]);class na extends Mn{constructor(t,i={}){super(),this.map=t,this.scope=i.scope||"",this.fragments=[],this.importDepth=i.importDepth||0,this.importsCache=i.importsCache||new Map,this.resolvedImports=i.resolvedImports||new Set,this.transition=Ct({},K3),this._buildingIndex=new Hq(this),this.crossTileSymbolIndex=new mZ,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=i.styleChanges||new s9,this.dispatcher=i.dispatcher?i.dispatcher:new Gu(Dp(),this),i.imageManager?this.imageManager=i.imageManager:(this.imageManager=new bq,this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=i.glyphManager?i.glyphManager:new vd(t._requestManager,i.localFontFamily?2:i.localIdeographFontFamily?1:0,i.localFontFamily||i.localIdeographFontFamily),i.modelManager?this.modelManager=i.modelManager:(this.modelManager=new xX(t._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this.options=new Map,this._configDependentLayers=new Set,this._config=i.config,this.dispatcher.broadcast("setReferrer",Yt());const o=this;this._rtlTextPluginCallback=na.registerForPluginStateChange(c=>{o.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:c.pluginStatus,pluginURL:c.pluginURL},(u,d)=>{if(KI(u),d&&d.every(p=>p))for(const p in o._sourceCaches){const g=o._sourceCaches[p],_=g.getSource().type;_!=="vector"&&_!=="geojson"||g.reload()}})}),this.on("data",c=>{if(c.dataType!=="source"||c.sourceDataType!=="metadata")return;const u=this.getOwnSource(c.sourceId);if(u&&u.vectorLayerIds)for(const d in this._layers){const p=this._layers[d];p.source===u.id&&this._validateLayer(p)}})}loadURL(t,i={}){this.fire(new Bt("dataloading",{dataType:"style"}));const o=typeof i.validate=="boolean"?i.validate:!kn(t);t=this.map._requestManager.normalizeStyleURL(t,i.accessToken),this.resolvedImports.add(t);const c=this.importsCache.get(t);if(c)return this._load(c,o);const u=this.map._requestManager.transformRequest(t,zt.Style);this._request=Kt(u,(d,p)=>{if(this._request=null,d)this.fire(new xe(d));else if(p)return this.importsCache.set(t,p),this._load(p,o)})}loadJSON(t,i={}){this.fire(new Bt("dataloading",{dataType:"style"})),this._request=Be.frame(()=>{this._request=null,this._load(t,i.validate!==!1)})}loadEmpty(){this.fire(new Bt("dataloading",{dataType:"style"})),this._load(Y3,!1)}_loadImports(t,i){if(this.importDepth>=4)return _t("Style doesn't support nesting deeper than 5"),Promise.resolve();const o=[];for(const c of t){const u=this._createFragmentStyle(c),d=new Promise(g=>{u.once("style.import.load",g),u.once("error",g)}).then(()=>this.mergeAll());if(o.push(d),this.resolvedImports.has(c.url)){u.loadEmpty();continue}const p=c.data||this.importsCache.get(c.url);p?u.loadJSON(p,{validate:i}):c.url?u.loadURL(c.url,{validate:i}):u.loadEmpty(),this.fragments.push({style:u,id:c.id,config:c.config})}return Promise.allSettled(o)}_createFragmentStyle(t){const i=this.scope?Xi(t.id,this.scope):t.id,o=new na(this.map,{scope:i,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:t.config});return o.setEventedParent(this.map,{style:o}),o}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options});const t=this.isRootStyle();this._shouldPrecompile=t,this.fire(new Bt(t?"style.load":"style.import.load"))}_load(t,i){const o=t.schema;if(this.isRootStyle()&&(t.fragment||o&&t.fragment!==!1)){const d=Ct({},Y3,{imports:[{id:"basemap",data:t,url:""}]});return void this._load(d,i)}if(this.setConfig(this._config,o),i&&Lp(this,td(t)))return;this._loaded=!0,this.stylesheet=ot(t);for(const d in t.sources)this.addSource(d,t.sources[d],{validate:!1,isInitialLoad:!0});t.sprite?this._loadSprite(t.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(t.glyphs,this.scope);const c=ZL(this.stylesheet.layers);if(this._order=c.map(d=>d.id),this.stylesheet.light&&_t("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const d=this.stylesheet.lights[0];this.light=new bL(d.properties,d.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new bL(this.stylesheet.light)),this._layers={},this._serializedLayers={};for(const d of c){const p=xy(d,this.options);p.setScope(this.scope),p.isConfigDependent&&this._configDependentLayers.add(p.fqid),p.setEventedParent(this,{layer:{id:p.id}}),this._layers[p.id]=p,this._serializedLayers[p.id]=p.serialize();const g=this.getOwnLayerSourceCache(p),_=!!this.directionalLight&&this.directionalLight.shadowsEnabled();g&&p.canCastShadows()&&_&&(g.castsShadows=!0)}this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const u=this.stylesheet.terrain;u&&(this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=Be.hasCanvasFingerprintNoise()),this.disableElevatedTerrain?_t("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."):this.terrainSetForDrapingOnly()||this._createTerrain(u,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new Bt("data",{dataType:"style"})),t.imports?this._loadImports(t.imports,i).then(()=>this._reloadImports()):this._reloadImports()}isRootStyle(){return this.importDepth===0}mergeAll(){let t,i,o,c,u,d,p,g;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(_=>{if(_.stylesheet){if(_.light!=null&&(t=_.light),_.stylesheet.lights)for(const v of _.stylesheet.lights)v.type==="ambient"&&_.ambientLight!=null&&(i=_.ambientLight),v.type==="directional"&&_.directionalLight!=null&&(o=_.directionalLight);c=this._prioritizeTerrain(c,_.terrain,_.stylesheet.terrain),_.stylesheet.fog&&_.fog!=null&&(u=_.fog),_.stylesheet.camera!=null&&(g=_.stylesheet.camera),_.stylesheet.projection!=null&&(d=_.stylesheet.projection),_.stylesheet.transition!=null&&(p=_.stylesheet.transition)}}),this.light=t,this.ambientLight=i,this.directionalLight=o,this.fog=u,c===null?delete this.terrain:this.terrain=c,this.camera=g||{"camera-projection":"perspective"},this.projection=d||{name:"mercator"},this.transition=Ct({},K3,p),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(t){const i=o=>{for(const c of o.fragments)i(c.style);t(o)};i(this)}_prioritizeTerrain(t,i,o){const c=t&&t.drapeRenderMode===0;return o===null?i&&i.drapeRenderMode===0?i:c?t:null:i!=null&&(!t||c||i&&i.drapeRenderMode===1)?i:t}mergeTerrain(){let t;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(i=>{t=this._prioritizeTerrain(t,i.terrain,i.stylesheet.terrain)}),t===null?delete this.terrain:this.terrain=t}mergeProjection(){let t;this.forEachFragmentStyle(i=>{i.stylesheet.projection!=null&&(t=i.stylesheet.projection)}),this.projection=t||{name:"mercator"}}mergeSources(){const t={},i={},o={};this.forEachFragmentStyle(c=>{for(const u in c._sourceCaches){const d=Xi(u,c.scope);t[d]=c._sourceCaches[u]}for(const u in c._otherSourceCaches){const d=Xi(u,c.scope);i[d]=c._otherSourceCaches[u]}for(const u in c._symbolSourceCaches){const d=Xi(u,c.scope);o[d]=c._symbolSourceCaches[u]}}),this._mergedSourceCaches=t,this._mergedOtherSourceCaches=i,this._mergedSymbolSourceCaches=o}mergeLayers(){const t={},i=[],o={};this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(u=>{for(const d of u._order){const p=u._layers[d];if(p.type==="slot"){const g=h_(d);if(t[g])continue;t[g]=[]}p.slot&&t[p.slot]?t[p.slot].push(p):i.push(p)}}),this._mergedOrder=[];const c=(u=[])=>{for(const d of u)if(d.type==="slot"){const p=h_(d.id);t[p]&&c(t[p])}else{const p=Xi(d.id,d.scope);this._mergedOrder.push(p),o[p]=d,d.is3D()&&(this._has3DLayers=!0),d.type==="circle"&&(this._hasCircleLayers=!0),d.type==="symbol"&&(this._hasSymbolLayers=!0)}};c(i),this._mergedLayers=o,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(t){return this.stylesheet.camera=Ct({},this.stylesheet.camera,t),this.camera=this.stylesheet.camera,this}setProjection(t){t?this.stylesheet.projection=t:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(t){this._spriteRequest=function(i,o,c){let u,d,p;const g=Be.devicePixelRatio>1?"@2x":"";let _=Kt(o.transformRequest(o.normalizeSpriteURL(i,g,".json"),zt.SpriteJSON),(S,E)=>{_=null,p||(p=S,u=E,b())}),v=Ye(o.transformRequest(o.normalizeSpriteURL(i,g,".png"),zt.SpriteImage),(S,E)=>{v=null,p||(p=S,d=E,b())});function b(){if(p)c(p);else if(u&&d){const S=Be.getImageData(d),E={};for(const A in u){const{width:C,height:P,x:k,y:L,sdf:j,pixelRatio:V,stretchX:F,stretchY:U,content:q}=u[A],Z=new Fr({width:C,height:P});Fr.copy(S,Z,{x:k,y:L},{x:0,y:0},{width:C,height:P}),E[A]={data:Z,pixelRatio:V,sdf:j,stretchX:F,stretchY:U,content:q}}c(null,E)}}return{cancel(){_&&(_.cancel(),_=null),v&&(v.cancel(),v=null)}}}(t,this.map._requestManager,(i,o)=>{if(this._spriteRequest=null,i)this.fire(new xe(i));else if(o)for(const c in o)this.imageManager.addImage(c,this.scope,o[c]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new Bt("data",{dataType:"style"}))})}_validateLayer(t){const i=this.getOwnSource(t.source);if(!i)return;const o=t.sourceLayer;o&&(i.type==="geojson"||i.vectorLayerIds&&i.vectorLayerIds.indexOf(o)===-1)&&this.fire(new xe(new Error(`Source layer "${o}" does not exist on source "${i.id}" as specified by style layer "${t.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const t in this._sourceCaches)if(!this._sourceCaches[t].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded())return!1;for(const{style:t}of this.fragments)if(!t.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((t,i)=>{const o=this.fragments[i];return o&&o.style&&(t.data=o.style.serialize()),t})}_serializeSources(){const t={};for(const i in this._sourceCaches){const o=this._sourceCaches[i].getSource();t[o.id]||(t[o.id]=o.serialize())}return t}_serializeLayers(t){const i=[];for(const o of t){const c=this._layers[o];c&&c.type!=="custom"&&i.push(c.serialize())}return i}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition())return!0;for(const t in this._sourceCaches)if(this._sourceCaches[t].hasTransition())return!0;for(const t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}isLayerDraped(t){return!!this.terrain&&(typeof t.isLayerDraped=="function"?t.isLayerDraped(this.getLayerSourceCache(t)):SX.has(t.type))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(t){const i=this.getOwnLayer(t);if(i)return i;this.fire(new xe(new Error(`The layer '${t}' does not exist in the map's style.`)))}_checkSource(t){const i=this.getOwnSource(t);if(i)return i;this.fire(new xe(new Error(`The source '${t}' does not exist in the map's style.`)))}update(t){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(t),this.directionalLight&&this.directionalLight.recalculate(t);const i=this.calculateLightsBrightness();t.brightness=i||0,i!==this._brightness&&(this._brightness=i,this.dispatcher.broadcast("setBrightness",i));const o=this._changes.isDirty();if(this._changes.isDirty()){const u=this._changes.getLayerUpdatesByScope();for(const d in u){const{updatedIds:p,removedIds:g}=u[d];(p||g)&&this._updateWorkerLayers(d,p,g)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(t),this.light&&this.light.updateTransitions(t),this.ambientLight&&this.ambientLight.updateTransitions(t),this.directionalLight&&this.directionalLight.updateTransitions(t),this.fog&&this.fog.updateTransitions(t),this._changes.reset()}const c={};for(const u in this._mergedSourceCaches){const d=this._mergedSourceCaches[u];c[u]=d.used,d.used=!1}for(const u of this._mergedOrder){const d=this._mergedLayers[u];if(d.recalculate(t,this._availableImages),!d.isHidden(t.zoom)){const p=this.getLayerSourceCache(d);p&&(p.used=!0)}if(!this._precompileDone&&this._shouldPrecompile)for(let p=d.minzoom||0;p<(d.maxzoom||25.5);p++){const g=this.map.painter;if(g){const _=d.getProgramIds();if(!_)continue;for(const v of _){const b=d.getDefaultProgramParams(v,t.zoom);b&&(g.style=this,this.fog&&(g._fogVisible=!0,b.overrideFog=!0,g.getOrCreateProgram(v,b)),g._fogVisible=!1,b.overrideFog=!1,g.getOrCreateProgram(v,b),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(b.overrideRtt=!0,g.getOrCreateProgram(v,b)))}}}}this._shouldPrecompile&&(this._precompileDone=!0);for(const u in c){const d=this._mergedSourceCaches[u];c[u]!==d.used&&d.getSource().fire(new Bt("data",{sourceDataType:"visibility",dataType:"source",sourceId:d.getSource().id}))}this.light&&this.light.recalculate(t),this.terrain&&this.terrain.recalculate(t),this.fog&&this.fog.recalculate(t),this.z=t.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),o&&this.fire(new Bt("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=this._changes.getUpdatedImages();if(t.length){for(const i in this._sourceCaches)this._sourceCaches[i].reloadTilesForDependencies(["icons","patterns"],t);this._changes.resetUpdatedImages()}}_updateWorkerLayers(t,i,o){const c=this.getFragmentStyle(t);c&&this.dispatcher.broadcast("updateLayers",{layers:i?c._serializeLayers(i):[],scope:t,removedIds:o||[],options:c.options})}setState(t){if(this._checkLoaded(),Lp(this,td(t)))return!1;(t=ot(t)).layers=ZL(t.layers);const i=function(c,u){if(!c)return[{command:Dn.setStyle,args:[u]}];let d=[];try{if(!Q(c.version,u.version))return[{command:Dn.setStyle,args:[u]}];Q(c.center,u.center)||d.push({command:Dn.setCenter,args:[u.center]}),Q(c.zoom,u.zoom)||d.push({command:Dn.setZoom,args:[u.zoom]}),Q(c.bearing,u.bearing)||d.push({command:Dn.setBearing,args:[u.bearing]}),Q(c.pitch,u.pitch)||d.push({command:Dn.setPitch,args:[u.pitch]}),Q(c.sprite,u.sprite)||d.push({command:Dn.setSprite,args:[u.sprite]}),Q(c.glyphs,u.glyphs)||d.push({command:Dn.setGlyphs,args:[u.glyphs]}),Q(c.imports,u.imports)||function(b=[],S=[],E){S=S||[];const A=(b=b||[]).map(Ey),C=S.map(Ey),P=b.reduce(My,{}),k=S.reduce(My,{}),L=A.slice();let j,V,F,U;for(j=0,V=0;j<A.length;j++)F=A[j],k.hasOwnProperty(F)?V++:(E.push({command:Dn.removeImport,args:[F]}),L.splice(L.indexOf(F,V),1));for(j=0,V=0;j<C.length;j++)F=C[C.length-1-j],L[L.length-1-j]!==F&&(P.hasOwnProperty(F)?(E.push({command:Dn.removeImport,args:[F]}),L.splice(L.lastIndexOf(F,L.length-V),1)):V++,U=L[L.length-j],E.push({command:Dn.addImport,args:[k[F],U]}),L.splice(L.length-j,0,F));for(const q of S){const Z=P[q.id];if(!Z||Q(Z,q))continue;Q(Z.config,q.config)||E.push({command:Dn.setImportConfig,args:[q.id,q.config]}),Q(Z.url,q.url)||E.push({command:Dn.setImportUrl,args:[q.id,q.url]});const X=q.data;Q(Z&&Z.data,X)||E.push({command:Dn.setImportData,args:[q.id,X]})}}(c.imports,u.imports,d),Q(c.transition,u.transition)||d.push({command:Dn.setTransition,args:[u.transition]}),Q(c.light,u.light)||d.push({command:Dn.setLight,args:[u.light]}),Q(c.fog,u.fog)||d.push({command:Dn.setFog,args:[u.fog]}),Q(c.projection,u.projection)||d.push({command:Dn.setProjection,args:[u.projection]}),Q(c.lights,u.lights)||d.push({command:Dn.setLights,args:[u.lights]}),Q(c.camera,u.camera)||d.push({command:Dn.setCamera,args:[u.camera]});const p={},g=[];(function(b,S,E,A){let C;for(C in S=S||{},b=b||{})b.hasOwnProperty(C)&&(S.hasOwnProperty(C)||YL(C,E,A));for(C in S){if(!S.hasOwnProperty(C))continue;const P=S[C];b.hasOwnProperty(C)?Q(b[C],P)||(b[C].type==="geojson"&&P.type==="geojson"&&Xq(b,S,C)?E.push({command:Dn.setGeoJSONSourceData,args:[C,P.data]}):Zq(C,S,E,A)):XL(C,S,E)}})(c.sources,u.sources,g,p);const _=[];c.layers&&c.layers.forEach(b=>{b.source&&p[b.source]?d.push({command:Dn.removeLayer,args:[b.id]}):_.push(b)});let v=c.terrain;v&&p[v.source]&&(d.push({command:Dn.setTerrain,args:[void 0]}),v=void 0),d=d.concat(g),Q(v,u.terrain)||d.push({command:Dn.setTerrain,args:[u.terrain]}),function(b,S,E){S=S||[];const A=(b=b||[]).map(Ey),C=S.map(Ey),P=b.reduce(My,{}),k=S.reduce(My,{}),L=A.slice(),j=Object.create(null);let V,F,U,q,Z,X,J;for(V=0,F=0;V<A.length;V++)U=A[V],k.hasOwnProperty(U)?F++:(E.push({command:Dn.removeLayer,args:[U]}),L.splice(L.indexOf(U,F),1));for(V=0,F=0;V<C.length;V++)U=C[C.length-1-V],L[L.length-1-V]!==U&&(P.hasOwnProperty(U)?(E.push({command:Dn.removeLayer,args:[U]}),L.splice(L.lastIndexOf(U,L.length-F),1)):F++,X=L[L.length-V],E.push({command:Dn.addLayer,args:[k[U],X]}),L.splice(L.length-V,0,U),j[U]=!0);for(V=0;V<C.length;V++)if(U=C[V],q=P[U],Z=k[U],!j[U]&&!Q(q,Z))if(Q(q.source,Z.source)&&Q(q["source-layer"],Z["source-layer"])&&Q(q.type,Z.type)){for(J in Ty(q.layout,Z.layout,E,U,null,Dn.setLayoutProperty),Ty(q.paint,Z.paint,E,U,null,Dn.setPaintProperty),Q(q.slot,Z.slot)||E.push({command:Dn.setSlot,args:[U,Z.slot]}),Q(q.filter,Z.filter)||E.push({command:Dn.setFilter,args:[U,Z.filter]}),Q(q.minzoom,Z.minzoom)&&Q(q.maxzoom,Z.maxzoom)||E.push({command:Dn.setLayerZoomRange,args:[U,Z.minzoom,Z.maxzoom]}),q)q.hasOwnProperty(J)&&J!=="layout"&&J!=="paint"&&J!=="filter"&&J!=="metadata"&&J!=="minzoom"&&J!=="maxzoom"&&J!=="slot"&&(J.indexOf("paint.")===0?Ty(q[J],Z[J],E,U,J.slice(6),Dn.setPaintProperty):Q(q[J],Z[J])||E.push({command:Dn.setLayerProperty,args:[U,J,Z[J]]}));for(J in Z)Z.hasOwnProperty(J)&&!q.hasOwnProperty(J)&&J!=="layout"&&J!=="paint"&&J!=="filter"&&J!=="metadata"&&J!=="minzoom"&&J!=="maxzoom"&&J!=="slot"&&(J.indexOf("paint.")===0?Ty(q[J],Z[J],E,U,J.slice(6),Dn.setPaintProperty):Q(q[J],Z[J])||E.push({command:Dn.setLayerProperty,args:[U,J,Z[J]]}))}else E.push({command:Dn.removeLayer,args:[U]}),X=L[L.lastIndexOf(U)+1],E.push({command:Dn.addLayer,args:[Z,X]})}(_,u.layers,d)}catch(p){console.warn("Unable to compute style diff:",p),d=[{command:Dn.setStyle,args:[u]}]}return d}(this.serialize(),t).filter(c=>!(c.command in wX));if(i.length===0)return!1;const o=i.filter(c=>!(c.command in bX));if(o.length>0)throw new Error(`Unimplemented: ${o.map(c=>c.command).join(", ")}.`);return i.forEach(c=>{this[c.command].apply(this,c.args)}),this.stylesheet=t,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(t,i){return this.getImage(t)?this.fire(new xe(new Error("An image with this name already exists."))):(this.imageManager.addImage(t,this.scope,i),this._afterImageUpdated(t),this)}updateImage(t,i){this.imageManager.updateImage(t,this.scope,i)}getImage(t){return this.imageManager.getImage(t,this.scope)}removeImage(t){return this.getImage(t)?(this.imageManager.removeImage(t,this.scope),this._afterImageUpdated(t),this):this.fire(new xe(new Error("No image with this name exists.")))}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(t),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new Bt("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(t,i,o={}){return this._checkLoaded(),this._validate(J7,`models.${t}`,i,null,o)||(this.modelManager.addModel(t,i,this.scope),this._changes.setDirty()),this}hasModel(t){return this.modelManager.hasModel(t,this.scope)}removeModel(t){return this.hasModel(t)?(this.modelManager.removeModel(t,this.scope),this):this.fire(new xe(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(t,i,o={}){if(this._checkLoaded(),this.getOwnSource(t)!==void 0)throw new Error(`There is already a source with ID "${t}".`);if(!i.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(i).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(i.type)>=0&&this._validate(G7,`sources.${t}`,i,null,o))return;this.map&&this.map._collectResourceTiming&&(i.collectResourceTiming=!0);const c=vS(t,i,this.dispatcher,this);c.scope=this.scope,c.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(c.id),source:c.serialize(),sourceId:c.id}));const u=d=>{const p=(d?"symbol:":"other:")+c.id,g=Xi(p,this.scope),_=this._sourceCaches[p]=new Qo(g,c,d);(d?this._symbolSourceCaches:this._otherSourceCaches)[c.id]=_,_.onAdd(this.map)};u(!1),i.type!=="vector"&&i.type!=="geojson"||u(!0),c.onAdd&&c.onAdd(this.map),o.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(t){this._checkLoaded();const i=this.getOwnSource(t);if(!i)throw new Error("There is no source with this ID");for(const c in this._layers)if(this._layers[c].source===t)return this.fire(new xe(new Error(`Source "${t}" cannot be removed while layer "${c}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===t)return this.fire(new xe(new Error(`Source "${t}" cannot be removed while terrain is using it.`)));const o=this.getOwnSourceCaches(t);for(const c of o){const u=h_(c.id);delete this._sourceCaches[u],this._changes.discardSourceCacheUpdate(c.id),c.fire(new Bt("data",{sourceDataType:"metadata",dataType:"source",sourceId:c.getSource().id})),c.setEventedParent(null),c.clearTiles()}return delete this._otherSourceCaches[t],delete this._symbolSourceCaches[t],this.mergeSources(),i.setEventedParent(null),i.onRemove&&i.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(t,i){this._checkLoaded(),this.getOwnSource(t).setData(i),this._changes.setDirty()}getOwnSource(t){const i=this.getOwnSourceCache(t);return i&&i.getSource()}getOwnSources(){const t=[];for(const i in this._otherSourceCaches){const o=this.getOwnSourceCache(i);o&&t.push(o.getSource())}return t}setLights(t){if(this._checkLoaded(),!t)return delete this.ambientLight,void delete this.directionalLight;const i=this._getTransitionParameters();for(const c of t){if(this._validate(H7,"lights",c))return;switch(c.type){case"ambient":if(this.ambientLight){const u=this.ambientLight;u.set(c),u.updateTransitions(i)}else this.ambientLight=new CL(c,Pq,this.scope,this.options);break;case"directional":if(this.directionalLight){const u=this.directionalLight;u.set(c),u.updateTransitions(i)}else this.directionalLight=new CL(c,Iq,this.scope,this.options)}}const o=new pr(this.z||0,i);this.ambientLight&&this.ambientLight.recalculate(o),this.directionalLight&&this.directionalLight.recalculate(o),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const t=this.directionalLight,i=this.ambientLight;if(!t||!i)return;const o=b=>.2126*(b[0]<=.03928?b[0]/12.92:Math.pow((b[0]+.055)/1.055,2.4))+.7152*(b[1]<=.03928?b[1]/12.92:Math.pow((b[1]+.055)/1.055,2.4))+.0722*(b[2]<=.03928?b[2]/12.92:Math.pow((b[2]+.055)/1.055,2.4)),c=t.properties.get("color").toArray01(),u=t.properties.get("intensity"),d=t.properties.get("direction"),p=1-Ee(d.x,d.y,d.z)[2]/90,g=o(c)*u*p,_=i.properties.get("color").toArray01(),v=i.properties.get("intensity");return(g+o(_)*v)/2}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const t=[];return this.directionalLight&&t.push(this.directionalLight.get()),this.ambientLight&&t.push(this.ambientLight.get()),t}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(t){if(!t)return this;if(ek(t)){const i=function(u){const d=u.indexOf(u_);return d>=0?u.slice(d+1):""}(t),o=this.fragments.find(({id:u})=>u===i);if(!o)throw new Error(`Style import not found: ${t}`);const c=h_(t);return o.style.getFragmentStyle(c)}{const i=this.fragments.find(({id:o})=>o===t);if(!i)throw new Error(`Style import not found: ${t}`);return i.style}}getConfigProperty(t,i){const o=this.getFragmentStyle(t);if(!o)return null;const c=o.options.get(i),u=c?c.value||c.default:null;return u?u.serialize():null}setConfigProperty(t,i,o){const c=tc(o);if(c.result!=="success")return void Lp(this,c.value);const u=c.value.expression,d=this.getFragmentStyle(t);if(!d)return;const p=d.options.get(i);p&&(d.options.set(i,{...p,value:u}),d.updateConfigDependencies())}setConfig(t,i){if(this._config=t,t||i)if(i){this.options.clear();for(const o in i){let c,u;const d=tc(i[o].default);if(d.result==="success"&&(c=d.value.expression),t&&t[o]!==void 0){const S=tc(t[o]);S.result==="success"&&(u=S.value.expression)}const{minValue:p,maxValue:g,stepValue:_,type:v,values:b}=i[o];c?this.options.set(o,{default:c,value:u,minValue:p,maxValue:g,stepValue:_,type:v,values:b}):this.fire(new xe(new Error(`No schema defined for config option "${o}".`)))}}else this.fire(new xe(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(){for(const t of this._configDependentLayers){const i=this.getLayer(t);i&&(i.possiblyEvaluateVisibility(),this._updateLayer(i))}this.ambientLight&&this.ambientLight.scope===this.scope&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.scope===this.scope&&this.directionalLight.updateConfig(this.options),this._changes.setDirty()}addLayer(t,i,o={}){this._checkLoaded();const c=t.id;if(this._layers[c])return void this.fire(new xe(new Error(`Layer with id "${c}" already exists on this map`)));let u;if(t.type==="custom"){if(Lp(this,function(v){const b=[],S=v.id;return S===void 0&&b.push({message:`layers.${S}: missing required property "id"`}),v.render===void 0&&b.push({message:`layers.${S}: missing required method "render"`}),v.renderingMode&&v.renderingMode!=="2d"&&v.renderingMode!=="3d"&&b.push({message:`layers.${S}: property "renderingMode" must be either "2d" or "3d"`}),b}(t)))return;u=xy(t,this.options)}else{if(typeof t.source=="object"&&(this.addSource(c,t.source),t=Ct(t=ot(t),{source:c})),this._validate(X7,`layers.${c}`,t,{arrayIndex:-1},o))return;u=xy(t,this.options),this._validateLayer(u),u.setEventedParent(this,{layer:{id:c}}),this._serializedLayers[u.id]=u.serialize()}u.isConfigDependent&&this._configDependentLayers.add(u.fqid),u.setScope(this.scope);let d=this._order.length;if(i){const v=this._order.indexOf(i);if(v===-1)return void this.fire(new xe(new Error(`Layer with id "${i}" does not exist on this map.`)));u.slot===this._layers[i].slot?d=v:_t(`Layer with id "${i}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(d,0,c),this._layerOrderChanged=!0,this._layers[c]=u;const p=this.getOwnLayerSourceCache(u),g=!!this.directionalLight&&this.directionalLight.shadowsEnabled();p&&u.canCastShadows()&&g&&(p.castsShadows=!0);const _=this._changes.getRemovedLayer(u);if(_&&u.source&&p&&u.type!=="custom"){this._changes.discardLayerRemoval(u);const v=Xi(u.source,u.scope);_.type!==u.type?this._changes.updateSourceCache(v,"clear"):(this._changes.updateSourceCache(v,"reload"),p.pause())}this._updateLayer(u),u.onAdd&&u.onAdd(this.map),u.scope=this.scope,this.mergeLayers()}moveLayer(t,i){this._checkLoaded();const o=this._checkLayer(t);if(!o||t===i)return;const c=this._order.indexOf(t);this._order.splice(c,1);let u=this._order.length;if(i){const d=this._order.indexOf(i);if(d===-1)return void this.fire(new xe(new Error(`Layer with id "${i}" does not exist on this map.`)));o.slot===this._layers[i].slot?u=d:_t(`Layer with id "${i}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(u,0,t),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(t){this._checkLoaded();const i=this._checkLayer(t);if(!i)return;i.setEventedParent(null);const o=this._order.indexOf(t);this._order.splice(o,1),delete this._layers[t],delete this._serializedLayers[t],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(i.fqid),this._changes.removeLayer(i);const c=this.getOwnLayerSourceCache(i);if(c&&c.castsShadows){let u=!1;for(const d in this._layers)if(this._layers[d].source===i.source&&this._layers[d].canCastShadows()){u=!0;break}c.castsShadows=u}i.onRemove&&i.onRemove(this.map),this.mergeLayers()}getOwnLayer(t){return this._layers[t]}hasLayer(t){return t in this._mergedLayers}hasLayerType(t){for(const i in this._layers)if(this._layers[i].type===t)return!0;return!1}setLayerZoomRange(t,i,o){this._checkLoaded();const c=this._checkLayer(t);c&&(c.minzoom===i&&c.maxzoom===o||(i!=null&&(c.minzoom=i),o!=null&&(c.maxzoom=o),this._updateLayer(c)))}setSlot(t,i){this._checkLoaded();const o=this._checkLayer(t);o&&o.slot!==i&&(o.slot=i,this._updateLayer(o))}setFilter(t,i,o={}){this._checkLoaded();const c=this._checkLayer(t);if(c&&!Q(c.filter,i))return i==null?(c.filter=void 0,void this._updateLayer(c)):void(this._validate(fb,`layers.${c.id}.filter`,i,{layerType:c.type},o)||(c.filter=ot(i),this._updateLayer(c)))}getFilter(t){const i=this._checkLayer(t);if(i)return ot(i.filter)}setLayoutProperty(t,i,o,c={}){this._checkLoaded();const u=this._checkLayer(t);u&&(Q(u.getLayoutProperty(i),o)||(u.setLayoutProperty(i,o,c),u.isConfigDependent&&this._configDependentLayers.add(u.fqid),this._updateLayer(u)))}getLayoutProperty(t,i){const o=this._checkLayer(t);if(o)return o.getLayoutProperty(i)}setPaintProperty(t,i,o,c={}){this._checkLoaded();const u=this._checkLayer(t);if(!u||Q(u.getPaintProperty(i),o))return;const d=u.setPaintProperty(i,o,c);u.isConfigDependent&&this._configDependentLayers.add(u.fqid),d&&this._updateLayer(u),this._changes.updatePaintProperties(u)}getPaintProperty(t,i){const o=this._checkLayer(t);if(o)return o.getPaintProperty(i)}setFeatureState(t,i){this._checkLoaded();const o=t.source,c=t.sourceLayer,u=this._checkSource(o);if(!u)return;const d=u.type;if(d==="geojson"&&c)return void this.fire(new xe(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(d==="vector"&&!c)return void this.fire(new xe(new Error("The sourceLayer parameter must be provided for vector source types.")));t.id===void 0&&this.fire(new xe(new Error("The feature id parameter must be provided.")));const p=this.getOwnSourceCaches(o);for(const g of p)g.setFeatureState(c,t.id,i)}removeFeatureState(t,i){this._checkLoaded();const o=t.source,c=this._checkSource(o);if(!c)return;const u=c.type,d=u==="vector"?t.sourceLayer:void 0;if(u==="vector"&&!d)return void this.fire(new xe(new Error("The sourceLayer parameter must be provided for vector source types.")));if(i&&typeof t.id!="string"&&typeof t.id!="number")return void this.fire(new xe(new Error("A feature id is required to remove its specific state property.")));const p=this.getOwnSourceCaches(o);for(const g of p)g.removeFeatureState(d,t.id,i)}getFeatureState(t){this._checkLoaded();const i=t.source,o=t.sourceLayer,c=this._checkSource(i);if(c){if(c.type!=="vector"||o)return t.id===void 0&&this.fire(new xe(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(i)[0].getFeatureState(o,t.id);this.fire(new xe(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(t){return this.stylesheet.transition=Ct({},this.stylesheet.transition,t),this.transition=this.stylesheet.transition,this}getTransition(){return Ct({},this.stylesheet.transition)}serialize(){this._checkLoaded();const t=this.getTerrain(),i=t&&this.terrain&&this.terrain.scope===this.scope?t:this.stylesheet.terrain;return Qt({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:i,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},o=>o!==void 0)}_updateLayer(t){this._changes.updateLayer(t);const i=this.getLayerSourceCache(t),o=Xi(t.source,t.scope),c=this._changes.getUpdatedSourceCaches();t.source&&!c[o]&&i&&i.getSource().type!=="raster"&&(this._changes.updateSourceCache(o,"reload"),i.pause()),t.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(t){const i=p=>this._mergedLayers[p].type==="fill-extrusion",o=this.order,c={},u=[];for(let p=o.length-1;p>=0;p--){const g=o[p];if(i(g)){c[g]=p;for(const _ of t){const v=_[g];if(v)for(const b of v)u.push(b)}}}u.sort((p,g)=>g.intersectionZ-p.intersectionZ);const d=[];for(let p=o.length-1;p>=0;p--){const g=o[p];if(i(g))for(let _=u.length-1;_>=0;_--){const v=u[_].feature;if(c[v.layer.id]<p)break;d.push(v),u.pop()}else for(const _ of t){const v=_[g];if(v)for(const b of v)d.push(b.feature)}}return d}queryRenderedFeatures(t,i,o){i&&i.filter&&this._validate(fb,"queryRenderedFeatures.filter",i.filter,null,i),i.scope=this.scope,i.availableImages=this._availableImages,i.serializedLayers=this._serializedLayers;const c={};if(i&&i.layers){if(!Array.isArray(i.layers))return this.fire(new xe(new Error("parameters.layers must be an Array."))),[];for(const _ of i.layers){const v=this._mergedLayers[_];if(!v)return this.fire(new xe(new Error(`The layer '${_}' does not exist in the map's style and cannot be queried for features.`))),[];c[v.source]=!0}}const u=[],d=i.serializedLayers||{},p=i&&i.layers?i.layers.some(_=>{const v=this.getLayer(_);return v&&v.is3D()}):this.has3DLayers(),g=iS.createFromScreenPoints(t,o);for(const _ in this._mergedSourceCaches){const v=this._mergedSourceCaches[_].getSource();if(!v||v.scope!==i.scope)continue;const b=this._mergedSourceCaches[_].getSource().id;i.layers&&!c[b]||u.push(Gq(this._mergedSourceCaches[_],this._mergedLayers,d,g,i,o,p,!!this.map._showQueryGeometry))}return this.placement&&u.push(function(_,v,b,S,E,A,C){const P={},k=A.queryRenderedSymbols(S),L=[];for(const j of Object.keys(k).map(Number))L.push(C[j]);L.sort(HL);for(const j of L){const V=j.featureIndex.lookupSymbolFeatures(k[j.bucketInstanceId],v,j.bucketIndex,j.sourceLayerIndex,E.filter,E.layers,E.availableImages,_);for(const F in V){const U=P[F]=P[F]||[],q=V[F];q.sort((Z,X)=>{const J=j.featureSortOrder;if(J){const rt=J.indexOf(Z.featureIndex);return J.indexOf(X.featureIndex)-rt}return X.featureIndex-Z.featureIndex});for(const Z of q)U.push(Z)}}for(const j in P)P[j].forEach(V=>{const F=V.feature,U=b(_[j]);if(!U)return;const q=U.getFeatureState(F.layer["source-layer"],F.id);F.source=F.layer.source,F.layer["source-layer"]&&(F.sourceLayer=F.layer["source-layer"]),F.state=q});return P}(this._mergedLayers,d,this.getLayerSourceCache.bind(this),g.screenGeometry,i,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(u)}querySourceFeatures(t,i){i&&i.filter&&this._validate(fb,"querySourceFeatures.filter",i.filter,null,i);const o=this.getOwnSourceCaches(t);let c=[];for(const u of o)c=c.concat(Wq(u,i));return c}addSourceType(t,i,o){return na.getSourceType(t)?o(new Error(`A source type called "${t}" already exists.`)):(na.setSourceType(t,i),i.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:i.workerSourceURL},o):o(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(t,i,o={}){this._checkLoaded();const c=this.light.getLight();let u=!1;for(const p in t)if(!Q(t[p],c[p])){u=!0;break}if(!u)return;const d=this._getTransitionParameters();this.light.setLight(t,i,o),this.light.updateTransitions(d)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(t,i=1){if(this._checkLoaded(),!t)return delete this.terrain,t===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let o=t;const c=t.source==null;if(i===1){if(typeof o.source=="object"){const p="terrain-dem-src";this.addSource(p,o.source),o=ot(o),o=Ct(o,{source:p})}const u=Ct({},o),d={};if(this.terrain&&c){u.source=this.terrain.get().source;const p=this.terrain?this.getFragmentStyle(this.terrain.scope):null;p&&(d.style=p.serialize())}if(this._validate(q7,"terrain",u,d))return}if(!this.terrain||this.terrain.scope!==this.scope&&!c||this.terrain&&i!==this.terrain.drapeRenderMode){if(!o)return;this._createTerrain(o,i),this.fire(new Bt("data",{dataType:"style"}))}else{const u=this.terrain,d=u.get();for(const p of Object.keys(vt.terrain))!o.hasOwnProperty(p)&&vt.terrain[p].default&&(o[p]=vt.terrain[p].default);for(const p in t)if(!Q(t[p],d[p])){u.set(t,this.options),this.stylesheet.terrain=t;const g=this._getTransitionParameters({duration:0});u.updateTransitions(g),this.fire(new Bt("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(t){const i=this.fog=new Mq(t,this.map.transform);this.stylesheet.fog=i.get();const o=this._getTransitionParameters({duration:0});i.updateTransitions(o)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const t of this.map._markers)t._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(t){if(this._checkLoaded(),!t)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const i=this.fog;if(!Q(i.get(),t)){i.set(t),this.stylesheet.fog=i.get();const o=this._getTransitionParameters({duration:0});i.updateTransitions(o)}}else this._createFog(t);this._markersNeedUpdate=!0}_getTransitionParameters(t){return{now:Be.now(),transition:Ct(this.transition,t)}}updateDrapeFirstLayers(){if(!this.terrain)return;const t=[],i=[];for(const o in this._mergedLayers)this.isLayerDraped(this._mergedLayers[o])?t.push(o):i.push(o);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...t),this._drapedFirstOrder.push(...i)}_createTerrain(t,i){const o=this.terrain=new Tq(t,i,this.scope,this.options);i===1&&(this.stylesheet.terrain=t),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const c=this._getTransitionParameters({duration:0});o.updateTransitions(c)}_force3DLayerUpdate(){for(const t in this._layers){const i=this._layers[t];i.type==="fill-extrusion"&&this._updateLayer(i)}}_forceSymbolLayerUpdate(){for(const t in this._layers){const i=this._layers[t];i.type==="symbol"&&this._updateLayer(i)}}_validate(t,i,o,c,u={}){if(u&&u.validate===!1)return!1;const d=Ct({},this.serialize());return Lp(this,t.call(td,Ct({key:i,style:d,value:o,styleSpec:vt},c)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),bb.off("pluginStateChange",this._rtlTextPluginCallback);for(const t in this._mergedLayers)this._mergedLayers[t].setEventedParent(null);for(const t in this._mergedSourceCaches)this._mergedSourceCaches[t].clearTiles(),this._mergedSourceCaches[t].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(t){const i=this.getSourceCaches(t);for(const o of i)o.clearTiles()}clearSources(){for(const t in this._mergedSourceCaches)this._mergedSourceCaches[t].clearTiles()}reloadSource(t){const i=this.getSourceCaches(t);for(const o of i)o.resume(),o.reload()}reloadSources(){for(const t of this.getSources())t.reload&&t.reload()}updateSources(t){let i;this.directionalLight&&(i=X3(this.directionalLight));for(const o in this._mergedSourceCaches)this._mergedSourceCaches[o].update(t,void 0,void 0,i)}_generateCollisionBoxes(){for(const t in this._sourceCaches){const i=this._sourceCaches[t];i.resume(),i.reload()}}_updatePlacement(t,i,o,c,u=!1){let d=!1,p=!1;const g={},_={};for(const v of this._mergedOrder){const b=this._mergedLayers[v];if(b.type!=="symbol")continue;const S=Xi(b.source,b.scope);let E=g[S];if(!E){const C=this.getLayerSourceCache(b);if(!C)continue;const P=C.getRenderableIds(!0).map(k=>C.getTileByID(k));_[S]=P.slice(),E=g[S]=P.sort((k,L)=>L.tileID.overscaledZ-k.tileID.overscaledZ||(k.tileID.isLessThan(L.tileID)?-1:1))}const A=this.crossTileSymbolIndex.addLayer(b,E,t.center.lng,t.projection);d=d||A}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),u=u||this._layerOrderChanged||o===0,this._layerOrderChanged&&this.fire(new Bt("neworder")),(u||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(Be.now(),t.zoom))&&(this.pauseablePlacement=new hZ(t,this._mergedOrder,u,i,o,c,this.placement,this.fog&&t.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,g,_),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(Be.now()),p=!0),d&&this.pauseablePlacement.placement.setStale()),p||d)for(const v of this._mergedOrder){const b=this._mergedLayers[v];b.type==="symbol"&&this.placement.updateLayerOpacities(b,g[Xi(b.source,b.scope)])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(Be.now())}_releaseSymbolFadeTiles(){for(const t in this._sourceCaches)this._sourceCaches[t].releaseSymbolFadeTiles()}addImport(t){this._checkLoaded();const i=this.stylesheet.imports=this.stylesheet.imports||[];return i.findIndex(({id:c})=>c===t.id)!==-1?this.fire(new xe(new Error(`Import with id '${t.id}' already exists in the map's style.`))):(i.push(t),this._loadImports([t],!0),this)}setImportUrl(t,i){this._checkLoaded();const o=this.stylesheet.imports||[],c=this.getImportIndex(t);if(c===-1)return this;o[c].url=i;const u=this.fragments[c];return u.style=this._createFragmentStyle(o[c]),u.style.on("style.import.load",()=>this.mergeAll()),u.style.loadURL(i),this}setImportData(t,i){this._checkLoaded();const o=this.getImportIndex(t),c=this.stylesheet.imports||[];return o===-1?this:i?(this.fragments[o].style.setState(i),this._reloadImports(),this):(delete c[o].data,this.setImportUrl(t,c[o].url))}setImportConfig(t,i){this._checkLoaded();const o=this.getImportIndex(t),c=this.stylesheet.imports||[];if(o===-1)return this;i?c[o].config=i:delete c[o].config;const u=this.fragments[o],d=u.style.stylesheet&&u.style.stylesheet.schema;return u.config=i,u.style.setConfig(i,d),u.style.updateConfigDependencies(),this}removeImport(t){this._checkLoaded();const i=this.stylesheet.imports||[],o=this.getImportIndex(t);return o===-1||(i.splice(o,1),this.fragments[o].style._remove(),this.fragments.splice(o,1),this._reloadImports()),this}getImportIndex(t){const i=(this.stylesheet.imports||[]).findIndex(o=>o.id===t);return i===-1&&this.fire(new xe(new Error(`Import '${t}' does not exist in the map's style and cannot be updated.`))),i}getLayer(t){return this._mergedLayers[t]}getSources(){const t=[];for(const i in this._mergedOtherSourceCaches){const o=this._mergedOtherSourceCaches[i];o&&t.push(o.getSource())}return t}getSource(t,i){const o=this.getSourceCache(t,i);return o&&o.getSource()}getLayerSource(t){const i=this.getLayerSourceCache(t);return i&&i.getSource()}getSourceCache(t,i){const o=Xi(t,i);return this._mergedOtherSourceCaches[o]}getLayerSourceCache(t){const i=Xi(t.source,t.scope);return t.type==="symbol"?this._mergedSymbolSourceCaches[i]:this._mergedOtherSourceCaches[i]}getSourceCaches(t){const i=[];return this._mergedOtherSourceCaches[t]&&i.push(this._mergedOtherSourceCaches[t]),this._mergedSymbolSourceCaches[t]&&i.push(this._mergedSymbolSourceCaches[t]),i}updateSourceCaches(){const t=this._changes.getUpdatedSourceCaches();for(const i in t){const o=t[i];o==="reload"?this.reloadSource(i):o==="clear"&&this.clearSource(i)}}updateLayers(t){const i=this._changes.getUpdatedPaintProperties();for(const o of i){const c=this.getLayer(o);c&&c.updateTransitions(t)}}getImages(t,i,o){this.imageManager.getImages(i.icons,i.scope,o),this._updateTilesForChangedImages();const c=u=>{u&&u.setDependencies(i.tileID.key,i.type,i.icons)};c(this._otherSourceCaches[i.source]),c(this._symbolSourceCaches[i.source])}getGlyphs(t,i,o){this.glyphManager.getGlyphs(i.stacks,i.scope,o)}getResource(t,i,o){return ne(i,o)}getOwnSourceCache(t){return this._otherSourceCaches[t]}getOwnLayerSourceCache(t){return t.type==="symbol"?this._symbolSourceCaches[t.source]:this._otherSourceCaches[t.source]}getOwnSourceCaches(t){const i=[];return this._otherSourceCaches[t]&&i.push(this._otherSourceCaches[t]),this._symbolSourceCaches[t]&&i.push(this._symbolSourceCaches[t]),i}_isSourceCacheLoaded(t){const i=this.getOwnSourceCaches(t);return i.length===0?(this.fire(new xe(new Error(`There is no source with ID '${t}'`))),!1):i.every(o=>o.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}function J3(n,t){let i=!1,o=null;const c=()=>{o=null,i&&(n(),o=setTimeout(c,t),i=!1)};return()=>(i=!0,o||c(),o)}na.getSourceType=function(n){return yS[n]},na.setSourceType=function(n,t){yS[n]=t},na.registerForPluginStateChange=function(n){return n({pluginStatus:ks,pluginURL:rc}),bb.on("pluginStateChange",n),n};class TX{constructor(t){this._hashName=t&&encodeURIComponent(t),Ne(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=J3(this._updateHashUnthrottled.bind(this),300)}addTo(t){return this._map=t,w.addEventListener("hashchange",this._onHashChange,!1),t.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),w.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const t=this._map;if(!t)return"";const i=Q3(t);if(this._hashName){const o=this._hashName;let c=!1;const u=w.location.hash.slice(1).split("&").map(d=>{const p=d.split("=")[0];return p===o?(c=!0,`${p}=${i}`):d}).filter(d=>d);return c||u.push(`${o}=${i}`),`#${u.join("&")}`}return`#${i}`}_getCurrentHash(){const t=w.location.hash.replace("#","");if(this._hashName){let i;return t.split("&").map(o=>o.split("=")).forEach(o=>{o[0]===this._hashName&&(i=o)}),(i&&i[1]||"").split("/")}return t.split("/")}_onHashChange(){const t=this._map;if(!t)return!1;const i=this._getCurrentHash();if(i.length>=3&&!i.some(o=>isNaN(o))){const o=t.dragRotate.isEnabled()&&t.touchZoomRotate.isEnabled()?+(i[3]||0):t.getBearing();return t.jumpTo({center:[+i[2],+i[1]],zoom:+i[0],bearing:o,pitch:+(i[4]||0)}),!0}return!1}_updateHashUnthrottled(){const t=w.location.href.replace(/(#.+)?$/,this.getHashString());w.history.replaceState(w.history.state,null,t)}}function Q3(n,t){const i=n.getCenter(),o=Math.round(100*n.getZoom())/100,c=Math.ceil((o*Math.LN2+Math.log(512/360/.5))/Math.LN10),u=Math.pow(10,c),d=Math.round(i.lng*u)/u,p=Math.round(i.lat*u)/u,g=n.getBearing(),_=n.getPitch();let v=t?`/${d}/${p}/${o}`:`${o}/${p}/${d}`;return(g||_)&&(v+="/"+Math.round(10*g)/10),_&&(v+=`/${Math.round(_)}`),v}const Fy={linearity:.3,easing:ee(0,0,.3,1)},EX=Ct({deceleration:2500,maxSpeed:1400},Fy),MX=Ct({deceleration:20,maxSpeed:1400},Fy),AX=Ct({deceleration:1e3,maxSpeed:360},Fy),CX=Ct({deceleration:1e3,maxSpeed:90},Fy);class PX{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:Be.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,i=Be.now();for(;t.length>0&&i-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const i={zoom:0,bearing:0,pitch:0,pan:new W(0,0),pinchAround:void 0,around:void 0};for(const{settings:u}of this._inertiaBuffer)i.zoom+=u.zoomDelta||0,i.bearing+=u.bearingDelta||0,i.pitch+=u.pitchDelta||0,u.panDelta&&i.pan._add(u.panDelta),u.around&&(i.around=u.around),u.pinchAround&&(i.pinchAround=u.pinchAround);const o=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,c={};if(i.pan.mag()){const u=jy(i.pan.mag(),o,Ct({},EX,t||{}));c.offset=i.pan.mult(u.amount/i.pan.mag()),c.center=this._map.transform.center,By(c,u)}if(i.zoom){const u=jy(i.zoom,o,MX);c.zoom=this._map.transform.zoom+u.amount,By(c,u)}if(i.bearing){const u=jy(i.bearing,o,AX);c.bearing=this._map.transform.bearing+Ot(u.amount,-179,179),By(c,u)}if(i.pitch){const u=jy(i.pitch,o,CX);c.pitch=this._map.transform.pitch+u.amount,By(c,u)}if(c.zoom||c.bearing){const u=i.pinchAround===void 0?i.around:i.pinchAround;c.around=u?this._map.unproject(u):this._map.getCenter()}return this.clear(),c.noMoveStart=!0,c}}function By(n,t){(!n.duration||n.duration<t.duration)&&(n.duration=t.duration,n.easing=t.easing)}function jy(n,t,i){const{maxSpeed:o,linearity:c,deceleration:u}=i,d=Ot(n*c/(t/1e3),-o,o),p=Math.abs(d)/(u*c);return{easing:i.easing,duration:1e3*p,amount:d*(p/2)}}class ro extends Bt{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,i,o,c={}){const u=Ps(i.getCanvasContainer(),o);super(t,Ct({point:u,lngLat:i.unproject(u),originalEvent:o},c)),this._defaultPrevented=!1,this.target=i}}class Vy extends Bt{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,i,o){const c=t==="touchend"?o.changedTouches:o.touches,u=tl(i.getCanvasContainer(),c),d=u.map(g=>i.unproject(g)),p=u.reduce((g,_,v,b)=>g.add(_.div(b.length)),new W(0,0));super(t,{points:u,point:p,lngLats:d,lngLat:i.unproject(p),originalEvent:o}),this._defaultPrevented=!1}}class IX extends Bt{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,i,o){super(t,{originalEvent:o}),this._defaultPrevented=!1}}class kX{constructor(t,i){this._map=t,this._clickTolerance=i.clickTolerance}reset(){this._mousedownPos=void 0}wheel(t){return this._firePreventable(new IX(t.type,this._map,t))}mousedown(t,i){return this._mousedownPos=i,this._firePreventable(new ro(t.type,this._map,t))}mouseup(t){this._map.fire(new ro(t.type,this._map,t))}preclick(t){const i=Ct({},t);i.type="preclick",this._map.fire(new ro(i.type,this._map,i))}click(t,i){this._mousedownPos&&this._mousedownPos.dist(i)>=this._clickTolerance||(this.preclick(t),this._map.fire(new ro(t.type,this._map,t)))}dblclick(t){return this._firePreventable(new ro(t.type,this._map,t))}mouseover(t){this._map.fire(new ro(t.type,this._map,t))}mouseout(t){this._map.fire(new ro(t.type,this._map,t))}touchstart(t){return this._firePreventable(new Vy(t.type,this._map,t))}touchmove(t){this._map.fire(new Vy(t.type,this._map,t))}touchend(t){this._map.fire(new Vy(t.type,this._map,t))}touchcancel(t){this._map.fire(new Vy(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class DX{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(t){this._map.fire(new ro(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ro("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._map.fire(new ro(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class RX{constructor(t,i){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=i.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,i){this.isEnabled()&&t.shiftKey&&t.button===0&&(Uh(),this._startPos=this._lastPos=i,this._active=!0)}mousemoveWindow(t,i){if(!this._active)return;const o=i,c=this._startPos,u=this._lastPos;if(!c||!u||u.equals(o)||!this._box&&o.dist(c)<this._clickTolerance)return;this._lastPos=o,this._box||(this._box=Nn("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));const d=Math.min(c.x,o.x),p=Math.max(c.x,o.x),g=Math.min(c.y,o.y),_=Math.max(c.y,o.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${d}px,${g}px)`,this._box.style.width=p-d+"px",this._box.style.height=_-g+"px")})}mouseupWindow(t,i){if(!this._active)return;const o=this._startPos,c=i;if(o&&t.button===0){if(this.reset(),xa(),o.x!==c.x||o.y!==c.y)return this._map.fire(new Bt("boxzoomend",{originalEvent:t})),{cameraAnimation:u=>u.fitScreenCoordinates(o,c,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",t)}}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),$h(),delete this._startPos,delete this._lastPos}_fireEvent(t,i){return this._map.fire(new Bt(t,{originalEvent:i}))}}function RS(n,t){const i={};for(let o=0;o<n.length;o++)i[n[o].identifier]=t[o];return i}class OX{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(t,i,o){(this.centroid||o.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=t.timeStamp),o.length===this.numTouches&&(this.centroid=function(c){const u=new W(0,0);for(const d of c)u._add(d);return u.div(c.length)}(i),this.touches=RS(o,i)))}touchmove(t,i,o){if(this.aborted||!this.centroid)return;const c=RS(o,i);for(const u in this.touches){const d=c[u];(!d||d.dist(this.touches[u])>30)&&(this.aborted=!0)}}touchend(t,i,o){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),o.length===0){const c=!this.aborted&&this.centroid;if(this.reset(),c)return c}}}class OS{constructor(t){this.singleTap=new OX(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(t,i,o){this.singleTap.touchstart(t,i,o)}touchmove(t,i,o){this.singleTap.touchmove(t,i,o)}touchend(t,i,o){const c=this.singleTap.touchend(t,i,o);if(c){const u=t.timeStamp-this.lastTime<500,d=!this.lastTap||this.lastTap.dist(c)<30;if(u&&d||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=c,this.count===this.numTaps)return this.reset(),c}}}class LX{constructor(){this._zoomIn=new OS({numTouches:1,numTaps:2}),this._zoomOut=new OS({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,i,o){this._zoomIn.touchstart(t,i,o),this._zoomOut.touchstart(t,i,o)}touchmove(t,i,o){this._zoomIn.touchmove(t,i,o),this._zoomOut.touchmove(t,i,o)}touchend(t,i,o){const c=this._zoomIn.touchend(t,i,o),u=this._zoomOut.touchend(t,i,o);return c?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:d=>d.easeTo({duration:300,zoom:d.getZoom()+1,around:d.unproject(c)},{originalEvent:t})}):u?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:d=>d.easeTo({duration:300,zoom:d.getZoom()-1,around:d.unproject(u)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const zX={0:1,2:2};class LS{constructor(t){this.reset(),this._clickTolerance=t.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(t,i){return!1}_move(t,i){return{}}mousedown(t,i){if(this._lastPoint)return;const o=Gh(t);this._correctButton(t,o)&&(this._lastPoint=i,this._eventButton=o)}mousemoveWindow(t,i){const o=this._lastPoint;if(o){if(t.preventDefault(),this._eventButton!=null&&function(c,u){const d=zX[u];return c.buttons===void 0||(c.buttons&d)!==d}(t,this._eventButton))this.reset();else if(this._moved||!(i.dist(o)<this._clickTolerance))return this._moved=!0,this._lastPoint=i,this._move(o,i)}}mouseupWindow(t){this._lastPoint&&Gh(t)===this._eventButton&&(this._moved&&xa(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class NX extends LS{mousedown(t,i){super.mousedown(t,i),this._lastPoint&&(this._active=!0)}_correctButton(t,i){return i===0&&!t.ctrlKey}_move(t,i){return{around:i,panDelta:i.sub(t)}}}class tz extends LS{_correctButton(t,i){return i===0&&t.ctrlKey||i===2}_move(t,i){const o=.8*(i.x-t.x);if(o)return this._active=!0,{bearingDelta:o}}contextmenu(t){t.preventDefault()}}class ez extends LS{_correctButton(t,i){return i===0&&t.ctrlKey||i===2}_move(t,i){const o=-.5*(i.y-t.y);if(o)return this._active=!0,{pitchDelta:o}}contextmenu(t){t.preventDefault()}}class FX{constructor(t,i){this._map=t,this._el=t.getCanvasContainer(),this._minTouches=1,this._clickTolerance=i.clickTolerance||1,this.reset(),Ne(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new W(0,0)}touchstart(t,i,o){return this._calculateTransform(t,i,o)}touchmove(t,i,o){if(this._active&&!(o.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(o.length===1&&!$e())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return t.cancelable&&t.preventDefault(),this._calculateTransform(t,i,o)}}touchend(t,i,o){this._calculateTransform(t,i,o),this._active&&o.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,i,o){o.length>0&&(this._active=!0);const c=RS(o,i),u=new W(0,0),d=new W(0,0);let p=0;for(const _ in c){const v=c[_],b=this._touches[_];b&&(u._add(v),d._add(v.sub(b)),p++,c[_]=v)}if(this._touches=c,p<this._minTouches||!d.mag())return;const g=d.div(p);return this._sum._add(g),this._sum.mag()<this._clickTolerance?void 0:{around:u.div(p),panDelta:g}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Nn("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class zS{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(t){}_move(t,i,o){return{}}touchstart(t,i,o){this._firstTwoTouches||o.length<2||(this._firstTwoTouches=[o[0].identifier,o[1].identifier],this._start([i[0],i[1]]))}touchmove(t,i,o){const c=this._firstTwoTouches;if(!c)return;t.preventDefault();const[u,d]=c,p=Uy(o,i,u),g=Uy(o,i,d);if(!p||!g)return;const _=this._aroundCenter?null:p.add(g).div(2);return this._move([p,g],_,t)}touchend(t,i,o){if(!this._firstTwoTouches)return;const[c,u]=this._firstTwoTouches,d=Uy(o,i,c),p=Uy(o,i,u);d&&p||(this._active&&xa(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Uy(n,t,i){for(let o=0;o<n.length;o++)if(n[o].identifier===i)return t[o]}function nz(n,t){return Math.log(n/t)/Math.LN2}class BX extends zS{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,i){const o=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(nz(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:nz(this._distance,o),pinchAround:i}}}function rz(n,t){return 180*n.angleWith(t)/Math.PI}class jX extends zS{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,i){const o=this._vector;if(this._vector=t[0].sub(t[1]),o&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:rz(this._vector,o),pinchAround:i}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const i=25/(Math.PI*this._minDiameter)*360,o=this._startVector;if(!o)return!1;const c=rz(t,o);return Math.abs(c)<i}}function NS(n){return Math.abs(n.y)>Math.abs(n.x)}class VX extends zS{constructor(t){super(),this._map=t}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(t){this._lastPoints=t,NS(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,i,o){const c=this._lastPoints;if(!c)return;const u=t[0].sub(c[0]),d=t[1].sub(c[1]);return this._map._cooperativeGestures&&!$e()&&o.touches.length<3||(this._valid=this.gestureBeginsVertically(u,d,o.timeStamp),!this._valid)?void 0:(this._lastPoints=t,this._active=!0,{pitchDelta:(u.y+d.y)/2*-.5})}gestureBeginsVertically(t,i,o){if(this._valid!==void 0)return this._valid;const c=t.mag()>=2,u=i.mag()>=2;if(!c&&!u)return;if(!c||!u)return this._firstMove==null&&(this._firstMove=o),o-this._firstMove<100&&void 0;const d=t.y>0==i.y>0;return NS(t)&&NS(i)&&d}}const UX={panStep:100,bearingStep:15,pitchStep:10};class $X{constructor(){const t=UX;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let i=0,o=0,c=0,u=0,d=0;switch(t.keyCode){case 61:case 107:case 171:case 187:i=1;break;case 189:case 109:case 173:i=-1;break;case 37:t.shiftKey?o=-1:(t.preventDefault(),u=-1);break;case 39:t.shiftKey?o=1:(t.preventDefault(),u=1);break;case 38:t.shiftKey?c=1:(t.preventDefault(),d=-1);break;case 40:t.shiftKey?c=-1:(t.preventDefault(),d=1);break;default:return}return this._rotationDisabled&&(o=0,c=0),{cameraAnimation:p=>{const g=p.getZoom();p.easeTo({duration:300,easeId:"keyboardHandler",easing:GX,zoom:i?Math.round(g)+i*(t.shiftKey?2:1):g,bearing:p.getBearing()+o*this._bearingStep,pitch:p.getPitch()+c*this._pitchStep,offset:[-u*this._panStep,-d*this._panStep],center:p.getCenter()},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function GX(n){return n*(2-n)}const iz=4.000244140625;class WX{constructor(t,i){this._map=t,this._el=t.getCanvasContainer(),this._handler=i,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,Ne(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&t.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(t){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(t.ctrlKey||t.metaKey||this.isZooming()||$e()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let i=t.deltaMode===w.WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const o=Be.now(),c=o-(this._lastWheelEventTime||0);this._lastWheelEventTime=o,i!==0&&i%iz==0?this._type="wheel":i!==0&&Math.abs(i)<4?this._type="trackpad":c>400?(this._type=null,this._lastValue=i,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(c*i)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,i+=this._lastValue)),t.shiftKey&&i&&(i/=4),this._type&&(this._lastWheelEvent=t,this._delta-=i,this._active||this._start(t)),t.preventDefault()}_onTimeout(t){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(t)}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const i=Ps(this._el,t);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:i,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._map.transform;this._type==="wheel"&&t.projection.wrap&&(t._center.lng>=180||t._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const i=()=>t._terrainEnabled()&&this._aroundCoord?t.computeZoomRelativeTo(this._aroundCoord):t.zoom;if(this._delta!==0){const _=this._type==="wheel"&&Math.abs(this._delta)>iz?this._wheelZoomRate:this._defaultZoomRate;let v=2/(1+Math.exp(-Math.abs(this._delta*_)));this._delta<0&&v!==0&&(v=1/v);const b=i(),S=Math.pow(2,b),E=typeof this._targetZoom=="number"?t.zoomScale(this._targetZoom):S;this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(E*v))),this._type==="wheel"&&(this._startZoom=b,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const o=typeof this._targetZoom=="number"?this._targetZoom:i(),c=this._startZoom,u=this._easing;let d,p=!1;if(this._type==="wheel"&&c&&u){const _=Math.min((Be.now()-this._lastWheelEventTime)/200,1);d=qe(c,o,u(_)),_<1?this._frameId||(this._frameId=!0):p=!0}else d=o,p=!0;this._active=!0,p&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let g=d-i();return g*this._lastDelta<0&&(g=0),{noInertia:!0,needsRenderFrame:!p,zoomDelta:g,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let i=se;if(this._prevEase){const o=this._prevEase,c=(Be.now()-o.start)/o.duration,u=o.easing(c+.01)-o.easing(c),d=.27/Math.sqrt(u*u+1e-4)*.01;i=ee(d,Math.sqrt(.0729-d*d),.25,1)}return this._prevEase={start:Be.now(),duration:t,easing:i},i}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Nn("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(w.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class HX{constructor(t,i){this._clickZoom=t,this._tapZoom=i}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class qX{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(t,i){return t.preventDefault(),{cameraAnimation:o=>{o.easeTo({duration:300,zoom:o.getZoom()+(t.shiftKey?-1:1),around:o.unproject(i)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ZX{constructor(){this._tap=new OS({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(t,i,o){this._swipePoint||(this._tapTime&&t.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?o.length>0&&(this._swipePoint=i[0],this._swipeTouch=o[0].identifier):this._tap.touchstart(t,i,o))}touchmove(t,i,o){if(this._tapTime){if(this._swipePoint){if(o[0].identifier!==this._swipeTouch)return;const c=i[0],u=c.y-this._swipePoint.y;return this._swipePoint=c,t.preventDefault(),this._active=!0,{zoomDelta:u/128}}}else this._tap.touchmove(t,i,o)}touchend(t,i,o){this._tapTime?this._swipePoint&&o.length===0&&this.reset():this._tap.touchend(t,i,o)&&(this._tapTime=t.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class XX{constructor(t,i,o){this._el=t,this._mousePan=i,this._touchPan=o}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class YX{constructor(t,i,o){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=i,this._mousePitch=o}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class KX{constructor(t,i,o,c){this._el=t,this._touchZoom=i,this._touchRotate=o,this._tapDragZoom=c,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const $y=n=>n.zoom||n.drag||n.pitch||n.rotate;class JX extends Bt{}class QX{constructor(){this.constants=[1,1,.01],this.radius=0}setup(t,i){const o=ct.sub([],i,t);this.radius=ct.length(o[2]<0?ct.div([],o,this.constants):[o[0],o[1],0])}projectRay(t){ct.div(t,t,this.constants),ct.normalize(t,t),ct.mul(t,t,this.constants);const i=ct.scale([],t,this.radius);if(i[2]>0){const o=ct.scale([],[0,0,1],ct.dot(i,[0,0,1])),c=ct.scale([],ct.normalize([],[i[0],i[1],0]),this.radius),u=ct.add([],i,ct.scale([],ct.sub([],ct.add([],c,o),i),2));i[0]=u[0],i[1]=u[1]}return i}}function Gy(n){return n.panDelta&&n.panDelta.mag()||n.zoomDelta||n.bearingDelta||n.pitchDelta}class tY{constructor(t,i){this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new PX(t),this._bearingSnap=i.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new QX,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(i),Ne(["handleEvent","handleWindowEvent"],this);const o=this._el;this._listeners=[[o,"touchstart",{passive:!0}],[o,"touchmove",{passive:!1}],[o,"touchend",void 0],[o,"touchcancel",void 0],[o,"mousedown",void 0],[o,"mousemove",void 0],[o,"mouseup",void 0],[w.document,"mousemove",{capture:!0}],[w.document,"mouseup",void 0],[o,"mouseover",void 0],[o,"mouseout",void 0],[o,"dblclick",void 0],[o,"click",void 0],[o,"keydown",{capture:!1}],[o,"keyup",void 0],[o,"wheel",{passive:!1}],[o,"contextmenu",void 0],[w,"blur",void 0]];for(const[c,u,d]of this._listeners)c.addEventListener(u,c===w.document?this.handleWindowEvent:this.handleEvent,d)}destroy(){for(const[t,i,o]of this._listeners)t.removeEventListener(i,t===w.document?this.handleWindowEvent:this.handleEvent,o)}_addDefaultHandlers(t){const i=this._map,o=i.getCanvasContainer();this._add("mapEvent",new kX(i,t));const c=i.boxZoom=new RX(i,t);this._add("boxZoom",c);const u=new LX,d=new qX;i.doubleClickZoom=new HX(d,u),this._add("tapZoom",u),this._add("clickZoom",d);const p=new ZX;this._add("tapDragZoom",p);const g=i.touchPitch=new VX(i);this._add("touchPitch",g);const _=new tz(t),v=new ez(t);i.dragRotate=new YX(t,_,v),this._add("mouseRotate",_,["mousePitch"]),this._add("mousePitch",v,["mouseRotate"]);const b=new NX(t),S=new FX(i,t);i.dragPan=new XX(o,b,S),this._add("mousePan",b),this._add("touchPan",S,["touchZoom","touchRotate"]);const E=new jX,A=new BX;i.touchZoomRotate=new KX(o,A,E,p),this._add("touchRotate",E,["touchPan","touchZoom"]),this._add("touchZoom",A,["touchPan","touchRotate"]),this._add("blockableMapEvent",new DX(i));const C=i.scrollZoom=new WX(i,this);this._add("scrollZoom",C,["mousePan"]);const P=i.keyboard=new $X;this._add("keyboard",P);for(const k of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])t.interactive&&t[k]&&i[k].enable(t[k])}_add(t,i,o){this._handlers.push({handlerName:t,handler:i,allowed:o}),this._handlersById[t]=i}stop(t){if(!this._updatingCamera){for(const{handler:i}of this._handlers)i.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!$y(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(t,i,o){for(const c in t)if(c!==o&&(!i||i.indexOf(c)<0))return!0;return!1}handleWindowEvent(t){this.handleEvent(t,`${t.type}Window`)}_getMapTouches(t){const i=[];for(const o of t)this._el.contains(o.target)&&i.push(o);return i}handleEvent(t,i){this._updatingCamera=!0;const o=t.type==="renderFrame",c=o?void 0:t,u={needsRenderFrame:!1},d={},p={},g=t.touches?this._getMapTouches(t.touches):void 0,_=g?tl(this._el,g):o?void 0:Ps(this._el,t);for(const{handlerName:S,handler:E,allowed:A}of this._handlers){if(!E.isEnabled())continue;let C;this._blockedByActive(p,A,S)?E.reset():E[i||t.type]&&(C=E[i||t.type](t,_,g),this.mergeHandlerResult(u,d,C,S,c),C&&C.needsRenderFrame&&this._triggerRenderFrame()),(C||E.isActive())&&(p[S]=E)}const v={};for(const S in this._previousActiveHandlers)p[S]||(v[S]=c);this._previousActiveHandlers=p,(Object.keys(v).length||Gy(u))&&(this._changes.push([u,d,v]),this._triggerRenderFrame()),(Object.keys(p).length||Gy(u))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:b}=u;b&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],b(this._map))}mergeHandlerResult(t,i,o,c,u){if(!o)return;Ct(t,o);const d={handlerName:c,originalEvent:o.originalEvent||u};o.zoomDelta!==void 0&&(i.zoom=d),o.panDelta!==void 0&&(i.drag=d),o.pitchDelta!==void 0&&(i.pitch=d),o.bearingDelta!==void 0&&(i.rotate=d)}_applyChanges(){const t={},i={},o={};for(const[c,u,d]of this._changes)c.panDelta&&(t.panDelta=(t.panDelta||new W(0,0))._add(c.panDelta)),c.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+c.zoomDelta),c.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+c.bearingDelta),c.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+c.pitchDelta),c.around!==void 0&&(t.around=c.around),c.aroundCoord!==void 0&&(t.aroundCoord=c.aroundCoord),c.pinchAround!==void 0&&(t.pinchAround=c.pinchAround),c.noInertia&&(t.noInertia=c.noInertia),Ct(i,u),Ct(o,d);this._updateMapTransform(t,i,o),this._changes=[]}_updateMapTransform(t,i,o){const c=this._map,u=c.transform,d=L=>[L.x,L.y,L.z];if((L=>{const j=this._eventsInProgress.drag;return j&&!this._handlersById[j.handlerName].isActive()})()&&!Gy(t)){const L=u.zoom;u.cameraElevationReference="sea",this._originalZoom!=null&&u._orthographicProjectionAtLowPitch&&u.projection.name!=="globe"&&u.pitch===0?(u.cameraElevationReference="ground",u.zoom=this._originalZoom):(u.recenterOnTerrain(),u.cameraElevationReference="ground"),L!==u.zoom&&this._map._update(!0)}if(u._isCameraConstrained&&c._stop(!0),!Gy(t))return void this._fireEvents(i,o,!0);let{panDelta:p,zoomDelta:g,bearingDelta:_,pitchDelta:v,around:b,aroundCoord:S,pinchAround:E}=t;u._isCameraConstrained&&(g>0&&(g=0),u._isCameraConstrained=!1),E!==void 0&&(b=E),(g||(L=>i[L]&&!this._eventsInProgress[L])("drag"))&&b&&(this._dragOrigin=d(u.pointCoordinate3D(b)),this._originalZoom=u.zoom,this._trackingEllipsoid.setup(u._camera.position,this._dragOrigin)),u.cameraElevationReference="sea",c._stop(!0),b=b||c.transform.centerPoint,_&&(u.bearing+=_),v&&(u.pitch+=v),u._updateCameraState();const A=[0,0,0];if(p)if(u.projection.name==="mercator"){const L=this._trackingEllipsoid.projectRay(u.screenPointToMercatorRay(b).dir),j=this._trackingEllipsoid.projectRay(u.screenPointToMercatorRay(b.sub(p)).dir);A[0]=j[0]-L[0],A[1]=j[1]-L[1]}else{const L=u.pointCoordinate(b);if(u.projection.name==="globe"){p=p.rotate(-u.angle);const j=u._pixelsPerMercatorPixel/u.worldSize;A[0]=-p.x*pw(qr(L.y))*j,A[1]=-p.y*pw(u.center.lat)*j}else{const j=u.pointCoordinate(b.sub(p));L&&j&&(A[0]=j.x-L.x,A[1]=j.y-L.y)}}const C=u.zoom,P=[0,0,0];if(g){const L=d(S||u.pointCoordinate3D(b)),j={dir:ct.normalize([],ct.sub([],L,u._camera.position))};if(j.dir[2]<0){const V=u.zoomDeltaToMovement(L,g);ct.scale(P,j.dir,V)}}const k=ct.add(A,A,P);u._translateCameraConstrained(k),g&&Math.abs(u.zoom-C)>1e-4&&u.recenterOnTerrain(),u.cameraElevationReference="ground",this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(i,o,!0)}_fireEvents(t,i,o){const c=$y(this._eventsInProgress),u=$y(t),d={};for(const v in t){const{originalEvent:b}=t[v];this._eventsInProgress[v]||(d[`${v}start`]=b),this._eventsInProgress[v]=t[v]}!c&&u&&this._fireEvent("movestart",u.originalEvent);for(const v in d)this._fireEvent(v,d[v]);u&&this._fireEvent("move",u.originalEvent);for(const v in t){const{originalEvent:b}=t[v];this._fireEvent(v,b)}const p={};let g;for(const v in this._eventsInProgress){const{handlerName:b,originalEvent:S}=this._eventsInProgress[v];this._handlersById[b].isActive()||(delete this._eventsInProgress[v],g=i[b]||S,p[`${v}end`]=g)}for(const v in p)this._fireEvent(v,p[v]);const _=$y(this._eventsInProgress);if(o&&(c||u)&&!_){this._updatingCamera=!0;const v=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),b=S=>S!==0&&-this._bearingSnap<S&&S<this._bearingSnap;v?(b(v.bearing||this._map.getBearing())&&(v.bearing=0),this._map.easeTo(v,{originalEvent:g})):(this._map.fire(new Bt("moveend",{originalEvent:g})),b(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(t,i){this._map.fire(new Bt(t,i?{originalEvent:i}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(t=>{this._frameId=void 0,this.handleEvent(new JX("renderFrame",{timeStamp:t})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const sz="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class eY extends Mn{constructor(t,i){super(),this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=i.bearingSnap,this._respectPrefersReducedMotion=i.respectPrefersReducedMotion!==!1,Ne(["_renderFrameCallback"],this)}getCenter(){return new Ze(this.transform.center.lng,this.transform.center.lat)}setCenter(t,i){return this.jumpTo({center:t},i)}panBy(t,i,o){return t=W.convert(t).mult(-1),this.panTo(this.transform.center,Ct({offset:t},i),o)}panTo(t,i,o){return this.easeTo(Ct({center:t},i),o)}getZoom(){return this.transform.zoom}setZoom(t,i){return this.jumpTo({zoom:t},i),this}zoomTo(t,i,o){return this.easeTo(Ct({zoom:t},i),o)}zoomIn(t,i){return this.zoomTo(this.getZoom()+1,t,i),this}zoomOut(t,i){return this.zoomTo(this.getZoom()-1,t,i),this}getBearing(){return this.transform.bearing}setBearing(t,i){return this.jumpTo({bearing:t},i),this}getPadding(){return this.transform.padding}setPadding(t,i){return this.jumpTo({padding:t},i),this}rotateTo(t,i,o){return this.easeTo(Ct({bearing:t},i),o)}resetNorth(t,i){return this.rotateTo(0,Ct({duration:1e3},t),i),this}resetNorthPitch(t,i){return this.easeTo(Ct({bearing:0,pitch:0,duration:1e3},t),i),this}snapToNorth(t,i){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,i):this}getPitch(){return this.transform.pitch}setPitch(t,i){return this.jumpTo({pitch:t},i),this}cameraForBounds(t,i){t=Os.convert(t);const o=i&&i.bearing||0,c=i&&i.pitch||0,u=t.getNorthWest(),d=t.getSouthEast();return this._cameraForBounds(this.transform,u,d,o,c,i)}_extendCameraOptions(t){const i={top:0,bottom:0,right:0,left:0};if(typeof(t=Ct({padding:i,offset:[0,0],maxZoom:this.transform.maxZoom},t)).padding=="number"){const o=t.padding;t.padding={top:o,bottom:o,right:o,left:o}}return t.padding=Ct(i,t.padding),t}_minimumAABBFrustumDistance(t,i){const o=i.max[0]-i.min[0],c=i.max[1]-i.min[1];return o/c>t.aspect?o/(2*Math.tan(.5*t.fovX)*t.aspect):c/(2*Math.tan(.5*t.fovY)*t.aspect)}_cameraForBoundsOnGlobe(t,i,o,c,u,d){const p=t.clone(),g=this._extendCameraOptions(d);p.bearing=c,p.pitch=u;const _=Ze.convert(i),v=Ze.convert(o),b=.5*(_.lat+v.lat),S=.5*(_.lng+v.lng),E=ws(b,S),A=ct.normalize([],E),C=ct.normalize([],ct.cross([],A,[0,1,0])),P=ct.cross([],C,A),k=[C[0],C[1],C[2],0,P[0],P[1],P[2],0,A[0],A[1],A[2],0,0,0,0,1],L=[E,ws(_.lat,_.lng),ws(v.lat,_.lng),ws(v.lat,v.lng),ws(_.lat,v.lng),ws(b,_.lng),ws(b,v.lng),ws(_.lat,S),ws(v.lat,S)];let j=nr.fromPoints(L.map(pt=>[ct.dot(C,pt),ct.dot(P,pt),ct.dot(A,pt)]));const V=ct.transformMat4([],j.center,k);ct.squaredLength(V)===0&&ct.set(V,0,0,1),ct.normalize(V,V),ct.scale(V,V,as),p.center=function([pt,Et,At]){const Mt=Math.hypot(pt,Et,At),Lt=Math.atan2(pt,At),Nt=.5*Math.PI-Math.acos(-Et/Mt);return new Ze(St(Lt),St(Nt))}(V);const F=p.getWorldToCameraMatrix(),U=wt.invert(new Float64Array(16),F);j=nr.applyTransform(j,wt.multiply([],F,k)),ct.transformMat4(V,V,F);const q=.5*(j.max[2]-j.min[2]),Z=this._minimumAABBFrustumDistance(p,j),X=ct.scale([],[0,0,1],q),J=ct.add(X,V,X),rt=Z+(p.pitch===0?0:ct.distance(V,J)),it=p.globeCenterInViewSpace,ut=ct.sub([],V,[it[0],it[1],it[2]]);ct.normalize(ut,ut),ct.scale(ut,ut,rt);const tt=ct.add([],V,ut);ct.transformMat4(tt,tt,U);const dt=ud/as,gt=ct.length(tt),xt=$n(Math.max(gt*dt-ud,Number.EPSILON),0),ht=Math.min(p.zoomFromMercatorZAdjusted(xt),g.maxZoom);return ht>.5*(sp+uc)?(p.setProjection({name:"mercator"}),p.zoom=ht,this._cameraForBounds(p,i,o,c,u,d)):{center:p.center,zoom:ht,bearing:c,pitch:u}}queryTerrainElevation(t,i){const o=this.transform.elevation;return o?(i=Ct({},{exaggerated:!0},i),o.getAtPoint(vn.fromLngLat(t),null,i.exaggerated)):null}_cameraForBounds(t,i,o,c,u,d){if(t.projection.name==="globe")return this._cameraForBoundsOnGlobe(t,i,o,c,u,d);const p=t.clone(),g=this._extendCameraOptions(d),_=p.padding;p.bearing=c,p.pitch=u;const v=Ze.convert(i),b=Ze.convert(o),S=new Ze(v.lng,b.lat),E=new Ze(b.lng,v.lat),A=p.project(v),C=p.project(b),P=this.queryTerrainElevation(v),k=this.queryTerrainElevation(b),L=this.queryTerrainElevation(S),j=this.queryTerrainElevation(E),V=[[A.x,A.y,Math.min(P||0,k||0,L||0,j||0)],[C.x,C.y,Math.max(P||0,k||0,L||0,j||0)]];let F=nr.fromPoints(V);const U=p.getWorldToCameraMatrix(),q=wt.invert(new Float64Array(16),U);F=nr.applyTransform(F,U);const Z=ct.sub([],F.max,F.min),X=_.left||0,J=_.right||0,rt=_.bottom||0,it=_.top||0,{left:ut,right:tt,top:dt,bottom:gt}=g.padding,xt=.5*(X+J),ht=.5*(it+rt),pt=Math.min(p.scaleZoom(p.scale*Math.min((p.width-(X+J+ut+tt))/Z[0],(p.height-(rt+it+gt+dt))/Z[1])),g.maxZoom),Et=p.scale/p.zoomScale(pt);F=new nr([F.min[0]-(ut+xt)*Et,F.min[1]-(gt+ht)*Et,F.min[2]],[F.max[0]+(tt+xt)*Et,F.max[1]+(dt+ht)*Et,F.max[2]]);const At=.5*Z[2],Mt=this._minimumAABBFrustumDistance(p,F),Lt=[0,0,1,0];jn.transformMat4(Lt,Lt,U),jn.normalize(Lt,Lt);const Nt=ct.scale([],Lt,Mt+At),jt=ct.add([],F.center,Nt),It=(typeof g.offset.x=="number"&&typeof g.offset.y=="number"?new W(g.offset.x,g.offset.y):W.convert(g.offset)).rotate(-st(c));F.center[0]-=It.x*Et,F.center[1]+=It.y*Et,ct.transformMat4(F.center,F.center,q),ct.transformMat4(jt,jt,q);const Gt=[F.center[0],F.center[1],jt[2]*p.pixelsPerMeter];ct.scale(Gt,Gt,1/p.worldSize);const ce=Ls(Gt[0]),ue=qr(Gt[1]),ye=Math.min(p._zoomFromMercatorZ(Gt[2]),g.maxZoom),be=new Ze(ce,ue);return p.mercatorFromTransition&&ye<.5*(sp+uc)?(p.setProjection({name:"globe"}),p.zoom=ye,this._cameraForBounds(p,i,o,c,u,d)):{center:be,zoom:ye,bearing:c,pitch:u}}fitBounds(t,i,o){const c=this.cameraForBounds(t,i);return this._fitInternal(c,i,o)}fitScreenCoordinates(t,i,o,c,u){const d=W.convert(t),p=W.convert(i),g=new W(Math.min(d.x,p.x),Math.min(d.y,p.y)),_=new W(Math.max(d.x,p.x),Math.max(d.y,p.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(d,p))return this;const v=this.transform.pointLocation3D(g),b=this.transform.pointLocation3D(_),S=this.transform.pointLocation3D(new W(g.x,_.y)),E=this.transform.pointLocation3D(new W(_.x,g.y)),A=[Math.min(v.lng,b.lng,S.lng,E.lng),Math.min(v.lat,b.lat,S.lat,E.lat)],C=[Math.max(v.lng,b.lng,S.lng,E.lng),Math.max(v.lat,b.lat,S.lat,E.lat)],P=c&&c.pitch?c.pitch:this.getPitch(),k=this._cameraForBounds(this.transform,A,C,o,P,c);return this._fitInternal(k,c,u)}_fitInternal(t,i,o){return t?(delete(i=Ct(t,i)).padding,i.linear?this.easeTo(i,o):this.flyTo(i,o)):this}jumpTo(t,i){this.stop();const o=t.preloadOnly?this.transform.clone():this.transform;let c=!1,u=!1,d=!1;return"zoom"in t&&o.zoom!==+t.zoom&&(c=!0,o.zoom=+t.zoom),t.center!==void 0&&(o.center=Ze.convert(t.center)),"bearing"in t&&o.bearing!==+t.bearing&&(u=!0,o.bearing=+t.bearing),"pitch"in t&&o.pitch!==+t.pitch&&(d=!0,o.pitch=+t.pitch),t.padding==null||o.isPaddingEqual(t.padding)||(o.padding=t.padding),t.preloadOnly?(this._preloadTiles(o),this):(this.fire(new Bt("movestart",i)).fire(new Bt("move",i)),c&&this.fire(new Bt("zoomstart",i)).fire(new Bt("zoom",i)).fire(new Bt("zoomend",i)),u&&this.fire(new Bt("rotatestart",i)).fire(new Bt("rotate",i)).fire(new Bt("rotateend",i)),d&&this.fire(new Bt("pitchstart",i)).fire(new Bt("pitch",i)).fire(new Bt("pitchend",i)),this.fire(new Bt("moveend",i)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||_t(sz),this.transform.getFreeCameraOptions()}setFreeCameraOptions(t,i){const o=this.transform;if(!o.projection.supportsFreeCamera)return _t(sz),this;this.stop();const c=o.zoom,u=o.pitch,d=o.bearing;o.setFreeCameraOptions(t);const p=c!==o.zoom,g=u!==o.pitch,_=d!==o.bearing;return this.fire(new Bt("movestart",i)).fire(new Bt("move",i)),p&&this.fire(new Bt("zoomstart",i)).fire(new Bt("zoom",i)).fire(new Bt("zoomend",i)),_&&this.fire(new Bt("rotatestart",i)).fire(new Bt("rotate",i)).fire(new Bt("rotateend",i)),g&&this.fire(new Bt("pitchstart",i)).fire(new Bt("pitch",i)).fire(new Bt("pitchend",i)),this.fire(new Bt("moveend",i)),this}easeTo(t,i){this._stop(!1,t.easeId),((t=Ct({offset:[0,0],duration:500,easing:se},t)).animate===!1||this._prefersReducedMotion(t))&&(t.duration=0);const o=this.transform,c=this.getZoom(),u=this.getBearing(),d=this.getPitch(),p=this.getPadding(),g="zoom"in t?+t.zoom:c,_="bearing"in t?this._normalizeBearing(t.bearing,u):u,v="pitch"in t?+t.pitch:d,b="padding"in t?t.padding:o.padding,S=W.convert(t.offset);let E,A,C;if(o.projection.name==="globe"){const X=vn.fromLngLat(o.center),J=S.rotate(-o.angle);X.x+=J.x/o.worldSize,X.y+=J.y/o.worldSize;const rt=X.toLngLat(),it=Ze.convert(t.center||rt);this._normalizeCenter(it),E=o.centerPoint.add(J),A=new W(X.x,X.y).mult(o.worldSize),C=new W(ti(it.lng),ui(it.lat)).mult(o.worldSize).sub(A)}else{E=o.centerPoint.add(S);const X=o.pointLocation(E),J=Ze.convert(t.center||X);this._normalizeCenter(J),A=o.project(X),C=o.project(J).sub(A)}const P=o.zoomScale(g-c);let k,L;t.around&&(k=Ze.convert(t.around),L=o.locationPoint(k));const j=this._zooming||g!==c,V=this._rotating||u!==_,F=this._pitching||v!==d,U=!o.isPaddingEqual(b),q=X=>J=>{if(j&&(X.zoom=qe(c,g,J)),V&&(X.bearing=qe(u,_,J)),F&&(X.pitch=qe(d,v,J)),U&&(X.interpolatePadding(p,b,J),E=X.centerPoint.add(S)),k)X.setLocationAtPoint(k,L);else{const rt=X.zoomScale(X.zoom-c),it=g>c?Math.min(2,P):Math.max(.5,P),ut=Math.pow(it,1-J),tt=X.unproject(A.add(C.mult(J*ut)).mult(rt));X.setLocationAtPoint(X.renderWorldCopies?tt.wrap():tt,E)}return t.preloadOnly||this._fireMoveEvents(i),X};if(t.preloadOnly){const X=this._emulate(q,t.duration,o);return this._preloadTiles(X),this}const Z={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=j,this._rotating=V,this._pitching=F,this._padding=U,this._easeId=t.easeId,this._prepareEase(i,t.noMoveStart,Z),this._ease(q(o),X=>{o.cameraElevationReference==="sea"&&o.recenterOnTerrain(),this._afterEase(i,X)},t),this}_prepareEase(t,i,o={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),i||o.moving||this.fire(new Bt("movestart",t)),this._zooming&&!o.zooming&&this.fire(new Bt("zoomstart",t)),this._rotating&&!o.rotating&&this.fire(new Bt("rotatestart",t)),this._pitching&&!o.pitching&&this.fire(new Bt("pitchstart",t))}_fireMoveEvents(t){this.fire(new Bt("move",t)),this._zooming&&this.fire(new Bt("zoom",t)),this._rotating&&this.fire(new Bt("rotate",t)),this._pitching&&this.fire(new Bt("pitch",t))}_afterEase(t,i){if(this._easeId&&i&&this._easeId===i)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const o=this._zooming,c=this._rotating,u=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,o&&this.fire(new Bt("zoomend",t)),c&&this.fire(new Bt("rotateend",t)),u&&this.fire(new Bt("pitchend",t)),this.fire(new Bt("moveend",t))}flyTo(t,i){if(this._prefersReducedMotion(t)){const pt=Ae(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(pt,i)}this.stop(),t=Ct({offset:[0,0],speed:1.2,curve:1.42,easing:se},t);const o=this.transform,c=this.getZoom(),u=this.getBearing(),d=this.getPitch(),p=this.getPadding(),g="zoom"in t?Ot(+t.zoom,o.minZoom,o.maxZoom):c,_="bearing"in t?this._normalizeBearing(t.bearing,u):u,v="pitch"in t?+t.pitch:d,b="padding"in t?t.padding:o.padding,S=o.zoomScale(g-c),E=W.convert(t.offset);let A=o.centerPoint.add(E);const C=o.pointLocation(A),P=Ze.convert(t.center||C);this._normalizeCenter(P);const k=o.project(C),L=o.project(P).sub(k);let j=t.curve;const V=Math.max(o.width,o.height),F=V/S,U=L.mag();if("minZoom"in t){const pt=Ot(Math.min(t.minZoom,c,g),o.minZoom,o.maxZoom),Et=V/o.zoomScale(pt-c);j=Math.sqrt(Et/U*2)}const q=j*j;function Z(pt){const Et=(F*F-V*V+(pt?-1:1)*q*q*U*U)/(2*(pt?F:V)*q*U);return Math.log(Math.sqrt(Et*Et+1)-Et)}function X(pt){return(Math.exp(pt)-Math.exp(-pt))/2}function J(pt){return(Math.exp(pt)+Math.exp(-pt))/2}const rt=Z(0);let it=function(pt){return J(rt)/J(rt+j*pt)},ut=function(pt){return V*((J(rt)*(X(Et=rt+j*pt)/J(Et))-X(rt))/q)/U;var Et},tt=(Z(1)-rt)/j;if(Math.abs(U)<1e-6||!isFinite(tt)){if(Math.abs(V-F)<1e-6)return this.easeTo(t,i);const pt=F<V?-1:1;tt=Math.abs(Math.log(F/V))/j,ut=function(){return 0},it=function(Et){return Math.exp(pt*j*Et)}}t.duration="duration"in t?+t.duration:1e3*tt/("screenSpeed"in t?+t.screenSpeed/j:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0);const dt=u!==_,gt=v!==d,xt=!o.isPaddingEqual(b),ht=pt=>Et=>{const At=Et*tt,Mt=1/it(At);pt.zoom=Et===1?g:c+pt.scaleZoom(Mt),dt&&(pt.bearing=qe(u,_,Et)),gt&&(pt.pitch=qe(d,v,Et)),xt&&(pt.interpolatePadding(p,b,Et),A=pt.centerPoint.add(E));const Lt=Et===1?P:pt.unproject(k.add(L.mult(ut(At))).mult(Mt));return pt.setLocationAtPoint(pt.renderWorldCopies?Lt.wrap():Lt,A),pt._updateCameraOnTerrain(),t.preloadOnly||this._fireMoveEvents(i),pt};if(t.preloadOnly){const pt=this._emulate(ht,t.duration,o);return this._preloadTiles(pt),this}return this._zooming=!0,this._rotating=dt,this._pitching=gt,this._padding=xt,this._prepareEase(i,!1),this._ease(ht(o),()=>this._afterEase(i),t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,i){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const o=this._onEaseEnd;this._onEaseEnd=void 0,o.call(this,i)}if(!t){const o=this.handlers;o&&o.stop(!1)}return this}_ease(t,i,o){o.animate===!1||o.duration===0?(t(1),i()):(this._easeStart=Be.now(),this._easeOptions=o,this._onEaseFrame=t,this._onEaseEnd=i,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const t=Math.min((Be.now()-this._easeStart)/this._easeOptions.duration,1),i=this._onEaseFrame;i&&i(this._easeOptions.easing(t)),t<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(t,i){t=me(t,-180,180);const o=Math.abs(t-i);return Math.abs(t-360-i)<o&&(t-=360),Math.abs(t+360-i)<o&&(t+=360),t}_normalizeCenter(t){const i=this.transform;if(i.maxBounds||i.projection.name!=="globe"&&!i.renderWorldCopies)return;const o=t.lng-i.center.lng;t.lng+=o>180?-360:o<-180?360:0}_prefersReducedMotion(t){return this._respectPrefersReducedMotion&&Be.prefersReducedMotion&&!(t&&t.essential)}_emulate(t,i,o){const c=Math.ceil(15*i/1e3),u=[],d=t(o.clone());for(let p=0;p<=c;p++){const g=d(p/c);u.push(g.clone())}return u}}class oz{constructor(t={}){this.options=t,Ne(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(t){const i=this.options&&this.options.compact;return this._map=t,this._container=Nn("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=Nn("button","mapboxgl-ctrl-attrib-button",this._container),Nn("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=Nn("div","mapboxgl-ctrl-attrib-inner",this._container),i&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),i===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(t,i){const o=this._map._getUIString(`AttributionControl.${i}`);t.removeAttribute("title"),t.firstElementChild&&t.firstElementChild.setAttribute("title",o)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let t=this._editLink;t||(t=this._editLink=this._container.querySelector(".mapbox-improve-map"));const i=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||I.ACCESS_TOKEN}];if(t){const o=i.reduce((c,u,d)=>(u.value&&(c+=`${u.key}=${u.value}${d<i.length-1?"&":""}`),c),"?");t.href=`${I.FEEDBACK_URL}/${o}#${Q3(this._map,!0)}`,t.rel="noopener nofollow",this._setElementTitle(t,"MapFeedback")}}_updateData(t){!t||t.sourceDataType!=="metadata"&&t.sourceDataType!=="visibility"&&t.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let t=[];if(this._map.style.stylesheet){const c=this._map.style.stylesheet;this.styleOwner=c.owner,this.styleId=c.id}const i=this._map.style._mergedSourceCaches;for(const c in i){const u=i[c];if(u.used){const d=u.getSource();d.attribution&&t.indexOf(d.attribution)<0&&t.push(d.attribution)}}t.sort((c,u)=>c.length-u.length),t=t.filter((c,u)=>{for(let d=u+1;d<t.length;d++)if(t[d].indexOf(c)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=[...this.options.customAttribution,...t]:t.unshift(this.options.customAttribution));const o=t.join(" | ");o!==this._attribHTML&&(this._attribHTML=o,t.length?(this._innerContainer.innerHTML=o,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class az{constructor(){Ne(["_updateLogo","_updateCompact"],this)}onAdd(t){this._map=t,this._container=Nn("div","mapboxgl-ctrl");const i=Nn("a","mapboxgl-ctrl-logo");return i.target="_blank",i.rel="noopener nofollow",i.href="https://www.mapbox.com/",i.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),i.setAttribute("rel","noopener nofollow"),this._container.appendChild(i),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(t){t&&t.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const t=this._map.style._sourceCaches;if(Object.entries(t).length===0)return!0;for(const i in t){const o=t[i].getSource();if(o.hasOwnProperty("mapbox_logo")&&!o.mapbox_logo)return!1}return!0}_updateCompact(){const t=this._container.children;if(t.length){const i=t[0];this._map.getCanvasContainer().offsetWidth<250?i.classList.add("mapboxgl-compact"):i.classList.remove("mapboxgl-compact")}}}class lz{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const i=++this._id;return this._queue.push({callback:t,id:i,cancelled:!1}),i}remove(t){const i=this._currentlyRunning,o=i?this._queue.concat(i):this._queue;for(const c of o)if(c.id===t)return void(c.cancelled=!0)}run(t=0){const i=this._currentlyRunning=this._queue;this._queue=[];for(const o of i)if(!o.cancelled&&(o.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function cz(n,t,i){if(n=new Ze(n.lng,n.lat),t){const o=new Ze(n.lng-360,n.lat),c=new Ze(n.lng+360,n.lat),u=360*Math.ceil(Math.abs(n.lng-i.center.lng)/360),d=i.locationPoint(n).distSqr(t),p=t.x<0||t.y<0||t.x>i.width||t.y>i.height;i.locationPoint(o).distSqr(t)<d&&(p||Math.abs(o.lng-i.center.lng)<u)?n=o:i.locationPoint(c).distSqr(t)<d&&(p||Math.abs(c.lng-i.center.lng)<u)&&(n=c)}for(;Math.abs(n.lng-i.center.lng)>180;){const o=i.locationPoint(n);if(o.x>=0&&o.y>=0&&o.x<=i.width&&o.y<=i.height)break;n.lng>i.center.lng?n.lng-=360:n.lng+=360}return n}const FS={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class BS extends Mn{constructor(t,i){if(super(),(t instanceof w.HTMLElement||i)&&(t=Ct({element:t},i)),Ne(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=t&&t.occludedOpacity||.2,t&&t.element)this._element=t.element,this._offset=W.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=Nn("div");const u=41,d=27,p=Ys("svg",{display:"block",height:u*this._scale+"px",width:d*this._scale+"px",viewBox:`0 0 ${d} ${u}`},this._element),g=Ys("radialGradient",{id:"shadowGradient"},Ys("defs",{},p));Ys("stop",{offset:"10%","stop-opacity":.4},g),Ys("stop",{offset:"100%","stop-opacity":.05},g),Ys("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},p),Ys("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},p),Ys("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},p),Ys("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},p),this._offset=W.convert(t&&t.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",u=>{u.preventDefault()}),this._element.addEventListener("mousedown",u=>{u.preventDefault()});const o=this._element.classList;for(const u in FS)o.remove(`mapboxgl-marker-anchor-${u}`);o.add(`mapboxgl-marker-anchor-${this._anchor}`);const c=t&&t.className?t.className.trim().split(/\s+/):[];o.add(...c),this._popup=null}addTo(t){return t===this._map||(this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._updateMoving),t.on("moveend",this._update),t.on("remove",this._clearFadeTimer),t._addMarker(this),this.setDraggable(this._draggable),this._update(),t.on("click",this._onMapClick)),this}remove(){const t=this._map;return t&&(t.off("click",this._onMapClick),t.off("move",this._updateMoving),t.off("moveend",this._update),t.off("mousedown",this._addDragHandler),t.off("touchstart",this._addDragHandler),t.off("mouseup",this._onUp),t.off("touchend",this._onUp),t.off("mousemove",this._onMove),t.off("touchmove",this._onMove),t.off("remove",this._clearFadeTimer),t._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=Ze.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const c=Math.sqrt(Math.pow(13.5,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[c,-1*(38.1-13.5+c)],"bottom-right":[-c,-1*(38.1-13.5+c)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=t,t._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(t){const i=t.code,o=t.charCode||t.keyCode;i!=="Space"&&i!=="Enter"&&o!==32&&o!==13||this.togglePopup()}_onMapClick(t){const i=t.originalEvent.target,o=this._element;this._popup&&(i===o||o.contains(i))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const t=this._popup;return t?(t.isOpen()?(t.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(t.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const t=this._map,i=this._pos;if(!t||!i)return!1;const o=t.unproject(i),c=t.getFreeCameraOptions();if(!c.position)return!1;const u=c.position.toLngLat();return u.distanceTo(o)<.9*u.distanceTo(this._lngLat)}_evaluateOpacity(){const t=this._map;if(!t)return;const i=this._pos;if(!i||i.x<0||i.x>t.transform.width||i.y<0||i.y>t.transform.height)return void this._clearFadeTimer();const o=t.unproject(i);let c;t._showingGlobe()&&C_(t.transform,this._lngLat)?c=0:(c=1-t._queryFogOpacity(o),t.transform._terrainEnabled()&&t.getTerrain()&&this._behindTerrain()&&(c*=this._occludedOpacity)),this._element.style.opacity=`${c}`,this._element.style.pointerEvents=c>0?"auto":"none",this._popup&&this._popup._setOpacity(c),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const t=this._pos;if(!t||!this._map)return;const i=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${t.x}px,${t.y}px)
            ${FS[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${i.x}px,${i.y}px)
        `}_calculateXYTransform(){const t=this._pos,i=this._map,o=this.getPitchAlignment();if(!i||!t||o!=="map")return"";if(!i._showingGlobe()){const g=i.getPitch();return g?`rotateX(${g}deg)`:""}const c=St(YD(i.transform,this._lngLat)),u=t.sub(XD(i.transform)),d=Math.abs(u.x)+Math.abs(u.y);if(d===0)return"";const p=c/d;return`rotateX(${-u.y*p}deg) rotateY(${u.x*p}deg)`}_calculateZTransform(){const t=this._pos,i=this._map;if(!i||!t)return"";let o=0;const c=this.getRotationAlignment();if(c==="map")if(i._showingGlobe()){const u=i.project(new Ze(this._lngLat.lng,this._lngLat.lat+.001)),d=i.project(new Ze(this._lngLat.lng,this._lngLat.lat-.001)).sub(u);o=St(Math.atan2(d.y,d.x))-90}else o=-i.getBearing();else if(c==="horizon"){const u=Me(4,6,i.getZoom()),d=XD(i.transform);d.y+=u*i.transform.height;const p=t.sub(d),g=St(Math.atan2(p.y,p.x));o=(g>90?g-270:g+90)*(1-u)}return o+=this._rotation,o?`rotateZ(${o}deg)`:""}_update(t){w.cancelAnimationFrame(this._updateFrameId);const i=this._map;i&&(i.transform.renderWorldCopies&&(this._lngLat=cz(this._lngLat,this._pos,i.transform)),this._pos=i.project(this._lngLat),t===!0?this._updateFrameId=w.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),i._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(i._showingGlobe()||i.getTerrain()||i.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(t){return this._offset=W.convert(t),this._update(),this}addClassName(t){return this._element.classList.add(t),this}removeClassName(t){return this._element.classList.remove(t),this}toggleClassName(t){return this._element.classList.toggle(t)}_onMove(t){const i=this._map;if(!i)return;const o=this._pointerdownPos,c=this._positionDelta;if(o&&c){if(!this._isDragging){const u=this._clickTolerance||i._clickTolerance;if(t.point.dist(o)<u)return;this._isDragging=!0}this._pos=t.point.sub(c),this._lngLat=i.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new Bt("dragstart"))),this.fire(new Bt("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const t=this._map;t&&(t.off("mousemove",this._onMove),t.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new Bt("dragend")),this._state="inactive"}_addDragHandler(t){const i=this._map,o=this._pos;i&&o&&this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(o),this._pointerdownPos=t.point,this._state="pending",i.on("mousemove",this._onMove),i.on("touchmove",this._onMove),i.once("mouseup",this._onUp),i.once("touchend",this._onUp))}setDraggable(t){this._draggable=!!t;const i=this._map;return i&&(t?(i.on("mousedown",this._addDragHandler),i.on("touchstart",this._addDragHandler)):(i.off("mousedown",this._addDragHandler),i.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(t){return this._occludedOpacity=t||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const nY={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},rY=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function uz(n=new W(0,0),t="bottom"){if(typeof n=="number"){const i=Math.round(Math.sqrt(.5*Math.pow(n,2)));switch(t){case"top":return new W(0,n);case"top-left":return new W(i,i);case"top-right":return new W(-i,i);case"bottom":return new W(0,-n);case"bottom-left":return new W(i,-i);case"bottom-right":return new W(-i,-i);case"left":return new W(n,0);case"right":return new W(-n,0)}return new W(0,0)}return n instanceof W||Array.isArray(n)?W.convert(n):W.convert(n[t]||[0,0])}class iY{constructor(t){this.jumpTo(t)}getValue(t){if(t<=this._startTime)return this._start;if(t>=this._endTime)return this._end;const i=Zt((t-this._startTime)/(this._endTime-this._startTime));return this._start*(1-i)+this._end*i}isEasing(t){return t>=this._startTime&&t<=this._endTime}jumpTo(t){this._startTime=-1/0,this._endTime=-1/0,this._start=t,this._end=t}easeTo(t,i,o){this._start=this.getValue(i),this._end=t,this._startTime=i,this._endTime=i+o}}const sY={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},oY={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1},aY={showCompass:!0,showZoom:!0,visualizePitch:!1};class lY{constructor(t,i,o=!1){this._clickTolerance=10,this.element=i,this.mouseRotate=new tz({clickTolerance:t.dragRotate._mouseRotate._clickTolerance}),this.map=t,o&&(this.mousePitch=new ez({clickTolerance:t.dragRotate._mousePitch._clickTolerance})),Ne(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),i.addEventListener("mousedown",this.mousedown),i.addEventListener("touchstart",this.touchstart,{passive:!1}),i.addEventListener("touchmove",this.touchmove),i.addEventListener("touchend",this.touchend),i.addEventListener("touchcancel",this.reset)}down(t,i){this.mouseRotate.mousedown(t,i),this.mousePitch&&this.mousePitch.mousedown(t,i),Uh()}move(t,i){const o=this.map,c=this.mouseRotate.mousemoveWindow(t,i),u=c&&c.bearingDelta;if(u&&o.setBearing(o.getBearing()+u),this.mousePitch){const d=this.mousePitch.mousemoveWindow(t,i),p=d&&d.pitchDelta;p&&o.setPitch(o.getPitch()+p)}}off(){const t=this.element;t.removeEventListener("mousedown",this.mousedown),t.removeEventListener("touchstart",this.touchstart,{passive:!1}),t.removeEventListener("touchmove",this.touchmove),t.removeEventListener("touchend",this.touchend),t.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){$h(),w.removeEventListener("mousemove",this.mousemove),w.removeEventListener("mouseup",this.mouseup)}mousedown(t){this.down(Ct({},t,{ctrlKey:!0,preventDefault:()=>t.preventDefault()}),Ps(this.element,t)),w.addEventListener("mousemove",this.mousemove),w.addEventListener("mouseup",this.mouseup)}mousemove(t){this.move(t,Ps(this.element,t))}mouseup(t){this.mouseRotate.mouseupWindow(t),this.mousePitch&&this.mousePitch.mouseupWindow(t),this.offTemp()}touchstart(t){t.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=tl(this.element,t.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>t.preventDefault()},this._startPos))}touchmove(t){t.targetTouches.length!==1?this.reset():(this._lastPos=tl(this.element,t.targetTouches)[0],this.move({preventDefault:()=>t.preventDefault()},this._lastPos))}touchend(t){t.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const cY={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},uY={maxWidth:100,unit:"metric"},hY={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},Wy={version:T,supported:Hl,setRTLTextPlugin:function(n,t,i=!1){if(ks===gb||ks===_b||ks===yb)throw new Error("setRTLTextPlugin cannot be called multiple times.");rc=Be.resolveURL(n),ks=gb,vb=t,xb(),i||JI()},getRTLTextPluginStatus:wb,Map:class extends eY{constructor(n){jh.mark(Go.create);const t=n;if((n=Ct({},oY,n)).minZoom!=null&&n.maxZoom!=null&&n.minZoom>n.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(n.minPitch!=null&&n.maxPitch!=null&&n.minPitch>n.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(n.minPitch!=null&&n.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(n.maxPitch!=null&&n.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(n.antialias&&function(i){const o=i.navigator?i.navigator.userAgent:null;return!!function(c){if(Ve==null){const u=c.navigator?c.navigator.userAgent:null;Ve=!!c.safari||!(!u||!(/\b(iPad|iPhone|iPod)\b/.test(u)||u.match("Safari")&&!u.match("Chrome")))}return Ve}(i)&&o&&(o.match("Version/15.4")||o.match("Version/15.5")||o.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))}(w)&&(n.antialias=!1,_t("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Qw(n.minZoom,n.maxZoom,n.minPitch,n.maxPitch,n.renderWorldCopies),n),this._interactive=n.interactive,this._minTileCacheSize=n.minTileCacheSize,this._maxTileCacheSize=n.maxTileCacheSize,this._failIfMajorPerformanceCaveat=n.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=n.preserveDrawingBuffer,this._antialias=n.antialias,this._trackResize=n.trackResize,this._bearingSnap=n.bearingSnap,this._refreshExpiredTiles=n.refreshExpiredTiles,this._fadeDuration=n.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=n.crossSourceCollisions,this._collectResourceTiming=n.collectResourceTiming,this._language=this._parseLanguage(n.language),this._worldview=n.worldview,this._renderTaskQueue=new lz,this._domRenderTaskQueue=new lz,this._controls=[],this._markers=[],this._popups=[],this._mapId=Fe(),this._locale=Ct({},sY,n.locale),this._clickTolerance=n.clickTolerance,this._cooperativeGestures=n.cooperativeGestures,this._performanceMetricsCollection=n.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new iY(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new De(n.transformRequest,n.accessToken,n.testMode),this._silenceAuthErrors=!!n.testMode,this._contextCreateOptions=n.contextCreateOptions?{...n.contextCreateOptions}:{},typeof n.container=="string"){if(this._container=w.document.getElementById(n.container),!this._container)throw new Error(`Container '${n.container.toString()}' not found.`)}else{if(!(n.container instanceof w.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=n.container}if(this._container.childNodes.length>0&&_t("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),n.maxBounds&&this.setMaxBounds(n.maxBounds),Ne(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),w!==void 0&&(this._fullscreenchangeEvent="onfullscreenchange"in w.document?"fullscreenchange":"webkitfullscreenchange",w.addEventListener("online",this._onWindowOnline,!1),w.addEventListener("resize",this._onWindowResize,!1),w.addEventListener("orientationchange",this._onWindowResize,!1),w.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),w.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new tY(this,n),this._localFontFamily=n.localFontFamily,this._localIdeographFontFamily=n.localIdeographFontFamily,(n.style||!n.testMode)&&this.setStyle(n.style||I.DEFAULT_STYLE,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),n.projection&&this.setProjection(n.projection),n.hash&&(this._hash=new TX(typeof n.hash=="string"&&n.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){t.center==null&&t.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:n.center,zoom:n.zoom,bearing:n.bearing,pitch:n.pitch});const i=n.bounds;i&&(this.resize(),this.fitBounds(i,Ct({},n.fitBoundsOptions,{duration:0})))}this.resize(),n.attributionControl&&this.addControl(new oz({customAttribution:n.customAttribution})),this._logoControl=new az,this.addControl(this._logoControl,n.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",i=>{this._update(i.dataType==="style"),this.fire(new Bt(`${i.dataType}data`,i))}),this.on("dataloading",i=>{this.fire(new Bt(`${i.dataType}dataloading`,i))})}_getMapId(){return this._mapId}addControl(n,t){if(t===void 0&&(t=n.getDefaultPosition?n.getDefaultPosition():"top-right"),!n||!n.onAdd)return this.fire(new xe(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const i=n.onAdd(this);this._controls.push(n);const o=this._controlPositions[t];return t.indexOf("bottom")!==-1?o.insertBefore(i,o.firstChild):o.appendChild(i),this}removeControl(n){if(!n||!n.onRemove)return this.fire(new xe(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(n);return t>-1&&this._controls.splice(t,1),n.onRemove(this),this}hasControl(n){return this._controls.indexOf(n)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(n){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const t=!this._moving;return t&&this.fire(new Bt("movestart",n)).fire(new Bt("move",n)),this.fire(new Bt("resize",n)),t&&this.fire(new Bt("moveend",n)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(n){return this.transform.setMaxBounds(Os.convert(n)),this._update()}setMinZoom(n){if((n=n??-2)>=-2&&n<=this.transform.maxZoom)return this.transform.minZoom=n,this._update(),this.getZoom()<n?this.setZoom(n):this.fire(new Bt("zoomstart")).fire(new Bt("zoom")).fire(new Bt("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(n){if((n=n??22)>=this.transform.minZoom)return this.transform.maxZoom=n,this._update(),this.getZoom()>n?this.setZoom(n):this.fire(new Bt("zoomstart")).fire(new Bt("zoom")).fire(new Bt("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(n){if((n=n??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(n>=0&&n<=this.transform.maxPitch)return this.transform.minPitch=n,this._update(),this.getPitch()<n?this.setPitch(n):this.fire(new Bt("pitchstart")).fire(new Bt("pitch")).fire(new Bt("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(n){if((n=n??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(n>=this.transform.minPitch)return this.transform.maxPitch=n,this._update(),this.getPitch()>n?this.setPitch(n):this.fire(new Bt("pitchstart")).fire(new Bt("pitch")).fire(new Bt("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(n){return this.transform.renderWorldCopies=n,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(n){return n==="auto"?w.navigator.language:Array.isArray(n)?n.length===0?void 0:n.map(t=>t==="auto"?w.navigator.language:t):n}setLanguage(n){const t=this._parseLanguage(n);if(!this.style||t===this._language)return this;this._language=t,this.style.reloadSources();for(const i of this._controls)i._setLanguage&&i._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(n){return this.style&&n!==this._worldview?(this._worldview=n,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(n){return this._lazyInitEmptyStyle(),n?typeof n=="string"&&(n={name:n}):n=null,this._useExplicitProjection=!!n,this._prioritizeAndUpdateProjection(n,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const n=this.transform,t=n.projection.name;let i;t==="globe"&&n.zoom>=uc?(n.setMercatorFromTransition(),i=!0):t==="mercator"&&n.zoom<uc&&(n.setProjection({name:"globe"}),i=!0),i&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(n,t){return this._updateProjection(n||t||{name:"mercator"})}_updateProjection(n){let t;return t=n.name==="globe"&&this.transform.zoom>=uc?this.transform.setMercatorFromTransition():this.transform.setProjection(n),this.style.applyProjectionUpdate(),t&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(n){return this.transform.locationPoint3D(Ze.convert(n))}unproject(n){return this.transform.pointLocation3D(W.convert(n))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(n,t,i){if(n==="mouseenter"||n==="mouseover"){let o=!1;const c=d=>{const p=t.filter(_=>this.getLayer(_)),g=p.length?this.queryRenderedFeatures(d.point,{layers:p}):[];g.length?o||(o=!0,i.call(this,new ro(n,this,d.originalEvent,{features:g}))):o=!1},u=()=>{o=!1};return{layers:new Set(t),listener:i,delegates:{mousemove:c,mouseout:u}}}if(n==="mouseleave"||n==="mouseout"){let o=!1;const c=d=>{const p=t.filter(g=>this.getLayer(g));(p.length?this.queryRenderedFeatures(d.point,{layers:p}):[]).length?o=!0:o&&(o=!1,i.call(this,new ro(n,this,d.originalEvent)))},u=d=>{o&&(o=!1,i.call(this,new ro(n,this,d.originalEvent)))};return{layers:new Set(t),listener:i,delegates:{mousemove:c,mouseout:u}}}{const o=c=>{const u=t.filter(p=>this.getLayer(p)),d=u.length?this.queryRenderedFeatures(c.point,{layers:u}):[];d.length&&(c.features=d,i.call(this,c),delete c.features)};return{layers:new Set(t),listener:i,delegates:{[n]:o}}}}on(n,t,i){if(i===void 0)return super.on(n,t);if(Array.isArray(t)||(t=[t]),t){for(const c of t)if(!this._isValidId(c))return this}const o=this._createDelegatedListener(n,t,i);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[n]=this._delegatedListeners[n]||[],this._delegatedListeners[n].push(o);for(const c in o.delegates)this.on(c,o.delegates[c]);return this}once(n,t,i){if(i===void 0)return super.once(n,t);if(Array.isArray(t)||(t=[t]),t){for(const c of t)if(!this._isValidId(c))return this}const o=this._createDelegatedListener(n,t,i);for(const c in o.delegates)this.once(c,o.delegates[c]);return this}off(n,t,i){if(i===void 0)return super.off(n,t);t=new Set(Array.isArray(t)?t:[t]);for(const u of t)if(!this._isValidId(u))return this;const o=(u,d)=>{if(u.size!==d.size)return!1;for(const p of u)if(!d.has(p))return!1;return!0},c=this._delegatedListeners?this._delegatedListeners[n]:void 0;return c&&(u=>{for(let d=0;d<u.length;d++){const p=u[d];if(p.listener===i&&o(p.layers,t)){for(const g in p.delegates)this.off(g,p.delegates[g]);return u.splice(d,1),this}}})(c),this}queryRenderedFeatures(n,t){if(!this.style)return[];if(t!==void 0||n===void 0||n instanceof W||Array.isArray(n)||(t=n,n=void 0),n=n||[[0,0],[this.transform.width,this.transform.height]],(t=t||{}).layers&&Array.isArray(t.layers)){for(const i of t.layers)if(!this._isValidId(i))return[]}return this.style.queryRenderedFeatures(n,t,this.transform)}querySourceFeatures(n,t){return this._isValidId(n)?this.style.querySourceFeatures(n,t):[]}isPointOnSurface(n){const{name:t}=this.transform.projection;return t!=="globe"&&t!=="mercator"&&_t(`${t} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(W.convert(n))}setStyle(n,t){return(t=Ct({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},t)).diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&t.localFontFamily===this._localFontFamily&&this.style&&n?(this._diffStyle(n,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._localFontFamily=t.localFontFamily,this._updateStyle(n,t))}_getUIString(n){const t=this._locale[n];if(t==null)throw new Error(`Missing UI string '${n}'`);return t}_updateStyle(n,t){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),n&&(this.style=new na(this,t||{}),this.style.setEventedParent(this,{style:this.style}),typeof n=="string"?this.style.loadURL(n):this.style.loadJSON(n)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new na(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(n,t){if(typeof n=="string"){const i=this._requestManager.normalizeStyleURL(n),o=this._requestManager.transformRequest(i,zt.Style);Kt(o,(c,u)=>{c?this.fire(new xe(c)):u&&this._updateDiff(u,t)})}else typeof n=="object"&&this._updateDiff(n,t)}_updateDiff(n,t){try{this.style.setState(n)&&this._update(!0)}catch(i){_t(`Unable to perform style diff: ${i.message||i.error||i}.  Rebuilding the style from scratch.`),this._updateStyle(n,t)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(_t("There is no style added to the map."),!1)}_isValidId(n){return n==null?(this.fire(new xe(new Error("IDs can't be empty."))),!1):!ek(n)||(this.fire(new xe(new Error(`IDs can't contain special symbols: "${n}".`))),!1)}addSource(n,t){return this._isValidId(n)?(this._lazyInitEmptyStyle(),this.style.addSource(n,t),this._update(!0)):this}isSourceLoaded(n){return!!this._isValidId(n)&&!!this.style&&this.style._isSourceCacheLoaded(n)}areTilesLoaded(){const n=this.style&&this.style._sourceCaches;for(const t in n){const i=n[t]._tiles;for(const o in i){const c=i[o];if(c.state!=="loaded"&&c.state!=="errored")return!1}}return!0}addSourceType(n,t,i){this._lazyInitEmptyStyle(),this.style.addSourceType(n,t,i)}removeSource(n){return this._isValidId(n)?(this.style.removeSource(n),this._updateTerrain(),this._update(!0)):this}getSource(n){return this._isValidId(n)?this.style.getOwnSource(n):null}addImage(n,t,{pixelRatio:i=1,sdf:o=!1,stretchX:c,stretchY:u,content:d}={}){if(this._lazyInitEmptyStyle(),t instanceof w.HTMLImageElement||w.ImageBitmap&&t instanceof w.ImageBitmap){const{width:p,height:g,data:_}=Be.getImageData(t);this.style.addImage(n,{data:new Fr({width:p,height:g},_),pixelRatio:i,stretchX:c,stretchY:u,content:d,sdf:o,version:0})}else if(t.width===void 0||t.height===void 0)this.fire(new xe(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:p,height:g}=t,_=t;this.style.addImage(n,{data:new Fr({width:p,height:g},new Uint8Array(_.data)),pixelRatio:i,stretchX:c,stretchY:u,content:d,sdf:o,version:0,userImage:_}),_.onAdd&&_.onAdd(this,n)}}updateImage(n,t){this._lazyInitEmptyStyle();const i=this.style.getImage(n);if(!i)return void this.fire(new xe(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const o=t instanceof w.HTMLImageElement||w.ImageBitmap&&t instanceof w.ImageBitmap?Be.getImageData(t):t,{width:c,height:u}=o;c!==void 0&&u!==void 0?c===i.data.width&&u===i.data.height?(i.data.replace(o.data,!(t instanceof w.HTMLImageElement||w.ImageBitmap&&t instanceof w.ImageBitmap)),this.style.updateImage(n,i)):this.fire(new xe(new Error(`The width and height of the updated image (${c}, ${u})
                must be that same as the previous version of the image
                (${i.data.width}, ${i.data.height})`))):this.fire(new xe(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(n){return n?!!this.style&&!!this.style.getImage(n):(this.fire(new xe(new Error("Missing required image id"))),!1)}removeImage(n){this.style.removeImage(n)}loadImage(n,t){Ye(this._requestManager.transformRequest(n,zt.Image),(i,o)=>{t(i,o instanceof w.HTMLImageElement?Be.getImageData(o):o)})}listImages(){return this.style.listImages()}addModel(n,t){this._lazyInitEmptyStyle(),this.style.addModel(n,t)}hasModel(n){return n?this.style.hasModel(n):(this.fire(new xe(new Error("Missing required model id"))),!1)}removeModel(n){this.style.removeModel(n)}listModels(){return this.style.listModels()}addLayer(n,t){return this._isValidId(n.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(n,t),this._update(!0)):this}moveLayer(n,t){return this._isValidId(n)?(this.style.moveLayer(n,t),this._update(!0)):this}removeLayer(n){return this._isValidId(n)?(this.style.removeLayer(n),this._update(!0)):this}getLayer(n){return this._isValidId(n)?this.style.getOwnLayer(n):null}setLayerZoomRange(n,t,i){return this._isValidId(n)?(this.style.setLayerZoomRange(n,t,i),this._update(!0)):this}setFilter(n,t,i={}){return this._isValidId(n)?(this.style.setFilter(n,t,i),this._update(!0)):this}getFilter(n){return this._isValidId(n)?this.style.getFilter(n):null}setPaintProperty(n,t,i,o={}){return this._isValidId(n)?(this.style.setPaintProperty(n,t,i,o),this._update(!0)):this}getPaintProperty(n,t){return this._isValidId(n)?this.style.getPaintProperty(n,t):null}setLayoutProperty(n,t,i,o={}){return this._isValidId(n)?(this.style.setLayoutProperty(n,t,i,o),this._update(!0)):this}getLayoutProperty(n,t){return this._isValidId(n)?this.style.getLayoutProperty(n,t):null}getConfigProperty(n,t){return this.style.getConfigProperty(n,t)}setConfigProperty(n,t,i){return this.style.setConfigProperty(n,t,i),this._update(!0)}setLights(n){if(this._lazyInitEmptyStyle(),n&&n.length===1&&n[0].type==="flat"){const t=n[0];t.properties?this.style.setFlatLight(t.properties,t.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(n),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const n=this.style.getLights()||[];return n.length===0&&n.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),n}setLight(n,t={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:n}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(n){return this._lazyInitEmptyStyle(),!n&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(n),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(n){return this._lazyInitEmptyStyle(),this.style.setFog(n),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setCamera(n){return this.style.setCamera(n),this._triggerCameraUpdate(n)}_triggerCameraUpdate(n){return this._update(this.transform.setOrthographicProjectionAtLowPitch(n["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(n){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(Ze.convert(n),this.transform):0}setFeatureState(n,t){return this._isValidId(n.source)?(this.style.setFeatureState(n,t),this._update()):this}removeFeatureState(n,t){return this._isValidId(n.source)?(this.style.removeFeatureState(n,t),this._update()):this}getFeatureState(n){return this._isValidId(n.source)?this.style.getFeatureState(n):null}_updateContainerDimensions(){if(!this._container)return;const n=this._container.getBoundingClientRect().width||400,t=this._container.getBoundingClientRect().height||300;let i,o,c,u=this._container;for(;u&&(!o||!c);){const d=w.getComputedStyle(u).transform;d&&d!=="none"&&(i=d.match(/matrix.*\((.+)\)/)[1].split(", "),i[0]&&i[0]!=="0"&&i[0]!=="1"&&(o=i[0]),i[3]&&i[3]!=="0"&&i[3]!=="1"&&(c=i[3])),u=u.parentElement}this._containerWidth=o?Math.abs(n/o):n,this._containerHeight=c?Math.abs(t/c):t}_detectMissingCSS(){w.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&_t("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const n=this._container;n.classList.add("mapboxgl-map"),(this._missingCSSCanary=Nn("div","mapboxgl-canary",n)).style.visibility="hidden",this._detectMissingCSS();const t=this._canvasContainer=Nn("div","mapboxgl-canvas-container",n);this._canvas=Nn("canvas","mapboxgl-canvas",t),this._interactive&&(t.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const i=this._controlContainer=Nn("div","mapboxgl-control-container",n),o=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(c=>{o[c]=Nn("div",`mapboxgl-ctrl-${c}`,i)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(n,t){const i=Be.devicePixelRatio||1;this._canvas.width=i*Math.ceil(n),this._canvas.height=i*Math.ceil(t),this._canvas.style.width=`${n}px`,this._canvas.style.height=`${t}px`}_addMarker(n){this._markers.push(n)}_removeMarker(n){const t=this._markers.indexOf(n);t!==-1&&this._markers.splice(t,1)}_addPopup(n){this._popups.push(n)}_removePopup(n){const t=this._popups.indexOf(n);t!==-1&&this._popups.splice(t,1)}_setupPainter(){const n=Ct({},Hl.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),t=this._canvas.getContext("webgl2",n);t?(Bh(t,!0),this.painter=new mX(t,this._contextCreateOptions,this.transform),this.on("data",i=>{i.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),R.testSupport(t)):this.fire(new xe(new Error("Failed to initialize WebGL")))}_contextLost(n){n.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new Bt("webglcontextlost",{originalEvent:n}))}_contextRestored(n){this._setupPainter(),this.resize(),this._update(),this.fire(new Bt("webglcontextrestored",{originalEvent:n}))}_onMapScroll(n){if(n.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(n){return this.style?(this._styleDirty=this._styleDirty||n,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(n){return this._update(),this._renderTaskQueue.add(n)}_cancelRenderFrame(n){this._renderTaskQueue.remove(n)}_requestDomTask(n){!this.loaded()||this.loaded()&&!this.isMoving()?n():this._domRenderTaskQueue.add(n)}_render(n){let t;this.fire(new Bt("renderstart"));const i=this.painter.context.extTimerQuery,o=Be.now(),c=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(t=c.createQuery(),c.beginQuery(i.TIME_ELAPSED_EXT,t)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],w.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],w.performance.now())),this._renderTaskQueue.run(n),this._domRenderTaskQueue.run(n),this._removed)return;this._updateProjectionTransition();const u=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const g=this.transform.zoom,_=this.transform.pitch,v=Be.now(),b=new pr(g,{now:v,fadeDuration:u,pitch:_,transition:this.style.transition});this.style.update(b)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let d=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),d=this._updateAverageElevation(o),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):d=this._updateAverageElevation(o),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,u,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:u,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new Bt("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new Bt("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),t){const g=Be.now()-o;c.endQuery(i.TIME_ELAPSED_EXT),setTimeout(()=>{const _=c.getQueryParameter(t,c.QUERY_RESULT)/1e6;c.deleteQuery(t),this.fire(new Bt("gpu-timing-frame",{cpuTime:g,gpuTime:_})),w.performance.mark("frame-gpu",{startTime:o,detail:{gpuTime:_}})},50)}if(this.listens("gpu-timing-layer")){const g=this.painter.collectGpuTimers();setTimeout(()=>{const _=this.painter.queryGpuTimers(g);this.fire(new Bt("gpu-timing-layer",{layerTimes:_}))},50)}if(this.listens("gpu-timing-deferred-render")){const g=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const _=this.painter.queryGpuTimeDeferredRender(g);this.fire(new Bt("gpu-timing-deferred-render",{gpuTime:_}))},50)}const p=this._sourcesDirty||this._styleDirty||this._placementDirty||d;if(p||this._repaint)this.triggerRepaint();else{const g=!this.isMoving()&&this.loaded();if(g&&(d=this._updateAverageElevation(o,!0)),d)this.triggerRepaint();else if(this._triggerFrame(!1),g&&(this.fire(new Bt("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const _=this._calculateSpeedIndex();this.fire(new Bt("speedindexcompleted",{speedIndex:_})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||p||(this._fullyLoaded=!0,jh.mark(Go.fullLoad),this._performanceMetricsCollection&&Fh(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(n){for(const t of this._markers)n&&!this.getRenderWorldCopies()&&(t._lngLat=t._lngLat.wrap()),t._update();for(const t of this._popups)!n||this.getRenderWorldCopies()||t._trackPointer||(t._lngLat=t._lngLat.wrap()),t._update()}_updateAverageElevation(n,t=!1){const i=c=>(this.transform.averageElevation=c,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&i(0);const o=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(o||(t||n-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(n)){const c=this.transform.averageElevation;let u=this.transform.sampleAverageElevation();this.transform.elevation&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(u)?u=0:this._averageElevationLastSampledAt=n;const d=Math.abs(c-u);if(d>1){if(this._isInitialLoad||o)return this._averageElevation.jumpTo(u),i(u);this._averageElevation.easeTo(u,n,300)}else if(d>1e-4)return this._averageElevation.jumpTo(u),i(u)}return!!this._averageElevation.isEasing(n)&&i(this._averageElevation.getValue(n))}_authenticate(){Rf(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,n=>{if(n&&(n.message===In||n.status===401)){const t=this.painter.context.gl;Bh(t,!1),this._logoControl instanceof az&&this._logoControl._updateLogo(),t&&t.clear(t.DEPTH_BUFFER_BIT|t.COLOR_BUFFER_BIT|t.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new xe(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),Df(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const n=this._isDragging();this.painter.updateTerrain(this.style,n)}_calculateSpeedIndex(){const n=this.painter.canvasCopy(),t=this.painter.getCanvasCopiesAndTimestamps();t.timeStamps.push(performance.now());const i=this.painter.context.gl,o=i.createFramebuffer();function c(u){i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,u,0);const d=new Uint8Array(i.drawingBufferWidth*i.drawingBufferHeight*4);return i.readPixels(0,0,i.drawingBufferWidth,i.drawingBufferHeight,i.RGBA,i.UNSIGNED_BYTE,d),d}return i.bindFramebuffer(i.FRAMEBUFFER,o),this._canvasPixelComparison(c(n),t.canvasCopies.map(c),t.timeStamps)}_canvasPixelComparison(n,t,i){let o=i[1]-i[0];const c=n.length/4;for(let u=0;u<t.length;u++){const d=t[u];let p=0;for(let g=0;g<d.length;g+=4)d[g]===n[g]&&d[g+1]===n[g+1]&&d[g+2]===n[g+2]&&d[g+3]===n[g+3]&&(p+=1);o+=(i[u+2]-i[u+1])*(1-p/c)}return o}remove(){this._hash&&this._hash.remove();for(const t of this._controls)t.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),w!==void 0&&(w.removeEventListener("resize",this._onWindowResize,!1),w.removeEventListener("orientationchange",this._onWindowResize,!1),w.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),w.removeEventListener("online",this._onWindowOnline,!1),w.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const n=this.painter.context.gl.getExtension("WEBGL_lose_context");n&&n.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),Ya.delete(this.painter.context.gl),this._removed=!0,this.fire(new Bt("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(n){this._renderNextFrame=this._renderNextFrame||n,this.style&&!this._frame&&(this._frame=Be.frame(t=>{const i=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,i&&this._render(t)}))}_preloadTiles(n){return kt(this.style?Object.values(this.style._sourceCaches):[],(t,i)=>t._preloadTiles(n,i),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(n){this._trackResize&&this.resize({originalEvent:n})._update()}_onVisibilityChange(){w.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(n){this._showTileBoundaries!==n&&(this._showTileBoundaries=n,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(n){this._showTerrainWireframe!==n&&(this._showTerrainWireframe=n,this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(n){this._showLayers2DWireframe!==n&&(this._showLayers2DWireframe=n,this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(n){this._showLayers3DWireframe!==n&&(this._showLayers3DWireframe=n,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(n){this._speedIndexTiming!==n&&(this._speedIndexTiming=n,this._update())}get showPadding(){return!!this._showPadding}set showPadding(n){this._showPadding!==n&&(this._showPadding=n,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(n){this._showCollisionBoxes!==n&&(this._showCollisionBoxes=n,n?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(n){this._showOverdrawInspector!==n&&(this._showOverdrawInspector=n,this._update())}get repaint(){return!!this._repaint}set repaint(n){this._repaint!==n&&(this._repaint=n,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(n){this._vertices=n,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(n){this._showTileAABBs!==n&&(this._showTileAABBs=n,n&&this._update())}_setCacheLimits(n,t){(function(i,o){ai=i,Wr=o})(n,t)}get version(){return T}},NavigationControl:class{constructor(n){this.options=Ct({},aY,n),this._container=Nn("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(Ne(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",t=>{this._map&&this._map.zoomIn({},{originalEvent:t})}),Nn("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",t=>{this._map&&this._map.zoomOut({},{originalEvent:t})}),Nn("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(Ne(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",t=>{const i=this._map;i&&(this.options.visualizePitch?i.resetNorthPitch({},{originalEvent:t}):i.resetNorth({},{originalEvent:t}))}),this._compassIcon=Nn("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const n=this._map;if(!n)return;const t=n.getZoom(),i=t===n.getMaxZoom(),o=t===n.getMinZoom();this._zoomInButton.disabled=i,this._zoomOutButton.disabled=o,this._zoomInButton.setAttribute("aria-disabled",i.toString()),this._zoomOutButton.setAttribute("aria-disabled",o.toString())}_rotateCompassArrow(){const n=this._map;if(!n)return;const t=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(n.transform.pitch*(Math.PI/180)),.5)}) rotateX(${n.transform.pitch}deg) rotateZ(${n.transform.angle*(180/Math.PI)}deg)`:`rotate(${n.transform.angle*(180/Math.PI)}deg)`;n._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=t)})}onAdd(n){return this._map=n,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),n.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&n.on("pitch",this._rotateCompassArrow),n.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new lY(n,this._compass,this.options.visualizePitch)),this._container}onRemove(){const n=this._map;n&&(this._container.remove(),this.options.showZoom&&n.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&n.off("pitch",this._rotateCompassArrow),n.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(n,t){const i=Nn("button",n,this._container);return i.type="button",i.addEventListener("click",t),i}_setButtonTitle(n,t){if(!this._map)return;const i=this._map._getUIString(`NavigationControl.${t}`);n.setAttribute("aria-label",i),n.firstElementChild&&n.firstElementChild.setAttribute("title",i)}},GeolocateControl:class extends Mn{constructor(n){super(),this.options=Ct({geolocation:w.navigator.geolocation},cY,n),Ne(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=J3(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(n){return this._map=n,this._container=Nn("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(n){const t=(i=!!this.options.geolocation)=>{this._supportsGeolocation=i,n(i)};this._supportsGeolocation!==void 0?n(this._supportsGeolocation):w.navigator.permissions!==void 0?w.navigator.permissions.query({name:"geolocation"}).then(i=>t(i.state!=="denied")).catch(()=>t()):t()}_isOutOfMapMaxBounds(n){const t=this._map.getMaxBounds(),i=n.coords;return!!t&&(i.longitude<t.getWest()||i.longitude>t.getEast()||i.latitude<t.getSouth()||i.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(n){if(this._map){if(this._isOutOfMapMaxBounds(n))return this._setErrorState(),this.fire(new Bt("outofmaxbounds",n)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=n,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(n),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(n),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new Bt("geolocate",n)),this._finish()}}_updateCamera(n){const t=new Ze(n.coords.longitude,n.coords.latitude),i=n.coords.accuracy,o=Ct({bearing:this._map.getBearing()},this.options.fitBoundsOptions);this._map.fitBounds(t.toBounds(i),o,{geolocateSource:!0})}_updateMarker(n){if(n){const t=new Ze(n.coords.longitude,n.coords.latitude);this._accuracyCircleMarker.setLngLat(t).addTo(this._map),this._userLocationDotMarker.setLngLat(t).addTo(this._map),this._accuracy=n.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const n=this._map.transform,t=$n(1,n._center.lat)*n.worldSize,i=Math.ceil(2*this._accuracy*t);this._circleElement.style.width=`${i}px`,this._circleElement.style.height=`${i}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(n){if(this._map){if(this.options.trackUserLocation)if(n.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(n.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new Bt("error",n)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(n){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",t=>t.preventDefault()),this._geolocateButton=Nn("button","mapboxgl-ctrl-geolocate",this._container),Nn("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",n===!1){_t("Geolocation support is not available so the GeolocateControl will be disabled.");const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t)}else{const t=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Nn("div","mapboxgl-user-location"),this._dotElement.appendChild(Nn("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(Nn("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new BS({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=Nn("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new BS({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",t=>{t.geolocateSource||this._watchState!=="ACTIVE_LOCK"||t.originalEvent&&t.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new Bt("trackuserlocationend")))})}}_onDeviceOrientation(n){this._userLocationDotMarker&&(n.webkitCompassHeading?this._heading=n.webkitCompassHeading:n.absolute===!0&&(this._heading=-1*n.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return _t("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new Bt("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new Bt("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new Bt("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let n;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(n={maximumAge:6e5,timeout:0},this._noTimeout=!0):(n=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,n),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const n=()=>{w.addEventListener("ondeviceorientationabsolute"in w?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};w.DeviceMotionEvent!==void 0&&typeof w.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(t=>{t==="granted"&&n()}).catch(console.error):n()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),w.removeEventListener("deviceorientation",this._onDeviceOrientation),w.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:oz,ScaleControl:class{constructor(n){this.options=Ct({},uY,n),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),Ne(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const n=this.options.maxWidth||100,t=this._map,i=t._containerHeight/2,o=t._containerWidth/2-n/2,c=t.unproject([o,i]),u=t.unproject([o+n,i]),d=c.distanceTo(u);if(this.options.unit==="imperial"){const p=3.2808*d;p>5280?this._setScale(n,p/5280,"mile"):this._setScale(n,p,"foot")}else this.options.unit==="nautical"?this._setScale(n,d/1852,"nautical-mile"):d>=1e3?this._setScale(n,d/1e3,"kilometer"):this._setScale(n,d,"meter")}_setScale(n,t,i){this._map._requestDomTask(()=>{const o=function(u){const d=Math.pow(10,`${Math.floor(u)}`.length-1);let p=u/d;return p=p>=10?10:p>=5?5:p>=3?3:p>=2?2:p>=1?1:function(g){const _=Math.pow(10,Math.ceil(-Math.log(g)/Math.LN10));return Math.round(g*_)/_}(p),d*p}(t),c=o/t;this._container.innerHTML=this._isNumberFormatSupported&&i!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:i}).format(o):`${o}&nbsp;${hY[i]}`,this._container.style.width=n*c+"px"})}onAdd(n){return this._map=n,this._language=n.getLanguage(),this._container=Nn("div","mapboxgl-ctrl mapboxgl-ctrl-scale",n.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(n){this._language=n,this._update()}setUnit(n){this.options.unit=n,this._update()}},FullscreenControl:class{constructor(n){this._fullscreen=!1,n&&n.container&&(n.container instanceof w.HTMLElement?this._container=n.container:_t("Full screen control 'container' must be a DOM element.")),Ne(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in w.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in w.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(n){return this._map=n,this._container||(this._container=this._map.getContainer()),this._controlContainer=Nn("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",_t("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,w.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!w.document.fullscreenEnabled&&!w.document.webkitFullscreenEnabled)}_setupUI(){const n=this._fullscreenButton=Nn("button","mapboxgl-ctrl-fullscreen",this._controlContainer);Nn("span","mapboxgl-ctrl-icon",n).setAttribute("aria-hidden","true"),n.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),w.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const n=this._getTitle();this._fullscreenButton.setAttribute("aria-label",n),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",n)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(w.document.fullscreenElement||w.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?w.document.exitFullscreen?w.document.exitFullscreen():w.document.webkitCancelFullScreen&&w.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends Mn{constructor(n){super(),this.options=Ct(Object.create(nY),n),Ne(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(n&&n.className?n.className.trim().split(/\s+/):[])}addTo(n){return this._map&&this.remove(),this._map=n,this.options.closeOnClick&&n.on("preclick",this._onClose),this.options.closeOnMove&&n.on("move",this._onClose),n.on("remove",this.remove),this._update(),n._addPopup(this),this._focusFirstElement(),this._trackPointer?(n.on("mousemove",this._onMouseEvent),n.on("mouseup",this._onMouseEvent),n._canvasContainer.classList.add("mapboxgl-track-pointer")):n.on("move",this._update),this.fire(new Bt("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const n=this._map;return n&&(n.off("move",this._update),n.off("move",this._onClose),n.off("preclick",this._onClose),n.off("click",this._onClose),n.off("remove",this.remove),n.off("mousemove",this._onMouseEvent),n.off("mouseup",this._onMouseEvent),n.off("drag",this._onMouseEvent),n._canvasContainer&&n._canvasContainer.classList.remove("mapboxgl-track-pointer"),n._removePopup(this),this._map=void 0),this.fire(new Bt("close")),this}getLngLat(){return this._lngLat}setLngLat(n){this._lngLat=Ze.convert(n),this._pos=null,this._trackPointer=!1,this._update();const t=this._map;return t&&(t.on("move",this._update),t.off("mousemove",this._onMouseEvent),t._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const n=this._map;return n&&(n.off("move",this._update),n.on("mousemove",this._onMouseEvent),n.on("drag",this._onMouseEvent),n._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(n){return this.setDOMContent(w.document.createTextNode(n))}setHTML(n){const t=w.document.createDocumentFragment(),i=w.document.createElement("body");let o;for(i.innerHTML=n;o=i.firstChild,o;)t.appendChild(o);return this.setDOMContent(t)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(n){return this.options.maxWidth=n,this._update(),this}setDOMContent(n){let t=this._content;if(t)for(;t.hasChildNodes();)t.firstChild&&t.removeChild(t.firstChild);else t=this._content=Nn("div","mapboxgl-popup-content",this._container||void 0);if(t.appendChild(n),this.options.closeButton){const i=this._closeButton=Nn("button","mapboxgl-popup-close-button",t);i.type="button",i.setAttribute("aria-label","Close popup"),i.setAttribute("aria-hidden","true"),i.innerHTML="&#215;",i.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(n){return this._classList.add(n),this._updateClassList(),this}removeClassName(n){return this._classList.delete(n),this._updateClassList(),this}setOffset(n){return this.options.offset=n,this._update(),this}toggleClassName(n){let t;return this._classList.delete(n)?t=!1:(this._classList.add(n),t=!0),this._updateClassList(),t}_onMouseEvent(n){this._update(n.point)}_getAnchor(n){if(this.options.anchor)return this.options.anchor;const t=this._map,i=this._container,o=this._pos;if(!t||!i||!o)return"bottom";const c=i.offsetWidth,u=i.offsetHeight,d=o.x<c/2,p=o.x>t.transform.width-c/2;if(o.y+n<u)return d?"top-left":p?"top-right":"top";if(o.y>t.transform.height-u){if(d)return"bottom-left";if(p)return"bottom-right"}return d?"left":p?"right":"bottom"}_updateClassList(){const n=this._container;if(!n)return;const t=[...this._classList];t.push("mapboxgl-popup"),this._anchor&&t.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&t.push("mapboxgl-popup-track-pointer"),n.className=t.join(" ")}_update(n){const t=this._map,i=this._content;if(!t||!this._lngLat&&!this._trackPointer||!i)return;let o=this._container;if(o||(o=this._container=Nn("div","mapboxgl-popup",t.getContainer()),this._tip=Nn("div","mapboxgl-popup-tip",o),o.appendChild(i)),this.options.maxWidth&&o.style.maxWidth!==this.options.maxWidth&&(o.style.maxWidth=this.options.maxWidth),t.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=cz(this._lngLat,this._pos,t.transform)),!this._trackPointer||n){const c=this._pos=this._trackPointer&&n?n:t.project(this._lngLat),u=uz(this.options.offset),d=this._anchor=this._getAnchor(u.y),p=uz(this.options.offset,d),g=c.add(p).round();t._requestDomTask(()=>{this._container&&d&&(this._container.style.transform=`${FS[d]} translate(${g.x}px,${g.y}px)`)})}if(!this._marker&&t._showingGlobe()){const c=C_(t.transform,this._lngLat)?0:1;this._setOpacity(c)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const n=this._container.querySelector(rY);n&&n.focus()}_onClose(){this.remove()}_setOpacity(n){this._container&&(this._container.style.opacity=`${n}`),this._content&&(this._content.style.pointerEvents=n?"auto":"none")}},Marker:BS,Style:na,LngLat:Ze,LngLatBounds:Os,Point:W,MercatorCoordinate:vn,FreeCameraOptions:bO,Evented:Mn,config:I,prewarm:function(){Dp().acquire(cS)},clearPrewarmedResources:function(){const n=kp;n&&(n.isPreloaded()&&n.numActive()===1?(n.release(cS),kp=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return I.ACCESS_TOKEN},set accessToken(n){I.ACCESS_TOKEN=n},get baseApiUrl(){return I.API_URL},set baseApiUrl(n){I.API_URL=n},get workerCount(){return Ad.workerCount},set workerCount(n){Ad.workerCount=n},get maxParallelImageRequests(){return I.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(n){I.MAX_PARALLEL_IMAGE_REQUESTS=n},clearStorage(n){(function(t){if(!Jr())return;const i=w.caches.delete(En);t&&i.catch(t).then(()=>t())})(n)},workerUrl:"",workerClass:null,get dracoUrl(){return zL()},set dracoUrl(n){(function(t){uS=Be.resolveURL(t),hS||(hS=new Gu(Dp(),new Mn)),hS.broadcast("setDracoUrl",uS)})(n)},setNow:Be.setNow,restoreNow:Be.restoreNow};x.A=AL,x.D=H_,x.E=Dt,x.F=Dw,x.K=Py,x.O=Pn,x.P=W,x.T=HO,x.V=V_,x.a=j_,x.b=TR,x.c=xy,x.d=class extends Mn{constructor(n,t,i,o,c,u){super(),this.actor=n,this.layerIndex=t,this.availableImages=i,this.loadVectorData=c||OL,this.loading={},this.loaded={},this.deduped=new RL(n.scheduler),this.isSpriteLoaded=o,this.scheduler=n.scheduler,this.brightness=u}loadTile(n,t){const i=n.uid,o=n&&n.request,c=o&&o.collectResourceTiming,u=this.loading[i]=new kq(n);u.abort=this.loadVectorData(n,(d,p)=>{const g=!this.loading[i];if(delete this.loading[i],g||d||!p)return u.status="done",g||(this.loaded[i]=u),t(d);const _=p.rawData,v={};p.expires&&(v.expires=p.expires),p.cacheControl&&(v.cacheControl=p.cacheControl),u.vectorTile=p.vectorTile||new Iw(new W_(_));const b=()=>{u.parse(u.vectorTile,this.layerIndex,this.availableImages,this.actor,(S,E)=>{if(S||!E)return t(S);const A={};if(c){const C=Vh(o);C.length>0&&(A.resourceTiming=JSON.parse(JSON.stringify(C)))}t(null,Ct({rawTileData:_.slice(0)},E,v,A))})};this.isSpriteLoaded?b():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(b,{type:"parseTile",isSymbolTile:n.isSymbolTile,zoom:n.tileZoom}):b()}),this.loaded=this.loaded||{},this.loaded[i]=u})}reloadTile(n,t){const i=this.loaded,o=n.uid,c=this;if(i&&i[o]){const u=i[o];u.showCollisionBoxes=n.showCollisionBoxes,u.projection=n.projection,u.brightness=n.brightness,u.tileTransform=Bu(n.tileID.canonical,n.projection),u.extraShadowCaster=n.extraShadowCaster;const d=(p,g)=>{const _=u.reloadCallback;_&&(delete u.reloadCallback,u.parse(u.vectorTile,c.layerIndex,this.availableImages,c.actor,_)),t(p,g)};u.status==="parsing"?u.reloadCallback=d:u.status==="done"&&(u.vectorTile?u.parse(u.vectorTile,this.layerIndex,this.availableImages,this.actor,d):d())}else t(null,void 0)}abortTile(n,t){const i=n.uid,o=this.loading[i];o&&(o.abort&&o.abort(),delete this.loading[i]),t()}removeTile(n,t){const i=this.loaded,o=n.uid;i&&i[o]&&delete i[o],t()}},x.e=tc,x.f=Vh,x.g=H,x.h=Kt,x.i=oe,x.j=function(n,t){const i=_S(n);for(const o of i){for(const c of o.meshes)Vq(c);o.lights&&(o.lightMeshIndex=o.meshes.length,o.meshes.push(Uq(o.lights,t)))}return i},x.k=pr,x.l=function(n){let t=0;if(new Uint32Array(n,0,1)[0]!==FL){const i=new Uint32Array(n,0,7),[,,o,c,u,d]=i;t=i.byteLength+c+u+d+u,(o!==n.byteLength||t>=n.byteLength)&&_t("Invalid b3dm header information.")}return UL(n,t)},x.m=ey,x.n=To,x.o=Bt,x.p=et,x.q=function(n){Ei(),pi&&pi.then(t=>{t.keys().then(i=>{for(let o=0;o<i.length-n;o++)t.delete(i[o])})})},x.r=qL,x.s=Wy,x.t=ap,x.v=Wt,x.w=w}),m(["./shared"],function(x){function w(Qt){if(typeof Qt=="number"||typeof Qt=="boolean"||typeof Qt=="string"||Qt==null)return JSON.stringify(Qt);if(Array.isArray(Qt)){let lt="[";for(const _t of Qt)lt+=`${w(_t)},`;return`${lt}]`}let ot="{";for(const lt of Object.keys(Qt).sort())ot+=`${lt}:${w(Qt[lt])},`;return`${ot}}`}function T(Qt){let ot="";for(const lt of x.r)ot+=`/${w(Qt[lt])}`;return ot}class M{constructor(ot){this.keyCache={},this._layers={},this._layerConfigs={},ot&&this.replace(ot)}replace(ot,lt){this._layerConfigs={},this._layers={},this.update(ot,[],lt)}update(ot,lt,_t){this._options=_t;for(const Ht of ot){this._layerConfigs[Ht.id]=Ht;const ge=this._layers[Ht.id]=x.c(Ht,this._options);ge.setScope(this.scope),ge.compileFilter(),this.keyCache[Ht.id]&&delete this.keyCache[Ht.id]}for(const Ht of lt)delete this.keyCache[Ht],delete this._layerConfigs[Ht],delete this._layers[Ht];this.familiesBySource={};const Ut=function(Ht,ge){const Ee={};for(let ke=0;ke<Ht.length;ke++){const Ve=ge&&ge[Ht[ke].id]||T(Ht[ke]);ge&&(ge[Ht[ke].id]=Ve);let $e=Ee[Ve];$e||($e=Ee[Ve]=[]),$e.push(Ht[ke])}const qt=[];for(const ke in Ee)qt.push(Ee[ke]);return qt}(x.v(this._layerConfigs),this.keyCache);for(const Ht of Ut){const ge=Ht.map(Un=>this._layers[Un.id]),Ee=ge[0];if(Ee.visibility==="none")continue;const qt=Ee.source||"";let ke=this.familiesBySource[qt];ke||(ke=this.familiesBySource[qt]={});const Ve=Ee.sourceLayer||"_geojsonTileLayer";let $e=ke[Ve];$e||($e=ke[Ve]=[]),$e.push(ge)}}}class I{loadTile(ot,lt){const{uid:_t,encoding:Ut,rawImageData:Ht,padding:ge}=ot,Ee=x.w.ImageBitmap&&Ht instanceof x.w.ImageBitmap?this.getImageData(Ht,ge):Ht;lt(null,new x.D(_t,Ee,Ut,ge<1))}getImageData(ot,lt){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ot.width,ot.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=ot.width,this.offscreenCanvas.height=ot.height,this.offscreenCanvasContext.drawImage(ot,0,0,ot.width,ot.height);const _t=this.offscreenCanvasContext.getImageData(-lt,-lt,ot.width+2*lt,ot.height+2*lt);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),_t}}function R(Qt,ot){if(Qt.length!==0){O(Qt[0],ot);for(var lt=1;lt<Qt.length;lt++)O(Qt[lt],!ot)}}function O(Qt,ot){for(var lt=0,_t=0,Ut=0,Ht=Qt.length,ge=Ht-1;Ut<Ht;ge=Ut++){var Ee=(Qt[Ut][0]-Qt[ge][0])*(Qt[ge][1]+Qt[Ut][1]),qt=lt+Ee;_t+=Math.abs(lt)>=Math.abs(Ee)?lt-qt+Ee:Ee-qt+lt,lt=qt}lt+_t>=0!=!!ot&&Qt.reverse()}var N=x.g(function Qt(ot,lt){var _t,Ut=ot&&ot.type;if(Ut==="FeatureCollection")for(_t=0;_t<ot.features.length;_t++)Qt(ot.features[_t],lt);else if(Ut==="GeometryCollection")for(_t=0;_t<ot.geometries.length;_t++)Qt(ot.geometries[_t],lt);else if(Ut==="Feature")Qt(ot.geometry,lt);else if(Ut==="Polygon")R(ot.coordinates,lt);else if(Ut==="MultiPolygon")for(_t=0;_t<ot.coordinates.length;_t++)R(ot.coordinates[_t],lt);return ot});const G=x.V.prototype.toGeoJSON;var $={exports:{}},z=x.p,B=x.a.VectorTileFeature,H=K;function K(Qt,ot){this.options=ot||{},this.features=Qt,this.length=Qt.length}function at(Qt,ot){this.id=typeof Qt.id=="number"?Qt.id:void 0,this.type=Qt.type,this.rawGeometry=Qt.type===1?[Qt.geometry]:Qt.geometry,this.properties=Qt.tags,this.extent=ot||4096}K.prototype.feature=function(Qt){return new at(this.features[Qt],this.options.extent)},at.prototype.loadGeometry=function(){var Qt=this.rawGeometry;this.geometry=[];for(var ot=0;ot<Qt.length;ot++){for(var lt=Qt[ot],_t=[],Ut=0;Ut<lt.length;Ut++)_t.push(new z(lt[Ut][0],lt[Ut][1]));this.geometry.push(_t)}return this.geometry},at.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Qt=this.geometry,ot=1/0,lt=-1/0,_t=1/0,Ut=-1/0,Ht=0;Ht<Qt.length;Ht++)for(var ge=Qt[Ht],Ee=0;Ee<ge.length;Ee++){var qt=ge[Ee];ot=Math.min(ot,qt.x),lt=Math.max(lt,qt.x),_t=Math.min(_t,qt.y),Ut=Math.max(Ut,qt.y)}return[ot,_t,lt,Ut]},at.prototype.toGeoJSON=B.prototype.toGeoJSON;var ft=x.b,et=H;function nt(Qt){var ot=new ft;return function(lt,_t){for(var Ut in lt.layers)_t.writeMessage(3,W,lt.layers[Ut])}(Qt,ot),ot.finish()}function W(Qt,ot){var lt;ot.writeVarintField(15,Qt.version||1),ot.writeStringField(1,Qt.name||""),ot.writeVarintField(5,Qt.extent||4096);var _t={keys:[],values:[],keycache:{},valuecache:{}};for(lt=0;lt<Qt.length;lt++)_t.feature=Qt.feature(lt),ot.writeMessage(2,Q,_t);var Ut=_t.keys;for(lt=0;lt<Ut.length;lt++)ot.writeStringField(3,Ut[lt]);var Ht=_t.values;for(lt=0;lt<Ht.length;lt++)ot.writeMessage(4,Rt,Ht[lt])}function Q(Qt,ot){var lt=Qt.feature;lt.id!==void 0&&ot.writeVarintField(1,lt.id),ot.writeMessage(2,yt,Qt),ot.writeVarintField(3,lt.type),ot.writeMessage(4,St,lt)}function yt(Qt,ot){var lt=Qt.feature,_t=Qt.keys,Ut=Qt.values,Ht=Qt.keycache,ge=Qt.valuecache;for(var Ee in lt.properties){var qt=lt.properties[Ee],ke=Ht[Ee];if(qt!==null){ke===void 0&&(_t.push(Ee),Ht[Ee]=ke=_t.length-1),ot.writeVarint(ke);var Ve=typeof qt;Ve!=="string"&&Ve!=="boolean"&&Ve!=="number"&&(qt=JSON.stringify(qt));var $e=Ve+":"+qt,Un=ge[$e];Un===void 0&&(Ut.push(qt),ge[$e]=Un=Ut.length-1),ot.writeVarint(Un)}}}function Pt(Qt,ot){return(ot<<3)+(7&Qt)}function st(Qt){return Qt<<1^Qt>>31}function St(Qt,ot){for(var lt=Qt.loadGeometry(),_t=Qt.type,Ut=0,Ht=0,ge=lt.length,Ee=0;Ee<ge;Ee++){var qt=lt[Ee],ke=1;_t===1&&(ke=qt.length),ot.writeVarint(Pt(1,ke));for(var Ve=_t===3?qt.length-1:qt.length,$e=0;$e<Ve;$e++){$e===1&&_t!==1&&ot.writeVarint(Pt(2,Ve-1));var Un=qt[$e].x-Ut,or=qt[$e].y-Ht;ot.writeVarint(st(Un)),ot.writeVarint(st(or)),Ut+=Un,Ht+=or}_t===3&&ot.writeVarint(Pt(7,1))}}function Rt(Qt,ot){var lt=typeof Qt;lt==="string"?ot.writeStringField(1,Qt):lt==="boolean"?ot.writeBooleanField(7,Qt):lt==="number"&&(Qt%1!=0?ot.writeDoubleField(3,Qt):Qt<0?ot.writeSVarintField(6,Qt):ot.writeVarintField(5,Qt))}$.exports=nt,$.exports.fromVectorTileJs=nt,$.exports.fromGeojsonVt=function(Qt,ot){ot=ot||{};var lt={};for(var _t in Qt)lt[_t]=new et(Qt[_t].features,ot),lt[_t].name=_t,lt[_t].version=ot.version,lt[_t].extent=ot.extent;return nt({layers:lt})},$.exports.GeoJSONWrapper=et;var Zt=x.g($.exports);const Ft={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Qt=>Qt},$t=Math.fround||(ee=new Float32Array(1),Qt=>(ee[0]=+Qt,ee[0]));var ee;const se=3,Ot=5,Me=6;class me{constructor(ot){this.options=Object.assign(Object.create(Ft),ot),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ot){const{log:lt,minZoom:_t,maxZoom:Ut}=this.options;lt&&console.time("total time");const Ht=`prepare ${ot.length} points`;lt&&console.time(Ht),this.points=ot;const ge=[];for(let qt=0;qt<ot.length;qt++){const ke=ot[qt];if(!ke.geometry)continue;const[Ve,$e]=ke.geometry.coordinates,Un=$t(Ct(Ve)),or=$t(Ae($e));ge.push(Un,or,1/0,qt,-1,1),this.options.reduce&&ge.push(0)}let Ee=this.trees[Ut+1]=this._createTree(ge);lt&&console.timeEnd(Ht);for(let qt=Ut;qt>=_t;qt--){const ke=+Date.now();Ee=this.trees[qt]=this._createTree(this._cluster(Ee,qt)),lt&&console.log("z%d: %d clusters in %dms",qt,Ee.numItems,+Date.now()-ke)}return lt&&console.timeEnd("total time"),this}getClusters(ot,lt){let _t=((ot[0]+180)%360+360)%360-180;const Ut=Math.max(-90,Math.min(90,ot[1]));let Ht=ot[2]===180?180:((ot[2]+180)%360+360)%360-180;const ge=Math.max(-90,Math.min(90,ot[3]));if(ot[2]-ot[0]>=360)_t=-180,Ht=180;else if(_t>Ht){const $e=this.getClusters([_t,Ut,180,ge],lt),Un=this.getClusters([-180,Ut,Ht,ge],lt);return $e.concat(Un)}const Ee=this.trees[this._limitZoom(lt)],qt=Ee.range(Ct(_t),Ae(ge),Ct(Ht),Ae(Ut)),ke=Ee.data,Ve=[];for(const $e of qt){const Un=this.stride*$e;Ve.push(ke[Un+Ot]>1?kt(ke,Un,this.clusterProps):this.points[ke[Un+se]])}return Ve}getChildren(ot){const lt=this._getOriginId(ot),_t=this._getOriginZoom(ot),Ut="No cluster with the specified id.",Ht=this.trees[_t];if(!Ht)throw new Error(Ut);const ge=Ht.data;if(lt*this.stride>=ge.length)throw new Error(Ut);const Ee=this.options.radius/(this.options.extent*Math.pow(2,_t-1)),qt=Ht.within(ge[lt*this.stride],ge[lt*this.stride+1],Ee),ke=[];for(const Ve of qt){const $e=Ve*this.stride;ge[$e+4]===ot&&ke.push(ge[$e+Ot]>1?kt(ge,$e,this.clusterProps):this.points[ge[$e+se]])}if(ke.length===0)throw new Error(Ut);return ke}getLeaves(ot,lt,_t){const Ut=[];return this._appendLeaves(Ut,ot,lt=lt||10,_t=_t||0,0),Ut}getTile(ot,lt,_t){const Ut=this.trees[this._limitZoom(ot)],Ht=Math.pow(2,ot),{extent:ge,radius:Ee}=this.options,qt=Ee/ge,ke=(_t-qt)/Ht,Ve=(_t+1+qt)/Ht,$e={features:[]};return this._addTileFeatures(Ut.range((lt-qt)/Ht,ke,(lt+1+qt)/Ht,Ve),Ut.data,lt,_t,Ht,$e),lt===0&&this._addTileFeatures(Ut.range(1-qt/Ht,ke,1,Ve),Ut.data,Ht,_t,Ht,$e),lt===Ht-1&&this._addTileFeatures(Ut.range(0,ke,qt/Ht,Ve),Ut.data,-1,_t,Ht,$e),$e.features.length?$e:null}getClusterExpansionZoom(ot){let lt=this._getOriginZoom(ot)-1;for(;lt<=this.options.maxZoom;){const _t=this.getChildren(ot);if(lt++,_t.length!==1)break;ot=_t[0].properties.cluster_id}return lt}_appendLeaves(ot,lt,_t,Ut,Ht){const ge=this.getChildren(lt);for(const Ee of ge){const qt=Ee.properties;if(qt&&qt.cluster?Ht+qt.point_count<=Ut?Ht+=qt.point_count:Ht=this._appendLeaves(ot,qt.cluster_id,_t,Ut,Ht):Ht<Ut?Ht++:ot.push(Ee),ot.length===_t)break}return Ht}_createTree(ot){const lt=new x.K(ot.length/this.stride|0,this.options.nodeSize,Float32Array);for(let _t=0;_t<ot.length;_t+=this.stride)lt.add(ot[_t],ot[_t+1]);return lt.finish(),lt.data=ot,lt}_addTileFeatures(ot,lt,_t,Ut,Ht,ge){for(const Ee of ot){const qt=Ee*this.stride,ke=lt[qt+Ot]>1;let Ve,$e,Un;if(ke)Ve=Wt(lt,qt,this.clusterProps),$e=lt[qt],Un=lt[qt+1];else{const Jn=this.points[lt[qt+se]];Ve=Jn.properties;const[cr,En]=Jn.geometry.coordinates;$e=Ct(cr),Un=Ae(En)}const or={type:1,geometry:[[Math.round(this.options.extent*($e*Ht-_t)),Math.round(this.options.extent*(Un*Ht-Ut))]],tags:Ve};let Mr;Mr=ke||this.options.generateId?lt[qt+se]:this.points[lt[qt+se]].id,Mr!==void 0&&(or.id=Mr),ge.features.push(or)}}_limitZoom(ot){return Math.max(this.options.minZoom,Math.min(Math.floor(+ot),this.options.maxZoom+1))}_cluster(ot,lt){const{radius:_t,extent:Ut,reduce:Ht,minPoints:ge}=this.options,Ee=_t/(Ut*Math.pow(2,lt)),qt=ot.data,ke=[],Ve=this.stride;for(let $e=0;$e<qt.length;$e+=Ve){if(qt[$e+2]<=lt)continue;qt[$e+2]=lt;const Un=qt[$e],or=qt[$e+1],Mr=ot.within(qt[$e],qt[$e+1],Ee),Jn=qt[$e+Ot];let cr=Jn;for(const En of Mr){const ai=En*Ve;qt[ai+2]>lt&&(cr+=qt[ai+Ot])}if(cr>Jn&&cr>=ge){let En,ai=Un*Jn,Wr=or*Jn,pi=-1;const Ri=(($e/Ve|0)<<5)+(lt+1)+this.points.length;for(const Jr of Mr){const Ei=Jr*Ve;if(qt[Ei+2]<=lt)continue;qt[Ei+2]=lt;const gs=qt[Ei+Ot];ai+=qt[Ei]*gs,Wr+=qt[Ei+1]*gs,qt[Ei+4]=Ri,Ht&&(En||(En=this._map(qt,$e,!0),pi=this.clusterProps.length,this.clusterProps.push(En)),Ht(En,this._map(qt,Ei)))}qt[$e+4]=Ri,ke.push(ai/cr,Wr/cr,1/0,Ri,-1,cr),Ht&&ke.push(pi)}else{for(let En=0;En<Ve;En++)ke.push(qt[$e+En]);if(cr>1)for(const En of Mr){const ai=En*Ve;if(!(qt[ai+2]<=lt)){qt[ai+2]=lt;for(let Wr=0;Wr<Ve;Wr++)ke.push(qt[ai+Wr])}}}}return ke}_getOriginId(ot){return ot-this.points.length>>5}_getOriginZoom(ot){return(ot-this.points.length)%32}_map(ot,lt,_t){if(ot[lt+Ot]>1){const ge=this.clusterProps[ot[lt+Me]];return _t?Object.assign({},ge):ge}const Ut=this.points[ot[lt+se]].properties,Ht=this.options.map(Ut);return _t&&Ht===Ut?Object.assign({},Ht):Ht}}function kt(Qt,ot,lt){return{type:"Feature",id:Qt[ot+se],properties:Wt(Qt,ot,lt),geometry:{type:"Point",coordinates:[(_t=Qt[ot],360*(_t-.5)),he(Qt[ot+1])]}};var _t}function Wt(Qt,ot,lt){const _t=Qt[ot+Ot],Ut=_t>=1e4?`${Math.round(_t/1e3)}k`:_t>=1e3?Math.round(_t/100)/10+"k":_t,Ht=Qt[ot+Me],ge=Ht===-1?{}:Object.assign({},lt[Ht]);return Object.assign(ge,{cluster:!0,cluster_id:Qt[ot+se],point_count:_t,point_count_abbreviated:Ut})}function Ct(Qt){return Qt/360+.5}function Ae(Qt){const ot=Math.sin(Qt*Math.PI/180),lt=.5-.25*Math.log((1+ot)/(1-ot))/Math.PI;return lt<0?0:lt>1?1:lt}function he(Qt){const ot=(180-360*Qt)*Math.PI/180;return 360*Math.atan(Math.exp(ot))/Math.PI-90}var Fe={exports:{}};Fe.exports=function(){function Qt(zt,Vt,Yt,ne){for(var Kt,oe=ne,fe=Yt-Vt>>1,re=Yt-Vt,ve=zt[Vt],le=zt[Vt+1],Ye=zt[Yt],In=zt[Yt+1],De=Vt+3;De<Yt;De+=3){var kn=ot(zt[De],zt[De+1],ve,le,Ye,In);if(kn>oe)Kt=De,oe=kn;else if(kn===oe){var Qn=Math.abs(De-fe);Qn<re&&(Kt=De,re=Qn)}}oe>ne&&(Kt-Vt>3&&Qt(zt,Vt,Kt,ne),zt[Kt+2]=oe,Yt-Kt>3&&Qt(zt,Kt,Yt,ne))}function ot(zt,Vt,Yt,ne,Kt,oe){var fe=Kt-Yt,re=oe-ne;if(fe!==0||re!==0){var ve=((zt-Yt)*fe+(Vt-ne)*re)/(fe*fe+re*re);ve>1?(Yt=Kt,ne=oe):ve>0&&(Yt+=fe*ve,ne+=re*ve)}return(fe=zt-Yt)*fe+(re=Vt-ne)*re}function lt(zt,Vt,Yt,ne){var Kt={id:zt===void 0?null:zt,type:Vt,geometry:Yt,tags:ne,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(oe){var fe=oe.geometry,re=oe.type;if(re==="Point"||re==="MultiPoint"||re==="LineString")_t(oe,fe);else if(re==="Polygon"||re==="MultiLineString")for(var ve=0;ve<fe.length;ve++)_t(oe,fe[ve]);else if(re==="MultiPolygon")for(ve=0;ve<fe.length;ve++)for(var le=0;le<fe[ve].length;le++)_t(oe,fe[ve][le])}(Kt),Kt}function _t(zt,Vt){for(var Yt=0;Yt<Vt.length;Yt+=3)zt.minX=Math.min(zt.minX,Vt[Yt]),zt.minY=Math.min(zt.minY,Vt[Yt+1]),zt.maxX=Math.max(zt.maxX,Vt[Yt]),zt.maxY=Math.max(zt.maxY,Vt[Yt+1])}function Ut(zt,Vt,Yt,ne){if(Vt.geometry){var Kt=Vt.geometry.coordinates,oe=Vt.geometry.type,fe=Math.pow(Yt.tolerance/((1<<Yt.maxZoom)*Yt.extent),2),re=[],ve=Vt.id;if(Yt.promoteId?ve=Vt.properties[Yt.promoteId]:Yt.generateId&&(ve=ne||0),oe==="Point")Ht(Kt,re);else if(oe==="MultiPoint")for(var le=0;le<Kt.length;le++)Ht(Kt[le],re);else if(oe==="LineString")ge(Kt,re,fe,!1);else if(oe==="MultiLineString"){if(Yt.lineMetrics){for(le=0;le<Kt.length;le++)ge(Kt[le],re=[],fe,!1),zt.push(lt(ve,"LineString",re,Vt.properties));return}Ee(Kt,re,fe,!1)}else if(oe==="Polygon")Ee(Kt,re,fe,!0);else{if(oe!=="MultiPolygon"){if(oe==="GeometryCollection"){for(le=0;le<Vt.geometry.geometries.length;le++)Ut(zt,{id:ve,geometry:Vt.geometry.geometries[le],properties:Vt.properties},Yt,ne);return}throw new Error("Input data is not a valid GeoJSON object.")}for(le=0;le<Kt.length;le++){var Ye=[];Ee(Kt[le],Ye,fe,!0),re.push(Ye)}}zt.push(lt(ve,oe,re,Vt.properties))}}function Ht(zt,Vt){Vt.push(qt(zt[0])),Vt.push(ke(zt[1])),Vt.push(0)}function ge(zt,Vt,Yt,ne){for(var Kt,oe,fe=0,re=0;re<zt.length;re++){var ve=qt(zt[re][0]),le=ke(zt[re][1]);Vt.push(ve),Vt.push(le),Vt.push(0),re>0&&(fe+=ne?(Kt*le-ve*oe)/2:Math.sqrt(Math.pow(ve-Kt,2)+Math.pow(le-oe,2))),Kt=ve,oe=le}var Ye=Vt.length-3;Vt[2]=1,Qt(Vt,0,Ye,Yt),Vt[Ye+2]=1,Vt.size=Math.abs(fe),Vt.start=0,Vt.end=Vt.size}function Ee(zt,Vt,Yt,ne){for(var Kt=0;Kt<zt.length;Kt++){var oe=[];ge(zt[Kt],oe,Yt,ne),Vt.push(oe)}}function qt(zt){return zt/360+.5}function ke(zt){var Vt=Math.sin(zt*Math.PI/180),Yt=.5-.25*Math.log((1+Vt)/(1-Vt))/Math.PI;return Yt<0?0:Yt>1?1:Yt}function Ve(zt,Vt,Yt,ne,Kt,oe,fe,re){if(ne/=Vt,oe>=(Yt/=Vt)&&fe<ne)return zt;if(fe<Yt||oe>=ne)return null;for(var ve=[],le=0;le<zt.length;le++){var Ye=zt[le],In=Ye.geometry,De=Ye.type,kn=Kt===0?Ye.minX:Ye.minY,Qn=Kt===0?Ye.maxX:Ye.maxY;if(kn>=Yt&&Qn<ne)ve.push(Ye);else if(!(Qn<Yt||kn>=ne)){var Wn=[];if(De==="Point"||De==="MultiPoint")$e(In,Wn,Yt,ne,Kt);else if(De==="LineString")Un(In,Wn,Yt,ne,Kt,!1,re.lineMetrics);else if(De==="MultiLineString")Mr(In,Wn,Yt,ne,Kt,!1);else if(De==="Polygon")Mr(In,Wn,Yt,ne,Kt,!0);else if(De==="MultiPolygon")for(var tr=0;tr<In.length;tr++){var mi=[];Mr(In[tr],mi,Yt,ne,Kt,!0),mi.length&&Wn.push(mi)}if(Wn.length){if(re.lineMetrics&&De==="LineString"){for(tr=0;tr<Wn.length;tr++)ve.push(lt(Ye.id,De,Wn[tr],Ye.tags));continue}De!=="LineString"&&De!=="MultiLineString"||(Wn.length===1?(De="LineString",Wn=Wn[0]):De="MultiLineString"),De!=="Point"&&De!=="MultiPoint"||(De=Wn.length===3?"Point":"MultiPoint"),ve.push(lt(Ye.id,De,Wn,Ye.tags))}}}return ve.length?ve:null}function $e(zt,Vt,Yt,ne,Kt){for(var oe=0;oe<zt.length;oe+=3){var fe=zt[oe+Kt];fe>=Yt&&fe<=ne&&(Vt.push(zt[oe]),Vt.push(zt[oe+1]),Vt.push(zt[oe+2]))}}function Un(zt,Vt,Yt,ne,Kt,oe,fe){for(var re,ve,le=or(zt),Ye=Kt===0?cr:En,In=zt.start,De=0;De<zt.length-3;De+=3){var kn=zt[De],Qn=zt[De+1],Wn=zt[De+2],tr=zt[De+3],mi=zt[De+4],is=Kt===0?kn:Qn,Nr=Kt===0?tr:mi,Oi=!1;fe&&(re=Math.sqrt(Math.pow(kn-tr,2)+Math.pow(Qn-mi,2))),is<Yt?Nr>Yt&&(ve=Ye(le,kn,Qn,tr,mi,Yt),fe&&(le.start=In+re*ve)):is>ne?Nr<ne&&(ve=Ye(le,kn,Qn,tr,mi,ne),fe&&(le.start=In+re*ve)):Jn(le,kn,Qn,Wn),Nr<Yt&&is>=Yt&&(ve=Ye(le,kn,Qn,tr,mi,Yt),Oi=!0),Nr>ne&&is<=ne&&(ve=Ye(le,kn,Qn,tr,mi,ne),Oi=!0),!oe&&Oi&&(fe&&(le.end=In+re*ve),Vt.push(le),le=or(zt)),fe&&(In+=re)}var li=zt.length-3;kn=zt[li],Qn=zt[li+1],Wn=zt[li+2],(is=Kt===0?kn:Qn)>=Yt&&is<=ne&&Jn(le,kn,Qn,Wn),li=le.length-3,oe&&li>=3&&(le[li]!==le[0]||le[li+1]!==le[1])&&Jn(le,le[0],le[1],le[2]),le.length&&Vt.push(le)}function or(zt){var Vt=[];return Vt.size=zt.size,Vt.start=zt.start,Vt.end=zt.end,Vt}function Mr(zt,Vt,Yt,ne,Kt,oe){for(var fe=0;fe<zt.length;fe++)Un(zt[fe],Vt,Yt,ne,Kt,oe,!1)}function Jn(zt,Vt,Yt,ne){zt.push(Vt),zt.push(Yt),zt.push(ne)}function cr(zt,Vt,Yt,ne,Kt,oe){var fe=(oe-Vt)/(ne-Vt);return zt.push(oe),zt.push(Yt+(Kt-Yt)*fe),zt.push(1),fe}function En(zt,Vt,Yt,ne,Kt,oe){var fe=(oe-Yt)/(Kt-Yt);return zt.push(Vt+(ne-Vt)*fe),zt.push(oe),zt.push(1),fe}function ai(zt,Vt){for(var Yt=[],ne=0;ne<zt.length;ne++){var Kt,oe=zt[ne],fe=oe.type;if(fe==="Point"||fe==="MultiPoint"||fe==="LineString")Kt=Wr(oe.geometry,Vt);else if(fe==="MultiLineString"||fe==="Polygon"){Kt=[];for(var re=0;re<oe.geometry.length;re++)Kt.push(Wr(oe.geometry[re],Vt))}else if(fe==="MultiPolygon")for(Kt=[],re=0;re<oe.geometry.length;re++){for(var ve=[],le=0;le<oe.geometry[re].length;le++)ve.push(Wr(oe.geometry[re][le],Vt));Kt.push(ve)}Yt.push(lt(oe.id,fe,Kt,oe.tags))}return Yt}function Wr(zt,Vt){var Yt=[];Yt.size=zt.size,zt.start!==void 0&&(Yt.start=zt.start,Yt.end=zt.end);for(var ne=0;ne<zt.length;ne+=3)Yt.push(zt[ne]+Vt,zt[ne+1],zt[ne+2]);return Yt}function pi(zt,Vt){if(zt.transformed)return zt;var Yt,ne,Kt,oe=1<<zt.z,fe=zt.x,re=zt.y;for(Yt=0;Yt<zt.features.length;Yt++){var ve=zt.features[Yt],le=ve.geometry,Ye=ve.type;if(ve.geometry=[],Ye===1)for(ne=0;ne<le.length;ne+=2)ve.geometry.push(Ri(le[ne],le[ne+1],Vt,oe,fe,re));else for(ne=0;ne<le.length;ne++){var In=[];for(Kt=0;Kt<le[ne].length;Kt+=2)In.push(Ri(le[ne][Kt],le[ne][Kt+1],Vt,oe,fe,re));ve.geometry.push(In)}}return zt.transformed=!0,zt}function Ri(zt,Vt,Yt,ne,Kt,oe){return[Math.round(Yt*(zt*ne-Kt)),Math.round(Yt*(Vt*ne-oe))]}function Jr(zt,Vt,Yt,ne,Kt){for(var oe=Vt===Kt.maxZoom?0:Kt.tolerance/((1<<Vt)*Kt.extent),fe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:Yt,y:ne,z:Vt,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},re=0;re<zt.length;re++){fe.numFeatures++,Ei(fe,zt[re],oe,Kt);var ve=zt[re].minX,le=zt[re].minY,Ye=zt[re].maxX,In=zt[re].maxY;ve<fe.minX&&(fe.minX=ve),le<fe.minY&&(fe.minY=le),Ye>fe.maxX&&(fe.maxX=Ye),In>fe.maxY&&(fe.maxY=In)}return fe}function Ei(zt,Vt,Yt,ne){var Kt=Vt.geometry,oe=Vt.type,fe=[];if(oe==="Point"||oe==="MultiPoint")for(var re=0;re<Kt.length;re+=3)fe.push(Kt[re]),fe.push(Kt[re+1]),zt.numPoints++,zt.numSimplified++;else if(oe==="LineString")gs(fe,Kt,zt,Yt,!1,!1);else if(oe==="MultiLineString"||oe==="Polygon")for(re=0;re<Kt.length;re++)gs(fe,Kt[re],zt,Yt,oe==="Polygon",re===0);else if(oe==="MultiPolygon")for(var ve=0;ve<Kt.length;ve++){var le=Kt[ve];for(re=0;re<le.length;re++)gs(fe,le[re],zt,Yt,!0,re===0)}if(fe.length){var Ye=Vt.tags||null;if(oe==="LineString"&&ne.lineMetrics){for(var In in Ye={},Vt.tags)Ye[In]=Vt.tags[In];Ye.mapbox_clip_start=Kt.start/Kt.size,Ye.mapbox_clip_end=Kt.end/Kt.size}var De={geometry:fe,type:oe==="Polygon"||oe==="MultiPolygon"?3:oe==="LineString"||oe==="MultiLineString"?2:1,tags:Ye};Vt.id!==null&&(De.id=Vt.id),zt.features.push(De)}}function gs(zt,Vt,Yt,ne,Kt,oe){var fe=ne*ne;if(ne>0&&Vt.size<(Kt?fe:ne))Yt.numPoints+=Vt.length/3;else{for(var re=[],ve=0;ve<Vt.length;ve+=3)(ne===0||Vt[ve+2]>fe)&&(Yt.numSimplified++,re.push(Vt[ve]),re.push(Vt[ve+1])),Yt.numPoints++;Kt&&function(le,Ye){for(var In=0,De=0,kn=le.length,Qn=kn-2;De<kn;Qn=De,De+=2)In+=(le[De]-le[Qn])*(le[De+1]+le[Qn+1]);if(In>0===Ye)for(De=0,kn=le.length;De<kn/2;De+=2){var Wn=le[De],tr=le[De+1];le[De]=le[kn-2-De],le[De+1]=le[kn-1-De],le[kn-2-De]=Wn,le[kn-1-De]=tr}}(re,oe),zt.push(re)}}function vo(zt,Vt){var Yt=(Vt=this.options=function(Kt,oe){for(var fe in oe)Kt[fe]=oe[fe];return Kt}(Object.create(this.options),Vt)).debug;if(Yt&&console.time("preprocess data"),Vt.maxZoom<0||Vt.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Vt.promoteId&&Vt.generateId)throw new Error("promoteId and generateId cannot be used together.");var ne=function(Kt,oe){var fe=[];if(Kt.type==="FeatureCollection")for(var re=0;re<Kt.features.length;re++)Ut(fe,Kt.features[re],oe,re);else Ut(fe,Kt.type==="Feature"?Kt:{geometry:Kt},oe);return fe}(zt,Vt);this.tiles={},this.tileCoords=[],Yt&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Vt.indexMaxZoom,Vt.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(ne=function(Kt,oe){var fe=oe.buffer/oe.extent,re=Kt,ve=Ve(Kt,1,-1-fe,fe,0,-1,2,oe),le=Ve(Kt,1,1-fe,2+fe,0,-1,2,oe);return(ve||le)&&(re=Ve(Kt,1,-fe,1+fe,0,-1,2,oe)||[],ve&&(re=ai(ve,1).concat(re)),le&&(re=re.concat(ai(le,-1)))),re}(ne,Vt)).length&&this.splitTile(ne,0,0,0),Yt&&(ne.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function rs(zt,Vt,Yt){return 32*((1<<zt)*Yt+Vt)+zt}return vo.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},vo.prototype.splitTile=function(zt,Vt,Yt,ne,Kt,oe,fe){for(var re=[zt,Vt,Yt,ne],ve=this.options,le=ve.debug;re.length;){ne=re.pop(),Yt=re.pop(),Vt=re.pop(),zt=re.pop();var Ye=1<<Vt,In=rs(Vt,Yt,ne),De=this.tiles[In];if(!De&&(le>1&&console.time("creation"),De=this.tiles[In]=Jr(zt,Vt,Yt,ne,ve),this.tileCoords.push({z:Vt,x:Yt,y:ne}),le)){le>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Vt,Yt,ne,De.numFeatures,De.numPoints,De.numSimplified),console.timeEnd("creation"));var kn="z"+Vt;this.stats[kn]=(this.stats[kn]||0)+1,this.total++}if(De.source=zt,Kt){if(Vt===ve.maxZoom||Vt===Kt)continue;var Qn=1<<Kt-Vt;if(Yt!==Math.floor(oe/Qn)||ne!==Math.floor(fe/Qn))continue}else if(Vt===ve.indexMaxZoom||De.numPoints<=ve.indexMaxPoints)continue;if(De.source=null,zt.length!==0){le>1&&console.time("clipping");var Wn,tr,mi,is,Nr,Oi,li=.5*ve.buffer/ve.extent,$i=.5-li,Xs=.5+li,ya=1+li;Wn=tr=mi=is=null,Nr=Ve(zt,Ye,Yt-li,Yt+Xs,0,De.minX,De.maxX,ve),Oi=Ve(zt,Ye,Yt+$i,Yt+ya,0,De.minX,De.maxX,ve),zt=null,Nr&&(Wn=Ve(Nr,Ye,ne-li,ne+Xs,1,De.minY,De.maxY,ve),tr=Ve(Nr,Ye,ne+$i,ne+ya,1,De.minY,De.maxY,ve),Nr=null),Oi&&(mi=Ve(Oi,Ye,ne-li,ne+Xs,1,De.minY,De.maxY,ve),is=Ve(Oi,Ye,ne+$i,ne+ya,1,De.minY,De.maxY,ve),Oi=null),le>1&&console.timeEnd("clipping"),re.push(Wn||[],Vt+1,2*Yt,2*ne),re.push(tr||[],Vt+1,2*Yt,2*ne+1),re.push(mi||[],Vt+1,2*Yt+1,2*ne),re.push(is||[],Vt+1,2*Yt+1,2*ne+1)}}},vo.prototype.getTile=function(zt,Vt,Yt){var ne=this.options,Kt=ne.extent,oe=ne.debug;if(zt<0||zt>24)return null;var fe=1<<zt,re=rs(zt,Vt=(Vt%fe+fe)%fe,Yt);if(this.tiles[re])return pi(this.tiles[re],Kt);oe>1&&console.log("drilling down to z%d-%d-%d",zt,Vt,Yt);for(var ve,le=zt,Ye=Vt,In=Yt;!ve&&le>0;)le--,Ye=Math.floor(Ye/2),In=Math.floor(In/2),ve=this.tiles[rs(le,Ye,In)];return ve&&ve.source?(oe>1&&console.log("found parent tile z%d-%d-%d",le,Ye,In),oe>1&&console.time("drilling down"),this.splitTile(ve.source,le,Ye,In,zt,Vt,Yt),oe>1&&console.timeEnd("drilling down"),this.tiles[re]?pi(this.tiles[re],Kt):null):null},function(zt,Vt){return new vo(zt,Vt)}}();var Oe=x.g(Fe.exports);function Qe(Qt,ot){const lt=Qt.tileID.canonical;if(!this._geoJSONIndex)return ot(null,null);const _t=this._geoJSONIndex.getTile(lt.z,lt.x,lt.y);if(!_t)return ot(null,null);const Ut=new class{constructor(ge){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=x.E,this.length=ge.length,this._features=ge}feature(ge){return new class{constructor(Ee){this._feature=Ee,this.extent=x.E,this.type=Ee.type,this.properties=Ee.tags,"id"in Ee&&!isNaN(Ee.id)&&(this.id=parseInt(Ee.id,10))}loadGeometry(){if(this._feature.type===1){const Ee=[];for(const qt of this._feature.geometry)Ee.push([new x.P(qt[0],qt[1])]);return Ee}{const Ee=[];for(const qt of this._feature.geometry){const ke=[];for(const Ve of qt)ke.push(new x.P(Ve[0],Ve[1]));Ee.push(ke)}return Ee}}toGeoJSON(Ee,qt,ke){return G.call(this,Ee,qt,ke)}}(this._features[ge])}}(_t.features);let Ht=Zt(Ut);Ht.byteOffset===0&&Ht.byteLength===Ht.buffer.byteLength||(Ht=new Uint8Array(Ht)),ot(null,{vectorTile:Ut,rawData:Ht.buffer})}class Le extends x.d{constructor(ot,lt,_t,Ut,Ht,ge){super(ot,lt,_t,Ut,Qe,ge),Ht&&(this.loadGeoJSON=Ht)}loadData(ot,lt){const _t=ot&&ot.request,Ut=_t&&_t.collectResourceTiming;this.loadGeoJSON(ot,(Ht,ge)=>{if(Ht||!ge)return lt(Ht);if(typeof ge!="object")return lt(new Error(`Input data given to '${ot.source}' is not a valid GeoJSON object.`));{N(ge,!0);try{if(ot.filter){const qt=x.e(ot.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(qt.result==="error")throw new Error(qt.value.map(Ve=>`${Ve.key}: ${Ve.message}`).join(", "));ge={type:"FeatureCollection",features:ge.features.filter(Ve=>qt.value.evaluate({zoom:0},Ve))}}this._geoJSONIndex=ot.cluster?new me(function({superclusterOptions:qt,clusterProperties:ke}){if(!ke||!qt)return qt;const Ve={},$e={},Un={accumulated:null,zoom:0},or={properties:null},Mr=Object.keys(ke);for(const Jn of Mr){const[cr,En]=ke[Jn],ai=x.e(En),Wr=x.e(typeof cr=="string"?[cr,["accumulated"],["get",Jn]]:cr);Ve[Jn]=ai.value,$e[Jn]=Wr.value}return qt.map=Jn=>{or.properties=Jn;const cr={};for(const En of Mr)cr[En]=Ve[En].evaluate(Un,or);return cr},qt.reduce=(Jn,cr)=>{or.properties=cr;for(const En of Mr)Un.accumulated=Jn[En],Jn[En]=$e[En].evaluate(Un,or)},qt}(ot)).load(ge.features):Oe(ge,ot.geojsonVtOptions)}catch(qt){return lt(qt)}this.loaded={};const Ee={};if(Ut){const qt=x.f(_t);qt&&(Ee.resourceTiming={},Ee.resourceTiming[ot.source]=JSON.parse(JSON.stringify(qt)))}lt(null,Ee)}})}reloadTile(ot,lt){const _t=this.loaded;return _t&&_t[ot.uid]?super.reloadTile(ot,lt):this.loadTile(ot,lt)}loadGeoJSON(ot,lt){if(ot.request)x.h(ot.request,lt);else{if(typeof ot.data!="string")return lt(new Error(`Input data given to '${ot.source}' is not a valid GeoJSON object.`));try{return lt(null,JSON.parse(ot.data))}catch{return lt(new Error(`Input data given to '${ot.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(ot,lt){try{lt(null,this._geoJSONIndex.getClusterExpansionZoom(ot.clusterId))}catch(_t){lt(_t)}}getClusterChildren(ot,lt){try{lt(null,this._geoJSONIndex.getChildren(ot.clusterId))}catch(_t){lt(_t)}}getClusterLeaves(ot,lt){try{lt(null,this._geoJSONIndex.getLeaves(ot.clusterId,ot.limit,ot.offset))}catch(_t){lt(_t)}}}class Ne{constructor(ot,lt){this.tileID=new x.O(ot.tileID.overscaledZ,ot.tileID.wrap,ot.tileID.canonical.z,ot.tileID.canonical.x,ot.tileID.canonical.y),this.tileZoom=ot.tileZoom,this.uid=ot.uid,this.zoom=ot.zoom,this.canonical=ot.tileID.canonical,this.pixelRatio=ot.pixelRatio,this.tileSize=ot.tileSize,this.source=ot.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=ot.projection,this.brightness=lt}parse(ot,lt,_t,Ut){this.status="parsing";const Ht=new x.O(_t.tileID.overscaledZ,_t.tileID.wrap,_t.tileID.canonical.z,_t.tileID.canonical.x,_t.tileID.canonical.y),ge={},Ee=lt.familiesBySource[_t.source],qt=new x.F(Ht,_t.promoteId);return qt.bucketLayerIDs=[],x.l(ot).then(ke=>{if(!ke)return Ut(new Error("Could not parse tile"));const Ve=x.j(ke,1/x.t(_t.tileID.canonical)),$e=ke.json.extensionsUsed&&ke.json.extensionsUsed.includes("MAPBOX_mesh_features"),Un=new x.k(this.zoom,{brightness:this.brightness});for(const or in Ee)for(const Mr of Ee[or]){const Jn=Mr[0],cr=ke.json.extensionsUsed;Jn.recalculate(Un,[]);const En=new x.T(Ve,Ht,cr&&cr.includes("MAPBOX_mesh_features"),this.brightness);$e||(En.needsUpload=!0),ge[Jn.fqid]=En,En.evaluate(Jn)}this.status="done",Ut(null,{buckets:ge,featureIndex:qt})}).catch(ke=>Ut(new Error(ke.message)))}}class Yn{constructor(ot,lt,_t,Ut,Ht,ge){this.actor=ot,this.layerIndex=lt,this.brightness=ge,this.loading={},this.loaded={}}loadTile(ot,lt){const _t=ot.uid,Ut=this.loading[_t]=new Ne(ot,this.brightness);x.i(ot.request,(Ht,ge)=>{const Ee=!this.loading[_t];return delete this.loading[_t],Ee||Ht?(Ut.status="done",Ee||(this.loaded[_t]=Ut),lt(Ht)):ge&&ge.byteLength!==0?void Ut.parse(ge,this.layerIndex,ot,(qt,ke)=>{Ut.status="done",this.loaded=this.loaded||{},this.loaded[_t]=Ut,qt||!ke?lt(qt):lt(null,ke)}):(Ut.status="done",this.loaded[_t]=Ut,lt())})}reloadTile(ot,lt){const _t=this.loaded,Ut=ot.uid;if(_t&&_t[Ut]){const Ht=_t[Ut];Ht.projection=ot.projection,Ht.brightness=ot.brightness;const ge=(Ee,qt)=>{Ht.reloadCallback&&(delete Ht.reloadCallback,this.loadTile(ot,lt)),lt(Ee,qt)};Ht.status==="parsing"?Ht.reloadCallback=ge:Ht.status==="done"&&this.loadTile(ot,lt)}}abortTile(ot,lt){const _t=ot.uid;this.loading[_t]&&delete this.loading[_t],lt()}removeTile(ot,lt){const _t=this.loaded,Ut=ot.uid;_t&&_t[Ut]&&delete _t[Ut],lt()}}class _n{constructor(ot){this.self=ot,this.actor=new x.A(ot,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=x.m({name:"mercator"}),this.workerSourceTypes={vector:x.d,geojson:Le,"batched-model":Yn},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(lt,_t)=>{if(this.workerSourceTypes[lt])throw new Error(`Worker source with name "${lt}" already registered.`);this.workerSourceTypes[lt]=_t},this.self.registerRTLTextPlugin=lt=>{if(x.n.isParsed())throw new Error("RTL text plugin already registered.");x.n.applyArabicShaping=lt.applyArabicShaping,x.n.processBidirectionalText=lt.processBidirectionalText,x.n.processStyledBidirectionalText=lt.processStyledBidirectionalText}}clearCaches(ot,lt,_t){delete this.layerIndexes[ot],delete this.availableImages[ot],delete this.workerSources[ot],delete this.demWorkerSources[ot],_t()}checkIfReady(ot,lt,_t){_t()}setReferrer(ot,lt){this.referrer=lt}spriteLoaded(ot,{scope:lt,isLoaded:_t}){if(this.isSpriteLoaded[ot]||(this.isSpriteLoaded[ot]={}),this.isSpriteLoaded[ot][lt]=_t,this.workerSources[ot]&&this.workerSources[ot][lt])for(const Ut in this.workerSources[ot][lt]){const Ht=this.workerSources[ot][lt][Ut];for(const ge in Ht)Ht[ge]instanceof x.d&&(Ht[ge].isSpriteLoaded=_t,Ht[ge].fire(new x.o("isSpriteLoaded")))}}setImages(ot,{scope:lt,images:_t},Ut){if(this.availableImages[ot]||(this.availableImages[ot]={}),this.availableImages[ot][lt]=_t,this.workerSources[ot]&&this.workerSources[ot][lt]){for(const Ht in this.workerSources[ot][lt]){const ge=this.workerSources[ot][lt][Ht];for(const Ee in ge)ge[Ee].availableImages=_t}Ut()}else Ut()}setProjection(ot,lt){this.projections[ot]=x.m(lt)}setBrightness(ot,lt,_t){this.brightness=lt,_t()}setLayers(ot,lt,_t){this.getLayerIndex(ot,lt.scope).replace(lt.layers,lt.options),_t()}updateLayers(ot,lt,_t){this.getLayerIndex(ot,lt.scope).update(lt.layers,lt.removedIds,lt.options),_t()}loadTile(ot,lt,_t){lt.projection=this.projections[ot]||this.defaultProjection,this.getWorkerSource(ot,lt.type,lt.source,lt.scope).loadTile(lt,_t)}loadDEMTile(ot,lt,_t){this.getDEMWorkerSource(ot,lt.source,lt.scope).loadTile(lt,_t)}reloadTile(ot,lt,_t){lt.projection=this.projections[ot]||this.defaultProjection,this.getWorkerSource(ot,lt.type,lt.source,lt.scope).reloadTile(lt,_t)}abortTile(ot,lt,_t){this.getWorkerSource(ot,lt.type,lt.source,lt.scope).abortTile(lt,_t)}removeTile(ot,lt,_t){this.getWorkerSource(ot,lt.type,lt.source,lt.scope).removeTile(lt,_t)}removeSource(ot,lt,_t){if(!(this.workerSources[ot]&&this.workerSources[ot][lt.scope]&&this.workerSources[ot][lt.scope][lt.type]&&this.workerSources[ot][lt.scope][lt.type][lt.source]))return;const Ut=this.workerSources[ot][lt.scope][lt.type][lt.source];delete this.workerSources[ot][lt.scope][lt.type][lt.source],Ut.removeSource!==void 0?Ut.removeSource(lt,_t):_t()}loadWorkerSource(ot,lt,_t){try{this.self.importScripts(lt.url),_t()}catch(Ut){_t(Ut.toString())}}syncRTLPluginState(ot,lt,_t){try{x.n.setState(lt);const Ut=x.n.getPluginURL();if(x.n.isLoaded()&&!x.n.isParsed()&&Ut!=null){this.self.importScripts(Ut);const Ht=x.n.isParsed();_t(Ht?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Ut}`),Ht)}}catch(Ut){_t(Ut.toString())}}setDracoUrl(ot,lt){this.dracoUrl=lt}getAvailableImages(ot,lt){this.availableImages[ot]||(this.availableImages[ot]={});let _t=this.availableImages[ot][lt];return _t||(_t=[]),_t}getLayerIndex(ot,lt){this.layerIndexes[ot]||(this.layerIndexes[ot]={});let _t=this.layerIndexes[ot][lt];return _t||(_t=this.layerIndexes[ot][lt]=new M,_t.scope=lt),_t}getWorkerSource(ot,lt,_t,Ut){if(this.workerSources[ot]||(this.workerSources[ot]={}),this.workerSources[ot][Ut]||(this.workerSources[ot][Ut]={}),this.workerSources[ot][Ut][lt]||(this.workerSources[ot][Ut][lt]={}),this.isSpriteLoaded[ot]||(this.isSpriteLoaded[ot]={}),!this.workerSources[ot][Ut][lt][_t]){const Ht={send:(ge,Ee,qt,ke,Ve,$e)=>{this.actor.send(ge,Ee,qt,ot,Ve,$e)},scheduler:this.actor.scheduler};this.workerSources[ot][Ut][lt][_t]=new this.workerSourceTypes[lt](Ht,this.getLayerIndex(ot,Ut),this.getAvailableImages(ot,Ut),this.isSpriteLoaded[ot][Ut],void 0,this.brightness)}return this.workerSources[ot][Ut][lt][_t]}getDEMWorkerSource(ot,lt,_t){return this.demWorkerSources[ot]||(this.demWorkerSources[ot]={}),this.demWorkerSources[ot][_t]||(this.demWorkerSources[ot][_t]={}),this.demWorkerSources[ot][_t][lt]||(this.demWorkerSources[ot][_t][lt]=new I),this.demWorkerSources[ot][_t][lt]}enforceCacheSizeLimit(ot,lt){x.q(lt)}getWorkerPerformanceMetrics(ot,lt,_t){_t(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new _n(self)),_n}),m(["./shared"],function(x){return x.s});var y=f;return y})})(Hrt);function g0(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var qrt={exports:{}};(function(e,r){(function(s){e.exports=s()})(function(){return function(){function s(a,h,f){function m(w,T){if(!h[w]){if(!a[w]){var M=typeof g0=="function"&&g0;if(!T&&M)return M(w,!0);if(y)return y(w,!0);var I=new Error("Cannot find module '"+w+"'");throw I.code="MODULE_NOT_FOUND",I}var R=h[w]={exports:{}};a[w][0].call(R.exports,function(O){var N=a[w][1][O];return m(N||O)},R,R.exports,s,a,h,f)}return h[w].exports}for(var y=typeof g0=="function"&&g0,x=0;x<f.length;x++)m(f[x]);return m}return s}()({1:[function(s,a,h){var f=s("./toPropertyKey.js");function m(y,x,w){return x=f(x),x in y?Object.defineProperty(y,x,{value:w,enumerable:!0,configurable:!0,writable:!0}):y[x]=w,y}a.exports=m,a.exports.__esModule=!0,a.exports.default=a.exports},{"./toPropertyKey.js":4}],2:[function(s,a,h){var f=s("./defineProperty.js");function m(x,w){var T=Object.keys(x);if(Object.getOwnPropertySymbols){var M=Object.getOwnPropertySymbols(x);w&&(M=M.filter(function(I){return Object.getOwnPropertyDescriptor(x,I).enumerable})),T.push.apply(T,M)}return T}function y(x){for(var w=1;w<arguments.length;w++){var T=arguments[w]!=null?arguments[w]:{};w%2?m(Object(T),!0).forEach(function(M){f(x,M,T[M])}):Object.getOwnPropertyDescriptors?Object.defineProperties(x,Object.getOwnPropertyDescriptors(T)):m(Object(T)).forEach(function(M){Object.defineProperty(x,M,Object.getOwnPropertyDescriptor(T,M))})}return x}a.exports=y,a.exports.__esModule=!0,a.exports.default=a.exports},{"./defineProperty.js":1}],3:[function(s,a,h){var f=s("./typeof.js").default;function m(y,x){if(f(y)!=="object"||y===null)return y;var w=y[Symbol.toPrimitive];if(w!==void 0){var T=w.call(y,x||"default");if(f(T)!=="object")return T;throw new TypeError("@@toPrimitive must return a primitive value.")}return(x==="string"?String:Number)(y)}a.exports=m,a.exports.__esModule=!0,a.exports.default=a.exports},{"./typeof.js":5}],4:[function(s,a,h){var f=s("./typeof.js").default,m=s("./toPrimitive.js");function y(x){var w=m(x,"string");return f(w)==="symbol"?w:String(w)}a.exports=y,a.exports.__esModule=!0,a.exports.default=a.exports},{"./toPrimitive.js":3,"./typeof.js":5}],5:[function(s,a,h){function f(m){"@babel/helpers - typeof";return a.exports=f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y},a.exports.__esModule=!0,a.exports.default=a.exports,f(m)}a.exports=f,a.exports.__esModule=!0,a.exports.default=a.exports},{}],6:[function(s,a,h){var f={};function m(w){return Math.floor(Math.abs(w)+.5)*(w>=0?1:-1)}function y(w,T,M){w=m(w*M),T=m(T*M);var I=w-T;I<<=1,w-T<0&&(I=~I);for(var R="";I>=32;)R+=String.fromCharCode((32|I&31)+63),I>>=5;return R+=String.fromCharCode(I+63),R}f.decode=function(w,T){for(var M=0,I=0,R=0,O=[],N=0,G=0,$=null,z,B,H=Math.pow(10,Number.isInteger(T)?T:5);M<w.length;){$=null,N=0,G=0;do $=w.charCodeAt(M++)-63,G|=($&31)<<N,N+=5;while($>=32);z=G&1?~(G>>1):G>>1,N=G=0;do $=w.charCodeAt(M++)-63,G|=($&31)<<N,N+=5;while($>=32);B=G&1?~(G>>1):G>>1,I+=z,R+=B,O.push([I/H,R/H])}return O},f.encode=function(w,T){if(!w.length)return"";for(var M=Math.pow(10,Number.isInteger(T)?T:5),I=y(w[0][0],0,M)+y(w[0][1],0,M),R=1;R<w.length;R++){var O=w[R],N=w[R-1];I+=y(O[0],N[0],M),I+=y(O[1],N[1],M)}return I};function x(w){for(var T=[],M=0;M<w.length;M++){var I=w[M].slice();T.push([I[1],I[0]])}return T}f.fromGeoJSON=function(w,T){if(w&&w.type==="Feature"&&(w=w.geometry),!w||w.type!=="LineString")throw new Error("Input must be a GeoJSON LineString");return f.encode(x(w.coordinates),T)},f.toGeoJSON=function(w,T){var M=f.decode(w,T);return{type:"LineString",coordinates:x(M)}},typeof a=="object"&&a.exports&&(a.exports=f)},{}],7:[function(s,a,h){var f=typeof Reflect=="object"?Reflect:null,m=f&&typeof f.apply=="function"?f.apply:function(W,Q,yt){return Function.prototype.apply.call(W,Q,yt)},y;f&&typeof f.ownKeys=="function"?y=f.ownKeys:Object.getOwnPropertySymbols?y=function(W){return Object.getOwnPropertyNames(W).concat(Object.getOwnPropertySymbols(W))}:y=function(W){return Object.getOwnPropertyNames(W)};function x(nt){console&&console.warn&&console.warn(nt)}var w=Number.isNaN||function(W){return W!==W};function T(){T.init.call(this)}a.exports=T,a.exports.once=at,T.EventEmitter=T,T.prototype._events=void 0,T.prototype._eventsCount=0,T.prototype._maxListeners=void 0;var M=10;function I(nt){if(typeof nt!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof nt)}Object.defineProperty(T,"defaultMaxListeners",{enumerable:!0,get:function(){return M},set:function(nt){if(typeof nt!="number"||nt<0||w(nt))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+nt+".");M=nt}}),T.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},T.prototype.setMaxListeners=function(W){if(typeof W!="number"||W<0||w(W))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+W+".");return this._maxListeners=W,this};function R(nt){return nt._maxListeners===void 0?T.defaultMaxListeners:nt._maxListeners}T.prototype.getMaxListeners=function(){return R(this)},T.prototype.emit=function(W){for(var Q=[],yt=1;yt<arguments.length;yt++)Q.push(arguments[yt]);var Pt=W==="error",st=this._events;if(st!==void 0)Pt=Pt&&st.error===void 0;else if(!Pt)return!1;if(Pt){var St;if(Q.length>0&&(St=Q[0]),St instanceof Error)throw St;var Rt=new Error("Unhandled error."+(St?" ("+St.message+")":""));throw Rt.context=St,Rt}var Zt=st[W];if(Zt===void 0)return!1;if(typeof Zt=="function")m(Zt,this,Q);else for(var Ft=Zt.length,$t=B(Zt,Ft),yt=0;yt<Ft;++yt)m($t[yt],this,Q);return!0};function O(nt,W,Q,yt){var Pt,st,St;if(I(Q),st=nt._events,st===void 0?(st=nt._events=Object.create(null),nt._eventsCount=0):(st.newListener!==void 0&&(nt.emit("newListener",W,Q.listener?Q.listener:Q),st=nt._events),St=st[W]),St===void 0)St=st[W]=Q,++nt._eventsCount;else if(typeof St=="function"?St=st[W]=yt?[Q,St]:[St,Q]:yt?St.unshift(Q):St.push(Q),Pt=R(nt),Pt>0&&St.length>Pt&&!St.warned){St.warned=!0;var Rt=new Error("Possible EventEmitter memory leak detected. "+St.length+" "+String(W)+" listeners added. Use emitter.setMaxListeners() to increase limit");Rt.name="MaxListenersExceededWarning",Rt.emitter=nt,Rt.type=W,Rt.count=St.length,x(Rt)}return nt}T.prototype.addListener=function(W,Q){return O(this,W,Q,!1)},T.prototype.on=T.prototype.addListener,T.prototype.prependListener=function(W,Q){return O(this,W,Q,!0)};function N(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function G(nt,W,Q){var yt={fired:!1,wrapFn:void 0,target:nt,type:W,listener:Q},Pt=N.bind(yt);return Pt.listener=Q,yt.wrapFn=Pt,Pt}T.prototype.once=function(W,Q){return I(Q),this.on(W,G(this,W,Q)),this},T.prototype.prependOnceListener=function(W,Q){return I(Q),this.prependListener(W,G(this,W,Q)),this},T.prototype.removeListener=function(W,Q){var yt,Pt,st,St,Rt;if(I(Q),Pt=this._events,Pt===void 0)return this;if(yt=Pt[W],yt===void 0)return this;if(yt===Q||yt.listener===Q)--this._eventsCount===0?this._events=Object.create(null):(delete Pt[W],Pt.removeListener&&this.emit("removeListener",W,yt.listener||Q));else if(typeof yt!="function"){for(st=-1,St=yt.length-1;St>=0;St--)if(yt[St]===Q||yt[St].listener===Q){Rt=yt[St].listener,st=St;break}if(st<0)return this;st===0?yt.shift():H(yt,st),yt.length===1&&(Pt[W]=yt[0]),Pt.removeListener!==void 0&&this.emit("removeListener",W,Rt||Q)}return this},T.prototype.off=T.prototype.removeListener,T.prototype.removeAllListeners=function(W){var Q,yt,Pt;if(yt=this._events,yt===void 0)return this;if(yt.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):yt[W]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete yt[W]),this;if(arguments.length===0){var st=Object.keys(yt),St;for(Pt=0;Pt<st.length;++Pt)St=st[Pt],St!=="removeListener"&&this.removeAllListeners(St);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(Q=yt[W],typeof Q=="function")this.removeListener(W,Q);else if(Q!==void 0)for(Pt=Q.length-1;Pt>=0;Pt--)this.removeListener(W,Q[Pt]);return this};function $(nt,W,Q){var yt=nt._events;if(yt===void 0)return[];var Pt=yt[W];return Pt===void 0?[]:typeof Pt=="function"?Q?[Pt.listener||Pt]:[Pt]:Q?K(Pt):B(Pt,Pt.length)}T.prototype.listeners=function(W){return $(this,W,!0)},T.prototype.rawListeners=function(W){return $(this,W,!1)},T.listenerCount=function(nt,W){return typeof nt.listenerCount=="function"?nt.listenerCount(W):z.call(nt,W)},T.prototype.listenerCount=z;function z(nt){var W=this._events;if(W!==void 0){var Q=W[nt];if(typeof Q=="function")return 1;if(Q!==void 0)return Q.length}return 0}T.prototype.eventNames=function(){return this._eventsCount>0?y(this._events):[]};function B(nt,W){for(var Q=new Array(W),yt=0;yt<W;++yt)Q[yt]=nt[yt];return Q}function H(nt,W){for(;W+1<nt.length;W++)nt[W]=nt[W+1];nt.pop()}function K(nt){for(var W=new Array(nt.length),Q=0;Q<W.length;++Q)W[Q]=nt[Q].listener||nt[Q];return W}function at(nt,W){return new Promise(function(Q,yt){function Pt(St){nt.removeListener(W,st),yt(St)}function st(){typeof nt.removeListener=="function"&&nt.removeListener("error",Pt),Q([].slice.call(arguments))}et(nt,W,st,{once:!0}),W!=="error"&&ft(nt,Pt,{once:!0})})}function ft(nt,W,Q){typeof nt.on=="function"&&et(nt,"error",W,Q)}function et(nt,W,Q,yt){if(typeof nt.on=="function")yt.once?nt.once(W,Q):nt.on(W,Q);else if(typeof nt.addEventListener=="function")nt.addEventListener(W,function Pt(st){yt.once&&nt.removeEventListener(W,Pt),Q(st)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof nt)}},{}],8:[function(s,a,h){(function(){var f=this,m={};typeof h<"u"?a.exports=m:f.fuzzy=m,m.simpleFilter=function(y,x){return x.filter(function(w){return m.test(y,w)})},m.test=function(y,x){return m.match(y,x)!==null},m.match=function(y,x,w){w=w||{};var T=0,M=[],I=x.length,R=0,O=0,N=w.pre||"",G=w.post||"",$=w.caseSensitive&&x||x.toLowerCase(),z;y=w.caseSensitive&&y||y.toLowerCase();for(var B=0;B<I;B++)z=x[B],$[B]===y[T]?(z=N+z+G,T+=1,O+=1+O):O=0,R+=O,M[M.length]=z;return T===y.length?(R=$===y?1/0:R,{rendered:M.join(""),score:R}):null},m.filter=function(y,x,w){return!x||x.length===0?[]:typeof y!="string"?x:(w=w||{},x.reduce(function(T,M,I,R){var O=M;w.extract&&(O=w.extract(M));var N=m.match(y,O,w);return N!=null&&(T[T.length]={string:N.rendered,score:N.score,index:I,original:M}),T},[]).sort(function(T,M){var I=M.score-T.score;return I||T.index-M.index}))}})()},{}],9:[function(s,a,h){var f=/<%=([\s\S]+?)%>/g;a.exports=f},{}],10:[function(s,a,h){(function(f){(function(){var m="Expected a function",y=NaN,x="[object Symbol]",w=/^\s+|\s+$/g,T=/^[-+]0x[0-9a-f]+$/i,M=/^0b[01]+$/i,I=/^0o[0-7]+$/i,R=parseInt,O=typeof f=="object"&&f&&f.Object===Object&&f,N=typeof self=="object"&&self&&self.Object===Object&&self,G=O||N||Function("return this")(),$=Object.prototype,z=$.toString,B=Math.max,H=Math.min,K=function(){return G.Date.now()};function at(Q,yt,Pt){var st,St,Rt,Zt,Ft,$t,ee=0,se=!1,Ot=!1,Me=!0;if(typeof Q!="function")throw new TypeError(m);yt=W(yt)||0,ft(Pt)&&(se=!!Pt.leading,Ot="maxWait"in Pt,Rt=Ot?B(W(Pt.maxWait)||0,yt):Rt,Me="trailing"in Pt?!!Pt.trailing:Me);function me(Le){var Ne=st,Yn=St;return st=St=void 0,ee=Le,Zt=Q.apply(Yn,Ne),Zt}function kt(Le){return ee=Le,Ft=setTimeout(Ae,yt),se?me(Le):Zt}function Wt(Le){var Ne=Le-$t,Yn=Le-ee,_n=yt-Ne;return Ot?H(_n,Rt-Yn):_n}function Ct(Le){var Ne=Le-$t,Yn=Le-ee;return $t===void 0||Ne>=yt||Ne<0||Ot&&Yn>=Rt}function Ae(){var Le=K();if(Ct(Le))return he(Le);Ft=setTimeout(Ae,Wt(Le))}function he(Le){return Ft=void 0,Me&&st?me(Le):(st=St=void 0,Zt)}function Fe(){Ft!==void 0&&clearTimeout(Ft),ee=0,st=$t=St=Ft=void 0}function Oe(){return Ft===void 0?Zt:he(K())}function Qe(){var Le=K(),Ne=Ct(Le);if(st=arguments,St=this,$t=Le,Ne){if(Ft===void 0)return kt($t);if(Ot)return Ft=setTimeout(Ae,yt),me($t)}return Ft===void 0&&(Ft=setTimeout(Ae,yt)),Zt}return Qe.cancel=Fe,Qe.flush=Oe,Qe}function ft(Q){var yt=typeof Q;return!!Q&&(yt=="object"||yt=="function")}function et(Q){return!!Q&&typeof Q=="object"}function nt(Q){return typeof Q=="symbol"||et(Q)&&z.call(Q)==x}function W(Q){if(typeof Q=="number")return Q;if(nt(Q))return y;if(ft(Q)){var yt=typeof Q.valueOf=="function"?Q.valueOf():Q;Q=ft(yt)?yt+"":yt}if(typeof Q!="string")return Q===0?Q:+Q;Q=Q.replace(w,"");var Pt=M.test(Q);return Pt||I.test(Q)?R(Q.slice(2),Pt?2:8):T.test(Q)?y:+Q}a.exports=at}).call(this)}).call(this,typeof Fa<"u"?Fa:typeof self<"u"?self:typeof window<"u"?window:{})},{}],11:[function(s,a,h){(function(f){(function(){var m=200,y="__lodash_hash_undefined__",x=1,w=2,T=9007199254740991,M="[object Arguments]",I="[object Array]",R="[object AsyncFunction]",O="[object Boolean]",N="[object Date]",G="[object Error]",$="[object Function]",z="[object GeneratorFunction]",B="[object Map]",H="[object Number]",K="[object Null]",at="[object Object]",ft="[object Promise]",et="[object Proxy]",nt="[object RegExp]",W="[object Set]",Q="[object String]",yt="[object Symbol]",Pt="[object Undefined]",st="[object WeakMap]",St="[object ArrayBuffer]",Rt="[object DataView]",Zt="[object Float32Array]",Ft="[object Float64Array]",$t="[object Int8Array]",ee="[object Int16Array]",se="[object Int32Array]",Ot="[object Uint8Array]",Me="[object Uint8ClampedArray]",me="[object Uint16Array]",kt="[object Uint32Array]",Wt=/[\\^$.*+?()[\]{}|]/g,Ct=/^\[object .+?Constructor\]$/,Ae=/^(?:0|[1-9]\d*)$/,he={};he[Zt]=he[Ft]=he[$t]=he[ee]=he[se]=he[Ot]=he[Me]=he[me]=he[kt]=!0,he[M]=he[I]=he[St]=he[O]=he[Rt]=he[N]=he[G]=he[$]=he[B]=he[H]=he[at]=he[nt]=he[W]=he[Q]=he[st]=!1;var Fe=typeof f=="object"&&f&&f.Object===Object&&f,Oe=typeof self=="object"&&self&&self.Object===Object&&self,Qe=Fe||Oe||Function("return this")(),Le=typeof h=="object"&&h&&!h.nodeType&&h,Ne=Le&&typeof a=="object"&&a&&!a.nodeType&&a,Yn=Ne&&Ne.exports===Le,_n=Yn&&Fe.process,Qt=function(){try{return _n&&_n.binding&&_n.binding("util")}catch{}}(),ot=Qt&&Qt.isTypedArray;function lt(mt,bt){for(var de=-1,je=mt==null?0:mt.length,ur=0,on=[];++de<je;){var Sn=mt[de];bt(Sn,de,mt)&&(on[ur++]=Sn)}return on}function _t(mt,bt){for(var de=-1,je=bt.length,ur=mt.length;++de<je;)mt[ur+de]=bt[de];return mt}function Ut(mt,bt){for(var de=-1,je=mt==null?0:mt.length;++de<je;)if(bt(mt[de],de,mt))return!0;return!1}function Ht(mt,bt){for(var de=-1,je=Array(mt);++de<mt;)je[de]=bt(de);return je}function ge(mt){return function(bt){return mt(bt)}}function Ee(mt,bt){return mt.has(bt)}function qt(mt,bt){return mt==null?void 0:mt[bt]}function ke(mt){var bt=-1,de=Array(mt.size);return mt.forEach(function(je,ur){de[++bt]=[ur,je]}),de}function Ve(mt,bt){return function(de){return mt(bt(de))}}function $e(mt){var bt=-1,de=Array(mt.size);return mt.forEach(function(je){de[++bt]=je}),de}var Un=Array.prototype,or=Function.prototype,Mr=Object.prototype,Jn=Qe["__core-js_shared__"],cr=or.toString,En=Mr.hasOwnProperty,ai=function(){var mt=/[^.]+$/.exec(Jn&&Jn.keys&&Jn.keys.IE_PROTO||"");return mt?"Symbol(src)_1."+mt:""}(),Wr=Mr.toString,pi=RegExp("^"+cr.call(En).replace(Wt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ri=Yn?Qe.Buffer:void 0,Jr=Qe.Symbol,Ei=Qe.Uint8Array,gs=Mr.propertyIsEnumerable,vo=Un.splice,rs=Jr?Jr.toStringTag:void 0,zt=Object.getOwnPropertySymbols,Vt=Ri?Ri.isBuffer:void 0,Yt=Ve(Object.keys,Object),ne=Ps(Qe,"DataView"),Kt=Ps(Qe,"Map"),oe=Ps(Qe,"Promise"),fe=Ps(Qe,"Set"),re=Ps(Qe,"WeakMap"),ve=Ps(Object,"create"),le=vt(ne),Ye=vt(Kt),In=vt(oe),De=vt(fe),kn=vt(re),Qn=Jr?Jr.prototype:void 0,Wn=Qn?Qn.valueOf:void 0;function tr(mt){var bt=-1,de=mt==null?0:mt.length;for(this.clear();++bt<de;){var je=mt[bt];this.set(je[0],je[1])}}function mi(){this.__data__=ve?ve(null):{},this.size=0}function is(mt){var bt=this.has(mt)&&delete this.__data__[mt];return this.size-=bt?1:0,bt}function Nr(mt){var bt=this.__data__;if(ve){var de=bt[mt];return de===y?void 0:de}return En.call(bt,mt)?bt[mt]:void 0}function Oi(mt){var bt=this.__data__;return ve?bt[mt]!==void 0:En.call(bt,mt)}function li(mt,bt){var de=this.__data__;return this.size+=this.has(mt)?0:1,de[mt]=ve&&bt===void 0?y:bt,this}tr.prototype.clear=mi,tr.prototype.delete=is,tr.prototype.get=Nr,tr.prototype.has=Oi,tr.prototype.set=li;function $i(mt){var bt=-1,de=mt==null?0:mt.length;for(this.clear();++bt<de;){var je=mt[bt];this.set(je[0],je[1])}}function Xs(){this.__data__=[],this.size=0}function ya(mt){var bt=this.__data__,de=Wo(bt,mt);if(de<0)return!1;var je=bt.length-1;return de==je?bt.pop():vo.call(bt,de,1),--this.size,!0}function bu(mt){var bt=this.__data__,de=Wo(bt,mt);return de<0?void 0:bt[de][1]}function wu(mt){return Wo(this.__data__,mt)>-1}function Df(mt,bt){var de=this.__data__,je=Wo(de,mt);return je<0?(++this.size,de.push([mt,bt])):de[je][1]=bt,this}$i.prototype.clear=Xs,$i.prototype.delete=ya,$i.prototype.get=bu,$i.prototype.has=wu,$i.prototype.set=Df;function xo(mt){var bt=-1,de=mt==null?0:mt.length;for(this.clear();++bt<de;){var je=mt[bt];this.set(je[0],je[1])}}function Fh(){this.size=0,this.__data__={hash:new tr,map:new(Kt||$i),string:new tr}}function Su(mt){var bt=xa(this,mt).delete(mt);return this.size-=bt?1:0,bt}function Rf(mt){return xa(this,mt).get(mt)}function Ya(mt){return xa(this,mt).has(mt)}function Bh(mt,bt){var de=xa(this,mt),je=de.size;return de.set(mt,bt),this.size+=de.size==je?0:1,this}xo.prototype.clear=Fh,xo.prototype.delete=Su,xo.prototype.get=Rf,xo.prototype.has=Ya,xo.prototype.set=Bh;function Go(mt){var bt=-1,de=mt==null?0:mt.length;for(this.__data__=new xo;++bt<de;)this.add(mt[bt])}function jh(mt){return this.__data__.set(mt,y),this}function Of(mt){return this.__data__.has(mt)}Go.prototype.add=Go.prototype.push=jh,Go.prototype.has=Of;function bo(mt){var bt=this.__data__=new $i(mt);this.size=bt.size}function Vh(){this.__data__=new $i,this.size=0}function Hl(mt){var bt=this.__data__,de=bt.delete(mt);return this.size=bt.size,de}function Tu(mt){return this.__data__.get(mt)}function ql(mt){return this.__data__.has(mt)}function Ka(mt,bt){var de=this.__data__;if(de instanceof $i){var je=de.__data__;if(!Kt||je.length<m-1)return je.push([mt,bt]),this.size=++de.size,this;de=this.__data__=new xo(je)}return de.set(mt,bt),this.size=de.size,this}bo.prototype.clear=Vh,bo.prototype.delete=Hl,bo.prototype.get=Tu,bo.prototype.has=ql,bo.prototype.set=Ka;function Zl(mt,bt){var de=Ar(mt),je=!de&&Mi(mt),ur=!de&&!je&&Sr(mt),on=!de&&!je&&!ur&&pe(mt),Sn=de||je||ur||on,Ai=Sn?Ht(mt.length,String):[],Qr=Ai.length;for(var Cr in mt)(bt||En.call(mt,Cr))&&!(Sn&&(Cr=="length"||ur&&(Cr=="offset"||Cr=="parent")||on&&(Cr=="buffer"||Cr=="byteLength"||Cr=="byteOffset")||Jt(Cr,Qr)))&&Ai.push(Cr);return Ai}function Wo(mt,bt){for(var de=mt.length;de--;)if(ie(mt[de][0],bt))return de;return-1}function Ja(mt,bt,de){var je=bt(mt);return Ar(mt)?je:_t(je,de(mt))}function ss(mt){return mt==null?mt===void 0?Pt:K:rs&&rs in Object(mt)?tl(mt):Mn(mt)}function va(mt){return ys(mt)&&ss(mt)==M}function Be(mt,bt,de,je,ur){return mt===bt?!0:mt==null||bt==null||!ys(mt)&&!ys(bt)?mt!==mt&&bt!==bt:Nn(mt,bt,de,je,Be,ur)}function Nn(mt,bt,de,je,ur,on){var Sn=Ar(mt),Ai=Ar(bt),Qr=Sn?I:Tt(mt),Cr=Ai?I:Tt(bt);Qr=Qr==M?at:Qr,Cr=Cr==M?at:Cr;var Li=Qr==at,vs=Cr==at,zi=Qr==Cr;if(zi&&Sr(mt)){if(!Sr(bt))return!1;Sn=!0,Li=!1}if(zi&&!Li)return on||(on=new bo),Sn||pe(mt)?Xl(mt,bt,de,je,ur,on):Uh(mt,bt,Qr,de,je,ur,on);if(!(de&x)){var Zi=Li&&En.call(mt,"__wrapped__"),os=vs&&En.call(bt,"__wrapped__");if(Zi||os){var Ks=Zi?mt.value():mt,Js=os?bt.value():bt;return on||(on=new bo),ur(Ks,Js,de,je,on)}}return zi?(on||(on=new bo),$h(mt,bt,de,je,ur,on)):!1}function Ys(mt){if(!el(mt)||Bt(mt))return!1;var bt=_s(mt)?pi:Ct;return bt.test(vt(mt))}function Ho(mt){return ys(mt)&&ba(mt.length)&&!!he[ss(mt)]}function Qa(mt){if(!xe(mt))return Yt(mt);var bt=[];for(var de in Object(mt))En.call(mt,de)&&de!="constructor"&&bt.push(de);return bt}function Xl(mt,bt,de,je,ur,on){var Sn=de&x,Ai=mt.length,Qr=bt.length;if(Ai!=Qr&&!(Sn&&Qr>Ai))return!1;var Cr=on.get(mt);if(Cr&&on.get(bt))return Cr==bt;var Li=-1,vs=!0,zi=de&w?new Go:void 0;for(on.set(mt,bt),on.set(bt,mt);++Li<Ai;){var Zi=mt[Li],os=bt[Li];if(je)var Ks=Sn?je(os,Zi,Li,bt,mt,on):je(Zi,os,Li,mt,bt,on);if(Ks!==void 0){if(Ks)continue;vs=!1;break}if(zi){if(!Ut(bt,function(Js,ci){if(!Ee(zi,ci)&&(Zi===Js||ur(Zi,Js,de,je,on)))return zi.push(ci)})){vs=!1;break}}else if(!(Zi===os||ur(Zi,os,de,je,on))){vs=!1;break}}return on.delete(mt),on.delete(bt),vs}function Uh(mt,bt,de,je,ur,on,Sn){switch(de){case Rt:if(mt.byteLength!=bt.byteLength||mt.byteOffset!=bt.byteOffset)return!1;mt=mt.buffer,bt=bt.buffer;case St:return!(mt.byteLength!=bt.byteLength||!on(new Ei(mt),new Ei(bt)));case O:case N:case H:return ie(+mt,+bt);case G:return mt.name==bt.name&&mt.message==bt.message;case nt:case Q:return mt==bt+"";case B:var Ai=ke;case W:var Qr=je&x;if(Ai||(Ai=$e),mt.size!=bt.size&&!Qr)return!1;var Cr=Sn.get(mt);if(Cr)return Cr==bt;je|=w,Sn.set(mt,bt);var Li=Xl(Ai(mt),Ai(bt),je,ur,on,Sn);return Sn.delete(mt),Li;case yt:if(Wn)return Wn.call(mt)==Wn.call(bt)}return!1}function $h(mt,bt,de,je,ur,on){var Sn=de&x,Ai=Yl(mt),Qr=Ai.length,Cr=Yl(bt),Li=Cr.length;if(Qr!=Li&&!Sn)return!1;for(var vs=Qr;vs--;){var zi=Ai[vs];if(!(Sn?zi in bt:En.call(bt,zi)))return!1}var Zi=on.get(mt);if(Zi&&on.get(bt))return Zi==bt;var os=!0;on.set(mt,bt),on.set(bt,mt);for(var Ks=Sn;++vs<Qr;){zi=Ai[vs];var Js=mt[zi],ci=bt[zi];if(je)var tn=Sn?je(ci,Js,zi,bt,mt,on):je(Js,ci,zi,mt,bt,on);if(!(tn===void 0?Js===ci||ur(Js,ci,de,je,on):tn)){os=!1;break}Ks||(Ks=zi=="constructor")}if(os&&!Ks){var Kl=mt.constructor,Jl=bt.constructor;Kl!=Jl&&"constructor"in mt&&"constructor"in bt&&!(typeof Kl=="function"&&Kl instanceof Kl&&typeof Jl=="function"&&Jl instanceof Jl)&&(os=!1)}return on.delete(mt),on.delete(bt),os}function Yl(mt){return Ja(mt,pn,Gh)}function xa(mt,bt){var de=mt.__data__;return _e(bt)?de[typeof bt=="string"?"string":"hash"]:de.map}function Ps(mt,bt){var de=qt(mt,bt);return Ys(de)?de:void 0}function tl(mt){var bt=En.call(mt,rs),de=mt[rs];try{mt[rs]=void 0;var je=!0}catch{}var ur=Wr.call(mt);return je&&(bt?mt[rs]=de:delete mt[rs]),ur}var Gh=zt?function(mt){return mt==null?[]:(mt=Object(mt),lt(zt(mt),function(bt){return gs.call(mt,bt)}))}:An,Tt=ss;(ne&&Tt(new ne(new ArrayBuffer(1)))!=Rt||Kt&&Tt(new Kt)!=B||oe&&Tt(oe.resolve())!=ft||fe&&Tt(new fe)!=W||re&&Tt(new re)!=st)&&(Tt=function(mt){var bt=ss(mt),de=bt==at?mt.constructor:void 0,je=de?vt(de):"";if(je)switch(je){case le:return Rt;case Ye:return B;case In:return ft;case De:return W;case kn:return st}return bt});function Jt(mt,bt){return bt=bt??T,!!bt&&(typeof mt=="number"||Ae.test(mt))&&mt>-1&&mt%1==0&&mt<bt}function _e(mt){var bt=typeof mt;return bt=="string"||bt=="number"||bt=="symbol"||bt=="boolean"?mt!=="__proto__":mt===null}function Bt(mt){return!!ai&&ai in mt}function xe(mt){var bt=mt&&mt.constructor,de=typeof bt=="function"&&bt.prototype||Mr;return mt===de}function Mn(mt){return Wr.call(mt)}function vt(mt){if(mt!=null){try{return cr.call(mt)}catch{}try{return mt+""}catch{}}return""}function ie(mt,bt){return mt===bt||mt!==mt&&bt!==bt}var Mi=va(function(){return arguments}())?va:function(mt){return ys(mt)&&En.call(mt,"callee")&&!gs.call(mt,"callee")},Ar=Array.isArray;function wr(mt){return mt!=null&&ba(mt.length)&&!_s(mt)}var Sr=Vt||qi;function Lf(mt,bt){return Be(mt,bt)}function _s(mt){if(!el(mt))return!1;var bt=ss(mt);return bt==$||bt==z||bt==R||bt==et}function ba(mt){return typeof mt=="number"&&mt>-1&&mt%1==0&&mt<=T}function el(mt){var bt=typeof mt;return mt!=null&&(bt=="object"||bt=="function")}function ys(mt){return mt!=null&&typeof mt=="object"}var pe=ot?ge(ot):Ho;function pn(mt){return wr(mt)?Zl(mt):Qa(mt)}function An(){return[]}function qi(){return!1}a.exports=Lf}).call(this)}).call(this,typeof Fa<"u"?Fa:typeof self<"u"?self:typeof window<"u"?window:{})},{}],12:[function(s,a,h){(function(f){(function(){var m=s("lodash._reinterpolate"),y=s("lodash.templatesettings"),x=800,w=16,T=1/0,M=9007199254740991,I="[object Arguments]",R="[object Array]",O="[object AsyncFunction]",N="[object Boolean]",G="[object Date]",$="[object DOMException]",z="[object Error]",B="[object Function]",H="[object GeneratorFunction]",K="[object Map]",at="[object Number]",ft="[object Null]",et="[object Object]",nt="[object Proxy]",W="[object RegExp]",Q="[object Set]",yt="[object String]",Pt="[object Symbol]",st="[object Undefined]",St="[object WeakMap]",Rt="[object ArrayBuffer]",Zt="[object DataView]",Ft="[object Float32Array]",$t="[object Float64Array]",ee="[object Int8Array]",se="[object Int16Array]",Ot="[object Int32Array]",Me="[object Uint8Array]",me="[object Uint8ClampedArray]",kt="[object Uint16Array]",Wt="[object Uint32Array]",Ct=/\b__p \+= '';/g,Ae=/\b(__p \+=) '' \+/g,he=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Fe=/[\\^$.*+?()[\]{}|]/g,Oe=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Qe=/^\[object .+?Constructor\]$/,Le=/^(?:0|[1-9]\d*)$/,Ne=/($^)/,Yn=/['\n\r\u2028\u2029\\]/g,_n={};_n[Ft]=_n[$t]=_n[ee]=_n[se]=_n[Ot]=_n[Me]=_n[me]=_n[kt]=_n[Wt]=!0,_n[I]=_n[R]=_n[Rt]=_n[N]=_n[Zt]=_n[G]=_n[z]=_n[B]=_n[K]=_n[at]=_n[et]=_n[W]=_n[Q]=_n[yt]=_n[St]=!1;var Qt={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ot=typeof f=="object"&&f&&f.Object===Object&&f,lt=typeof self=="object"&&self&&self.Object===Object&&self,_t=ot||lt||Function("return this")(),Ut=typeof h=="object"&&h&&!h.nodeType&&h,Ht=Ut&&typeof a=="object"&&a&&!a.nodeType&&a,ge=Ht&&Ht.exports===Ut,Ee=ge&&ot.process,qt=function(){try{var Tt=Ht&&Ht.require&&Ht.require("util").types;return Tt||Ee&&Ee.binding&&Ee.binding("util")}catch{}}(),ke=qt&&qt.isTypedArray;function Ve(Tt,Jt,_e){switch(_e.length){case 0:return Tt.call(Jt);case 1:return Tt.call(Jt,_e[0]);case 2:return Tt.call(Jt,_e[0],_e[1]);case 3:return Tt.call(Jt,_e[0],_e[1],_e[2])}return Tt.apply(Jt,_e)}function $e(Tt,Jt){for(var _e=-1,Bt=Tt==null?0:Tt.length,xe=Array(Bt);++_e<Bt;)xe[_e]=Jt(Tt[_e],_e,Tt);return xe}function Un(Tt,Jt){for(var _e=-1,Bt=Array(Tt);++_e<Tt;)Bt[_e]=Jt(_e);return Bt}function or(Tt){return function(Jt){return Tt(Jt)}}function Mr(Tt,Jt){return $e(Jt,function(_e){return Tt[_e]})}function Jn(Tt){return"\\"+Qt[Tt]}function cr(Tt,Jt){return Tt==null?void 0:Tt[Jt]}function En(Tt,Jt){return function(_e){return Tt(Jt(_e))}}var ai=Function.prototype,Wr=Object.prototype,pi=_t["__core-js_shared__"],Ri=ai.toString,Jr=Wr.hasOwnProperty,Ei=function(){var Tt=/[^.]+$/.exec(pi&&pi.keys&&pi.keys.IE_PROTO||"");return Tt?"Symbol(src)_1."+Tt:""}(),gs=Wr.toString,vo=Ri.call(Object),rs=RegExp("^"+Ri.call(Jr).replace(Fe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),zt=ge?_t.Buffer:void 0,Vt=_t.Symbol,Yt=En(Object.getPrototypeOf,Object),ne=Wr.propertyIsEnumerable,Kt=Vt?Vt.toStringTag:void 0,oe=function(){try{var Tt=Df(Object,"defineProperty");return Tt({},"",{}),Tt}catch{}}(),fe=zt?zt.isBuffer:void 0,re=En(Object.keys,Object),ve=Math.max,le=Date.now,Ye=Vt?Vt.prototype:void 0,In=Ye?Ye.toString:void 0;function De(Tt,Jt){var _e=ql(Tt),Bt=!_e&&Tu(Tt),xe=!_e&&!Bt&&Zl(Tt),Mn=!_e&&!Bt&&!xe&&Ho(Tt),vt=_e||Bt||xe||Mn,ie=vt?Un(Tt.length,String):[],Mi=ie.length;for(var Ar in Tt)(Jt||Jr.call(Tt,Ar))&&!(vt&&(Ar=="length"||xe&&(Ar=="offset"||Ar=="parent")||Mn&&(Ar=="buffer"||Ar=="byteLength"||Ar=="byteOffset")||Fh(Ar,Mi)))&&ie.push(Ar);return ie}function kn(Tt,Jt,_e){var Bt=Tt[Jt];(!(Jr.call(Tt,Jt)&&Hl(Bt,_e))||_e===void 0&&!(Jt in Tt))&&Qn(Tt,Jt,_e)}function Qn(Tt,Jt,_e){Jt=="__proto__"&&oe?oe(Tt,Jt,{configurable:!0,enumerable:!0,value:_e,writable:!0}):Tt[Jt]=_e}function Wn(Tt){return Tt==null?Tt===void 0?st:ft:Kt&&Kt in Object(Tt)?xo(Tt):Go(Tt)}function tr(Tt){return Be(Tt)&&Wn(Tt)==I}function mi(Tt){if(!va(Tt)||Rf(Tt))return!1;var Jt=Ja(Tt)?rs:Qe;return Jt.test(Vh(Tt))}function is(Tt){return Be(Tt)&&ss(Tt.length)&&!!_n[Wn(Tt)]}function Nr(Tt){if(!Ya(Tt))return re(Tt);var Jt=[];for(var _e in Object(Tt))Jr.call(Tt,_e)&&_e!="constructor"&&Jt.push(_e);return Jt}function Oi(Tt){if(!va(Tt))return Bh(Tt);var Jt=Ya(Tt),_e=[];for(var Bt in Tt)Bt=="constructor"&&(Jt||!Jr.call(Tt,Bt))||_e.push(Bt);return _e}function li(Tt,Jt){return Of(jh(Tt,Jt,tl),Tt+"")}var $i=oe?function(Tt,Jt){return oe(Tt,"toString",{configurable:!0,enumerable:!1,value:Ps(Jt),writable:!0})}:tl;function Xs(Tt){if(typeof Tt=="string")return Tt;if(ql(Tt))return $e(Tt,Xs)+"";if(Ys(Tt))return In?In.call(Tt):"";var Jt=Tt+"";return Jt=="0"&&1/Tt==-T?"-0":Jt}function ya(Tt,Jt,_e,Bt){var xe=!_e;_e||(_e={});for(var Mn=-1,vt=Jt.length;++Mn<vt;){var ie=Jt[Mn],Mi=Bt?Bt(_e[ie],Tt[ie],ie,_e,Tt):void 0;Mi===void 0&&(Mi=Tt[ie]),xe?Qn(_e,ie,Mi):kn(_e,ie,Mi)}return _e}function bu(Tt){return li(function(Jt,_e){var Bt=-1,xe=_e.length,Mn=xe>1?_e[xe-1]:void 0,vt=xe>2?_e[2]:void 0;for(Mn=Tt.length>3&&typeof Mn=="function"?(xe--,Mn):void 0,vt&&Su(_e[0],_e[1],vt)&&(Mn=xe<3?void 0:Mn,xe=1),Jt=Object(Jt);++Bt<xe;){var ie=_e[Bt];ie&&Tt(Jt,ie,Bt,Mn)}return Jt})}function wu(Tt,Jt,_e,Bt){return Tt===void 0||Hl(Tt,Wr[_e])&&!Jr.call(Bt,_e)?Jt:Tt}function Df(Tt,Jt){var _e=cr(Tt,Jt);return mi(_e)?_e:void 0}function xo(Tt){var Jt=Jr.call(Tt,Kt),_e=Tt[Kt];try{Tt[Kt]=void 0;var Bt=!0}catch{}var xe=gs.call(Tt);return Bt&&(Jt?Tt[Kt]=_e:delete Tt[Kt]),xe}function Fh(Tt,Jt){var _e=typeof Tt;return Jt=Jt??M,!!Jt&&(_e=="number"||_e!="symbol"&&Le.test(Tt))&&Tt>-1&&Tt%1==0&&Tt<Jt}function Su(Tt,Jt,_e){if(!va(_e))return!1;var Bt=typeof Jt;return(Bt=="number"?Ka(_e)&&Fh(Jt,_e.length):Bt=="string"&&Jt in _e)?Hl(_e[Jt],Tt):!1}function Rf(Tt){return!!Ei&&Ei in Tt}function Ya(Tt){var Jt=Tt&&Tt.constructor,_e=typeof Jt=="function"&&Jt.prototype||Wr;return Tt===_e}function Bh(Tt){var Jt=[];if(Tt!=null)for(var _e in Object(Tt))Jt.push(_e);return Jt}function Go(Tt){return gs.call(Tt)}function jh(Tt,Jt,_e){return Jt=ve(Jt===void 0?Tt.length-1:Jt,0),function(){for(var Bt=arguments,xe=-1,Mn=ve(Bt.length-Jt,0),vt=Array(Mn);++xe<Mn;)vt[xe]=Bt[Jt+xe];xe=-1;for(var ie=Array(Jt+1);++xe<Jt;)ie[xe]=Bt[xe];return ie[Jt]=_e(vt),Ve(Tt,this,ie)}}var Of=bo($i);function bo(Tt){var Jt=0,_e=0;return function(){var Bt=le(),xe=w-(Bt-_e);if(_e=Bt,xe>0){if(++Jt>=x)return arguments[0]}else Jt=0;return Tt.apply(void 0,arguments)}}function Vh(Tt){if(Tt!=null){try{return Ri.call(Tt)}catch{}try{return Tt+""}catch{}}return""}function Hl(Tt,Jt){return Tt===Jt||Tt!==Tt&&Jt!==Jt}var Tu=tr(function(){return arguments}())?tr:function(Tt){return Be(Tt)&&Jr.call(Tt,"callee")&&!ne.call(Tt,"callee")},ql=Array.isArray;function Ka(Tt){return Tt!=null&&ss(Tt.length)&&!Ja(Tt)}var Zl=fe||Gh;function Wo(Tt){if(!Be(Tt))return!1;var Jt=Wn(Tt);return Jt==z||Jt==$||typeof Tt.message=="string"&&typeof Tt.name=="string"&&!Nn(Tt)}function Ja(Tt){if(!va(Tt))return!1;var Jt=Wn(Tt);return Jt==B||Jt==H||Jt==O||Jt==nt}function ss(Tt){return typeof Tt=="number"&&Tt>-1&&Tt%1==0&&Tt<=M}function va(Tt){var Jt=typeof Tt;return Tt!=null&&(Jt=="object"||Jt=="function")}function Be(Tt){return Tt!=null&&typeof Tt=="object"}function Nn(Tt){if(!Be(Tt)||Wn(Tt)!=et)return!1;var Jt=Yt(Tt);if(Jt===null)return!0;var _e=Jr.call(Jt,"constructor")&&Jt.constructor;return typeof _e=="function"&&_e instanceof _e&&Ri.call(_e)==vo}function Ys(Tt){return typeof Tt=="symbol"||Be(Tt)&&Wn(Tt)==Pt}var Ho=ke?or(ke):is;function Qa(Tt){return Tt==null?"":Xs(Tt)}var Xl=bu(function(Tt,Jt,_e,Bt){ya(Jt,$h(Jt),Tt,Bt)});function Uh(Tt){return Ka(Tt)?De(Tt):Nr(Tt)}function $h(Tt){return Ka(Tt)?De(Tt,!0):Oi(Tt)}function Yl(Tt,Jt,_e){var Bt=y.imports._.templateSettings||y;_e&&Su(Tt,Jt,_e)&&(Jt=void 0),Tt=Qa(Tt),Jt=Xl({},Jt,Bt,wu);var xe=Xl({},Jt.imports,Bt.imports,wu),Mn=Uh(xe),vt=Mr(xe,Mn),ie,Mi,Ar=0,wr=Jt.interpolate||Ne,Sr="__p += '",Lf=RegExp((Jt.escape||Ne).source+"|"+wr.source+"|"+(wr===m?Oe:Ne).source+"|"+(Jt.evaluate||Ne).source+"|$","g"),_s=Jr.call(Jt,"sourceURL")?"//# sourceURL="+(Jt.sourceURL+"").replace(/[\r\n]/g," ")+`
`:"";Tt.replace(Lf,function(ys,pe,pn,An,qi,mt){return pn||(pn=An),Sr+=Tt.slice(Ar,mt).replace(Yn,Jn),pe&&(ie=!0,Sr+=`' +
__e(`+pe+`) +
'`),qi&&(Mi=!0,Sr+=`';
`+qi+`;
__p += '`),pn&&(Sr+=`' +
((__t = (`+pn+`)) == null ? '' : __t) +
'`),Ar=mt+ys.length,ys}),Sr+=`';
`;var ba=Jr.call(Jt,"variable")&&Jt.variable;ba||(Sr=`with (obj) {
`+Sr+`
}
`),Sr=(Mi?Sr.replace(Ct,""):Sr).replace(Ae,"$1").replace(he,"$1;"),Sr="function("+(ba||"obj")+`) {
`+(ba?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(ie?", __e = _.escape":"")+(Mi?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Sr+`return __p
}`;var el=xa(function(){return Function(Mn,_s+"return "+Sr).apply(void 0,vt)});if(el.source=Sr,Wo(el))throw el;return el}var xa=li(function(Tt,Jt){try{return Ve(Tt,void 0,Jt)}catch(_e){return Wo(_e)?_e:new Error(_e)}});function Ps(Tt){return function(){return Tt}}function tl(Tt){return Tt}function Gh(){return!1}a.exports=Yl}).call(this)}).call(this,typeof Fa<"u"?Fa:typeof self<"u"?self:typeof window<"u"?window:{})},{"lodash._reinterpolate":9,"lodash.templatesettings":13}],13:[function(s,a,h){(function(f){(function(){var m=s("lodash._reinterpolate"),y=1/0,x="[object Symbol]",w=/[&<>"'`]/g,T=RegExp(w.source),M=/<%-([\s\S]+?)%>/g,I=/<%([\s\S]+?)%>/g,R={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},O=typeof f=="object"&&f&&f.Object===Object&&f,N=typeof self=="object"&&self&&self.Object===Object&&self,G=O||N||Function("return this")();function $(st){return function(St){return st==null?void 0:st[St]}}var z=$(R),B=Object.prototype,H=B.toString,K=G.Symbol,at=K?K.prototype:void 0,ft=at?at.toString:void 0,et={escape:M,evaluate:I,interpolate:m,variable:"",imports:{_:{escape:Pt}}};function nt(st){if(typeof st=="string")return st;if(Q(st))return ft?ft.call(st):"";var St=st+"";return St=="0"&&1/st==-y?"-0":St}function W(st){return!!st&&typeof st=="object"}function Q(st){return typeof st=="symbol"||W(st)&&H.call(st)==x}function yt(st){return st==null?"":nt(st)}function Pt(st){return st=yt(st),st&&T.test(st)?st.replace(w,z):st}a.exports=et}).call(this)}).call(this,typeof Fa<"u"?Fa:typeof self<"u"?self:typeof window<"u"?window:{})},{"lodash._reinterpolate":9}],14:[function(s,a,h){const f=s("is-plain-obj"),{hasOwnProperty:m}=Object.prototype,{propertyIsEnumerable:y}=Object,x=(z,B,H)=>Object.defineProperty(z,B,{value:H,writable:!0,enumerable:!0,configurable:!0}),w=this,T={concatArrays:!1,ignoreUndefined:!1},M=z=>{const B=[];for(const H in z)m.call(z,H)&&B.push(H);if(Object.getOwnPropertySymbols){const H=Object.getOwnPropertySymbols(z);for(const K of H)y.call(z,K)&&B.push(K)}return B};function I(z){return Array.isArray(z)?R(z):f(z)?O(z):z}function R(z){const B=z.slice(0,0);return M(z).forEach(H=>{x(B,H,I(z[H]))}),B}function O(z){const B=Object.getPrototypeOf(z)===null?Object.create(null):{};return M(z).forEach(H=>{x(B,H,I(z[H]))}),B}const N=(z,B,H,K)=>(H.forEach(at=>{typeof B[at]>"u"&&K.ignoreUndefined||(at in z&&z[at]!==Object.getPrototypeOf(z)?x(z,at,$(z[at],B[at],K)):x(z,at,I(B[at])))}),z),G=(z,B,H)=>{let K=z.slice(0,0),at=0;return[z,B].forEach(ft=>{const et=[];for(let nt=0;nt<ft.length;nt++)m.call(ft,nt)&&(et.push(String(nt)),ft===z?x(K,at++,ft[nt]):x(K,at++,I(ft[nt])));K=N(K,ft,M(ft).filter(nt=>!et.includes(nt)),H)}),K};function $(z,B,H){return H.concatArrays&&Array.isArray(z)&&Array.isArray(B)?G(z,B,H):!f(B)||!f(z)?I(B):N(z,B,M(B),H)}a.exports=function(...z){const B=$(I(T),this!==w&&this||{},T);let H={_:{}};for(const K of z)if(K!==void 0){if(!f(K))throw new TypeError("`"+K+"` is not an Option Object");H=$(H,{_:K},B)}return H._}},{"is-plain-obj":15}],15:[function(s,a,h){a.exports=f=>{if(Object.prototype.toString.call(f)!=="[object Object]")return!1;const m=Object.getPrototypeOf(f);return m===null||m===Object.prototype}},{}],16:[function(s,a,h){var f=a.exports={},m,y;function x(){throw new Error("setTimeout has not been defined")}function w(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?m=setTimeout:m=x}catch{m=x}try{typeof clearTimeout=="function"?y=clearTimeout:y=w}catch{y=w}})();function T(H){if(m===setTimeout)return setTimeout(H,0);if((m===x||!m)&&setTimeout)return m=setTimeout,setTimeout(H,0);try{return m(H,0)}catch{try{return m.call(null,H,0)}catch{return m.call(this,H,0)}}}function M(H){if(y===clearTimeout)return clearTimeout(H);if((y===w||!y)&&clearTimeout)return y=clearTimeout,clearTimeout(H);try{return y(H)}catch{try{return y.call(null,H)}catch{return y.call(this,H)}}}var I=[],R=!1,O,N=-1;function G(){!R||!O||(R=!1,O.length?I=O.concat(I):N=-1,I.length&&$())}function $(){if(!R){var H=T(G);R=!0;for(var K=I.length;K;){for(O=I,I=[];++N<K;)O&&O[N].run();N=-1,K=I.length}O=null,R=!1,M(H)}}f.nextTick=function(H){var K=new Array(arguments.length-1);if(arguments.length>1)for(var at=1;at<arguments.length;at++)K[at-1]=arguments[at];I.push(new z(H,K)),I.length===1&&!R&&T($)};function z(H,K){this.fun=H,this.array=K}z.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={};function B(){}f.on=B,f.addListener=B,f.once=B,f.off=B,f.removeListener=B,f.removeAllListeners=B,f.emit=B,f.prependListener=B,f.prependOnceListener=B,f.listeners=function(H){return[]},f.binding=function(H){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(H){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},{}],17:[function(s,a,h){Object.defineProperty(h,"__esModule",{value:!0}),h.default=void 0;function f(x){var w=function(M){var I=M.dispatch,R=M.getState;return function(O){return function(N){return typeof N=="function"?N(I,R,x):O(N)}}};return w}var m=f();m.withExtraArgument=f;var y=m;h.default=y},{}],18:[function(s,a,h){(function(f){(function(){Object.defineProperty(h,"__esModule",{value:!0});var m=s("@babel/runtime/helpers/objectSpread2");function y(st){return st&&typeof st=="object"&&"default"in st?st:{default:st}}var x=y(m);function w(st){return"Minified Redux error #"+st+"; visit https://redux.js.org/Errors?code="+st+" for the full message or use the non-minified dev environment for full errors. "}var T=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),M=function(){return Math.random().toString(36).substring(7).split("").join(".")},I={INIT:"@@redux/INIT"+M(),REPLACE:"@@redux/REPLACE"+M(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+M()}};function R(st){if(typeof st!="object"||st===null)return!1;for(var St=st;Object.getPrototypeOf(St)!==null;)St=Object.getPrototypeOf(St);return Object.getPrototypeOf(st)===St}function O(st){if(st===void 0)return"undefined";if(st===null)return"null";var St=typeof st;switch(St){case"boolean":case"string":case"number":case"symbol":case"function":return St}if(Array.isArray(st))return"array";if($(st))return"date";if(G(st))return"error";var Rt=N(st);switch(Rt){case"Symbol":case"Promise":case"WeakMap":case"WeakSet":case"Map":case"Set":return Rt}return St.slice(8,-1).toLowerCase().replace(/\s/g,"")}function N(st){return typeof st.constructor=="function"?st.constructor.name:null}function G(st){return st instanceof Error||typeof st.message=="string"&&st.constructor&&typeof st.constructor.stackTraceLimit=="number"}function $(st){return st instanceof Date?!0:typeof st.toDateString=="function"&&typeof st.getDate=="function"&&typeof st.setDate=="function"}function z(st){var St=typeof st;return f.env.NODE_ENV!=="production"&&(St=O(st)),St}function B(st,St,Rt){var Zt;if(typeof St=="function"&&typeof Rt=="function"||typeof Rt=="function"&&typeof arguments[3]=="function")throw new Error(f.env.NODE_ENV==="production"?w(0):"It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function. See https://redux.js.org/tutorials/fundamentals/part-4-store#creating-a-store-with-enhancers for an example.");if(typeof St=="function"&&typeof Rt>"u"&&(Rt=St,St=void 0),typeof Rt<"u"){if(typeof Rt!="function")throw new Error(f.env.NODE_ENV==="production"?w(1):"Expected the enhancer to be a function. Instead, received: '"+z(Rt)+"'");return Rt(B)(st,St)}if(typeof st!="function")throw new Error(f.env.NODE_ENV==="production"?w(2):"Expected the root reducer to be a function. Instead, received: '"+z(st)+"'");var Ft=st,$t=St,ee=[],se=ee,Ot=!1;function Me(){se===ee&&(se=ee.slice())}function me(){if(Ot)throw new Error(f.env.NODE_ENV==="production"?w(3):"You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return $t}function kt(he){if(typeof he!="function")throw new Error(f.env.NODE_ENV==="production"?w(4):"Expected the listener to be a function. Instead, received: '"+z(he)+"'");if(Ot)throw new Error(f.env.NODE_ENV==="production"?w(5):"You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api/store#subscribelistener for more details.");var Fe=!0;return Me(),se.push(he),function(){if(Fe){if(Ot)throw new Error(f.env.NODE_ENV==="production"?w(6):"You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api/store#subscribelistener for more details.");Fe=!1,Me();var Qe=se.indexOf(he);se.splice(Qe,1),ee=null}}}function Wt(he){if(!R(he))throw new Error(f.env.NODE_ENV==="production"?w(7):"Actions must be plain objects. Instead, the actual type was: '"+z(he)+"'. You may need to add middleware to your store setup to handle dispatching other values, such as 'redux-thunk' to handle dispatching functions. See https://redux.js.org/tutorials/fundamentals/part-4-store#middleware and https://redux.js.org/tutorials/fundamentals/part-6-async-logic#using-the-redux-thunk-middleware for examples.");if(typeof he.type>"u")throw new Error(f.env.NODE_ENV==="production"?w(8):'Actions may not have an undefined "type" property. You may have misspelled an action type string constant.');if(Ot)throw new Error(f.env.NODE_ENV==="production"?w(9):"Reducers may not dispatch actions.");try{Ot=!0,$t=Ft($t,he)}finally{Ot=!1}for(var Fe=ee=se,Oe=0;Oe<Fe.length;Oe++){var Qe=Fe[Oe];Qe()}return he}function Ct(he){if(typeof he!="function")throw new Error(f.env.NODE_ENV==="production"?w(10):"Expected the nextReducer to be a function. Instead, received: '"+z(he));Ft=he,Wt({type:I.REPLACE})}function Ae(){var he,Fe=kt;return he={subscribe:function(Qe){if(typeof Qe!="object"||Qe===null)throw new Error(f.env.NODE_ENV==="production"?w(11):"Expected the observer to be an object. Instead, received: '"+z(Qe)+"'");function Le(){Qe.next&&Qe.next(me())}Le();var Ne=Fe(Le);return{unsubscribe:Ne}}},he[T]=function(){return this},he}return Wt({type:I.INIT}),Zt={dispatch:Wt,subscribe:kt,getState:me,replaceReducer:Ct},Zt[T]=Ae,Zt}var H=B;function K(st){typeof console<"u"&&typeof console.error=="function"&&console.error(st);try{throw new Error(st)}catch{}}function at(st,St,Rt,Zt){var Ft=Object.keys(St),$t=Rt&&Rt.type===I.INIT?"preloadedState argument passed to createStore":"previous state received by the reducer";if(Ft.length===0)return"Store does not have a valid reducer. Make sure the argument passed to combineReducers is an object whose values are reducers.";if(!R(st))return"The "+$t+' has unexpected type of "'+z(st)+'". Expected argument to be an object with the following '+('keys: "'+Ft.join('", "')+'"');var ee=Object.keys(st).filter(function(se){return!St.hasOwnProperty(se)&&!Zt[se]});if(ee.forEach(function(se){Zt[se]=!0}),!(Rt&&Rt.type===I.REPLACE)&&ee.length>0)return"Unexpected "+(ee.length>1?"keys":"key")+" "+('"'+ee.join('", "')+'" found in '+$t+". ")+"Expected to find one of the known reducer keys instead: "+('"'+Ft.join('", "')+'". Unexpected keys will be ignored.')}function ft(st){Object.keys(st).forEach(function(St){var Rt=st[St],Zt=Rt(void 0,{type:I.INIT});if(typeof Zt>"u")throw new Error(f.env.NODE_ENV==="production"?w(12):'The slice reducer for key "'+St+`" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.`);if(typeof Rt(void 0,{type:I.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(f.env.NODE_ENV==="production"?w(13):'The slice reducer for key "'+St+'" returned undefined when probed with a random type. '+("Don't try to handle '"+I.INIT+`' or other actions in "redux/*" `)+"namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.")})}function et(st){for(var St=Object.keys(st),Rt={},Zt=0;Zt<St.length;Zt++){var Ft=St[Zt];f.env.NODE_ENV!=="production"&&typeof st[Ft]>"u"&&K('No reducer provided for key "'+Ft+'"'),typeof st[Ft]=="function"&&(Rt[Ft]=st[Ft])}var $t=Object.keys(Rt),ee;f.env.NODE_ENV!=="production"&&(ee={});var se;try{ft(Rt)}catch(Ot){se=Ot}return function(Me,me){if(Me===void 0&&(Me={}),se)throw se;if(f.env.NODE_ENV!=="production"){var kt=at(Me,Rt,me,ee);kt&&K(kt)}for(var Wt=!1,Ct={},Ae=0;Ae<$t.length;Ae++){var he=$t[Ae],Fe=Rt[he],Oe=Me[he],Qe=Fe(Oe,me);if(typeof Qe>"u"){var Le=me&&me.type;throw new Error(f.env.NODE_ENV==="production"?w(14):"When called with an action of type "+(Le?'"'+String(Le)+'"':"(unknown type)")+', the slice reducer for key "'+he+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.')}Ct[he]=Qe,Wt=Wt||Qe!==Oe}return Wt=Wt||$t.length!==Object.keys(Me).length,Wt?Ct:Me}}function nt(st,St){return function(){return St(st.apply(this,arguments))}}function W(st,St){if(typeof st=="function")return nt(st,St);if(typeof st!="object"||st===null)throw new Error(f.env.NODE_ENV==="production"?w(16):"bindActionCreators expected an object or a function, but instead received: '"+z(st)+`'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?`);var Rt={};for(var Zt in st){var Ft=st[Zt];typeof Ft=="function"&&(Rt[Zt]=nt(Ft,St))}return Rt}function Q(){for(var st=arguments.length,St=new Array(st),Rt=0;Rt<st;Rt++)St[Rt]=arguments[Rt];return St.length===0?function(Zt){return Zt}:St.length===1?St[0]:St.reduce(function(Zt,Ft){return function(){return Zt(Ft.apply(void 0,arguments))}})}function yt(){for(var st=arguments.length,St=new Array(st),Rt=0;Rt<st;Rt++)St[Rt]=arguments[Rt];return function(Zt){return function(){var Ft=Zt.apply(void 0,arguments),$t=function(){throw new Error(f.env.NODE_ENV==="production"?w(15):"Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},ee={getState:Ft.getState,dispatch:function(){return $t.apply(void 0,arguments)}},se=St.map(function(Ot){return Ot(ee)});return $t=Q.apply(void 0,se)(Ft.dispatch),x.default(x.default({},Ft),{},{dispatch:$t})}}}function Pt(){}f.env.NODE_ENV!=="production"&&typeof Pt.name=="string"&&Pt.name!=="isCrushed"&&K('You are currently using minified code outside of NODE_ENV === "production". This means that you are running a slower development build of Redux. You can use loose-envify (https://github.com/zertosh/loose-envify) for browserify or setting mode to production in webpack (https://webpack.js.org/concepts/mode/) to ensure you have the correct code for your production build.'),h.__DO_NOT_USE__ActionTypes=I,h.applyMiddleware=yt,h.bindActionCreators=W,h.combineReducers=et,h.compose=Q,h.createStore=B,h.legacy_createStore=H}).call(this)}).call(this,s("_process"))},{"@babel/runtime/helpers/objectSpread2":2,_process:16}],19:[function(s,a,h){var f=s("./src/suggestions");a.exports=f,typeof window<"u"&&(window.Suggestions=f)},{"./src/suggestions":21}],20:[function(s,a,h){var f=function(m){return this.component=m,this.items=[],this.active=0,this.wrapper=document.createElement("div"),this.wrapper.className="suggestions-wrapper",this.element=document.createElement("ul"),this.element.className="suggestions",this.wrapper.appendChild(this.element),this.selectingListItem=!1,m.el.parentNode.insertBefore(this.wrapper,m.el.nextSibling),this};f.prototype.show=function(){this.element.style.display="block"},f.prototype.hide=function(){this.element.style.display="none"},f.prototype.add=function(m){this.items.push(m)},f.prototype.clear=function(){this.items=[],this.active=0},f.prototype.isEmpty=function(){return!this.items.length},f.prototype.isVisible=function(){return this.element.style.display==="block"},f.prototype.draw=function(){if(this.element.innerHTML="",this.items.length===0){this.hide();return}for(var m=0;m<this.items.length;m++)this.drawItem(this.items[m],this.active===m);this.show()},f.prototype.drawItem=function(m,y){var x=document.createElement("li"),w=document.createElement("a");y&&(x.className+=" active"),w.innerHTML=m.string,x.appendChild(w),this.element.appendChild(x),x.addEventListener("mousedown",(function(){this.selectingListItem=!0}).bind(this)),x.addEventListener("mouseup",(function(){this.handleMouseUp.call(this,m)}).bind(this))},f.prototype.handleMouseUp=function(m){this.selectingListItem=!1,this.component.value(m.original),this.clear(),this.draw()},f.prototype.move=function(m){this.active=m,this.draw()},f.prototype.previous=function(){this.move(this.active===0?this.items.length-1:this.active-1)},f.prototype.next=function(){this.move(this.active===this.items.length-1?0:this.active+1)},f.prototype.drawError=function(m){var y=document.createElement("li");y.innerHTML=m,this.element.appendChild(y),this.show()},a.exports=f},{}],21:[function(s,a,h){var f=s("xtend"),m=s("fuzzy"),y=s("./list"),x=function(w,T,M){return M=M||{},this.options=f({minLength:2,limit:5,filter:!0,hideOnBlur:!0},M),this.el=w,this.data=T||[],this.list=new y(this),this.query="",this.selected=null,this.list.draw(),this.el.addEventListener("keyup",(function(I){this.handleKeyUp(I.keyCode)}).bind(this),!1),this.el.addEventListener("keydown",(function(I){this.handleKeyDown(I)}).bind(this)),this.el.addEventListener("focus",(function(){this.handleFocus()}).bind(this)),this.el.addEventListener("blur",(function(){this.handleBlur()}).bind(this)),this.el.addEventListener("paste",(function(I){this.handlePaste(I)}).bind(this)),this.render=this.options.render?this.options.render.bind(this):this.render.bind(this),this.getItemValue=this.options.getItemValue?this.options.getItemValue.bind(this):this.getItemValue.bind(this),this};x.prototype.handleKeyUp=function(w){w===40||w===38||w===27||w===13||w===9||this.handleInputChange(this.el.value)},x.prototype.handleKeyDown=function(w){switch(w.keyCode){case 13:case 9:this.list.isEmpty()||(this.list.isVisible()&&w.preventDefault(),this.value(this.list.items[this.list.active].original),this.list.hide());break;case 27:this.list.isEmpty()||this.list.hide();break;case 38:this.list.previous();break;case 40:this.list.next();break}},x.prototype.handleBlur=function(){!this.list.selectingListItem&&this.options.hideOnBlur&&this.list.hide()},x.prototype.handlePaste=function(w){if(w.clipboardData)this.handleInputChange(w.clipboardData.getData("Text"));else{var T=this;setTimeout(function(){T.handleInputChange(w.target.value)},100)}},x.prototype.handleInputChange=function(w){if(this.query=this.normalize(w),this.list.clear(),this.query.length<this.options.minLength){this.list.draw();return}this.getCandidates((function(T){for(var M=0;M<T.length&&(this.list.add(T[M]),M!==this.options.limit-1);M++);this.list.draw()}).bind(this))},x.prototype.handleFocus=function(){this.list.isEmpty()||this.list.show(),this.list.selectingListItem=!1},x.prototype.update=function(w){this.data=w,this.handleKeyUp()},x.prototype.clear=function(){this.data=[],this.list.clear()},x.prototype.normalize=function(w){return w=w.toLowerCase(),w},x.prototype.match=function(w,T){return w.indexOf(T)>-1},x.prototype.value=function(w){if(this.selected=w,this.el.value=this.getItemValue(w),document.createEvent){var T=document.createEvent("HTMLEvents");T.initEvent("change",!0,!1),this.el.dispatchEvent(T)}else this.el.fireEvent("onchange")},x.prototype.getCandidates=function(w){var T={pre:"<strong>",post:"</strong>",extract:(function(I){return this.getItemValue(I)}).bind(this)},M;this.options.filter?(M=m.filter(this.query,this.data,T),M=M.map((function(I){return{original:I.original,string:this.render(I.original,I.string)}}).bind(this))):M=this.data.map((function(I){var R=this.render(I);return{original:I,string:R}}).bind(this)),w(M)},x.prototype.getItemValue=function(w){return w},x.prototype.render=function(w,T){if(T)return T;for(var M=w.original?this.getItemValue(w.original):this.getItemValue(w),I=this.normalize(M),R=I.lastIndexOf(this.query);R>-1;){var O=R+this.query.length;M=M.slice(0,R)+"<strong>"+M.slice(R,O)+"</strong>"+M.slice(O),R=I.slice(0,R).lastIndexOf(this.query)}return M},x.prototype.renderError=function(w){this.list.drawError(w)},a.exports=x},{"./list":20,fuzzy:8,xtend:24}],22:[function(s,a,h){var f=s("turf-meta").coordEach;a.exports=function(m){var y=[1/0,1/0,-1/0,-1/0];return f(m,function(x){y[0]>x[0]&&(y[0]=x[0]),y[1]>x[1]&&(y[1]=x[1]),y[2]<x[0]&&(y[2]=x[0]),y[3]<x[1]&&(y[3]=x[1])}),y}},{"turf-meta":23}],23:[function(s,a,h){function f(w,T,M){var I,R,O,N,G,$,z,B,H=0,K,at=w.type==="FeatureCollection",ft=w.type==="Feature",et=at?w.features.length:1;for(I=0;I<et;I++)for(B=at?w.features[I].geometry:ft?w.geometry:w,K=B.type==="GeometryCollection",$=K?B.geometries.length:1,N=0;N<$;N++)if(G=K?B.geometries[N]:B,z=G.coordinates,H=M&&(G.type==="Polygon"||G.type==="MultiPolygon")?1:0,G.type==="Point")T(z);else if(G.type==="LineString"||G.type==="MultiPoint")for(R=0;R<z.length;R++)T(z[R]);else if(G.type==="Polygon"||G.type==="MultiLineString")for(R=0;R<z.length;R++)for(O=0;O<z[R].length-H;O++)T(z[R][O]);else if(G.type==="MultiPolygon")for(R=0;R<z.length;R++)for(O=0;O<z[R].length;O++)for(l=0;l<z[R][O].length-H;l++)T(z[R][O][l]);else throw new Error("Unknown Geometry Type")}a.exports.coordEach=f;function m(w,T,M,I){return f(w,function(R){M=T(M,R)},I),M}a.exports.coordReduce=m;function y(w,T){var M;switch(w.type){case"FeatureCollection":for(features=w.features,M=0;M<w.features.length;M++)T(w.features[M].properties);break;case"Feature":T(w.properties);break}}a.exports.propEach=y;function x(w,T,M){return y(w,function(I){M=T(M,I)}),M}a.exports.propReduce=x},{}],24:[function(s,a,h){a.exports=m;var f=Object.prototype.hasOwnProperty;function m(){for(var y={},x=0;x<arguments.length;x++){var w=arguments[x];for(var T in w)f.call(w,T)&&(y[T]=w[T])}return y}},{}],25:[function(s,a,h){function f(kt){"@babel/helpers - typeof";return f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Wt){return typeof Wt}:function(Wt){return Wt&&typeof Symbol=="function"&&Wt.constructor===Symbol&&Wt!==Symbol.prototype?"symbol":typeof Wt},f(kt)}Object.defineProperty(h,"__esModule",{value:!0}),h.addWaypoint=ee,h.clearDestination=W,h.clearOrigin=nt,h.createDestination=St,h.createOrigin=st,h.eventEmit=me,h.eventSubscribe=Me,h.hoverMarker=yt,h.queryDestination=at,h.queryDestinationCoordinates=et,h.queryOrigin=K,h.queryOriginCoordinates=ft,h.removeWaypoint=Ot,h.reverse=Zt,h.setDestinationFromCoordinates=$t,h.setOptions=Q,h.setOriginFromCoordinates=Ft,h.setProfile=Rt,h.setRouteIndex=Pt,h.setWaypoint=se;var m=T(s("../constants/action_types")),y=x(s("../utils"));function x(kt){return kt&&kt.__esModule?kt:{default:kt}}function w(kt){if(typeof WeakMap!="function")return null;var Wt=new WeakMap,Ct=new WeakMap;return(w=function(he){return he?Ct:Wt})(kt)}function T(kt,Wt){if(!Wt&&kt&&kt.__esModule)return kt;if(kt===null||f(kt)!=="object"&&typeof kt!="function")return{default:kt};var Ct=w(Wt);if(Ct&&Ct.has(kt))return Ct.get(kt);var Ae={},he=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Fe in kt)if(Fe!=="default"&&Object.prototype.hasOwnProperty.call(kt,Fe)){var Oe=he?Object.getOwnPropertyDescriptor(kt,Fe):null;Oe&&(Oe.get||Oe.set)?Object.defineProperty(Ae,Fe,Oe):Ae[Fe]=kt[Fe]}return Ae.default=kt,Ct&&Ct.set(kt,Ae),Ae}function M(kt){return function(Wt){var Ct=y.default.createPoint(kt,{id:"origin","marker-symbol":"A"});Wt({type:m.ORIGIN,origin:Ct}),Wt(me("origin",{feature:Ct}))}}function I(kt){return function(Wt){var Ct=y.default.createPoint(kt,{id:"destination","marker-symbol":"B"});Wt({type:m.DESTINATION,destination:Ct}),Wt(me("destination",{feature:Ct}))}}function R(kt){return function(Wt){Wt({type:m.DIRECTIONS_REQUEST_START,request:kt})}}function O(kt){return function(Wt){Wt({type:m.DIRECTIONS,directions:kt}),Wt(me("route",{route:kt}))}}function N(kt){return{type:m.WAYPOINTS,waypoints:kt}}function G(kt){return{type:m.HOVER_MARKER,hoverMarker:kt}}function $(){return function(kt,Wt){var Ct=Wt(),Ae=Ct.api,he=Ct.accessToken,Fe=Ct.routeIndex,Oe=Ct.profile,Qe=Ct.alternatives,Le=Ct.congestion,Ne=Ct.destination,Yn=Ct.language,_n=Ct.exclude,Qt=Ct.fetchDirectionsRequest;if(Ne&&Ne.geometry){Qt&&Qt.abort();var ot=z(Wt),lt=[];lt.push("geometries=polyline"),Qe&&lt.push("alternatives=true"),Le&&lt.push("annotations=congestion"),lt.push("steps=true"),lt.push("overview=full"),Yn&&lt.push("language="+Yn),_n&&lt.push("exclude="+_n),he&&lt.push("access_token="+he);var _t=new XMLHttpRequest;_t.open("GET","".concat(Ae).concat(Oe,"/").concat(ot,".json?").concat(lt.join("&")),!0),kt(R(_t)),_t.onload=function(){if(_t.status>=200&&_t.status<400){var Ut=JSON.parse(_t.responseText);if(Ut.error)return kt(O([])),kt(H(Ut.error));if(Ut.message==="No route found")return kt(H("No route found"));kt(H(null)),Ut.routes[Fe]||kt(Pt(0)),kt(O(Ut.routes)),kt(M(Ut.waypoints[0].location)),kt(I(Ut.waypoints[Ut.waypoints.length-1].location))}else return kt(O([])),kt(H(JSON.parse(_t.responseText).message))},_t.onerror=function(){return kt(O([])),_t.responseText?kt(H(JSON.parse(_t.responseText).message)):kt(H("Error"))},_t.send()}}}function z(kt){var Wt=kt(),Ct=Wt.origin,Ae=Wt.destination,he=Wt.waypoints,Fe=[];return Fe.push(Ct.geometry.coordinates.join(",")),Fe.push(";"),he.length&&he.forEach(function(Oe){Fe.push(Oe.geometry.coordinates.join(",")),Fe.push(";")}),Fe.push(Ae.geometry.coordinates.join(",")),encodeURIComponent(Fe.join(""))}function B(kt){var Wt={id:"waypoint"};return Object.assign(kt,{properties:kt.properties?Object.assign(kt.properties,Wt):Wt})}function H(kt){return function(Wt){Wt({type:"ERROR",error:kt}),kt&&Wt(me("error",{error:kt}))}}function K(kt){return{type:m.ORIGIN_QUERY,query:kt}}function at(kt){return{type:m.DESTINATION_QUERY,query:kt}}function ft(kt){return{type:m.ORIGIN_FROM_COORDINATES,coordinates:kt}}function et(kt){return{type:m.DESTINATION_FROM_COORDINATES,coordinates:kt}}function nt(){return function(kt){kt({type:m.ORIGIN_CLEAR}),kt(me("clear",{type:"origin"})),kt(H(null))}}function W(){return function(kt,Wt){var Ct=Wt(),Ae=Ct.fetchDirectionsRequest;Ae&&Ae.abort(),kt({type:m.DESTINATION_CLEAR}),kt(me("clear",{type:"destination"})),kt(H(null))}}function Q(kt){return{type:m.SET_OPTIONS,options:kt}}function yt(kt){return function(Wt){var Ct=kt?y.default.createPoint(kt,{id:"hover"}):{};Wt(G(Ct))}}function Pt(kt){return{type:m.ROUTE_INDEX,routeIndex:kt}}function st(kt){return function(Wt,Ct){var Ae=Ct(),he=Ae.destination;Wt(M(kt)),he.geometry&&Wt($())}}function St(kt){return function(Wt,Ct){var Ae=Ct(),he=Ae.origin;Wt(I(kt)),he.geometry&&Wt($())}}function Rt(kt){return function(Wt,Ct){var Ae=Ct(),he=Ae.origin,Fe=Ae.destination;Wt({type:m.DIRECTIONS_PROFILE,profile:kt}),Wt(me("profile",{profile:kt})),he.geometry&&Fe.geometry&&Wt($())}}function Zt(){return function(kt,Wt){var Ct=Wt();Ct.destination.geometry&&kt(M(Ct.destination.geometry.coordinates)),Ct.origin.geometry&&kt(I(Ct.origin.geometry.coordinates)),Ct.origin.geometry&&Ct.destination.geometry&&kt($());for(var Ae=document.getElementsByClassName("suggestions"),he=0;he<Ae.length;he++)Ae[he].style.visibility="hidden"}}function Ft(kt){return function(Wt){if(y.default.validCoords(kt)||(kt=[y.default.wrap(kt[0]),y.default.wrap(kt[1])]),isNaN(kt[0])&&isNaN(kt[1]))return Wt(H(new Error("Coordinates are not valid")));Wt(ft(kt)),Wt(st(kt))}}function $t(kt){return function(Wt){if(y.default.validCoords(kt)||(kt=[y.default.wrap(kt[0]),y.default.wrap(kt[1])]),isNaN(kt[0])&&isNaN(kt[1]))return Wt(H(new Error("Coordinates are not valid")));Wt(St(kt)),Wt(et(kt))}}function ee(kt,Wt){return function(Ct,Ae){var he=Ae(),Fe=he.destination,Oe=he.waypoints;Oe.splice(kt,0,B(Wt)),Ct(N(Oe)),Fe.geometry&&Ct($())}}function se(kt,Wt){return function(Ct,Ae){var he=Ae(),Fe=he.destination,Oe=he.waypoints;Oe[kt]=B(Wt),Ct(N(Oe)),Fe.geometry&&Ct($())}}function Ot(kt){return function(Wt,Ct){var Ae=Ct(),he=Ae.destination,Fe=Ae.waypoints;Fe=Fe.filter(function(Oe){return!y.default.coordinateMatch(Oe,kt)}),Wt(N(Fe)),he.geometry&&Wt($())}}function Me(kt,Wt){return function(Ct,Ae){var he=Ae(),Fe=he.events;return Fe[kt]=Fe[kt]||[],Fe[kt].push(Wt),{type:m.EVENTS,events:Fe}}}function me(kt,Wt){var Ct=this;return function(Ae,he){var Fe=he(),Oe=Fe.events;if(!Oe[kt])return{type:m.EVENTS,events:Oe};for(var Qe=Oe[kt].slice(),Le=0;Le<Qe.length;Le++)Qe[Le].call(Ct,Wt)}}},{"../constants/action_types":26,"../utils":34}],26:[function(s,a,h){Object.defineProperty(h,"__esModule",{value:!0}),h.WAYPOINTS=h.SET_OPTIONS=h.ROUTE_INDEX=h.ORIGIN_QUERY=h.ORIGIN_FROM_COORDINATES=h.ORIGIN_CLEAR=h.ORIGIN=h.HOVER_MARKER=h.EVENTS=h.ERROR=h.DIRECTIONS_REQUEST_START=h.DIRECTIONS_PROFILE=h.DIRECTIONS=h.DESTINATION_QUERY=h.DESTINATION_FROM_COORDINATES=h.DESTINATION_CLEAR=h.DESTINATION=void 0;var f="DESTINATION";h.DESTINATION=f;var m="DESTINATION_CLEAR";h.DESTINATION_CLEAR=m;var y="DESTINATION_QUERY";h.DESTINATION_QUERY=y;var x="DESTINATION_FROM_COORDINATES";h.DESTINATION_FROM_COORDINATES=x;var w="DIRECTIONS";h.DIRECTIONS=w;var T="DIRECTIONS_REQUEST_START";h.DIRECTIONS_REQUEST_START=T;var M="DIRECTIONS_PROFILE";h.DIRECTIONS_PROFILE=M;var I="EVENTS";h.EVENTS=I;var R="ERROR";h.ERROR=R;var O="HOVER_MARKER";h.HOVER_MARKER=O;var N="ORIGIN";h.ORIGIN=N;var G="ORIGIN_CLEAR";h.ORIGIN_CLEAR=G;var $="ORIGIN_QUERY";h.ORIGIN_QUERY=$;var z="ORIGIN_FROM_COORDINATES";h.ORIGIN_FROM_COORDINATES=z;var B="ROUTE_INDEX";h.ROUTE_INDEX=B;var H="SET_OPTIONS";h.SET_OPTIONS=H;var K="WAYPOINTS";h.WAYPOINTS=K},{}],27:[function(s,a,h){Object.defineProperty(h,"__esModule",{value:!0}),h.default=void 0;var f=w(s("suggestions")),m=w(s("lodash.debounce")),y=s("events"),x=w(s("../utils"));function w($){return $&&$.__esModule?$:{default:$}}function T($){"@babel/helpers - typeof";return T=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(z){return typeof z}:function(z){return z&&typeof Symbol=="function"&&z.constructor===Symbol&&z!==Symbol.prototype?"symbol":typeof z},T($)}function M($,z){if(!($ instanceof z))throw new TypeError("Cannot call a class as a function")}function I($,z){for(var B=0;B<z.length;B++){var H=z[B];H.enumerable=H.enumerable||!1,H.configurable=!0,"value"in H&&(H.writable=!0),Object.defineProperty($,O(H.key),H)}}function R($,z,B){return z&&I($.prototype,z),B&&I($,B),Object.defineProperty($,"prototype",{writable:!1}),$}function O($){var z=N($,"string");return T(z)==="symbol"?z:String(z)}function N($,z){if(T($)!=="object"||$===null)return $;var B=$[Symbol.toPrimitive];if(B!==void 0){var H=B.call($,z||"default");if(T(H)!=="object")return H;throw new TypeError("@@toPrimitive must return a primitive value.")}return(z==="string"?String:Number)($)}var G=function(){function $(z){M(this,$),this._ev=new y.EventEmitter,this.options=z,this.api=z&&z.api||"https://api.mapbox.com/geocoding/v5/mapbox.places/"}return R($,[{key:"onAdd",value:function(B){this._map=B,this.request=new XMLHttpRequest;var H=document.createElement("div");H.className="mapboxgl-ctrl-geocoder";var K=document.createElement("span");K.className="geocoder-icon geocoder-icon-search";var at=this._inputEl=document.createElement("input");at.type="text",at.placeholder=this.options.placeholder,at.addEventListener("keydown",(0,m.default)((function(W){if(!W.target.value)return this._clearEl.classList.remove("active");W.metaKey||[9,27,37,39,13,38,40].indexOf(W.keyCode)!==-1||this._queryFromInput(W.target.value)}).bind(this)),200),at.addEventListener("change",(function(W){W.target.value&&this._clearEl.classList.add("active");var Q=this._typeahead.selected;if(Q){if(this.options.flyTo)if(Q.bbox&&Q.context&&Q.context.length<=3||Q.bbox&&!Q.context){var yt=Q.bbox;B.fitBounds([[yt[0],yt[1]],[yt[2],yt[3]]])}else B.flyTo({center:Q.center,zoom:this.options.zoom});this._input=Q,this.fire("result",{result:Q})}}).bind(this));var ft=document.createElement("div");ft.classList.add("geocoder-pin-right");var et=this._clearEl=document.createElement("button");et.className="geocoder-icon geocoder-icon-close",et.addEventListener("click",this._clear.bind(this));var nt=this._loadingEl=document.createElement("span");return nt.className="geocoder-icon geocoder-icon-loading",ft.appendChild(et),ft.appendChild(nt),H.appendChild(K),H.appendChild(at),H.appendChild(ft),this.options.container&&(this.options.position=!1),this._typeahead=new f.default(at,[],{filter:!1}),this._typeahead.getItemValue=function(W){return W.place_name},H}},{key:"_geocode",value:function(B,H){this._loadingEl.classList.add("active"),this.fire("loading");var K=this.options,at=["placeholder","zoom","flyTo","accessToken","api"],ft=Object.keys(this.options).filter(function(nt){return at.indexOf(nt)===-1}).map(function(nt){return nt+"="+K[nt]}),et=this.options.accessToken?this.options.accessToken:mapboxgl.accessToken;ft.push("access_token="+et),this.request.abort(),this.request.open("GET",this.api+encodeURIComponent(B.trim())+".json?"+ft.join("&"),!0),this.request.onload=(function(){if(this._loadingEl.classList.remove("active"),this.request.status>=200&&this.request.status<400){var nt=JSON.parse(this.request.responseText);return nt.features.length?this._clearEl.classList.add("active"):(this._clearEl.classList.remove("active"),this._typeahead.selected=null),this.fire("results",{results:nt.features}),this._typeahead.update(nt.features),H(nt.features)}else this.fire("error",{error:JSON.parse(this.request.responseText).message})}).bind(this),this.request.onerror=(function(){this._loadingEl.classList.remove("active"),this.fire("error",{error:JSON.parse(this.request.responseText).message})}).bind(this),this.request.send()}},{key:"_queryFromInput",value:function(B){B=B.trim(),B||this._clear(),B.length>2&&this._geocode(B,(function(H){this._results=H}).bind(this))}},{key:"_change",value:function(){var B=document.createEvent("HTMLEvents");B.initEvent("change",!0,!1),this._inputEl.dispatchEvent(B)}},{key:"_query",value:function(B){B&&(T(B)==="object"&&B.length&&(B=[x.default.wrap(B[0]),x.default.wrap(B[1])].join()),this._geocode(B,(function(H){if(H.length){var K=H[0];this._results=H,this._typeahead.selected=K,this._inputEl.value=K.place_name,this._change()}}).bind(this)))}},{key:"_setInput",value:function(B){B&&(T(B)==="object"&&B.length&&(B=[x.default.roundWithOriginalPrecision(x.default.wrap(B[0]),B[0]),x.default.roundWithOriginalPrecision(x.default.wrap(B[1]),B[1])].join()),this._inputEl.value=B,this._input=null,this._typeahead.selected=null,this._typeahead.clear(),this._change())}},{key:"_clear",value:function(){this._input=null,this._inputEl.value="",this._typeahead.selected=null,this._typeahead.clear(),this._change(),this._inputEl.focus(),this._clearEl.classList.remove("active"),this.fire("clear")}},{key:"getResult",value:function(){return this._input}},{key:"query",value:function(B){return this._query(B),this}},{key:"setInput",value:function(B){return this._setInput(B),this}},{key:"on",value:function(B,H){return this._ev.on(B,H),this._ev.on("error",function(K){console.log(K)}),this}},{key:"fire",value:function(B,H){return this._ev.emit(B,H),this}},{key:"off",value:function(B,H){return this._ev.removeListener(B,H),this}}]),$}();h.default=G},{"../utils":34,events:7,"lodash.debounce":10,suggestions:19}],28:[function(s,a,h){Object.defineProperty(h,"__esModule",{value:!0}),h.default=void 0;var f=w(s("./geocoder")),m=w(s("lodash.template")),y=w(s("lodash.isequal")),x=w(s("turf-extent"));function w(z){return z&&z.__esModule?z:{default:z}}function T(z){"@babel/helpers - typeof";return T=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(B){return typeof B}:function(B){return B&&typeof Symbol=="function"&&B.constructor===Symbol&&B!==Symbol.prototype?"symbol":typeof B},T(z)}function M(z,B){if(!(z instanceof B))throw new TypeError("Cannot call a class as a function")}function I(z,B){for(var H=0;H<B.length;H++){var K=B[H];K.enumerable=K.enumerable||!1,K.configurable=!0,"value"in K&&(K.writable=!0),Object.defineProperty(z,O(K.key),K)}}function R(z,B,H){return B&&I(z.prototype,B),H&&I(z,H),Object.defineProperty(z,"prototype",{writable:!1}),z}function O(z){var B=N(z,"string");return T(B)==="symbol"?B:String(B)}function N(z,B){if(T(z)!=="object"||z===null)return z;var H=z[Symbol.toPrimitive];if(H!==void 0){var K=H.call(z,B||"default");if(T(K)!=="object")return K;throw new TypeError("@@toPrimitive must return a primitive value.")}return(B==="string"?String:Number)(z)}var G=(0,m.default)(`<div class='mapbox-directions-component mapbox-directions-inputs'>
  <div class='mapbox-directions-component-keyline'>
    <div class='mapbox-directions-origin'>
      <label class='mapbox-form-label'>
        <span class='directions-icon directions-icon-depart'></span>
      </label>
      <div id='mapbox-directions-origin-input'></div>
    </div>

    <button
      class='directions-icon directions-icon-reverse directions-reverse js-reverse-inputs'
      title='Reverse origin &amp; destination'>
    </button>

    <div class='mapbox-directions-destination'>
      <label class='mapbox-form-label'>
        <span class='directions-icon directions-icon-arrive'></span>
      </label>
      <div id='mapbox-directions-destination-input'></div>
    </div>
  </div>

  <% if (controls.profileSwitcher) { %>
  <div class='mapbox-directions-profile mapbox-directions-component-keyline mapbox-directions-clearfix'><input
      id='mapbox-directions-profile-driving-traffic'
      type='radio'
      name='profile'
      value='mapbox/driving-traffic'
      <% if (profile === 'mapbox/driving-traffic') { %>checked<% } %>
    />
    <label for='mapbox-directions-profile-driving-traffic'>Traffic</label>
    <input
      id='mapbox-directions-profile-driving'
      type='radio'
      name='profile'
      value='mapbox/driving'
      <% if (profile === 'mapbox/driving') { %>checked<% } %>
    />
    <label for='mapbox-directions-profile-driving'>Driving</label>
    <input
      id='mapbox-directions-profile-walking'
      type='radio'
      name='profile'
      value='mapbox/walking'
      <% if (profile === 'mapbox/walking') { %>checked<% } %>
    />
    <label for='mapbox-directions-profile-walking'>Walking</label>
    <input
      id='mapbox-directions-profile-cycling'
      type='radio'
      name='profile'
      value='mapbox/cycling'
      <% if (profile === 'mapbox/cycling') { %>checked<% } %>
    />
    <label for='mapbox-directions-profile-cycling'>Cycling</label>
  </div>
  <% } %>
</div>
`),$=function(){function z(B,H,K,at){M(this,z);var ft=H.getState(),et=ft.originQuery,nt=ft.destinationQuery,W=ft.profile,Q=ft.controls;B.innerHTML=G({originQuery:et,destinationQuery:nt,profile:W,controls:Q}),this.container=B,this.actions=K,this.store=H,this._map=at,this.onAdd(),this.render()}return R(z,[{key:"animateToCoordinates",value:function(H,K){var at=this.store.getState(),ft=at.origin,et=at.destination,nt=at.routePadding;if(ft.geometry&&et.geometry&&!(0,y.default)(ft.geometry,et.geometry)){var W=(0,x.default)({type:"FeatureCollection",features:[ft,et]});this._map.fitBounds([[W[0],W[1]],[W[2],W[3]]],{padding:nt})}else this._map.flyTo({center:K})}},{key:"onAdd",value:function(){var H=this,K=this.actions,at=K.clearOrigin,ft=K.clearDestination,et=K.createOrigin,nt=K.createDestination,W=K.setProfile,Q=K.reverse,yt=this.store.getState(),Pt=yt.geocoder,st=yt.accessToken,St=yt.flyTo,Rt=yt.placeholderOrigin,Zt=yt.placeholderDestination,Ft=yt.zoom;this.originInput=new f.default(Object.assign({},{accessToken:st},Pt,{flyTo:St,placeholder:Rt,zoom:Ft}));var $t=this.originInput.onAdd(this._map),ee=this.container.querySelector("#mapbox-directions-origin-input");ee.appendChild($t),this.destinationInput=new f.default(Object.assign({},{accessToken:st},Pt,{flyTo:St,placeholder:Zt,zoom:Ft}));var se=this.destinationInput.onAdd(this._map);this.container.querySelector("#mapbox-directions-destination-input").appendChild(se),this.originInput.on("result",function(Me){var me=Me.result.center;et(me),H.animateToCoordinates("origin",me)}),this.originInput.on("clear",at),this.destinationInput.on("result",function(Me){var me=Me.result.center;nt(me),H.animateToCoordinates("destination",me)}),this.destinationInput.on("clear",ft);var Ot=this.container.querySelectorAll('input[type="radio"]');Array.prototype.forEach.call(Ot,function(Me){Me.addEventListener("change",function(){W(Me.value)})}),this.container.querySelector(".js-reverse-inputs").addEventListener("click",function(){var Me=H.store.getState(),me=Me.origin,kt=Me.destination;me&&H.actions.queryDestination(me.geometry.coordinates),kt&&H.actions.queryOrigin(kt.geometry.coordinates),Q()})}},{key:"render",value:function(){var H=this;this.store.subscribe(function(){var K=H.store.getState(),at=K.originQuery,ft=K.destinationQuery,et=K.originQueryCoordinates,nt=K.destinationQueryCoordinates;at&&(H.originInput.query(at),H.actions.queryOrigin(null)),ft&&(H.destinationInput.query(ft),H.actions.queryDestination(null)),et&&(H.originInput.setInput(et),H.animateToCoordinates("origin",et),H.actions.queryOriginCoordinates(null)),nt&&(H.destinationInput.setInput(nt),H.animateToCoordinates("destination",nt),H.actions.queryDestinationCoordinates(null))})}}]),z}();h.default=$},{"./geocoder":27,"lodash.isequal":11,"lodash.template":12,"turf-extent":22}],29:[function(s,a,h){Object.defineProperty(h,"__esModule",{value:!0}),h.default=void 0;var f=x(s("../utils")),m=x(s("lodash.template")),y=x(s("lodash.isequal"));function x(z){return z&&z.__esModule?z:{default:z}}function w(z){"@babel/helpers - typeof";return w=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(B){return typeof B}:function(B){return B&&typeof Symbol=="function"&&B.constructor===Symbol&&B!==Symbol.prototype?"symbol":typeof B},w(z)}function T(z,B){if(!(z instanceof B))throw new TypeError("Cannot call a class as a function")}function M(z,B){for(var H=0;H<B.length;H++){var K=B[H];K.enumerable=K.enumerable||!1,K.configurable=!0,"value"in K&&(K.writable=!0),Object.defineProperty(z,R(K.key),K)}}function I(z,B,H){return B&&M(z.prototype,B),H&&M(z,H),Object.defineProperty(z,"prototype",{writable:!1}),z}function R(z){var B=O(z,"string");return w(B)==="symbol"?B:String(B)}function O(z,B){if(w(z)!=="object"||z===null)return z;var H=z[Symbol.toPrimitive];if(H!==void 0){var K=H.call(z,B||"default");if(w(K)!=="object")return K;throw new TypeError("@@toPrimitive must return a primitive value.")}return(B==="string"?String:Number)(z)}var N=(0,m.default)(`<div class='directions-control directions-control-directions'>
  <div class='mapbox-directions-component mapbox-directions-route-summary<% if (routes > 1) { %> mapbox-directions-multiple<% } %>'>
    <% if (routes > 1) { %>
    <div class='mapbox-directions-routes mapbox-directions-clearfix'>
      <% for (var i = 0; i < routes; i++) { %>
        <input type='radio' name='routes' id='<%= i %>' <% if (i === routeIndex) { %>checked<% } %>>
        <label for='<%= i %>' class='mapbox-directions-route'><%= i + 1 %></label>
      <% } %>
    </div>
    <% } %>
    <h1><%- duration %></h1>
    <span><%- distance %></span>
  </div>

  <div class='mapbox-directions-instructions'>
    <div class='mapbox-directions-instructions-wrapper'>
      <ol class='mapbox-directions-steps'>
        <% steps.forEach(function(step) { %>
          <%
            var distance = step.distance ? format(step.distance) : false;
            var icon = step.maneuver.modifier ? step.maneuver.modifier.replace(/\\s+/g, '-').toLowerCase() : step.maneuver.type.replace(/\\s+/g, '-').toLowerCase();

            if (['arrive', 'depart', 'waypoint'].includes(step.maneuver.type)) {
              icon = step.maneuver.type;
            }

            if (step.maneuver.type === 'roundabout' || step.maneuver.type === 'rotary') {
              icon = 'roundabout';
            }

            var lng = step.maneuver.location[0];
            var lat = step.maneuver.location[1];
          %>
          <li
            data-lat='<%= lat %>'
            data-lng='<%= lng %>'
            class='mapbox-directions-step'>
            <span class='directions-icon directions-icon-<%= icon %>'></span>
            <div class='mapbox-directions-step-maneuver'>
              <%= step.maneuver.instruction %>
            </div>
            <% if (distance) { %>
              <div class='mapbox-directions-step-distance'>
                <%= distance %>
              </div>
            <% } %>
          </li>
        <% }); %>
      </ol>
    </div>
  </div>
</div>
`),G=(0,m.default)(`<div class='directions-control directions-control-directions'>
  <div class='mapbox-directions-error'>
    <%= error %>
  </div>
</div>
`),$=function(){function z(B,H,K,at){T(this,z),this.container=B,this.actions=K,this.store=H,this._map=at,this.directions={},this.render()}return I(z,[{key:"render",value:function(){var H=this;this.store.subscribe(function(){var K=H.actions,at=K.hoverMarker,ft=K.setRouteIndex,et=H.store.getState(),nt=et.routeIndex,W=et.unit,Q=et.directions,yt=et.error,Pt=et.compile,st=!(0,y.default)(Q[nt],H.directions);if(yt){H.container.innerHTML=G({error:yt});return}if(Q.length&&st){var St=H.directions=Q[nt],Rt=f.default.getAllSteps(St);Pt&&St.legs.forEach(function($t){$t.steps.forEach(function(ee){ee.maneuver.instruction=Pt("en",ee)})}),H.container.innerHTML=N({routeIndex:nt,routes:Q.length,steps:Rt,format:f.default.format[W],duration:f.default.format.duration(St.duration),distance:f.default.format[W](St.distance)});var Zt=H.container.querySelectorAll(".mapbox-directions-step");Array.prototype.forEach.call(Zt,function($t){var ee=$t.getAttribute("data-lng"),se=$t.getAttribute("data-lat");$t.addEventListener("mouseover",function(){at([ee,se])}),$t.addEventListener("mouseout",function(){at(null)}),$t.addEventListener("click",function(){H._map.flyTo({center:[ee,se],zoom:16})})});var Ft=H.container.querySelectorAll('input[type="radio"]');Array.prototype.forEach.call(Ft,function($t){$t.addEventListener("change",function(ee){ft(parseInt(ee.target.id,10))})})}else H.container.innerHTML&&st&&(H.container.innerHTML="")})}}]),z}();h.default=$},{"../utils":34,"lodash.isequal":11,"lodash.template":12}],30:[function(s,a,h){Object.defineProperty(h,"__esModule",{value:!0}),h.default=void 0;var f=s("redux"),m=G(s("redux-thunk")),y=s("@mapbox/polyline"),x=G(s("./utils")),w=G(s("./reducers")),T=N(s("./actions")),M=G(s("./directions_style")),I=G(s("./controls/inputs")),R=G(s("./controls/instructions"));function O(et){if(typeof WeakMap!="function")return null;var nt=new WeakMap,W=new WeakMap;return(O=function(yt){return yt?W:nt})(et)}function N(et,nt){if(!nt&&et&&et.__esModule)return et;if(et===null||$(et)!=="object"&&typeof et!="function")return{default:et};var W=O(nt);if(W&&W.has(et))return W.get(et);var Q={},yt=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Pt in et)if(Pt!=="default"&&Object.prototype.hasOwnProperty.call(et,Pt)){var st=yt?Object.getOwnPropertyDescriptor(et,Pt):null;st&&(st.get||st.set)?Object.defineProperty(Q,Pt,st):Q[Pt]=et[Pt]}return Q.default=et,W&&W.set(et,Q),Q}function G(et){return et&&et.__esModule?et:{default:et}}function $(et){"@babel/helpers - typeof";return $=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(nt){return typeof nt}:function(nt){return nt&&typeof Symbol=="function"&&nt.constructor===Symbol&&nt!==Symbol.prototype?"symbol":typeof nt},$(et)}function z(et,nt){if(!(et instanceof nt))throw new TypeError("Cannot call a class as a function")}function B(et,nt){for(var W=0;W<nt.length;W++){var Q=nt[W];Q.enumerable=Q.enumerable||!1,Q.configurable=!0,"value"in Q&&(Q.writable=!0),Object.defineProperty(et,K(Q.key),Q)}}function H(et,nt,W){return nt&&B(et.prototype,nt),W&&B(et,W),Object.defineProperty(et,"prototype",{writable:!1}),et}function K(et){var nt=at(et,"string");return $(nt)==="symbol"?nt:String(nt)}function at(et,nt){if($(et)!=="object"||et===null)return et;var W=et[Symbol.toPrimitive];if(W!==void 0){var Q=W.call(et,nt||"default");if($(Q)!=="object")return Q;throw new TypeError("@@toPrimitive must return a primitive value.")}return(nt==="string"?String:Number)(et)}var ft=function(){function et(nt){z(this,et),this._store=this._initStore(),this.actions=(0,f.bindActionCreators)(T,this._store.dispatch),this.actions.setOptions(nt||{}),this.options=nt||{},this.onDragDown=this._onDragDown.bind(this),this.onDragMove=this._onDragMove.bind(this),this.onDragUp=this._onDragUp.bind(this),this.move=this._move.bind(this),this.onClick=this._clickHandler().bind(this)}return H(et,[{key:"onAdd",value:function(W){var Q=this;this._map=W;var yt=this._store.getState(),Pt=yt.controls,st=this.container=document.createElement("div");st.className="mapboxgl-ctrl-directions mapboxgl-ctrl";var St=document.createElement("div");St.className="directions-control directions-control-inputs",new I.default(St,this._store,this.actions,this._map);var Rt=document.createElement("div");return Rt.className="directions-control directions-control-instructions",new R.default(Rt,this._store,{hoverMarker:this.actions.hoverMarker,setRouteIndex:this.actions.setRouteIndex},this._map),Pt.inputs&&st.appendChild(St),Pt.instructions&&st.appendChild(Rt),this.subscribedActions(),this._map.loaded()?this.mapState():this._map.on("load",function(){return Q.mapState()}),st}},{key:"onRemove",value:function(W){return this.container.parentNode.removeChild(this.container),this.removeRoutes(),W.off("mousedown",this.onDragDown),W.off("mousemove",this.move),W.off("touchstart",this.onDragDown),W.off("touchstart",this.move),W.off("click",this.onClick),this.storeUnsubscribe&&(this.storeUnsubscribe(),delete this.storeUnsubscribe),M.default.forEach(function(Q){W.getLayer(Q.id)&&W.removeLayer(Q.id)}),W.getSource("directions")&&W.removeSource("directions"),this._map=null,this}},{key:"mapState",value:function(){var W=this,Q=this._store.getState(),yt=Q.profile;Q.alternatives,Q.congestion;var Pt=Q.styles,st=Q.interactive;Q.compile,this.actions.eventEmit("profile",{profile:yt});var St={type:"geojson",data:{type:"FeatureCollection",features:[]}};this._map.addSource("directions",St),Pt&&Pt.length&&Pt.forEach(function(Rt){return W._map.addLayer(Rt)}),M.default.forEach(function(Rt){W._map.getLayer(Rt.id)||W._map.addLayer(Rt)}),st&&(this._map.on("mousedown",this.onDragDown),this._map.on("mousemove",this.move),this._map.on("click",this.onClick),this._map.on("touchstart",this.move),this._map.on("touchstart",this.onDragDown))}},{key:"subscribedActions",value:function(){var W=this;this.storeUnsubscribe=this._store.subscribe(function(){var Q=W._store.getState(),yt=Q.origin,Pt=Q.destination,st=Q.hoverMarker,St=Q.directions,Rt=Q.routeIndex,Zt={type:"FeatureCollection",features:[yt,Pt,st].filter(function(Ft){return Ft.geometry})};St.length&&St.forEach(function(Ft,$t){var ee=[],se=(0,y.decode)(Ft.geometry,5).map(function(Me){return Me.reverse()}),Ot=x.default.getAllSteps(Ft);se.forEach(function(Me,me){var kt=ee[ee.length-1],Wt=Ft.legs[0].annotation&&Ft.legs[0].annotation.congestion&&Ft.legs[0].annotation.congestion[me-1];if(kt&&(!Wt||kt.properties.congestion===Wt))kt.geometry.coordinates.push(Me);else{var Ct={geometry:{type:"LineString",coordinates:[]},properties:{"route-index":$t,route:$t===Rt?"selected":"alternate"}};kt&&Ct.geometry.coordinates.push(kt.geometry.coordinates[kt.geometry.coordinates.length-1]),Ct.geometry.coordinates.push(Me),Wt&&(Ct.properties.congestion=Ft.legs[0].annotation.congestion[me-1]),ee.push(Ct)}}),Zt.features=Zt.features.concat(ee),$t===Rt&&Ot.forEach(function(Me){Me.maneuver.type==="waypoint"&&Zt.features.push({type:"Feature",geometry:{type:"Point",coordinates:Me.maneuver.location},properties:{id:"waypoint"}})})}),W._map.style&&W._map.getSource("directions")&&W._map.getSource("directions").setData(Zt)})}},{key:"_initStore",value:function(){var W=(0,f.applyMiddleware)(m.default)(f.createStore);return W(w.default)}},{key:"_clickHandler",value:function(){var W=null,Q=250;return function(yt){if(W)clearTimeout(W),W=null,this._map.zoomIn();else{var Pt=this._onSingleClick.bind(this);W=setTimeout(function(){Pt(yt),W=null},Q)}}}},{key:"_onSingleClick",value:function(W){var Q=this,yt=this._store.getState(),Pt=yt.origin,st=[W.lngLat.lng,W.lngLat.lat];if(!Pt.geometry)this.actions.setOriginFromCoordinates(st);else{var St=this._map.queryRenderedFeatures(W.point,{layers:["directions-origin-point","directions-destination-point","directions-waypoint-point","directions-route-line-alt"]});if(St.length){if(St.forEach(function(Zt){Zt.layer.id==="directions-waypoint-point"&&Q.actions.removeWaypoint(Zt)}),St[0].properties.route==="alternate"){var Rt=St[0].properties["route-index"];this.actions.setRouteIndex(Rt)}}else this.actions.setDestinationFromCoordinates(st),this._map.flyTo({center:st})}}},{key:"_move",value:function(W){var Q=this,yt=this._store.getState(),Pt=yt.hoverMarker,st=this._map.queryRenderedFeatures(W.point,{layers:["directions-route-line-alt","directions-route-line","directions-origin-point","directions-destination-point","directions-hover-point"]});this._map.getCanvas().style.cursor=st.length?"pointer":"",st.length?(this.isCursorOverPoint=st[0],this._map.dragPan.disable(),st.forEach(function(St){St.layer.id==="directions-route-line"?Q.actions.hoverMarker([W.lngLat.lng,W.lngLat.lat]):Pt.geometry&&Q.actions.hoverMarker(null)})):this.isCursorOverPoint&&(this.isCursorOverPoint=!1,this._map.dragPan.enable())}},{key:"_onDragDown",value:function(){this.isCursorOverPoint&&(this.isDragging=this.isCursorOverPoint,this._map.getCanvas().style.cursor="grab",this._map.on("mousemove",this.onDragMove),this._map.on("mouseup",this.onDragUp),this._map.on("touchmove",this.onDragMove),this._map.on("touchend",this.onDragUp))}},{key:"_onDragMove",value:function(W){if(this.isDragging){var Q=[W.lngLat.lng,W.lngLat.lat];switch(this.isDragging.layer.id){case"directions-origin-point":this.actions.createOrigin(Q);break;case"directions-destination-point":this.actions.createDestination(Q);break;case"directions-hover-point":this.actions.hoverMarker(Q);break}}}},{key:"_onDragUp",value:function(){if(this.isDragging){var W=this._store.getState(),Q=W.hoverMarker,yt=W.origin,Pt=W.destination;switch(this.isDragging.layer.id){case"directions-origin-point":this.actions.setOriginFromCoordinates(yt.geometry.coordinates);break;case"directions-destination-point":this.actions.setDestinationFromCoordinates(Pt.geometry.coordinates);break;case"directions-hover-point":Q.geometry&&!x.default.coordinateMatch(this.isDragging,Q)&&this.actions.addWaypoint(0,Q);break}this.isDragging=!1,this._map.getCanvas().style.cursor="",this._map.off("touchmove",this.onDragMove),this._map.off("touchend",this.onDragUp),this._map.off("mousemove",this.onDragMove),this._map.off("mouseup",this.onDragUp)}}},{key:"interactive",value:function(W){return W?(this._map.on("touchstart",this.move),this._map.on("touchstart",this.onDragDown),this._map.on("mousedown",this.onDragDown),this._map.on("mousemove",this.move),this._map.on("click",this.onClick)):(this._map.off("touchstart",this.move),this._map.off("touchstart",this.onDragDown),this._map.off("mousedown",this.onDragDown),this._map.off("mousemove",this.move),this._map.off("click",this.onClick)),this}},{key:"getOrigin",value:function(){return this._store.getState().origin}},{key:"setOrigin",value:function(W){return typeof W=="string"?this.actions.queryOrigin(W):this.actions.setOriginFromCoordinates(W),this}},{key:"getDestination",value:function(){return this._store.getState().destination}},{key:"setDestination",value:function(W){return typeof W=="string"?this.actions.queryDestination(W):this.actions.setDestinationFromCoordinates(W),this}},{key:"reverse",value:function(){return this.actions.reverse(),this}},{key:"addWaypoint",value:function(W,Q){return Q.type||(Q=x.default.createPoint(Q,{id:"waypoint"})),this.actions.addWaypoint(W,Q),this}},{key:"setWaypoint",value:function(W,Q){return Q.type||(Q=x.default.createPoint(Q,{id:"waypoint"})),this.actions.setWaypoint(W,Q),this}},{key:"removeWaypoint",value:function(W){var Q=this._store.getState(),yt=Q.waypoints;return this.actions.removeWaypoint(yt[W]),this}},{key:"getWaypoints",value:function(){return this._store.getState().waypoints}},{key:"removeRoutes",value:function(){return this.actions.clearOrigin(),this.actions.clearDestination(),this}},{key:"on",value:function(W,Q){return this.actions.eventSubscribe(W,Q),this}}]),et}();h.default=ft},{"./actions":25,"./controls/inputs":28,"./controls/instructions":29,"./directions_style":31,"./reducers":33,"./utils":34,"@mapbox/polyline":6,redux:18,"redux-thunk":17}],31:[function(s,a,h){Object.defineProperty(h,"__esModule",{value:!0}),h.default=void 0;var f=[{id:"directions-route-line-alt",type:"line",source:"directions",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#bbb","line-width":4},filter:["all",["in","$type","LineString"],["in","route","alternate"]]},{id:"directions-route-line-casing",type:"line",source:"directions",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#2d5f99","line-width":12},filter:["all",["in","$type","LineString"],["in","route","selected"]]},{id:"directions-route-line",type:"line",source:"directions",layout:{"line-cap":"butt","line-join":"round"},paint:{"line-color":{property:"congestion",type:"categorical",default:"#4882c5",stops:[["unknown","#4882c5"],["low","#4882c5"],["moderate","#f09a46"],["heavy","#e34341"],["severe","#8b2342"]]},"line-width":7},filter:["all",["in","$type","LineString"],["in","route","selected"]]},{id:"directions-hover-point-casing",type:"circle",source:"directions",paint:{"circle-radius":8,"circle-color":"#fff"},filter:["all",["in","$type","Point"],["in","id","hover"]]},{id:"directions-hover-point",type:"circle",source:"directions",paint:{"circle-radius":6,"circle-color":"#3bb2d0"},filter:["all",["in","$type","Point"],["in","id","hover"]]},{id:"directions-waypoint-point-casing",type:"circle",source:"directions",paint:{"circle-radius":8,"circle-color":"#fff"},filter:["all",["in","$type","Point"],["in","id","waypoint"]]},{id:"directions-waypoint-point",type:"circle",source:"directions",paint:{"circle-radius":6,"circle-color":"#8a8bc9"},filter:["all",["in","$type","Point"],["in","id","waypoint"]]},{id:"directions-origin-point",type:"circle",source:"directions",paint:{"circle-radius":18,"circle-color":"#3bb2d0"},filter:["all",["in","$type","Point"],["in","marker-symbol","A"]]},{id:"directions-origin-label",type:"symbol",source:"directions",layout:{"text-field":"A","text-font":["Open Sans Bold","Arial Unicode MS Bold"],"text-size":12},paint:{"text-color":"#fff"},filter:["all",["in","$type","Point"],["in","marker-symbol","A"]]},{id:"directions-destination-point",type:"circle",source:"directions",paint:{"circle-radius":18,"circle-color":"#8a8bc9"},filter:["all",["in","$type","Point"],["in","marker-symbol","B"]]},{id:"directions-destination-label",type:"symbol",source:"directions",layout:{"text-field":"B","text-font":["Open Sans Bold","Arial Unicode MS Bold"],"text-size":12},paint:{"text-color":"#fff"},filter:["all",["in","$type","Point"],["in","marker-symbol","B"]]}],m=f;h.default=m},{}],32:[function(s,a,h){var f=m(s("./directions"));function m(y){return y&&y.__esModule?y:{default:y}}a.exports=f.default},{"./directions":30}],33:[function(s,a,h){function f(O){"@babel/helpers - typeof";return f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(N){return typeof N}:function(N){return N&&typeof Symbol=="function"&&N.constructor===Symbol&&N!==Symbol.prototype?"symbol":typeof N},f(O)}Object.defineProperty(h,"__esModule",{value:!0}),h.default=void 0;var m=T(s("../constants/action_types.js")),y=x(s("merge-options"));function x(O){return O&&O.__esModule?O:{default:O}}function w(O){if(typeof WeakMap!="function")return null;var N=new WeakMap,G=new WeakMap;return(w=function(z){return z?G:N})(O)}function T(O,N){if(!N&&O&&O.__esModule)return O;if(O===null||f(O)!=="object"&&typeof O!="function")return{default:O};var G=w(N);if(G&&G.has(O))return G.get(O);var $={},z=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var B in O)if(B!=="default"&&Object.prototype.hasOwnProperty.call(O,B)){var H=z?Object.getOwnPropertyDescriptor(O,B):null;H&&(H.get||H.set)?Object.defineProperty($,B,H):$[B]=O[B]}return $.default=O,G&&G.set(O,$),$}var M=function(){return{api:"https://api.mapbox.com/directions/v5/",profile:"mapbox/driving-traffic",alternatives:!1,congestion:!1,unit:"imperial",flyTo:!0,placeholderOrigin:"Choose a starting place",placeholderDestination:"Choose destination",zoom:16,language:"en",compile:null,proximity:!1,styles:[],controls:{profileSwitcher:!0,inputs:!0,instructions:!0},geocoder:{},interactive:!0,events:{},origin:{},destination:{},hoverMarker:{},waypoints:[],originQuery:null,destinationQuery:null,originQueryCoordinates:null,destinationQueryCoordinates:null,directions:[],fetchDirectionsRequest:null,routeIndex:0,routePadding:80}};function I(){var O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:M(),N=arguments.length>1?arguments[1]:void 0;switch(N.type){case m.SET_OPTIONS:return(0,y.default)({},O,N.options);case m.DIRECTIONS_PROFILE:return Object.assign({},O,{profile:N.profile});case m.ORIGIN:return Object.assign({},O,{origin:N.origin,hoverMarker:{}});case m.DESTINATION:return Object.assign({},O,{destination:N.destination,hoverMarker:{}});case m.HOVER_MARKER:return Object.assign({},O,{hoverMarker:N.hoverMarker});case m.WAYPOINTS:return Object.assign({},O,{waypoints:N.waypoints});case m.ORIGIN_QUERY:return Object.assign({},O,{originQuery:N.query});case m.DESTINATION_QUERY:return Object.assign({},O,{destinationQuery:N.query});case m.ORIGIN_FROM_COORDINATES:return Object.assign({},O,{originQueryCoordinates:N.coordinates});case m.DESTINATION_FROM_COORDINATES:return Object.assign({},O,{destinationQueryCoordinates:N.coordinates});case m.ORIGIN_CLEAR:return Object.assign({},O,{origin:{},originQuery:"",waypoints:[],directions:[]});case m.DESTINATION_CLEAR:return Object.assign({},O,{destination:{},destinationQuery:"",waypoints:[],directions:[]});case m.DIRECTIONS_REQUEST_START:return Object.assign({},O,{fetchDirectionsRequest:N.request});case m.DIRECTIONS:return Object.assign({},O,{directions:N.directions,fetchDirectionsRequest:null});case m.ROUTE_INDEX:return Object.assign({},O,{routeIndex:N.routeIndex});case m.ERROR:return Object.assign({},O,{error:N.error});default:return O}}var R=I;h.default=R},{"../constants/action_types.js":26,"merge-options":14}],34:[function(s,a,h){Object.defineProperty(h,"__esModule",{value:!0}),h.default=void 0;function f(R){return R[0]>=-180&&R[0]<=180&&R[1]>=-90&&R[1]<=90}function m(R,O){return R=R.geometry.coordinates,O=O.geometry.coordinates,R.join()===O.join()||R[0].toFixed(3)===O[0].toFixed(3)&&R[1].toFixed(3)===O[1].toFixed(3)}function y(R){var O=360,N=((R- -180)%O+O)%O+-180;return N===-180?180:N}function x(R,O){var N=0;return Math.floor(O)!==O&&(N=O.toString().split(".")[1].length),R.toFixed(Math.min(N,5))}function w(R,O){return{type:"Feature",geometry:{type:"Point",coordinates:R},properties:O||{}}}function T(R){return R.legs.reduce(function(O,N,G){return G>0&&(O[O.length-1].maneuver.type="waypoint",N.steps[0].maneuver.type=""),O.concat(N.steps)},[])}var M={duration:function(O){var N=Math.floor(O/60),G=Math.floor(N/60);return O%=60,N%=60,G===0&&N===0?O+"s":G===0?N+"min":G+"h "+N+"min"},imperial:function(O){var N=O/1609.344;return N>=100?N.toFixed(0)+"mi":N>=10?N.toFixed(1)+"mi":N>=.1?N.toFixed(2)+"mi":(N*5280).toFixed(0)+"ft"},metric:function(O){return O>=1e5?(O/1e3).toFixed(0)+"km":O>=1e4?(O/1e3).toFixed(1)+"km":O>=100?(O/1e3).toFixed(2)+"km":O.toFixed(0)+"m"}},I={format:M,coordinateMatch:m,createPoint:w,validCoords:f,wrap:y,roundWithOriginalPrecision:x,getAllSteps:T};h.default=I},{}]},{},[32])(32)})})(qrt);function Zrt(){PV.init();const e=[{name:"Evacuation guide",description:"Navigate evacuation routes with ease. AgapayReady provides step-by-step guidance to ensure your safety during emergencies.",icon:Brt},{name:"Contact Support",description:"Access emergency assistance with ease. Find essential contact numbers for immediate support during crises.",icon:jrt},{name:"Emergency drills gruide",description:"Prepare effectively with comprehensive drill guides. Access resources and instructions to enhance your readiness for emergency situations.",icon:Vrt},{name:"Realtime updates",description:"Stay informed and ready for action with live updates. Access detailed guides and essential resources instantly, empowering you to respond effectively to emergency situations as they unfold.",icon:Wrt}];return D.jsx("div",{className:"overflow-hidden bg-white py-24 sm:py-32",children:D.jsx("div",{className:"mx-auto max-w-7xl px-6 lg:px-8",children:D.jsx("div",{className:"mx-auto grid max-w-2xl grid-cols-1 gap-x-8 gap-y-16 sm:gap-y-20 lg:mx-0 lg:max-w-none lg:grid-cols-2",children:D.jsx("div",{className:"lg:pr-8 lg:pt-4",children:D.jsxs("div",{className:"lg:max-w-lg",children:[D.jsx("h2",{className:"text-base font-semibold leading-7 text-red-600",children:"Ready When You Need It"}),D.jsx("p",{className:"mt-2 text-3xl font-bold tracking-tight text-gray-900 sm:text-4xl",children:"Explore Our Services"}),D.jsx("p",{className:"mt-6 text-lg leading-8 text-gray-600",children:"Our service is here to assist you. AgapayReady ensures you're prepared to respond effectively in any emergency."}),D.jsx("dl",{className:"mt-10 max-w-xl space-y-8 text-base leading-7 text-gray-600 lg:max-w-none",children:e.map(r=>D.jsxs("div",{className:"relative pl-9",children:[D.jsxs("dt",{className:"inline font-semibold text-gray-900",children:[D.jsx(r.icon,{className:"absolute left-1 top-1 h-5 w-5 text-red-600","aria-hidden":"true"}),r.name]})," ",D.jsx("br",{}),D.jsx("dd",{className:"inline",children:r.description})]},r.name))})]})})})})})}function Xrt(){return D.jsx("section",{children:D.jsx("div",{className:"mx-auto max-w-screen-2xl px-4 py-8 sm:px-6 lg:px-8",children:D.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[D.jsx("div",{className:"bg-black p-8 md:p-12 lg:px-16 lg:py-24",children:D.jsxs("div",{className:"mx-auto max-w-xl text-center",children:[D.jsx("h2",{className:"text-2xl font-bold text-white md:text-3xl text-left",children:"Your Comprehensive Solution for Campus Safety and Resilience"}),D.jsx("p",{className:"hidden text-white/90 sm:mt-4 sm:block text-left",children:"Discover peace of mind in every crisis. AgapayReady keeps you informed and empowered during emergencies at TUP-Taguig. From real-time updates to intuitive guidance, stay safe with us."})]})}),D.jsxs("div",{className:"grid grid-cols-2 gap-4 md:grid-cols-1 lg:grid-cols-2",children:[D.jsx("img",{alt:"Student",src:"https://pbs.twimg.com/media/DSlWgkQV4AAMPMA.jpg",className:"h-40 w-full object-cover sm:h-56 md:h-full"}),D.jsx("img",{alt:"Student",src:"https://mb.com.ph/media/Taguig_March162023_D_31130ebc3b/Taguig_March162023_D_31130ebc3b.jpg",className:"h-40 w-full object-cover sm:h-56 md:h-full"})]})]})})})}const LV=Y.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),Qx=Y.createContext({}),DC=Y.createContext(null),t1=typeof document<"u",Yrt=t1?Y.useLayoutEffect:Y.useEffect,zV=Y.createContext({strict:!1}),RC=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),Krt="framerAppearId",NV="data-"+RC(Krt),FV={skipAnimations:!1,useManualTiming:!1};class c4{constructor(){this.order=[],this.scheduled=new Set}add(r){if(!this.scheduled.has(r))return this.scheduled.add(r),this.order.push(r),!0}remove(r){const s=this.order.indexOf(r);s!==-1&&(this.order.splice(s,1),this.scheduled.delete(r))}clear(){this.order.length=0,this.scheduled.clear()}}function Jrt(e){let r=new c4,s=new c4,a=0,h=!1,f=!1;const m=new WeakSet,y={schedule:(x,w=!1,T=!1)=>{const M=T&&h,I=M?r:s;return w&&m.add(x),I.add(x)&&M&&h&&(a=r.order.length),x},cancel:x=>{s.remove(x),m.delete(x)},process:x=>{if(h){f=!0;return}if(h=!0,[r,s]=[s,r],s.clear(),a=r.order.length,a)for(let w=0;w<a;w++){const T=r.order[w];m.has(T)&&(y.schedule(T),e()),T(x)}h=!1,f&&(f=!1,y.process(x))}};return y}const _0=["prepare","read","update","preRender","render","postRender"],Qrt=40;function BV(e,r){let s=!1,a=!0;const h={delta:0,timestamp:0,isProcessing:!1},f=_0.reduce((M,I)=>(M[I]=Jrt(()=>s=!0),M),{}),m=M=>{f[M].process(h)},y=()=>{const M=performance.now();s=!1,h.delta=a?1e3/60:Math.max(Math.min(M-h.timestamp,Qrt),1),h.timestamp=M,h.isProcessing=!0,_0.forEach(m),h.isProcessing=!1,s&&r&&(a=!1,e(y))},x=()=>{s=!0,a=!0,h.isProcessing||e(y)};return{schedule:_0.reduce((M,I)=>{const R=f[I];return M[I]=(O,N=!1,G=!1)=>(s||x(),R.schedule(O,N,G)),M},{}),cancel:M=>_0.forEach(I=>f[I].cancel(M)),state:h,steps:f}}const{schedule:OC,cancel:w_t}=BV(queueMicrotask,!1);function tit(e,r,s,a){const{visualElement:h}=Y.useContext(Qx),f=Y.useContext(zV),m=Y.useContext(DC),y=Y.useContext(LV).reducedMotion,x=Y.useRef();a=a||f.renderer,!x.current&&a&&(x.current=a(e,{visualState:r,parent:h,props:s,presenceContext:m,blockInitialAnimation:m?m.initial===!1:!1,reducedMotionConfig:y}));const w=x.current;Y.useInsertionEffect(()=>{w&&w.update(s,m)});const T=Y.useRef(!!(s[NV]&&!window.HandoffComplete));return Yrt(()=>{w&&(OC.postRender(w.render),T.current&&w.animationState&&w.animationState.animateChanges())}),Y.useEffect(()=>{w&&(w.updateFeatures(),!T.current&&w.animationState&&w.animationState.animateChanges(),T.current&&(T.current=!1,window.HandoffComplete=!0))}),w}function Yd(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function eit(e,r,s){return Y.useCallback(a=>{a&&e.mount&&e.mount(a),r&&(a?r.mount(a):r.unmount()),s&&(typeof s=="function"?s(a):Yd(s)&&(s.current=a))},[r])}function ig(e){return typeof e=="string"||Array.isArray(e)}function e1(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}const LC=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],zC=["initial",...LC];function n1(e){return e1(e.animate)||zC.some(r=>ig(e[r]))}function jV(e){return!!(n1(e)||e.variants)}function nit(e,r){if(n1(e)){const{initial:s,animate:a}=e;return{initial:s===!1||ig(s)?s:void 0,animate:ig(a)?a:void 0}}return e.inherit!==!1?r:{}}function rit(e){const{initial:r,animate:s}=nit(e,Y.useContext(Qx));return Y.useMemo(()=>({initial:r,animate:s}),[u4(r),u4(s)])}function u4(e){return Array.isArray(e)?e.join(" "):e}const h4={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},sg={};for(const e in h4)sg[e]={isEnabled:r=>h4[e].some(s=>!!r[s])};function iit(e){for(const r in e)sg[r]={...sg[r],...e[r]}}const VV=Y.createContext({}),UV=Y.createContext({}),sit=Symbol.for("motionComponentSymbol");function oit({preloadedFeatures:e,createVisualElement:r,useRender:s,useVisualState:a,Component:h}){e&&iit(e);function f(y,x){let w;const T={...Y.useContext(LV),...y,layoutId:ait(y)},{isStatic:M}=T,I=rit(y),R=a(y,M);if(!M&&t1){I.visualElement=tit(h,R,T,r);const O=Y.useContext(UV),N=Y.useContext(zV).strict;I.visualElement&&(w=I.visualElement.loadFeatures(T,N,e,O))}return Y.createElement(Qx.Provider,{value:I},w&&I.visualElement?Y.createElement(w,{visualElement:I.visualElement,...T}):null,s(h,y,eit(R,I.visualElement,x),R,M,I.visualElement))}const m=Y.forwardRef(f);return m[sit]=h,m}function ait({layoutId:e}){const r=Y.useContext(VV).id;return r&&e!==void 0?r+"-"+e:e}function lit(e){function r(a,h={}){return oit(e(a,h))}if(typeof Proxy>"u")return r;const s=new Map;return new Proxy(r,{get:(a,h)=>(s.has(h)||s.set(h,r(h)),s.get(h))})}const cit=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function NC(e){return typeof e!="string"||e.includes("-")?!1:!!(cit.indexOf(e)>-1||/[A-Z]/.test(e))}const tx={};function uit(e){Object.assign(tx,e)}const Rg=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Lh=new Set(Rg);function $V(e,{layout:r,layoutId:s}){return Lh.has(e)||e.startsWith("origin")||(r||s!==void 0)&&(!!tx[e]||e==="opacity")}const Zs=e=>!!(e&&e.getVelocity),hit={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},dit=Rg.length;function fit(e,{enableHardwareAcceleration:r=!0,allowTransformNone:s=!0},a,h){let f="";for(let m=0;m<dit;m++){const y=Rg[m];if(e[y]!==void 0){const x=hit[y]||y;f+=`${x}(${e[y]}) `}}return r&&!e.z&&(f+="translateZ(0)"),f=f.trim(),h?f=h(e,a?"":f):s&&a&&(f="none"),f}const GV=e=>r=>typeof r=="string"&&r.startsWith(e),WV=GV("--"),_M=GV("var(--"),pit=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,mit=(e,r)=>r&&typeof e=="number"?r.transform(e):e,cu=(e,r,s)=>Math.min(Math.max(s,e),r),zh={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Am={...zh,transform:e=>cu(0,1,e)},y0={...zh,default:1},Cm=e=>Math.round(e*1e5)/1e5,r1=/(-)?([\d]*\.?[\d])+/g,HV=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,git=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function Og(e){return typeof e=="string"}const Lg=e=>({test:r=>Og(r)&&r.endsWith(e)&&r.split(" ").length===1,parse:parseFloat,transform:r=>`${r}${e}`}),Ic=Lg("deg"),Ha=Lg("%"),wn=Lg("px"),_it=Lg("vh"),yit=Lg("vw"),d4={...Ha,parse:e=>Ha.parse(e)/100,transform:e=>Ha.transform(e*100)},f4={...zh,transform:Math.round},qV={borderWidth:wn,borderTopWidth:wn,borderRightWidth:wn,borderBottomWidth:wn,borderLeftWidth:wn,borderRadius:wn,radius:wn,borderTopLeftRadius:wn,borderTopRightRadius:wn,borderBottomRightRadius:wn,borderBottomLeftRadius:wn,width:wn,maxWidth:wn,height:wn,maxHeight:wn,size:wn,top:wn,right:wn,bottom:wn,left:wn,padding:wn,paddingTop:wn,paddingRight:wn,paddingBottom:wn,paddingLeft:wn,margin:wn,marginTop:wn,marginRight:wn,marginBottom:wn,marginLeft:wn,rotate:Ic,rotateX:Ic,rotateY:Ic,rotateZ:Ic,scale:y0,scaleX:y0,scaleY:y0,scaleZ:y0,skew:Ic,skewX:Ic,skewY:Ic,distance:wn,translateX:wn,translateY:wn,translateZ:wn,x:wn,y:wn,z:wn,perspective:wn,transformPerspective:wn,opacity:Am,originX:d4,originY:d4,originZ:wn,zIndex:f4,fillOpacity:Am,strokeOpacity:Am,numOctaves:f4};function FC(e,r,s,a){const{style:h,vars:f,transform:m,transformOrigin:y}=e;let x=!1,w=!1,T=!0;for(const M in r){const I=r[M];if(WV(M)){f[M]=I;continue}const R=qV[M],O=mit(I,R);if(Lh.has(M)){if(x=!0,m[M]=O,!T)continue;I!==(R.default||0)&&(T=!1)}else M.startsWith("origin")?(w=!0,y[M]=O):h[M]=O}if(r.transform||(x||a?h.transform=fit(e.transform,s,T,a):h.transform&&(h.transform="none")),w){const{originX:M="50%",originY:I="50%",originZ:R=0}=y;h.transformOrigin=`${M} ${I} ${R}`}}const BC=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function ZV(e,r,s){for(const a in r)!Zs(r[a])&&!$V(a,s)&&(e[a]=r[a])}function vit({transformTemplate:e},r,s){return Y.useMemo(()=>{const a=BC();return FC(a,r,{enableHardwareAcceleration:!s},e),Object.assign({},a.vars,a.style)},[r])}function xit(e,r,s){const a=e.style||{},h={};return ZV(h,a,e),Object.assign(h,vit(e,r,s)),h}function bit(e,r,s){const a={},h=xit(e,r,s);return e.drag&&e.dragListener!==!1&&(a.draggable=!1,h.userSelect=h.WebkitUserSelect=h.WebkitTouchCallout="none",h.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(a.tabIndex=0),a.style=h,a}const wit=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function ex(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||wit.has(e)}let XV=e=>!ex(e);function Sit(e){e&&(XV=r=>r.startsWith("on")?!ex(r):e(r))}try{Sit(require("@emotion/is-prop-valid").default)}catch{}function Tit(e,r,s){const a={};for(const h in e)h==="values"&&typeof e.values=="object"||(XV(h)||s===!0&&ex(h)||!r&&!ex(h)||e.draggable&&h.startsWith("onDrag"))&&(a[h]=e[h]);return a}function p4(e,r,s){return typeof e=="string"?e:wn.transform(r+s*e)}function Eit(e,r,s){const a=p4(r,e.x,e.width),h=p4(s,e.y,e.height);return`${a} ${h}`}const Mit={offset:"stroke-dashoffset",array:"stroke-dasharray"},Ait={offset:"strokeDashoffset",array:"strokeDasharray"};function Cit(e,r,s=1,a=0,h=!0){e.pathLength=1;const f=h?Mit:Ait;e[f.offset]=wn.transform(-a);const m=wn.transform(r),y=wn.transform(s);e[f.array]=`${m} ${y}`}function jC(e,{attrX:r,attrY:s,attrScale:a,originX:h,originY:f,pathLength:m,pathSpacing:y=1,pathOffset:x=0,...w},T,M,I){if(FC(e,w,T,I),M){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:R,style:O,dimensions:N}=e;R.transform&&(N&&(O.transform=R.transform),delete R.transform),N&&(h!==void 0||f!==void 0||O.transform)&&(O.transformOrigin=Eit(N,h!==void 0?h:.5,f!==void 0?f:.5)),r!==void 0&&(R.x=r),s!==void 0&&(R.y=s),a!==void 0&&(R.scale=a),m!==void 0&&Cit(R,m,y,x,!1)}const YV=()=>({...BC(),attrs:{}}),VC=e=>typeof e=="string"&&e.toLowerCase()==="svg";function Pit(e,r,s,a){const h=Y.useMemo(()=>{const f=YV();return jC(f,r,{enableHardwareAcceleration:!1},VC(a),e.transformTemplate),{...f.attrs,style:{...f.style}}},[r]);if(e.style){const f={};ZV(f,e.style,e),h.style={...f,...h.style}}return h}function Iit(e=!1){return(s,a,h,{latestValues:f},m)=>{const x=(NC(s)?Pit:bit)(a,f,m,s),T={...Tit(a,typeof s=="string",e),...x,ref:h},{children:M}=a,I=Y.useMemo(()=>Zs(M)?M.get():M,[M]);return Y.createElement(s,{...T,children:I})}}function KV(e,{style:r,vars:s},a,h){Object.assign(e.style,r,h&&h.getProjectionStyles(a));for(const f in s)e.style.setProperty(f,s[f])}const JV=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function QV(e,r,s,a){KV(e,r,void 0,a);for(const h in r.attrs)e.setAttribute(JV.has(h)?h:RC(h),r.attrs[h])}function UC(e,r){const{style:s}=e,a={};for(const h in s)(Zs(s[h])||r.style&&Zs(r.style[h])||$V(h,e))&&(a[h]=s[h]);return a}function tU(e,r){const s=UC(e,r);for(const a in e)if(Zs(e[a])||Zs(r[a])){const h=Rg.indexOf(a)!==-1?"attr"+a.charAt(0).toUpperCase()+a.substring(1):a;s[h]=e[a]}return s}function $C(e,r,s,a={},h={}){return typeof r=="function"&&(r=r(s!==void 0?s:e.custom,a,h)),typeof r=="string"&&(r=e.variants&&e.variants[r]),typeof r=="function"&&(r=r(s!==void 0?s:e.custom,a,h)),r}function kit(e){const r=Y.useRef(null);return r.current===null&&(r.current=e()),r.current}const nx=e=>Array.isArray(e),Dit=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),Rit=e=>nx(e)?e[e.length-1]||0:e;function nv(e){const r=Zs(e)?e.get():e;return Dit(r)?r.toValue():r}function Oit({scrapeMotionValuesFromProps:e,createRenderState:r,onMount:s},a,h,f){const m={latestValues:Lit(a,h,f,e),renderState:r()};return s&&(m.mount=y=>s(a,y,m)),m}const eU=e=>(r,s)=>{const a=Y.useContext(Qx),h=Y.useContext(DC),f=()=>Oit(e,r,a,h);return s?f():kit(f)};function Lit(e,r,s,a){const h={},f=a(e,{});for(const I in f)h[I]=nv(f[I]);let{initial:m,animate:y}=e;const x=n1(e),w=jV(e);r&&w&&!x&&e.inherit!==!1&&(m===void 0&&(m=r.initial),y===void 0&&(y=r.animate));let T=s?s.initial===!1:!1;T=T||m===!1;const M=T?y:m;return M&&typeof M!="boolean"&&!e1(M)&&(Array.isArray(M)?M:[M]).forEach(R=>{const O=$C(e,R);if(!O)return;const{transitionEnd:N,transition:G,...$}=O;for(const z in $){let B=$[z];if(Array.isArray(B)){const H=T?B.length-1:0;B=B[H]}B!==null&&(h[z]=B)}for(const z in N)h[z]=N[z]}),h}const Si=e=>e,{schedule:ii,cancel:jl,state:Ji,steps:CT}=BV(typeof requestAnimationFrame<"u"?requestAnimationFrame:Si,!0),zit={useVisualState:eU({scrapeMotionValuesFromProps:tU,createRenderState:YV,onMount:(e,r,{renderState:s,latestValues:a})=>{ii.read(()=>{try{s.dimensions=typeof r.getBBox=="function"?r.getBBox():r.getBoundingClientRect()}catch{s.dimensions={x:0,y:0,width:0,height:0}}}),ii.render(()=>{jC(s,a,{enableHardwareAcceleration:!1},VC(r.tagName),e.transformTemplate),QV(r,s)})}})},Nit={useVisualState:eU({scrapeMotionValuesFromProps:UC,createRenderState:BC})};function Fit(e,{forwardMotionProps:r=!1},s,a){return{...NC(e)?zit:Nit,preloadedFeatures:s,useRender:Iit(r),createVisualElement:a,Component:e}}function Al(e,r,s,a={passive:!0}){return e.addEventListener(r,s,a),()=>e.removeEventListener(r,s)}const nU=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1;function i1(e,r="page"){return{point:{x:e[r+"X"],y:e[r+"Y"]}}}const Bit=e=>r=>nU(r)&&e(r,i1(r));function Rl(e,r,s,a){return Al(e,r,Bit(s),a)}const jit=(e,r)=>s=>r(e(s)),nu=(...e)=>e.reduce(jit);function rU(e){let r=null;return()=>{const s=()=>{r=null};return r===null?(r=e,s):!1}}const m4=rU("dragHorizontal"),g4=rU("dragVertical");function iU(e){let r=!1;if(e==="y")r=g4();else if(e==="x")r=m4();else{const s=m4(),a=g4();s&&a?r=()=>{s(),a()}:(s&&s(),a&&a())}return r}function sU(){const e=iU(!0);return e?(e(),!1):!0}class yu{constructor(r){this.isMounted=!1,this.node=r}update(){}}function _4(e,r){const s="pointer"+(r?"enter":"leave"),a="onHover"+(r?"Start":"End"),h=(f,m)=>{if(f.pointerType==="touch"||sU())return;const y=e.getProps();e.animationState&&y.whileHover&&e.animationState.setActive("whileHover",r),y[a]&&ii.update(()=>y[a](f,m))};return Rl(e.current,s,h,{passive:!e.getProps()[a]})}class Vit extends yu{mount(){this.unmount=nu(_4(this.node,!0),_4(this.node,!1))}unmount(){}}class Uit extends yu{constructor(){super(...arguments),this.isActive=!1}onFocus(){let r=!1;try{r=this.node.current.matches(":focus-visible")}catch{r=!0}!r||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=nu(Al(this.node.current,"focus",()=>this.onFocus()),Al(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const oU=(e,r)=>r?e===r?!0:oU(e,r.parentElement):!1;function PT(e,r){if(!r)return;const s=new PointerEvent("pointer"+e);r(s,i1(s))}class $it extends yu{constructor(){super(...arguments),this.removeStartListeners=Si,this.removeEndListeners=Si,this.removeAccessibleListeners=Si,this.startPointerPress=(r,s)=>{if(this.isPressing)return;this.removeEndListeners();const a=this.node.getProps(),f=Rl(window,"pointerup",(y,x)=>{if(!this.checkPressEnd())return;const{onTap:w,onTapCancel:T,globalTapTarget:M}=this.node.getProps();ii.update(()=>{!M&&!oU(this.node.current,y.target)?T&&T(y,x):w&&w(y,x)})},{passive:!(a.onTap||a.onPointerUp)}),m=Rl(window,"pointercancel",(y,x)=>this.cancelPress(y,x),{passive:!(a.onTapCancel||a.onPointerCancel)});this.removeEndListeners=nu(f,m),this.startPress(r,s)},this.startAccessiblePress=()=>{const r=f=>{if(f.key!=="Enter"||this.isPressing)return;const m=y=>{y.key!=="Enter"||!this.checkPressEnd()||PT("up",(x,w)=>{const{onTap:T}=this.node.getProps();T&&ii.update(()=>T(x,w))})};this.removeEndListeners(),this.removeEndListeners=Al(this.node.current,"keyup",m),PT("down",(y,x)=>{this.startPress(y,x)})},s=Al(this.node.current,"keydown",r),a=()=>{this.isPressing&&PT("cancel",(f,m)=>this.cancelPress(f,m))},h=Al(this.node.current,"blur",a);this.removeAccessibleListeners=nu(s,h)}}startPress(r,s){this.isPressing=!0;const{onTapStart:a,whileTap:h}=this.node.getProps();h&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),a&&ii.update(()=>a(r,s))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!sU()}cancelPress(r,s){if(!this.checkPressEnd())return;const{onTapCancel:a}=this.node.getProps();a&&ii.update(()=>a(r,s))}mount(){const r=this.node.getProps(),s=Rl(r.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(r.onTapStart||r.onPointerStart)}),a=Al(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=nu(s,a)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const yM=new WeakMap,IT=new WeakMap,Git=e=>{const r=yM.get(e.target);r&&r(e)},Wit=e=>{e.forEach(Git)};function Hit({root:e,...r}){const s=e||document;IT.has(s)||IT.set(s,{});const a=IT.get(s),h=JSON.stringify(r);return a[h]||(a[h]=new IntersectionObserver(Wit,{root:e,...r})),a[h]}function qit(e,r,s){const a=Hit(r);return yM.set(e,s),a.observe(e),()=>{yM.delete(e),a.unobserve(e)}}const Zit={some:0,all:1};class Xit extends yu{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:r={}}=this.node.getProps(),{root:s,margin:a,amount:h="some",once:f}=r,m={root:s?s.current:void 0,rootMargin:a,threshold:typeof h=="number"?h:Zit[h]},y=x=>{const{isIntersecting:w}=x;if(this.isInView===w||(this.isInView=w,f&&!w&&this.hasEnteredView))return;w&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",w);const{onViewportEnter:T,onViewportLeave:M}=this.node.getProps(),I=w?T:M;I&&I(x)};return qit(this.node.current,m,y)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:r,prevProps:s}=this.node;["amount","margin","root"].some(Yit(r,s))&&this.startObserver()}unmount(){}}function Yit({viewport:e={}},{viewport:r={}}={}){return s=>e[s]!==r[s]}const Kit={inView:{Feature:Xit},tap:{Feature:$it},focus:{Feature:Uit},hover:{Feature:Vit}};function aU(e,r){if(!Array.isArray(r))return!1;const s=r.length;if(s!==e.length)return!1;for(let a=0;a<s;a++)if(r[a]!==e[a])return!1;return!0}function Jit(e){const r={};return e.values.forEach((s,a)=>r[a]=s.get()),r}function Qit(e){const r={};return e.values.forEach((s,a)=>r[a]=s.getVelocity()),r}function s1(e,r,s){const a=e.getProps();return $C(a,r,s!==void 0?s:a.custom,Jit(e),Qit(e))}let GC=Si;const gh=e=>e*1e3,Ol=e=>e/1e3,tst={current:!1},lU=e=>Array.isArray(e)&&typeof e[0]=="number";function cU(e){return!!(!e||typeof e=="string"&&uU[e]||lU(e)||Array.isArray(e)&&e.every(cU))}const cm=([e,r,s,a])=>`cubic-bezier(${e}, ${r}, ${s}, ${a})`,uU={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:cm([0,.65,.55,1]),circOut:cm([.55,0,1,.45]),backIn:cm([.31,.01,.66,-.59]),backOut:cm([.33,1.53,.69,.99])};function hU(e){if(e)return lU(e)?cm(e):Array.isArray(e)?e.map(hU):uU[e]}function est(e,r,s,{delay:a=0,duration:h,repeat:f=0,repeatType:m="loop",ease:y,times:x}={}){const w={[r]:s};x&&(w.offset=x);const T=hU(y);return Array.isArray(T)&&(w.easing=T),e.animate(w,{delay:a,duration:h,easing:Array.isArray(T)?"linear":T,fill:"both",iterations:f+1,direction:m==="reverse"?"alternate":"normal"})}function nst(e,{repeat:r,repeatType:s="loop"}){const a=r&&s!=="loop"&&r%2===1?0:e.length-1;return e[a]}const dU=(e,r,s)=>(((1-3*s+3*r)*e+(3*s-6*r))*e+3*r)*e,rst=1e-7,ist=12;function sst(e,r,s,a,h){let f,m,y=0;do m=r+(s-r)/2,f=dU(m,a,h)-e,f>0?s=m:r=m;while(Math.abs(f)>rst&&++y<ist);return m}function zg(e,r,s,a){if(e===r&&s===a)return Si;const h=f=>sst(f,0,1,e,s);return f=>f===0||f===1?f:dU(h(f),r,a)}const ost=zg(.42,0,1,1),ast=zg(0,0,.58,1),fU=zg(.42,0,.58,1),lst=e=>Array.isArray(e)&&typeof e[0]!="number",pU=e=>r=>r<=.5?e(2*r)/2:(2-e(2*(1-r)))/2,mU=e=>r=>1-e(1-r),WC=e=>1-Math.sin(Math.acos(e)),gU=mU(WC),cst=pU(WC),_U=zg(.33,1.53,.69,.99),HC=mU(_U),ust=pU(HC),hst=e=>(e*=2)<1?.5*HC(e):.5*(2-Math.pow(2,-10*(e-1))),dst={linear:Si,easeIn:ost,easeInOut:fU,easeOut:ast,circIn:WC,circInOut:cst,circOut:gU,backIn:HC,backInOut:ust,backOut:_U,anticipate:hst},y4=e=>{if(Array.isArray(e)){GC(e.length===4);const[r,s,a,h]=e;return zg(r,s,a,h)}else if(typeof e=="string")return dst[e];return e},qC=(e,r)=>s=>!!(Og(s)&&git.test(s)&&s.startsWith(e)||r&&Object.prototype.hasOwnProperty.call(s,r)),yU=(e,r,s)=>a=>{if(!Og(a))return a;const[h,f,m,y]=a.match(r1);return{[e]:parseFloat(h),[r]:parseFloat(f),[s]:parseFloat(m),alpha:y!==void 0?parseFloat(y):1}},fst=e=>cu(0,255,e),kT={...zh,transform:e=>Math.round(fst(e))},dh={test:qC("rgb","red"),parse:yU("red","green","blue"),transform:({red:e,green:r,blue:s,alpha:a=1})=>"rgba("+kT.transform(e)+", "+kT.transform(r)+", "+kT.transform(s)+", "+Cm(Am.transform(a))+")"};function pst(e){let r="",s="",a="",h="";return e.length>5?(r=e.substring(1,3),s=e.substring(3,5),a=e.substring(5,7),h=e.substring(7,9)):(r=e.substring(1,2),s=e.substring(2,3),a=e.substring(3,4),h=e.substring(4,5),r+=r,s+=s,a+=a,h+=h),{red:parseInt(r,16),green:parseInt(s,16),blue:parseInt(a,16),alpha:h?parseInt(h,16)/255:1}}const vM={test:qC("#"),parse:pst,transform:dh.transform},Kd={test:qC("hsl","hue"),parse:yU("hue","saturation","lightness"),transform:({hue:e,saturation:r,lightness:s,alpha:a=1})=>"hsla("+Math.round(e)+", "+Ha.transform(Cm(r))+", "+Ha.transform(Cm(s))+", "+Cm(Am.transform(a))+")"},Ss={test:e=>dh.test(e)||vM.test(e)||Kd.test(e),parse:e=>dh.test(e)?dh.parse(e):Kd.test(e)?Kd.parse(e):vM.parse(e),transform:e=>Og(e)?e:e.hasOwnProperty("red")?dh.transform(e):Kd.transform(e)},ri=(e,r,s)=>-s*e+s*r+e;function DT(e,r,s){return s<0&&(s+=1),s>1&&(s-=1),s<1/6?e+(r-e)*6*s:s<1/2?r:s<2/3?e+(r-e)*(2/3-s)*6:e}function mst({hue:e,saturation:r,lightness:s,alpha:a}){e/=360,r/=100,s/=100;let h=0,f=0,m=0;if(!r)h=f=m=s;else{const y=s<.5?s*(1+r):s+r-s*r,x=2*s-y;h=DT(x,y,e+1/3),f=DT(x,y,e),m=DT(x,y,e-1/3)}return{red:Math.round(h*255),green:Math.round(f*255),blue:Math.round(m*255),alpha:a}}const RT=(e,r,s)=>{const a=e*e;return Math.sqrt(Math.max(0,s*(r*r-a)+a))},gst=[vM,dh,Kd],_st=e=>gst.find(r=>r.test(e));function v4(e){const r=_st(e);let s=r.parse(e);return r===Kd&&(s=mst(s)),s}const vU=(e,r)=>{const s=v4(e),a=v4(r),h={...s};return f=>(h.red=RT(s.red,a.red,f),h.green=RT(s.green,a.green,f),h.blue=RT(s.blue,a.blue,f),h.alpha=ri(s.alpha,a.alpha,f),dh.transform(h))};function yst(e){var r,s;return isNaN(e)&&Og(e)&&(((r=e.match(r1))===null||r===void 0?void 0:r.length)||0)+(((s=e.match(HV))===null||s===void 0?void 0:s.length)||0)>0}const xU={regex:pit,countKey:"Vars",token:"${v}",parse:Si},bU={regex:HV,countKey:"Colors",token:"${c}",parse:Ss.parse},wU={regex:r1,countKey:"Numbers",token:"${n}",parse:zh.parse};function OT(e,{regex:r,countKey:s,token:a,parse:h}){const f=e.tokenised.match(r);f&&(e["num"+s]=f.length,e.tokenised=e.tokenised.replace(r,a),e.values.push(...f.map(h)))}function rx(e){const r=e.toString(),s={value:r,tokenised:r,values:[],numVars:0,numColors:0,numNumbers:0};return s.value.includes("var(--")&&OT(s,xU),OT(s,bU),OT(s,wU),s}function SU(e){return rx(e).values}function TU(e){const{values:r,numColors:s,numVars:a,tokenised:h}=rx(e),f=r.length;return m=>{let y=h;for(let x=0;x<f;x++)x<a?y=y.replace(xU.token,m[x]):x<a+s?y=y.replace(bU.token,Ss.transform(m[x])):y=y.replace(wU.token,Cm(m[x]));return y}}const vst=e=>typeof e=="number"?0:e;function xst(e){const r=SU(e);return TU(e)(r.map(vst))}const uu={test:yst,parse:SU,createTransformer:TU,getAnimatableNone:xst},EU=(e,r)=>s=>`${s>0?r:e}`;function MU(e,r){return typeof e=="number"?s=>ri(e,r,s):Ss.test(e)?vU(e,r):e.startsWith("var(")?EU(e,r):CU(e,r)}const AU=(e,r)=>{const s=[...e],a=s.length,h=e.map((f,m)=>MU(f,r[m]));return f=>{for(let m=0;m<a;m++)s[m]=h[m](f);return s}},bst=(e,r)=>{const s={...e,...r},a={};for(const h in s)e[h]!==void 0&&r[h]!==void 0&&(a[h]=MU(e[h],r[h]));return h=>{for(const f in a)s[f]=a[f](h);return s}},CU=(e,r)=>{const s=uu.createTransformer(r),a=rx(e),h=rx(r);return a.numVars===h.numVars&&a.numColors===h.numColors&&a.numNumbers>=h.numNumbers?nu(AU(a.values,h.values),s):EU(e,r)},og=(e,r,s)=>{const a=r-e;return a===0?1:(s-e)/a},x4=(e,r)=>s=>ri(e,r,s);function wst(e){return typeof e=="number"?x4:typeof e=="string"?Ss.test(e)?vU:CU:Array.isArray(e)?AU:typeof e=="object"?bst:x4}function Sst(e,r,s){const a=[],h=s||wst(e[0]),f=e.length-1;for(let m=0;m<f;m++){let y=h(e[m],e[m+1]);if(r){const x=Array.isArray(r)?r[m]||Si:r;y=nu(x,y)}a.push(y)}return a}function PU(e,r,{clamp:s=!0,ease:a,mixer:h}={}){const f=e.length;if(GC(f===r.length),f===1)return()=>r[0];e[0]>e[f-1]&&(e=[...e].reverse(),r=[...r].reverse());const m=Sst(r,a,h),y=m.length,x=w=>{let T=0;if(y>1)for(;T<e.length-2&&!(w<e[T+1]);T++);const M=og(e[T],e[T+1],w);return m[T](M)};return s?w=>x(cu(e[0],e[f-1],w)):x}function Tst(e,r){const s=e[e.length-1];for(let a=1;a<=r;a++){const h=og(0,r,a);e.push(ri(s,1,h))}}function Est(e){const r=[0];return Tst(r,e.length-1),r}function Mst(e,r){return e.map(s=>s*r)}function Ast(e,r){return e.map(()=>r||fU).splice(0,e.length-1)}function ix({duration:e=300,keyframes:r,times:s,ease:a="easeInOut"}){const h=lst(a)?a.map(y4):y4(a),f={done:!1,value:r[0]},m=Mst(s&&s.length===r.length?s:Est(r),e),y=PU(m,r,{ease:Array.isArray(h)?h:Ast(r,h)});return{calculatedDuration:e,next:x=>(f.value=y(x),f.done=x>=e,f)}}function IU(e,r){return r?e*(1e3/r):0}const Cst=5;function kU(e,r,s){const a=Math.max(r-Cst,0);return IU(s-e(a),r-a)}const LT=.001,Pst=.01,Ist=10,kst=.05,Dst=1;function Rst({duration:e=800,bounce:r=.25,velocity:s=0,mass:a=1}){let h,f,m=1-r;m=cu(kst,Dst,m),e=cu(Pst,Ist,Ol(e)),m<1?(h=w=>{const T=w*m,M=T*e,I=T-s,R=xM(w,m),O=Math.exp(-M);return LT-I/R*O},f=w=>{const M=w*m*e,I=M*s+s,R=Math.pow(m,2)*Math.pow(w,2)*e,O=Math.exp(-M),N=xM(Math.pow(w,2),m);return(-h(w)+LT>0?-1:1)*((I-R)*O)/N}):(h=w=>{const T=Math.exp(-w*e),M=(w-s)*e+1;return-LT+T*M},f=w=>{const T=Math.exp(-w*e),M=(s-w)*(e*e);return T*M});const y=5/e,x=Lst(h,f,y);if(e=gh(e),isNaN(x))return{stiffness:100,damping:10,duration:e};{const w=Math.pow(x,2)*a;return{stiffness:w,damping:m*2*Math.sqrt(a*w),duration:e}}}const Ost=12;function Lst(e,r,s){let a=s;for(let h=1;h<Ost;h++)a=a-e(a)/r(a);return a}function xM(e,r){return e*Math.sqrt(1-r*r)}const zst=["duration","bounce"],Nst=["stiffness","damping","mass"];function b4(e,r){return r.some(s=>e[s]!==void 0)}function Fst(e){let r={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...e};if(!b4(e,Nst)&&b4(e,zst)){const s=Rst(e);r={...r,...s,mass:1},r.isResolvedFromDuration=!0}return r}function DU({keyframes:e,restDelta:r,restSpeed:s,...a}){const h=e[0],f=e[e.length-1],m={done:!1,value:h},{stiffness:y,damping:x,mass:w,duration:T,velocity:M,isResolvedFromDuration:I}=Fst({...a,velocity:-Ol(a.velocity||0)}),R=M||0,O=x/(2*Math.sqrt(y*w)),N=f-h,G=Ol(Math.sqrt(y/w)),$=Math.abs(N)<5;s||(s=$?.01:2),r||(r=$?.005:.5);let z;if(O<1){const B=xM(G,O);z=H=>{const K=Math.exp(-O*G*H);return f-K*((R+O*G*N)/B*Math.sin(B*H)+N*Math.cos(B*H))}}else if(O===1)z=B=>f-Math.exp(-G*B)*(N+(R+G*N)*B);else{const B=G*Math.sqrt(O*O-1);z=H=>{const K=Math.exp(-O*G*H),at=Math.min(B*H,300);return f-K*((R+O*G*N)*Math.sinh(at)+B*N*Math.cosh(at))/B}}return{calculatedDuration:I&&T||null,next:B=>{const H=z(B);if(I)m.done=B>=T;else{let K=R;B!==0&&(O<1?K=kU(z,B,H):K=0);const at=Math.abs(K)<=s,ft=Math.abs(f-H)<=r;m.done=at&&ft}return m.value=m.done?f:H,m}}}function w4({keyframes:e,velocity:r=0,power:s=.8,timeConstant:a=325,bounceDamping:h=10,bounceStiffness:f=500,modifyTarget:m,min:y,max:x,restDelta:w=.5,restSpeed:T}){const M=e[0],I={done:!1,value:M},R=et=>y!==void 0&&et<y||x!==void 0&&et>x,O=et=>y===void 0?x:x===void 0||Math.abs(y-et)<Math.abs(x-et)?y:x;let N=s*r;const G=M+N,$=m===void 0?G:m(G);$!==G&&(N=$-M);const z=et=>-N*Math.exp(-et/a),B=et=>$+z(et),H=et=>{const nt=z(et),W=B(et);I.done=Math.abs(nt)<=w,I.value=I.done?$:W};let K,at;const ft=et=>{R(I.value)&&(K=et,at=DU({keyframes:[I.value,O(I.value)],velocity:kU(B,et,I.value),damping:h,stiffness:f,restDelta:w,restSpeed:T}))};return ft(0),{calculatedDuration:null,next:et=>{let nt=!1;return!at&&K===void 0&&(nt=!0,H(et),ft(et)),K!==void 0&&et>K?at.next(et-K):(!nt&&H(et),I)}}}let rv;function Bst(){rv=void 0}const _h={now:()=>(rv===void 0&&_h.set(Ji.isProcessing||FV.useManualTiming?Ji.timestamp:performance.now()),rv),set:e=>{rv=e,queueMicrotask(Bst)}},jst=e=>{const r=({timestamp:s})=>e(s);return{start:()=>ii.update(r,!0),stop:()=>jl(r),now:()=>Ji.isProcessing?Ji.timestamp:_h.now()}},S4=2e4;function T4(e){let r=0;const s=50;let a=e.next(r);for(;!a.done&&r<S4;)r+=s,a=e.next(r);return r>=S4?1/0:r}const Vst={decay:w4,inertia:w4,tween:ix,keyframes:ix,spring:DU};function sx({autoplay:e=!0,delay:r=0,driver:s=jst,keyframes:a,type:h="keyframes",repeat:f=0,repeatDelay:m=0,repeatType:y="loop",onPlay:x,onStop:w,onComplete:T,onUpdate:M,...I}){let R=1,O=!1,N,G;const $=()=>{G=new Promise(se=>{N=se})};$();let z;const B=Vst[h]||ix;let H;B!==ix&&typeof a[0]!="number"&&(H=PU([0,100],a,{clamp:!1}),a=[0,100]);const K=B({...I,keyframes:a});let at;y==="mirror"&&(at=B({...I,keyframes:[...a].reverse(),velocity:-(I.velocity||0)}));let ft="idle",et=null,nt=null,W=null;K.calculatedDuration===null&&f&&(K.calculatedDuration=T4(K));const{calculatedDuration:Q}=K;let yt=1/0,Pt=1/0;Q!==null&&(yt=Q+m,Pt=yt*(f+1)-m);let st=0;const St=se=>{if(nt===null)return;R>0&&(nt=Math.min(nt,se)),R<0&&(nt=Math.min(se-Pt/R,nt)),et!==null?st=et:st=Math.round(se-nt)*R;const Ot=st-r*(R>=0?1:-1),Me=R>=0?Ot<0:Ot>Pt;st=Math.max(Ot,0),ft==="finished"&&et===null&&(st=Pt);let me=st,kt=K;if(f){const he=Math.min(st,Pt)/yt;let Fe=Math.floor(he),Oe=he%1;!Oe&&he>=1&&(Oe=1),Oe===1&&Fe--,Fe=Math.min(Fe,f+1),!!(Fe%2)&&(y==="reverse"?(Oe=1-Oe,m&&(Oe-=m/yt)):y==="mirror"&&(kt=at)),me=cu(0,1,Oe)*yt}const Wt=Me?{done:!1,value:a[0]}:kt.next(me);H&&(Wt.value=H(Wt.value));let{done:Ct}=Wt;!Me&&Q!==null&&(Ct=R>=0?st>=Pt:st<=0);const Ae=et===null&&(ft==="finished"||ft==="running"&&Ct);return M&&M(Wt.value),Ae&&Ft(),Wt},Rt=()=>{z&&z.stop(),z=void 0},Zt=()=>{ft="idle",Rt(),N(),$(),nt=W=null},Ft=()=>{ft="finished",T&&T(),Rt(),N()},$t=()=>{if(O)return;z||(z=s(St));const se=z.now();x&&x(),et!==null?nt=se-et:(!nt||ft==="finished")&&(nt=se),ft==="finished"&&$(),W=nt,et=null,ft="running",z.start()};e&&$t();const ee={then(se,Ot){return G.then(se,Ot)},get time(){return Ol(st)},set time(se){se=gh(se),st=se,et!==null||!z||R===0?et=se:nt=z.now()-se/R},get duration(){const se=K.calculatedDuration===null?T4(K):K.calculatedDuration;return Ol(se)},get speed(){return R},set speed(se){se===R||!z||(R=se,ee.time=Ol(st))},get state(){return ft},play:$t,pause:()=>{ft="paused",et=st},stop:()=>{O=!0,ft!=="idle"&&(ft="idle",w&&w(),Zt())},cancel:()=>{W!==null&&St(W),Zt()},complete:()=>{ft="finished"},sample:se=>(nt=0,St(se))};return ee}function Ust(e){let r;return()=>(r===void 0&&(r=e()),r)}const $st=Ust(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Gst=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),v0=10,Wst=2e4,Hst=(e,r)=>r.type==="spring"||e==="backgroundColor"||!cU(r.ease);function qst(e,r,{onUpdate:s,onComplete:a,...h}){if(!($st()&&Gst.has(r)&&!h.repeatDelay&&h.repeatType!=="mirror"&&h.damping!==0&&h.type!=="inertia"))return!1;let m=!1,y,x,w=!1;const T=()=>{x=new Promise(B=>{y=B})};T();let{keyframes:M,duration:I=300,ease:R,times:O}=h;if(Hst(r,h)){const B=sx({...h,repeat:0,delay:0});let H={done:!1,value:M[0]};const K=[];let at=0;for(;!H.done&&at<Wst;)H=B.sample(at),K.push(H.value),at+=v0;O=void 0,M=K,I=at-v0,R="linear"}const N=est(e.owner.current,r,M,{...h,duration:I,ease:R,times:O}),G=()=>{w=!1,N.cancel()},$=()=>{w=!0,ii.update(G),y(),T()};return N.onfinish=()=>{w||(e.set(nst(M,h)),a&&a(),$())},{then(B,H){return x.then(B,H)},attachTimeline(B){return N.timeline=B,N.onfinish=null,Si},get time(){return Ol(N.currentTime||0)},set time(B){N.currentTime=gh(B)},get speed(){return N.playbackRate},set speed(B){N.playbackRate=B},get duration(){return Ol(I)},play:()=>{m||(N.play(),jl(G))},pause:()=>N.pause(),stop:()=>{if(m=!0,N.playState==="idle")return;const{currentTime:B}=N;if(B){const H=sx({...h,autoplay:!1});e.setWithVelocity(H.sample(B-v0).value,H.sample(B).value,v0)}$()},complete:()=>{w||N.finish()},cancel:$}}function Zst({keyframes:e,delay:r,onUpdate:s,onComplete:a}){const h=()=>(s&&s(e[e.length-1]),a&&a(),{time:0,speed:1,duration:0,play:Si,pause:Si,stop:Si,then:f=>(f(),Promise.resolve()),cancel:Si,complete:Si});return r?sx({keyframes:[0,1],duration:0,delay:r,onComplete:h}):h()}const Xst={type:"spring",stiffness:500,damping:25,restSpeed:10},Yst=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),Kst={type:"keyframes",duration:.8},Jst={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Qst=(e,{keyframes:r})=>r.length>2?Kst:Lh.has(e)?e.startsWith("scale")?Yst(r[1]):Xst:Jst,bM=(e,r)=>e==="zIndex"?!1:!!(typeof r=="number"||Array.isArray(r)||typeof r=="string"&&(uu.test(r)||r==="0")&&!r.startsWith("url(")),tot=new Set(["brightness","contrast","saturate","opacity"]);function eot(e){const[r,s]=e.slice(0,-1).split("(");if(r==="drop-shadow")return e;const[a]=s.match(r1)||[];if(!a)return e;const h=s.replace(a,"");let f=tot.has(r)?1:0;return a!==s&&(f*=100),r+"("+f+h+")"}const not=/([a-z-]*)\(.*?\)/g,wM={...uu,getAnimatableNone:e=>{const r=e.match(not);return r?r.map(eot).join(" "):e}},rot={...qV,color:Ss,backgroundColor:Ss,outlineColor:Ss,fill:Ss,stroke:Ss,borderColor:Ss,borderTopColor:Ss,borderRightColor:Ss,borderBottomColor:Ss,borderLeftColor:Ss,filter:wM,WebkitFilter:wM},ZC=e=>rot[e];function RU(e,r){let s=ZC(e);return s!==wM&&(s=uu),s.getAnimatableNone?s.getAnimatableNone(r):void 0}const OU=e=>/^0[^.\s]+$/.test(e);function iot(e){if(typeof e=="number")return e===0;if(e!==null)return e==="none"||e==="0"||OU(e)}function sot(e,r,s,a){const h=bM(r,s);let f;Array.isArray(s)?f=[...s]:f=[null,s];const m=a.from!==void 0?a.from:e.get();let y;const x=[];for(let w=0;w<f.length;w++)f[w]===null&&(f[w]=w===0?m:f[w-1]),iot(f[w])&&x.push(w),typeof f[w]=="string"&&f[w]!=="none"&&f[w]!=="0"&&(y=f[w]);if(h&&x.length&&y)for(let w=0;w<x.length;w++){const T=x[w];f[T]=RU(r,y)}return f}function oot({when:e,delay:r,delayChildren:s,staggerChildren:a,staggerDirection:h,repeat:f,repeatType:m,repeatDelay:y,from:x,elapsed:w,...T}){return!!Object.keys(T).length}function XC(e,r){return e[r]||e.default||e}const YC=(e,r,s,a={})=>h=>{const f=XC(a,e)||{},m=f.delay||a.delay||0;let{elapsed:y=0}=a;y=y-gh(m);const x=sot(r,e,s,f),w=x[0],T=x[x.length-1],M=bM(e,w),I=bM(e,T);let R={keyframes:x,velocity:r.getVelocity(),ease:"easeOut",...f,delay:-y,onUpdate:O=>{r.set(O),f.onUpdate&&f.onUpdate(O)},onComplete:()=>{h(),f.onComplete&&f.onComplete()}};if(oot(f)||(R={...R,...Qst(e,R)}),R.duration&&(R.duration=gh(R.duration)),R.repeatDelay&&(R.repeatDelay=gh(R.repeatDelay)),!M||!I||tst.current||f.type===!1||FV.skipAnimations)return Zst(R);if(!a.isHandoff&&r.owner&&r.owner.current instanceof HTMLElement&&!r.owner.getProps().onUpdate){const O=qst(r,e,R);if(O)return O}return sx(R)};function ox(e){return!!(Zs(e)&&e.add)}const LU=e=>/^\-?\d*\.?\d+$/.test(e);function KC(e,r){e.indexOf(r)===-1&&e.push(r)}function JC(e,r){const s=e.indexOf(r);s>-1&&e.splice(s,1)}class QC{constructor(){this.subscriptions=[]}add(r){return KC(this.subscriptions,r),()=>JC(this.subscriptions,r)}notify(r,s,a){const h=this.subscriptions.length;if(h)if(h===1)this.subscriptions[0](r,s,a);else for(let f=0;f<h;f++){const m=this.subscriptions[f];m&&m(r,s,a)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const E4=30,aot=e=>!isNaN(parseFloat(e));class lot{constructor(r,s={}){this.version="11.0.3",this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(a,h=!0)=>{const f=_h.now();this.updatedAt!==f&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(a),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),h&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(r),this.canTrackVelocity=aot(this.current),this.owner=s.owner}setCurrent(r){this.current=r,this.updatedAt=_h.now()}setPrevFrameValue(r=this.current){this.prevFrameValue=r,this.prevUpdatedAt=this.updatedAt}onChange(r){return this.on("change",r)}on(r,s){this.events[r]||(this.events[r]=new QC);const a=this.events[r].add(s);return r==="change"?()=>{a(),ii.read(()=>{this.events.change.getSize()||this.stop()})}:a}clearListeners(){for(const r in this.events)this.events[r].clear()}attach(r,s){this.passiveEffect=r,this.stopPassiveEffect=s}set(r,s=!0){!s||!this.passiveEffect?this.updateAndNotify(r,s):this.passiveEffect(r,this.updateAndNotify)}setWithVelocity(r,s,a){this.set(s),this.prev=void 0,this.prevFrameValue=r,this.prevUpdatedAt=this.updatedAt-a}jump(r){this.updateAndNotify(r),this.prev=r,this.prevUpdatedAt=this.prevFrameValue=void 0,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const r=_h.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||r-this.updatedAt>E4)return 0;const s=Math.min(this.updatedAt-this.prevUpdatedAt,E4);return IU(parseFloat(this.current)-parseFloat(this.prevFrameValue),s)}start(r){return this.stop(),new Promise(s=>{this.hasAnimated=!0,this.animation=r(s),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function mf(e,r){return new lot(e,r)}const zU=e=>r=>r.test(e),cot={test:e=>e==="auto",parse:e=>e},NU=[zh,wn,Ha,Ic,yit,_it,cot],Xp=e=>NU.find(zU(e)),uot=[...NU,Ss,uu],hot=e=>uot.find(zU(e));function dot(e,r,s){e.hasValue(r)?e.getValue(r).set(s):e.addValue(r,mf(s))}function fot(e,r){const s=s1(e,r);let{transitionEnd:a={},transition:h={},...f}=s?e.makeTargetAnimatable(s,!1):{};f={...f,...a};for(const m in f){const y=Rit(f[m]);dot(e,m,y)}}function pot(e,r,s){var a,h;const f=Object.keys(r).filter(y=>!e.hasValue(y)),m=f.length;if(m)for(let y=0;y<m;y++){const x=f[y],w=r[x];let T=null;Array.isArray(w)&&(T=w[0]),T===null&&(T=(h=(a=s[x])!==null&&a!==void 0?a:e.readValue(x))!==null&&h!==void 0?h:r[x]),T!=null&&(typeof T=="string"&&(LU(T)||OU(T))?T=parseFloat(T):!hot(T)&&uu.test(w)&&(T=RU(x,w)),e.addValue(x,mf(T,{owner:e})),s[x]===void 0&&(s[x]=T),T!==null&&e.setBaseTarget(x,T))}}function mot(e,r){return r?(r[e]||r.default||r).from:void 0}function got(e,r,s){const a={};for(const h in e){const f=mot(h,r);if(f!==void 0)a[h]=f;else{const m=s.getValue(h);m&&(a[h]=m.get())}}return a}function _ot({protectedKeys:e,needsAnimating:r},s){const a=e.hasOwnProperty(s)&&r[s]!==!0;return r[s]=!1,a}function yot(e,r){const s=e.get();if(Array.isArray(r)){for(let a=0;a<r.length;a++)if(r[a]!==s)return!0}else return s!==r}function FU(e,r,{delay:s=0,transitionOverride:a,type:h}={}){let{transition:f=e.getDefaultTransition(),transitionEnd:m,...y}=e.makeTargetAnimatable(r);const x=e.getValue("willChange");a&&(f=a);const w=[],T=h&&e.animationState&&e.animationState.getState()[h];for(const M in y){const I=e.getValue(M),R=y[M];if(!I||R===void 0||T&&_ot(T,M))continue;const O={delay:s,elapsed:0,...XC(f||{},M)};if(window.HandoffAppearAnimations){const $=e.getProps()[NV];if($){const z=window.HandoffAppearAnimations($,M,I,ii);z!==null&&(O.elapsed=z,O.isHandoff=!0)}}let N=!O.isHandoff&&!yot(I,R);if(O.type==="spring"&&(I.getVelocity()||O.velocity)&&(N=!1),I.animation&&(N=!1),N)continue;I.start(YC(M,I,R,e.shouldReduceMotion&&Lh.has(M)?{type:!1}:O));const G=I.animation;ox(x)&&(x.add(M),G.then(()=>x.remove(M))),w.push(G)}return m&&Promise.all(w).then(()=>{m&&fot(e,m)}),w}function SM(e,r,s={}){const a=s1(e,r,s.custom);let{transition:h=e.getDefaultTransition()||{}}=a||{};s.transitionOverride&&(h=s.transitionOverride);const f=a?()=>Promise.all(FU(e,a,s)):()=>Promise.resolve(),m=e.variantChildren&&e.variantChildren.size?(x=0)=>{const{delayChildren:w=0,staggerChildren:T,staggerDirection:M}=h;return vot(e,r,w+x,T,M,s)}:()=>Promise.resolve(),{when:y}=h;if(y){const[x,w]=y==="beforeChildren"?[f,m]:[m,f];return x().then(()=>w())}else return Promise.all([f(),m(s.delay)])}function vot(e,r,s=0,a=0,h=1,f){const m=[],y=(e.variantChildren.size-1)*a,x=h===1?(w=0)=>w*a:(w=0)=>y-w*a;return Array.from(e.variantChildren).sort(xot).forEach((w,T)=>{w.notify("AnimationStart",r),m.push(SM(w,r,{...f,delay:s+x(T)}).then(()=>w.notify("AnimationComplete",r)))}),Promise.all(m)}function xot(e,r){return e.sortNodePosition(r)}function bot(e,r,s={}){e.notify("AnimationStart",r);let a;if(Array.isArray(r)){const h=r.map(f=>SM(e,f,s));a=Promise.all(h)}else if(typeof r=="string")a=SM(e,r,s);else{const h=typeof r=="function"?s1(e,r,s.custom):r;a=Promise.all(FU(e,h,s))}return a.then(()=>e.notify("AnimationComplete",r))}const wot=[...LC].reverse(),Sot=LC.length;function Tot(e){return r=>Promise.all(r.map(({animation:s,options:a})=>bot(e,s,a)))}function Eot(e){let r=Tot(e);const s=Aot();let a=!0;const h=(x,w)=>{const T=s1(e,w);if(T){const{transition:M,transitionEnd:I,...R}=T;x={...x,...R,...I}}return x};function f(x){r=x(e)}function m(x,w){const T=e.getProps(),M=e.getVariantContext(!0)||{},I=[],R=new Set;let O={},N=1/0;for(let $=0;$<Sot;$++){const z=wot[$],B=s[z],H=T[z]!==void 0?T[z]:M[z],K=ig(H),at=z===w?B.isActive:null;at===!1&&(N=$);let ft=H===M[z]&&H!==T[z]&&K;if(ft&&a&&e.manuallyAnimateOnMount&&(ft=!1),B.protectedKeys={...O},!B.isActive&&at===null||!H&&!B.prevProp||e1(H)||typeof H=="boolean")continue;let nt=Mot(B.prevProp,H)||z===w&&B.isActive&&!ft&&K||$>N&&K,W=!1;const Q=Array.isArray(H)?H:[H];let yt=Q.reduce(h,{});at===!1&&(yt={});const{prevResolvedValues:Pt={}}=B,st={...Pt,...yt},St=Rt=>{nt=!0,R.has(Rt)&&(W=!0,R.delete(Rt)),B.needsAnimating[Rt]=!0};for(const Rt in st){const Zt=yt[Rt],Ft=Pt[Rt];if(O.hasOwnProperty(Rt))continue;let $t=!1;nx(Zt)&&nx(Ft)?$t=!aU(Zt,Ft):$t=Zt!==Ft,$t?Zt!==void 0?St(Rt):R.add(Rt):Zt!==void 0&&R.has(Rt)?St(Rt):B.protectedKeys[Rt]=!0}B.prevProp=H,B.prevResolvedValues=yt,B.isActive&&(O={...O,...yt}),a&&e.blockInitialAnimation&&(nt=!1),nt&&(!ft||W)&&I.push(...Q.map(Rt=>({animation:Rt,options:{type:z,...x}})))}if(R.size){const $={};R.forEach(z=>{const B=e.getBaseTarget(z);B!==void 0&&($[z]=B)}),I.push({animation:$})}let G=!!I.length;return a&&(T.initial===!1||T.initial===T.animate)&&!e.manuallyAnimateOnMount&&(G=!1),a=!1,G?r(I):Promise.resolve()}function y(x,w,T){var M;if(s[x].isActive===w)return Promise.resolve();(M=e.variantChildren)===null||M===void 0||M.forEach(R=>{var O;return(O=R.animationState)===null||O===void 0?void 0:O.setActive(x,w)}),s[x].isActive=w;const I=m(T,x);for(const R in s)s[R].protectedKeys={};return I}return{animateChanges:m,setActive:y,setAnimateFunction:f,getState:()=>s}}function Mot(e,r){return typeof r=="string"?r!==e:Array.isArray(r)?!aU(r,e):!1}function Xu(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function Aot(){return{animate:Xu(!0),whileInView:Xu(),whileHover:Xu(),whileTap:Xu(),whileDrag:Xu(),whileFocus:Xu(),exit:Xu()}}class Cot extends yu{constructor(r){super(r),r.animationState||(r.animationState=Eot(r))}updateAnimationControlsSubscription(){const{animate:r}=this.node.getProps();this.unmount(),e1(r)&&(this.unmount=r.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:r}=this.node.getProps(),{animate:s}=this.node.prevProps||{};r!==s&&this.updateAnimationControlsSubscription()}unmount(){}}let Pot=0;class Iot extends yu{constructor(){super(...arguments),this.id=Pot++}update(){if(!this.node.presenceContext)return;const{isPresent:r,onExitComplete:s,custom:a}=this.node.presenceContext,{isPresent:h}=this.node.prevPresenceContext||{};if(!this.node.animationState||r===h)return;const f=this.node.animationState.setActive("exit",!r,{custom:a??this.node.getProps().custom});s&&!r&&f.then(()=>s(this.id))}mount(){const{register:r}=this.node.presenceContext||{};r&&(this.unmount=r(this.id))}unmount(){}}const kot={animation:{Feature:Cot},exit:{Feature:Iot}},M4=(e,r)=>Math.abs(e-r);function Dot(e,r){const s=M4(e.x,r.x),a=M4(e.y,r.y);return Math.sqrt(s**2+a**2)}class BU{constructor(r,s,{transformPagePoint:a,contextWindow:h,dragSnapToOrigin:f=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const M=NT(this.lastMoveEventInfo,this.history),I=this.startEvent!==null,R=Dot(M.offset,{x:0,y:0})>=3;if(!I&&!R)return;const{point:O}=M,{timestamp:N}=Ji;this.history.push({...O,timestamp:N});const{onStart:G,onMove:$}=this.handlers;I||(G&&G(this.lastMoveEvent,M),this.startEvent=this.lastMoveEvent),$&&$(this.lastMoveEvent,M)},this.handlePointerMove=(M,I)=>{this.lastMoveEvent=M,this.lastMoveEventInfo=zT(I,this.transformPagePoint),ii.update(this.updatePoint,!0)},this.handlePointerUp=(M,I)=>{this.end();const{onEnd:R,onSessionEnd:O,resumeAnimation:N}=this.handlers;if(this.dragSnapToOrigin&&N&&N(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const G=NT(M.type==="pointercancel"?this.lastMoveEventInfo:zT(I,this.transformPagePoint),this.history);this.startEvent&&R&&R(M,G),O&&O(M,G)},!nU(r))return;this.dragSnapToOrigin=f,this.handlers=s,this.transformPagePoint=a,this.contextWindow=h||window;const m=i1(r),y=zT(m,this.transformPagePoint),{point:x}=y,{timestamp:w}=Ji;this.history=[{...x,timestamp:w}];const{onSessionStart:T}=s;T&&T(r,NT(y,this.history)),this.removeListeners=nu(Rl(this.contextWindow,"pointermove",this.handlePointerMove),Rl(this.contextWindow,"pointerup",this.handlePointerUp),Rl(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(r){this.handlers=r}end(){this.removeListeners&&this.removeListeners(),jl(this.updatePoint)}}function zT(e,r){return r?{point:r(e.point)}:e}function A4(e,r){return{x:e.x-r.x,y:e.y-r.y}}function NT({point:e},r){return{point:e,delta:A4(e,jU(r)),offset:A4(e,Rot(r)),velocity:Oot(r,.1)}}function Rot(e){return e[0]}function jU(e){return e[e.length-1]}function Oot(e,r){if(e.length<2)return{x:0,y:0};let s=e.length-1,a=null;const h=jU(e);for(;s>=0&&(a=e[s],!(h.timestamp-a.timestamp>gh(r)));)s--;if(!a)return{x:0,y:0};const f=Ol(h.timestamp-a.timestamp);if(f===0)return{x:0,y:0};const m={x:(h.x-a.x)/f,y:(h.y-a.y)/f};return m.x===1/0&&(m.x=0),m.y===1/0&&(m.y=0),m}function po(e){return e.max-e.min}function TM(e,r=0,s=.01){return Math.abs(e-r)<=s}function C4(e,r,s,a=.5){e.origin=a,e.originPoint=ri(r.min,r.max,e.origin),e.scale=po(s)/po(r),(TM(e.scale,1,1e-4)||isNaN(e.scale))&&(e.scale=1),e.translate=ri(s.min,s.max,e.origin)-e.originPoint,(TM(e.translate)||isNaN(e.translate))&&(e.translate=0)}function Pm(e,r,s,a){C4(e.x,r.x,s.x,a?a.originX:void 0),C4(e.y,r.y,s.y,a?a.originY:void 0)}function P4(e,r,s){e.min=s.min+r.min,e.max=e.min+po(r)}function Lot(e,r,s){P4(e.x,r.x,s.x),P4(e.y,r.y,s.y)}function I4(e,r,s){e.min=r.min-s.min,e.max=e.min+po(r)}function Im(e,r,s){I4(e.x,r.x,s.x),I4(e.y,r.y,s.y)}function zot(e,{min:r,max:s},a){return r!==void 0&&e<r?e=a?ri(r,e,a.min):Math.max(e,r):s!==void 0&&e>s&&(e=a?ri(s,e,a.max):Math.min(e,s)),e}function k4(e,r,s){return{min:r!==void 0?e.min+r:void 0,max:s!==void 0?e.max+s-(e.max-e.min):void 0}}function Not(e,{top:r,left:s,bottom:a,right:h}){return{x:k4(e.x,s,h),y:k4(e.y,r,a)}}function D4(e,r){let s=r.min-e.min,a=r.max-e.max;return r.max-r.min<e.max-e.min&&([s,a]=[a,s]),{min:s,max:a}}function Fot(e,r){return{x:D4(e.x,r.x),y:D4(e.y,r.y)}}function Bot(e,r){let s=.5;const a=po(e),h=po(r);return h>a?s=og(r.min,r.max-a,e.min):a>h&&(s=og(e.min,e.max-h,r.min)),cu(0,1,s)}function jot(e,r){const s={};return r.min!==void 0&&(s.min=r.min-e.min),r.max!==void 0&&(s.max=r.max-e.min),s}const EM=.35;function Vot(e=EM){return e===!1?e=0:e===!0&&(e=EM),{x:R4(e,"left","right"),y:R4(e,"top","bottom")}}function R4(e,r,s){return{min:O4(e,r),max:O4(e,s)}}function O4(e,r){return typeof e=="number"?e:e[r]||0}const L4=()=>({translate:0,scale:1,origin:0,originPoint:0}),Jd=()=>({x:L4(),y:L4()}),z4=()=>({min:0,max:0}),bi=()=>({x:z4(),y:z4()});function Ro(e){return[e("x"),e("y")]}function VU({top:e,left:r,right:s,bottom:a}){return{x:{min:r,max:s},y:{min:e,max:a}}}function Uot({x:e,y:r}){return{top:r.min,right:e.max,bottom:r.max,left:e.min}}function $ot(e,r){if(!r)return e;const s=r({x:e.left,y:e.top}),a=r({x:e.right,y:e.bottom});return{top:s.y,left:s.x,bottom:a.y,right:a.x}}function FT(e){return e===void 0||e===1}function MM({scale:e,scaleX:r,scaleY:s}){return!FT(e)||!FT(r)||!FT(s)}function nh(e){return MM(e)||UU(e)||e.z||e.rotate||e.rotateX||e.rotateY}function UU(e){return N4(e.x)||N4(e.y)}function N4(e){return e&&e!=="0%"}function ax(e,r,s){const a=e-s,h=r*a;return s+h}function F4(e,r,s,a,h){return h!==void 0&&(e=ax(e,h,a)),ax(e,s,a)+r}function AM(e,r=0,s=1,a,h){e.min=F4(e.min,r,s,a,h),e.max=F4(e.max,r,s,a,h)}function $U(e,{x:r,y:s}){AM(e.x,r.translate,r.scale,r.originPoint),AM(e.y,s.translate,s.scale,s.originPoint)}function Got(e,r,s,a=!1){const h=s.length;if(!h)return;r.x=r.y=1;let f,m;for(let y=0;y<h;y++){f=s[y],m=f.projectionDelta;const x=f.instance;x&&x.style&&x.style.display==="contents"||(a&&f.options.layoutScroll&&f.scroll&&f!==f.root&&Qd(e,{x:-f.scroll.offset.x,y:-f.scroll.offset.y}),m&&(r.x*=m.x.scale,r.y*=m.y.scale,$U(e,m)),a&&nh(f.latestValues)&&Qd(e,f.latestValues))}r.x=B4(r.x),r.y=B4(r.y)}function B4(e){return Number.isInteger(e)||e>1.0000000000001||e<.999999999999?e:1}function Rc(e,r){e.min=e.min+r,e.max=e.max+r}function j4(e,r,[s,a,h]){const f=r[h]!==void 0?r[h]:.5,m=ri(e.min,e.max,f);AM(e,r[s],r[a],m,r.scale)}const Wot=["x","scaleX","originX"],Hot=["y","scaleY","originY"];function Qd(e,r){j4(e.x,r,Wot),j4(e.y,r,Hot)}function GU(e,r){return VU($ot(e.getBoundingClientRect(),r))}function qot(e,r,s){const a=GU(e,s),{scroll:h}=r;return h&&(Rc(a.x,h.offset.x),Rc(a.y,h.offset.y)),a}const WU=({current:e})=>e?e.ownerDocument.defaultView:null,Zot=new WeakMap;class Xot{constructor(r){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=bi(),this.visualElement=r}start(r,{snapToCursor:s=!1}={}){const{presenceContext:a}=this.visualElement;if(a&&a.isPresent===!1)return;const h=T=>{const{dragSnapToOrigin:M}=this.getProps();M?this.pauseAnimation():this.stopAnimation(),s&&this.snapToCursor(i1(T,"page").point)},f=(T,M)=>{const{drag:I,dragPropagation:R,onDragStart:O}=this.getProps();if(I&&!R&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=iU(I),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Ro(G=>{let $=this.getAxisMotionValue(G).get()||0;if(Ha.test($)){const{projection:z}=this.visualElement;if(z&&z.layout){const B=z.layout.layoutBox[G];B&&($=po(B)*(parseFloat($)/100))}}this.originPoint[G]=$}),O&&ii.update(()=>O(T,M),!1,!0);const{animationState:N}=this.visualElement;N&&N.setActive("whileDrag",!0)},m=(T,M)=>{const{dragPropagation:I,dragDirectionLock:R,onDirectionLock:O,onDrag:N}=this.getProps();if(!I&&!this.openGlobalLock)return;const{offset:G}=M;if(R&&this.currentDirection===null){this.currentDirection=Yot(G),this.currentDirection!==null&&O&&O(this.currentDirection);return}this.updateAxis("x",M.point,G),this.updateAxis("y",M.point,G),this.visualElement.render(),N&&N(T,M)},y=(T,M)=>this.stop(T,M),x=()=>Ro(T=>{var M;return this.getAnimationState(T)==="paused"&&((M=this.getAxisMotionValue(T).animation)===null||M===void 0?void 0:M.play())}),{dragSnapToOrigin:w}=this.getProps();this.panSession=new BU(r,{onSessionStart:h,onStart:f,onMove:m,onSessionEnd:y,resumeAnimation:x},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:w,contextWindow:WU(this.visualElement)})}stop(r,s){const a=this.isDragging;if(this.cancel(),!a)return;const{velocity:h}=s;this.startAnimation(h);const{onDragEnd:f}=this.getProps();f&&ii.update(()=>f(r,s))}cancel(){this.isDragging=!1;const{projection:r,animationState:s}=this.visualElement;r&&(r.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:a}=this.getProps();!a&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),s&&s.setActive("whileDrag",!1)}updateAxis(r,s,a){const{drag:h}=this.getProps();if(!a||!x0(r,h,this.currentDirection))return;const f=this.getAxisMotionValue(r);let m=this.originPoint[r]+a[r];this.constraints&&this.constraints[r]&&(m=zot(m,this.constraints[r],this.elastic[r])),f.set(m)}resolveConstraints(){var r;const{dragConstraints:s,dragElastic:a}=this.getProps(),h=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(r=this.visualElement.projection)===null||r===void 0?void 0:r.layout,f=this.constraints;s&&Yd(s)?this.constraints||(this.constraints=this.resolveRefConstraints()):s&&h?this.constraints=Not(h.layoutBox,s):this.constraints=!1,this.elastic=Vot(a),f!==this.constraints&&h&&this.constraints&&!this.hasMutatedConstraints&&Ro(m=>{this.getAxisMotionValue(m)&&(this.constraints[m]=jot(h.layoutBox[m],this.constraints[m]))})}resolveRefConstraints(){const{dragConstraints:r,onMeasureDragConstraints:s}=this.getProps();if(!r||!Yd(r))return!1;const a=r.current,{projection:h}=this.visualElement;if(!h||!h.layout)return!1;const f=qot(a,h.root,this.visualElement.getTransformPagePoint());let m=Fot(h.layout.layoutBox,f);if(s){const y=s(Uot(m));this.hasMutatedConstraints=!!y,y&&(m=VU(y))}return m}startAnimation(r){const{drag:s,dragMomentum:a,dragElastic:h,dragTransition:f,dragSnapToOrigin:m,onDragTransitionEnd:y}=this.getProps(),x=this.constraints||{},w=Ro(T=>{if(!x0(T,s,this.currentDirection))return;let M=x&&x[T]||{};m&&(M={min:0,max:0});const I=h?200:1e6,R=h?40:1e7,O={type:"inertia",velocity:a?r[T]:0,bounceStiffness:I,bounceDamping:R,timeConstant:750,restDelta:1,restSpeed:10,...f,...M};return this.startAxisValueAnimation(T,O)});return Promise.all(w).then(y)}startAxisValueAnimation(r,s){const a=this.getAxisMotionValue(r);return a.start(YC(r,a,0,s))}stopAnimation(){Ro(r=>this.getAxisMotionValue(r).stop())}pauseAnimation(){Ro(r=>{var s;return(s=this.getAxisMotionValue(r).animation)===null||s===void 0?void 0:s.pause()})}getAnimationState(r){var s;return(s=this.getAxisMotionValue(r).animation)===null||s===void 0?void 0:s.state}getAxisMotionValue(r){const s="_drag"+r.toUpperCase(),a=this.visualElement.getProps(),h=a[s];return h||this.visualElement.getValue(r,(a.initial?a.initial[r]:void 0)||0)}snapToCursor(r){Ro(s=>{const{drag:a}=this.getProps();if(!x0(s,a,this.currentDirection))return;const{projection:h}=this.visualElement,f=this.getAxisMotionValue(s);if(h&&h.layout){const{min:m,max:y}=h.layout.layoutBox[s];f.set(r[s]-ri(m,y,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:r,dragConstraints:s}=this.getProps(),{projection:a}=this.visualElement;if(!Yd(s)||!a||!this.constraints)return;this.stopAnimation();const h={x:0,y:0};Ro(m=>{const y=this.getAxisMotionValue(m);if(y){const x=y.get();h[m]=Bot({min:x,max:x},this.constraints[m])}});const{transformTemplate:f}=this.visualElement.getProps();this.visualElement.current.style.transform=f?f({},""):"none",a.root&&a.root.updateScroll(),a.updateLayout(),this.resolveConstraints(),Ro(m=>{if(!x0(m,r,null))return;const y=this.getAxisMotionValue(m),{min:x,max:w}=this.constraints[m];y.set(ri(x,w,h[m]))})}addListeners(){if(!this.visualElement.current)return;Zot.set(this.visualElement,this);const r=this.visualElement.current,s=Rl(r,"pointerdown",x=>{const{drag:w,dragListener:T=!0}=this.getProps();w&&T&&this.start(x)}),a=()=>{const{dragConstraints:x}=this.getProps();Yd(x)&&(this.constraints=this.resolveRefConstraints())},{projection:h}=this.visualElement,f=h.addEventListener("measure",a);h&&!h.layout&&(h.root&&h.root.updateScroll(),h.updateLayout()),a();const m=Al(window,"resize",()=>this.scalePositionWithinConstraints()),y=h.addEventListener("didUpdate",({delta:x,hasLayoutChanged:w})=>{this.isDragging&&w&&(Ro(T=>{const M=this.getAxisMotionValue(T);M&&(this.originPoint[T]+=x[T].translate,M.set(M.get()+x[T].translate))}),this.visualElement.render())});return()=>{m(),s(),f(),y&&y()}}getProps(){const r=this.visualElement.getProps(),{drag:s=!1,dragDirectionLock:a=!1,dragPropagation:h=!1,dragConstraints:f=!1,dragElastic:m=EM,dragMomentum:y=!0}=r;return{...r,drag:s,dragDirectionLock:a,dragPropagation:h,dragConstraints:f,dragElastic:m,dragMomentum:y}}}function x0(e,r,s){return(r===!0||r===e)&&(s===null||s===e)}function Yot(e,r=10){let s=null;return Math.abs(e.y)>r?s="y":Math.abs(e.x)>r&&(s="x"),s}class Kot extends yu{constructor(r){super(r),this.removeGroupControls=Si,this.removeListeners=Si,this.controls=new Xot(r)}mount(){const{dragControls:r}=this.node.getProps();r&&(this.removeGroupControls=r.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Si}unmount(){this.removeGroupControls(),this.removeListeners()}}const V4=e=>(r,s)=>{e&&ii.update(()=>e(r,s))};class Jot extends yu{constructor(){super(...arguments),this.removePointerDownListener=Si}onPointerDown(r){this.session=new BU(r,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:WU(this.node)})}createPanHandlers(){const{onPanSessionStart:r,onPanStart:s,onPan:a,onPanEnd:h}=this.node.getProps();return{onSessionStart:V4(r),onStart:V4(s),onMove:a,onEnd:(f,m)=>{delete this.session,h&&ii.update(()=>h(f,m))}}}mount(){this.removePointerDownListener=Rl(this.node.current,"pointerdown",r=>this.onPointerDown(r))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function Qot(){const e=Y.useContext(DC);if(e===null)return[!0,null];const{isPresent:r,onExitComplete:s,register:a}=e,h=Y.useId();return Y.useEffect(()=>a(h),[]),!r&&s?[!1,()=>s&&s(h)]:[!0]}const iv={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function U4(e,r){return r.max===r.min?0:e/(r.max-r.min)*100}const Yp={correct:(e,r)=>{if(!r.target)return e;if(typeof e=="string")if(wn.test(e))e=parseFloat(e);else return e;const s=U4(e,r.target.x),a=U4(e,r.target.y);return`${s}% ${a}%`}},tat={correct:(e,{treeScale:r,projectionDelta:s})=>{const a=e,h=uu.parse(e);if(h.length>5)return a;const f=uu.createTransformer(e),m=typeof h[0]!="number"?1:0,y=s.x.scale*r.x,x=s.y.scale*r.y;h[0+m]/=y,h[1+m]/=x;const w=ri(y,x,.5);return typeof h[2+m]=="number"&&(h[2+m]/=w),typeof h[3+m]=="number"&&(h[3+m]/=w),f(h)}};class eat extends we.Component{componentDidMount(){const{visualElement:r,layoutGroup:s,switchLayoutGroup:a,layoutId:h}=this.props,{projection:f}=r;uit(nat),f&&(s.group&&s.group.add(f),a&&a.register&&h&&a.register(f),f.root.didUpdate(),f.addEventListener("animationComplete",()=>{this.safeToRemove()}),f.setOptions({...f.options,onExitComplete:()=>this.safeToRemove()})),iv.hasEverUpdated=!0}getSnapshotBeforeUpdate(r){const{layoutDependency:s,visualElement:a,drag:h,isPresent:f}=this.props,m=a.projection;return m&&(m.isPresent=f,h||r.layoutDependency!==s||s===void 0?m.willUpdate():this.safeToRemove(),r.isPresent!==f&&(f?m.promote():m.relegate()||ii.postRender(()=>{const y=m.getStack();(!y||!y.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:r}=this.props.visualElement;r&&(r.root.didUpdate(),OC.postRender(()=>{!r.currentAnimation&&r.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:r,layoutGroup:s,switchLayoutGroup:a}=this.props,{projection:h}=r;h&&(h.scheduleCheckAfterUnmount(),s&&s.group&&s.group.remove(h),a&&a.deregister&&a.deregister(h))}safeToRemove(){const{safeToRemove:r}=this.props;r&&r()}render(){return null}}function HU(e){const[r,s]=Qot(),a=Y.useContext(VV);return we.createElement(eat,{...e,layoutGroup:a,switchLayoutGroup:Y.useContext(UV),isPresent:r,safeToRemove:s})}const nat={borderRadius:{...Yp,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Yp,borderTopRightRadius:Yp,borderBottomLeftRadius:Yp,borderBottomRightRadius:Yp,boxShadow:tat},qU=["TopLeft","TopRight","BottomLeft","BottomRight"],rat=qU.length,$4=e=>typeof e=="string"?parseFloat(e):e,G4=e=>typeof e=="number"||wn.test(e);function iat(e,r,s,a,h,f){h?(e.opacity=ri(0,s.opacity!==void 0?s.opacity:1,sat(a)),e.opacityExit=ri(r.opacity!==void 0?r.opacity:1,0,oat(a))):f&&(e.opacity=ri(r.opacity!==void 0?r.opacity:1,s.opacity!==void 0?s.opacity:1,a));for(let m=0;m<rat;m++){const y=`border${qU[m]}Radius`;let x=W4(r,y),w=W4(s,y);if(x===void 0&&w===void 0)continue;x||(x=0),w||(w=0),x===0||w===0||G4(x)===G4(w)?(e[y]=Math.max(ri($4(x),$4(w),a),0),(Ha.test(w)||Ha.test(x))&&(e[y]+="%")):e[y]=w}(r.rotate||s.rotate)&&(e.rotate=ri(r.rotate||0,s.rotate||0,a))}function W4(e,r){return e[r]!==void 0?e[r]:e.borderRadius}const sat=ZU(0,.5,gU),oat=ZU(.5,.95,Si);function ZU(e,r,s){return a=>a<e?0:a>r?1:s(og(e,r,a))}function H4(e,r){e.min=r.min,e.max=r.max}function ko(e,r){H4(e.x,r.x),H4(e.y,r.y)}function q4(e,r,s,a,h){return e-=r,e=ax(e,1/s,a),h!==void 0&&(e=ax(e,1/h,a)),e}function aat(e,r=0,s=1,a=.5,h,f=e,m=e){if(Ha.test(r)&&(r=parseFloat(r),r=ri(m.min,m.max,r/100)-m.min),typeof r!="number")return;let y=ri(f.min,f.max,a);e===f&&(y-=r),e.min=q4(e.min,r,s,y,h),e.max=q4(e.max,r,s,y,h)}function Z4(e,r,[s,a,h],f,m){aat(e,r[s],r[a],r[h],r.scale,f,m)}const lat=["x","scaleX","originX"],cat=["y","scaleY","originY"];function X4(e,r,s,a){Z4(e.x,r,lat,s?s.x:void 0,a?a.x:void 0),Z4(e.y,r,cat,s?s.y:void 0,a?a.y:void 0)}function Y4(e){return e.translate===0&&e.scale===1}function XU(e){return Y4(e.x)&&Y4(e.y)}function uat(e,r){return e.x.min===r.x.min&&e.x.max===r.x.max&&e.y.min===r.y.min&&e.y.max===r.y.max}function YU(e,r){return Math.round(e.x.min)===Math.round(r.x.min)&&Math.round(e.x.max)===Math.round(r.x.max)&&Math.round(e.y.min)===Math.round(r.y.min)&&Math.round(e.y.max)===Math.round(r.y.max)}function K4(e){return po(e.x)/po(e.y)}class hat{constructor(){this.members=[]}add(r){KC(this.members,r),r.scheduleRender()}remove(r){if(JC(this.members,r),r===this.prevLead&&(this.prevLead=void 0),r===this.lead){const s=this.members[this.members.length-1];s&&this.promote(s)}}relegate(r){const s=this.members.findIndex(h=>r===h);if(s===0)return!1;let a;for(let h=s;h>=0;h--){const f=this.members[h];if(f.isPresent!==!1){a=f;break}}return a?(this.promote(a),!0):!1}promote(r,s){const a=this.lead;if(r!==a&&(this.prevLead=a,this.lead=r,r.show(),a)){a.instance&&a.scheduleRender(),r.scheduleRender(),r.resumeFrom=a,s&&(r.resumeFrom.preserveOpacity=!0),a.snapshot&&(r.snapshot=a.snapshot,r.snapshot.latestValues=a.animationValues||a.latestValues),r.root&&r.root.isUpdating&&(r.isLayoutDirty=!0);const{crossfade:h}=r.options;h===!1&&a.hide()}}exitAnimationComplete(){this.members.forEach(r=>{const{options:s,resumingFrom:a}=r;s.onExitComplete&&s.onExitComplete(),a&&a.options.onExitComplete&&a.options.onExitComplete()})}scheduleRender(){this.members.forEach(r=>{r.instance&&r.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function J4(e,r,s){let a="";const h=e.x.translate/r.x,f=e.y.translate/r.y;if((h||f)&&(a=`translate3d(${h}px, ${f}px, 0) `),(r.x!==1||r.y!==1)&&(a+=`scale(${1/r.x}, ${1/r.y}) `),s){const{rotate:x,rotateX:w,rotateY:T}=s;x&&(a+=`rotate(${x}deg) `),w&&(a+=`rotateX(${w}deg) `),T&&(a+=`rotateY(${T}deg) `)}const m=e.x.scale*r.x,y=e.y.scale*r.y;return(m!==1||y!==1)&&(a+=`scale(${m}, ${y})`),a||"none"}const dat=(e,r)=>e.depth-r.depth;class fat{constructor(){this.children=[],this.isDirty=!1}add(r){KC(this.children,r),this.isDirty=!0}remove(r){JC(this.children,r),this.isDirty=!0}forEach(r){this.isDirty&&this.children.sort(dat),this.isDirty=!1,this.children.forEach(r)}}function pat(e,r){const s=_h.now(),a=({timestamp:h})=>{const f=h-s;f>=r&&(jl(a),e(f-r))};return ii.read(a,!0),()=>jl(a)}function mat(e){window.MotionDebug&&window.MotionDebug.record(e)}function gat(e){return e instanceof SVGElement&&e.tagName!=="svg"}function _at(e,r,s){const a=Zs(e)?e:mf(e);return a.start(YC("",a,r,s)),a.animation}const Q4=["","X","Y","Z"],yat={visibility:"hidden"},tN=1e3;let vat=0;const rh={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function KU({attachResizeListener:e,defaultParent:r,measureScroll:s,checkIsScrollRoot:a,resetTransform:h}){return class{constructor(m={},y=r==null?void 0:r()){this.id=vat++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,rh.totalNodes=rh.resolvedTargetDeltas=rh.recalculatedProjection=0,this.nodes.forEach(wat),this.nodes.forEach(Aat),this.nodes.forEach(Cat),this.nodes.forEach(Sat),mat(rh)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=m,this.root=y?y.root||y:this,this.path=y?[...y.path,y]:[],this.parent=y,this.depth=y?y.depth+1:0;for(let x=0;x<this.path.length;x++)this.path[x].shouldResetTransform=!0;this.root===this&&(this.nodes=new fat)}addEventListener(m,y){return this.eventHandlers.has(m)||this.eventHandlers.set(m,new QC),this.eventHandlers.get(m).add(y)}notifyListeners(m,...y){const x=this.eventHandlers.get(m);x&&x.notify(...y)}hasListeners(m){return this.eventHandlers.has(m)}mount(m,y=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=gat(m),this.instance=m;const{layoutId:x,layout:w,visualElement:T}=this.options;if(T&&!T.current&&T.mount(m),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),y&&(w||x)&&(this.isLayoutDirty=!0),e){let M;const I=()=>this.root.updateBlockedByResize=!1;e(m,()=>{this.root.updateBlockedByResize=!0,M&&M(),M=pat(I,250),iv.hasAnimatedSinceResize&&(iv.hasAnimatedSinceResize=!1,this.nodes.forEach(nN))})}x&&this.root.registerSharedNode(x,this),this.options.animate!==!1&&T&&(x||w)&&this.addEventListener("didUpdate",({delta:M,hasLayoutChanged:I,hasRelativeTargetChanged:R,layout:O})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const N=this.options.transition||T.getDefaultTransition()||Rat,{onLayoutAnimationStart:G,onLayoutAnimationComplete:$}=T.getProps(),z=!this.targetLayout||!YU(this.targetLayout,O)||R,B=!I&&R;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||B||I&&(z||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(M,B);const H={...XC(N,"layout"),onPlay:G,onComplete:$};(T.shouldReduceMotion||this.options.layoutRoot)&&(H.delay=0,H.type=!1),this.startAnimation(H)}else I||nN(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=O})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const m=this.getStack();m&&m.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,jl(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Pat),this.animationId++)}getTransformTemplate(){const{visualElement:m}=this.options;return m&&m.getProps().transformTemplate}willUpdate(m=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let T=0;T<this.path.length;T++){const M=this.path[T];M.shouldResetTransform=!0,M.updateScroll("snapshot"),M.options.layoutRoot&&M.willUpdate(!1)}const{layoutId:y,layout:x}=this.options;if(y===void 0&&!x)return;const w=this.getTransformTemplate();this.prevTransformTemplateValue=w?w(this.latestValues,""):void 0,this.updateSnapshot(),m&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(eN);return}this.isUpdating||this.nodes.forEach(Eat),this.isUpdating=!1,this.nodes.forEach(Mat),this.nodes.forEach(xat),this.nodes.forEach(bat),this.clearAllSnapshots();const y=_h.now();Ji.delta=cu(0,1e3/60,y-Ji.timestamp),Ji.timestamp=y,Ji.isProcessing=!0,CT.update.process(Ji),CT.preRender.process(Ji),CT.render.process(Ji),Ji.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,OC.read(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(Tat),this.sharedNodes.forEach(Iat)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,ii.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){ii.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let x=0;x<this.path.length;x++)this.path[x].updateScroll();const m=this.layout;this.layout=this.measure(!1),this.layoutCorrected=bi(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:y}=this.options;y&&y.notify("LayoutMeasure",this.layout.layoutBox,m?m.layoutBox:void 0)}updateScroll(m="measure"){let y=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===m&&(y=!1),y&&(this.scroll={animationId:this.root.animationId,phase:m,isRoot:a(this.instance),offset:s(this.instance)})}resetTransform(){if(!h)return;const m=this.isLayoutDirty||this.shouldResetTransform,y=this.projectionDelta&&!XU(this.projectionDelta),x=this.getTransformTemplate(),w=x?x(this.latestValues,""):void 0,T=w!==this.prevTransformTemplateValue;m&&(y||nh(this.latestValues)||T)&&(h(this.instance,w),this.shouldResetTransform=!1,this.scheduleRender())}measure(m=!0){const y=this.measurePageBox();let x=this.removeElementScroll(y);return m&&(x=this.removeTransform(x)),Oat(x),{animationId:this.root.animationId,measuredBox:y,layoutBox:x,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:m}=this.options;if(!m)return bi();const y=m.measureViewportBox(),{scroll:x}=this.root;return x&&(Rc(y.x,x.offset.x),Rc(y.y,x.offset.y)),y}removeElementScroll(m){const y=bi();ko(y,m);for(let x=0;x<this.path.length;x++){const w=this.path[x],{scroll:T,options:M}=w;if(w!==this.root&&T&&M.layoutScroll){if(T.isRoot){ko(y,m);const{scroll:I}=this.root;I&&(Rc(y.x,-I.offset.x),Rc(y.y,-I.offset.y))}Rc(y.x,T.offset.x),Rc(y.y,T.offset.y)}}return y}applyTransform(m,y=!1){const x=bi();ko(x,m);for(let w=0;w<this.path.length;w++){const T=this.path[w];!y&&T.options.layoutScroll&&T.scroll&&T!==T.root&&Qd(x,{x:-T.scroll.offset.x,y:-T.scroll.offset.y}),nh(T.latestValues)&&Qd(x,T.latestValues)}return nh(this.latestValues)&&Qd(x,this.latestValues),x}removeTransform(m){const y=bi();ko(y,m);for(let x=0;x<this.path.length;x++){const w=this.path[x];if(!w.instance||!nh(w.latestValues))continue;MM(w.latestValues)&&w.updateSnapshot();const T=bi(),M=w.measurePageBox();ko(T,M),X4(y,w.latestValues,w.snapshot?w.snapshot.layoutBox:void 0,T)}return nh(this.latestValues)&&X4(y,this.latestValues),y}setTargetDelta(m){this.targetDelta=m,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(m){this.options={...this.options,...m,crossfade:m.crossfade!==void 0?m.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Ji.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(m=!1){var y;const x=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=x.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=x.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=x.isSharedProjectionDirty);const w=!!this.resumingFrom||this!==x;if(!(m||w&&this.isSharedProjectionDirty||this.isProjectionDirty||!((y=this.parent)===null||y===void 0)&&y.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:M,layoutId:I}=this.options;if(!(!this.layout||!(M||I))){if(this.resolvedRelativeTargetAt=Ji.timestamp,!this.targetDelta&&!this.relativeTarget){const R=this.getClosestProjectingParent();R&&R.layout&&this.animationProgress!==1?(this.relativeParent=R,this.forceRelativeParentToResolveTarget(),this.relativeTarget=bi(),this.relativeTargetOrigin=bi(),Im(this.relativeTargetOrigin,this.layout.layoutBox,R.layout.layoutBox),ko(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=bi(),this.targetWithTransforms=bi()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Lot(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):ko(this.target,this.layout.layoutBox),$U(this.target,this.targetDelta)):ko(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const R=this.getClosestProjectingParent();R&&!!R.resumingFrom==!!this.resumingFrom&&!R.options.layoutScroll&&R.target&&this.animationProgress!==1?(this.relativeParent=R,this.forceRelativeParentToResolveTarget(),this.relativeTarget=bi(),this.relativeTargetOrigin=bi(),Im(this.relativeTargetOrigin,this.target,R.target),ko(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}rh.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||MM(this.parent.latestValues)||UU(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var m;const y=this.getLead(),x=!!this.resumingFrom||this!==y;let w=!0;if((this.isProjectionDirty||!((m=this.parent)===null||m===void 0)&&m.isProjectionDirty)&&(w=!1),x&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(w=!1),this.resolvedRelativeTargetAt===Ji.timestamp&&(w=!1),w)return;const{layout:T,layoutId:M}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(T||M))return;ko(this.layoutCorrected,this.layout.layoutBox);const I=this.treeScale.x,R=this.treeScale.y;Got(this.layoutCorrected,this.treeScale,this.path,x),y.layout&&!y.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(y.target=y.layout.layoutBox,y.targetWithTransforms=bi());const{target:O}=y;if(!O){this.projectionTransform&&(this.projectionDelta=Jd(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=Jd(),this.projectionDeltaWithTransform=Jd());const N=this.projectionTransform;Pm(this.projectionDelta,this.layoutCorrected,O,this.latestValues),this.projectionTransform=J4(this.projectionDelta,this.treeScale),(this.projectionTransform!==N||this.treeScale.x!==I||this.treeScale.y!==R)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",O)),rh.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(m=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),m){const y=this.getStack();y&&y.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(m,y=!1){const x=this.snapshot,w=x?x.latestValues:{},T={...this.latestValues},M=Jd();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!y;const I=bi(),R=x?x.source:void 0,O=this.layout?this.layout.source:void 0,N=R!==O,G=this.getStack(),$=!G||G.members.length<=1,z=!!(N&&!$&&this.options.crossfade===!0&&!this.path.some(Dat));this.animationProgress=0;let B;this.mixTargetDelta=H=>{const K=H/1e3;rN(M.x,m.x,K),rN(M.y,m.y,K),this.setTargetDelta(M),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Im(I,this.layout.layoutBox,this.relativeParent.layout.layoutBox),kat(this.relativeTarget,this.relativeTargetOrigin,I,K),B&&uat(this.relativeTarget,B)&&(this.isProjectionDirty=!1),B||(B=bi()),ko(B,this.relativeTarget)),N&&(this.animationValues=T,iat(T,w,this.latestValues,K,z,$)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=K},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(m){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(jl(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=ii.update(()=>{iv.hasAnimatedSinceResize=!0,this.currentAnimation=_at(0,tN,{...m,onUpdate:y=>{this.mixTargetDelta(y),m.onUpdate&&m.onUpdate(y)},onComplete:()=>{m.onComplete&&m.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const m=this.getStack();m&&m.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(tN),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const m=this.getLead();let{targetWithTransforms:y,target:x,layout:w,latestValues:T}=m;if(!(!y||!x||!w)){if(this!==m&&this.layout&&w&&JU(this.options.animationType,this.layout.layoutBox,w.layoutBox)){x=this.target||bi();const M=po(this.layout.layoutBox.x);x.x.min=m.target.x.min,x.x.max=x.x.min+M;const I=po(this.layout.layoutBox.y);x.y.min=m.target.y.min,x.y.max=x.y.min+I}ko(y,x),Qd(y,T),Pm(this.projectionDeltaWithTransform,this.layoutCorrected,y,T)}}registerSharedNode(m,y){this.sharedNodes.has(m)||this.sharedNodes.set(m,new hat),this.sharedNodes.get(m).add(y);const w=y.options.initialPromotionConfig;y.promote({transition:w?w.transition:void 0,preserveFollowOpacity:w&&w.shouldPreserveFollowOpacity?w.shouldPreserveFollowOpacity(y):void 0})}isLead(){const m=this.getStack();return m?m.lead===this:!0}getLead(){var m;const{layoutId:y}=this.options;return y?((m=this.getStack())===null||m===void 0?void 0:m.lead)||this:this}getPrevLead(){var m;const{layoutId:y}=this.options;return y?(m=this.getStack())===null||m===void 0?void 0:m.prevLead:void 0}getStack(){const{layoutId:m}=this.options;if(m)return this.root.sharedNodes.get(m)}promote({needsReset:m,transition:y,preserveFollowOpacity:x}={}){const w=this.getStack();w&&w.promote(this,x),m&&(this.projectionDelta=void 0,this.needsReset=!0),y&&this.setOptions({transition:y})}relegate(){const m=this.getStack();return m?m.relegate(this):!1}resetRotation(){const{visualElement:m}=this.options;if(!m)return;let y=!1;const{latestValues:x}=m;if((x.rotate||x.rotateX||x.rotateY||x.rotateZ)&&(y=!0),!y)return;const w={};for(let T=0;T<Q4.length;T++){const M="rotate"+Q4[T];x[M]&&(w[M]=x[M],m.setStaticValue(M,0))}m.render();for(const T in w)m.setStaticValue(T,w[T]);m.scheduleRender()}getProjectionStyles(m){var y,x;if(!this.instance||this.isSVG)return;if(!this.isVisible)return yat;const w={visibility:""},T=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,w.opacity="",w.pointerEvents=nv(m==null?void 0:m.pointerEvents)||"",w.transform=T?T(this.latestValues,""):"none",w;const M=this.getLead();if(!this.projectionDelta||!this.layout||!M.target){const N={};return this.options.layoutId&&(N.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,N.pointerEvents=nv(m==null?void 0:m.pointerEvents)||""),this.hasProjected&&!nh(this.latestValues)&&(N.transform=T?T({},""):"none",this.hasProjected=!1),N}const I=M.animationValues||M.latestValues;this.applyTransformsToTarget(),w.transform=J4(this.projectionDeltaWithTransform,this.treeScale,I),T&&(w.transform=T(I,w.transform));const{x:R,y:O}=this.projectionDelta;w.transformOrigin=`${R.origin*100}% ${O.origin*100}% 0`,M.animationValues?w.opacity=M===this?(x=(y=I.opacity)!==null&&y!==void 0?y:this.latestValues.opacity)!==null&&x!==void 0?x:1:this.preserveOpacity?this.latestValues.opacity:I.opacityExit:w.opacity=M===this?I.opacity!==void 0?I.opacity:"":I.opacityExit!==void 0?I.opacityExit:0;for(const N in tx){if(I[N]===void 0)continue;const{correct:G,applyTo:$}=tx[N],z=w.transform==="none"?I[N]:G(I[N],M);if($){const B=$.length;for(let H=0;H<B;H++)w[$[H]]=z}else w[N]=z}return this.options.layoutId&&(w.pointerEvents=M===this?nv(m==null?void 0:m.pointerEvents)||"":"none"),w}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(m=>{var y;return(y=m.currentAnimation)===null||y===void 0?void 0:y.stop()}),this.root.nodes.forEach(eN),this.root.sharedNodes.clear()}}}function xat(e){e.updateLayout()}function bat(e){var r;const s=((r=e.resumeFrom)===null||r===void 0?void 0:r.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&s&&e.hasListeners("didUpdate")){const{layoutBox:a,measuredBox:h}=e.layout,{animationType:f}=e.options,m=s.source!==e.layout.source;f==="size"?Ro(M=>{const I=m?s.measuredBox[M]:s.layoutBox[M],R=po(I);I.min=a[M].min,I.max=I.min+R}):JU(f,s.layoutBox,a)&&Ro(M=>{const I=m?s.measuredBox[M]:s.layoutBox[M],R=po(a[M]);I.max=I.min+R,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[M].max=e.relativeTarget[M].min+R)});const y=Jd();Pm(y,a,s.layoutBox);const x=Jd();m?Pm(x,e.applyTransform(h,!0),s.measuredBox):Pm(x,a,s.layoutBox);const w=!XU(y);let T=!1;if(!e.resumeFrom){const M=e.getClosestProjectingParent();if(M&&!M.resumeFrom){const{snapshot:I,layout:R}=M;if(I&&R){const O=bi();Im(O,s.layoutBox,I.layoutBox);const N=bi();Im(N,a,R.layoutBox),YU(O,N)||(T=!0),M.options.layoutRoot&&(e.relativeTarget=N,e.relativeTargetOrigin=O,e.relativeParent=M)}}}e.notifyListeners("didUpdate",{layout:a,snapshot:s,delta:x,layoutDelta:y,hasLayoutChanged:w,hasRelativeTargetChanged:T})}else if(e.isLead()){const{onExitComplete:a}=e.options;a&&a()}e.options.transition=void 0}function wat(e){rh.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function Sat(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function Tat(e){e.clearSnapshot()}function eN(e){e.clearMeasurements()}function Eat(e){e.isLayoutDirty=!1}function Mat(e){const{visualElement:r}=e.options;r&&r.getProps().onBeforeLayoutMeasure&&r.notify("BeforeLayoutMeasure"),e.resetTransform()}function nN(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function Aat(e){e.resolveTargetDelta()}function Cat(e){e.calcProjection()}function Pat(e){e.resetRotation()}function Iat(e){e.removeLeadSnapshot()}function rN(e,r,s){e.translate=ri(r.translate,0,s),e.scale=ri(r.scale,1,s),e.origin=r.origin,e.originPoint=r.originPoint}function iN(e,r,s,a){e.min=ri(r.min,s.min,a),e.max=ri(r.max,s.max,a)}function kat(e,r,s,a){iN(e.x,r.x,s.x,a),iN(e.y,r.y,s.y,a)}function Dat(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const Rat={duration:.45,ease:[.4,0,.1,1]},sN=e=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(e),oN=sN("applewebkit/")&&!sN("chrome/")?Math.round:Si;function aN(e){e.min=oN(e.min),e.max=oN(e.max)}function Oat(e){aN(e.x),aN(e.y)}function JU(e,r,s){return e==="position"||e==="preserve-aspect"&&!TM(K4(r),K4(s),.2)}const Lat=KU({attachResizeListener:(e,r)=>Al(e,"resize",r),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),BT={current:void 0},QU=KU({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!BT.current){const e=new Lat({});e.mount(window),e.setOptions({layoutScroll:!0}),BT.current=e}return BT.current},resetTransform:(e,r)=>{e.style.transform=r!==void 0?r:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),zat={pan:{Feature:Jot},drag:{Feature:Kot,ProjectionNode:QU,MeasureLayout:HU}},Nat=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function Fat(e){const r=Nat.exec(e);if(!r)return[,];const[,s,a]=r;return[s,a]}function CM(e,r,s=1){const[a,h]=Fat(e);if(!a)return;const f=window.getComputedStyle(r).getPropertyValue(a);if(f){const m=f.trim();return LU(m)?parseFloat(m):m}else return _M(h)?CM(h,r,s+1):h}function Bat(e,{...r},s){const a=e.current;if(!(a instanceof Element))return{target:r,transitionEnd:s};s&&(s={...s}),e.values.forEach(h=>{const f=h.get();if(!_M(f))return;const m=CM(f,a);m&&h.set(m)});for(const h in r){const f=r[h];if(!_M(f))continue;const m=CM(f,a);m&&(r[h]=m,s||(s={}),s[h]===void 0&&(s[h]=f))}return{target:r,transitionEnd:s}}const jat=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),t8=e=>jat.has(e),Vat=e=>Object.keys(e).some(t8),lN=e=>e===zh||e===wn,cN=(e,r)=>parseFloat(e.split(", ")[r]),uN=(e,r)=>(s,{transform:a})=>{if(a==="none"||!a)return 0;const h=a.match(/^matrix3d\((.+)\)$/);if(h)return cN(h[1],r);{const f=a.match(/^matrix\((.+)\)$/);return f?cN(f[1],e):0}},Uat=new Set(["x","y","z"]),$at=Rg.filter(e=>!Uat.has(e));function Gat(e){const r=[];return $at.forEach(s=>{const a=e.getValue(s);a!==void 0&&(r.push([s,a.get()]),a.set(s.startsWith("scale")?1:0))}),r.length&&e.render(),r}const gf={width:({x:e},{paddingLeft:r="0",paddingRight:s="0"})=>e.max-e.min-parseFloat(r)-parseFloat(s),height:({y:e},{paddingTop:r="0",paddingBottom:s="0"})=>e.max-e.min-parseFloat(r)-parseFloat(s),top:(e,{top:r})=>parseFloat(r),left:(e,{left:r})=>parseFloat(r),bottom:({y:e},{top:r})=>parseFloat(r)+(e.max-e.min),right:({x:e},{left:r})=>parseFloat(r)+(e.max-e.min),x:uN(4,13),y:uN(5,14)};gf.translateX=gf.x;gf.translateY=gf.y;const Wat=(e,r,s)=>{const a=r.measureViewportBox(),h=r.current,f=getComputedStyle(h),{display:m}=f,y={};m==="none"&&r.setStaticValue("display",e.display||"block"),s.forEach(w=>{y[w]=gf[w](a,f)}),r.render();const x=r.measureViewportBox();return s.forEach(w=>{const T=r.getValue(w);T&&T.jump(y[w]),e[w]=gf[w](x,f)}),e},Hat=(e,r,s={},a={})=>{r={...r},a={...a};const h=Object.keys(r).filter(t8);let f=[],m=!1;const y=[];if(h.forEach(x=>{const w=e.getValue(x);if(!e.hasValue(x))return;let T=s[x],M=Xp(T);const I=r[x];let R;if(nx(I)){const O=I.length,N=I[0]===null?1:0;T=I[N],M=Xp(T);for(let G=N;G<O&&I[G]!==null;G++)R?GC(Xp(I[G])===R):R=Xp(I[G])}else R=Xp(I);if(M!==R)if(lN(M)&&lN(R)){const O=w.get();typeof O=="string"&&w.set(parseFloat(O)),typeof I=="string"?r[x]=parseFloat(I):Array.isArray(I)&&R===wn&&(r[x]=I.map(parseFloat))}else M!=null&&M.transform&&(R!=null&&R.transform)&&(T===0||I===0)?T===0?w.set(R.transform(T)):r[x]=M.transform(I):(m||(f=Gat(e),m=!0),y.push(x),a[x]=a[x]!==void 0?a[x]:r[x],w.jump(I))}),y.length){const x=y.indexOf("height")>=0?window.pageYOffset:null,w=Wat(r,e,y);return f.length&&f.forEach(([T,M])=>{e.getValue(T).set(M)}),e.render(),t1&&x!==null&&window.scrollTo({top:x}),{target:w,transitionEnd:a}}else return{target:r,transitionEnd:a}};function qat(e,r,s,a){return Vat(r)?Hat(e,r,s,a):{target:r,transitionEnd:a}}const Zat=(e,r,s,a)=>{const h=Bat(e,r,a);return r=h.target,a=h.transitionEnd,qat(e,r,s,a)},PM={current:null},e8={current:!1};function Xat(){if(e8.current=!0,!!t1)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),r=()=>PM.current=e.matches;e.addListener(r),r()}else PM.current=!1}function Yat(e,r,s){const{willChange:a}=r;for(const h in r){const f=r[h],m=s[h];if(Zs(f))e.addValue(h,f),ox(a)&&a.add(h);else if(Zs(m))e.addValue(h,mf(f,{owner:e})),ox(a)&&a.remove(h);else if(m!==f)if(e.hasValue(h)){const y=e.getValue(h);!y.hasAnimated&&y.set(f)}else{const y=e.getStaticValue(h);e.addValue(h,mf(y!==void 0?y:f,{owner:e}))}}for(const h in s)r[h]===void 0&&e.removeValue(h);return r}const hN=new WeakMap,n8=Object.keys(sg),Kat=n8.length,dN=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],Jat=zC.length;class Qat{constructor({parent:r,props:s,presenceContext:a,reducedMotionConfig:h,visualState:f},m={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>ii.render(this.render,!1,!0);const{latestValues:y,renderState:x}=f;this.latestValues=y,this.baseTarget={...y},this.initialValues=s.initial?{...y}:{},this.renderState=x,this.parent=r,this.props=s,this.presenceContext=a,this.depth=r?r.depth+1:0,this.reducedMotionConfig=h,this.options=m,this.isControllingVariants=n1(s),this.isVariantNode=jV(s),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(r&&r.current);const{willChange:w,...T}=this.scrapeMotionValuesFromProps(s,{});for(const M in T){const I=T[M];y[M]!==void 0&&Zs(I)&&(I.set(y[M],!1),ox(w)&&w.add(M))}}scrapeMotionValuesFromProps(r,s){return{}}mount(r){this.current=r,hN.set(r,this),this.projection&&!this.projection.instance&&this.projection.mount(r),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((s,a)=>this.bindToMotionValue(a,s)),e8.current||Xat(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:PM.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){hN.delete(this.current),this.projection&&this.projection.unmount(),jl(this.notifyUpdate),jl(this.render),this.valueSubscriptions.forEach(r=>r()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const r in this.events)this.events[r].clear();for(const r in this.features)this.features[r].unmount();this.current=null}bindToMotionValue(r,s){const a=Lh.has(r),h=s.on("change",m=>{this.latestValues[r]=m,this.props.onUpdate&&ii.update(this.notifyUpdate,!1,!0),a&&this.projection&&(this.projection.isTransformDirty=!0)}),f=s.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(r,()=>{h(),f()})}sortNodePosition(r){return!this.current||!this.sortInstanceNodePosition||this.type!==r.type?0:this.sortInstanceNodePosition(this.current,r.current)}loadFeatures({children:r,...s},a,h,f){let m,y;for(let x=0;x<Kat;x++){const w=n8[x],{isEnabled:T,Feature:M,ProjectionNode:I,MeasureLayout:R}=sg[w];I&&(m=I),T(s)&&(!this.features[w]&&M&&(this.features[w]=new M(this)),R&&(y=R))}if((this.type==="html"||this.type==="svg")&&!this.projection&&m){this.projection=new m(this.latestValues,this.parent&&this.parent.projection);const{layoutId:x,layout:w,drag:T,dragConstraints:M,layoutScroll:I,layoutRoot:R}=s;this.projection.setOptions({layoutId:x,layout:w,alwaysMeasureLayout:!!T||M&&Yd(M),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof w=="string"?w:"both",initialPromotionConfig:f,layoutScroll:I,layoutRoot:R})}return y}updateFeatures(){for(const r in this.features){const s=this.features[r];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):bi()}getStaticValue(r){return this.latestValues[r]}setStaticValue(r,s){this.latestValues[r]=s}makeTargetAnimatable(r,s=!0){return this.makeTargetAnimatableFromInstance(r,s)}update(r,s){(r.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=r,this.prevPresenceContext=this.presenceContext,this.presenceContext=s;for(let a=0;a<dN.length;a++){const h=dN[a];this.propEventSubscriptions[h]&&(this.propEventSubscriptions[h](),delete this.propEventSubscriptions[h]);const f=r["on"+h];f&&(this.propEventSubscriptions[h]=this.on(h,f))}this.prevMotionValues=Yat(this,this.scrapeMotionValuesFromProps(r,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(r){return this.props.variants?this.props.variants[r]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(r=!1){if(r)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const a=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(a.initial=this.props.initial),a}const s={};for(let a=0;a<Jat;a++){const h=zC[a],f=this.props[h];(ig(f)||f===!1)&&(s[h]=f)}return s}addVariantChild(r){const s=this.getClosestVariantNode();if(s)return s.variantChildren&&s.variantChildren.add(r),()=>s.variantChildren.delete(r)}addValue(r,s){s!==this.values.get(r)&&(this.removeValue(r),this.bindToMotionValue(r,s)),this.values.set(r,s),this.latestValues[r]=s.get()}removeValue(r){this.values.delete(r);const s=this.valueSubscriptions.get(r);s&&(s(),this.valueSubscriptions.delete(r)),delete this.latestValues[r],this.removeValueFromRenderState(r,this.renderState)}hasValue(r){return this.values.has(r)}getValue(r,s){if(this.props.values&&this.props.values[r])return this.props.values[r];let a=this.values.get(r);return a===void 0&&s!==void 0&&(a=mf(s,{owner:this}),this.addValue(r,a)),a}readValue(r){var s;return this.latestValues[r]!==void 0||!this.current?this.latestValues[r]:(s=this.getBaseTargetFromProps(this.props,r))!==null&&s!==void 0?s:this.readValueFromInstance(this.current,r,this.options)}setBaseTarget(r,s){this.baseTarget[r]=s}getBaseTarget(r){var s;const{initial:a}=this.props,h=typeof a=="string"||typeof a=="object"?(s=$C(this.props,a))===null||s===void 0?void 0:s[r]:void 0;if(a&&h!==void 0)return h;const f=this.getBaseTargetFromProps(this.props,r);return f!==void 0&&!Zs(f)?f:this.initialValues[r]!==void 0&&h===void 0?void 0:this.baseTarget[r]}on(r,s){return this.events[r]||(this.events[r]=new QC),this.events[r].add(s)}notify(r,...s){this.events[r]&&this.events[r].notify(...s)}}class r8 extends Qat{sortInstanceNodePosition(r,s){return r.compareDocumentPosition(s)&2?1:-1}getBaseTargetFromProps(r,s){return r.style?r.style[s]:void 0}removeValueFromRenderState(r,{vars:s,style:a}){delete s[r],delete a[r]}makeTargetAnimatableFromInstance({transition:r,transitionEnd:s,...a},h){const f=got(a,r||{},this);if(h){pot(this,a,f);const m=Zat(this,a,f,s);s=m.transitionEnd,a=m.target}return{transition:r,transitionEnd:s,...a}}}function tlt(e){return window.getComputedStyle(e)}class elt extends r8{constructor(){super(...arguments),this.type="html"}readValueFromInstance(r,s){if(Lh.has(s)){const a=ZC(s);return a&&a.default||0}else{const a=tlt(r),h=(WV(s)?a.getPropertyValue(s):a[s])||0;return typeof h=="string"?h.trim():h}}measureInstanceViewportBox(r,{transformPagePoint:s}){return GU(r,s)}build(r,s,a,h){FC(r,s,a,h.transformTemplate)}scrapeMotionValuesFromProps(r,s){return UC(r,s)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:r}=this.props;Zs(r)&&(this.childSubscription=r.on("change",s=>{this.current&&(this.current.textContent=`${s}`)}))}renderInstance(r,s,a,h){KV(r,s,a,h)}}class nlt extends r8{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(r,s){return r[s]}readValueFromInstance(r,s){if(Lh.has(s)){const a=ZC(s);return a&&a.default||0}return s=JV.has(s)?s:RC(s),r.getAttribute(s)}measureInstanceViewportBox(){return bi()}scrapeMotionValuesFromProps(r,s){return tU(r,s)}build(r,s,a,h){jC(r,s,a,this.isSVGTag,h.transformTemplate)}renderInstance(r,s,a,h){QV(r,s,a,h)}mount(r){this.isSVGTag=VC(r.tagName),super.mount(r)}}const rlt=(e,r)=>NC(e)?new nlt(r,{enableHardwareAcceleration:!1}):new elt(r,{enableHardwareAcceleration:!0}),ilt={layout:{ProjectionNode:QU,MeasureLayout:HU}},slt={...kot,...Kit,...zat,...ilt},lx=lit((e,r)=>Fit(e,r,slt,rlt)),olt=()=>(Y.useEffect(()=>{PV.init({duration:1e3})},[]),D.jsxs("section",{className:"w-full px-8 py-12 grid grid-cols-1 md:grid-cols-2 items-center gap-8 max-w-6xl mx-auto",children:[D.jsxs("div",{children:[D.jsxs("h3",{"data-aos":"fade-right",className:"text-4xl md:text-6xl font-semibold",children:["Agapay",D.jsx("b",{className:"text-red-500",children:"Ready"})]}),D.jsx("p",{"data-aos":"fade-right",className:"text-base md:text-lg text-slate-700 my-4 md:my-6",children:"Your trusted partner in emergency response. Be prepared, stay safe, and act fast with AgapayReady."}),D.jsx(qn,{to:"/register",children:D.jsx("button",{className:"bg-red-500 text-white font-medium py-2 px-4 rounded transition-all hover:bg-red-600 active:scale-95",children:"Register Now"})})]}),D.jsx(clt,{})]})),alt=e=>{let r=e.length,s;for(;r!=0;)s=Math.floor(Math.random()*r),r--,[e[r],e[s]]=[e[s],e[r]];return e},llt=[{id:1,src:"https://images.metronewscentral.net/LJFN7Wa5lH643-taguig.jpg"},{id:2,src:"https://mb.com.ph/media/disaster2_5141e2b1ed/disaster2_5141e2b1ed.jpg"},{id:3,src:"https://media.philstar.com/photos/2023/08/07/taguig-center-disaster-management_2023-08-07_17-54-25.jpg"},{id:4,src:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQF2obcSsxcEqlUASJljecgWWPmVHmzkHUPBA&usqp=CAU"},{id:5,src:"https://pia.gov.ph/uploads/2023/07/e9d62ac9903a70f2e7c9decfdf14dd78-800-1200.jpg"},{id:6,src:"https://pia.gov.ph/uploads/2023/07/03cafec07381294c54c2c9b61ec4660c.jpg"},{id:7,src:"https://mb.com.ph/media/Taguig_July302023_C_92c078f30a/Taguig_July302023_C_92c078f30a.jpg"},{id:8,src:"https://images.metronewscentral.net/MfOzEM2DfQ198.jpg"},{id:9,src:"https://mb.com.ph/media/Food4_52a26ecbff/Food4_52a26ecbff.jpg"},{id:10,src:"https://mb.com.ph/media/Food2_d784995f32/Food2_d784995f32.jpg"},{id:11,src:"https://usgtuptaguig.files.wordpress.com/2016/05/13083270_851413388335599_7508443394257278316_n.jpg"},{id:12,src:"https://scontent.fmnl33-6.fna.fbcdn.net/v/t39.30808-6/277745988_468522438404405_525251723295275089_n.png?_nc_cat=107&ccb=1-7&_nc_sid=efb6e6&_nc_eui2=AeEplnc3-LduyyUjxgAFdM9FSFRXVpbFI4dIVFdWlsUjh03MRbyeGrppg3gnKU-BWr8hauYiIW9RSOWcFXdgd79B&_nc_ohc=ZxhQIwB4LmcAX-AwXFV&_nc_pt=1&_nc_ht=scontent.fmnl33-6.fna&oh=00_AfBsQsAQiJIZpCA3SF6yT0yu2HSLT17AL0hvYHjWPnJaxA&oe=65C74D5E"},{id:13,src:"https://scontent.fmnl33-2.fna.fbcdn.net/v/t39.30808-6/290011019_5708643569168086_4500153366612772046_n.jpg?_nc_cat=103&ccb=1-7&_nc_sid=a73e89&_nc_eui2=AeGIy9boOGKRWBBlw9PyciD4JY_Q1zijrOslj9DXOKOs66joeNKdDqDQGrBVg4S8rSXV8k5bDn6zyLwur-WukCn-&_nc_ohc=EPN5VNRXSOcAX89J5JZ&_nc_oc=AQlO-SAOGMKnXXqv683p2oz_eHguLdJnFxjo8tQ9Dd8Ta6Ad7kLLU8_sUrj14RF98kQ&_nc_pt=1&_nc_ht=scontent.fmnl33-2.fna&oh=00_AfCYXv_cVwBd7zXyP3pgslj3zcoOnKkdPXwXRx9cPJdfyg&oe=65C7D949"},{id:14,src:"https://scontent.fmnl33-6.fna.fbcdn.net/v/t39.30808-6/289896432_5708643585834751_3478112417003114407_n.jpg?_nc_cat=107&ccb=1-7&_nc_sid=a73e89&_nc_eui2=AeFm6f53x9c5gfNbsKYtoN60zsebYqz53tDOx5tirPne0AoyLc6tZv7x1-yTRXxu9rh_1CrRKEVOOpmU8Lyqeva5&_nc_ohc=b38q7gK3NcIAX-j6Hnm&_nc_pt=1&_nc_ht=scontent.fmnl33-6.fna&oh=00_AfBlsOQUfO_7fLJhG589KsxS0tBmBxR796wP9_NQFYuySg&oe=65C7FC1C"},{id:15,src:"https://scontent.fmnl33-3.fna.fbcdn.net/v/t39.30808-6/289835465_5708643802501396_691843364399510319_n.jpg?_nc_cat=110&ccb=1-7&_nc_sid=a73e89&_nc_eui2=AeGFbFYbDAWzJs9_YAtWqUQ6d6kq7XkHI853qSrteQcjzpcJT-WROnFVwFiW4JcreYjsjro2glLLNmQ0I3P6ILGR&_nc_ohc=ol7OGHyVb58AX9JEGvh&_nc_pt=1&_nc_ht=scontent.fmnl33-3.fna&oh=00_AfA8-7Ab_i8jTSpjCooOc4pMTzCQc0zJ2MElOGtEUqbaKA&oe=65C69D08"},{id:16,src:"https://scontent.fmnl33-5.fna.fbcdn.net/v/t39.30808-6/290025533_5708643079168135_4454547939967444281_n.jpg?_nc_cat=101&ccb=1-7&_nc_sid=a73e89&_nc_eui2=AeFjIGk4D7tw2tzFNWl0Ft1Ichi43Azjj-dyGLjcDOOP58yReEg7M_U01qauArGXQDojosW7VudcxUHlRGil6VCZ&_nc_ohc=nvuAgSQLMn4AX-SVlHj&_nc_pt=1&_nc_ht=scontent.fmnl33-5.fna&oh=00_AfCD-c2G5TapRHDOk2jztppuVgEyZUp_h4S3G4oripERKg&oe=65C69AE7"}],fN=()=>alt(llt).map(e=>D.jsx(lx.div,{layout:!0,transition:{duration:1.5,type:"spring"},className:"w-full h-full",style:{backgroundImage:`url(${e.src})`,backgroundSize:"cover"}},e.id)),clt=()=>{const e=Y.useRef(null),[r,s]=Y.useState(fN());Y.useEffect(()=>(a(),()=>clearTimeout(e.current)),[]);const a=()=>{s(fN()),e.current=setTimeout(a,3e3)};return D.jsx("div",{className:"grid grid-cols-4 grid-rows-4 h-[450px] gap-1",children:r.map(h=>h)})};function i8(){const e=[{id:1,title:"Boost your conversion rate",href:"#",description:"Illo sint voluptas. Error voluptates culpa eligendi. Hic vel totam vitae illo. Non aliquid explicabo necessitatibus unde. Sed exercitationem placeat consectetur nulla deserunt vel. Iusto corrupti dicta.",date:"Feb 11, 2024",datetime:"2020-03-16",category:{title:"Others",href:"#"},author:{name:"Michael Foster",role:"User",href:"#",imageUrl:"https://images.unsplash.com/photo-1519244703995-f4e0f30006d5?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80"}},{id:2,title:"Boost your conversion rate",href:"#",description:"Illo sint voluptas. Error voluptates culpa eligendi. Hic vel totam vitae illo. Non aliquid explicabo necessitatibus unde. Sed exercitationem placeat consectetur nulla deserunt vel. Iusto corrupti dicta.",date:"Feb 10, 2024",datetime:"2020-03-16",category:{title:"Information",href:"#"},author:{name:"Michael Foster",role:"Staff",href:"#",imageUrl:"https://images.unsplash.com/photo-1519244703995-f4e0f30006d5?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80"}},{id:3,title:"Boost your conversion rate",href:"#",description:"Illo sint voluptas. Error voluptates culpa eligendi. Hic vel totam vitae illo. Non aliquid explicabo necessitatibus unde. Sed exercitationem placeat consectetur nulla deserunt vel. Iusto corrupti dicta.",date:"january 16, 2024",datetime:"2020-03-16",category:{title:"Response",href:"#"},author:{name:"Michael Foster",role:"Student",href:"#",imageUrl:"https://images.unsplash.com/photo-1519244703995-f4e0f30006d5?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80"}}];return D.jsx("div",{className:"bg-white py-24 sm:py-32",children:D.jsxs("div",{className:"mx-auto max-w-7xl px-6 lg:px-8",children:[D.jsxs("div",{className:"mx-auto max-w-2xl lg:mx-0",children:[D.jsx("h2",{className:"text-3xl font-bold tracking-tight text-gray-900 sm:text-4xl",children:"From the blog"}),D.jsx("p",{className:"mt-2 text-lg leading-8 text-gray-600",children:"Your feedback will help AgapayReady for future improvements"})]}),D.jsx("div",{className:"mx-auto mt-10 grid max-w-2xl grid-cols-1 gap-x-8 gap-y-16 border-t border-gray-200 pt-10 sm:mt-16 sm:pt-16 lg:mx-0 lg:max-w-none lg:grid-cols-3",children:e.map(r=>D.jsxs("article",{className:"flex max-w-xl flex-col items-start justify-between",children:[D.jsxs("div",{className:"flex items-center gap-x-4 text-xs",children:[D.jsx("time",{dateTime:r.datetime,className:"text-gray-500",children:r.date}),D.jsx("a",{href:r.category.href,className:"relative z-10 rounded-full bg-gray-50 px-3 py-1.5 font-medium text-gray-600 hover:bg-gray-100",children:r.category.title})]}),D.jsxs("div",{className:"group relative",children:[D.jsx("h3",{className:"mt-3 text-lg font-semibold leading-6 text-gray-900 group-hover:text-gray-600",children:D.jsxs("a",{href:r.href,children:[D.jsx("span",{className:"absolute inset-0"}),r.title]})}),D.jsx("p",{className:"mt-5 line-clamp-3 text-sm leading-6 text-gray-600",children:r.description})]}),D.jsxs("div",{className:"relative mt-8 flex items-center gap-x-4",children:[D.jsx("img",{src:r.author.imageUrl,alt:"",className:"h-10 w-10 rounded-full bg-gray-50"}),D.jsxs("div",{className:"text-sm leading-6",children:[D.jsx("p",{className:"font-semibold text-gray-900",children:D.jsxs("a",{href:r.author.href,children:[D.jsx("span",{className:"absolute inset-0"}),r.author.name]})}),D.jsx("p",{className:"text-gray-600",children:r.author.role})]})]})]},r.id))})]})})}function ult(){return D.jsxs("div",{children:[D.jsx(olt,{}),D.jsx(Xrt,{}),D.jsx(Zrt,{}),D.jsx(i8,{})]})}function s8(e,r){return function(){return e.apply(r,arguments)}}const{toString:hlt}=Object.prototype,{getPrototypeOf:tP}=Object,o1=(e=>r=>{const s=hlt.call(r);return e[s]||(e[s]=s.slice(8,-1).toLowerCase())})(Object.create(null)),Xa=e=>(e=e.toLowerCase(),r=>o1(r)===e),a1=e=>r=>typeof r===e,{isArray:kf}=Array,ag=a1("undefined");function dlt(e){return e!==null&&!ag(e)&&e.constructor!==null&&!ag(e.constructor)&&jo(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const o8=Xa("ArrayBuffer");function flt(e){let r;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?r=ArrayBuffer.isView(e):r=e&&e.buffer&&o8(e.buffer),r}const plt=a1("string"),jo=a1("function"),a8=a1("number"),l1=e=>e!==null&&typeof e=="object",mlt=e=>e===!0||e===!1,sv=e=>{if(o1(e)!=="object")return!1;const r=tP(e);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},glt=Xa("Date"),_lt=Xa("File"),ylt=Xa("Blob"),vlt=Xa("FileList"),xlt=e=>l1(e)&&jo(e.pipe),blt=e=>{let r;return e&&(typeof FormData=="function"&&e instanceof FormData||jo(e.append)&&((r=o1(e))==="formdata"||r==="object"&&jo(e.toString)&&e.toString()==="[object FormData]"))},wlt=Xa("URLSearchParams"),Slt=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Ng(e,r,{allOwnKeys:s=!1}={}){if(e===null||typeof e>"u")return;let a,h;if(typeof e!="object"&&(e=[e]),kf(e))for(a=0,h=e.length;a<h;a++)r.call(null,e[a],a,e);else{const f=s?Object.getOwnPropertyNames(e):Object.keys(e),m=f.length;let y;for(a=0;a<m;a++)y=f[a],r.call(null,e[y],y,e)}}function l8(e,r){r=r.toLowerCase();const s=Object.keys(e);let a=s.length,h;for(;a-- >0;)if(h=s[a],r===h.toLowerCase())return h;return null}const c8=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,u8=e=>!ag(e)&&e!==c8;function IM(){const{caseless:e}=u8(this)&&this||{},r={},s=(a,h)=>{const f=e&&l8(r,h)||h;sv(r[f])&&sv(a)?r[f]=IM(r[f],a):sv(a)?r[f]=IM({},a):kf(a)?r[f]=a.slice():r[f]=a};for(let a=0,h=arguments.length;a<h;a++)arguments[a]&&Ng(arguments[a],s);return r}const Tlt=(e,r,s,{allOwnKeys:a}={})=>(Ng(r,(h,f)=>{s&&jo(h)?e[f]=s8(h,s):e[f]=h},{allOwnKeys:a}),e),Elt=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Mlt=(e,r,s,a)=>{e.prototype=Object.create(r.prototype,a),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:r.prototype}),s&&Object.assign(e.prototype,s)},Alt=(e,r,s,a)=>{let h,f,m;const y={};if(r=r||{},e==null)return r;do{for(h=Object.getOwnPropertyNames(e),f=h.length;f-- >0;)m=h[f],(!a||a(m,e,r))&&!y[m]&&(r[m]=e[m],y[m]=!0);e=s!==!1&&tP(e)}while(e&&(!s||s(e,r))&&e!==Object.prototype);return r},Clt=(e,r,s)=>{e=String(e),(s===void 0||s>e.length)&&(s=e.length),s-=r.length;const a=e.indexOf(r,s);return a!==-1&&a===s},Plt=e=>{if(!e)return null;if(kf(e))return e;let r=e.length;if(!a8(r))return null;const s=new Array(r);for(;r-- >0;)s[r]=e[r];return s},Ilt=(e=>r=>e&&r instanceof e)(typeof Uint8Array<"u"&&tP(Uint8Array)),klt=(e,r)=>{const a=(e&&e[Symbol.iterator]).call(e);let h;for(;(h=a.next())&&!h.done;){const f=h.value;r.call(e,f[0],f[1])}},Dlt=(e,r)=>{let s;const a=[];for(;(s=e.exec(r))!==null;)a.push(s);return a},Rlt=Xa("HTMLFormElement"),Olt=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(s,a,h){return a.toUpperCase()+h}),pN=(({hasOwnProperty:e})=>(r,s)=>e.call(r,s))(Object.prototype),Llt=Xa("RegExp"),h8=(e,r)=>{const s=Object.getOwnPropertyDescriptors(e),a={};Ng(s,(h,f)=>{let m;(m=r(h,f,e))!==!1&&(a[f]=m||h)}),Object.defineProperties(e,a)},zlt=e=>{h8(e,(r,s)=>{if(jo(e)&&["arguments","caller","callee"].indexOf(s)!==-1)return!1;const a=e[s];if(jo(a)){if(r.enumerable=!1,"writable"in r){r.writable=!1;return}r.set||(r.set=()=>{throw Error("Can not rewrite read-only method '"+s+"'")})}})},Nlt=(e,r)=>{const s={},a=h=>{h.forEach(f=>{s[f]=!0})};return kf(e)?a(e):a(String(e).split(r)),s},Flt=()=>{},Blt=(e,r)=>(e=+e,Number.isFinite(e)?e:r),jT="abcdefghijklmnopqrstuvwxyz",mN="0123456789",d8={DIGIT:mN,ALPHA:jT,ALPHA_DIGIT:jT+jT.toUpperCase()+mN},jlt=(e=16,r=d8.ALPHA_DIGIT)=>{let s="";const{length:a}=r;for(;e--;)s+=r[Math.random()*a|0];return s};function Vlt(e){return!!(e&&jo(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const Ult=e=>{const r=new Array(10),s=(a,h)=>{if(l1(a)){if(r.indexOf(a)>=0)return;if(!("toJSON"in a)){r[h]=a;const f=kf(a)?[]:{};return Ng(a,(m,y)=>{const x=s(m,h+1);!ag(x)&&(f[y]=x)}),r[h]=void 0,f}}return a};return s(e,0)},$lt=Xa("AsyncFunction"),Glt=e=>e&&(l1(e)||jo(e))&&jo(e.then)&&jo(e.catch),ae={isArray:kf,isArrayBuffer:o8,isBuffer:dlt,isFormData:blt,isArrayBufferView:flt,isString:plt,isNumber:a8,isBoolean:mlt,isObject:l1,isPlainObject:sv,isUndefined:ag,isDate:glt,isFile:_lt,isBlob:ylt,isRegExp:Llt,isFunction:jo,isStream:xlt,isURLSearchParams:wlt,isTypedArray:Ilt,isFileList:vlt,forEach:Ng,merge:IM,extend:Tlt,trim:Slt,stripBOM:Elt,inherits:Mlt,toFlatObject:Alt,kindOf:o1,kindOfTest:Xa,endsWith:Clt,toArray:Plt,forEachEntry:klt,matchAll:Dlt,isHTMLForm:Rlt,hasOwnProperty:pN,hasOwnProp:pN,reduceDescriptors:h8,freezeMethods:zlt,toObjectSet:Nlt,toCamelCase:Olt,noop:Flt,toFiniteNumber:Blt,findKey:l8,global:c8,isContextDefined:u8,ALPHABET:d8,generateString:jlt,isSpecCompliantForm:Vlt,toJSONObject:Ult,isAsyncFn:$lt,isThenable:Glt};function er(e,r,s,a,h){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",r&&(this.code=r),s&&(this.config=s),a&&(this.request=a),h&&(this.response=h)}ae.inherits(er,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ae.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const f8=er.prototype,p8={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{p8[e]={value:e}});Object.defineProperties(er,p8);Object.defineProperty(f8,"isAxiosError",{value:!0});er.from=(e,r,s,a,h,f)=>{const m=Object.create(f8);return ae.toFlatObject(e,m,function(x){return x!==Error.prototype},y=>y!=="isAxiosError"),er.call(m,e.message,r,s,a,h),m.cause=e,m.name=e.name,f&&Object.assign(m,f),m};const Wlt=null;function kM(e){return ae.isPlainObject(e)||ae.isArray(e)}function m8(e){return ae.endsWith(e,"[]")?e.slice(0,-2):e}function gN(e,r,s){return e?e.concat(r).map(function(h,f){return h=m8(h),!s&&f?"["+h+"]":h}).join(s?".":""):r}function Hlt(e){return ae.isArray(e)&&!e.some(kM)}const qlt=ae.toFlatObject(ae,{},null,function(r){return/^is[A-Z]/.test(r)});function c1(e,r,s){if(!ae.isObject(e))throw new TypeError("target must be an object");r=r||new FormData,s=ae.toFlatObject(s,{metaTokens:!0,dots:!1,indexes:!1},!1,function(N,G){return!ae.isUndefined(G[N])});const a=s.metaTokens,h=s.visitor||T,f=s.dots,m=s.indexes,x=(s.Blob||typeof Blob<"u"&&Blob)&&ae.isSpecCompliantForm(r);if(!ae.isFunction(h))throw new TypeError("visitor must be a function");function w(O){if(O===null)return"";if(ae.isDate(O))return O.toISOString();if(!x&&ae.isBlob(O))throw new er("Blob is not supported. Use a Buffer instead.");return ae.isArrayBuffer(O)||ae.isTypedArray(O)?x&&typeof Blob=="function"?new Blob([O]):Buffer.from(O):O}function T(O,N,G){let $=O;if(O&&!G&&typeof O=="object"){if(ae.endsWith(N,"{}"))N=a?N:N.slice(0,-2),O=JSON.stringify(O);else if(ae.isArray(O)&&Hlt(O)||(ae.isFileList(O)||ae.endsWith(N,"[]"))&&($=ae.toArray(O)))return N=m8(N),$.forEach(function(B,H){!(ae.isUndefined(B)||B===null)&&r.append(m===!0?gN([N],H,f):m===null?N:N+"[]",w(B))}),!1}return kM(O)?!0:(r.append(gN(G,N,f),w(O)),!1)}const M=[],I=Object.assign(qlt,{defaultVisitor:T,convertValue:w,isVisitable:kM});function R(O,N){if(!ae.isUndefined(O)){if(M.indexOf(O)!==-1)throw Error("Circular reference detected in "+N.join("."));M.push(O),ae.forEach(O,function($,z){(!(ae.isUndefined($)||$===null)&&h.call(r,$,ae.isString(z)?z.trim():z,N,I))===!0&&R($,N?N.concat(z):[z])}),M.pop()}}if(!ae.isObject(e))throw new TypeError("data must be an object");return R(e),r}function _N(e){const r={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(a){return r[a]})}function eP(e,r){this._pairs=[],e&&c1(e,this,r)}const g8=eP.prototype;g8.append=function(r,s){this._pairs.push([r,s])};g8.toString=function(r){const s=r?function(a){return r.call(this,a,_N)}:_N;return this._pairs.map(function(h){return s(h[0])+"="+s(h[1])},"").join("&")};function Zlt(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function _8(e,r,s){if(!r)return e;const a=s&&s.encode||Zlt,h=s&&s.serialize;let f;if(h?f=h(r,s):f=ae.isURLSearchParams(r)?r.toString():new eP(r,s).toString(a),f){const m=e.indexOf("#");m!==-1&&(e=e.slice(0,m)),e+=(e.indexOf("?")===-1?"?":"&")+f}return e}class yN{constructor(){this.handlers=[]}use(r,s,a){return this.handlers.push({fulfilled:r,rejected:s,synchronous:a?a.synchronous:!1,runWhen:a?a.runWhen:null}),this.handlers.length-1}eject(r){this.handlers[r]&&(this.handlers[r]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(r){ae.forEach(this.handlers,function(a){a!==null&&r(a)})}}const y8={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Xlt=typeof URLSearchParams<"u"?URLSearchParams:eP,Ylt=typeof FormData<"u"?FormData:null,Klt=typeof Blob<"u"?Blob:null,Jlt={isBrowser:!0,classes:{URLSearchParams:Xlt,FormData:Ylt,Blob:Klt},protocols:["http","https","file","blob","url","data"]},v8=typeof window<"u"&&typeof document<"u",Qlt=(e=>v8&&["ReactNative","NativeScript","NS"].indexOf(e)<0)(typeof navigator<"u"&&navigator.product),tct=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",ect=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:v8,hasStandardBrowserEnv:Qlt,hasStandardBrowserWebWorkerEnv:tct},Symbol.toStringTag,{value:"Module"})),Ua={...ect,...Jlt};function nct(e,r){return c1(e,new Ua.classes.URLSearchParams,Object.assign({visitor:function(s,a,h,f){return Ua.isNode&&ae.isBuffer(s)?(this.append(a,s.toString("base64")),!1):f.defaultVisitor.apply(this,arguments)}},r))}function rct(e){return ae.matchAll(/\w+|\[(\w*)]/g,e).map(r=>r[0]==="[]"?"":r[1]||r[0])}function ict(e){const r={},s=Object.keys(e);let a;const h=s.length;let f;for(a=0;a<h;a++)f=s[a],r[f]=e[f];return r}function x8(e){function r(s,a,h,f){let m=s[f++];if(m==="__proto__")return!0;const y=Number.isFinite(+m),x=f>=s.length;return m=!m&&ae.isArray(h)?h.length:m,x?(ae.hasOwnProp(h,m)?h[m]=[h[m],a]:h[m]=a,!y):((!h[m]||!ae.isObject(h[m]))&&(h[m]=[]),r(s,a,h[m],f)&&ae.isArray(h[m])&&(h[m]=ict(h[m])),!y)}if(ae.isFormData(e)&&ae.isFunction(e.entries)){const s={};return ae.forEachEntry(e,(a,h)=>{r(rct(a),h,s,0)}),s}return null}function sct(e,r,s){if(ae.isString(e))try{return(r||JSON.parse)(e),ae.trim(e)}catch(a){if(a.name!=="SyntaxError")throw a}return(s||JSON.stringify)(e)}const nP={transitional:y8,adapter:["xhr","http"],transformRequest:[function(r,s){const a=s.getContentType()||"",h=a.indexOf("application/json")>-1,f=ae.isObject(r);if(f&&ae.isHTMLForm(r)&&(r=new FormData(r)),ae.isFormData(r))return h?JSON.stringify(x8(r)):r;if(ae.isArrayBuffer(r)||ae.isBuffer(r)||ae.isStream(r)||ae.isFile(r)||ae.isBlob(r))return r;if(ae.isArrayBufferView(r))return r.buffer;if(ae.isURLSearchParams(r))return s.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),r.toString();let y;if(f){if(a.indexOf("application/x-www-form-urlencoded")>-1)return nct(r,this.formSerializer).toString();if((y=ae.isFileList(r))||a.indexOf("multipart/form-data")>-1){const x=this.env&&this.env.FormData;return c1(y?{"files[]":r}:r,x&&new x,this.formSerializer)}}return f||h?(s.setContentType("application/json",!1),sct(r)):r}],transformResponse:[function(r){const s=this.transitional||nP.transitional,a=s&&s.forcedJSONParsing,h=this.responseType==="json";if(r&&ae.isString(r)&&(a&&!this.responseType||h)){const m=!(s&&s.silentJSONParsing)&&h;try{return JSON.parse(r)}catch(y){if(m)throw y.name==="SyntaxError"?er.from(y,er.ERR_BAD_RESPONSE,this,null,this.response):y}}return r}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ua.classes.FormData,Blob:Ua.classes.Blob},validateStatus:function(r){return r>=200&&r<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ae.forEach(["delete","get","head","post","put","patch"],e=>{nP.headers[e]={}});const rP=nP,oct=ae.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),act=e=>{const r={};let s,a,h;return e&&e.split(`
`).forEach(function(m){h=m.indexOf(":"),s=m.substring(0,h).trim().toLowerCase(),a=m.substring(h+1).trim(),!(!s||r[s]&&oct[s])&&(s==="set-cookie"?r[s]?r[s].push(a):r[s]=[a]:r[s]=r[s]?r[s]+", "+a:a)}),r},vN=Symbol("internals");function Kp(e){return e&&String(e).trim().toLowerCase()}function ov(e){return e===!1||e==null?e:ae.isArray(e)?e.map(ov):String(e)}function lct(e){const r=Object.create(null),s=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let a;for(;a=s.exec(e);)r[a[1]]=a[2];return r}const cct=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function VT(e,r,s,a,h){if(ae.isFunction(a))return a.call(this,r,s);if(h&&(r=s),!!ae.isString(r)){if(ae.isString(a))return r.indexOf(a)!==-1;if(ae.isRegExp(a))return a.test(r)}}function uct(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(r,s,a)=>s.toUpperCase()+a)}function hct(e,r){const s=ae.toCamelCase(" "+r);["get","set","has"].forEach(a=>{Object.defineProperty(e,a+s,{value:function(h,f,m){return this[a].call(this,r,h,f,m)},configurable:!0})})}class u1{constructor(r){r&&this.set(r)}set(r,s,a){const h=this;function f(y,x,w){const T=Kp(x);if(!T)throw new Error("header name must be a non-empty string");const M=ae.findKey(h,T);(!M||h[M]===void 0||w===!0||w===void 0&&h[M]!==!1)&&(h[M||x]=ov(y))}const m=(y,x)=>ae.forEach(y,(w,T)=>f(w,T,x));return ae.isPlainObject(r)||r instanceof this.constructor?m(r,s):ae.isString(r)&&(r=r.trim())&&!cct(r)?m(act(r),s):r!=null&&f(s,r,a),this}get(r,s){if(r=Kp(r),r){const a=ae.findKey(this,r);if(a){const h=this[a];if(!s)return h;if(s===!0)return lct(h);if(ae.isFunction(s))return s.call(this,h,a);if(ae.isRegExp(s))return s.exec(h);throw new TypeError("parser must be boolean|regexp|function")}}}has(r,s){if(r=Kp(r),r){const a=ae.findKey(this,r);return!!(a&&this[a]!==void 0&&(!s||VT(this,this[a],a,s)))}return!1}delete(r,s){const a=this;let h=!1;function f(m){if(m=Kp(m),m){const y=ae.findKey(a,m);y&&(!s||VT(a,a[y],y,s))&&(delete a[y],h=!0)}}return ae.isArray(r)?r.forEach(f):f(r),h}clear(r){const s=Object.keys(this);let a=s.length,h=!1;for(;a--;){const f=s[a];(!r||VT(this,this[f],f,r,!0))&&(delete this[f],h=!0)}return h}normalize(r){const s=this,a={};return ae.forEach(this,(h,f)=>{const m=ae.findKey(a,f);if(m){s[m]=ov(h),delete s[f];return}const y=r?uct(f):String(f).trim();y!==f&&delete s[f],s[y]=ov(h),a[y]=!0}),this}concat(...r){return this.constructor.concat(this,...r)}toJSON(r){const s=Object.create(null);return ae.forEach(this,(a,h)=>{a!=null&&a!==!1&&(s[h]=r&&ae.isArray(a)?a.join(", "):a)}),s}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([r,s])=>r+": "+s).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(r){return r instanceof this?r:new this(r)}static concat(r,...s){const a=new this(r);return s.forEach(h=>a.set(h)),a}static accessor(r){const a=(this[vN]=this[vN]={accessors:{}}).accessors,h=this.prototype;function f(m){const y=Kp(m);a[y]||(hct(h,m),a[y]=!0)}return ae.isArray(r)?r.forEach(f):f(r),this}}u1.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ae.reduceDescriptors(u1.prototype,({value:e},r)=>{let s=r[0].toUpperCase()+r.slice(1);return{get:()=>e,set(a){this[s]=a}}});ae.freezeMethods(u1);const Ll=u1;function UT(e,r){const s=this||rP,a=r||s,h=Ll.from(a.headers);let f=a.data;return ae.forEach(e,function(y){f=y.call(s,f,h.normalize(),r?r.status:void 0)}),h.normalize(),f}function b8(e){return!!(e&&e.__CANCEL__)}function Fg(e,r,s){er.call(this,e??"canceled",er.ERR_CANCELED,r,s),this.name="CanceledError"}ae.inherits(Fg,er,{__CANCEL__:!0});function dct(e,r,s){const a=s.config.validateStatus;!s.status||!a||a(s.status)?e(s):r(new er("Request failed with status code "+s.status,[er.ERR_BAD_REQUEST,er.ERR_BAD_RESPONSE][Math.floor(s.status/100)-4],s.config,s.request,s))}const fct=Ua.hasStandardBrowserEnv?{write(e,r,s,a,h,f){const m=[e+"="+encodeURIComponent(r)];ae.isNumber(s)&&m.push("expires="+new Date(s).toGMTString()),ae.isString(a)&&m.push("path="+a),ae.isString(h)&&m.push("domain="+h),f===!0&&m.push("secure"),document.cookie=m.join("; ")},read(e){const r=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return r?decodeURIComponent(r[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function pct(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function mct(e,r){return r?e.replace(/\/?\/$/,"")+"/"+r.replace(/^\/+/,""):e}function w8(e,r){return e&&!pct(r)?mct(e,r):r}const gct=Ua.hasStandardBrowserEnv?function(){const r=/(msie|trident)/i.test(navigator.userAgent),s=document.createElement("a");let a;function h(f){let m=f;return r&&(s.setAttribute("href",m),m=s.href),s.setAttribute("href",m),{href:s.href,protocol:s.protocol?s.protocol.replace(/:$/,""):"",host:s.host,search:s.search?s.search.replace(/^\?/,""):"",hash:s.hash?s.hash.replace(/^#/,""):"",hostname:s.hostname,port:s.port,pathname:s.pathname.charAt(0)==="/"?s.pathname:"/"+s.pathname}}return a=h(window.location.href),function(m){const y=ae.isString(m)?h(m):m;return y.protocol===a.protocol&&y.host===a.host}}():function(){return function(){return!0}}();function _ct(e){const r=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return r&&r[1]||""}function yct(e,r){e=e||10;const s=new Array(e),a=new Array(e);let h=0,f=0,m;return r=r!==void 0?r:1e3,function(x){const w=Date.now(),T=a[f];m||(m=w),s[h]=x,a[h]=w;let M=f,I=0;for(;M!==h;)I+=s[M++],M=M%e;if(h=(h+1)%e,h===f&&(f=(f+1)%e),w-m<r)return;const R=T&&w-T;return R?Math.round(I*1e3/R):void 0}}function xN(e,r){let s=0;const a=yct(50,250);return h=>{const f=h.loaded,m=h.lengthComputable?h.total:void 0,y=f-s,x=a(y),w=f<=m;s=f;const T={loaded:f,total:m,progress:m?f/m:void 0,bytes:y,rate:x||void 0,estimated:x&&m&&w?(m-f)/x:void 0,event:h};T[r?"download":"upload"]=!0,e(T)}}const vct=typeof XMLHttpRequest<"u",xct=vct&&function(e){return new Promise(function(s,a){let h=e.data;const f=Ll.from(e.headers).normalize();let{responseType:m,withXSRFToken:y}=e,x;function w(){e.cancelToken&&e.cancelToken.unsubscribe(x),e.signal&&e.signal.removeEventListener("abort",x)}let T;if(ae.isFormData(h)){if(Ua.hasStandardBrowserEnv||Ua.hasStandardBrowserWebWorkerEnv)f.setContentType(!1);else if((T=f.getContentType())!==!1){const[N,...G]=T?T.split(";").map($=>$.trim()).filter(Boolean):[];f.setContentType([N||"multipart/form-data",...G].join("; "))}}let M=new XMLHttpRequest;if(e.auth){const N=e.auth.username||"",G=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";f.set("Authorization","Basic "+btoa(N+":"+G))}const I=w8(e.baseURL,e.url);M.open(e.method.toUpperCase(),_8(I,e.params,e.paramsSerializer),!0),M.timeout=e.timeout;function R(){if(!M)return;const N=Ll.from("getAllResponseHeaders"in M&&M.getAllResponseHeaders()),$={data:!m||m==="text"||m==="json"?M.responseText:M.response,status:M.status,statusText:M.statusText,headers:N,config:e,request:M};dct(function(B){s(B),w()},function(B){a(B),w()},$),M=null}if("onloadend"in M?M.onloadend=R:M.onreadystatechange=function(){!M||M.readyState!==4||M.status===0&&!(M.responseURL&&M.responseURL.indexOf("file:")===0)||setTimeout(R)},M.onabort=function(){M&&(a(new er("Request aborted",er.ECONNABORTED,e,M)),M=null)},M.onerror=function(){a(new er("Network Error",er.ERR_NETWORK,e,M)),M=null},M.ontimeout=function(){let G=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded";const $=e.transitional||y8;e.timeoutErrorMessage&&(G=e.timeoutErrorMessage),a(new er(G,$.clarifyTimeoutError?er.ETIMEDOUT:er.ECONNABORTED,e,M)),M=null},Ua.hasStandardBrowserEnv&&(y&&ae.isFunction(y)&&(y=y(e)),y||y!==!1&&gct(I))){const N=e.xsrfHeaderName&&e.xsrfCookieName&&fct.read(e.xsrfCookieName);N&&f.set(e.xsrfHeaderName,N)}h===void 0&&f.setContentType(null),"setRequestHeader"in M&&ae.forEach(f.toJSON(),function(G,$){M.setRequestHeader($,G)}),ae.isUndefined(e.withCredentials)||(M.withCredentials=!!e.withCredentials),m&&m!=="json"&&(M.responseType=e.responseType),typeof e.onDownloadProgress=="function"&&M.addEventListener("progress",xN(e.onDownloadProgress,!0)),typeof e.onUploadProgress=="function"&&M.upload&&M.upload.addEventListener("progress",xN(e.onUploadProgress)),(e.cancelToken||e.signal)&&(x=N=>{M&&(a(!N||N.type?new Fg(null,e,M):N),M.abort(),M=null)},e.cancelToken&&e.cancelToken.subscribe(x),e.signal&&(e.signal.aborted?x():e.signal.addEventListener("abort",x)));const O=_ct(I);if(O&&Ua.protocols.indexOf(O)===-1){a(new er("Unsupported protocol "+O+":",er.ERR_BAD_REQUEST,e));return}M.send(h||null)})},DM={http:Wlt,xhr:xct};ae.forEach(DM,(e,r)=>{if(e){try{Object.defineProperty(e,"name",{value:r})}catch{}Object.defineProperty(e,"adapterName",{value:r})}});const bN=e=>`- ${e}`,bct=e=>ae.isFunction(e)||e===null||e===!1,S8={getAdapter:e=>{e=ae.isArray(e)?e:[e];const{length:r}=e;let s,a;const h={};for(let f=0;f<r;f++){s=e[f];let m;if(a=s,!bct(s)&&(a=DM[(m=String(s)).toLowerCase()],a===void 0))throw new er(`Unknown adapter '${m}'`);if(a)break;h[m||"#"+f]=a}if(!a){const f=Object.entries(h).map(([y,x])=>`adapter ${y} `+(x===!1?"is not supported by the environment":"is not available in the build"));let m=r?f.length>1?`since :
`+f.map(bN).join(`
`):" "+bN(f[0]):"as no adapter specified";throw new er("There is no suitable adapter to dispatch the request "+m,"ERR_NOT_SUPPORT")}return a},adapters:DM};function $T(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Fg(null,e)}function wN(e){return $T(e),e.headers=Ll.from(e.headers),e.data=UT.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),S8.getAdapter(e.adapter||rP.adapter)(e).then(function(a){return $T(e),a.data=UT.call(e,e.transformResponse,a),a.headers=Ll.from(a.headers),a},function(a){return b8(a)||($T(e),a&&a.response&&(a.response.data=UT.call(e,e.transformResponse,a.response),a.response.headers=Ll.from(a.response.headers))),Promise.reject(a)})}const SN=e=>e instanceof Ll?e.toJSON():e;function _f(e,r){r=r||{};const s={};function a(w,T,M){return ae.isPlainObject(w)&&ae.isPlainObject(T)?ae.merge.call({caseless:M},w,T):ae.isPlainObject(T)?ae.merge({},T):ae.isArray(T)?T.slice():T}function h(w,T,M){if(ae.isUndefined(T)){if(!ae.isUndefined(w))return a(void 0,w,M)}else return a(w,T,M)}function f(w,T){if(!ae.isUndefined(T))return a(void 0,T)}function m(w,T){if(ae.isUndefined(T)){if(!ae.isUndefined(w))return a(void 0,w)}else return a(void 0,T)}function y(w,T,M){if(M in r)return a(w,T);if(M in e)return a(void 0,w)}const x={url:f,method:f,data:f,baseURL:m,transformRequest:m,transformResponse:m,paramsSerializer:m,timeout:m,timeoutMessage:m,withCredentials:m,withXSRFToken:m,adapter:m,responseType:m,xsrfCookieName:m,xsrfHeaderName:m,onUploadProgress:m,onDownloadProgress:m,decompress:m,maxContentLength:m,maxBodyLength:m,beforeRedirect:m,transport:m,httpAgent:m,httpsAgent:m,cancelToken:m,socketPath:m,responseEncoding:m,validateStatus:y,headers:(w,T)=>h(SN(w),SN(T),!0)};return ae.forEach(Object.keys(Object.assign({},e,r)),function(T){const M=x[T]||h,I=M(e[T],r[T],T);ae.isUndefined(I)&&M!==y||(s[T]=I)}),s}const T8="1.6.7",iP={};["object","boolean","number","function","string","symbol"].forEach((e,r)=>{iP[e]=function(a){return typeof a===e||"a"+(r<1?"n ":" ")+e}});const TN={};iP.transitional=function(r,s,a){function h(f,m){return"[Axios v"+T8+"] Transitional option '"+f+"'"+m+(a?". "+a:"")}return(f,m,y)=>{if(r===!1)throw new er(h(m," has been removed"+(s?" in "+s:"")),er.ERR_DEPRECATED);return s&&!TN[m]&&(TN[m]=!0,console.warn(h(m," has been deprecated since v"+s+" and will be removed in the near future"))),r?r(f,m,y):!0}};function wct(e,r,s){if(typeof e!="object")throw new er("options must be an object",er.ERR_BAD_OPTION_VALUE);const a=Object.keys(e);let h=a.length;for(;h-- >0;){const f=a[h],m=r[f];if(m){const y=e[f],x=y===void 0||m(y,f,e);if(x!==!0)throw new er("option "+f+" must be "+x,er.ERR_BAD_OPTION_VALUE);continue}if(s!==!0)throw new er("Unknown option "+f,er.ERR_BAD_OPTION)}}const RM={assertOptions:wct,validators:iP},Pc=RM.validators;class cx{constructor(r){this.defaults=r,this.interceptors={request:new yN,response:new yN}}async request(r,s){try{return await this._request(r,s)}catch(a){if(a instanceof Error){let h;Error.captureStackTrace?Error.captureStackTrace(h={}):h=new Error;const f=h.stack?h.stack.replace(/^.+\n/,""):"";a.stack?f&&!String(a.stack).endsWith(f.replace(/^.+\n.+\n/,""))&&(a.stack+=`
`+f):a.stack=f}throw a}}_request(r,s){typeof r=="string"?(s=s||{},s.url=r):s=r||{},s=_f(this.defaults,s);const{transitional:a,paramsSerializer:h,headers:f}=s;a!==void 0&&RM.assertOptions(a,{silentJSONParsing:Pc.transitional(Pc.boolean),forcedJSONParsing:Pc.transitional(Pc.boolean),clarifyTimeoutError:Pc.transitional(Pc.boolean)},!1),h!=null&&(ae.isFunction(h)?s.paramsSerializer={serialize:h}:RM.assertOptions(h,{encode:Pc.function,serialize:Pc.function},!0)),s.method=(s.method||this.defaults.method||"get").toLowerCase();let m=f&&ae.merge(f.common,f[s.method]);f&&ae.forEach(["delete","get","head","post","put","patch","common"],O=>{delete f[O]}),s.headers=Ll.concat(m,f);const y=[];let x=!0;this.interceptors.request.forEach(function(N){typeof N.runWhen=="function"&&N.runWhen(s)===!1||(x=x&&N.synchronous,y.unshift(N.fulfilled,N.rejected))});const w=[];this.interceptors.response.forEach(function(N){w.push(N.fulfilled,N.rejected)});let T,M=0,I;if(!x){const O=[wN.bind(this),void 0];for(O.unshift.apply(O,y),O.push.apply(O,w),I=O.length,T=Promise.resolve(s);M<I;)T=T.then(O[M++],O[M++]);return T}I=y.length;let R=s;for(M=0;M<I;){const O=y[M++],N=y[M++];try{R=O(R)}catch(G){N.call(this,G);break}}try{T=wN.call(this,R)}catch(O){return Promise.reject(O)}for(M=0,I=w.length;M<I;)T=T.then(w[M++],w[M++]);return T}getUri(r){r=_f(this.defaults,r);const s=w8(r.baseURL,r.url);return _8(s,r.params,r.paramsSerializer)}}ae.forEach(["delete","get","head","options"],function(r){cx.prototype[r]=function(s,a){return this.request(_f(a||{},{method:r,url:s,data:(a||{}).data}))}});ae.forEach(["post","put","patch"],function(r){function s(a){return function(f,m,y){return this.request(_f(y||{},{method:r,headers:a?{"Content-Type":"multipart/form-data"}:{},url:f,data:m}))}}cx.prototype[r]=s(),cx.prototype[r+"Form"]=s(!0)});const av=cx;class sP{constructor(r){if(typeof r!="function")throw new TypeError("executor must be a function.");let s;this.promise=new Promise(function(f){s=f});const a=this;this.promise.then(h=>{if(!a._listeners)return;let f=a._listeners.length;for(;f-- >0;)a._listeners[f](h);a._listeners=null}),this.promise.then=h=>{let f;const m=new Promise(y=>{a.subscribe(y),f=y}).then(h);return m.cancel=function(){a.unsubscribe(f)},m},r(function(f,m,y){a.reason||(a.reason=new Fg(f,m,y),s(a.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(r){if(this.reason){r(this.reason);return}this._listeners?this._listeners.push(r):this._listeners=[r]}unsubscribe(r){if(!this._listeners)return;const s=this._listeners.indexOf(r);s!==-1&&this._listeners.splice(s,1)}static source(){let r;return{token:new sP(function(h){r=h}),cancel:r}}}const Sct=sP;function Tct(e){return function(s){return e.apply(null,s)}}function Ect(e){return ae.isObject(e)&&e.isAxiosError===!0}const OM={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(OM).forEach(([e,r])=>{OM[r]=e});const Mct=OM;function E8(e){const r=new av(e),s=s8(av.prototype.request,r);return ae.extend(s,av.prototype,r,{allOwnKeys:!0}),ae.extend(s,r,null,{allOwnKeys:!0}),s.create=function(h){return E8(_f(e,h))},s}const yn=E8(rP);yn.Axios=av;yn.CanceledError=Fg;yn.CancelToken=Sct;yn.isCancel=b8;yn.VERSION=T8;yn.toFormData=c1;yn.AxiosError=er;yn.Cancel=yn.CanceledError;yn.all=function(r){return Promise.all(r)};yn.spread=Tct;yn.isAxiosError=Ect;yn.mergeConfig=_f;yn.AxiosHeaders=Ll;yn.formToJSON=e=>x8(ae.isHTMLForm(e)?new FormData(e):e);yn.getAdapter=S8.getAdapter;yn.HttpStatusCode=Mct;yn.default=yn;function Act(){const e=$l(),[r,s]=Y.useState({firstname:"",lastname:"",email:"",password:"",departmentId:"",avatar:null,departments:[]}),a=y=>{s({...r,[y.target.name]:y.target.value})},h=y=>{s({...r,avatar:y.target.files[0]})};Y.useEffect(()=>{f()},[]);const f=async()=>{try{const y=await yn.get("api/v1/departments");s(x=>({...x,departments:y.data}))}catch(y){console.error("Error fetching departments",y)}},m=async y=>{y.preventDefault();const{firstname:x,lastname:w,email:T,password:M,avatar:I,departmentId:R}=r;try{const O=new FormData;O.append("firstname",x),O.append("lastname",w),O.append("email",T),O.append("password",M),O.append("departmentId",R),O.append("avatar",I),await yn.post("/api/v1/register",O,{headers:{"Content-Type":"multipart/form-data"}}),console.log("User registered successfully"),e("/login")}catch(O){console.error("Registration failed",O)}};return D.jsx("section",{className:"bg-white",children:D.jsxs("div",{className:"lg:grid lg:min-h-screen lg:grid-cols-12",children:[D.jsxs("section",{className:"relative flex h-32 items-end bg-gray-900 lg:col-span-5 lg:h-full xl:col-span-6",children:[D.jsx("img",{alt:"Night",src:"https://sa.kapamilya.com/absnews/abscbnnews/media/2022/news/11/10/earthquake-drill-students-epa-1.jpg",className:"absolute inset-0 h-full w-full object-cover opacity-80"}),D.jsxs("div",{className:"hidden lg:relative lg:block lg:p-12",children:[D.jsxs("a",{className:"block text-white",href:"/",children:[D.jsx("span",{className:"sr-only",children:"Home"}),D.jsx("img",{src:rg,alt:"Vite Logo",className:"h-8"})]}),D.jsx("h2",{className:"mt-6 text-2xl font-bold text-white sm:text-3xl md:text-4xl",children:"Welcome to AgapayReady"}),D.jsx("p",{className:"mt-4 leading-relaxed text-white/90",children:"Discover peace of mind in every crisis. AgapayReady keeps you informed and empowered during emergencies at TUP-Taguig. From real-time updates to intuitive guidance, stay safe with us."})]})]}),D.jsx("main",{className:"flex items-center justify-center px-8 py-8 sm:px-12 lg:col-span-7 lg:px-16 lg:py-12 xl:col-span-6",children:D.jsxs("div",{className:"max-w-xl lg:max-w-3xl",children:[D.jsxs("div",{className:"relative -mt-16 block lg:hidden",children:[D.jsxs("a",{className:"block text-white",href:"/",children:[D.jsx("span",{className:"sr-only",children:"Home"}),D.jsx("img",{src:rg,alt:"Vite Logo",className:"h-8"})]}),D.jsx("h1",{className:"mt-2 text-2xl font-bold text-gray-900 sm:text-3xl md:text-4xl",children:"Welcome to AgapayReady"}),D.jsx("p",{className:"mt-4 leading-relaxed text-gray-500",children:"Lorem, ipsum dolor sit amet consectetur adipisicing elit. Eligendi nam dolorum aliquam, quibusdam aperiam voluptatum."})]}),D.jsxs("form",{onSubmit:m,className:"mt-8 grid grid-cols-6 gap-6",children:[D.jsxs("div",{className:"col-span-6 sm:col-span-3",children:[D.jsx("label",{htmlFor:"FirstName",className:"block text-sm font-medium text-gray-700",children:"First Name"}),D.jsx("input",{type:"text",id:"FirstName",name:"firstname",value:r.firstname,onChange:a,className:"placeholder"})]}),D.jsxs("div",{className:"col-span-6 sm:col-span-3",children:[D.jsx("label",{htmlFor:"LastName",className:"block text-sm font-medium text-gray-700",children:"Last Name"}),D.jsx("input",{type:"text",id:"LastName",name:"lastname",value:r.lastname,onChange:a,className:"input mt-1 w-full rounded-md border-gray-200 bg-white text-sm text-gray-700 shadow-sm"})]}),D.jsxs("div",{className:"col-span-6",children:[D.jsxs("label",{htmlFor:"Email",className:"block text-sm font-medium text-gray-700",children:[" ","Email"," "]}),D.jsx("input",{type:"email",id:"Email",name:"email",value:r.email,onChange:a,className:"input mt-1 w-full rounded-md border-gray-200 bg-white text-sm text-gray-700 shadow-sm"})]}),D.jsxs("div",{className:"col-span-6 sm:col-span-3",children:[D.jsxs("label",{htmlFor:"Password",className:"block text-sm font-medium text-gray-700",children:[" ","Password"," "]}),D.jsx("input",{type:"password",id:"Password",name:"password",value:r.password,onChange:a,className:"input mt-1 w-full rounded-md border-gray-200 bg-white text-sm text-gray-700 shadow-sm"})]}),D.jsxs("div",{className:"col-span-6 sm:col-span-3",children:[D.jsx("label",{htmlFor:"Department",className:"block text-sm font-medium text-gray-700",children:"Department"}),D.jsxs("select",{id:"Department",name:"departmentId",value:r.departmentId,onChange:a,className:"input mt-1 w-full rounded-md border-gray-200 bg-white text-sm text-gray-700 shadow-sm",children:[D.jsx("option",{value:"",children:"Select Department"}),r.departments.map(y=>D.jsx("option",{value:y._id,children:y.name},y._id))]})]}),D.jsxs("div",{className:"col-span-6 sm:col-span-6",children:[D.jsx("label",{htmlFor:"Avatar",className:"block text-sm font-medium text-gray-700",children:"Profile"}),D.jsx("input",{type:"file",className:"file-input file-input-bordered w-full ",name:"avatar",accept:"image/*",onChange:h})]}),D.jsx("div",{className:"col-span-6",children:D.jsxs("label",{htmlFor:"MarketingAccept",className:"flex gap-4",children:[D.jsx("input",{type:"checkbox",id:"MarketingAccept",name:"marketing_accept",className:"h-5 w-5 rounded-md border-gray-200 bg-white shadow-sm"}),D.jsx("span",{className:"text-sm text-gray-700",children:"I want to receive emails about events, updates and AgapayReady announcements."})]})}),D.jsx("div",{className:"col-span-6",children:D.jsxs("p",{className:"text-sm text-gray-500",children:["By creating an account, you agree to our",D.jsxs("a",{href:"#",className:"text-gray-700 underline",children:[" ","terms and conditions"," "]}),"and",D.jsxs("a",{href:"#",className:"text-gray-700 underline",children:[" ","privacy policy"]}),"."]})}),D.jsxs("div",{className:"col-span-6 sm:flex sm:items-center sm:gap-4",children:[D.jsx("button",{className:"inline-block shrink-0 rounded-md border border-red-600 bg-red-600 px-12 py-3 text-sm font-medium text-white transition hover:bg-transparent hover:text-red-600 focus:outline-none focus:ring active:text-red-500",children:"Create an account"}),D.jsxs("p",{className:"mt-4 text-sm text-gray-500 sm:mt-0",children:["Already have an account?",D.jsx(qn,{to:"/login",className:"text-gray-700 underline",children:"Log in"})]})]})]})]})})]})})}function Yi(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var Cct=typeof Symbol=="function"&&Symbol.observable||"@@observable",EN=Cct,GT=()=>Math.random().toString(36).substring(7).split("").join("."),Pct={INIT:`@@redux/INIT${GT()}`,REPLACE:`@@redux/REPLACE${GT()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${GT()}`},ux=Pct;function oP(e){if(typeof e!="object"||e===null)return!1;let r=e;for(;Object.getPrototypeOf(r)!==null;)r=Object.getPrototypeOf(r);return Object.getPrototypeOf(e)===r||Object.getPrototypeOf(e)===null}function aP(e,r,s){if(typeof e!="function")throw new Error(Yi(2));if(typeof r=="function"&&typeof s=="function"||typeof s=="function"&&typeof arguments[3]=="function")throw new Error(Yi(0));if(typeof r=="function"&&typeof s>"u"&&(s=r,r=void 0),typeof s<"u"){if(typeof s!="function")throw new Error(Yi(1));return s(aP)(e,r)}let a=e,h=r,f=new Map,m=f,y=0,x=!1;function w(){m===f&&(m=new Map,f.forEach((G,$)=>{m.set($,G)}))}function T(){if(x)throw new Error(Yi(3));return h}function M(G){if(typeof G!="function")throw new Error(Yi(4));if(x)throw new Error(Yi(5));let $=!0;w();const z=y++;return m.set(z,G),function(){if($){if(x)throw new Error(Yi(6));$=!1,w(),m.delete(z),f=null}}}function I(G){if(!oP(G))throw new Error(Yi(7));if(typeof G.type>"u")throw new Error(Yi(8));if(typeof G.type!="string")throw new Error(Yi(17));if(x)throw new Error(Yi(9));try{x=!0,h=a(h,G)}finally{x=!1}return(f=m).forEach(z=>{z()}),G}function R(G){if(typeof G!="function")throw new Error(Yi(10));a=G,I({type:ux.REPLACE})}function O(){const G=M;return{subscribe($){if(typeof $!="object"||$===null)throw new Error(Yi(11));function z(){const H=$;H.next&&H.next(T())}return z(),{unsubscribe:G(z)}},[EN](){return this}}}return I({type:ux.INIT}),{dispatch:I,subscribe:M,getState:T,replaceReducer:R,[EN]:O}}function Ict(e){Object.keys(e).forEach(r=>{const s=e[r];if(typeof s(void 0,{type:ux.INIT})>"u")throw new Error(Yi(12));if(typeof s(void 0,{type:ux.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Yi(13))})}function M8(e){const r=Object.keys(e),s={};for(let f=0;f<r.length;f++){const m=r[f];typeof e[m]=="function"&&(s[m]=e[m])}const a=Object.keys(s);let h;try{Ict(s)}catch(f){h=f}return function(m={},y){if(h)throw h;let x=!1;const w={};for(let T=0;T<a.length;T++){const M=a[T],I=s[M],R=m[M],O=I(R,y);if(typeof O>"u")throw y&&y.type,new Error(Yi(14));w[M]=O,x=x||O!==R}return x=x||a.length!==Object.keys(m).length,x?w:m}}function hx(...e){return e.length===0?r=>r:e.length===1?e[0]:e.reduce((r,s)=>(...a)=>r(s(...a)))}function kct(...e){return r=>(s,a)=>{const h=r(s,a);let f=()=>{throw new Error(Yi(15))};const m={getState:h.getState,dispatch:(x,...w)=>f(x,...w)},y=e.map(x=>x(m));return f=hx(...y)(h.dispatch),{...h,dispatch:f}}}function Dct(e){return oP(e)&&"type"in e&&typeof e.type=="string"}var A8=Symbol.for("immer-nothing"),MN=Symbol.for("immer-draftable"),mo=Symbol.for("immer-state");function ca(e,...r){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var yf=Object.getPrototypeOf;function hu(e){return!!e&&!!e[mo]}function Vl(e){var r;return e?C8(e)||Array.isArray(e)||!!e[MN]||!!((r=e.constructor)!=null&&r[MN])||d1(e)||f1(e):!1}var Rct=Object.prototype.constructor.toString();function C8(e){if(!e||typeof e!="object")return!1;const r=yf(e);if(r===null)return!0;const s=Object.hasOwnProperty.call(r,"constructor")&&r.constructor;return s===Object?!0:typeof s=="function"&&Function.toString.call(s)===Rct}function lg(e,r){h1(e)===0?Object.entries(e).forEach(([s,a])=>{r(s,a,e)}):e.forEach((s,a)=>r(a,s,e))}function h1(e){const r=e[mo];return r?r.type_:Array.isArray(e)?1:d1(e)?2:f1(e)?3:0}function LM(e,r){return h1(e)===2?e.has(r):Object.prototype.hasOwnProperty.call(e,r)}function P8(e,r,s){const a=h1(e);a===2?e.set(r,s):a===3?e.add(s):e[r]=s}function Oct(e,r){return e===r?e!==0||1/e===1/r:e!==e&&r!==r}function d1(e){return e instanceof Map}function f1(e){return e instanceof Set}function ih(e){return e.copy_||e.base_}function zM(e,r){if(d1(e))return new Map(e);if(f1(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);if(!r&&C8(e))return yf(e)?{...e}:Object.assign(Object.create(null),e);const s=Object.getOwnPropertyDescriptors(e);delete s[mo];let a=Reflect.ownKeys(s);for(let h=0;h<a.length;h++){const f=a[h],m=s[f];m.writable===!1&&(m.writable=!0,m.configurable=!0),(m.get||m.set)&&(s[f]={configurable:!0,writable:!0,enumerable:m.enumerable,value:e[f]})}return Object.create(yf(e),s)}function lP(e,r=!1){return p1(e)||hu(e)||!Vl(e)||(h1(e)>1&&(e.set=e.add=e.clear=e.delete=Lct),Object.freeze(e),r&&lg(e,(s,a)=>lP(a,!0))),e}function Lct(){ca(2)}function p1(e){return Object.isFrozen(e)}var zct={};function Ah(e){const r=zct[e];return r||ca(0,e),r}var cg;function I8(){return cg}function Nct(e,r){return{drafts_:[],parent_:e,immer_:r,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function AN(e,r){r&&(Ah("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=r)}function NM(e){FM(e),e.drafts_.forEach(Fct),e.drafts_=null}function FM(e){e===cg&&(cg=e.parent_)}function CN(e){return cg=Nct(cg,e)}function Fct(e){const r=e[mo];r.type_===0||r.type_===1?r.revoke_():r.revoked_=!0}function PN(e,r){r.unfinalizedDrafts_=r.drafts_.length;const s=r.drafts_[0];return e!==void 0&&e!==s?(s[mo].modified_&&(NM(r),ca(4)),Vl(e)&&(e=dx(r,e),r.parent_||fx(r,e)),r.patches_&&Ah("Patches").generateReplacementPatches_(s[mo].base_,e,r.patches_,r.inversePatches_)):e=dx(r,s,[]),NM(r),r.patches_&&r.patchListener_(r.patches_,r.inversePatches_),e!==A8?e:void 0}function dx(e,r,s){if(p1(r))return r;const a=r[mo];if(!a)return lg(r,(h,f)=>IN(e,a,r,h,f,s)),r;if(a.scope_!==e)return r;if(!a.modified_)return fx(e,a.base_,!0),a.base_;if(!a.finalized_){a.finalized_=!0,a.scope_.unfinalizedDrafts_--;const h=a.copy_;let f=h,m=!1;a.type_===3&&(f=new Set(h),h.clear(),m=!0),lg(f,(y,x)=>IN(e,a,h,y,x,s,m)),fx(e,h,!1),s&&e.patches_&&Ah("Patches").generatePatches_(a,s,e.patches_,e.inversePatches_)}return a.copy_}function IN(e,r,s,a,h,f,m){if(hu(h)){const y=f&&r&&r.type_!==3&&!LM(r.assigned_,a)?f.concat(a):void 0,x=dx(e,h,y);if(P8(s,a,x),hu(x))e.canAutoFreeze_=!1;else return}else m&&s.add(h);if(Vl(h)&&!p1(h)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;dx(e,h),(!r||!r.scope_.parent_)&&fx(e,h)}}function fx(e,r,s=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&lP(r,s)}function Bct(e,r){const s=Array.isArray(e),a={type_:s?1:0,scope_:r?r.scope_:I8(),modified_:!1,finalized_:!1,assigned_:{},parent_:r,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let h=a,f=cP;s&&(h=[a],f=ug);const{revoke:m,proxy:y}=Proxy.revocable(h,f);return a.draft_=y,a.revoke_=m,y}var cP={get(e,r){if(r===mo)return e;const s=ih(e);if(!LM(s,r))return jct(e,s,r);const a=s[r];return e.finalized_||!Vl(a)?a:a===WT(e.base_,r)?(HT(e),e.copy_[r]=jM(a,e)):a},has(e,r){return r in ih(e)},ownKeys(e){return Reflect.ownKeys(ih(e))},set(e,r,s){const a=k8(ih(e),r);if(a!=null&&a.set)return a.set.call(e.draft_,s),!0;if(!e.modified_){const h=WT(ih(e),r),f=h==null?void 0:h[mo];if(f&&f.base_===s)return e.copy_[r]=s,e.assigned_[r]=!1,!0;if(Oct(s,h)&&(s!==void 0||LM(e.base_,r)))return!0;HT(e),BM(e)}return e.copy_[r]===s&&(s!==void 0||r in e.copy_)||Number.isNaN(s)&&Number.isNaN(e.copy_[r])||(e.copy_[r]=s,e.assigned_[r]=!0),!0},deleteProperty(e,r){return WT(e.base_,r)!==void 0||r in e.base_?(e.assigned_[r]=!1,HT(e),BM(e)):delete e.assigned_[r],e.copy_&&delete e.copy_[r],!0},getOwnPropertyDescriptor(e,r){const s=ih(e),a=Reflect.getOwnPropertyDescriptor(s,r);return a&&{writable:!0,configurable:e.type_!==1||r!=="length",enumerable:a.enumerable,value:s[r]}},defineProperty(){ca(11)},getPrototypeOf(e){return yf(e.base_)},setPrototypeOf(){ca(12)}},ug={};lg(cP,(e,r)=>{ug[e]=function(){return arguments[0]=arguments[0][0],r.apply(this,arguments)}});ug.deleteProperty=function(e,r){return ug.set.call(this,e,r,void 0)};ug.set=function(e,r,s){return cP.set.call(this,e[0],r,s,e[0])};function WT(e,r){const s=e[mo];return(s?ih(s):e)[r]}function jct(e,r,s){var h;const a=k8(r,s);return a?"value"in a?a.value:(h=a.get)==null?void 0:h.call(e.draft_):void 0}function k8(e,r){if(!(r in e))return;let s=yf(e);for(;s;){const a=Object.getOwnPropertyDescriptor(s,r);if(a)return a;s=yf(s)}}function BM(e){e.modified_||(e.modified_=!0,e.parent_&&BM(e.parent_))}function HT(e){e.copy_||(e.copy_=zM(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var Vct=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(r,s,a)=>{if(typeof r=="function"&&typeof s!="function"){const f=s;s=r;const m=this;return function(x=f,...w){return m.produce(x,T=>s.call(this,T,...w))}}typeof s!="function"&&ca(6),a!==void 0&&typeof a!="function"&&ca(7);let h;if(Vl(r)){const f=CN(this),m=jM(r,void 0);let y=!0;try{h=s(m),y=!1}finally{y?NM(f):FM(f)}return AN(f,a),PN(h,f)}else if(!r||typeof r!="object"){if(h=s(r),h===void 0&&(h=r),h===A8&&(h=void 0),this.autoFreeze_&&lP(h,!0),a){const f=[],m=[];Ah("Patches").generateReplacementPatches_(r,h,f,m),a(f,m)}return h}else ca(1,r)},this.produceWithPatches=(r,s)=>{if(typeof r=="function")return(m,...y)=>this.produceWithPatches(m,x=>r(x,...y));let a,h;return[this.produce(r,s,(m,y)=>{a=m,h=y}),a,h]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){Vl(e)||ca(8),hu(e)&&(e=D8(e));const r=CN(this),s=jM(e,void 0);return s[mo].isManual_=!0,FM(r),s}finishDraft(e,r){const s=e&&e[mo];(!s||!s.isManual_)&&ca(9);const{scope_:a}=s;return AN(a,r),PN(void 0,a)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,r){let s;for(s=r.length-1;s>=0;s--){const h=r[s];if(h.path.length===0&&h.op==="replace"){e=h.value;break}}s>-1&&(r=r.slice(s+1));const a=Ah("Patches").applyPatches_;return hu(e)?a(e,r):this.produce(e,h=>a(h,r))}};function jM(e,r){const s=d1(e)?Ah("MapSet").proxyMap_(e,r):f1(e)?Ah("MapSet").proxySet_(e,r):Bct(e,r);return(r?r.scope_:I8()).drafts_.push(s),s}function D8(e){return hu(e)||ca(10,e),R8(e)}function R8(e){if(!Vl(e)||p1(e))return e;const r=e[mo];let s;if(r){if(!r.modified_)return r.base_;r.finalized_=!0,s=zM(e,r.scope_.immer_.useStrictShallowCopy_)}else s=zM(e,!0);return lg(s,(a,h)=>{P8(s,a,R8(h))}),r&&(r.finalized_=!1),s}var go=new Vct,O8=go.produce;go.produceWithPatches.bind(go);go.setAutoFreeze.bind(go);go.setUseStrictShallowCopy.bind(go);go.applyPatches.bind(go);go.createDraft.bind(go);go.finishDraft.bind(go);function Uct(e,r=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(r)}function $ct(e,r=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(r)}function Gct(e,r="expected all items to be functions, instead received the following types: "){if(!e.every(s=>typeof s=="function")){const s=e.map(a=>typeof a=="function"?`function ${a.name||"unnamed"}()`:typeof a).join(", ");throw new TypeError(`${r}[${s}]`)}}var kN=e=>Array.isArray(e)?e:[e];function Wct(e){const r=Array.isArray(e[0])?e[0]:e;return Gct(r,"createSelector expects all input-selectors to be functions, but received the following types: "),r}function Hct(e,r){const s=[],{length:a}=e;for(let h=0;h<a;h++)s.push(e[h].apply(null,r));return s}var qct=class{constructor(e){this.value=e}deref(){return this.value}},Zct=typeof WeakRef<"u"?WeakRef:qct,Xct=0,DN=1;function b0(){return{s:Xct,v:void 0,o:null,p:null}}function uP(e,r={}){let s=b0();const{resultEqualityCheck:a}=r;let h,f=0;function m(){var M;let y=s;const{length:x}=arguments;for(let I=0,R=x;I<R;I++){const O=arguments[I];if(typeof O=="function"||typeof O=="object"&&O!==null){let N=y.o;N===null&&(y.o=N=new WeakMap);const G=N.get(O);G===void 0?(y=b0(),N.set(O,y)):y=G}else{let N=y.p;N===null&&(y.p=N=new Map);const G=N.get(O);G===void 0?(y=b0(),N.set(O,y)):y=G}}const w=y;let T;if(y.s===DN?T=y.v:(T=e.apply(null,arguments),f++),w.s=DN,a){const I=((M=h==null?void 0:h.deref)==null?void 0:M.call(h))??h;I!=null&&a(I,T)&&(T=I,f!==0&&f--),h=typeof T=="object"&&T!==null||typeof T=="function"?new Zct(T):T}return w.v=T,T}return m.clearCache=()=>{s=b0(),m.resetResultsCount()},m.resultsCount=()=>f,m.resetResultsCount=()=>{f=0},m}function L8(e,...r){const s=typeof e=="function"?{memoize:e,memoizeOptions:r}:e,a=(...h)=>{let f=0,m=0,y,x={},w=h.pop();typeof w=="object"&&(x=w,w=h.pop()),Uct(w,`createSelector expects an output function after the inputs, but received: [${typeof w}]`);const T={...s,...x},{memoize:M,memoizeOptions:I=[],argsMemoize:R=uP,argsMemoizeOptions:O=[],devModeChecks:N={}}=T,G=kN(I),$=kN(O),z=Wct(h),B=M(function(){return f++,w.apply(null,arguments)},...G),H=R(function(){m++;const at=Hct(z,arguments);return y=B.apply(null,at),y},...$);return Object.assign(H,{resultFunc:w,memoizedResultFunc:B,dependencies:z,dependencyRecomputations:()=>m,resetDependencyRecomputations:()=>{m=0},lastResult:()=>y,recomputations:()=>f,resetRecomputations:()=>{f=0},memoize:M,argsMemoize:R})};return Object.assign(a,{withTypes:()=>a}),a}var Yct=L8(uP),Kct=Object.assign((e,r=Yct)=>{$ct(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const s=Object.keys(e),a=s.map(f=>e[f]);return r(a,(...f)=>f.reduce((m,y,x)=>(m[s[x]]=y,m),{}))},{withTypes:()=>Kct});function z8(e){return({dispatch:s,getState:a})=>h=>f=>typeof f=="function"?f(s,a,e):h(f)}var Jct=z8(),Qct=z8,tut=(...e)=>{const r=L8(...e),s=Object.assign((...a)=>{const h=r(...a),f=(m,...y)=>h(hu(m)?D8(m):m,...y);return Object.assign(f,h),f},{withTypes:()=>s});return s};tut(uP);var eut=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?hx:hx.apply(null,arguments)};function vf(e,r){function s(...a){if(r){let h=r(...a);if(!h)throw new Error(qs(0));return{type:e,payload:h.payload,..."meta"in h&&{meta:h.meta},..."error"in h&&{error:h.error}}}return{type:e,payload:a[0]}}return s.toString=()=>`${e}`,s.type=e,s.match=a=>Dct(a)&&a.type===e,s}var N8=class um extends Array{constructor(...r){super(...r),Object.setPrototypeOf(this,um.prototype)}static get[Symbol.species](){return um}concat(...r){return super.concat.apply(this,r)}prepend(...r){return r.length===1&&Array.isArray(r[0])?new um(...r[0].concat(this)):new um(...r.concat(this))}};function RN(e){return Vl(e)?O8(e,()=>{}):e}function ON(e,r,s){if(e.has(r)){let h=e.get(r);return s.update&&(h=s.update(h,r,e),e.set(r,h)),h}if(!s.insert)throw new Error(qs(10));const a=s.insert(r,e);return e.set(r,a),a}function nut(e){return typeof e=="boolean"}var rut=()=>function(r){const{thunk:s=!0,immutableCheck:a=!0,serializableCheck:h=!0,actionCreatorCheck:f=!0}=r??{};let m=new N8;return s&&(nut(s)?m.push(Jct):m.push(Qct(s.extraArgument))),m},iut="RTK_autoBatch",F8=e=>r=>{setTimeout(r,e)},sut=typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:F8(10),out=(e={type:"raf"})=>r=>(...s)=>{const a=r(...s);let h=!0,f=!1,m=!1;const y=new Set,x=e.type==="tick"?queueMicrotask:e.type==="raf"?sut:e.type==="callback"?e.queueNotification:F8(e.timeout),w=()=>{m=!1,f&&(f=!1,y.forEach(T=>T()))};return Object.assign({},a,{subscribe(T){const M=()=>h&&T(),I=a.subscribe(M);return y.add(T),()=>{I(),y.delete(T)}},dispatch(T){var M;try{return h=!((M=T==null?void 0:T.meta)!=null&&M[iut]),f=!h,f&&(m||(m=!0,x(w))),a.dispatch(T)}finally{h=!0}}})},aut=e=>function(s){const{autoBatch:a=!0}=s??{};let h=new N8(e);return a&&h.push(out(typeof a=="object"?a:void 0)),h},lut=!0;function cut(e){const r=rut(),{reducer:s=void 0,middleware:a,devTools:h=!0,preloadedState:f=void 0,enhancers:m=void 0}=e||{};let y;if(typeof s=="function")y=s;else if(oP(s))y=M8(s);else throw new Error(qs(1));let x;typeof a=="function"?x=a(r):x=r();let w=hx;h&&(w=eut({trace:!lut,...typeof h=="object"&&h}));const T=kct(...x),M=aut(T);let I=typeof m=="function"?m(M):M();const R=w(...I);return aP(y,f,R)}function B8(e){const r={},s=[];let a;const h={addCase(f,m){const y=typeof f=="string"?f:f.type;if(!y)throw new Error(qs(28));if(y in r)throw new Error(qs(29));return r[y]=m,h},addMatcher(f,m){return s.push({matcher:f,reducer:m}),h},addDefaultCase(f){return a=f,h}};return e(h),[r,s,a]}function uut(e){return typeof e=="function"}function hut(e,r){let[s,a,h]=B8(r),f;if(uut(e))f=()=>RN(e());else{const y=RN(e);f=()=>y}function m(y=f(),x){let w=[s[x.type],...a.filter(({matcher:T})=>T(x)).map(({reducer:T})=>T)];return w.filter(T=>!!T).length===0&&(w=[h]),w.reduce((T,M)=>{if(M)if(hu(T)){const R=M(T,x);return R===void 0?T:R}else{if(Vl(T))return O8(T,I=>M(I,x));{const I=M(T,x);if(I===void 0){if(T===null)return T;throw new Error(qs(9))}return I}}return T},y)}return m.getInitialState=f,m}var dut="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",fut=(e=21)=>{let r="",s=e;for(;s--;)r+=dut[Math.random()*64|0];return r},put=Symbol.for("rtk-slice-createasyncthunk");function mut(e,r){return`${e}/${r}`}function gut({creators:e}={}){var s;const r=(s=e==null?void 0:e.asyncThunk)==null?void 0:s[put];return function(h){const{name:f,reducerPath:m=f}=h;if(!f)throw new Error(qs(11));typeof process<"u";const y=(typeof h.reducers=="function"?h.reducers(vut()):h.reducers)||{},x=Object.keys(y),w={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},T={addCase(B,H){const K=typeof B=="string"?B:B.type;if(!K)throw new Error(qs(12));if(K in w.sliceCaseReducersByType)throw new Error(qs(13));return w.sliceCaseReducersByType[K]=H,T},addMatcher(B,H){return w.sliceMatchers.push({matcher:B,reducer:H}),T},exposeAction(B,H){return w.actionCreators[B]=H,T},exposeCaseReducer(B,H){return w.sliceCaseReducersByName[B]=H,T}};x.forEach(B=>{const H=y[B],K={reducerName:B,type:mut(f,B),createNotation:typeof h.reducers=="function"};but(H)?Sut(K,H,T,r):xut(K,H,T)});function M(){const[B={},H=[],K=void 0]=typeof h.extraReducers=="function"?B8(h.extraReducers):[h.extraReducers],at={...B,...w.sliceCaseReducersByType};return hut(h.initialState,ft=>{for(let et in at)ft.addCase(et,at[et]);for(let et of w.sliceMatchers)ft.addMatcher(et.matcher,et.reducer);for(let et of H)ft.addMatcher(et.matcher,et.reducer);K&&ft.addDefaultCase(K)})}const I=B=>B,R=new Map;let O;function N(B,H){return O||(O=M()),O(B,H)}function G(){return O||(O=M()),O.getInitialState()}function $(B,H=!1){function K(ft){let et=ft[B];return typeof et>"u"&&H&&(et=G()),et}function at(ft=I){const et=ON(R,H,{insert:()=>new WeakMap});return ON(et,ft,{insert:()=>{const nt={};for(const[W,Q]of Object.entries(h.selectors??{}))nt[W]=_ut(Q,ft,G,H);return nt}})}return{reducerPath:B,getSelectors:at,get selectors(){return at(K)},selectSlice:K}}const z={name:f,reducer:N,actions:w.actionCreators,caseReducers:w.sliceCaseReducersByName,getInitialState:G,...$(m),injectInto(B,{reducerPath:H,...K}={}){const at=H??m;return B.inject({reducerPath:at,reducer:N},K),{...z,...$(at,!0)}}};return z}}function _ut(e,r,s,a){function h(f,...m){let y=r(f);return typeof y>"u"&&a&&(y=s()),e(y,...m)}return h.unwrapped=e,h}var yut=gut();function vut(){function e(r,s){return{_reducerDefinitionType:"asyncThunk",payloadCreator:r,...s}}return e.withTypes=()=>e,{reducer(r){return Object.assign({[r.name](...s){return r(...s)}}[r.name],{_reducerDefinitionType:"reducer"})},preparedReducer(r,s){return{_reducerDefinitionType:"reducerWithPrepare",prepare:r,reducer:s}},asyncThunk:e}}function xut({type:e,reducerName:r,createNotation:s},a,h){let f,m;if("reducer"in a){if(s&&!wut(a))throw new Error(qs(17));f=a.reducer,m=a.prepare}else f=a;h.addCase(e,f).exposeCaseReducer(r,f).exposeAction(r,m?vf(e,m):vf(e))}function but(e){return e._reducerDefinitionType==="asyncThunk"}function wut(e){return e._reducerDefinitionType==="reducerWithPrepare"}function Sut({type:e,reducerName:r},s,a,h){if(!h)throw new Error(qs(18));const{payloadCreator:f,fulfilled:m,pending:y,rejected:x,settled:w,options:T}=s,M=h(e,f,T);a.exposeAction(r,M),m&&a.addCase(M.fulfilled,m),y&&a.addCase(M.pending,y),x&&a.addCase(M.rejected,x),w&&a.addMatcher(M.settled,w),a.exposeCaseReducer(r,{fulfilled:m||w0,pending:y||w0,rejected:x||w0,settled:w||w0})}function w0(){}var Tut=(e,r)=>{if(typeof e!="function")throw new Error(qs(32))},hP="listenerMiddleware",Eut=e=>{let{type:r,actionCreator:s,matcher:a,predicate:h,effect:f}=e;if(r)h=vf(r).match;else if(s)r=s.type,h=s.match;else if(a)h=a;else if(!h)throw new Error(qs(21));return Tut(f),{predicate:h,type:r,effect:f}},Mut=Object.assign(e=>{const{type:r,predicate:s,effect:a}=Eut(e);return{id:fut(),effect:a,type:r,predicate:s,pending:new Set,unsubscribe:()=>{throw new Error(qs(22))}}},{withTypes:()=>Mut}),Aut=Object.assign(vf(`${hP}/add`),{withTypes:()=>Aut});vf(`${hP}/removeAll`);var Cut=Object.assign(vf(`${hP}/remove`),{withTypes:()=>Cut});function qs(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}const Put={currentUser:null,error:null,loading:!1},j8=yut({name:"user",initialState:Put,reducers:{logInStart:e=>{e.loading=!0},logInSuccess:(e,r)=>{e.currentUser=r.payload,e.loading=!1,e.error=null},logInFailure:(e,r)=>{e.error=r.payload,e.loading=!1},updateUserStart:e=>{e.loading=!0},updateUserSuccess:(e,r)=>{e.currentUser=r.payload,e.loading=!1,e.error=null},updateUserFailure:(e,r)=>{e.error=r.payload,e.loading=!1},deleteUserStart:e=>{e.loading=!0},deleteUserSuccess:e=>{e.currentUser=null,e.loading=!1,e.error=null},deleteUserFailure:(e,r)=>{e.error=r.payload,e.loading=!1},logOutUserStart:e=>{e.loading=!0},logOutUserSuccess:e=>{e.currentUser=null,e.loading=!1,e.error=null},logOutUserFailure:(e,r)=>{e.error=r.payload,e.loading=!1}}}),{logInStart:Iut,logInSuccess:qT,logInFailure:kut,updateUserFailure:T_t,updateUserSuccess:E_t,updateUserStart:M_t,deleteUserFailure:px,deleteUserSuccess:V8,deleteUserStart:A_t,logOutUserStart:U8,logOutUserSuccess:C_t,logOutUserFailure:P_t}=j8.actions,Dut=j8.reducer;/*! js-cookie v3.0.5 | MIT */function S0(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)e[a]=s[a]}return e}var Rut={read:function(e){return e[0]==='"'&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function VM(e,r){function s(h,f,m){if(!(typeof document>"u")){m=S0({},r,m),typeof m.expires=="number"&&(m.expires=new Date(Date.now()+m.expires*864e5)),m.expires&&(m.expires=m.expires.toUTCString()),h=encodeURIComponent(h).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var y="";for(var x in m)m[x]&&(y+="; "+x,m[x]!==!0&&(y+="="+m[x].split(";")[0]));return document.cookie=h+"="+e.write(f,h)+y}}function a(h){if(!(typeof document>"u"||arguments.length&&!h)){for(var f=document.cookie?document.cookie.split("; "):[],m={},y=0;y<f.length;y++){var x=f[y].split("="),w=x.slice(1).join("=");try{var T=decodeURIComponent(x[0]);if(m[T]=e.read(w,T),h===T)break}catch{}}return h?m[h]:m}}return Object.create({set:s,get:a,remove:function(h,f){s(h,"",S0({},f,{expires:-1}))},withAttributes:function(h){return VM(this.converter,S0({},this.attributes,h))},withConverter:function(h){return VM(S0({},this.converter,h),this.attributes)}},{attributes:{value:Object.freeze(r)},converter:{value:Object.freeze(e)}})}var Out=VM(Rut,{path:"/"});function Lut(){const{loading:e,error:r}=Rh(T=>T.user),[s,a]=Y.useState(""),h=$l(),f=fC(),[m,y]=Y.useState({email:"",password:""}),x=T=>{y({...m,[T.target.name]:T.target.value})},w=async T=>{T.preventDefault();try{f(Iut());const M=await yn.post("/api/v1/login",m);if(M.data.success===!1){f(logInFailureInFailure("Invalid email or password.")),f(qT(!1)),toast.error("Invalid email or password. Please try again.");return}Out.set("access_token",M.data.access_token),f(qT(M.data)),M.data.role==="Admin"?h("/admin/dashboard"):h("/user/profile")}catch(M){console.error("Error occurred:",M),f(kut()),f(qT(!1)),a("An error occurred while logging in")}};return D.jsx("section",{className:"bg-white",children:D.jsx("main",{className:"flex items-center justify-center px-8 py-8 sm:px-12 lg:col-span-7 lg:px-16 lg:py-12 xl:col-span-6",children:D.jsxs("div",{className:"max-w-xl lg:max-w-3xl",children:[D.jsx("div",{className:"flex items-center justify-center",children:D.jsx("img",{src:rg,alt:"Vite Logo",className:"w-40"})}),D.jsxs("form",{onSubmit:w,className:"mt-8 grid grid-cols-6 gap-6",children:[D.jsxs("div",{className:"col-span-6",children:[D.jsx("label",{htmlFor:"Email",className:"block text-sm font-medium text-gray-700",children:"Email"}),D.jsx("input",{type:"email",id:"Email",name:"email",value:m.email,onChange:x,className:"placeholder"})]}),D.jsxs("div",{className:"col-span-6",children:[D.jsx("label",{htmlFor:"Password",className:"block text-sm font-medium text-gray-700",children:"Password"}),D.jsx("input",{type:"password",id:"Password",name:"password",value:m.password,onChange:x,className:"placeholder"}),s&&D.jsx("p",{className:"mt-2 text-sm text-red-600",children:s})]}),D.jsxs("div",{className:"col-span-6 sm:flex sm:items-center sm:gap-4",children:[D.jsx("button",{disabled:e,className:"inline-block shrink-0 rounded-md border border-red-600 bg-red-600 px-12 py-3 text-sm font-medium text-white transition hover:bg-transparent hover:text-red-600 focus:outline-none focus:ring active:text-red-500",children:e?"Loading...":"Log In"}),D.jsxs("p",{className:"mt-4 text-sm text-gray-500 sm:mt-0",children:["Don't have an account?"," ",D.jsx(qn,{to:"/register",className:"text-gray-700 underline",children:"Register"}),"."]})]})]})]})})})}function zut(e){return ms({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"1",y:"4",width:"22",height:"16",rx:"2",ry:"2"},child:[]},{tag:"line",attr:{x1:"1",y1:"10",x2:"23",y2:"10"},child:[]}]})(e)}function LN(e){return ms({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"5",x2:"12",y2:"19"},child:[]},{tag:"line",attr:{x1:"5",y1:"12",x2:"19",y2:"12"},child:[]}]})(e)}function Nut(e){return ms({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"3 6 5 6 21 6"},child:[]},{tag:"path",attr:{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"},child:[]}]})(e)}const Fut=[{id:1,title:"Fire emergency",href:"#",description:"Illo sint voluptas. Error voluptates culpa eligendi. Hic vel totam vitae illo. Non aliquid explicabo necessitatibus unde. Sed exercitationem placeat consectetur nulla deserunt vel. Iusto corrupti dicta.",date:"Feb 11, 2024",datetime:"2020-03-16",category:{title:"Others",href:"#"},author:{name:"Michael Foster",role:"User",href:"#",imageUrl:"https://images.unsplash.com/photo-1519244703995-f4e0f30006d5?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80"}},{id:2,title:"Flood",href:"#",description:"Illo sint voluptas. Error voluptates culpa eligendi. Hic vel totam vitae illo. Non aliquid explicabo necessitatibus unde. Sed exercitationem placeat consectetur nulla deserunt vel. Iusto corrupti dicta.",date:"Feb 10, 2024",datetime:"2020-03-16",category:{title:"Information",href:"#"},author:{name:"Michael Foster",role:"Staff",href:"#",imageUrl:"https://images.unsplash.com/photo-1519244703995-f4e0f30006d5?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80"}},{id:3,title:"Earthquake",href:"#",description:"Illo sint voluptas. Error voluptates culpa eligendi. Hic vel totam vitae illo. Non aliquid explicabo necessitatibus unde. Sed exercitationem placeat consectetur nulla deserunt vel. Iusto corrupti dicta.",date:"january 16, 2024",datetime:"2020-03-16",category:{title:"Response",href:"#"},author:{name:"Michael Foster",role:"Student",href:"#",imageUrl:"https://images.unsplash.com/photo-1519244703995-f4e0f30006d5?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80"}}],But=()=>D.jsxs("div",{className:"p-4",children:[D.jsx("p",{className:"text-xl font-semibold mb-2",children:"Evacuation Guidelines"}),D.jsx("div",{className:"grid gap-4 grid-cols-2 lg:grid-cols-4",children:Fut.map(e=>D.jsx(Vut,{title:e.title,subtitle:e.category.title,href:e.href,Icon:jut(e.category.title)},e.id))})]}),jut=e=>{switch(e){case"Others":return $rt;case"Information":return Grt;case"Response":return Urt;default:return zut}},Vut=({title:e,subtitle:r,Icon:s,href:a})=>D.jsxs("a",{href:a,className:"w-full p-4 rounded border-[1px] border-slate-300 relative overflow-hidden group bg-white",children:[D.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-red-600 to-red-600 translate-y-[100%] group-hover:translate-y-[0%] transition-transform duration-300"}),D.jsx(s,{className:"absolute z-10 -top-12 -right-12 text-9xl text-slate-100 group-hover:text-red-400 group-hover:rotate-12 transition-transform duration-300"}),D.jsx(s,{className:"mb-2 text-2xl text-red-600 group-hover:text-white transition-colors relative z-10 duration-300"}),D.jsx("h3",{className:"font-medium text-lg text-slate-950 group-hover:text-white relative z-10 duration-300",children:e}),D.jsx("p",{className:"text-slate-400 group-hover:text-violet-200 relative z-10 duration-300",children:r})]});function $8(e){var r,s,a="";if(typeof e=="string"||typeof e=="number")a+=e;else if(typeof e=="object")if(Array.isArray(e)){var h=e.length;for(r=0;r<h;r++)e[r]&&(s=$8(e[r]))&&(a&&(a+=" "),a+=s)}else for(s in e)e[s]&&(a&&(a+=" "),a+=s);return a}function Vc(){for(var e,r,s=0,a="",h=arguments.length;s<h;s++)(e=arguments[s])&&(r=$8(e))&&(a&&(a+=" "),a+=r);return a}const hg=e=>typeof e=="number"&&!isNaN(e),yh=e=>typeof e=="string",uo=e=>typeof e=="function",lv=e=>yh(e)||uo(e)?e:null,UM=e=>Y.isValidElement(e)||yh(e)||uo(e)||hg(e);function Uut(e,r,s){s===void 0&&(s=300);const{scrollHeight:a,style:h}=e;requestAnimationFrame(()=>{h.minHeight="initial",h.height=a+"px",h.transition=`all ${s}ms`,requestAnimationFrame(()=>{h.height="0",h.padding="0",h.margin="0",setTimeout(r,s)})})}function m1(e){let{enter:r,exit:s,appendPosition:a=!1,collapse:h=!0,collapseDuration:f=300}=e;return function(m){let{children:y,position:x,preventExitTransition:w,done:T,nodeRef:M,isIn:I,playToast:R}=m;const O=a?`${r}--${x}`:r,N=a?`${s}--${x}`:s,G=Y.useRef(0);return Y.useLayoutEffect(()=>{const $=M.current,z=O.split(" "),B=H=>{H.target===M.current&&(R(),$.removeEventListener("animationend",B),$.removeEventListener("animationcancel",B),G.current===0&&H.type!=="animationcancel"&&$.classList.remove(...z))};$.classList.add(...z),$.addEventListener("animationend",B),$.addEventListener("animationcancel",B)},[]),Y.useEffect(()=>{const $=M.current,z=()=>{$.removeEventListener("animationend",z),h?Uut($,T,f):T()};I||(w?z():(G.current=1,$.className+=` ${N}`,$.addEventListener("animationend",z)))},[I]),we.createElement(we.Fragment,null,y)}}function zN(e,r){return e!=null?{content:e.content,containerId:e.props.containerId,id:e.props.toastId,theme:e.props.theme,type:e.props.type,data:e.props.data||{},isLoading:e.props.isLoading,icon:e.props.icon,status:r}:{}}const Es=new Map;let dg=[];const $M=new Set,$ut=e=>$M.forEach(r=>r(e)),G8=()=>Es.size>0;function W8(e,r){var s;if(r)return!((s=Es.get(r))==null||!s.isToastActive(e));let a=!1;return Es.forEach(h=>{h.isToastActive(e)&&(a=!0)}),a}function H8(e,r){UM(e)&&(G8()||dg.push({content:e,options:r}),Es.forEach(s=>{s.buildToast(e,r)}))}function NN(e,r){Es.forEach(s=>{r!=null&&r!=null&&r.containerId?(r==null?void 0:r.containerId)===s.id&&s.toggle(e,r==null?void 0:r.id):s.toggle(e,r==null?void 0:r.id)})}function Gut(e){const{subscribe:r,getSnapshot:s,setProps:a}=Y.useRef(function(f){const m=f.containerId||1;return{subscribe(y){const x=function(T,M,I){let R=1,O=0,N=[],G=[],$=[],z=M;const B=new Map,H=new Set,K=()=>{$=Array.from(B.values()),H.forEach(et=>et())},at=et=>{G=et==null?[]:G.filter(nt=>nt!==et),K()},ft=et=>{const{toastId:nt,onOpen:W,updateId:Q,children:yt}=et.props,Pt=Q==null;et.staleId&&B.delete(et.staleId),B.set(nt,et),G=[...G,et.props.toastId].filter(st=>st!==et.staleId),K(),I(zN(et,Pt?"added":"updated")),Pt&&uo(W)&&W(Y.isValidElement(yt)&&yt.props)};return{id:T,props:z,observe:et=>(H.add(et),()=>H.delete(et)),toggle:(et,nt)=>{B.forEach(W=>{nt!=null&&nt!==W.props.toastId||uo(W.toggle)&&W.toggle(et)})},removeToast:at,toasts:B,clearQueue:()=>{O-=N.length,N=[]},buildToast:(et,nt)=>{if((Ot=>{let{containerId:Me,toastId:me,updateId:kt}=Ot;const Wt=Me?Me!==T:T!==1,Ct=B.has(me)&&kt==null;return Wt||Ct})(nt))return;const{toastId:W,updateId:Q,data:yt,staleId:Pt,delay:st}=nt,St=()=>{at(W)},Rt=Q==null;Rt&&O++;const Zt={...z,style:z.toastStyle,key:R++,...Object.fromEntries(Object.entries(nt).filter(Ot=>{let[Me,me]=Ot;return me!=null})),toastId:W,updateId:Q,data:yt,closeToast:St,isIn:!1,className:lv(nt.className||z.toastClassName),bodyClassName:lv(nt.bodyClassName||z.bodyClassName),progressClassName:lv(nt.progressClassName||z.progressClassName),autoClose:!nt.isLoading&&(Ft=nt.autoClose,$t=z.autoClose,Ft===!1||hg(Ft)&&Ft>0?Ft:$t),deleteToast(){const Ot=B.get(W),{onClose:Me,children:me}=Ot.props;uo(Me)&&Me(Y.isValidElement(me)&&me.props),I(zN(Ot,"removed")),B.delete(W),O--,O<0&&(O=0),N.length>0?ft(N.shift()):K()}};var Ft,$t;Zt.closeButton=z.closeButton,nt.closeButton===!1||UM(nt.closeButton)?Zt.closeButton=nt.closeButton:nt.closeButton===!0&&(Zt.closeButton=!UM(z.closeButton)||z.closeButton);let ee=et;Y.isValidElement(et)&&!yh(et.type)?ee=Y.cloneElement(et,{closeToast:St,toastProps:Zt,data:yt}):uo(et)&&(ee=et({closeToast:St,toastProps:Zt,data:yt}));const se={content:ee,props:Zt,staleId:Pt};z.limit&&z.limit>0&&O>z.limit&&Rt?N.push(se):hg(st)?setTimeout(()=>{ft(se)},st):ft(se)},setProps(et){z=et},setToggle:(et,nt)=>{B.get(et).toggle=nt},isToastActive:et=>G.some(nt=>nt===et),getSnapshot:()=>z.newestOnTop?$.reverse():$}}(m,f,$ut);Es.set(m,x);const w=x.observe(y);return dg.forEach(T=>H8(T.content,T.options)),dg=[],()=>{w(),Es.delete(m)}},setProps(y){var x;(x=Es.get(m))==null||x.setProps(y)},getSnapshot(){var y;return(y=Es.get(m))==null?void 0:y.getSnapshot()}}}(e)).current;a(e);const h=Y.useSyncExternalStore(r,s,s);return{getToastToRender:function(f){if(!h)return[];const m=new Map;return h.forEach(y=>{const{position:x}=y.props;m.has(x)||m.set(x,[]),m.get(x).push(y)}),Array.from(m,y=>f(y[0],y[1]))},isToastActive:W8,count:h==null?void 0:h.length}}function Wut(e){const[r,s]=Y.useState(!1),[a,h]=Y.useState(!1),f=Y.useRef(null),m=Y.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:y,pauseOnHover:x,closeToast:w,onClick:T,closeOnClick:M}=e;var I,R;function O(){s(!0)}function N(){s(!1)}function G(B){const H=f.current;m.canDrag&&H&&(m.didMove=!0,r&&N(),m.delta=e.draggableDirection==="x"?B.clientX-m.start:B.clientY-m.start,m.start!==B.clientX&&(m.canCloseOnClick=!1),H.style.transform=`translate3d(${e.draggableDirection==="x"?`${m.delta}px, var(--y)`:`0, calc(${m.delta}px + var(--y))`},0)`,H.style.opacity=""+(1-Math.abs(m.delta/m.removalDistance)))}function $(){document.removeEventListener("pointermove",G),document.removeEventListener("pointerup",$);const B=f.current;if(m.canDrag&&m.didMove&&B){if(m.canDrag=!1,Math.abs(m.delta)>m.removalDistance)return h(!0),e.closeToast(),void e.collapseAll();B.style.transition="transform 0.2s, opacity 0.2s",B.style.removeProperty("transform"),B.style.removeProperty("opacity")}}(R=Es.get((I={id:e.toastId,containerId:e.containerId,fn:s}).containerId||1))==null||R.setToggle(I.id,I.fn),Y.useEffect(()=>{if(e.pauseOnFocusLoss)return document.hasFocus()||N(),window.addEventListener("focus",O),window.addEventListener("blur",N),()=>{window.removeEventListener("focus",O),window.removeEventListener("blur",N)}},[e.pauseOnFocusLoss]);const z={onPointerDown:function(B){if(e.draggable===!0||e.draggable===B.pointerType){m.didMove=!1,document.addEventListener("pointermove",G),document.addEventListener("pointerup",$);const H=f.current;m.canCloseOnClick=!0,m.canDrag=!0,H.style.transition="none",e.draggableDirection==="x"?(m.start=B.clientX,m.removalDistance=H.offsetWidth*(e.draggablePercent/100)):(m.start=B.clientY,m.removalDistance=H.offsetHeight*(e.draggablePercent===80?1.5*e.draggablePercent:e.draggablePercent)/100)}},onPointerUp:function(B){const{top:H,bottom:K,left:at,right:ft}=f.current.getBoundingClientRect();B.nativeEvent.type!=="touchend"&&e.pauseOnHover&&B.clientX>=at&&B.clientX<=ft&&B.clientY>=H&&B.clientY<=K?N():O()}};return y&&x&&(z.onMouseEnter=N,e.stacked||(z.onMouseLeave=O)),M&&(z.onClick=B=>{T&&T(B),m.canCloseOnClick&&w()}),{playToast:O,pauseToast:N,isRunning:r,preventExitTransition:a,toastRef:f,eventHandlers:z}}function Hut(e){let{delay:r,isRunning:s,closeToast:a,type:h="default",hide:f,className:m,style:y,controlledProgress:x,progress:w,rtl:T,isIn:M,theme:I}=e;const R=f||x&&w===0,O={...y,animationDuration:`${r}ms`,animationPlayState:s?"running":"paused"};x&&(O.transform=`scaleX(${w})`);const N=Vc("Toastify__progress-bar",x?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${I}`,`Toastify__progress-bar--${h}`,{"Toastify__progress-bar--rtl":T}),G=uo(m)?m({rtl:T,type:h,defaultClassName:N}):Vc(N,m),$={[x&&w>=1?"onTransitionEnd":"onAnimationEnd"]:x&&w<1?null:()=>{M&&a()}};return we.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":R},we.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${I} Toastify__progress-bar--${h}`}),we.createElement("div",{role:"progressbar","aria-hidden":R?"true":"false","aria-label":"notification timer",className:G,style:O,...$}))}let qut=1;const q8=()=>""+qut++;function Zut(e){return e&&(yh(e.toastId)||hg(e.toastId))?e.toastId:q8()}function km(e,r){return H8(e,r),r.toastId}function mx(e,r){return{...r,type:r&&r.type||e,toastId:Zut(r)}}function T0(e){return(r,s)=>km(r,mx(e,s))}function fr(e,r){return km(e,mx("default",r))}fr.loading=(e,r)=>km(e,mx("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...r})),fr.promise=function(e,r,s){let a,{pending:h,error:f,success:m}=r;h&&(a=yh(h)?fr.loading(h,s):fr.loading(h.render,{...s,...h}));const y={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},x=(T,M,I)=>{if(M==null)return void fr.dismiss(a);const R={type:T,...y,...s,data:I},O=yh(M)?{render:M}:M;return a?fr.update(a,{...R,...O}):fr(O.render,{...R,...O}),I},w=uo(e)?e():e;return w.then(T=>x("success",m,T)).catch(T=>x("error",f,T)),w},fr.success=T0("success"),fr.info=T0("info"),fr.error=T0("error"),fr.warning=T0("warning"),fr.warn=fr.warning,fr.dark=(e,r)=>km(e,mx("default",{theme:"dark",...r})),fr.dismiss=function(e){(function(r){var s;if(G8()){if(r==null||yh(s=r)||hg(s))Es.forEach(h=>{h.removeToast(r)});else if(r&&("containerId"in r||"id"in r)){var a;(a=Es.get(r.containerId))!=null&&a.removeToast(r.id)||Es.forEach(h=>{h.removeToast(r.id)})}}else dg=dg.filter(h=>r!=null&&h.options.toastId!==r)})(e)},fr.clearWaitingQueue=function(e){e===void 0&&(e={}),Es.forEach(r=>{!r.props.limit||e.containerId&&r.id!==e.containerId||r.clearQueue()})},fr.isActive=W8,fr.update=function(e,r){r===void 0&&(r={});const s=((a,h)=>{var f;let{containerId:m}=h;return(f=Es.get(m||1))==null?void 0:f.toasts.get(a)})(e,r);if(s){const{props:a,content:h}=s,f={delay:100,...a,...r,toastId:r.toastId||e,updateId:q8()};f.toastId!==e&&(f.staleId=e);const m=f.render||h;delete f.render,km(m,f)}},fr.done=e=>{fr.update(e,{progress:1})},fr.onChange=function(e){return $M.add(e),()=>{$M.delete(e)}},fr.play=e=>NN(!0,e),fr.pause=e=>NN(!1,e);const Xut=typeof window<"u"?Y.useLayoutEffect:Y.useEffect,E0=e=>{let{theme:r,type:s,isLoading:a,...h}=e;return we.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:r==="colored"?"currentColor":`var(--toastify-icon-color-${s})`,...h})},ZT={info:function(e){return we.createElement(E0,{...e},we.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))},warning:function(e){return we.createElement(E0,{...e},we.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))},success:function(e){return we.createElement(E0,{...e},we.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))},error:function(e){return we.createElement(E0,{...e},we.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))},spinner:function(){return we.createElement("div",{className:"Toastify__spinner"})}},Yut=e=>{const{isRunning:r,preventExitTransition:s,toastRef:a,eventHandlers:h,playToast:f}=Wut(e),{closeButton:m,children:y,autoClose:x,onClick:w,type:T,hideProgressBar:M,closeToast:I,transition:R,position:O,className:N,style:G,bodyClassName:$,bodyStyle:z,progressClassName:B,progressStyle:H,updateId:K,role:at,progress:ft,rtl:et,toastId:nt,deleteToast:W,isIn:Q,isLoading:yt,closeOnClick:Pt,theme:st}=e,St=Vc("Toastify__toast",`Toastify__toast-theme--${st}`,`Toastify__toast--${T}`,{"Toastify__toast--rtl":et},{"Toastify__toast--close-on-click":Pt}),Rt=uo(N)?N({rtl:et,position:O,type:T,defaultClassName:St}):Vc(St,N),Zt=function(se){let{theme:Ot,type:Me,isLoading:me,icon:kt}=se,Wt=null;const Ct={theme:Ot,type:Me};return kt===!1||(uo(kt)?Wt=kt({...Ct,isLoading:me}):Y.isValidElement(kt)?Wt=Y.cloneElement(kt,Ct):me?Wt=ZT.spinner():(Ae=>Ae in ZT)(Me)&&(Wt=ZT[Me](Ct))),Wt}(e),Ft=!!ft||!x,$t={closeToast:I,type:T,theme:st};let ee=null;return m===!1||(ee=uo(m)?m($t):Y.isValidElement(m)?Y.cloneElement(m,$t):function(se){let{closeToast:Ot,theme:Me,ariaLabel:me="close"}=se;return we.createElement("button",{className:`Toastify__close-button Toastify__close-button--${Me}`,type:"button",onClick:kt=>{kt.stopPropagation(),Ot(kt)},"aria-label":me},we.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},we.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}($t)),we.createElement(R,{isIn:Q,done:W,position:O,preventExitTransition:s,nodeRef:a,playToast:f},we.createElement("div",{id:nt,onClick:w,"data-in":Q,className:Rt,...h,style:G,ref:a},we.createElement("div",{...Q&&{role:at},className:uo($)?$({type:T}):Vc("Toastify__toast-body",$),style:z},Zt!=null&&we.createElement("div",{className:Vc("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!yt})},Zt),we.createElement("div",null,y)),ee,we.createElement(Hut,{...K&&!Ft?{key:`pb-${K}`}:{},rtl:et,theme:st,delay:x,isRunning:r,isIn:Q,closeToast:I,hide:M,type:T,style:H,className:B,controlledProgress:Ft,progress:ft||0})))},g1=function(e,r){return r===void 0&&(r=!1),{enter:`Toastify--animate Toastify__${e}-enter`,exit:`Toastify--animate Toastify__${e}-exit`,appendPosition:r}},Kut=m1(g1("bounce",!0));m1(g1("slide",!0));m1(g1("zoom"));m1(g1("flip"));const Jut={position:"top-right",transition:Kut,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light"};function dP(e){let r={...Jut,...e};const s=e.stacked,[a,h]=Y.useState(!0),f=Y.useRef(null),{getToastToRender:m,isToastActive:y,count:x}=Gut(r),{className:w,style:T,rtl:M,containerId:I}=r;function R(N){const G=Vc("Toastify__toast-container",`Toastify__toast-container--${N}`,{"Toastify__toast-container--rtl":M});return uo(w)?w({position:N,rtl:M,defaultClassName:G}):Vc(G,lv(w))}function O(){s&&(h(!0),fr.play())}return Xut(()=>{if(s){var N;const G=f.current.querySelectorAll('[data-in="true"]'),$=12,z=(N=r.position)==null?void 0:N.includes("top");let B=0,H=0;Array.from(G).reverse().forEach((K,at)=>{const ft=K;ft.classList.add("Toastify__toast--stacked"),at>0&&(ft.dataset.collapsed=`${a}`),ft.dataset.pos||(ft.dataset.pos=z?"top":"bot");const et=B*(a?.2:1)+(a?0:$*at);ft.style.setProperty("--y",`${z?et:-1*et}px`),ft.style.setProperty("--g",`${$}`),ft.style.setProperty("--s",""+(1-(a?H:0))),B+=ft.offsetHeight,H+=.025})}},[a,x,s]),we.createElement("div",{ref:f,className:"Toastify",id:I,onMouseEnter:()=>{s&&(h(!1),fr.pause())},onMouseLeave:O},m((N,G)=>{const $=G.length?{...T}:{...T,pointerEvents:"none"};return we.createElement("div",{className:R(N),style:$,key:`container-${N}`},G.map(z=>{let{content:B,props:H}=z;return we.createElement(Yut,{...H,stacked:s,collapseAll:O,isIn:y(H.toastId,H.containerId),style:H.style,key:`toast-${H.key}`},B)}))}))}const Qut=()=>{const[e,r]=Y.useState(""),[s,a]=Y.useState(""),h=y=>{r(y.target.value)},f=y=>{a(y.target.value)},m=async y=>{y.preventDefault();try{await yn.post("/api/v1/report",{location:e,description:s}),r(""),a(""),fr.success("Emergency report sent successfully!")}catch(x){console.error("Error submitting emergency report:",x),fr.error("Failed to submit emergency report")}};return D.jsxs("div",{className:"max-w-md mx-auto mt-8",children:[D.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Emergency Report Form"}),D.jsxs("form",{onSubmit:m,className:"space-y-4",children:[D.jsxs("div",{children:[D.jsx("label",{className:"block mb-1 font-medium",children:"Location"}),D.jsx("input",{type:"text",value:e,onChange:h,placeholder:"Location",className:"w-full px-4 py-2 border rounded-md focus:outline-none focus:border-blue-500"})]}),D.jsxs("div",{children:[D.jsx("label",{className:"block mb-1 font-medium",children:"Description"}),D.jsx("textarea",{value:s,onChange:f,placeholder:"Description",className:"w-full px-4 py-2 border rounded-md focus:outline-none focus:border-blue-500",rows:"4"})]}),D.jsx("button",{type:"submit",className:"w-full bg-blue-500 text-white font-bold py-2 rounded-md transition duration-300 hover:bg-blue-600",children:"Submit"})]}),D.jsx(dP,{})]})};function tht(){const{currentUser:e,loading:r,error:s}=Rh(a=>a.user);return D.jsxs(D.Fragment,{children:[D.jsx("img",{src:e.avatar}),D.jsx("div",{children:e.firstname}),D.jsx("div",{children:e.lastname}),D.jsx("div",{children:e.role}),D.jsx(Qut,{})]})}function vu(){const e=fC(),r=$l(),{currentUser:s}=Rh(h=>h.user),a=async()=>{try{e(U8());const f=await(await yn.get("http://localhost:4000/api/v1/logout")).data;if(f.success===!1){e(px(f.message)),r("/");return}e(V8(f))}catch(h){e(px(h.message))}};return D.jsxs("div",{className:"flex h-screen flex-col justify-between border-e bg-white",children:[D.jsxs("div",{className:"px-4 py-6",children:[D.jsx("span",{className:"grid h-10 w-32 place-content-center rounded-lg bg-gray-100 text-xs text-gray-600",children:D.jsx("img",{src:rg})}),D.jsxs("ul",{className:"mt-6 space-y-1",children:[D.jsx("li",{children:D.jsx(qn,{to:"/admin/dashboard",className:"block rounded-lg px-4 py-2 text-sm font-medium text-gray-500 hover:bg-gray-100 hover:text-gray-700",children:"General"})}),D.jsx("li",{children:D.jsxs("details",{className:"group [&_summary::-webkit-details-marker]:hidden",children:[D.jsxs("summary",{className:"flex cursor-pointer items-center justify-between rounded-lg px-4 py-2 text-gray-500 hover:bg-gray-100 hover:text-gray-700",children:[D.jsx("span",{className:"text-sm font-medium",children:" Tables "}),D.jsx("span",{className:"shrink-0 transition duration-300 group-open:-rotate-180",children:D.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:D.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),D.jsx("li",{children:D.jsx(qn,{to:"/admin/create/category/contacts",className:"block rounded-lg px-4 py-2 text-sm font-medium text-gray-500 hover:bg-gray-100 hover:text-gray-700",children:"Contacts Category"})}),D.jsx("li",{children:D.jsx(qn,{to:"/admin/create/category/guidelines",className:"block rounded-lg px-4 py-2 text-sm font-medium text-gray-500 hover:bg-gray-100 hover:text-gray-700",children:"Guidelines Category"})}),D.jsxs("ul",{className:"mt-2 space-y-1 px-4",children:[D.jsx("li",{children:D.jsx(qn,{to:"/admin/create/guidelines",className:"block rounded-lg px-4 py-2 text-sm font-medium text-gray-500 hover:bg-gray-100 hover:text-gray-700",children:"Guidelines"})}),D.jsx("li",{children:D.jsx(qn,{to:"/admin/create/contacts",className:"block rounded-lg px-4 py-2 text-sm font-medium text-gray-500 hover:bg-gray-100 hover:text-gray-700",children:"Contacts"})}),D.jsx("li",{children:D.jsx(qn,{to:"/admin/create/departments",className:"block rounded-lg px-4 py-2 text-sm font-medium text-gray-500 hover:bg-gray-100 hover:text-gray-700",children:"Department"})})]})]})}),D.jsx("li",{children:D.jsx("a",{href:"#",className:"block rounded-lg px-4 py-2 text-sm font-medium text-gray-500 hover:bg-gray-100 hover:text-gray-700",children:"Annoucement"})}),D.jsx("li",{children:D.jsx("a",{href:"#",className:"block rounded-lg px-4 py-2 text-sm font-medium text-gray-500 hover:bg-gray-100 hover:text-gray-700",children:"Invoices"})}),D.jsx("li",{children:D.jsx(qn,{to:"/admin/report",className:"block rounded-lg px-4 py-2 text-sm font-medium text-gray-500 hover:bg-gray-100 hover:text-gray-700",children:"Reports"})}),D.jsx("li",{children:D.jsxs("details",{className:"group [&_summary::-webkit-details-marker]:hidden",children:[D.jsxs("summary",{className:"flex cursor-pointer items-center justify-between rounded-lg px-4 py-2 text-gray-500 hover:bg-gray-100 hover:text-gray-700",children:[D.jsx("span",{className:"text-sm font-medium",children:" Account "}),D.jsx("span",{className:"shrink-0 transition duration-300 group-open:-rotate-180",children:D.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:D.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),D.jsxs("ul",{className:"mt-2 space-y-1 px-4",children:[D.jsx("li",{children:D.jsx(qn,{to:"/admin/profile",className:"block rounded-lg px-4 py-2 text-sm font-medium text-gray-500 hover:bg-gray-100 hover:text-gray-700",children:"Profile"})}),D.jsx("li",{children:D.jsx("a",{href:"#",className:"block rounded-lg px-4 py-2 text-sm font-medium text-gray-500 hover:bg-gray-100 hover:text-gray-700",children:"Security"})}),D.jsx("li",{children:D.jsx(qn,{to:"/",onClick:a,className:"w-full rounded-lg px-4 py-2 text-sm font-medium text-gray-500 [text-align:_inherit] hover:bg-gray-100 hover:text-gray-700",children:"Logout"})})]})]})})]})]}),D.jsx("div",{className:"sticky inset-x-0 bottom-0 border-t border-gray-100",children:D.jsxs("a",{href:"#",className:"flex items-center gap-2 bg-white p-4 hover:bg-gray-50",children:[D.jsx("img",{alt:"",src:s.avatar,className:"size-10 rounded-full object-cover"}),D.jsx("div",{children:D.jsxs("p",{className:"text-xs",children:[D.jsxs("strong",{className:"block font-medium",children:[s.firstname," ",s.lastname]}),D.jsxs("span",{children:[" ",s.email," "]})]})})]})})]})}/*!
 * @kurkle/color v0.3.2
 * https://github.com/kurkle/color#readme
 * (c) 2023 Jukka Kurkela
 * Released under the MIT License
 */function Bg(e){return e+.5|0}const Uc=(e,r,s)=>Math.max(Math.min(e,s),r);function hm(e){return Uc(Bg(e*2.55),0,255)}function ru(e){return Uc(Bg(e*255),0,255)}function Tl(e){return Uc(Bg(e/2.55)/100,0,1)}function FN(e){return Uc(Bg(e*100),0,100)}const Do={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},GM=[..."0123456789ABCDEF"],eht=e=>GM[e&15],nht=e=>GM[(e&240)>>4]+GM[e&15],M0=e=>(e&240)>>4===(e&15),rht=e=>M0(e.r)&&M0(e.g)&&M0(e.b)&&M0(e.a);function iht(e){var r=e.length,s;return e[0]==="#"&&(r===4||r===5?s={r:255&Do[e[1]]*17,g:255&Do[e[2]]*17,b:255&Do[e[3]]*17,a:r===5?Do[e[4]]*17:255}:(r===7||r===9)&&(s={r:Do[e[1]]<<4|Do[e[2]],g:Do[e[3]]<<4|Do[e[4]],b:Do[e[5]]<<4|Do[e[6]],a:r===9?Do[e[7]]<<4|Do[e[8]]:255})),s}const sht=(e,r)=>e<255?r(e):"";function oht(e){var r=rht(e)?eht:nht;return e?"#"+r(e.r)+r(e.g)+r(e.b)+sht(e.a,r):void 0}const aht=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function Z8(e,r,s){const a=r*Math.min(s,1-s),h=(f,m=(f+e/30)%12)=>s-a*Math.max(Math.min(m-3,9-m,1),-1);return[h(0),h(8),h(4)]}function lht(e,r,s){const a=(h,f=(h+e/60)%6)=>s-s*r*Math.max(Math.min(f,4-f,1),0);return[a(5),a(3),a(1)]}function cht(e,r,s){const a=Z8(e,1,.5);let h;for(r+s>1&&(h=1/(r+s),r*=h,s*=h),h=0;h<3;h++)a[h]*=1-r-s,a[h]+=r;return a}function uht(e,r,s,a,h){return e===h?(r-s)/a+(r<s?6:0):r===h?(s-e)/a+2:(e-r)/a+4}function fP(e){const s=e.r/255,a=e.g/255,h=e.b/255,f=Math.max(s,a,h),m=Math.min(s,a,h),y=(f+m)/2;let x,w,T;return f!==m&&(T=f-m,w=y>.5?T/(2-f-m):T/(f+m),x=uht(s,a,h,T,f),x=x*60+.5),[x|0,w||0,y]}function pP(e,r,s,a){return(Array.isArray(r)?e(r[0],r[1],r[2]):e(r,s,a)).map(ru)}function mP(e,r,s){return pP(Z8,e,r,s)}function hht(e,r,s){return pP(cht,e,r,s)}function dht(e,r,s){return pP(lht,e,r,s)}function X8(e){return(e%360+360)%360}function fht(e){const r=aht.exec(e);let s=255,a;if(!r)return;r[5]!==a&&(s=r[6]?hm(+r[5]):ru(+r[5]));const h=X8(+r[2]),f=+r[3]/100,m=+r[4]/100;return r[1]==="hwb"?a=hht(h,f,m):r[1]==="hsv"?a=dht(h,f,m):a=mP(h,f,m),{r:a[0],g:a[1],b:a[2],a:s}}function pht(e,r){var s=fP(e);s[0]=X8(s[0]+r),s=mP(s),e.r=s[0],e.g=s[1],e.b=s[2]}function mht(e){if(!e)return;const r=fP(e),s=r[0],a=FN(r[1]),h=FN(r[2]);return e.a<255?`hsla(${s}, ${a}%, ${h}%, ${Tl(e.a)})`:`hsl(${s}, ${a}%, ${h}%)`}const BN={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},jN={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function ght(){const e={},r=Object.keys(jN),s=Object.keys(BN);let a,h,f,m,y;for(a=0;a<r.length;a++){for(m=y=r[a],h=0;h<s.length;h++)f=s[h],y=y.replace(f,BN[f]);f=parseInt(jN[m],16),e[y]=[f>>16&255,f>>8&255,f&255]}return e}let A0;function _ht(e){A0||(A0=ght(),A0.transparent=[0,0,0,0]);const r=A0[e.toLowerCase()];return r&&{r:r[0],g:r[1],b:r[2],a:r.length===4?r[3]:255}}const yht=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function vht(e){const r=yht.exec(e);let s=255,a,h,f;if(r){if(r[7]!==a){const m=+r[7];s=r[8]?hm(m):Uc(m*255,0,255)}return a=+r[1],h=+r[3],f=+r[5],a=255&(r[2]?hm(a):Uc(a,0,255)),h=255&(r[4]?hm(h):Uc(h,0,255)),f=255&(r[6]?hm(f):Uc(f,0,255)),{r:a,g:h,b:f,a:s}}}function xht(e){return e&&(e.a<255?`rgba(${e.r}, ${e.g}, ${e.b}, ${Tl(e.a)})`:`rgb(${e.r}, ${e.g}, ${e.b})`)}const XT=e=>e<=.0031308?e*12.92:Math.pow(e,1/2.4)*1.055-.055,Ld=e=>e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4);function bht(e,r,s){const a=Ld(Tl(e.r)),h=Ld(Tl(e.g)),f=Ld(Tl(e.b));return{r:ru(XT(a+s*(Ld(Tl(r.r))-a))),g:ru(XT(h+s*(Ld(Tl(r.g))-h))),b:ru(XT(f+s*(Ld(Tl(r.b))-f))),a:e.a+s*(r.a-e.a)}}function C0(e,r,s){if(e){let a=fP(e);a[r]=Math.max(0,Math.min(a[r]+a[r]*s,r===0?360:1)),a=mP(a),e.r=a[0],e.g=a[1],e.b=a[2]}}function Y8(e,r){return e&&Object.assign(r||{},e)}function VN(e){var r={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(r={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(r.a=ru(e[3]))):(r=Y8(e,{r:0,g:0,b:0,a:1}),r.a=ru(r.a)),r}function wht(e){return e.charAt(0)==="r"?vht(e):fht(e)}class fg{constructor(r){if(r instanceof fg)return r;const s=typeof r;let a;s==="object"?a=VN(r):s==="string"&&(a=iht(r)||_ht(r)||wht(r)),this._rgb=a,this._valid=!!a}get valid(){return this._valid}get rgb(){var r=Y8(this._rgb);return r&&(r.a=Tl(r.a)),r}set rgb(r){this._rgb=VN(r)}rgbString(){return this._valid?xht(this._rgb):void 0}hexString(){return this._valid?oht(this._rgb):void 0}hslString(){return this._valid?mht(this._rgb):void 0}mix(r,s){if(r){const a=this.rgb,h=r.rgb;let f;const m=s===f?.5:s,y=2*m-1,x=a.a-h.a,w=((y*x===-1?y:(y+x)/(1+y*x))+1)/2;f=1-w,a.r=255&w*a.r+f*h.r+.5,a.g=255&w*a.g+f*h.g+.5,a.b=255&w*a.b+f*h.b+.5,a.a=m*a.a+(1-m)*h.a,this.rgb=a}return this}interpolate(r,s){return r&&(this._rgb=bht(this._rgb,r._rgb,s)),this}clone(){return new fg(this.rgb)}alpha(r){return this._rgb.a=ru(r),this}clearer(r){const s=this._rgb;return s.a*=1-r,this}greyscale(){const r=this._rgb,s=Bg(r.r*.3+r.g*.59+r.b*.11);return r.r=r.g=r.b=s,this}opaquer(r){const s=this._rgb;return s.a*=1+r,this}negate(){const r=this._rgb;return r.r=255-r.r,r.g=255-r.g,r.b=255-r.b,this}lighten(r){return C0(this._rgb,2,r),this}darken(r){return C0(this._rgb,2,-r),this}saturate(r){return C0(this._rgb,1,r),this}desaturate(r){return C0(this._rgb,1,-r),this}rotate(r){return pht(this._rgb,r),this}}/*!
 * Chart.js v4.4.1
 * https://www.chartjs.org
 * (c) 2023 Chart.js Contributors
 * Released under the MIT License
 */function yl(){}const Sht=(()=>{let e=0;return()=>e++})();function sr(e){return e===null||typeof e>"u"}function jr(e){if(Array.isArray&&Array.isArray(e))return!0;const r=Object.prototype.toString.call(e);return r.slice(0,7)==="[object"&&r.slice(-6)==="Array]"}function Zn(e){return e!==null&&Object.prototype.toString.call(e)==="[object Object]"}function di(e){return(typeof e=="number"||e instanceof Number)&&isFinite(+e)}function io(e,r){return di(e)?e:r}function On(e,r){return typeof e>"u"?r:e}const Tht=(e,r)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100:+e/r,K8=(e,r)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100*r:+e;function Lr(e,r,s){if(e&&typeof e.call=="function")return e.apply(s,r)}function xr(e,r,s,a){let h,f,m;if(jr(e))if(f=e.length,a)for(h=f-1;h>=0;h--)r.call(s,e[h],h);else for(h=0;h<f;h++)r.call(s,e[h],h);else if(Zn(e))for(m=Object.keys(e),f=m.length,h=0;h<f;h++)r.call(s,e[m[h]],m[h])}function gx(e,r){let s,a,h,f;if(!e||!r||e.length!==r.length)return!1;for(s=0,a=e.length;s<a;++s)if(h=e[s],f=r[s],h.datasetIndex!==f.datasetIndex||h.index!==f.index)return!1;return!0}function _x(e){if(jr(e))return e.map(_x);if(Zn(e)){const r=Object.create(null),s=Object.keys(e),a=s.length;let h=0;for(;h<a;++h)r[s[h]]=_x(e[s[h]]);return r}return e}function J8(e){return["__proto__","prototype","constructor"].indexOf(e)===-1}function Eht(e,r,s,a){if(!J8(e))return;const h=r[e],f=s[e];Zn(h)&&Zn(f)?pg(h,f,a):r[e]=_x(f)}function pg(e,r,s){const a=jr(r)?r:[r],h=a.length;if(!Zn(e))return e;s=s||{};const f=s.merger||Eht;let m;for(let y=0;y<h;++y){if(m=a[y],!Zn(m))continue;const x=Object.keys(m);for(let w=0,T=x.length;w<T;++w)f(x[w],e,m,s)}return e}function Dm(e,r){return pg(e,r,{merger:Mht})}function Mht(e,r,s){if(!J8(e))return;const a=r[e],h=s[e];Zn(a)&&Zn(h)?Dm(a,h):Object.prototype.hasOwnProperty.call(r,e)||(r[e]=_x(h))}const UN={"":e=>e,x:e=>e.x,y:e=>e.y};function Aht(e){const r=e.split("."),s=[];let a="";for(const h of r)a+=h,a.endsWith("\\")?a=a.slice(0,-1)+".":(s.push(a),a="");return s}function Cht(e){const r=Aht(e);return s=>{for(const a of r){if(a==="")break;s=s&&s[a]}return s}}function du(e,r){return(UN[r]||(UN[r]=Cht(r)))(e)}function gP(e){return e.charAt(0).toUpperCase()+e.slice(1)}const mg=e=>typeof e<"u",fu=e=>typeof e=="function",$N=(e,r)=>{if(e.size!==r.size)return!1;for(const s of e)if(!r.has(s))return!1;return!0};function Pht(e){return e.type==="mouseup"||e.type==="click"||e.type==="contextmenu"}const $r=Math.PI,Ur=2*$r,Iht=Ur+$r,yx=Number.POSITIVE_INFINITY,kht=$r/180,Ti=$r/2,Yu=$r/4,GN=$r*2/3,$c=Math.log10,qa=Math.sign;function Rm(e,r,s){return Math.abs(e-r)<s}function WN(e){const r=Math.round(e);e=Rm(e,r,e/1e3)?r:e;const s=Math.pow(10,Math.floor($c(e))),a=e/s;return(a<=1?1:a<=2?2:a<=5?5:10)*s}function Dht(e){const r=[],s=Math.sqrt(e);let a;for(a=1;a<s;a++)e%a===0&&(r.push(a),r.push(e/a));return s===(s|0)&&r.push(s),r.sort((h,f)=>h-f).pop(),r}function xf(e){return!isNaN(parseFloat(e))&&isFinite(e)}function Rht(e,r){const s=Math.round(e);return s-r<=e&&s+r>=e}function Q8(e,r,s){let a,h,f;for(a=0,h=e.length;a<h;a++)f=e[a][s],isNaN(f)||(r.min=Math.min(r.min,f),r.max=Math.max(r.max,f))}function ha(e){return e*($r/180)}function _P(e){return e*(180/$r)}function HN(e){if(!di(e))return;let r=1,s=0;for(;Math.round(e*r)/r!==e;)r*=10,s++;return s}function t$(e,r){const s=r.x-e.x,a=r.y-e.y,h=Math.sqrt(s*s+a*a);let f=Math.atan2(a,s);return f<-.5*$r&&(f+=Ur),{angle:f,distance:h}}function WM(e,r){return Math.sqrt(Math.pow(r.x-e.x,2)+Math.pow(r.y-e.y,2))}function Oht(e,r){return(e-r+Iht)%Ur-$r}function oo(e){return(e%Ur+Ur)%Ur}function gg(e,r,s,a){const h=oo(e),f=oo(r),m=oo(s),y=oo(f-h),x=oo(m-h),w=oo(h-f),T=oo(h-m);return h===f||h===m||a&&f===m||y>x&&w<T}function Wi(e,r,s){return Math.max(r,Math.min(s,e))}function Lht(e){return Wi(e,-32768,32767)}function Cl(e,r,s,a=1e-6){return e>=Math.min(r,s)-a&&e<=Math.max(r,s)+a}function yP(e,r,s){s=s||(m=>e[m]<r);let a=e.length-1,h=0,f;for(;a-h>1;)f=h+a>>1,s(f)?h=f:a=f;return{lo:h,hi:a}}const Pl=(e,r,s,a)=>yP(e,s,a?h=>{const f=e[h][r];return f<s||f===s&&e[h+1][r]===s}:h=>e[h][r]<s),zht=(e,r,s)=>yP(e,s,a=>e[a][r]>=s);function Nht(e,r,s){let a=0,h=e.length;for(;a<h&&e[a]<r;)a++;for(;h>a&&e[h-1]>s;)h--;return a>0||h<e.length?e.slice(a,h):e}const e$=["push","pop","shift","splice","unshift"];function Fht(e,r){if(e._chartjs){e._chartjs.listeners.push(r);return}Object.defineProperty(e,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[r]}}),e$.forEach(s=>{const a="_onData"+gP(s),h=e[s];Object.defineProperty(e,s,{configurable:!0,enumerable:!1,value(...f){const m=h.apply(this,f);return e._chartjs.listeners.forEach(y=>{typeof y[a]=="function"&&y[a](...f)}),m}})})}function qN(e,r){const s=e._chartjs;if(!s)return;const a=s.listeners,h=a.indexOf(r);h!==-1&&a.splice(h,1),!(a.length>0)&&(e$.forEach(f=>{delete e[f]}),delete e._chartjs)}function n$(e){const r=new Set(e);return r.size===e.length?e:Array.from(r)}const r$=function(){return typeof window>"u"?function(e){return e()}:window.requestAnimationFrame}();function i$(e,r){let s=[],a=!1;return function(...h){s=h,a||(a=!0,r$.call(window,()=>{a=!1,e.apply(r,s)}))}}function Bht(e,r){let s;return function(...a){return r?(clearTimeout(s),s=setTimeout(e,r,a)):e.apply(this,a),r}}const vP=e=>e==="start"?"left":e==="end"?"right":"center",us=(e,r,s)=>e==="start"?r:e==="end"?s:(r+s)/2,jht=(e,r,s,a)=>e===(a?"left":"right")?s:e==="center"?(r+s)/2:r;function s$(e,r,s){const a=r.length;let h=0,f=a;if(e._sorted){const{iScale:m,_parsed:y}=e,x=m.axis,{min:w,max:T,minDefined:M,maxDefined:I}=m.getUserBounds();M&&(h=Wi(Math.min(Pl(y,x,w).lo,s?a:Pl(r,x,m.getPixelForValue(w)).lo),0,a-1)),I?f=Wi(Math.max(Pl(y,m.axis,T,!0).hi+1,s?0:Pl(r,x,m.getPixelForValue(T),!0).hi+1),h,a)-h:f=a-h}return{start:h,count:f}}function o$(e){const{xScale:r,yScale:s,_scaleRanges:a}=e,h={xmin:r.min,xmax:r.max,ymin:s.min,ymax:s.max};if(!a)return e._scaleRanges=h,!0;const f=a.xmin!==r.min||a.xmax!==r.max||a.ymin!==s.min||a.ymax!==s.max;return Object.assign(a,h),f}const P0=e=>e===0||e===1,ZN=(e,r,s)=>-(Math.pow(2,10*(e-=1))*Math.sin((e-r)*Ur/s)),XN=(e,r,s)=>Math.pow(2,-10*e)*Math.sin((e-r)*Ur/s)+1,Om={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>-e*(e-2),easeInOutQuad:e=>(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1),easeInCubic:e=>e*e*e,easeOutCubic:e=>(e-=1)*e*e+1,easeInOutCubic:e=>(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>-((e-=1)*e*e*e-1),easeInOutQuart:e=>(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>(e-=1)*e*e*e*e+1,easeInOutQuint:e=>(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2),easeInSine:e=>-Math.cos(e*Ti)+1,easeOutSine:e=>Math.sin(e*Ti),easeInOutSine:e=>-.5*(Math.cos($r*e)-1),easeInExpo:e=>e===0?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>e===1?1:-Math.pow(2,-10*e)+1,easeInOutExpo:e=>P0(e)?e:e<.5?.5*Math.pow(2,10*(e*2-1)):.5*(-Math.pow(2,-10*(e*2-1))+2),easeInCirc:e=>e>=1?e:-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-(e-=1)*e),easeInOutCirc:e=>(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1),easeInElastic:e=>P0(e)?e:ZN(e,.075,.3),easeOutElastic:e=>P0(e)?e:XN(e,.075,.3),easeInOutElastic(e){return P0(e)?e:e<.5?.5*ZN(e*2,.1125,.45):.5+.5*XN(e*2-1,.1125,.45)},easeInBack(e){return e*e*((1.70158+1)*e-1.70158)},easeOutBack(e){return(e-=1)*e*((1.70158+1)*e+1.70158)+1},easeInOutBack(e){let r=1.70158;return(e/=.5)<1?.5*(e*e*(((r*=1.525)+1)*e-r)):.5*((e-=2)*e*(((r*=1.525)+1)*e+r)+2)},easeInBounce:e=>1-Om.easeOutBounce(1-e),easeOutBounce(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},easeInOutBounce:e=>e<.5?Om.easeInBounce(e*2)*.5:Om.easeOutBounce(e*2-1)*.5+.5};function xP(e){if(e&&typeof e=="object"){const r=e.toString();return r==="[object CanvasPattern]"||r==="[object CanvasGradient]"}return!1}function YN(e){return xP(e)?e:new fg(e)}function YT(e){return xP(e)?e:new fg(e).saturate(.5).darken(.1).hexString()}const Vht=["x","y","borderWidth","radius","tension"],Uht=["color","borderColor","backgroundColor"];function $ht(e){e.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),e.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:r=>r!=="onProgress"&&r!=="onComplete"&&r!=="fn"}),e.set("animations",{colors:{type:"color",properties:Uht},numbers:{type:"number",properties:Vht}}),e.describe("animations",{_fallback:"animation"}),e.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:r=>r|0}}}})}function Ght(e){e.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const KN=new Map;function Wht(e,r){r=r||{};const s=e+JSON.stringify(r);let a=KN.get(s);return a||(a=new Intl.NumberFormat(e,r),KN.set(s,a)),a}function jg(e,r,s){return Wht(r,s).format(e)}const a$={values(e){return jr(e)?e:""+e},numeric(e,r,s){if(e===0)return"0";const a=this.chart.options.locale;let h,f=e;if(s.length>1){const w=Math.max(Math.abs(s[0].value),Math.abs(s[s.length-1].value));(w<1e-4||w>1e15)&&(h="scientific"),f=Hht(e,s)}const m=$c(Math.abs(f)),y=isNaN(m)?1:Math.max(Math.min(-1*Math.floor(m),20),0),x={notation:h,minimumFractionDigits:y,maximumFractionDigits:y};return Object.assign(x,this.options.ticks.format),jg(e,a,x)},logarithmic(e,r,s){if(e===0)return"0";const a=s[r].significand||e/Math.pow(10,Math.floor($c(e)));return[1,2,3,5,10,15].includes(a)||r>.8*s.length?a$.numeric.call(this,e,r,s):""}};function Hht(e,r){let s=r.length>3?r[2].value-r[1].value:r[1].value-r[0].value;return Math.abs(s)>=1&&e!==Math.floor(e)&&(s=e-Math.floor(e)),s}var _1={formatters:a$};function qht(e){e.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(r,s)=>s.lineWidth,tickColor:(r,s)=>s.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:_1.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),e.route("scale.ticks","color","","color"),e.route("scale.grid","color","","borderColor"),e.route("scale.border","color","","borderColor"),e.route("scale.title","color","","color"),e.describe("scale",{_fallback:!1,_scriptable:r=>!r.startsWith("before")&&!r.startsWith("after")&&r!=="callback"&&r!=="parser",_indexable:r=>r!=="borderDash"&&r!=="tickBorderDash"&&r!=="dash"}),e.describe("scales",{_fallback:"scale"}),e.describe("scale.ticks",{_scriptable:r=>r!=="backdropPadding"&&r!=="callback",_indexable:r=>r!=="backdropPadding"})}const Ch=Object.create(null),HM=Object.create(null);function Lm(e,r){if(!r)return e;const s=r.split(".");for(let a=0,h=s.length;a<h;++a){const f=s[a];e=e[f]||(e[f]=Object.create(null))}return e}function KT(e,r,s){return typeof r=="string"?pg(Lm(e,r),s):pg(Lm(e,""),r)}class Zht{constructor(r,s){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=a=>a.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(a,h)=>YT(h.backgroundColor),this.hoverBorderColor=(a,h)=>YT(h.borderColor),this.hoverColor=(a,h)=>YT(h.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(r),this.apply(s)}set(r,s){return KT(this,r,s)}get(r){return Lm(this,r)}describe(r,s){return KT(HM,r,s)}override(r,s){return KT(Ch,r,s)}route(r,s,a,h){const f=Lm(this,r),m=Lm(this,a),y="_"+s;Object.defineProperties(f,{[y]:{value:f[s],writable:!0},[s]:{enumerable:!0,get(){const x=this[y],w=m[h];return Zn(x)?Object.assign({},w,x):On(x,w)},set(x){this[y]=x}}})}apply(r){r.forEach(s=>s(this))}}var fi=new Zht({_scriptable:e=>!e.startsWith("on"),_indexable:e=>e!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[$ht,Ght,qht]);function Xht(e){return!e||sr(e.size)||sr(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}function vx(e,r,s,a,h){let f=r[h];return f||(f=r[h]=e.measureText(h).width,s.push(h)),f>a&&(a=f),a}function Yht(e,r,s,a){a=a||{};let h=a.data=a.data||{},f=a.garbageCollect=a.garbageCollect||[];a.font!==r&&(h=a.data={},f=a.garbageCollect=[],a.font=r),e.save(),e.font=r;let m=0;const y=s.length;let x,w,T,M,I;for(x=0;x<y;x++)if(M=s[x],M!=null&&!jr(M))m=vx(e,h,f,m,M);else if(jr(M))for(w=0,T=M.length;w<T;w++)I=M[w],I!=null&&!jr(I)&&(m=vx(e,h,f,m,I));e.restore();const R=f.length/2;if(R>s.length){for(x=0;x<R;x++)delete h[f[x]];f.splice(0,R)}return m}function Ku(e,r,s){const a=e.currentDevicePixelRatio,h=s!==0?Math.max(s/2,.5):0;return Math.round((r-h)*a)/a+h}function JN(e,r){r=r||e.getContext("2d"),r.save(),r.resetTransform(),r.clearRect(0,0,e.width,e.height),r.restore()}function qM(e,r,s,a){l$(e,r,s,a,null)}function l$(e,r,s,a,h){let f,m,y,x,w,T,M,I;const R=r.pointStyle,O=r.rotation,N=r.radius;let G=(O||0)*kht;if(R&&typeof R=="object"&&(f=R.toString(),f==="[object HTMLImageElement]"||f==="[object HTMLCanvasElement]")){e.save(),e.translate(s,a),e.rotate(G),e.drawImage(R,-R.width/2,-R.height/2,R.width,R.height),e.restore();return}if(!(isNaN(N)||N<=0)){switch(e.beginPath(),R){default:h?e.ellipse(s,a,h/2,N,0,0,Ur):e.arc(s,a,N,0,Ur),e.closePath();break;case"triangle":T=h?h/2:N,e.moveTo(s+Math.sin(G)*T,a-Math.cos(G)*N),G+=GN,e.lineTo(s+Math.sin(G)*T,a-Math.cos(G)*N),G+=GN,e.lineTo(s+Math.sin(G)*T,a-Math.cos(G)*N),e.closePath();break;case"rectRounded":w=N*.516,x=N-w,m=Math.cos(G+Yu)*x,M=Math.cos(G+Yu)*(h?h/2-w:x),y=Math.sin(G+Yu)*x,I=Math.sin(G+Yu)*(h?h/2-w:x),e.arc(s-M,a-y,w,G-$r,G-Ti),e.arc(s+I,a-m,w,G-Ti,G),e.arc(s+M,a+y,w,G,G+Ti),e.arc(s-I,a+m,w,G+Ti,G+$r),e.closePath();break;case"rect":if(!O){x=Math.SQRT1_2*N,T=h?h/2:x,e.rect(s-T,a-x,2*T,2*x);break}G+=Yu;case"rectRot":M=Math.cos(G)*(h?h/2:N),m=Math.cos(G)*N,y=Math.sin(G)*N,I=Math.sin(G)*(h?h/2:N),e.moveTo(s-M,a-y),e.lineTo(s+I,a-m),e.lineTo(s+M,a+y),e.lineTo(s-I,a+m),e.closePath();break;case"crossRot":G+=Yu;case"cross":M=Math.cos(G)*(h?h/2:N),m=Math.cos(G)*N,y=Math.sin(G)*N,I=Math.sin(G)*(h?h/2:N),e.moveTo(s-M,a-y),e.lineTo(s+M,a+y),e.moveTo(s+I,a-m),e.lineTo(s-I,a+m);break;case"star":M=Math.cos(G)*(h?h/2:N),m=Math.cos(G)*N,y=Math.sin(G)*N,I=Math.sin(G)*(h?h/2:N),e.moveTo(s-M,a-y),e.lineTo(s+M,a+y),e.moveTo(s+I,a-m),e.lineTo(s-I,a+m),G+=Yu,M=Math.cos(G)*(h?h/2:N),m=Math.cos(G)*N,y=Math.sin(G)*N,I=Math.sin(G)*(h?h/2:N),e.moveTo(s-M,a-y),e.lineTo(s+M,a+y),e.moveTo(s+I,a-m),e.lineTo(s-I,a+m);break;case"line":m=h?h/2:Math.cos(G)*N,y=Math.sin(G)*N,e.moveTo(s-m,a-y),e.lineTo(s+m,a+y);break;case"dash":e.moveTo(s,a),e.lineTo(s+Math.cos(G)*(h?h/2:N),a+Math.sin(G)*N);break;case!1:e.closePath();break}e.fill(),r.borderWidth>0&&e.stroke()}}function Il(e,r,s){return s=s||.5,!r||e&&e.x>r.left-s&&e.x<r.right+s&&e.y>r.top-s&&e.y<r.bottom+s}function y1(e,r){e.save(),e.beginPath(),e.rect(r.left,r.top,r.right-r.left,r.bottom-r.top),e.clip()}function v1(e){e.restore()}function Kht(e,r,s,a,h){if(!r)return e.lineTo(s.x,s.y);if(h==="middle"){const f=(r.x+s.x)/2;e.lineTo(f,r.y),e.lineTo(f,s.y)}else h==="after"!=!!a?e.lineTo(r.x,s.y):e.lineTo(s.x,r.y);e.lineTo(s.x,s.y)}function Jht(e,r,s,a){if(!r)return e.lineTo(s.x,s.y);e.bezierCurveTo(a?r.cp1x:r.cp2x,a?r.cp1y:r.cp2y,a?s.cp2x:s.cp1x,a?s.cp2y:s.cp1y,s.x,s.y)}function Qht(e,r){r.translation&&e.translate(r.translation[0],r.translation[1]),sr(r.rotation)||e.rotate(r.rotation),r.color&&(e.fillStyle=r.color),r.textAlign&&(e.textAlign=r.textAlign),r.textBaseline&&(e.textBaseline=r.textBaseline)}function tdt(e,r,s,a,h){if(h.strikethrough||h.underline){const f=e.measureText(a),m=r-f.actualBoundingBoxLeft,y=r+f.actualBoundingBoxRight,x=s-f.actualBoundingBoxAscent,w=s+f.actualBoundingBoxDescent,T=h.strikethrough?(x+w)/2:w;e.strokeStyle=e.fillStyle,e.beginPath(),e.lineWidth=h.decorationWidth||2,e.moveTo(m,T),e.lineTo(y,T),e.stroke()}}function edt(e,r){const s=e.fillStyle;e.fillStyle=r.color,e.fillRect(r.left,r.top,r.width,r.height),e.fillStyle=s}function Ph(e,r,s,a,h,f={}){const m=jr(r)?r:[r],y=f.strokeWidth>0&&f.strokeColor!=="";let x,w;for(e.save(),e.font=h.string,Qht(e,f),x=0;x<m.length;++x)w=m[x],f.backdrop&&edt(e,f.backdrop),y&&(f.strokeColor&&(e.strokeStyle=f.strokeColor),sr(f.strokeWidth)||(e.lineWidth=f.strokeWidth),e.strokeText(w,s,a,f.maxWidth)),e.fillText(w,s,a,f.maxWidth),tdt(e,s,a,w,f),a+=Number(h.lineHeight);e.restore()}function _g(e,r){const{x:s,y:a,w:h,h:f,radius:m}=r;e.arc(s+m.topLeft,a+m.topLeft,m.topLeft,1.5*$r,$r,!0),e.lineTo(s,a+f-m.bottomLeft),e.arc(s+m.bottomLeft,a+f-m.bottomLeft,m.bottomLeft,$r,Ti,!0),e.lineTo(s+h-m.bottomRight,a+f),e.arc(s+h-m.bottomRight,a+f-m.bottomRight,m.bottomRight,Ti,0,!0),e.lineTo(s+h,a+m.topRight),e.arc(s+h-m.topRight,a+m.topRight,m.topRight,0,-Ti,!0),e.lineTo(s+m.topLeft,a)}const ndt=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,rdt=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function idt(e,r){const s=(""+e).match(ndt);if(!s||s[1]==="normal")return r*1.2;switch(e=+s[2],s[3]){case"px":return e;case"%":e/=100;break}return r*e}const sdt=e=>+e||0;function bP(e,r){const s={},a=Zn(r),h=a?Object.keys(r):r,f=Zn(e)?a?m=>On(e[m],e[r[m]]):m=>e[m]:()=>e;for(const m of h)s[m]=sdt(f(m));return s}function c$(e){return bP(e,{top:"y",right:"x",bottom:"y",left:"x"})}function vh(e){return bP(e,["topLeft","topRight","bottomLeft","bottomRight"])}function ps(e){const r=c$(e);return r.width=r.left+r.right,r.height=r.top+r.bottom,r}function Vi(e,r){e=e||{},r=r||fi.font;let s=On(e.size,r.size);typeof s=="string"&&(s=parseInt(s,10));let a=On(e.style,r.style);a&&!(""+a).match(rdt)&&(console.warn('Invalid font style specified: "'+a+'"'),a=void 0);const h={family:On(e.family,r.family),lineHeight:idt(On(e.lineHeight,r.lineHeight),s),size:s,style:a,weight:On(e.weight,r.weight),string:""};return h.string=Xht(h),h}function dm(e,r,s,a){let h=!0,f,m,y;for(f=0,m=e.length;f<m;++f)if(y=e[f],y!==void 0&&(r!==void 0&&typeof y=="function"&&(y=y(r),h=!1),s!==void 0&&jr(y)&&(y=y[s%y.length],h=!1),y!==void 0))return a&&!h&&(a.cacheable=!1),y}function odt(e,r,s){const{min:a,max:h}=e,f=K8(r,(h-a)/2),m=(y,x)=>s&&y===0?0:y+x;return{min:m(a,-Math.abs(f)),max:m(h,f)}}function xu(e,r){return Object.assign(Object.create(e),r)}function wP(e,r=[""],s,a,h=()=>e[0]){const f=s||e;typeof a>"u"&&(a=f$("_fallback",e));const m={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:e,_rootScopes:f,_fallback:a,_getTarget:h,override:y=>wP([y,...e],r,f,a)};return new Proxy(m,{deleteProperty(y,x){return delete y[x],delete y._keys,delete e[0][x],!0},get(y,x){return h$(y,x,()=>pdt(x,r,e,y))},getOwnPropertyDescriptor(y,x){return Reflect.getOwnPropertyDescriptor(y._scopes[0],x)},getPrototypeOf(){return Reflect.getPrototypeOf(e[0])},has(y,x){return tF(y).includes(x)},ownKeys(y){return tF(y)},set(y,x,w){const T=y._storage||(y._storage=h());return y[x]=T[x]=w,delete y._keys,!0}})}function bf(e,r,s,a){const h={_cacheable:!1,_proxy:e,_context:r,_subProxy:s,_stack:new Set,_descriptors:u$(e,a),setContext:f=>bf(e,f,s,a),override:f=>bf(e.override(f),r,s,a)};return new Proxy(h,{deleteProperty(f,m){return delete f[m],delete e[m],!0},get(f,m,y){return h$(f,m,()=>ldt(f,m,y))},getOwnPropertyDescriptor(f,m){return f._descriptors.allKeys?Reflect.has(e,m)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(e,m)},getPrototypeOf(){return Reflect.getPrototypeOf(e)},has(f,m){return Reflect.has(e,m)},ownKeys(){return Reflect.ownKeys(e)},set(f,m,y){return e[m]=y,delete f[m],!0}})}function u$(e,r={scriptable:!0,indexable:!0}){const{_scriptable:s=r.scriptable,_indexable:a=r.indexable,_allKeys:h=r.allKeys}=e;return{allKeys:h,scriptable:s,indexable:a,isScriptable:fu(s)?s:()=>s,isIndexable:fu(a)?a:()=>a}}const adt=(e,r)=>e?e+gP(r):r,SP=(e,r)=>Zn(r)&&e!=="adapters"&&(Object.getPrototypeOf(r)===null||r.constructor===Object);function h$(e,r,s){if(Object.prototype.hasOwnProperty.call(e,r))return e[r];const a=s();return e[r]=a,a}function ldt(e,r,s){const{_proxy:a,_context:h,_subProxy:f,_descriptors:m}=e;let y=a[r];return fu(y)&&m.isScriptable(r)&&(y=cdt(r,y,e,s)),jr(y)&&y.length&&(y=udt(r,y,e,m.isIndexable)),SP(r,y)&&(y=bf(y,h,f&&f[r],m)),y}function cdt(e,r,s,a){const{_proxy:h,_context:f,_subProxy:m,_stack:y}=s;if(y.has(e))throw new Error("Recursion detected: "+Array.from(y).join("->")+"->"+e);y.add(e);let x=r(f,m||a);return y.delete(e),SP(e,x)&&(x=TP(h._scopes,h,e,x)),x}function udt(e,r,s,a){const{_proxy:h,_context:f,_subProxy:m,_descriptors:y}=s;if(typeof f.index<"u"&&a(e))return r[f.index%r.length];if(Zn(r[0])){const x=r,w=h._scopes.filter(T=>T!==x);r=[];for(const T of x){const M=TP(w,h,e,T);r.push(bf(M,f,m&&m[e],y))}}return r}function d$(e,r,s){return fu(e)?e(r,s):e}const hdt=(e,r)=>e===!0?r:typeof e=="string"?du(r,e):void 0;function ddt(e,r,s,a,h){for(const f of r){const m=hdt(s,f);if(m){e.add(m);const y=d$(m._fallback,s,h);if(typeof y<"u"&&y!==s&&y!==a)return y}else if(m===!1&&typeof a<"u"&&s!==a)return null}return!1}function TP(e,r,s,a){const h=r._rootScopes,f=d$(r._fallback,s,a),m=[...e,...h],y=new Set;y.add(a);let x=QN(y,m,s,f||s,a);return x===null||typeof f<"u"&&f!==s&&(x=QN(y,m,f,x,a),x===null)?!1:wP(Array.from(y),[""],h,f,()=>fdt(r,s,a))}function QN(e,r,s,a,h){for(;s;)s=ddt(e,r,s,a,h);return s}function fdt(e,r,s){const a=e._getTarget();r in a||(a[r]={});const h=a[r];return jr(h)&&Zn(s)?s:h||{}}function pdt(e,r,s,a){let h;for(const f of r)if(h=f$(adt(f,e),s),typeof h<"u")return SP(e,h)?TP(s,a,e,h):h}function f$(e,r){for(const s of r){if(!s)continue;const a=s[e];if(typeof a<"u")return a}}function tF(e){let r=e._keys;return r||(r=e._keys=mdt(e._scopes)),r}function mdt(e){const r=new Set;for(const s of e)for(const a of Object.keys(s).filter(h=>!h.startsWith("_")))r.add(a);return Array.from(r)}function p$(e,r,s,a){const{iScale:h}=e,{key:f="r"}=this._parsing,m=new Array(a);let y,x,w,T;for(y=0,x=a;y<x;++y)w=y+s,T=r[w],m[y]={r:h.parse(du(T,f),w)};return m}const gdt=Number.EPSILON||1e-14,wf=(e,r)=>r<e.length&&!e[r].skip&&e[r],m$=e=>e==="x"?"y":"x";function _dt(e,r,s,a){const h=e.skip?r:e,f=r,m=s.skip?r:s,y=WM(f,h),x=WM(m,f);let w=y/(y+x),T=x/(y+x);w=isNaN(w)?0:w,T=isNaN(T)?0:T;const M=a*w,I=a*T;return{previous:{x:f.x-M*(m.x-h.x),y:f.y-M*(m.y-h.y)},next:{x:f.x+I*(m.x-h.x),y:f.y+I*(m.y-h.y)}}}function ydt(e,r,s){const a=e.length;let h,f,m,y,x,w=wf(e,0);for(let T=0;T<a-1;++T)if(x=w,w=wf(e,T+1),!(!x||!w)){if(Rm(r[T],0,gdt)){s[T]=s[T+1]=0;continue}h=s[T]/r[T],f=s[T+1]/r[T],y=Math.pow(h,2)+Math.pow(f,2),!(y<=9)&&(m=3/Math.sqrt(y),s[T]=h*m*r[T],s[T+1]=f*m*r[T])}}function vdt(e,r,s="x"){const a=m$(s),h=e.length;let f,m,y,x=wf(e,0);for(let w=0;w<h;++w){if(m=y,y=x,x=wf(e,w+1),!y)continue;const T=y[s],M=y[a];m&&(f=(T-m[s])/3,y[`cp1${s}`]=T-f,y[`cp1${a}`]=M-f*r[w]),x&&(f=(x[s]-T)/3,y[`cp2${s}`]=T+f,y[`cp2${a}`]=M+f*r[w])}}function xdt(e,r="x"){const s=m$(r),a=e.length,h=Array(a).fill(0),f=Array(a);let m,y,x,w=wf(e,0);for(m=0;m<a;++m)if(y=x,x=w,w=wf(e,m+1),!!x){if(w){const T=w[r]-x[r];h[m]=T!==0?(w[s]-x[s])/T:0}f[m]=y?w?qa(h[m-1])!==qa(h[m])?0:(h[m-1]+h[m])/2:h[m-1]:h[m]}ydt(e,h,f),vdt(e,f,r)}function I0(e,r,s){return Math.max(Math.min(e,s),r)}function bdt(e,r){let s,a,h,f,m,y=Il(e[0],r);for(s=0,a=e.length;s<a;++s)m=f,f=y,y=s<a-1&&Il(e[s+1],r),f&&(h=e[s],m&&(h.cp1x=I0(h.cp1x,r.left,r.right),h.cp1y=I0(h.cp1y,r.top,r.bottom)),y&&(h.cp2x=I0(h.cp2x,r.left,r.right),h.cp2y=I0(h.cp2y,r.top,r.bottom)))}function wdt(e,r,s,a,h){let f,m,y,x;if(r.spanGaps&&(e=e.filter(w=>!w.skip)),r.cubicInterpolationMode==="monotone")xdt(e,h);else{let w=a?e[e.length-1]:e[0];for(f=0,m=e.length;f<m;++f)y=e[f],x=_dt(w,y,e[Math.min(f+1,m-(a?0:1))%m],r.tension),y.cp1x=x.previous.x,y.cp1y=x.previous.y,y.cp2x=x.next.x,y.cp2y=x.next.y,w=y}r.capBezierPoints&&bdt(e,s)}function EP(){return typeof window<"u"&&typeof document<"u"}function MP(e){let r=e.parentNode;return r&&r.toString()==="[object ShadowRoot]"&&(r=r.host),r}function xx(e,r,s){let a;return typeof e=="string"?(a=parseInt(e,10),e.indexOf("%")!==-1&&(a=a/100*r.parentNode[s])):a=e,a}const x1=e=>e.ownerDocument.defaultView.getComputedStyle(e,null);function Sdt(e,r){return x1(e).getPropertyValue(r)}const Tdt=["top","right","bottom","left"];function xh(e,r,s){const a={};s=s?"-"+s:"";for(let h=0;h<4;h++){const f=Tdt[h];a[f]=parseFloat(e[r+"-"+f+s])||0}return a.width=a.left+a.right,a.height=a.top+a.bottom,a}const Edt=(e,r,s)=>(e>0||r>0)&&(!s||!s.shadowRoot);function Mdt(e,r){const s=e.touches,a=s&&s.length?s[0]:e,{offsetX:h,offsetY:f}=a;let m=!1,y,x;if(Edt(h,f,e.target))y=h,x=f;else{const w=r.getBoundingClientRect();y=a.clientX-w.left,x=a.clientY-w.top,m=!0}return{x:y,y:x,box:m}}function sh(e,r){if("native"in e)return e;const{canvas:s,currentDevicePixelRatio:a}=r,h=x1(s),f=h.boxSizing==="border-box",m=xh(h,"padding"),y=xh(h,"border","width"),{x,y:w,box:T}=Mdt(e,s),M=m.left+(T&&y.left),I=m.top+(T&&y.top);let{width:R,height:O}=r;return f&&(R-=m.width+y.width,O-=m.height+y.height),{x:Math.round((x-M)/R*s.width/a),y:Math.round((w-I)/O*s.height/a)}}function Adt(e,r,s){let a,h;if(r===void 0||s===void 0){const f=MP(e);if(!f)r=e.clientWidth,s=e.clientHeight;else{const m=f.getBoundingClientRect(),y=x1(f),x=xh(y,"border","width"),w=xh(y,"padding");r=m.width-w.width-x.width,s=m.height-w.height-x.height,a=xx(y.maxWidth,f,"clientWidth"),h=xx(y.maxHeight,f,"clientHeight")}}return{width:r,height:s,maxWidth:a||yx,maxHeight:h||yx}}const k0=e=>Math.round(e*10)/10;function Cdt(e,r,s,a){const h=x1(e),f=xh(h,"margin"),m=xx(h.maxWidth,e,"clientWidth")||yx,y=xx(h.maxHeight,e,"clientHeight")||yx,x=Adt(e,r,s);let{width:w,height:T}=x;if(h.boxSizing==="content-box"){const I=xh(h,"border","width"),R=xh(h,"padding");w-=R.width+I.width,T-=R.height+I.height}return w=Math.max(0,w-f.width),T=Math.max(0,a?w/a:T-f.height),w=k0(Math.min(w,m,x.maxWidth)),T=k0(Math.min(T,y,x.maxHeight)),w&&!T&&(T=k0(w/2)),(r!==void 0||s!==void 0)&&a&&x.height&&T>x.height&&(T=x.height,w=k0(Math.floor(T*a))),{width:w,height:T}}function eF(e,r,s){const a=r||1,h=Math.floor(e.height*a),f=Math.floor(e.width*a);e.height=Math.floor(e.height),e.width=Math.floor(e.width);const m=e.canvas;return m.style&&(s||!m.style.height&&!m.style.width)&&(m.style.height=`${e.height}px`,m.style.width=`${e.width}px`),e.currentDevicePixelRatio!==a||m.height!==h||m.width!==f?(e.currentDevicePixelRatio=a,m.height=h,m.width=f,e.ctx.setTransform(a,0,0,a,0,0),!0):!1}const Pdt=function(){let e=!1;try{const r={get passive(){return e=!0,!1}};EP()&&(window.addEventListener("test",null,r),window.removeEventListener("test",null,r))}catch{}return e}();function nF(e,r){const s=Sdt(e,r),a=s&&s.match(/^(\d+)(\.\d+)?px$/);return a?+a[1]:void 0}function oh(e,r,s,a){return{x:e.x+s*(r.x-e.x),y:e.y+s*(r.y-e.y)}}function Idt(e,r,s,a){return{x:e.x+s*(r.x-e.x),y:a==="middle"?s<.5?e.y:r.y:a==="after"?s<1?e.y:r.y:s>0?r.y:e.y}}function kdt(e,r,s,a){const h={x:e.cp2x,y:e.cp2y},f={x:r.cp1x,y:r.cp1y},m=oh(e,h,s),y=oh(h,f,s),x=oh(f,r,s),w=oh(m,y,s),T=oh(y,x,s);return oh(w,T,s)}const Ddt=function(e,r){return{x(s){return e+e+r-s},setWidth(s){r=s},textAlign(s){return s==="center"?s:s==="right"?"left":"right"},xPlus(s,a){return s-a},leftForLtr(s,a){return s-a}}},Rdt=function(){return{x(e){return e},setWidth(e){},textAlign(e){return e},xPlus(e,r){return e+r},leftForLtr(e,r){return e}}};function af(e,r,s){return e?Ddt(r,s):Rdt()}function g$(e,r){let s,a;(r==="ltr"||r==="rtl")&&(s=e.canvas.style,a=[s.getPropertyValue("direction"),s.getPropertyPriority("direction")],s.setProperty("direction",r,"important"),e.prevTextDirection=a)}function _$(e,r){r!==void 0&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",r[0],r[1]))}function y$(e){return e==="angle"?{between:gg,compare:Oht,normalize:oo}:{between:Cl,compare:(r,s)=>r-s,normalize:r=>r}}function rF({start:e,end:r,count:s,loop:a,style:h}){return{start:e%s,end:r%s,loop:a&&(r-e+1)%s===0,style:h}}function Odt(e,r,s){const{property:a,start:h,end:f}=s,{between:m,normalize:y}=y$(a),x=r.length;let{start:w,end:T,loop:M}=e,I,R;if(M){for(w+=x,T+=x,I=0,R=x;I<R&&m(y(r[w%x][a]),h,f);++I)w--,T--;w%=x,T%=x}return T<w&&(T+=x),{start:w,end:T,loop:M,style:e.style}}function v$(e,r,s){if(!s)return[e];const{property:a,start:h,end:f}=s,m=r.length,{compare:y,between:x,normalize:w}=y$(a),{start:T,end:M,loop:I,style:R}=Odt(e,r,s),O=[];let N=!1,G=null,$,z,B;const H=()=>x(h,B,$)&&y(h,B)!==0,K=()=>y(f,$)===0||x(f,B,$),at=()=>N||H(),ft=()=>!N||K();for(let et=T,nt=T;et<=M;++et)z=r[et%m],!z.skip&&($=w(z[a]),$!==B&&(N=x($,h,f),G===null&&at()&&(G=y($,h)===0?et:nt),G!==null&&ft()&&(O.push(rF({start:G,end:et,loop:I,count:m,style:R})),G=null),nt=et,B=$));return G!==null&&O.push(rF({start:G,end:M,loop:I,count:m,style:R})),O}function x$(e,r){const s=[],a=e.segments;for(let h=0;h<a.length;h++){const f=v$(a[h],e.points,r);f.length&&s.push(...f)}return s}function Ldt(e,r,s,a){let h=0,f=r-1;if(s&&!a)for(;h<r&&!e[h].skip;)h++;for(;h<r&&e[h].skip;)h++;for(h%=r,s&&(f+=h);f>h&&e[f%r].skip;)f--;return f%=r,{start:h,end:f}}function zdt(e,r,s,a){const h=e.length,f=[];let m=r,y=e[r],x;for(x=r+1;x<=s;++x){const w=e[x%h];w.skip||w.stop?y.skip||(a=!1,f.push({start:r%h,end:(x-1)%h,loop:a}),r=m=w.stop?x:null):(m=x,y.skip&&(r=x)),y=w}return m!==null&&f.push({start:r%h,end:m%h,loop:a}),f}function Ndt(e,r){const s=e.points,a=e.options.spanGaps,h=s.length;if(!h)return[];const f=!!e._loop,{start:m,end:y}=Ldt(s,h,f,a);if(a===!0)return iF(e,[{start:m,end:y,loop:f}],s,r);const x=y<m?y+h:y,w=!!e._fullLoop&&m===0&&y===h-1;return iF(e,zdt(s,m,x,w),s,r)}function iF(e,r,s,a){return!a||!a.setContext||!s?r:Fdt(e,r,s,a)}function Fdt(e,r,s,a){const h=e._chart.getContext(),f=sF(e.options),{_datasetIndex:m,options:{spanGaps:y}}=e,x=s.length,w=[];let T=f,M=r[0].start,I=M;function R(O,N,G,$){const z=y?-1:1;if(O!==N){for(O+=x;s[O%x].skip;)O-=z;for(;s[N%x].skip;)N+=z;O%x!==N%x&&(w.push({start:O%x,end:N%x,loop:G,style:$}),T=$,M=N%x)}}for(const O of r){M=y?M:O.start;let N=s[M%x],G;for(I=M+1;I<=O.end;I++){const $=s[I%x];G=sF(a.setContext(xu(h,{type:"segment",p0:N,p1:$,p0DataIndex:(I-1)%x,p1DataIndex:I%x,datasetIndex:m}))),Bdt(G,T)&&R(M,I-1,O.loop,T),N=$,T=G}M<I-1&&R(M,I-1,O.loop,T)}return w}function sF(e){return{backgroundColor:e.backgroundColor,borderCapStyle:e.borderCapStyle,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderJoinStyle:e.borderJoinStyle,borderWidth:e.borderWidth,borderColor:e.borderColor}}function Bdt(e,r){if(!r)return!1;const s=[],a=function(h,f){return xP(f)?(s.includes(f)||s.push(f),s.indexOf(f)):f};return JSON.stringify(e,a)!==JSON.stringify(r,a)}/*!
 * Chart.js v4.4.1
 * https://www.chartjs.org
 * (c) 2023 Chart.js Contributors
 * Released under the MIT License
 */class jdt{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(r,s,a,h){const f=s.listeners[h],m=s.duration;f.forEach(y=>y({chart:r,initial:s.initial,numSteps:m,currentStep:Math.min(a-s.start,m)}))}_refresh(){this._request||(this._running=!0,this._request=r$.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(r=Date.now()){let s=0;this._charts.forEach((a,h)=>{if(!a.running||!a.items.length)return;const f=a.items;let m=f.length-1,y=!1,x;for(;m>=0;--m)x=f[m],x._active?(x._total>a.duration&&(a.duration=x._total),x.tick(r),y=!0):(f[m]=f[f.length-1],f.pop());y&&(h.draw(),this._notify(h,a,r,"progress")),f.length||(a.running=!1,this._notify(h,a,r,"complete"),a.initial=!1),s+=f.length}),this._lastDate=r,s===0&&(this._running=!1)}_getAnims(r){const s=this._charts;let a=s.get(r);return a||(a={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},s.set(r,a)),a}listen(r,s,a){this._getAnims(r).listeners[s].push(a)}add(r,s){!s||!s.length||this._getAnims(r).items.push(...s)}has(r){return this._getAnims(r).items.length>0}start(r){const s=this._charts.get(r);s&&(s.running=!0,s.start=Date.now(),s.duration=s.items.reduce((a,h)=>Math.max(a,h._duration),0),this._refresh())}running(r){if(!this._running)return!1;const s=this._charts.get(r);return!(!s||!s.running||!s.items.length)}stop(r){const s=this._charts.get(r);if(!s||!s.items.length)return;const a=s.items;let h=a.length-1;for(;h>=0;--h)a[h].cancel();s.items=[],this._notify(r,s,Date.now(),"complete")}remove(r){return this._charts.delete(r)}}var xl=new jdt;const oF="transparent",Vdt={boolean(e,r,s){return s>.5?r:e},color(e,r,s){const a=YN(e||oF),h=a.valid&&YN(r||oF);return h&&h.valid?h.mix(a,s).hexString():r},number(e,r,s){return e+(r-e)*s}};class Udt{constructor(r,s,a,h){const f=s[a];h=dm([r.to,h,f,r.from]);const m=dm([r.from,f,h]);this._active=!0,this._fn=r.fn||Vdt[r.type||typeof m],this._easing=Om[r.easing]||Om.linear,this._start=Math.floor(Date.now()+(r.delay||0)),this._duration=this._total=Math.floor(r.duration),this._loop=!!r.loop,this._target=s,this._prop=a,this._from=m,this._to=h,this._promises=void 0}active(){return this._active}update(r,s,a){if(this._active){this._notify(!1);const h=this._target[this._prop],f=a-this._start,m=this._duration-f;this._start=a,this._duration=Math.floor(Math.max(m,r.duration)),this._total+=f,this._loop=!!r.loop,this._to=dm([r.to,s,h,r.from]),this._from=dm([r.from,h,s])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(r){const s=r-this._start,a=this._duration,h=this._prop,f=this._from,m=this._loop,y=this._to;let x;if(this._active=f!==y&&(m||s<a),!this._active){this._target[h]=y,this._notify(!0);return}if(s<0){this._target[h]=f;return}x=s/a%2,x=m&&x>1?2-x:x,x=this._easing(Math.min(1,Math.max(0,x))),this._target[h]=this._fn(f,y,x)}wait(){const r=this._promises||(this._promises=[]);return new Promise((s,a)=>{r.push({res:s,rej:a})})}_notify(r){const s=r?"res":"rej",a=this._promises||[];for(let h=0;h<a.length;h++)a[h][s]()}}class b${constructor(r,s){this._chart=r,this._properties=new Map,this.configure(s)}configure(r){if(!Zn(r))return;const s=Object.keys(fi.animation),a=this._properties;Object.getOwnPropertyNames(r).forEach(h=>{const f=r[h];if(!Zn(f))return;const m={};for(const y of s)m[y]=f[y];(jr(f.properties)&&f.properties||[h]).forEach(y=>{(y===h||!a.has(y))&&a.set(y,m)})})}_animateOptions(r,s){const a=s.options,h=Gdt(r,a);if(!h)return[];const f=this._createAnimations(h,a);return a.$shared&&$dt(r.options.$animations,a).then(()=>{r.options=a},()=>{}),f}_createAnimations(r,s){const a=this._properties,h=[],f=r.$animations||(r.$animations={}),m=Object.keys(s),y=Date.now();let x;for(x=m.length-1;x>=0;--x){const w=m[x];if(w.charAt(0)==="$")continue;if(w==="options"){h.push(...this._animateOptions(r,s));continue}const T=s[w];let M=f[w];const I=a.get(w);if(M)if(I&&M.active()){M.update(I,T,y);continue}else M.cancel();if(!I||!I.duration){r[w]=T;continue}f[w]=M=new Udt(I,r,w,T),h.push(M)}return h}update(r,s){if(this._properties.size===0){Object.assign(r,s);return}const a=this._createAnimations(r,s);if(a.length)return xl.add(this._chart,a),!0}}function $dt(e,r){const s=[],a=Object.keys(r);for(let h=0;h<a.length;h++){const f=e[a[h]];f&&f.active()&&s.push(f.wait())}return Promise.all(s)}function Gdt(e,r){if(!r)return;let s=e.options;if(!s){e.options=r;return}return s.$shared&&(e.options=s=Object.assign({},s,{$shared:!1,$animations:{}})),s}function aF(e,r){const s=e&&e.options||{},a=s.reverse,h=s.min===void 0?r:0,f=s.max===void 0?r:0;return{start:a?f:h,end:a?h:f}}function Wdt(e,r,s){if(s===!1)return!1;const a=aF(e,s),h=aF(r,s);return{top:h.end,right:a.end,bottom:h.start,left:a.start}}function Hdt(e){let r,s,a,h;return Zn(e)?(r=e.top,s=e.right,a=e.bottom,h=e.left):r=s=a=h=e,{top:r,right:s,bottom:a,left:h,disabled:e===!1}}function w$(e,r){const s=[],a=e._getSortedDatasetMetas(r);let h,f;for(h=0,f=a.length;h<f;++h)s.push(a[h].index);return s}function lF(e,r,s,a={}){const h=e.keys,f=a.mode==="single";let m,y,x,w;if(r!==null){for(m=0,y=h.length;m<y;++m){if(x=+h[m],x===s){if(a.all)continue;break}w=e.values[x],di(w)&&(f||r===0||qa(r)===qa(w))&&(r+=w)}return r}}function qdt(e){const r=Object.keys(e),s=new Array(r.length);let a,h,f;for(a=0,h=r.length;a<h;++a)f=r[a],s[a]={x:f,y:e[f]};return s}function cF(e,r){const s=e&&e.options.stacked;return s||s===void 0&&r.stack!==void 0}function Zdt(e,r,s){return`${e.id}.${r.id}.${s.stack||s.type}`}function Xdt(e){const{min:r,max:s,minDefined:a,maxDefined:h}=e.getUserBounds();return{min:a?r:Number.NEGATIVE_INFINITY,max:h?s:Number.POSITIVE_INFINITY}}function Ydt(e,r,s){const a=e[r]||(e[r]={});return a[s]||(a[s]={})}function uF(e,r,s,a){for(const h of r.getMatchingVisibleMetas(a).reverse()){const f=e[h.index];if(s&&f>0||!s&&f<0)return h.index}return null}function hF(e,r){const{chart:s,_cachedMeta:a}=e,h=s._stacks||(s._stacks={}),{iScale:f,vScale:m,index:y}=a,x=f.axis,w=m.axis,T=Zdt(f,m,a),M=r.length;let I;for(let R=0;R<M;++R){const O=r[R],{[x]:N,[w]:G}=O,$=O._stacks||(O._stacks={});I=$[w]=Ydt(h,T,N),I[y]=G,I._top=uF(I,m,!0,a.type),I._bottom=uF(I,m,!1,a.type);const z=I._visualValues||(I._visualValues={});z[y]=G}}function JT(e,r){const s=e.scales;return Object.keys(s).filter(a=>s[a].axis===r).shift()}function Kdt(e,r){return xu(e,{active:!1,dataset:void 0,datasetIndex:r,index:r,mode:"default",type:"dataset"})}function Jdt(e,r,s){return xu(e,{active:!1,dataIndex:r,parsed:void 0,raw:void 0,element:s,index:r,mode:"default",type:"data"})}function Jp(e,r){const s=e.controller.index,a=e.vScale&&e.vScale.axis;if(a){r=r||e._parsed;for(const h of r){const f=h._stacks;if(!f||f[a]===void 0||f[a][s]===void 0)return;delete f[a][s],f[a]._visualValues!==void 0&&f[a]._visualValues[s]!==void 0&&delete f[a]._visualValues[s]}}}const QT=e=>e==="reset"||e==="none",dF=(e,r)=>r?e:Object.assign({},e),Qdt=(e,r,s)=>e&&!r.hidden&&r._stacked&&{keys:w$(s,!0),values:null};class ma{constructor(r,s){this.chart=r,this._ctx=r.ctx,this.index=s,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const r=this._cachedMeta;this.configure(),this.linkScales(),r._stacked=cF(r.vScale,r),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(r){this.index!==r&&Jp(this._cachedMeta),this.index=r}linkScales(){const r=this.chart,s=this._cachedMeta,a=this.getDataset(),h=(M,I,R,O)=>M==="x"?I:M==="r"?O:R,f=s.xAxisID=On(a.xAxisID,JT(r,"x")),m=s.yAxisID=On(a.yAxisID,JT(r,"y")),y=s.rAxisID=On(a.rAxisID,JT(r,"r")),x=s.indexAxis,w=s.iAxisID=h(x,f,m,y),T=s.vAxisID=h(x,m,f,y);s.xScale=this.getScaleForId(f),s.yScale=this.getScaleForId(m),s.rScale=this.getScaleForId(y),s.iScale=this.getScaleForId(w),s.vScale=this.getScaleForId(T)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(r){return this.chart.scales[r]}_getOtherScale(r){const s=this._cachedMeta;return r===s.iScale?s.vScale:s.iScale}reset(){this._update("reset")}_destroy(){const r=this._cachedMeta;this._data&&qN(this._data,this),r._stacked&&Jp(r)}_dataCheck(){const r=this.getDataset(),s=r.data||(r.data=[]),a=this._data;if(Zn(s))this._data=qdt(s);else if(a!==s){if(a){qN(a,this);const h=this._cachedMeta;Jp(h),h._parsed=[]}s&&Object.isExtensible(s)&&Fht(s,this),this._syncList=[],this._data=s}}addElements(){const r=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(r.dataset=new this.datasetElementType)}buildOrUpdateElements(r){const s=this._cachedMeta,a=this.getDataset();let h=!1;this._dataCheck();const f=s._stacked;s._stacked=cF(s.vScale,s),s.stack!==a.stack&&(h=!0,Jp(s),s.stack=a.stack),this._resyncElements(r),(h||f!==s._stacked)&&hF(this,s._parsed)}configure(){const r=this.chart.config,s=r.datasetScopeKeys(this._type),a=r.getOptionScopes(this.getDataset(),s,!0);this.options=r.createResolver(a,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(r,s){const{_cachedMeta:a,_data:h}=this,{iScale:f,_stacked:m}=a,y=f.axis;let x=r===0&&s===h.length?!0:a._sorted,w=r>0&&a._parsed[r-1],T,M,I;if(this._parsing===!1)a._parsed=h,a._sorted=!0,I=h;else{jr(h[r])?I=this.parseArrayData(a,h,r,s):Zn(h[r])?I=this.parseObjectData(a,h,r,s):I=this.parsePrimitiveData(a,h,r,s);const R=()=>M[y]===null||w&&M[y]<w[y];for(T=0;T<s;++T)a._parsed[T+r]=M=I[T],x&&(R()&&(x=!1),w=M);a._sorted=x}m&&hF(this,I)}parsePrimitiveData(r,s,a,h){const{iScale:f,vScale:m}=r,y=f.axis,x=m.axis,w=f.getLabels(),T=f===m,M=new Array(h);let I,R,O;for(I=0,R=h;I<R;++I)O=I+a,M[I]={[y]:T||f.parse(w[O],O),[x]:m.parse(s[O],O)};return M}parseArrayData(r,s,a,h){const{xScale:f,yScale:m}=r,y=new Array(h);let x,w,T,M;for(x=0,w=h;x<w;++x)T=x+a,M=s[T],y[x]={x:f.parse(M[0],T),y:m.parse(M[1],T)};return y}parseObjectData(r,s,a,h){const{xScale:f,yScale:m}=r,{xAxisKey:y="x",yAxisKey:x="y"}=this._parsing,w=new Array(h);let T,M,I,R;for(T=0,M=h;T<M;++T)I=T+a,R=s[I],w[T]={x:f.parse(du(R,y),I),y:m.parse(du(R,x),I)};return w}getParsed(r){return this._cachedMeta._parsed[r]}getDataElement(r){return this._cachedMeta.data[r]}applyStack(r,s,a){const h=this.chart,f=this._cachedMeta,m=s[r.axis],y={keys:w$(h,!0),values:s._stacks[r.axis]._visualValues};return lF(y,m,f.index,{mode:a})}updateRangeFromParsed(r,s,a,h){const f=a[s.axis];let m=f===null?NaN:f;const y=h&&a._stacks[s.axis];h&&y&&(h.values=y,m=lF(h,f,this._cachedMeta.index)),r.min=Math.min(r.min,m),r.max=Math.max(r.max,m)}getMinMax(r,s){const a=this._cachedMeta,h=a._parsed,f=a._sorted&&r===a.iScale,m=h.length,y=this._getOtherScale(r),x=Qdt(s,a,this.chart),w={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:T,max:M}=Xdt(y);let I,R;function O(){R=h[I];const N=R[y.axis];return!di(R[r.axis])||T>N||M<N}for(I=0;I<m&&!(!O()&&(this.updateRangeFromParsed(w,r,R,x),f));++I);if(f){for(I=m-1;I>=0;--I)if(!O()){this.updateRangeFromParsed(w,r,R,x);break}}return w}getAllParsedValues(r){const s=this._cachedMeta._parsed,a=[];let h,f,m;for(h=0,f=s.length;h<f;++h)m=s[h][r.axis],di(m)&&a.push(m);return a}getMaxOverflow(){return!1}getLabelAndValue(r){const s=this._cachedMeta,a=s.iScale,h=s.vScale,f=this.getParsed(r);return{label:a?""+a.getLabelForValue(f[a.axis]):"",value:h?""+h.getLabelForValue(f[h.axis]):""}}_update(r){const s=this._cachedMeta;this.update(r||"default"),s._clip=Hdt(On(this.options.clip,Wdt(s.xScale,s.yScale,this.getMaxOverflow())))}update(r){}draw(){const r=this._ctx,s=this.chart,a=this._cachedMeta,h=a.data||[],f=s.chartArea,m=[],y=this._drawStart||0,x=this._drawCount||h.length-y,w=this.options.drawActiveElementsOnTop;let T;for(a.dataset&&a.dataset.draw(r,f,y,x),T=y;T<y+x;++T){const M=h[T];M.hidden||(M.active&&w?m.push(M):M.draw(r,f))}for(T=0;T<m.length;++T)m[T].draw(r,f)}getStyle(r,s){const a=s?"active":"default";return r===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(a):this.resolveDataElementOptions(r||0,a)}getContext(r,s,a){const h=this.getDataset();let f;if(r>=0&&r<this._cachedMeta.data.length){const m=this._cachedMeta.data[r];f=m.$context||(m.$context=Jdt(this.getContext(),r,m)),f.parsed=this.getParsed(r),f.raw=h.data[r],f.index=f.dataIndex=r}else f=this.$context||(this.$context=Kdt(this.chart.getContext(),this.index)),f.dataset=h,f.index=f.datasetIndex=this.index;return f.active=!!s,f.mode=a,f}resolveDatasetElementOptions(r){return this._resolveElementOptions(this.datasetElementType.id,r)}resolveDataElementOptions(r,s){return this._resolveElementOptions(this.dataElementType.id,s,r)}_resolveElementOptions(r,s="default",a){const h=s==="active",f=this._cachedDataOpts,m=r+"-"+s,y=f[m],x=this.enableOptionSharing&&mg(a);if(y)return dF(y,x);const w=this.chart.config,T=w.datasetElementScopeKeys(this._type,r),M=h?[`${r}Hover`,"hover",r,""]:[r,""],I=w.getOptionScopes(this.getDataset(),T),R=Object.keys(fi.elements[r]),O=()=>this.getContext(a,h,s),N=w.resolveNamedOptions(I,R,O,M);return N.$shared&&(N.$shared=x,f[m]=Object.freeze(dF(N,x))),N}_resolveAnimations(r,s,a){const h=this.chart,f=this._cachedDataOpts,m=`animation-${s}`,y=f[m];if(y)return y;let x;if(h.options.animation!==!1){const T=this.chart.config,M=T.datasetAnimationScopeKeys(this._type,s),I=T.getOptionScopes(this.getDataset(),M);x=T.createResolver(I,this.getContext(r,a,s))}const w=new b$(h,x&&x.animations);return x&&x._cacheable&&(f[m]=Object.freeze(w)),w}getSharedOptions(r){if(r.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},r))}includeOptions(r,s){return!s||QT(r)||this.chart._animationsDisabled}_getSharedOptions(r,s){const a=this.resolveDataElementOptions(r,s),h=this._sharedOptions,f=this.getSharedOptions(a),m=this.includeOptions(s,f)||f!==h;return this.updateSharedOptions(f,s,a),{sharedOptions:f,includeOptions:m}}updateElement(r,s,a,h){QT(h)?Object.assign(r,a):this._resolveAnimations(s,h).update(r,a)}updateSharedOptions(r,s,a){r&&!QT(s)&&this._resolveAnimations(void 0,s).update(r,a)}_setStyle(r,s,a,h){r.active=h;const f=this.getStyle(s,h);this._resolveAnimations(s,a,h).update(r,{options:!h&&this.getSharedOptions(f)||f})}removeHoverStyle(r,s,a){this._setStyle(r,a,"active",!1)}setHoverStyle(r,s,a){this._setStyle(r,a,"active",!0)}_removeDatasetHoverStyle(){const r=this._cachedMeta.dataset;r&&this._setStyle(r,void 0,"active",!1)}_setDatasetHoverStyle(){const r=this._cachedMeta.dataset;r&&this._setStyle(r,void 0,"active",!0)}_resyncElements(r){const s=this._data,a=this._cachedMeta.data;for(const[y,x,w]of this._syncList)this[y](x,w);this._syncList=[];const h=a.length,f=s.length,m=Math.min(f,h);m&&this.parse(0,m),f>h?this._insertElements(h,f-h,r):f<h&&this._removeElements(f,h-f)}_insertElements(r,s,a=!0){const h=this._cachedMeta,f=h.data,m=r+s;let y;const x=w=>{for(w.length+=s,y=w.length-1;y>=m;y--)w[y]=w[y-s]};for(x(f),y=r;y<m;++y)f[y]=new this.dataElementType;this._parsing&&x(h._parsed),this.parse(r,s),a&&this.updateElements(f,r,s,"reset")}updateElements(r,s,a,h){}_removeElements(r,s){const a=this._cachedMeta;if(this._parsing){const h=a._parsed.splice(r,s);a._stacked&&Jp(a,h)}a.data.splice(r,s)}_sync(r){if(this._parsing)this._syncList.push(r);else{const[s,a,h]=r;this[s](a,h)}this.chart._dataChanges.push([this.index,...r])}_onDataPush(){const r=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-r,r])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(r,s){s&&this._sync(["_removeElements",r,s]);const a=arguments.length-2;a&&this._sync(["_insertElements",r,a])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}Ie(ma,"defaults",{}),Ie(ma,"datasetElementType",null),Ie(ma,"dataElementType",null);function tft(e,r){if(!e._cache.$bar){const s=e.getMatchingVisibleMetas(r);let a=[];for(let h=0,f=s.length;h<f;h++)a=a.concat(s[h].controller.getAllParsedValues(e));e._cache.$bar=n$(a.sort((h,f)=>h-f))}return e._cache.$bar}function eft(e){const r=e.iScale,s=tft(r,e.type);let a=r._length,h,f,m,y;const x=()=>{m===32767||m===-32768||(mg(y)&&(a=Math.min(a,Math.abs(m-y)||a)),y=m)};for(h=0,f=s.length;h<f;++h)m=r.getPixelForValue(s[h]),x();for(y=void 0,h=0,f=r.ticks.length;h<f;++h)m=r.getPixelForTick(h),x();return a}function nft(e,r,s,a){const h=s.barThickness;let f,m;return sr(h)?(f=r.min*s.categoryPercentage,m=s.barPercentage):(f=h*a,m=1),{chunk:f/a,ratio:m,start:r.pixels[e]-f/2}}function rft(e,r,s,a){const h=r.pixels,f=h[e];let m=e>0?h[e-1]:null,y=e<h.length-1?h[e+1]:null;const x=s.categoryPercentage;m===null&&(m=f-(y===null?r.end-r.start:y-f)),y===null&&(y=f+f-m);const w=f-(f-Math.min(m,y))/2*x;return{chunk:Math.abs(y-m)/2*x/a,ratio:s.barPercentage,start:w}}function ift(e,r,s,a){const h=s.parse(e[0],a),f=s.parse(e[1],a),m=Math.min(h,f),y=Math.max(h,f);let x=m,w=y;Math.abs(m)>Math.abs(y)&&(x=y,w=m),r[s.axis]=w,r._custom={barStart:x,barEnd:w,start:h,end:f,min:m,max:y}}function S$(e,r,s,a){return jr(e)?ift(e,r,s,a):r[s.axis]=s.parse(e,a),r}function fF(e,r,s,a){const h=e.iScale,f=e.vScale,m=h.getLabels(),y=h===f,x=[];let w,T,M,I;for(w=s,T=s+a;w<T;++w)I=r[w],M={},M[h.axis]=y||h.parse(m[w],w),x.push(S$(I,M,f,w));return x}function tE(e){return e&&e.barStart!==void 0&&e.barEnd!==void 0}function sft(e,r,s){return e!==0?qa(e):(r.isHorizontal()?1:-1)*(r.min>=s?1:-1)}function oft(e){let r,s,a,h,f;return e.horizontal?(r=e.base>e.x,s="left",a="right"):(r=e.base<e.y,s="bottom",a="top"),r?(h="end",f="start"):(h="start",f="end"),{start:s,end:a,reverse:r,top:h,bottom:f}}function aft(e,r,s,a){let h=r.borderSkipped;const f={};if(!h){e.borderSkipped=f;return}if(h===!0){e.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:m,end:y,reverse:x,top:w,bottom:T}=oft(e);h==="middle"&&s&&(e.enableBorderRadius=!0,(s._top||0)===a?h=w:(s._bottom||0)===a?h=T:(f[pF(T,m,y,x)]=!0,h=w)),f[pF(h,m,y,x)]=!0,e.borderSkipped=f}function pF(e,r,s,a){return a?(e=lft(e,r,s),e=mF(e,s,r)):e=mF(e,r,s),e}function lft(e,r,s){return e===r?s:e===s?r:e}function mF(e,r,s){return e==="start"?r:e==="end"?s:e}function cft(e,{inflateAmount:r},s){e.inflateAmount=r==="auto"?s===1?.33:0:r}class cv extends ma{parsePrimitiveData(r,s,a,h){return fF(r,s,a,h)}parseArrayData(r,s,a,h){return fF(r,s,a,h)}parseObjectData(r,s,a,h){const{iScale:f,vScale:m}=r,{xAxisKey:y="x",yAxisKey:x="y"}=this._parsing,w=f.axis==="x"?y:x,T=m.axis==="x"?y:x,M=[];let I,R,O,N;for(I=a,R=a+h;I<R;++I)N=s[I],O={},O[f.axis]=f.parse(du(N,w),I),M.push(S$(du(N,T),O,m,I));return M}updateRangeFromParsed(r,s,a,h){super.updateRangeFromParsed(r,s,a,h);const f=a._custom;f&&s===this._cachedMeta.vScale&&(r.min=Math.min(r.min,f.min),r.max=Math.max(r.max,f.max))}getMaxOverflow(){return 0}getLabelAndValue(r){const s=this._cachedMeta,{iScale:a,vScale:h}=s,f=this.getParsed(r),m=f._custom,y=tE(m)?"["+m.start+", "+m.end+"]":""+h.getLabelForValue(f[h.axis]);return{label:""+a.getLabelForValue(f[a.axis]),value:y}}initialize(){this.enableOptionSharing=!0,super.initialize();const r=this._cachedMeta;r.stack=this.getDataset().stack}update(r){const s=this._cachedMeta;this.updateElements(s.data,0,s.data.length,r)}updateElements(r,s,a,h){const f=h==="reset",{index:m,_cachedMeta:{vScale:y}}=this,x=y.getBasePixel(),w=y.isHorizontal(),T=this._getRuler(),{sharedOptions:M,includeOptions:I}=this._getSharedOptions(s,h);for(let R=s;R<s+a;R++){const O=this.getParsed(R),N=f||sr(O[y.axis])?{base:x,head:x}:this._calculateBarValuePixels(R),G=this._calculateBarIndexPixels(R,T),$=(O._stacks||{})[y.axis],z={horizontal:w,base:N.base,enableBorderRadius:!$||tE(O._custom)||m===$._top||m===$._bottom,x:w?N.head:G.center,y:w?G.center:N.head,height:w?G.size:Math.abs(N.size),width:w?Math.abs(N.size):G.size};I&&(z.options=M||this.resolveDataElementOptions(R,r[R].active?"active":h));const B=z.options||r[R].options;aft(z,B,$,m),cft(z,B,T.ratio),this.updateElement(r[R],R,z,h)}}_getStacks(r,s){const{iScale:a}=this._cachedMeta,h=a.getMatchingVisibleMetas(this._type).filter(x=>x.controller.options.grouped),f=a.options.stacked,m=[],y=x=>{const w=x.controller.getParsed(s),T=w&&w[x.vScale.axis];if(sr(T)||isNaN(T))return!0};for(const x of h)if(!(s!==void 0&&y(x))&&((f===!1||m.indexOf(x.stack)===-1||f===void 0&&x.stack===void 0)&&m.push(x.stack),x.index===r))break;return m.length||m.push(void 0),m}_getStackCount(r){return this._getStacks(void 0,r).length}_getStackIndex(r,s,a){const h=this._getStacks(r,a),f=s!==void 0?h.indexOf(s):-1;return f===-1?h.length-1:f}_getRuler(){const r=this.options,s=this._cachedMeta,a=s.iScale,h=[];let f,m;for(f=0,m=s.data.length;f<m;++f)h.push(a.getPixelForValue(this.getParsed(f)[a.axis],f));const y=r.barThickness;return{min:y||eft(s),pixels:h,start:a._startPixel,end:a._endPixel,stackCount:this._getStackCount(),scale:a,grouped:r.grouped,ratio:y?1:r.categoryPercentage*r.barPercentage}}_calculateBarValuePixels(r){const{_cachedMeta:{vScale:s,_stacked:a,index:h},options:{base:f,minBarLength:m}}=this,y=f||0,x=this.getParsed(r),w=x._custom,T=tE(w);let M=x[s.axis],I=0,R=a?this.applyStack(s,x,a):M,O,N;R!==M&&(I=R-M,R=M),T&&(M=w.barStart,R=w.barEnd-w.barStart,M!==0&&qa(M)!==qa(w.barEnd)&&(I=0),I+=M);const G=!sr(f)&&!T?f:I;let $=s.getPixelForValue(G);if(this.chart.getDataVisibility(r)?O=s.getPixelForValue(I+R):O=$,N=O-$,Math.abs(N)<m){N=sft(N,s,y)*m,M===y&&($-=N/2);const z=s.getPixelForDecimal(0),B=s.getPixelForDecimal(1),H=Math.min(z,B),K=Math.max(z,B);$=Math.max(Math.min($,K),H),O=$+N,a&&!T&&(x._stacks[s.axis]._visualValues[h]=s.getValueForPixel(O)-s.getValueForPixel($))}if($===s.getPixelForValue(y)){const z=qa(N)*s.getLineWidthForValue(y)/2;$+=z,N-=z}return{size:N,base:$,head:O,center:O+N/2}}_calculateBarIndexPixels(r,s){const a=s.scale,h=this.options,f=h.skipNull,m=On(h.maxBarThickness,1/0);let y,x;if(s.grouped){const w=f?this._getStackCount(r):s.stackCount,T=h.barThickness==="flex"?rft(r,s,h,w):nft(r,s,h,w),M=this._getStackIndex(this.index,this._cachedMeta.stack,f?r:void 0);y=T.start+T.chunk*M+T.chunk/2,x=Math.min(m,T.chunk*T.ratio)}else y=a.getPixelForValue(this.getParsed(r)[a.axis],r),x=Math.min(m,s.min*s.ratio);return{base:y-x/2,head:y+x/2,center:y,size:x}}draw(){const r=this._cachedMeta,s=r.vScale,a=r.data,h=a.length;let f=0;for(;f<h;++f)this.getParsed(f)[s.axis]!==null&&a[f].draw(this._ctx)}}Ie(cv,"id","bar"),Ie(cv,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),Ie(cv,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});class uv extends ma{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(r,s,a,h){const f=super.parsePrimitiveData(r,s,a,h);for(let m=0;m<f.length;m++)f[m]._custom=this.resolveDataElementOptions(m+a).radius;return f}parseArrayData(r,s,a,h){const f=super.parseArrayData(r,s,a,h);for(let m=0;m<f.length;m++){const y=s[a+m];f[m]._custom=On(y[2],this.resolveDataElementOptions(m+a).radius)}return f}parseObjectData(r,s,a,h){const f=super.parseObjectData(r,s,a,h);for(let m=0;m<f.length;m++){const y=s[a+m];f[m]._custom=On(y&&y.r&&+y.r,this.resolveDataElementOptions(m+a).radius)}return f}getMaxOverflow(){const r=this._cachedMeta.data;let s=0;for(let a=r.length-1;a>=0;--a)s=Math.max(s,r[a].size(this.resolveDataElementOptions(a))/2);return s>0&&s}getLabelAndValue(r){const s=this._cachedMeta,a=this.chart.data.labels||[],{xScale:h,yScale:f}=s,m=this.getParsed(r),y=h.getLabelForValue(m.x),x=f.getLabelForValue(m.y),w=m._custom;return{label:a[r]||"",value:"("+y+", "+x+(w?", "+w:"")+")"}}update(r){const s=this._cachedMeta.data;this.updateElements(s,0,s.length,r)}updateElements(r,s,a,h){const f=h==="reset",{iScale:m,vScale:y}=this._cachedMeta,{sharedOptions:x,includeOptions:w}=this._getSharedOptions(s,h),T=m.axis,M=y.axis;for(let I=s;I<s+a;I++){const R=r[I],O=!f&&this.getParsed(I),N={},G=N[T]=f?m.getPixelForDecimal(.5):m.getPixelForValue(O[T]),$=N[M]=f?y.getBasePixel():y.getPixelForValue(O[M]);N.skip=isNaN(G)||isNaN($),w&&(N.options=x||this.resolveDataElementOptions(I,R.active?"active":h),f&&(N.options.radius=0)),this.updateElement(R,I,N,h)}}resolveDataElementOptions(r,s){const a=this.getParsed(r);let h=super.resolveDataElementOptions(r,s);h.$shared&&(h=Object.assign({},h,{$shared:!1}));const f=h.radius;return s!=="active"&&(h.radius=0),h.radius+=On(a&&a._custom,f),h}}Ie(uv,"id","bubble"),Ie(uv,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),Ie(uv,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}});function uft(e,r,s){let a=1,h=1,f=0,m=0;if(r<Ur){const y=e,x=y+r,w=Math.cos(y),T=Math.sin(y),M=Math.cos(x),I=Math.sin(x),R=(B,H,K)=>gg(B,y,x,!0)?1:Math.max(H,H*s,K,K*s),O=(B,H,K)=>gg(B,y,x,!0)?-1:Math.min(H,H*s,K,K*s),N=R(0,w,M),G=R(Ti,T,I),$=O($r,w,M),z=O($r+Ti,T,I);a=(N-$)/2,h=(G-z)/2,f=-(N+$)/2,m=-(G+z)/2}return{ratioX:a,ratioY:h,offsetX:f,offsetY:m}}class fh extends ma{constructor(r,s){super(r,s),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(r,s){const a=this.getDataset().data,h=this._cachedMeta;if(this._parsing===!1)h._parsed=a;else{let f=x=>+a[x];if(Zn(a[r])){const{key:x="value"}=this._parsing;f=w=>+du(a[w],x)}let m,y;for(m=r,y=r+s;m<y;++m)h._parsed[m]=f(m)}}_getRotation(){return ha(this.options.rotation-90)}_getCircumference(){return ha(this.options.circumference)}_getRotationExtents(){let r=Ur,s=-Ur;for(let a=0;a<this.chart.data.datasets.length;++a)if(this.chart.isDatasetVisible(a)&&this.chart.getDatasetMeta(a).type===this._type){const h=this.chart.getDatasetMeta(a).controller,f=h._getRotation(),m=h._getCircumference();r=Math.min(r,f),s=Math.max(s,f+m)}return{rotation:r,circumference:s-r}}update(r){const s=this.chart,{chartArea:a}=s,h=this._cachedMeta,f=h.data,m=this.getMaxBorderWidth()+this.getMaxOffset(f)+this.options.spacing,y=Math.max((Math.min(a.width,a.height)-m)/2,0),x=Math.min(Tht(this.options.cutout,y),1),w=this._getRingWeight(this.index),{circumference:T,rotation:M}=this._getRotationExtents(),{ratioX:I,ratioY:R,offsetX:O,offsetY:N}=uft(M,T,x),G=(a.width-m)/I,$=(a.height-m)/R,z=Math.max(Math.min(G,$)/2,0),B=K8(this.options.radius,z),H=Math.max(B*x,0),K=(B-H)/this._getVisibleDatasetWeightTotal();this.offsetX=O*B,this.offsetY=N*B,h.total=this.calculateTotal(),this.outerRadius=B-K*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-K*w,0),this.updateElements(f,0,f.length,r)}_circumference(r,s){const a=this.options,h=this._cachedMeta,f=this._getCircumference();return s&&a.animation.animateRotate||!this.chart.getDataVisibility(r)||h._parsed[r]===null||h.data[r].hidden?0:this.calculateCircumference(h._parsed[r]*f/Ur)}updateElements(r,s,a,h){const f=h==="reset",m=this.chart,y=m.chartArea,w=m.options.animation,T=(y.left+y.right)/2,M=(y.top+y.bottom)/2,I=f&&w.animateScale,R=I?0:this.innerRadius,O=I?0:this.outerRadius,{sharedOptions:N,includeOptions:G}=this._getSharedOptions(s,h);let $=this._getRotation(),z;for(z=0;z<s;++z)$+=this._circumference(z,f);for(z=s;z<s+a;++z){const B=this._circumference(z,f),H=r[z],K={x:T+this.offsetX,y:M+this.offsetY,startAngle:$,endAngle:$+B,circumference:B,outerRadius:O,innerRadius:R};G&&(K.options=N||this.resolveDataElementOptions(z,H.active?"active":h)),$+=B,this.updateElement(H,z,K,h)}}calculateTotal(){const r=this._cachedMeta,s=r.data;let a=0,h;for(h=0;h<s.length;h++){const f=r._parsed[h];f!==null&&!isNaN(f)&&this.chart.getDataVisibility(h)&&!s[h].hidden&&(a+=Math.abs(f))}return a}calculateCircumference(r){const s=this._cachedMeta.total;return s>0&&!isNaN(r)?Ur*(Math.abs(r)/s):0}getLabelAndValue(r){const s=this._cachedMeta,a=this.chart,h=a.data.labels||[],f=jg(s._parsed[r],a.options.locale);return{label:h[r]||"",value:f}}getMaxBorderWidth(r){let s=0;const a=this.chart;let h,f,m,y,x;if(!r){for(h=0,f=a.data.datasets.length;h<f;++h)if(a.isDatasetVisible(h)){m=a.getDatasetMeta(h),r=m.data,y=m.controller;break}}if(!r)return 0;for(h=0,f=r.length;h<f;++h)x=y.resolveDataElementOptions(h),x.borderAlign!=="inner"&&(s=Math.max(s,x.borderWidth||0,x.hoverBorderWidth||0));return s}getMaxOffset(r){let s=0;for(let a=0,h=r.length;a<h;++a){const f=this.resolveDataElementOptions(a);s=Math.max(s,f.offset||0,f.hoverOffset||0)}return s}_getRingWeightOffset(r){let s=0;for(let a=0;a<r;++a)this.chart.isDatasetVisible(a)&&(s+=this._getRingWeight(a));return s}_getRingWeight(r){return Math.max(On(this.chart.data.datasets[r].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}Ie(fh,"id","doughnut"),Ie(fh,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),Ie(fh,"descriptors",{_scriptable:r=>r!=="spacing",_indexable:r=>r!=="spacing"&&!r.startsWith("borderDash")&&!r.startsWith("hoverBorderDash")}),Ie(fh,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(r){const s=r.data;if(s.labels.length&&s.datasets.length){const{labels:{pointStyle:a,color:h}}=r.legend.options;return s.labels.map((f,m)=>{const x=r.getDatasetMeta(0).controller.getStyle(m);return{text:f,fillStyle:x.backgroundColor,strokeStyle:x.borderColor,fontColor:h,lineWidth:x.borderWidth,pointStyle:a,hidden:!r.getDataVisibility(m),index:m}})}return[]}},onClick(r,s,a){a.chart.toggleDataVisibility(s.index),a.chart.update()}}}});class hv extends ma{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(r){const s=this._cachedMeta,{dataset:a,data:h=[],_dataset:f}=s,m=this.chart._animationsDisabled;let{start:y,count:x}=s$(s,h,m);this._drawStart=y,this._drawCount=x,o$(s)&&(y=0,x=h.length),a._chart=this.chart,a._datasetIndex=this.index,a._decimated=!!f._decimated,a.points=h;const w=this.resolveDatasetElementOptions(r);this.options.showLine||(w.borderWidth=0),w.segment=this.options.segment,this.updateElement(a,void 0,{animated:!m,options:w},r),this.updateElements(h,y,x,r)}updateElements(r,s,a,h){const f=h==="reset",{iScale:m,vScale:y,_stacked:x,_dataset:w}=this._cachedMeta,{sharedOptions:T,includeOptions:M}=this._getSharedOptions(s,h),I=m.axis,R=y.axis,{spanGaps:O,segment:N}=this.options,G=xf(O)?O:Number.POSITIVE_INFINITY,$=this.chart._animationsDisabled||f||h==="none",z=s+a,B=r.length;let H=s>0&&this.getParsed(s-1);for(let K=0;K<B;++K){const at=r[K],ft=$?at:{};if(K<s||K>=z){ft.skip=!0;continue}const et=this.getParsed(K),nt=sr(et[R]),W=ft[I]=m.getPixelForValue(et[I],K),Q=ft[R]=f||nt?y.getBasePixel():y.getPixelForValue(x?this.applyStack(y,et,x):et[R],K);ft.skip=isNaN(W)||isNaN(Q)||nt,ft.stop=K>0&&Math.abs(et[I]-H[I])>G,N&&(ft.parsed=et,ft.raw=w.data[K]),M&&(ft.options=T||this.resolveDataElementOptions(K,at.active?"active":h)),$||this.updateElement(at,K,ft,h),H=et}}getMaxOverflow(){const r=this._cachedMeta,s=r.dataset,a=s.options&&s.options.borderWidth||0,h=r.data||[];if(!h.length)return a;const f=h[0].size(this.resolveDataElementOptions(0)),m=h[h.length-1].size(this.resolveDataElementOptions(h.length-1));return Math.max(a,f,m)/2}draw(){const r=this._cachedMeta;r.dataset.updateControlPoints(this.chart.chartArea,r.iScale.axis),super.draw()}}Ie(hv,"id","line"),Ie(hv,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),Ie(hv,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class zm extends ma{constructor(r,s){super(r,s),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(r){const s=this._cachedMeta,a=this.chart,h=a.data.labels||[],f=jg(s._parsed[r].r,a.options.locale);return{label:h[r]||"",value:f}}parseObjectData(r,s,a,h){return p$.bind(this)(r,s,a,h)}update(r){const s=this._cachedMeta.data;this._updateRadius(),this.updateElements(s,0,s.length,r)}getMinMax(){const r=this._cachedMeta,s={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return r.data.forEach((a,h)=>{const f=this.getParsed(h).r;!isNaN(f)&&this.chart.getDataVisibility(h)&&(f<s.min&&(s.min=f),f>s.max&&(s.max=f))}),s}_updateRadius(){const r=this.chart,s=r.chartArea,a=r.options,h=Math.min(s.right-s.left,s.bottom-s.top),f=Math.max(h/2,0),m=Math.max(a.cutoutPercentage?f/100*a.cutoutPercentage:1,0),y=(f-m)/r.getVisibleDatasetCount();this.outerRadius=f-y*this.index,this.innerRadius=this.outerRadius-y}updateElements(r,s,a,h){const f=h==="reset",m=this.chart,x=m.options.animation,w=this._cachedMeta.rScale,T=w.xCenter,M=w.yCenter,I=w.getIndexAngle(0)-.5*$r;let R=I,O;const N=360/this.countVisibleElements();for(O=0;O<s;++O)R+=this._computeAngle(O,h,N);for(O=s;O<s+a;O++){const G=r[O];let $=R,z=R+this._computeAngle(O,h,N),B=m.getDataVisibility(O)?w.getDistanceFromCenterForValue(this.getParsed(O).r):0;R=z,f&&(x.animateScale&&(B=0),x.animateRotate&&($=z=I));const H={x:T,y:M,innerRadius:0,outerRadius:B,startAngle:$,endAngle:z,options:this.resolveDataElementOptions(O,G.active?"active":h)};this.updateElement(G,O,H,h)}}countVisibleElements(){const r=this._cachedMeta;let s=0;return r.data.forEach((a,h)=>{!isNaN(this.getParsed(h).r)&&this.chart.getDataVisibility(h)&&s++}),s}_computeAngle(r,s,a){return this.chart.getDataVisibility(r)?ha(this.resolveDataElementOptions(r,s).angle||a):0}}Ie(zm,"id","polarArea"),Ie(zm,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),Ie(zm,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(r){const s=r.data;if(s.labels.length&&s.datasets.length){const{labels:{pointStyle:a,color:h}}=r.legend.options;return s.labels.map((f,m)=>{const x=r.getDatasetMeta(0).controller.getStyle(m);return{text:f,fillStyle:x.backgroundColor,strokeStyle:x.borderColor,fontColor:h,lineWidth:x.borderWidth,pointStyle:a,hidden:!r.getDataVisibility(m),index:m}})}return[]}},onClick(r,s,a){a.chart.toggleDataVisibility(s.index),a.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}});class ZM extends fh{}Ie(ZM,"id","pie"),Ie(ZM,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});class dv extends ma{getLabelAndValue(r){const s=this._cachedMeta.vScale,a=this.getParsed(r);return{label:s.getLabels()[r],value:""+s.getLabelForValue(a[s.axis])}}parseObjectData(r,s,a,h){return p$.bind(this)(r,s,a,h)}update(r){const s=this._cachedMeta,a=s.dataset,h=s.data||[],f=s.iScale.getLabels();if(a.points=h,r!=="resize"){const m=this.resolveDatasetElementOptions(r);this.options.showLine||(m.borderWidth=0);const y={_loop:!0,_fullLoop:f.length===h.length,options:m};this.updateElement(a,void 0,y,r)}this.updateElements(h,0,h.length,r)}updateElements(r,s,a,h){const f=this._cachedMeta.rScale,m=h==="reset";for(let y=s;y<s+a;y++){const x=r[y],w=this.resolveDataElementOptions(y,x.active?"active":h),T=f.getPointPositionForValue(y,this.getParsed(y).r),M=m?f.xCenter:T.x,I=m?f.yCenter:T.y,R={x:M,y:I,angle:T.angle,skip:isNaN(M)||isNaN(I),options:w};this.updateElement(x,y,R,h)}}}Ie(dv,"id","radar"),Ie(dv,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),Ie(dv,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}});class fv extends ma{getLabelAndValue(r){const s=this._cachedMeta,a=this.chart.data.labels||[],{xScale:h,yScale:f}=s,m=this.getParsed(r),y=h.getLabelForValue(m.x),x=f.getLabelForValue(m.y);return{label:a[r]||"",value:"("+y+", "+x+")"}}update(r){const s=this._cachedMeta,{data:a=[]}=s,h=this.chart._animationsDisabled;let{start:f,count:m}=s$(s,a,h);if(this._drawStart=f,this._drawCount=m,o$(s)&&(f=0,m=a.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:y,_dataset:x}=s;y._chart=this.chart,y._datasetIndex=this.index,y._decimated=!!x._decimated,y.points=a;const w=this.resolveDatasetElementOptions(r);w.segment=this.options.segment,this.updateElement(y,void 0,{animated:!h,options:w},r)}else this.datasetElementType&&(delete s.dataset,this.datasetElementType=!1);this.updateElements(a,f,m,r)}addElements(){const{showLine:r}=this.options;!this.datasetElementType&&r&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(r,s,a,h){const f=h==="reset",{iScale:m,vScale:y,_stacked:x,_dataset:w}=this._cachedMeta,T=this.resolveDataElementOptions(s,h),M=this.getSharedOptions(T),I=this.includeOptions(h,M),R=m.axis,O=y.axis,{spanGaps:N,segment:G}=this.options,$=xf(N)?N:Number.POSITIVE_INFINITY,z=this.chart._animationsDisabled||f||h==="none";let B=s>0&&this.getParsed(s-1);for(let H=s;H<s+a;++H){const K=r[H],at=this.getParsed(H),ft=z?K:{},et=sr(at[O]),nt=ft[R]=m.getPixelForValue(at[R],H),W=ft[O]=f||et?y.getBasePixel():y.getPixelForValue(x?this.applyStack(y,at,x):at[O],H);ft.skip=isNaN(nt)||isNaN(W)||et,ft.stop=H>0&&Math.abs(at[R]-B[R])>$,G&&(ft.parsed=at,ft.raw=w.data[H]),I&&(ft.options=M||this.resolveDataElementOptions(H,K.active?"active":h)),z||this.updateElement(K,H,ft,h),B=at}this.updateSharedOptions(M,h,T)}getMaxOverflow(){const r=this._cachedMeta,s=r.data||[];if(!this.options.showLine){let y=0;for(let x=s.length-1;x>=0;--x)y=Math.max(y,s[x].size(this.resolveDataElementOptions(x))/2);return y>0&&y}const a=r.dataset,h=a.options&&a.options.borderWidth||0;if(!s.length)return h;const f=s[0].size(this.resolveDataElementOptions(0)),m=s[s.length-1].size(this.resolveDataElementOptions(s.length-1));return Math.max(h,f,m)/2}}Ie(fv,"id","scatter"),Ie(fv,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),Ie(fv,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}});var hft=Object.freeze({__proto__:null,BarController:cv,BubbleController:uv,DoughnutController:fh,LineController:hv,PieController:ZM,PolarAreaController:zm,RadarController:dv,ScatterController:fv});function Ju(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class AP{constructor(r){Ie(this,"options");this.options=r||{}}static override(r){Object.assign(AP.prototype,r)}init(){}formats(){return Ju()}parse(){return Ju()}format(){return Ju()}add(){return Ju()}diff(){return Ju()}startOf(){return Ju()}endOf(){return Ju()}}var dft={_date:AP};function fft(e,r,s,a){const{controller:h,data:f,_sorted:m}=e,y=h._cachedMeta.iScale;if(y&&r===y.axis&&r!=="r"&&m&&f.length){const x=y._reversePixels?zht:Pl;if(a){if(h._sharedOptions){const w=f[0],T=typeof w.getRange=="function"&&w.getRange(r);if(T){const M=x(f,r,s-T),I=x(f,r,s+T);return{lo:M.lo,hi:I.hi}}}}else return x(f,r,s)}return{lo:0,hi:f.length-1}}function Vg(e,r,s,a,h){const f=e.getSortedVisibleDatasetMetas(),m=s[r];for(let y=0,x=f.length;y<x;++y){const{index:w,data:T}=f[y],{lo:M,hi:I}=fft(f[y],r,m,h);for(let R=M;R<=I;++R){const O=T[R];O.skip||a(O,w,R)}}}function pft(e){const r=e.indexOf("x")!==-1,s=e.indexOf("y")!==-1;return function(a,h){const f=r?Math.abs(a.x-h.x):0,m=s?Math.abs(a.y-h.y):0;return Math.sqrt(Math.pow(f,2)+Math.pow(m,2))}}function eE(e,r,s,a,h){const f=[];return!h&&!e.isPointInArea(r)||Vg(e,s,r,function(y,x,w){!h&&!Il(y,e.chartArea,0)||y.inRange(r.x,r.y,a)&&f.push({element:y,datasetIndex:x,index:w})},!0),f}function mft(e,r,s,a){let h=[];function f(m,y,x){const{startAngle:w,endAngle:T}=m.getProps(["startAngle","endAngle"],a),{angle:M}=t$(m,{x:r.x,y:r.y});gg(M,w,T)&&h.push({element:m,datasetIndex:y,index:x})}return Vg(e,s,r,f),h}function gft(e,r,s,a,h,f){let m=[];const y=pft(s);let x=Number.POSITIVE_INFINITY;function w(T,M,I){const R=T.inRange(r.x,r.y,h);if(a&&!R)return;const O=T.getCenterPoint(h);if(!(!!f||e.isPointInArea(O))&&!R)return;const G=y(r,O);G<x?(m=[{element:T,datasetIndex:M,index:I}],x=G):G===x&&m.push({element:T,datasetIndex:M,index:I})}return Vg(e,s,r,w),m}function nE(e,r,s,a,h,f){return!f&&!e.isPointInArea(r)?[]:s==="r"&&!a?mft(e,r,s,h):gft(e,r,s,a,h,f)}function gF(e,r,s,a,h){const f=[],m=s==="x"?"inXRange":"inYRange";let y=!1;return Vg(e,s,r,(x,w,T)=>{x[m](r[s],h)&&(f.push({element:x,datasetIndex:w,index:T}),y=y||x.inRange(r.x,r.y,h))}),a&&!y?[]:f}var _ft={evaluateInteractionItems:Vg,modes:{index(e,r,s,a){const h=sh(r,e),f=s.axis||"x",m=s.includeInvisible||!1,y=s.intersect?eE(e,h,f,a,m):nE(e,h,f,!1,a,m),x=[];return y.length?(e.getSortedVisibleDatasetMetas().forEach(w=>{const T=y[0].index,M=w.data[T];M&&!M.skip&&x.push({element:M,datasetIndex:w.index,index:T})}),x):[]},dataset(e,r,s,a){const h=sh(r,e),f=s.axis||"xy",m=s.includeInvisible||!1;let y=s.intersect?eE(e,h,f,a,m):nE(e,h,f,!1,a,m);if(y.length>0){const x=y[0].datasetIndex,w=e.getDatasetMeta(x).data;y=[];for(let T=0;T<w.length;++T)y.push({element:w[T],datasetIndex:x,index:T})}return y},point(e,r,s,a){const h=sh(r,e),f=s.axis||"xy",m=s.includeInvisible||!1;return eE(e,h,f,a,m)},nearest(e,r,s,a){const h=sh(r,e),f=s.axis||"xy",m=s.includeInvisible||!1;return nE(e,h,f,s.intersect,a,m)},x(e,r,s,a){const h=sh(r,e);return gF(e,h,"x",s.intersect,a)},y(e,r,s,a){const h=sh(r,e);return gF(e,h,"y",s.intersect,a)}}};const T$=["left","top","right","bottom"];function Qp(e,r){return e.filter(s=>s.pos===r)}function _F(e,r){return e.filter(s=>T$.indexOf(s.pos)===-1&&s.box.axis===r)}function tm(e,r){return e.sort((s,a)=>{const h=r?a:s,f=r?s:a;return h.weight===f.weight?h.index-f.index:h.weight-f.weight})}function yft(e){const r=[];let s,a,h,f,m,y;for(s=0,a=(e||[]).length;s<a;++s)h=e[s],{position:f,options:{stack:m,stackWeight:y=1}}=h,r.push({index:s,box:h,pos:f,horizontal:h.isHorizontal(),weight:h.weight,stack:m&&f+m,stackWeight:y});return r}function vft(e){const r={};for(const s of e){const{stack:a,pos:h,stackWeight:f}=s;if(!a||!T$.includes(h))continue;const m=r[a]||(r[a]={count:0,placed:0,weight:0,size:0});m.count++,m.weight+=f}return r}function xft(e,r){const s=vft(e),{vBoxMaxWidth:a,hBoxMaxHeight:h}=r;let f,m,y;for(f=0,m=e.length;f<m;++f){y=e[f];const{fullSize:x}=y.box,w=s[y.stack],T=w&&y.stackWeight/w.weight;y.horizontal?(y.width=T?T*a:x&&r.availableWidth,y.height=h):(y.width=a,y.height=T?T*h:x&&r.availableHeight)}return s}function bft(e){const r=yft(e),s=tm(r.filter(w=>w.box.fullSize),!0),a=tm(Qp(r,"left"),!0),h=tm(Qp(r,"right")),f=tm(Qp(r,"top"),!0),m=tm(Qp(r,"bottom")),y=_F(r,"x"),x=_F(r,"y");return{fullSize:s,leftAndTop:a.concat(f),rightAndBottom:h.concat(x).concat(m).concat(y),chartArea:Qp(r,"chartArea"),vertical:a.concat(h).concat(x),horizontal:f.concat(m).concat(y)}}function yF(e,r,s,a){return Math.max(e[s],r[s])+Math.max(e[a],r[a])}function E$(e,r){e.top=Math.max(e.top,r.top),e.left=Math.max(e.left,r.left),e.bottom=Math.max(e.bottom,r.bottom),e.right=Math.max(e.right,r.right)}function wft(e,r,s,a){const{pos:h,box:f}=s,m=e.maxPadding;if(!Zn(h)){s.size&&(e[h]-=s.size);const M=a[s.stack]||{size:0,count:1};M.size=Math.max(M.size,s.horizontal?f.height:f.width),s.size=M.size/M.count,e[h]+=s.size}f.getPadding&&E$(m,f.getPadding());const y=Math.max(0,r.outerWidth-yF(m,e,"left","right")),x=Math.max(0,r.outerHeight-yF(m,e,"top","bottom")),w=y!==e.w,T=x!==e.h;return e.w=y,e.h=x,s.horizontal?{same:w,other:T}:{same:T,other:w}}function Sft(e){const r=e.maxPadding;function s(a){const h=Math.max(r[a]-e[a],0);return e[a]+=h,h}e.y+=s("top"),e.x+=s("left"),s("right"),s("bottom")}function Tft(e,r){const s=r.maxPadding;function a(h){const f={left:0,top:0,right:0,bottom:0};return h.forEach(m=>{f[m]=Math.max(r[m],s[m])}),f}return a(e?["left","right"]:["top","bottom"])}function fm(e,r,s,a){const h=[];let f,m,y,x,w,T;for(f=0,m=e.length,w=0;f<m;++f){y=e[f],x=y.box,x.update(y.width||r.w,y.height||r.h,Tft(y.horizontal,r));const{same:M,other:I}=wft(r,s,y,a);w|=M&&h.length,T=T||I,x.fullSize||h.push(y)}return w&&fm(h,r,s,a)||T}function D0(e,r,s,a,h){e.top=s,e.left=r,e.right=r+a,e.bottom=s+h,e.width=a,e.height=h}function vF(e,r,s,a){const h=s.padding;let{x:f,y:m}=r;for(const y of e){const x=y.box,w=a[y.stack]||{count:1,placed:0,weight:1},T=y.stackWeight/w.weight||1;if(y.horizontal){const M=r.w*T,I=w.size||x.height;mg(w.start)&&(m=w.start),x.fullSize?D0(x,h.left,m,s.outerWidth-h.right-h.left,I):D0(x,r.left+w.placed,m,M,I),w.start=m,w.placed+=M,m=x.bottom}else{const M=r.h*T,I=w.size||x.width;mg(w.start)&&(f=w.start),x.fullSize?D0(x,f,h.top,I,s.outerHeight-h.bottom-h.top):D0(x,f,r.top+w.placed,I,M),w.start=f,w.placed+=M,f=x.right}}r.x=f,r.y=m}var ds={addBox(e,r){e.boxes||(e.boxes=[]),r.fullSize=r.fullSize||!1,r.position=r.position||"top",r.weight=r.weight||0,r._layers=r._layers||function(){return[{z:0,draw(s){r.draw(s)}}]},e.boxes.push(r)},removeBox(e,r){const s=e.boxes?e.boxes.indexOf(r):-1;s!==-1&&e.boxes.splice(s,1)},configure(e,r,s){r.fullSize=s.fullSize,r.position=s.position,r.weight=s.weight},update(e,r,s,a){if(!e)return;const h=ps(e.options.layout.padding),f=Math.max(r-h.width,0),m=Math.max(s-h.height,0),y=bft(e.boxes),x=y.vertical,w=y.horizontal;xr(e.boxes,N=>{typeof N.beforeLayout=="function"&&N.beforeLayout()});const T=x.reduce((N,G)=>G.box.options&&G.box.options.display===!1?N:N+1,0)||1,M=Object.freeze({outerWidth:r,outerHeight:s,padding:h,availableWidth:f,availableHeight:m,vBoxMaxWidth:f/2/T,hBoxMaxHeight:m/2}),I=Object.assign({},h);E$(I,ps(a));const R=Object.assign({maxPadding:I,w:f,h:m,x:h.left,y:h.top},h),O=xft(x.concat(w),M);fm(y.fullSize,R,M,O),fm(x,R,M,O),fm(w,R,M,O)&&fm(x,R,M,O),Sft(R),vF(y.leftAndTop,R,M,O),R.x+=R.w,R.y+=R.h,vF(y.rightAndBottom,R,M,O),e.chartArea={left:R.left,top:R.top,right:R.left+R.w,bottom:R.top+R.h,height:R.h,width:R.w},xr(y.chartArea,N=>{const G=N.box;Object.assign(G,e.chartArea),G.update(R.w,R.h,{left:0,top:0,right:0,bottom:0})})}};class M${acquireContext(r,s){}releaseContext(r){return!1}addEventListener(r,s,a){}removeEventListener(r,s,a){}getDevicePixelRatio(){return 1}getMaximumSize(r,s,a,h){return s=Math.max(0,s||r.width),a=a||r.height,{width:s,height:Math.max(0,h?Math.floor(s/h):a)}}isAttached(r){return!0}updateConfig(r){}}class Eft extends M${acquireContext(r){return r&&r.getContext&&r.getContext("2d")||null}updateConfig(r){r.options.animation=!1}}const pv="$chartjs",Mft={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},xF=e=>e===null||e==="";function Aft(e,r){const s=e.style,a=e.getAttribute("height"),h=e.getAttribute("width");if(e[pv]={initial:{height:a,width:h,style:{display:s.display,height:s.height,width:s.width}}},s.display=s.display||"block",s.boxSizing=s.boxSizing||"border-box",xF(h)){const f=nF(e,"width");f!==void 0&&(e.width=f)}if(xF(a))if(e.style.height==="")e.height=e.width/(r||2);else{const f=nF(e,"height");f!==void 0&&(e.height=f)}return e}const A$=Pdt?{passive:!0}:!1;function Cft(e,r,s){e.addEventListener(r,s,A$)}function Pft(e,r,s){e.canvas.removeEventListener(r,s,A$)}function Ift(e,r){const s=Mft[e.type]||e.type,{x:a,y:h}=sh(e,r);return{type:s,chart:r,native:e,x:a!==void 0?a:null,y:h!==void 0?h:null}}function bx(e,r){for(const s of e)if(s===r||s.contains(r))return!0}function kft(e,r,s){const a=e.canvas,h=new MutationObserver(f=>{let m=!1;for(const y of f)m=m||bx(y.addedNodes,a),m=m&&!bx(y.removedNodes,a);m&&s()});return h.observe(document,{childList:!0,subtree:!0}),h}function Dft(e,r,s){const a=e.canvas,h=new MutationObserver(f=>{let m=!1;for(const y of f)m=m||bx(y.removedNodes,a),m=m&&!bx(y.addedNodes,a);m&&s()});return h.observe(document,{childList:!0,subtree:!0}),h}const yg=new Map;let bF=0;function C$(){const e=window.devicePixelRatio;e!==bF&&(bF=e,yg.forEach((r,s)=>{s.currentDevicePixelRatio!==e&&r()}))}function Rft(e,r){yg.size||window.addEventListener("resize",C$),yg.set(e,r)}function Oft(e){yg.delete(e),yg.size||window.removeEventListener("resize",C$)}function Lft(e,r,s){const a=e.canvas,h=a&&MP(a);if(!h)return;const f=i$((y,x)=>{const w=h.clientWidth;s(y,x),w<h.clientWidth&&s()},window),m=new ResizeObserver(y=>{const x=y[0],w=x.contentRect.width,T=x.contentRect.height;w===0&&T===0||f(w,T)});return m.observe(h),Rft(e,f),m}function rE(e,r,s){s&&s.disconnect(),r==="resize"&&Oft(e)}function zft(e,r,s){const a=e.canvas,h=i$(f=>{e.ctx!==null&&s(Ift(f,e))},e);return Cft(a,r,h),h}class Nft extends M${acquireContext(r,s){const a=r&&r.getContext&&r.getContext("2d");return a&&a.canvas===r?(Aft(r,s),a):null}releaseContext(r){const s=r.canvas;if(!s[pv])return!1;const a=s[pv].initial;["height","width"].forEach(f=>{const m=a[f];sr(m)?s.removeAttribute(f):s.setAttribute(f,m)});const h=a.style||{};return Object.keys(h).forEach(f=>{s.style[f]=h[f]}),s.width=s.width,delete s[pv],!0}addEventListener(r,s,a){this.removeEventListener(r,s);const h=r.$proxies||(r.$proxies={}),m={attach:kft,detach:Dft,resize:Lft}[s]||zft;h[s]=m(r,s,a)}removeEventListener(r,s){const a=r.$proxies||(r.$proxies={}),h=a[s];if(!h)return;({attach:rE,detach:rE,resize:rE}[s]||Pft)(r,s,h),a[s]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(r,s,a,h){return Cdt(r,s,a,h)}isAttached(r){const s=MP(r);return!!(s&&s.isConnected)}}function Fft(e){return!EP()||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas?Eft:Nft}var V0;let Wl=(V0=class{constructor(){Ie(this,"x");Ie(this,"y");Ie(this,"active",!1);Ie(this,"options");Ie(this,"$animations")}tooltipPosition(r){const{x:s,y:a}=this.getProps(["x","y"],r);return{x:s,y:a}}hasValue(){return xf(this.x)&&xf(this.y)}getProps(r,s){const a=this.$animations;if(!s||!a)return this;const h={};return r.forEach(f=>{h[f]=a[f]&&a[f].active()?a[f]._to:this[f]}),h}},Ie(V0,"defaults",{}),Ie(V0,"defaultRoutes"),V0);function Bft(e,r){const s=e.options.ticks,a=jft(e),h=Math.min(s.maxTicksLimit||a,a),f=s.major.enabled?Uft(r):[],m=f.length,y=f[0],x=f[m-1],w=[];if(m>h)return $ft(r,w,f,m/h),w;const T=Vft(f,r,h);if(m>0){let M,I;const R=m>1?Math.round((x-y)/(m-1)):null;for(R0(r,w,T,sr(R)?0:y-R,y),M=0,I=m-1;M<I;M++)R0(r,w,T,f[M],f[M+1]);return R0(r,w,T,x,sr(R)?r.length:x+R),w}return R0(r,w,T),w}function jft(e){const r=e.options.offset,s=e._tickSize(),a=e._length/s+(r?0:1),h=e._maxLength/s;return Math.floor(Math.min(a,h))}function Vft(e,r,s){const a=Gft(e),h=r.length/s;if(!a)return Math.max(h,1);const f=Dht(a);for(let m=0,y=f.length-1;m<y;m++){const x=f[m];if(x>h)return x}return Math.max(h,1)}function Uft(e){const r=[];let s,a;for(s=0,a=e.length;s<a;s++)e[s].major&&r.push(s);return r}function $ft(e,r,s,a){let h=0,f=s[0],m;for(a=Math.ceil(a),m=0;m<e.length;m++)m===f&&(r.push(e[m]),h++,f=s[h*a])}function R0(e,r,s,a,h){const f=On(a,0),m=Math.min(On(h,e.length),e.length);let y=0,x,w,T;for(s=Math.ceil(s),h&&(x=h-a,s=x/Math.floor(x/s)),T=f;T<0;)y++,T=Math.round(f+y*s);for(w=Math.max(f,0);w<m;w++)w===T&&(r.push(e[w]),y++,T=Math.round(f+y*s))}function Gft(e){const r=e.length;let s,a;if(r<2)return!1;for(a=e[0],s=1;s<r;++s)if(e[s]-e[s-1]!==a)return!1;return a}const Wft=e=>e==="left"?"right":e==="right"?"left":e,wF=(e,r,s)=>r==="top"||r==="left"?e[r]+s:e[r]-s,SF=(e,r)=>Math.min(r||e,e);function TF(e,r){const s=[],a=e.length/r,h=e.length;let f=0;for(;f<h;f+=a)s.push(e[Math.floor(f)]);return s}function Hft(e,r,s){const a=e.ticks.length,h=Math.min(r,a-1),f=e._startPixel,m=e._endPixel,y=1e-6;let x=e.getPixelForTick(h),w;if(!(s&&(a===1?w=Math.max(x-f,m-x):r===0?w=(e.getPixelForTick(1)-x)/2:w=(x-e.getPixelForTick(h-1))/2,x+=h<r?w:-w,x<f-y||x>m+y)))return x}function qft(e,r){xr(e,s=>{const a=s.gc,h=a.length/2;let f;if(h>r){for(f=0;f<h;++f)delete s.data[a[f]];a.splice(0,h)}})}function em(e){return e.drawTicks?e.tickLength:0}function EF(e,r){if(!e.display)return 0;const s=Vi(e.font,r),a=ps(e.padding);return(jr(e.text)?e.text.length:1)*s.lineHeight+a.height}function Zft(e,r){return xu(e,{scale:r,type:"scale"})}function Xft(e,r,s){return xu(e,{tick:s,index:r,type:"tick"})}function Yft(e,r,s){let a=vP(e);return(s&&r!=="right"||!s&&r==="right")&&(a=Wft(a)),a}function Kft(e,r,s,a){const{top:h,left:f,bottom:m,right:y,chart:x}=e,{chartArea:w,scales:T}=x;let M=0,I,R,O;const N=m-h,G=y-f;if(e.isHorizontal()){if(R=us(a,f,y),Zn(s)){const $=Object.keys(s)[0],z=s[$];O=T[$].getPixelForValue(z)+N-r}else s==="center"?O=(w.bottom+w.top)/2+N-r:O=wF(e,s,r);I=y-f}else{if(Zn(s)){const $=Object.keys(s)[0],z=s[$];R=T[$].getPixelForValue(z)-G+r}else s==="center"?R=(w.left+w.right)/2-G+r:R=wF(e,s,r);O=us(a,m,h),M=s==="left"?-Ti:Ti}return{titleX:R,titleY:O,maxWidth:I,rotation:M}}class Nh extends Wl{constructor(r){super(),this.id=r.id,this.type=r.type,this.options=void 0,this.ctx=r.ctx,this.chart=r.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(r){this.options=r.setContext(this.getContext()),this.axis=r.axis,this._userMin=this.parse(r.min),this._userMax=this.parse(r.max),this._suggestedMin=this.parse(r.suggestedMin),this._suggestedMax=this.parse(r.suggestedMax)}parse(r,s){return r}getUserBounds(){let{_userMin:r,_userMax:s,_suggestedMin:a,_suggestedMax:h}=this;return r=io(r,Number.POSITIVE_INFINITY),s=io(s,Number.NEGATIVE_INFINITY),a=io(a,Number.POSITIVE_INFINITY),h=io(h,Number.NEGATIVE_INFINITY),{min:io(r,a),max:io(s,h),minDefined:di(r),maxDefined:di(s)}}getMinMax(r){let{min:s,max:a,minDefined:h,maxDefined:f}=this.getUserBounds(),m;if(h&&f)return{min:s,max:a};const y=this.getMatchingVisibleMetas();for(let x=0,w=y.length;x<w;++x)m=y[x].controller.getMinMax(this,r),h||(s=Math.min(s,m.min)),f||(a=Math.max(a,m.max));return s=f&&s>a?a:s,a=h&&s>a?s:a,{min:io(s,io(a,s)),max:io(a,io(s,a))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const r=this.chart.data;return this.options.labels||(this.isHorizontal()?r.xLabels:r.yLabels)||r.labels||[]}getLabelItems(r=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(r))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Lr(this.options.beforeUpdate,[this])}update(r,s,a){const{beginAtZero:h,grace:f,ticks:m}=this.options,y=m.sampleSize;this.beforeUpdate(),this.maxWidth=r,this.maxHeight=s,this._margins=a=Object.assign({left:0,right:0,top:0,bottom:0},a),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+a.left+a.right:this.height+a.top+a.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=odt(this,f,h),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const x=y<this.ticks.length;this._convertTicksToLabels(x?TF(this.ticks,y):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),m.display&&(m.autoSkip||m.source==="auto")&&(this.ticks=Bft(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),x&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let r=this.options.reverse,s,a;this.isHorizontal()?(s=this.left,a=this.right):(s=this.top,a=this.bottom,r=!r),this._startPixel=s,this._endPixel=a,this._reversePixels=r,this._length=a-s,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Lr(this.options.afterUpdate,[this])}beforeSetDimensions(){Lr(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Lr(this.options.afterSetDimensions,[this])}_callHooks(r){this.chart.notifyPlugins(r,this.getContext()),Lr(this.options[r],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Lr(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(r){const s=this.options.ticks;let a,h,f;for(a=0,h=r.length;a<h;a++)f=r[a],f.label=Lr(s.callback,[f.value,a,r],this)}afterTickToLabelConversion(){Lr(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Lr(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const r=this.options,s=r.ticks,a=SF(this.ticks.length,r.ticks.maxTicksLimit),h=s.minRotation||0,f=s.maxRotation;let m=h,y,x,w;if(!this._isVisible()||!s.display||h>=f||a<=1||!this.isHorizontal()){this.labelRotation=h;return}const T=this._getLabelSizes(),M=T.widest.width,I=T.highest.height,R=Wi(this.chart.width-M,0,this.maxWidth);y=r.offset?this.maxWidth/a:R/(a-1),M+6>y&&(y=R/(a-(r.offset?.5:1)),x=this.maxHeight-em(r.grid)-s.padding-EF(r.title,this.chart.options.font),w=Math.sqrt(M*M+I*I),m=_P(Math.min(Math.asin(Wi((T.highest.height+6)/y,-1,1)),Math.asin(Wi(x/w,-1,1))-Math.asin(Wi(I/w,-1,1)))),m=Math.max(h,Math.min(f,m))),this.labelRotation=m}afterCalculateLabelRotation(){Lr(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Lr(this.options.beforeFit,[this])}fit(){const r={width:0,height:0},{chart:s,options:{ticks:a,title:h,grid:f}}=this,m=this._isVisible(),y=this.isHorizontal();if(m){const x=EF(h,s.options.font);if(y?(r.width=this.maxWidth,r.height=em(f)+x):(r.height=this.maxHeight,r.width=em(f)+x),a.display&&this.ticks.length){const{first:w,last:T,widest:M,highest:I}=this._getLabelSizes(),R=a.padding*2,O=ha(this.labelRotation),N=Math.cos(O),G=Math.sin(O);if(y){const $=a.mirror?0:G*M.width+N*I.height;r.height=Math.min(this.maxHeight,r.height+$+R)}else{const $=a.mirror?0:N*M.width+G*I.height;r.width=Math.min(this.maxWidth,r.width+$+R)}this._calculatePadding(w,T,G,N)}}this._handleMargins(),y?(this.width=this._length=s.width-this._margins.left-this._margins.right,this.height=r.height):(this.width=r.width,this.height=this._length=s.height-this._margins.top-this._margins.bottom)}_calculatePadding(r,s,a,h){const{ticks:{align:f,padding:m},position:y}=this.options,x=this.labelRotation!==0,w=y!=="top"&&this.axis==="x";if(this.isHorizontal()){const T=this.getPixelForTick(0)-this.left,M=this.right-this.getPixelForTick(this.ticks.length-1);let I=0,R=0;x?w?(I=h*r.width,R=a*s.height):(I=a*r.height,R=h*s.width):f==="start"?R=s.width:f==="end"?I=r.width:f!=="inner"&&(I=r.width/2,R=s.width/2),this.paddingLeft=Math.max((I-T+m)*this.width/(this.width-T),0),this.paddingRight=Math.max((R-M+m)*this.width/(this.width-M),0)}else{let T=s.height/2,M=r.height/2;f==="start"?(T=0,M=r.height):f==="end"&&(T=s.height,M=0),this.paddingTop=T+m,this.paddingBottom=M+m}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Lr(this.options.afterFit,[this])}isHorizontal(){const{axis:r,position:s}=this.options;return s==="top"||s==="bottom"||r==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(r){this.beforeTickToLabelConversion(),this.generateTickLabels(r);let s,a;for(s=0,a=r.length;s<a;s++)sr(r[s].label)&&(r.splice(s,1),a--,s--);this.afterTickToLabelConversion()}_getLabelSizes(){let r=this._labelSizes;if(!r){const s=this.options.ticks.sampleSize;let a=this.ticks;s<a.length&&(a=TF(a,s)),this._labelSizes=r=this._computeLabelSizes(a,a.length,this.options.ticks.maxTicksLimit)}return r}_computeLabelSizes(r,s,a){const{ctx:h,_longestTextCache:f}=this,m=[],y=[],x=Math.floor(s/SF(s,a));let w=0,T=0,M,I,R,O,N,G,$,z,B,H,K;for(M=0;M<s;M+=x){if(O=r[M].label,N=this._resolveTickFontOptions(M),h.font=G=N.string,$=f[G]=f[G]||{data:{},gc:[]},z=N.lineHeight,B=H=0,!sr(O)&&!jr(O))B=vx(h,$.data,$.gc,B,O),H=z;else if(jr(O))for(I=0,R=O.length;I<R;++I)K=O[I],!sr(K)&&!jr(K)&&(B=vx(h,$.data,$.gc,B,K),H+=z);m.push(B),y.push(H),w=Math.max(B,w),T=Math.max(H,T)}qft(f,s);const at=m.indexOf(w),ft=y.indexOf(T),et=nt=>({width:m[nt]||0,height:y[nt]||0});return{first:et(0),last:et(s-1),widest:et(at),highest:et(ft),widths:m,heights:y}}getLabelForValue(r){return r}getPixelForValue(r,s){return NaN}getValueForPixel(r){}getPixelForTick(r){const s=this.ticks;return r<0||r>s.length-1?null:this.getPixelForValue(s[r].value)}getPixelForDecimal(r){this._reversePixels&&(r=1-r);const s=this._startPixel+r*this._length;return Lht(this._alignToPixels?Ku(this.chart,s,0):s)}getDecimalForPixel(r){const s=(r-this._startPixel)/this._length;return this._reversePixels?1-s:s}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:r,max:s}=this;return r<0&&s<0?s:r>0&&s>0?r:0}getContext(r){const s=this.ticks||[];if(r>=0&&r<s.length){const a=s[r];return a.$context||(a.$context=Xft(this.getContext(),r,a))}return this.$context||(this.$context=Zft(this.chart.getContext(),this))}_tickSize(){const r=this.options.ticks,s=ha(this.labelRotation),a=Math.abs(Math.cos(s)),h=Math.abs(Math.sin(s)),f=this._getLabelSizes(),m=r.autoSkipPadding||0,y=f?f.widest.width+m:0,x=f?f.highest.height+m:0;return this.isHorizontal()?x*a>y*h?y/a:x/h:x*h<y*a?x/a:y/h}_isVisible(){const r=this.options.display;return r!=="auto"?!!r:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(r){const s=this.axis,a=this.chart,h=this.options,{grid:f,position:m,border:y}=h,x=f.offset,w=this.isHorizontal(),M=this.ticks.length+(x?1:0),I=em(f),R=[],O=y.setContext(this.getContext()),N=O.display?O.width:0,G=N/2,$=function(Rt){return Ku(a,Rt,N)};let z,B,H,K,at,ft,et,nt,W,Q,yt,Pt;if(m==="top")z=$(this.bottom),ft=this.bottom-I,nt=z-G,Q=$(r.top)+G,Pt=r.bottom;else if(m==="bottom")z=$(this.top),Q=r.top,Pt=$(r.bottom)-G,ft=z+G,nt=this.top+I;else if(m==="left")z=$(this.right),at=this.right-I,et=z-G,W=$(r.left)+G,yt=r.right;else if(m==="right")z=$(this.left),W=r.left,yt=$(r.right)-G,at=z+G,et=this.left+I;else if(s==="x"){if(m==="center")z=$((r.top+r.bottom)/2+.5);else if(Zn(m)){const Rt=Object.keys(m)[0],Zt=m[Rt];z=$(this.chart.scales[Rt].getPixelForValue(Zt))}Q=r.top,Pt=r.bottom,ft=z+G,nt=ft+I}else if(s==="y"){if(m==="center")z=$((r.left+r.right)/2);else if(Zn(m)){const Rt=Object.keys(m)[0],Zt=m[Rt];z=$(this.chart.scales[Rt].getPixelForValue(Zt))}at=z-G,et=at-I,W=r.left,yt=r.right}const st=On(h.ticks.maxTicksLimit,M),St=Math.max(1,Math.ceil(M/st));for(B=0;B<M;B+=St){const Rt=this.getContext(B),Zt=f.setContext(Rt),Ft=y.setContext(Rt),$t=Zt.lineWidth,ee=Zt.color,se=Ft.dash||[],Ot=Ft.dashOffset,Me=Zt.tickWidth,me=Zt.tickColor,kt=Zt.tickBorderDash||[],Wt=Zt.tickBorderDashOffset;H=Hft(this,B,x),H!==void 0&&(K=Ku(a,H,$t),w?at=et=W=yt=K:ft=nt=Q=Pt=K,R.push({tx1:at,ty1:ft,tx2:et,ty2:nt,x1:W,y1:Q,x2:yt,y2:Pt,width:$t,color:ee,borderDash:se,borderDashOffset:Ot,tickWidth:Me,tickColor:me,tickBorderDash:kt,tickBorderDashOffset:Wt}))}return this._ticksLength=M,this._borderValue=z,R}_computeLabelItems(r){const s=this.axis,a=this.options,{position:h,ticks:f}=a,m=this.isHorizontal(),y=this.ticks,{align:x,crossAlign:w,padding:T,mirror:M}=f,I=em(a.grid),R=I+T,O=M?-T:R,N=-ha(this.labelRotation),G=[];let $,z,B,H,K,at,ft,et,nt,W,Q,yt,Pt="middle";if(h==="top")at=this.bottom-O,ft=this._getXAxisLabelAlignment();else if(h==="bottom")at=this.top+O,ft=this._getXAxisLabelAlignment();else if(h==="left"){const St=this._getYAxisLabelAlignment(I);ft=St.textAlign,K=St.x}else if(h==="right"){const St=this._getYAxisLabelAlignment(I);ft=St.textAlign,K=St.x}else if(s==="x"){if(h==="center")at=(r.top+r.bottom)/2+R;else if(Zn(h)){const St=Object.keys(h)[0],Rt=h[St];at=this.chart.scales[St].getPixelForValue(Rt)+R}ft=this._getXAxisLabelAlignment()}else if(s==="y"){if(h==="center")K=(r.left+r.right)/2-R;else if(Zn(h)){const St=Object.keys(h)[0],Rt=h[St];K=this.chart.scales[St].getPixelForValue(Rt)}ft=this._getYAxisLabelAlignment(I).textAlign}s==="y"&&(x==="start"?Pt="top":x==="end"&&(Pt="bottom"));const st=this._getLabelSizes();for($=0,z=y.length;$<z;++$){B=y[$],H=B.label;const St=f.setContext(this.getContext($));et=this.getPixelForTick($)+f.labelOffset,nt=this._resolveTickFontOptions($),W=nt.lineHeight,Q=jr(H)?H.length:1;const Rt=Q/2,Zt=St.color,Ft=St.textStrokeColor,$t=St.textStrokeWidth;let ee=ft;m?(K=et,ft==="inner"&&($===z-1?ee=this.options.reverse?"left":"right":$===0?ee=this.options.reverse?"right":"left":ee="center"),h==="top"?w==="near"||N!==0?yt=-Q*W+W/2:w==="center"?yt=-st.highest.height/2-Rt*W+W:yt=-st.highest.height+W/2:w==="near"||N!==0?yt=W/2:w==="center"?yt=st.highest.height/2-Rt*W:yt=st.highest.height-Q*W,M&&(yt*=-1),N!==0&&!St.showLabelBackdrop&&(K+=W/2*Math.sin(N))):(at=et,yt=(1-Q)*W/2);let se;if(St.showLabelBackdrop){const Ot=ps(St.backdropPadding),Me=st.heights[$],me=st.widths[$];let kt=yt-Ot.top,Wt=0-Ot.left;switch(Pt){case"middle":kt-=Me/2;break;case"bottom":kt-=Me;break}switch(ft){case"center":Wt-=me/2;break;case"right":Wt-=me;break;case"inner":$===z-1?Wt-=me:$>0&&(Wt-=me/2);break}se={left:Wt,top:kt,width:me+Ot.width,height:Me+Ot.height,color:St.backdropColor}}G.push({label:H,font:nt,textOffset:yt,options:{rotation:N,color:Zt,strokeColor:Ft,strokeWidth:$t,textAlign:ee,textBaseline:Pt,translation:[K,at],backdrop:se}})}return G}_getXAxisLabelAlignment(){const{position:r,ticks:s}=this.options;if(-ha(this.labelRotation))return r==="top"?"left":"right";let h="center";return s.align==="start"?h="left":s.align==="end"?h="right":s.align==="inner"&&(h="inner"),h}_getYAxisLabelAlignment(r){const{position:s,ticks:{crossAlign:a,mirror:h,padding:f}}=this.options,m=this._getLabelSizes(),y=r+f,x=m.widest.width;let w,T;return s==="left"?h?(T=this.right+f,a==="near"?w="left":a==="center"?(w="center",T+=x/2):(w="right",T+=x)):(T=this.right-y,a==="near"?w="right":a==="center"?(w="center",T-=x/2):(w="left",T=this.left)):s==="right"?h?(T=this.left+f,a==="near"?w="right":a==="center"?(w="center",T-=x/2):(w="left",T-=x)):(T=this.left+y,a==="near"?w="left":a==="center"?(w="center",T+=x/2):(w="right",T=this.right)):w="right",{textAlign:w,x:T}}_computeLabelArea(){if(this.options.ticks.mirror)return;const r=this.chart,s=this.options.position;if(s==="left"||s==="right")return{top:0,left:this.left,bottom:r.height,right:this.right};if(s==="top"||s==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:r.width}}drawBackground(){const{ctx:r,options:{backgroundColor:s},left:a,top:h,width:f,height:m}=this;s&&(r.save(),r.fillStyle=s,r.fillRect(a,h,f,m),r.restore())}getLineWidthForValue(r){const s=this.options.grid;if(!this._isVisible()||!s.display)return 0;const h=this.ticks.findIndex(f=>f.value===r);return h>=0?s.setContext(this.getContext(h)).lineWidth:0}drawGrid(r){const s=this.options.grid,a=this.ctx,h=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(r));let f,m;const y=(x,w,T)=>{!T.width||!T.color||(a.save(),a.lineWidth=T.width,a.strokeStyle=T.color,a.setLineDash(T.borderDash||[]),a.lineDashOffset=T.borderDashOffset,a.beginPath(),a.moveTo(x.x,x.y),a.lineTo(w.x,w.y),a.stroke(),a.restore())};if(s.display)for(f=0,m=h.length;f<m;++f){const x=h[f];s.drawOnChartArea&&y({x:x.x1,y:x.y1},{x:x.x2,y:x.y2},x),s.drawTicks&&y({x:x.tx1,y:x.ty1},{x:x.tx2,y:x.ty2},{color:x.tickColor,width:x.tickWidth,borderDash:x.tickBorderDash,borderDashOffset:x.tickBorderDashOffset})}}drawBorder(){const{chart:r,ctx:s,options:{border:a,grid:h}}=this,f=a.setContext(this.getContext()),m=a.display?f.width:0;if(!m)return;const y=h.setContext(this.getContext(0)).lineWidth,x=this._borderValue;let w,T,M,I;this.isHorizontal()?(w=Ku(r,this.left,m)-m/2,T=Ku(r,this.right,y)+y/2,M=I=x):(M=Ku(r,this.top,m)-m/2,I=Ku(r,this.bottom,y)+y/2,w=T=x),s.save(),s.lineWidth=f.width,s.strokeStyle=f.color,s.beginPath(),s.moveTo(w,M),s.lineTo(T,I),s.stroke(),s.restore()}drawLabels(r){if(!this.options.ticks.display)return;const a=this.ctx,h=this._computeLabelArea();h&&y1(a,h);const f=this.getLabelItems(r);for(const m of f){const y=m.options,x=m.font,w=m.label,T=m.textOffset;Ph(a,w,0,T,x,y)}h&&v1(a)}drawTitle(){const{ctx:r,options:{position:s,title:a,reverse:h}}=this;if(!a.display)return;const f=Vi(a.font),m=ps(a.padding),y=a.align;let x=f.lineHeight/2;s==="bottom"||s==="center"||Zn(s)?(x+=m.bottom,jr(a.text)&&(x+=f.lineHeight*(a.text.length-1))):x+=m.top;const{titleX:w,titleY:T,maxWidth:M,rotation:I}=Kft(this,x,s,y);Ph(r,a.text,0,0,f,{color:a.color,maxWidth:M,rotation:I,textAlign:Yft(y,s,h),textBaseline:"middle",translation:[w,T]})}draw(r){this._isVisible()&&(this.drawBackground(),this.drawGrid(r),this.drawBorder(),this.drawTitle(),this.drawLabels(r))}_layers(){const r=this.options,s=r.ticks&&r.ticks.z||0,a=On(r.grid&&r.grid.z,-1),h=On(r.border&&r.border.z,0);return!this._isVisible()||this.draw!==Nh.prototype.draw?[{z:s,draw:f=>{this.draw(f)}}]:[{z:a,draw:f=>{this.drawBackground(),this.drawGrid(f),this.drawTitle()}},{z:h,draw:()=>{this.drawBorder()}},{z:s,draw:f=>{this.drawLabels(f)}}]}getMatchingVisibleMetas(r){const s=this.chart.getSortedVisibleDatasetMetas(),a=this.axis+"AxisID",h=[];let f,m;for(f=0,m=s.length;f<m;++f){const y=s[f];y[a]===this.id&&(!r||y.type===r)&&h.push(y)}return h}_resolveTickFontOptions(r){const s=this.options.ticks.setContext(this.getContext(r));return Vi(s.font)}_maxDigits(){const r=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/r}}class O0{constructor(r,s,a){this.type=r,this.scope=s,this.override=a,this.items=Object.create(null)}isForType(r){return Object.prototype.isPrototypeOf.call(this.type.prototype,r.prototype)}register(r){const s=Object.getPrototypeOf(r);let a;tpt(s)&&(a=this.register(s));const h=this.items,f=r.id,m=this.scope+"."+f;if(!f)throw new Error("class does not have id: "+r);return f in h||(h[f]=r,Jft(r,m,a),this.override&&fi.override(r.id,r.overrides)),m}get(r){return this.items[r]}unregister(r){const s=this.items,a=r.id,h=this.scope;a in s&&delete s[a],h&&a in fi[h]&&(delete fi[h][a],this.override&&delete Ch[a])}}function Jft(e,r,s){const a=pg(Object.create(null),[s?fi.get(s):{},fi.get(r),e.defaults]);fi.set(r,a),e.defaultRoutes&&Qft(r,e.defaultRoutes),e.descriptors&&fi.describe(r,e.descriptors)}function Qft(e,r){Object.keys(r).forEach(s=>{const a=s.split("."),h=a.pop(),f=[e].concat(a).join("."),m=r[s].split("."),y=m.pop(),x=m.join(".");fi.route(f,h,x,y)})}function tpt(e){return"id"in e&&"defaults"in e}class ept{constructor(){this.controllers=new O0(ma,"datasets",!0),this.elements=new O0(Wl,"elements"),this.plugins=new O0(Object,"plugins"),this.scales=new O0(Nh,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...r){this._each("register",r)}remove(...r){this._each("unregister",r)}addControllers(...r){this._each("register",r,this.controllers)}addElements(...r){this._each("register",r,this.elements)}addPlugins(...r){this._each("register",r,this.plugins)}addScales(...r){this._each("register",r,this.scales)}getController(r){return this._get(r,this.controllers,"controller")}getElement(r){return this._get(r,this.elements,"element")}getPlugin(r){return this._get(r,this.plugins,"plugin")}getScale(r){return this._get(r,this.scales,"scale")}removeControllers(...r){this._each("unregister",r,this.controllers)}removeElements(...r){this._each("unregister",r,this.elements)}removePlugins(...r){this._each("unregister",r,this.plugins)}removeScales(...r){this._each("unregister",r,this.scales)}_each(r,s,a){[...s].forEach(h=>{const f=a||this._getRegistryForType(h);a||f.isForType(h)||f===this.plugins&&h.id?this._exec(r,f,h):xr(h,m=>{const y=a||this._getRegistryForType(m);this._exec(r,y,m)})})}_exec(r,s,a){const h=gP(r);Lr(a["before"+h],[],a),s[r](a),Lr(a["after"+h],[],a)}_getRegistryForType(r){for(let s=0;s<this._typedRegistries.length;s++){const a=this._typedRegistries[s];if(a.isForType(r))return a}return this.plugins}_get(r,s,a){const h=s.get(r);if(h===void 0)throw new Error('"'+r+'" is not a registered '+a+".");return h}}var ja=new ept;class npt{constructor(){this._init=[]}notify(r,s,a,h){s==="beforeInit"&&(this._init=this._createDescriptors(r,!0),this._notify(this._init,r,"install"));const f=h?this._descriptors(r).filter(h):this._descriptors(r),m=this._notify(f,r,s,a);return s==="afterDestroy"&&(this._notify(f,r,"stop"),this._notify(this._init,r,"uninstall")),m}_notify(r,s,a,h){h=h||{};for(const f of r){const m=f.plugin,y=m[a],x=[s,h,f.options];if(Lr(y,x,m)===!1&&h.cancelable)return!1}return!0}invalidate(){sr(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(r){if(this._cache)return this._cache;const s=this._cache=this._createDescriptors(r);return this._notifyStateChanges(r),s}_createDescriptors(r,s){const a=r&&r.config,h=On(a.options&&a.options.plugins,{}),f=rpt(a);return h===!1&&!s?[]:spt(r,f,h,s)}_notifyStateChanges(r){const s=this._oldCache||[],a=this._cache,h=(f,m)=>f.filter(y=>!m.some(x=>y.plugin.id===x.plugin.id));this._notify(h(s,a),r,"stop"),this._notify(h(a,s),r,"start")}}function rpt(e){const r={},s=[],a=Object.keys(ja.plugins.items);for(let f=0;f<a.length;f++)s.push(ja.getPlugin(a[f]));const h=e.plugins||[];for(let f=0;f<h.length;f++){const m=h[f];s.indexOf(m)===-1&&(s.push(m),r[m.id]=!0)}return{plugins:s,localIds:r}}function ipt(e,r){return!r&&e===!1?null:e===!0?{}:e}function spt(e,{plugins:r,localIds:s},a,h){const f=[],m=e.getContext();for(const y of r){const x=y.id,w=ipt(a[x],h);w!==null&&f.push({plugin:y,options:opt(e.config,{plugin:y,local:s[x]},w,m)})}return f}function opt(e,{plugin:r,local:s},a,h){const f=e.pluginScopeKeys(r),m=e.getOptionScopes(a,f);return s&&r.defaults&&m.push(r.defaults),e.createResolver(m,h,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function XM(e,r){const s=fi.datasets[e]||{};return((r.datasets||{})[e]||{}).indexAxis||r.indexAxis||s.indexAxis||"x"}function apt(e,r){let s=e;return e==="_index_"?s=r:e==="_value_"&&(s=r==="x"?"y":"x"),s}function lpt(e,r){return e===r?"_index_":"_value_"}function MF(e){if(e==="x"||e==="y"||e==="r")return e}function cpt(e){if(e==="top"||e==="bottom")return"x";if(e==="left"||e==="right")return"y"}function YM(e,...r){if(MF(e))return e;for(const s of r){const a=s.axis||cpt(s.position)||e.length>1&&MF(e[0].toLowerCase());if(a)return a}throw new Error(`Cannot determine type of '${e}' axis. Please provide 'axis' or 'position' option.`)}function AF(e,r,s){if(s[r+"AxisID"]===e)return{axis:r}}function upt(e,r){if(r.data&&r.data.datasets){const s=r.data.datasets.filter(a=>a.xAxisID===e||a.yAxisID===e);if(s.length)return AF(e,"x",s[0])||AF(e,"y",s[0])}return{}}function hpt(e,r){const s=Ch[e.type]||{scales:{}},a=r.scales||{},h=XM(e.type,r),f=Object.create(null);return Object.keys(a).forEach(m=>{const y=a[m];if(!Zn(y))return console.error(`Invalid scale configuration for scale: ${m}`);if(y._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${m}`);const x=YM(m,y,upt(m,e),fi.scales[y.type]),w=lpt(x,h),T=s.scales||{};f[m]=Dm(Object.create(null),[{axis:x},y,T[x],T[w]])}),e.data.datasets.forEach(m=>{const y=m.type||e.type,x=m.indexAxis||XM(y,r),T=(Ch[y]||{}).scales||{};Object.keys(T).forEach(M=>{const I=apt(M,x),R=m[I+"AxisID"]||I;f[R]=f[R]||Object.create(null),Dm(f[R],[{axis:I},a[R],T[M]])})}),Object.keys(f).forEach(m=>{const y=f[m];Dm(y,[fi.scales[y.type],fi.scale])}),f}function P$(e){const r=e.options||(e.options={});r.plugins=On(r.plugins,{}),r.scales=hpt(e,r)}function I$(e){return e=e||{},e.datasets=e.datasets||[],e.labels=e.labels||[],e}function dpt(e){return e=e||{},e.data=I$(e.data),P$(e),e}const CF=new Map,k$=new Set;function L0(e,r){let s=CF.get(e);return s||(s=r(),CF.set(e,s),k$.add(s)),s}const nm=(e,r,s)=>{const a=du(r,s);a!==void 0&&e.add(a)};class fpt{constructor(r){this._config=dpt(r),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(r){this._config.type=r}get data(){return this._config.data}set data(r){this._config.data=I$(r)}get options(){return this._config.options}set options(r){this._config.options=r}get plugins(){return this._config.plugins}update(){const r=this._config;this.clearCache(),P$(r)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(r){return L0(r,()=>[[`datasets.${r}`,""]])}datasetAnimationScopeKeys(r,s){return L0(`${r}.transition.${s}`,()=>[[`datasets.${r}.transitions.${s}`,`transitions.${s}`],[`datasets.${r}`,""]])}datasetElementScopeKeys(r,s){return L0(`${r}-${s}`,()=>[[`datasets.${r}.elements.${s}`,`datasets.${r}`,`elements.${s}`,""]])}pluginScopeKeys(r){const s=r.id,a=this.type;return L0(`${a}-plugin-${s}`,()=>[[`plugins.${s}`,...r.additionalOptionScopes||[]]])}_cachedScopes(r,s){const a=this._scopeCache;let h=a.get(r);return(!h||s)&&(h=new Map,a.set(r,h)),h}getOptionScopes(r,s,a){const{options:h,type:f}=this,m=this._cachedScopes(r,a),y=m.get(s);if(y)return y;const x=new Set;s.forEach(T=>{r&&(x.add(r),T.forEach(M=>nm(x,r,M))),T.forEach(M=>nm(x,h,M)),T.forEach(M=>nm(x,Ch[f]||{},M)),T.forEach(M=>nm(x,fi,M)),T.forEach(M=>nm(x,HM,M))});const w=Array.from(x);return w.length===0&&w.push(Object.create(null)),k$.has(s)&&m.set(s,w),w}chartOptionScopes(){const{options:r,type:s}=this;return[r,Ch[s]||{},fi.datasets[s]||{},{type:s},fi,HM]}resolveNamedOptions(r,s,a,h=[""]){const f={$shared:!0},{resolver:m,subPrefixes:y}=PF(this._resolverCache,r,h);let x=m;if(mpt(m,s)){f.$shared=!1,a=fu(a)?a():a;const w=this.createResolver(r,a,y);x=bf(m,a,w)}for(const w of s)f[w]=x[w];return f}createResolver(r,s,a=[""],h){const{resolver:f}=PF(this._resolverCache,r,a);return Zn(s)?bf(f,s,void 0,h):f}}function PF(e,r,s){let a=e.get(r);a||(a=new Map,e.set(r,a));const h=s.join();let f=a.get(h);return f||(f={resolver:wP(r,s),subPrefixes:s.filter(y=>!y.toLowerCase().includes("hover"))},a.set(h,f)),f}const ppt=e=>Zn(e)&&Object.getOwnPropertyNames(e).some(r=>fu(e[r]));function mpt(e,r){const{isScriptable:s,isIndexable:a}=u$(e);for(const h of r){const f=s(h),m=a(h),y=(m||f)&&e[h];if(f&&(fu(y)||ppt(y))||m&&jr(y))return!0}return!1}var gpt="4.4.1";const _pt=["top","bottom","left","right","chartArea"];function IF(e,r){return e==="top"||e==="bottom"||_pt.indexOf(e)===-1&&r==="x"}function kF(e,r){return function(s,a){return s[e]===a[e]?s[r]-a[r]:s[e]-a[e]}}function DF(e){const r=e.chart,s=r.options.animation;r.notifyPlugins("afterRender"),Lr(s&&s.onComplete,[e],r)}function ypt(e){const r=e.chart,s=r.options.animation;Lr(s&&s.onProgress,[e],r)}function D$(e){return EP()&&typeof e=="string"?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}const mv={},RF=e=>{const r=D$(e);return Object.values(mv).filter(s=>s.canvas===r).pop()};function vpt(e,r,s){const a=Object.keys(e);for(const h of a){const f=+h;if(f>=r){const m=e[h];delete e[h],(s>0||f>r)&&(e[f+s]=m)}}}function xpt(e,r,s,a){return!s||e.type==="mouseout"?null:a?r:e}function z0(e,r,s){return e.options.clip?e[s]:r[s]}function bpt(e,r){const{xScale:s,yScale:a}=e;return s&&a?{left:z0(s,r,"left"),right:z0(s,r,"right"),top:z0(a,r,"top"),bottom:z0(a,r,"bottom")}:r}class la{static register(...r){ja.add(...r),OF()}static unregister(...r){ja.remove(...r),OF()}constructor(r,s){const a=this.config=new fpt(s),h=D$(r),f=RF(h);if(f)throw new Error("Canvas is already in use. Chart with ID '"+f.id+"' must be destroyed before the canvas with ID '"+f.canvas.id+"' can be reused.");const m=a.createResolver(a.chartOptionScopes(),this.getContext());this.platform=new(a.platform||Fft(h)),this.platform.updateConfig(a);const y=this.platform.acquireContext(h,m.aspectRatio),x=y&&y.canvas,w=x&&x.height,T=x&&x.width;if(this.id=Sht(),this.ctx=y,this.canvas=x,this.width=T,this.height=w,this._options=m,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new npt,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=Bht(M=>this.update(M),m.resizeDelay||0),this._dataChanges=[],mv[this.id]=this,!y||!x){console.error("Failed to create chart: can't acquire context from the given item");return}xl.listen(this,"complete",DF),xl.listen(this,"progress",ypt),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:r,maintainAspectRatio:s},width:a,height:h,_aspectRatio:f}=this;return sr(r)?s&&f?f:h?a/h:null:r}get data(){return this.config.data}set data(r){this.config.data=r}get options(){return this._options}set options(r){this.config.options=r}get registry(){return ja}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():eF(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return JN(this.canvas,this.ctx),this}stop(){return xl.stop(this),this}resize(r,s){xl.running(this)?this._resizeBeforeDraw={width:r,height:s}:this._resize(r,s)}_resize(r,s){const a=this.options,h=this.canvas,f=a.maintainAspectRatio&&this.aspectRatio,m=this.platform.getMaximumSize(h,r,s,f),y=a.devicePixelRatio||this.platform.getDevicePixelRatio(),x=this.width?"resize":"attach";this.width=m.width,this.height=m.height,this._aspectRatio=this.aspectRatio,eF(this,y,!0)&&(this.notifyPlugins("resize",{size:m}),Lr(a.onResize,[this,m],this),this.attached&&this._doResize(x)&&this.render())}ensureScalesHaveIDs(){const s=this.options.scales||{};xr(s,(a,h)=>{a.id=h})}buildOrUpdateScales(){const r=this.options,s=r.scales,a=this.scales,h=Object.keys(a).reduce((m,y)=>(m[y]=!1,m),{});let f=[];s&&(f=f.concat(Object.keys(s).map(m=>{const y=s[m],x=YM(m,y),w=x==="r",T=x==="x";return{options:y,dposition:w?"chartArea":T?"bottom":"left",dtype:w?"radialLinear":T?"category":"linear"}}))),xr(f,m=>{const y=m.options,x=y.id,w=YM(x,y),T=On(y.type,m.dtype);(y.position===void 0||IF(y.position,w)!==IF(m.dposition))&&(y.position=m.dposition),h[x]=!0;let M=null;if(x in a&&a[x].type===T)M=a[x];else{const I=ja.getScale(T);M=new I({id:x,type:T,ctx:this.ctx,chart:this}),a[M.id]=M}M.init(y,r)}),xr(h,(m,y)=>{m||delete a[y]}),xr(a,m=>{ds.configure(this,m,m.options),ds.addBox(this,m)})}_updateMetasets(){const r=this._metasets,s=this.data.datasets.length,a=r.length;if(r.sort((h,f)=>h.index-f.index),a>s){for(let h=s;h<a;++h)this._destroyDatasetMeta(h);r.splice(s,a-s)}this._sortedMetasets=r.slice(0).sort(kF("order","index"))}_removeUnreferencedMetasets(){const{_metasets:r,data:{datasets:s}}=this;r.length>s.length&&delete this._stacks,r.forEach((a,h)=>{s.filter(f=>f===a._dataset).length===0&&this._destroyDatasetMeta(h)})}buildOrUpdateControllers(){const r=[],s=this.data.datasets;let a,h;for(this._removeUnreferencedMetasets(),a=0,h=s.length;a<h;a++){const f=s[a];let m=this.getDatasetMeta(a);const y=f.type||this.config.type;if(m.type&&m.type!==y&&(this._destroyDatasetMeta(a),m=this.getDatasetMeta(a)),m.type=y,m.indexAxis=f.indexAxis||XM(y,this.options),m.order=f.order||0,m.index=a,m.label=""+f.label,m.visible=this.isDatasetVisible(a),m.controller)m.controller.updateIndex(a),m.controller.linkScales();else{const x=ja.getController(y),{datasetElementType:w,dataElementType:T}=fi.datasets[y];Object.assign(x,{dataElementType:ja.getElement(T),datasetElementType:w&&ja.getElement(w)}),m.controller=new x(this,a),r.push(m.controller)}}return this._updateMetasets(),r}_resetElements(){xr(this.data.datasets,(r,s)=>{this.getDatasetMeta(s).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(r){const s=this.config;s.update();const a=this._options=s.createResolver(s.chartOptionScopes(),this.getContext()),h=this._animationsDisabled=!a.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:r,cancelable:!0})===!1)return;const f=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let m=0;for(let w=0,T=this.data.datasets.length;w<T;w++){const{controller:M}=this.getDatasetMeta(w),I=!h&&f.indexOf(M)===-1;M.buildOrUpdateElements(I),m=Math.max(+M.getMaxOverflow(),m)}m=this._minPadding=a.layout.autoPadding?m:0,this._updateLayout(m),h||xr(f,w=>{w.reset()}),this._updateDatasets(r),this.notifyPlugins("afterUpdate",{mode:r}),this._layers.sort(kF("z","_idx"));const{_active:y,_lastEvent:x}=this;x?this._eventHandler(x,!0):y.length&&this._updateHoverStyles(y,y,!0),this.render()}_updateScales(){xr(this.scales,r=>{ds.removeBox(this,r)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const r=this.options,s=new Set(Object.keys(this._listeners)),a=new Set(r.events);(!$N(s,a)||!!this._responsiveListeners!==r.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:r}=this,s=this._getUniformDataChanges()||[];for(const{method:a,start:h,count:f}of s){const m=a==="_removeElements"?-f:f;vpt(r,h,m)}}_getUniformDataChanges(){const r=this._dataChanges;if(!r||!r.length)return;this._dataChanges=[];const s=this.data.datasets.length,a=f=>new Set(r.filter(m=>m[0]===f).map((m,y)=>y+","+m.splice(1).join(","))),h=a(0);for(let f=1;f<s;f++)if(!$N(h,a(f)))return;return Array.from(h).map(f=>f.split(",")).map(f=>({method:f[1],start:+f[2],count:+f[3]}))}_updateLayout(r){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;ds.update(this,this.width,this.height,r);const s=this.chartArea,a=s.width<=0||s.height<=0;this._layers=[],xr(this.boxes,h=>{a&&h.position==="chartArea"||(h.configure&&h.configure(),this._layers.push(...h._layers()))},this),this._layers.forEach((h,f)=>{h._idx=f}),this.notifyPlugins("afterLayout")}_updateDatasets(r){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:r,cancelable:!0})!==!1){for(let s=0,a=this.data.datasets.length;s<a;++s)this.getDatasetMeta(s).controller.configure();for(let s=0,a=this.data.datasets.length;s<a;++s)this._updateDataset(s,fu(r)?r({datasetIndex:s}):r);this.notifyPlugins("afterDatasetsUpdate",{mode:r})}}_updateDataset(r,s){const a=this.getDatasetMeta(r),h={meta:a,index:r,mode:s,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",h)!==!1&&(a.controller._update(s),h.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",h))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(xl.has(this)?this.attached&&!xl.running(this)&&xl.start(this):(this.draw(),DF({chart:this})))}draw(){let r;if(this._resizeBeforeDraw){const{width:a,height:h}=this._resizeBeforeDraw;this._resize(a,h),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const s=this._layers;for(r=0;r<s.length&&s[r].z<=0;++r)s[r].draw(this.chartArea);for(this._drawDatasets();r<s.length;++r)s[r].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(r){const s=this._sortedMetasets,a=[];let h,f;for(h=0,f=s.length;h<f;++h){const m=s[h];(!r||m.visible)&&a.push(m)}return a}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const r=this.getSortedVisibleDatasetMetas();for(let s=r.length-1;s>=0;--s)this._drawDataset(r[s]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(r){const s=this.ctx,a=r._clip,h=!a.disabled,f=bpt(r,this.chartArea),m={meta:r,index:r.index,cancelable:!0};this.notifyPlugins("beforeDatasetDraw",m)!==!1&&(h&&y1(s,{left:a.left===!1?0:f.left-a.left,right:a.right===!1?this.width:f.right+a.right,top:a.top===!1?0:f.top-a.top,bottom:a.bottom===!1?this.height:f.bottom+a.bottom}),r.controller.draw(),h&&v1(s),m.cancelable=!1,this.notifyPlugins("afterDatasetDraw",m))}isPointInArea(r){return Il(r,this.chartArea,this._minPadding)}getElementsAtEventForMode(r,s,a,h){const f=_ft.modes[s];return typeof f=="function"?f(this,r,a,h):[]}getDatasetMeta(r){const s=this.data.datasets[r],a=this._metasets;let h=a.filter(f=>f&&f._dataset===s).pop();return h||(h={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:s&&s.order||0,index:r,_dataset:s,_parsed:[],_sorted:!1},a.push(h)),h}getContext(){return this.$context||(this.$context=xu(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(r){const s=this.data.datasets[r];if(!s)return!1;const a=this.getDatasetMeta(r);return typeof a.hidden=="boolean"?!a.hidden:!s.hidden}setDatasetVisibility(r,s){const a=this.getDatasetMeta(r);a.hidden=!s}toggleDataVisibility(r){this._hiddenIndices[r]=!this._hiddenIndices[r]}getDataVisibility(r){return!this._hiddenIndices[r]}_updateVisibility(r,s,a){const h=a?"show":"hide",f=this.getDatasetMeta(r),m=f.controller._resolveAnimations(void 0,h);mg(s)?(f.data[s].hidden=!a,this.update()):(this.setDatasetVisibility(r,a),m.update(f,{visible:a}),this.update(y=>y.datasetIndex===r?h:void 0))}hide(r,s){this._updateVisibility(r,s,!1)}show(r,s){this._updateVisibility(r,s,!0)}_destroyDatasetMeta(r){const s=this._metasets[r];s&&s.controller&&s.controller._destroy(),delete this._metasets[r]}_stop(){let r,s;for(this.stop(),xl.remove(this),r=0,s=this.data.datasets.length;r<s;++r)this._destroyDatasetMeta(r)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:r,ctx:s}=this;this._stop(),this.config.clearCache(),r&&(this.unbindEvents(),JN(r,s),this.platform.releaseContext(s),this.canvas=null,this.ctx=null),delete mv[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...r){return this.canvas.toDataURL(...r)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const r=this._listeners,s=this.platform,a=(f,m)=>{s.addEventListener(this,f,m),r[f]=m},h=(f,m,y)=>{f.offsetX=m,f.offsetY=y,this._eventHandler(f)};xr(this.options.events,f=>a(f,h))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const r=this._responsiveListeners,s=this.platform,a=(x,w)=>{s.addEventListener(this,x,w),r[x]=w},h=(x,w)=>{r[x]&&(s.removeEventListener(this,x,w),delete r[x])},f=(x,w)=>{this.canvas&&this.resize(x,w)};let m;const y=()=>{h("attach",y),this.attached=!0,this.resize(),a("resize",f),a("detach",m)};m=()=>{this.attached=!1,h("resize",f),this._stop(),this._resize(0,0),a("attach",y)},s.isAttached(this.canvas)?y():m()}unbindEvents(){xr(this._listeners,(r,s)=>{this.platform.removeEventListener(this,s,r)}),this._listeners={},xr(this._responsiveListeners,(r,s)=>{this.platform.removeEventListener(this,s,r)}),this._responsiveListeners=void 0}updateHoverStyle(r,s,a){const h=a?"set":"remove";let f,m,y,x;for(s==="dataset"&&(f=this.getDatasetMeta(r[0].datasetIndex),f.controller["_"+h+"DatasetHoverStyle"]()),y=0,x=r.length;y<x;++y){m=r[y];const w=m&&this.getDatasetMeta(m.datasetIndex).controller;w&&w[h+"HoverStyle"](m.element,m.datasetIndex,m.index)}}getActiveElements(){return this._active||[]}setActiveElements(r){const s=this._active||[],a=r.map(({datasetIndex:f,index:m})=>{const y=this.getDatasetMeta(f);if(!y)throw new Error("No dataset found at index "+f);return{datasetIndex:f,element:y.data[m],index:m}});!gx(a,s)&&(this._active=a,this._lastEvent=null,this._updateHoverStyles(a,s))}notifyPlugins(r,s,a){return this._plugins.notify(this,r,s,a)}isPluginEnabled(r){return this._plugins._cache.filter(s=>s.plugin.id===r).length===1}_updateHoverStyles(r,s,a){const h=this.options.hover,f=(x,w)=>x.filter(T=>!w.some(M=>T.datasetIndex===M.datasetIndex&&T.index===M.index)),m=f(s,r),y=a?r:f(r,s);m.length&&this.updateHoverStyle(m,h.mode,!1),y.length&&h.mode&&this.updateHoverStyle(y,h.mode,!0)}_eventHandler(r,s){const a={event:r,replay:s,cancelable:!0,inChartArea:this.isPointInArea(r)},h=m=>(m.options.events||this.options.events).includes(r.native.type);if(this.notifyPlugins("beforeEvent",a,h)===!1)return;const f=this._handleEvent(r,s,a.inChartArea);return a.cancelable=!1,this.notifyPlugins("afterEvent",a,h),(f||a.changed)&&this.render(),this}_handleEvent(r,s,a){const{_active:h=[],options:f}=this,m=s,y=this._getActiveElements(r,h,a,m),x=Pht(r),w=xpt(r,this._lastEvent,a,x);a&&(this._lastEvent=null,Lr(f.onHover,[r,y,this],this),x&&Lr(f.onClick,[r,y,this],this));const T=!gx(y,h);return(T||s)&&(this._active=y,this._updateHoverStyles(y,h,s)),this._lastEvent=w,T}_getActiveElements(r,s,a,h){if(r.type==="mouseout")return[];if(!a)return s;const f=this.options.hover;return this.getElementsAtEventForMode(r,f.mode,f,h)}}Ie(la,"defaults",fi),Ie(la,"instances",mv),Ie(la,"overrides",Ch),Ie(la,"registry",ja),Ie(la,"version",gpt),Ie(la,"getChart",RF);function OF(){return xr(la.instances,e=>e._plugins.invalidate())}function wpt(e,r,s){const{startAngle:a,pixelMargin:h,x:f,y:m,outerRadius:y,innerRadius:x}=r;let w=h/y;e.beginPath(),e.arc(f,m,y,a-w,s+w),x>h?(w=h/x,e.arc(f,m,x,s+w,a-w,!0)):e.arc(f,m,h,s+Ti,a-Ti),e.closePath(),e.clip()}function Spt(e){return bP(e,["outerStart","outerEnd","innerStart","innerEnd"])}function Tpt(e,r,s,a){const h=Spt(e.options.borderRadius),f=(s-r)/2,m=Math.min(f,a*r/2),y=x=>{const w=(s-Math.min(f,x))*a/2;return Wi(x,0,Math.min(f,w))};return{outerStart:y(h.outerStart),outerEnd:y(h.outerEnd),innerStart:Wi(h.innerStart,0,m),innerEnd:Wi(h.innerEnd,0,m)}}function zd(e,r,s,a){return{x:s+e*Math.cos(r),y:a+e*Math.sin(r)}}function wx(e,r,s,a,h,f){const{x:m,y,startAngle:x,pixelMargin:w,innerRadius:T}=r,M=Math.max(r.outerRadius+a+s-w,0),I=T>0?T+a+s+w:0;let R=0;const O=h-x;if(a){const St=T>0?T-a:0,Rt=M>0?M-a:0,Zt=(St+Rt)/2,Ft=Zt!==0?O*Zt/(Zt+a):O;R=(O-Ft)/2}const N=Math.max(.001,O*M-s/$r)/M,G=(O-N)/2,$=x+G+R,z=h-G-R,{outerStart:B,outerEnd:H,innerStart:K,innerEnd:at}=Tpt(r,I,M,z-$),ft=M-B,et=M-H,nt=$+B/ft,W=z-H/et,Q=I+K,yt=I+at,Pt=$+K/Q,st=z-at/yt;if(e.beginPath(),f){const St=(nt+W)/2;if(e.arc(m,y,M,nt,St),e.arc(m,y,M,St,W),H>0){const $t=zd(et,W,m,y);e.arc($t.x,$t.y,H,W,z+Ti)}const Rt=zd(yt,z,m,y);if(e.lineTo(Rt.x,Rt.y),at>0){const $t=zd(yt,st,m,y);e.arc($t.x,$t.y,at,z+Ti,st+Math.PI)}const Zt=(z-at/I+($+K/I))/2;if(e.arc(m,y,I,z-at/I,Zt,!0),e.arc(m,y,I,Zt,$+K/I,!0),K>0){const $t=zd(Q,Pt,m,y);e.arc($t.x,$t.y,K,Pt+Math.PI,$-Ti)}const Ft=zd(ft,$,m,y);if(e.lineTo(Ft.x,Ft.y),B>0){const $t=zd(ft,nt,m,y);e.arc($t.x,$t.y,B,$-Ti,nt)}}else{e.moveTo(m,y);const St=Math.cos(nt)*M+m,Rt=Math.sin(nt)*M+y;e.lineTo(St,Rt);const Zt=Math.cos(W)*M+m,Ft=Math.sin(W)*M+y;e.lineTo(Zt,Ft)}e.closePath()}function Ept(e,r,s,a,h){const{fullCircles:f,startAngle:m,circumference:y}=r;let x=r.endAngle;if(f){wx(e,r,s,a,x,h);for(let w=0;w<f;++w)e.fill();isNaN(y)||(x=m+(y%Ur||Ur))}return wx(e,r,s,a,x,h),e.fill(),x}function Mpt(e,r,s,a,h){const{fullCircles:f,startAngle:m,circumference:y,options:x}=r,{borderWidth:w,borderJoinStyle:T,borderDash:M,borderDashOffset:I}=x,R=x.borderAlign==="inner";if(!w)return;e.setLineDash(M||[]),e.lineDashOffset=I,R?(e.lineWidth=w*2,e.lineJoin=T||"round"):(e.lineWidth=w,e.lineJoin=T||"bevel");let O=r.endAngle;if(f){wx(e,r,s,a,O,h);for(let N=0;N<f;++N)e.stroke();isNaN(y)||(O=m+(y%Ur||Ur))}R&&wpt(e,r,O),f||(wx(e,r,s,a,O,h),e.stroke())}class pm extends Wl{constructor(s){super();Ie(this,"circumference");Ie(this,"endAngle");Ie(this,"fullCircles");Ie(this,"innerRadius");Ie(this,"outerRadius");Ie(this,"pixelMargin");Ie(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,s&&Object.assign(this,s)}inRange(s,a,h){const f=this.getProps(["x","y"],h),{angle:m,distance:y}=t$(f,{x:s,y:a}),{startAngle:x,endAngle:w,innerRadius:T,outerRadius:M,circumference:I}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],h),R=(this.options.spacing+this.options.borderWidth)/2,N=On(I,w-x)>=Ur||gg(m,x,w),G=Cl(y,T+R,M+R);return N&&G}getCenterPoint(s){const{x:a,y:h,startAngle:f,endAngle:m,innerRadius:y,outerRadius:x}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],s),{offset:w,spacing:T}=this.options,M=(f+m)/2,I=(y+x+T+w)/2;return{x:a+Math.cos(M)*I,y:h+Math.sin(M)*I}}tooltipPosition(s){return this.getCenterPoint(s)}draw(s){const{options:a,circumference:h}=this,f=(a.offset||0)/4,m=(a.spacing||0)/2,y=a.circular;if(this.pixelMargin=a.borderAlign==="inner"?.33:0,this.fullCircles=h>Ur?Math.floor(h/Ur):0,h===0||this.innerRadius<0||this.outerRadius<0)return;s.save();const x=(this.startAngle+this.endAngle)/2;s.translate(Math.cos(x)*f,Math.sin(x)*f);const w=1-Math.sin(Math.min($r,h||0)),T=f*w;s.fillStyle=a.backgroundColor,s.strokeStyle=a.borderColor,Ept(s,this,T,m,y),Mpt(s,this,T,m,y),s.restore()}}Ie(pm,"id","arc"),Ie(pm,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0}),Ie(pm,"defaultRoutes",{backgroundColor:"backgroundColor"}),Ie(pm,"descriptors",{_scriptable:!0,_indexable:s=>s!=="borderDash"});function R$(e,r,s=r){e.lineCap=On(s.borderCapStyle,r.borderCapStyle),e.setLineDash(On(s.borderDash,r.borderDash)),e.lineDashOffset=On(s.borderDashOffset,r.borderDashOffset),e.lineJoin=On(s.borderJoinStyle,r.borderJoinStyle),e.lineWidth=On(s.borderWidth,r.borderWidth),e.strokeStyle=On(s.borderColor,r.borderColor)}function Apt(e,r,s){e.lineTo(s.x,s.y)}function Cpt(e){return e.stepped?Kht:e.tension||e.cubicInterpolationMode==="monotone"?Jht:Apt}function O$(e,r,s={}){const a=e.length,{start:h=0,end:f=a-1}=s,{start:m,end:y}=r,x=Math.max(h,m),w=Math.min(f,y),T=h<m&&f<m||h>y&&f>y;return{count:a,start:x,loop:r.loop,ilen:w<x&&!T?a+w-x:w-x}}function Ppt(e,r,s,a){const{points:h,options:f}=r,{count:m,start:y,loop:x,ilen:w}=O$(h,s,a),T=Cpt(f);let{move:M=!0,reverse:I}=a||{},R,O,N;for(R=0;R<=w;++R)O=h[(y+(I?w-R:R))%m],!O.skip&&(M?(e.moveTo(O.x,O.y),M=!1):T(e,N,O,I,f.stepped),N=O);return x&&(O=h[(y+(I?w:0))%m],T(e,N,O,I,f.stepped)),!!x}function Ipt(e,r,s,a){const h=r.points,{count:f,start:m,ilen:y}=O$(h,s,a),{move:x=!0,reverse:w}=a||{};let T=0,M=0,I,R,O,N,G,$;const z=H=>(m+(w?y-H:H))%f,B=()=>{N!==G&&(e.lineTo(T,G),e.lineTo(T,N),e.lineTo(T,$))};for(x&&(R=h[z(0)],e.moveTo(R.x,R.y)),I=0;I<=y;++I){if(R=h[z(I)],R.skip)continue;const H=R.x,K=R.y,at=H|0;at===O?(K<N?N=K:K>G&&(G=K),T=(M*T+H)/++M):(B(),e.lineTo(H,K),O=at,M=0,N=G=K),$=K}B()}function KM(e){const r=e.options,s=r.borderDash&&r.borderDash.length;return!e._decimated&&!e._loop&&!r.tension&&r.cubicInterpolationMode!=="monotone"&&!r.stepped&&!s?Ipt:Ppt}function kpt(e){return e.stepped?Idt:e.tension||e.cubicInterpolationMode==="monotone"?kdt:oh}function Dpt(e,r,s,a){let h=r._path;h||(h=r._path=new Path2D,r.path(h,s,a)&&h.closePath()),R$(e,r.options),e.stroke(h)}function Rpt(e,r,s,a){const{segments:h,options:f}=r,m=KM(r);for(const y of h)R$(e,f,y.style),e.beginPath(),m(e,r,y,{start:s,end:s+a-1})&&e.closePath(),e.stroke()}const Opt=typeof Path2D=="function";function Lpt(e,r,s,a){Opt&&!r.options.segment?Dpt(e,r,s,a):Rpt(e,r,s,a)}class Gc extends Wl{constructor(r){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,r&&Object.assign(this,r)}updateControlPoints(r,s){const a=this.options;if((a.tension||a.cubicInterpolationMode==="monotone")&&!a.stepped&&!this._pointsUpdated){const h=a.spanGaps?this._loop:this._fullLoop;wdt(this._points,a,r,h,s),this._pointsUpdated=!0}}set points(r){this._points=r,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=Ndt(this,this.options.segment))}first(){const r=this.segments,s=this.points;return r.length&&s[r[0].start]}last(){const r=this.segments,s=this.points,a=r.length;return a&&s[r[a-1].end]}interpolate(r,s){const a=this.options,h=r[s],f=this.points,m=x$(this,{property:s,start:h,end:h});if(!m.length)return;const y=[],x=kpt(a);let w,T;for(w=0,T=m.length;w<T;++w){const{start:M,end:I}=m[w],R=f[M],O=f[I];if(R===O){y.push(R);continue}const N=Math.abs((h-R[s])/(O[s]-R[s])),G=x(R,O,N,a.stepped);G[s]=r[s],y.push(G)}return y.length===1?y[0]:y}pathSegment(r,s,a){return KM(this)(r,this,s,a)}path(r,s,a){const h=this.segments,f=KM(this);let m=this._loop;s=s||0,a=a||this.points.length-s;for(const y of h)m&=f(r,this,y,{start:s,end:s+a-1});return!!m}draw(r,s,a,h){const f=this.options||{};(this.points||[]).length&&f.borderWidth&&(r.save(),Lpt(r,this,a,h),r.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}Ie(Gc,"id","line"),Ie(Gc,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),Ie(Gc,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),Ie(Gc,"descriptors",{_scriptable:!0,_indexable:r=>r!=="borderDash"&&r!=="fill"});function LF(e,r,s,a){const h=e.options,{[s]:f}=e.getProps([s],a);return Math.abs(r-f)<h.radius+h.hitRadius}class gv extends Wl{constructor(s){super();Ie(this,"parsed");Ie(this,"skip");Ie(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,s&&Object.assign(this,s)}inRange(s,a,h){const f=this.options,{x:m,y}=this.getProps(["x","y"],h);return Math.pow(s-m,2)+Math.pow(a-y,2)<Math.pow(f.hitRadius+f.radius,2)}inXRange(s,a){return LF(this,s,"x",a)}inYRange(s,a){return LF(this,s,"y",a)}getCenterPoint(s){const{x:a,y:h}=this.getProps(["x","y"],s);return{x:a,y:h}}size(s){s=s||this.options||{};let a=s.radius||0;a=Math.max(a,a&&s.hoverRadius||0);const h=a&&s.borderWidth||0;return(a+h)*2}draw(s,a){const h=this.options;this.skip||h.radius<.1||!Il(this,a,this.size(h)/2)||(s.strokeStyle=h.borderColor,s.lineWidth=h.borderWidth,s.fillStyle=h.backgroundColor,qM(s,h,this.x,this.y))}getRange(){const s=this.options||{};return s.radius+s.hitRadius}}Ie(gv,"id","point"),Ie(gv,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),Ie(gv,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function L$(e,r){const{x:s,y:a,base:h,width:f,height:m}=e.getProps(["x","y","base","width","height"],r);let y,x,w,T,M;return e.horizontal?(M=m/2,y=Math.min(s,h),x=Math.max(s,h),w=a-M,T=a+M):(M=f/2,y=s-M,x=s+M,w=Math.min(a,h),T=Math.max(a,h)),{left:y,top:w,right:x,bottom:T}}function Wc(e,r,s,a){return e?0:Wi(r,s,a)}function zpt(e,r,s){const a=e.options.borderWidth,h=e.borderSkipped,f=c$(a);return{t:Wc(h.top,f.top,0,s),r:Wc(h.right,f.right,0,r),b:Wc(h.bottom,f.bottom,0,s),l:Wc(h.left,f.left,0,r)}}function Npt(e,r,s){const{enableBorderRadius:a}=e.getProps(["enableBorderRadius"]),h=e.options.borderRadius,f=vh(h),m=Math.min(r,s),y=e.borderSkipped,x=a||Zn(h);return{topLeft:Wc(!x||y.top||y.left,f.topLeft,0,m),topRight:Wc(!x||y.top||y.right,f.topRight,0,m),bottomLeft:Wc(!x||y.bottom||y.left,f.bottomLeft,0,m),bottomRight:Wc(!x||y.bottom||y.right,f.bottomRight,0,m)}}function Fpt(e){const r=L$(e),s=r.right-r.left,a=r.bottom-r.top,h=zpt(e,s/2,a/2),f=Npt(e,s/2,a/2);return{outer:{x:r.left,y:r.top,w:s,h:a,radius:f},inner:{x:r.left+h.l,y:r.top+h.t,w:s-h.l-h.r,h:a-h.t-h.b,radius:{topLeft:Math.max(0,f.topLeft-Math.max(h.t,h.l)),topRight:Math.max(0,f.topRight-Math.max(h.t,h.r)),bottomLeft:Math.max(0,f.bottomLeft-Math.max(h.b,h.l)),bottomRight:Math.max(0,f.bottomRight-Math.max(h.b,h.r))}}}}function iE(e,r,s,a){const h=r===null,f=s===null,y=e&&!(h&&f)&&L$(e,a);return y&&(h||Cl(r,y.left,y.right))&&(f||Cl(s,y.top,y.bottom))}function Bpt(e){return e.topLeft||e.topRight||e.bottomLeft||e.bottomRight}function jpt(e,r){e.rect(r.x,r.y,r.w,r.h)}function sE(e,r,s={}){const a=e.x!==s.x?-r:0,h=e.y!==s.y?-r:0,f=(e.x+e.w!==s.x+s.w?r:0)-a,m=(e.y+e.h!==s.y+s.h?r:0)-h;return{x:e.x+a,y:e.y+h,w:e.w+f,h:e.h+m,radius:e.radius}}class _v extends Wl{constructor(r){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,r&&Object.assign(this,r)}draw(r){const{inflateAmount:s,options:{borderColor:a,backgroundColor:h}}=this,{inner:f,outer:m}=Fpt(this),y=Bpt(m.radius)?_g:jpt;r.save(),(m.w!==f.w||m.h!==f.h)&&(r.beginPath(),y(r,sE(m,s,f)),r.clip(),y(r,sE(f,-s,m)),r.fillStyle=a,r.fill("evenodd")),r.beginPath(),y(r,sE(f,s)),r.fillStyle=h,r.fill(),r.restore()}inRange(r,s,a){return iE(this,r,s,a)}inXRange(r,s){return iE(this,r,null,s)}inYRange(r,s){return iE(this,null,r,s)}getCenterPoint(r){const{x:s,y:a,base:h,horizontal:f}=this.getProps(["x","y","base","horizontal"],r);return{x:f?(s+h)/2:s,y:f?a:(a+h)/2}}getRange(r){return r==="x"?this.width/2:this.height/2}}Ie(_v,"id","bar"),Ie(_v,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),Ie(_v,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});var Vpt=Object.freeze({__proto__:null,ArcElement:pm,BarElement:_v,LineElement:Gc,PointElement:gv});const JM=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],zF=JM.map(e=>e.replace("rgb(","rgba(").replace(")",", 0.5)"));function z$(e){return JM[e%JM.length]}function N$(e){return zF[e%zF.length]}function Upt(e,r){return e.borderColor=z$(r),e.backgroundColor=N$(r),++r}function $pt(e,r){return e.backgroundColor=e.data.map(()=>z$(r++)),r}function Gpt(e,r){return e.backgroundColor=e.data.map(()=>N$(r++)),r}function Wpt(e){let r=0;return(s,a)=>{const h=e.getDatasetMeta(a).controller;h instanceof fh?r=$pt(s,r):h instanceof zm?r=Gpt(s,r):h&&(r=Upt(s,r))}}function NF(e){let r;for(r in e)if(e[r].borderColor||e[r].backgroundColor)return!0;return!1}function Hpt(e){return e&&(e.borderColor||e.backgroundColor)}var qpt={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(e,r,s){if(!s.enabled)return;const{data:{datasets:a},options:h}=e.config,{elements:f}=h;if(!s.forceOverride&&(NF(a)||Hpt(h)||f&&NF(f)))return;const m=Wpt(e);a.forEach(m)}};function Zpt(e,r,s,a,h){const f=h.samples||a;if(f>=s)return e.slice(r,r+s);const m=[],y=(s-2)/(f-2);let x=0;const w=r+s-1;let T=r,M,I,R,O,N;for(m[x++]=e[T],M=0;M<f-2;M++){let G=0,$=0,z;const B=Math.floor((M+1)*y)+1+r,H=Math.min(Math.floor((M+2)*y)+1,s)+r,K=H-B;for(z=B;z<H;z++)G+=e[z].x,$+=e[z].y;G/=K,$/=K;const at=Math.floor(M*y)+1+r,ft=Math.min(Math.floor((M+1)*y)+1,s)+r,{x:et,y:nt}=e[T];for(R=O=-1,z=at;z<ft;z++)O=.5*Math.abs((et-G)*(e[z].y-nt)-(et-e[z].x)*($-nt)),O>R&&(R=O,I=e[z],N=z);m[x++]=I,T=N}return m[x++]=e[w],m}function Xpt(e,r,s,a){let h=0,f=0,m,y,x,w,T,M,I,R,O,N;const G=[],$=r+s-1,z=e[r].x,H=e[$].x-z;for(m=r;m<r+s;++m){y=e[m],x=(y.x-z)/H*a,w=y.y;const K=x|0;if(K===T)w<O?(O=w,M=m):w>N&&(N=w,I=m),h=(f*h+y.x)/++f;else{const at=m-1;if(!sr(M)&&!sr(I)){const ft=Math.min(M,I),et=Math.max(M,I);ft!==R&&ft!==at&&G.push({...e[ft],x:h}),et!==R&&et!==at&&G.push({...e[et],x:h})}m>0&&at!==R&&G.push(e[at]),G.push(y),T=K,f=0,O=N=w,M=I=R=m}}return G}function F$(e){if(e._decimated){const r=e._data;delete e._decimated,delete e._data,Object.defineProperty(e,"data",{configurable:!0,enumerable:!0,writable:!0,value:r})}}function FF(e){e.data.datasets.forEach(r=>{F$(r)})}function Ypt(e,r){const s=r.length;let a=0,h;const{iScale:f}=e,{min:m,max:y,minDefined:x,maxDefined:w}=f.getUserBounds();return x&&(a=Wi(Pl(r,f.axis,m).lo,0,s-1)),w?h=Wi(Pl(r,f.axis,y).hi+1,a,s)-a:h=s-a,{start:a,count:h}}var Kpt={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(e,r,s)=>{if(!s.enabled){FF(e);return}const a=e.width;e.data.datasets.forEach((h,f)=>{const{_data:m,indexAxis:y}=h,x=e.getDatasetMeta(f),w=m||h.data;if(dm([y,e.options.indexAxis])==="y"||!x.controller.supportsDecimation)return;const T=e.scales[x.xAxisID];if(T.type!=="linear"&&T.type!=="time"||e.options.parsing)return;let{start:M,count:I}=Ypt(x,w);const R=s.threshold||4*a;if(I<=R){F$(h);return}sr(m)&&(h._data=w,delete h.data,Object.defineProperty(h,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(N){this._data=N}}));let O;switch(s.algorithm){case"lttb":O=Zpt(w,M,I,a,s);break;case"min-max":O=Xpt(w,M,I,a);break;default:throw new Error(`Unsupported decimation algorithm '${s.algorithm}'`)}h._decimated=O})},destroy(e){FF(e)}};function Jpt(e,r,s){const a=e.segments,h=e.points,f=r.points,m=[];for(const y of a){let{start:x,end:w}=y;w=CP(x,w,h);const T=QM(s,h[x],h[w],y.loop);if(!r.segments){m.push({source:y,target:T,start:h[x],end:h[w]});continue}const M=x$(r,T);for(const I of M){const R=QM(s,f[I.start],f[I.end],I.loop),O=v$(y,h,R);for(const N of O)m.push({source:N,target:I,start:{[s]:BF(T,R,"start",Math.max)},end:{[s]:BF(T,R,"end",Math.min)}})}}return m}function QM(e,r,s,a){if(a)return;let h=r[e],f=s[e];return e==="angle"&&(h=oo(h),f=oo(f)),{property:e,start:h,end:f}}function Qpt(e,r){const{x:s=null,y:a=null}=e||{},h=r.points,f=[];return r.segments.forEach(({start:m,end:y})=>{y=CP(m,y,h);const x=h[m],w=h[y];a!==null?(f.push({x:x.x,y:a}),f.push({x:w.x,y:a})):s!==null&&(f.push({x:s,y:x.y}),f.push({x:s,y:w.y}))}),f}function CP(e,r,s){for(;r>e;r--){const a=s[r];if(!isNaN(a.x)&&!isNaN(a.y))break}return r}function BF(e,r,s,a){return e&&r?a(e[s],r[s]):e?e[s]:r?r[s]:0}function B$(e,r){let s=[],a=!1;return jr(e)?(a=!0,s=e):s=Qpt(e,r),s.length?new Gc({points:s,options:{tension:0},_loop:a,_fullLoop:a}):null}function jF(e){return e&&e.fill!==!1}function tmt(e,r,s){let h=e[r].fill;const f=[r];let m;if(!s)return h;for(;h!==!1&&f.indexOf(h)===-1;){if(!di(h))return h;if(m=e[h],!m)return!1;if(m.visible)return h;f.push(h),h=m.fill}return!1}function emt(e,r,s){const a=smt(e);if(Zn(a))return isNaN(a.value)?!1:a;let h=parseFloat(a);return di(h)&&Math.floor(h)===h?nmt(a[0],r,h,s):["origin","start","end","stack","shape"].indexOf(a)>=0&&a}function nmt(e,r,s,a){return(e==="-"||e==="+")&&(s=r+s),s===r||s<0||s>=a?!1:s}function rmt(e,r){let s=null;return e==="start"?s=r.bottom:e==="end"?s=r.top:Zn(e)?s=r.getPixelForValue(e.value):r.getBasePixel&&(s=r.getBasePixel()),s}function imt(e,r,s){let a;return e==="start"?a=s:e==="end"?a=r.options.reverse?r.min:r.max:Zn(e)?a=e.value:a=r.getBaseValue(),a}function smt(e){const r=e.options,s=r.fill;let a=On(s&&s.target,s);return a===void 0&&(a=!!r.backgroundColor),a===!1||a===null?!1:a===!0?"origin":a}function omt(e){const{scale:r,index:s,line:a}=e,h=[],f=a.segments,m=a.points,y=amt(r,s);y.push(B$({x:null,y:r.bottom},a));for(let x=0;x<f.length;x++){const w=f[x];for(let T=w.start;T<=w.end;T++)lmt(h,m[T],y)}return new Gc({points:h,options:{}})}function amt(e,r){const s=[],a=e.getMatchingVisibleMetas("line");for(let h=0;h<a.length;h++){const f=a[h];if(f.index===r)break;f.hidden||s.unshift(f.dataset)}return s}function lmt(e,r,s){const a=[];for(let h=0;h<s.length;h++){const f=s[h],{first:m,last:y,point:x}=cmt(f,r,"x");if(!(!x||m&&y)){if(m)a.unshift(x);else if(e.push(x),!y)break}}e.push(...a)}function cmt(e,r,s){const a=e.interpolate(r,s);if(!a)return{};const h=a[s],f=e.segments,m=e.points;let y=!1,x=!1;for(let w=0;w<f.length;w++){const T=f[w],M=m[T.start][s],I=m[T.end][s];if(Cl(h,M,I)){y=h===M,x=h===I;break}}return{first:y,last:x,point:a}}class j${constructor(r){this.x=r.x,this.y=r.y,this.radius=r.radius}pathSegment(r,s,a){const{x:h,y:f,radius:m}=this;return s=s||{start:0,end:Ur},r.arc(h,f,m,s.end,s.start,!0),!a.bounds}interpolate(r){const{x:s,y:a,radius:h}=this,f=r.angle;return{x:s+Math.cos(f)*h,y:a+Math.sin(f)*h,angle:f}}}function umt(e){const{chart:r,fill:s,line:a}=e;if(di(s))return hmt(r,s);if(s==="stack")return omt(e);if(s==="shape")return!0;const h=dmt(e);return h instanceof j$?h:B$(h,a)}function hmt(e,r){const s=e.getDatasetMeta(r);return s&&e.isDatasetVisible(r)?s.dataset:null}function dmt(e){return(e.scale||{}).getPointPositionForValue?pmt(e):fmt(e)}function fmt(e){const{scale:r={},fill:s}=e,a=rmt(s,r);if(di(a)){const h=r.isHorizontal();return{x:h?a:null,y:h?null:a}}return null}function pmt(e){const{scale:r,fill:s}=e,a=r.options,h=r.getLabels().length,f=a.reverse?r.max:r.min,m=imt(s,r,f),y=[];if(a.grid.circular){const x=r.getPointPositionForValue(0,f);return new j$({x:x.x,y:x.y,radius:r.getDistanceFromCenterForValue(m)})}for(let x=0;x<h;++x)y.push(r.getPointPositionForValue(x,m));return y}function oE(e,r,s){const a=umt(r),{line:h,scale:f,axis:m}=r,y=h.options,x=y.fill,w=y.backgroundColor,{above:T=w,below:M=w}=x||{};a&&h.points.length&&(y1(e,s),mmt(e,{line:h,target:a,above:T,below:M,area:s,scale:f,axis:m}),v1(e))}function mmt(e,r){const{line:s,target:a,above:h,below:f,area:m,scale:y}=r,x=s._loop?"angle":r.axis;e.save(),x==="x"&&f!==h&&(VF(e,a,m.top),UF(e,{line:s,target:a,color:h,scale:y,property:x}),e.restore(),e.save(),VF(e,a,m.bottom)),UF(e,{line:s,target:a,color:f,scale:y,property:x}),e.restore()}function VF(e,r,s){const{segments:a,points:h}=r;let f=!0,m=!1;e.beginPath();for(const y of a){const{start:x,end:w}=y,T=h[x],M=h[CP(x,w,h)];f?(e.moveTo(T.x,T.y),f=!1):(e.lineTo(T.x,s),e.lineTo(T.x,T.y)),m=!!r.pathSegment(e,y,{move:m}),m?e.closePath():e.lineTo(M.x,s)}e.lineTo(r.first().x,s),e.closePath(),e.clip()}function UF(e,r){const{line:s,target:a,property:h,color:f,scale:m}=r,y=Jpt(s,a,h);for(const{source:x,target:w,start:T,end:M}of y){const{style:{backgroundColor:I=f}={}}=x,R=a!==!0;e.save(),e.fillStyle=I,gmt(e,m,R&&QM(h,T,M)),e.beginPath();const O=!!s.pathSegment(e,x);let N;if(R){O?e.closePath():$F(e,a,M,h);const G=!!a.pathSegment(e,w,{move:O,reverse:!0});N=O&&G,N||$F(e,a,T,h)}e.closePath(),e.fill(N?"evenodd":"nonzero"),e.restore()}}function gmt(e,r,s){const{top:a,bottom:h}=r.chart.chartArea,{property:f,start:m,end:y}=s||{};f==="x"&&(e.beginPath(),e.rect(m,a,y-m,h-a),e.clip())}function $F(e,r,s,a){const h=r.interpolate(s,a);h&&e.lineTo(h.x,h.y)}var _mt={id:"filler",afterDatasetsUpdate(e,r,s){const a=(e.data.datasets||[]).length,h=[];let f,m,y,x;for(m=0;m<a;++m)f=e.getDatasetMeta(m),y=f.dataset,x=null,y&&y.options&&y instanceof Gc&&(x={visible:e.isDatasetVisible(m),index:m,fill:emt(y,m,a),chart:e,axis:f.controller.options.indexAxis,scale:f.vScale,line:y}),f.$filler=x,h.push(x);for(m=0;m<a;++m)x=h[m],!(!x||x.fill===!1)&&(x.fill=tmt(h,m,s.propagate))},beforeDraw(e,r,s){const a=s.drawTime==="beforeDraw",h=e.getSortedVisibleDatasetMetas(),f=e.chartArea;for(let m=h.length-1;m>=0;--m){const y=h[m].$filler;y&&(y.line.updateControlPoints(f,y.axis),a&&y.fill&&oE(e.ctx,y,f))}},beforeDatasetsDraw(e,r,s){if(s.drawTime!=="beforeDatasetsDraw")return;const a=e.getSortedVisibleDatasetMetas();for(let h=a.length-1;h>=0;--h){const f=a[h].$filler;jF(f)&&oE(e.ctx,f,e.chartArea)}},beforeDatasetDraw(e,r,s){const a=r.meta.$filler;!jF(a)||s.drawTime!=="beforeDatasetDraw"||oE(e.ctx,a,e.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const GF=(e,r)=>{let{boxHeight:s=r,boxWidth:a=r}=e;return e.usePointStyle&&(s=Math.min(s,r),a=e.pointStyleWidth||Math.min(a,r)),{boxWidth:a,boxHeight:s,itemHeight:Math.max(r,s)}},ymt=(e,r)=>e!==null&&r!==null&&e.datasetIndex===r.datasetIndex&&e.index===r.index;class WF extends Wl{constructor(r){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=r.chart,this.options=r.options,this.ctx=r.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(r,s,a){this.maxWidth=r,this.maxHeight=s,this._margins=a,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const r=this.options.labels||{};let s=Lr(r.generateLabels,[this.chart],this)||[];r.filter&&(s=s.filter(a=>r.filter(a,this.chart.data))),r.sort&&(s=s.sort((a,h)=>r.sort(a,h,this.chart.data))),this.options.reverse&&s.reverse(),this.legendItems=s}fit(){const{options:r,ctx:s}=this;if(!r.display){this.width=this.height=0;return}const a=r.labels,h=Vi(a.font),f=h.size,m=this._computeTitleHeight(),{boxWidth:y,itemHeight:x}=GF(a,f);let w,T;s.font=h.string,this.isHorizontal()?(w=this.maxWidth,T=this._fitRows(m,f,y,x)+10):(T=this.maxHeight,w=this._fitCols(m,h,y,x)+10),this.width=Math.min(w,r.maxWidth||this.maxWidth),this.height=Math.min(T,r.maxHeight||this.maxHeight)}_fitRows(r,s,a,h){const{ctx:f,maxWidth:m,options:{labels:{padding:y}}}=this,x=this.legendHitBoxes=[],w=this.lineWidths=[0],T=h+y;let M=r;f.textAlign="left",f.textBaseline="middle";let I=-1,R=-T;return this.legendItems.forEach((O,N)=>{const G=a+s/2+f.measureText(O.text).width;(N===0||w[w.length-1]+G+2*y>m)&&(M+=T,w[w.length-(N>0?0:1)]=0,R+=T,I++),x[N]={left:0,top:R,row:I,width:G,height:h},w[w.length-1]+=G+y}),M}_fitCols(r,s,a,h){const{ctx:f,maxHeight:m,options:{labels:{padding:y}}}=this,x=this.legendHitBoxes=[],w=this.columnSizes=[],T=m-r;let M=y,I=0,R=0,O=0,N=0;return this.legendItems.forEach((G,$)=>{const{itemWidth:z,itemHeight:B}=vmt(a,s,f,G,h);$>0&&R+B+2*y>T&&(M+=I+y,w.push({width:I,height:R}),O+=I+y,N++,I=R=0),x[$]={left:O,top:R,col:N,width:z,height:B},I=Math.max(I,z),R+=B+y}),M+=I,w.push({width:I,height:R}),M}adjustHitBoxes(){if(!this.options.display)return;const r=this._computeTitleHeight(),{legendHitBoxes:s,options:{align:a,labels:{padding:h},rtl:f}}=this,m=af(f,this.left,this.width);if(this.isHorizontal()){let y=0,x=us(a,this.left+h,this.right-this.lineWidths[y]);for(const w of s)y!==w.row&&(y=w.row,x=us(a,this.left+h,this.right-this.lineWidths[y])),w.top+=this.top+r+h,w.left=m.leftForLtr(m.x(x),w.width),x+=w.width+h}else{let y=0,x=us(a,this.top+r+h,this.bottom-this.columnSizes[y].height);for(const w of s)w.col!==y&&(y=w.col,x=us(a,this.top+r+h,this.bottom-this.columnSizes[y].height)),w.top=x,w.left+=this.left+h,w.left=m.leftForLtr(m.x(w.left),w.width),x+=w.height+h}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const r=this.ctx;y1(r,this),this._draw(),v1(r)}}_draw(){const{options:r,columnSizes:s,lineWidths:a,ctx:h}=this,{align:f,labels:m}=r,y=fi.color,x=af(r.rtl,this.left,this.width),w=Vi(m.font),{padding:T}=m,M=w.size,I=M/2;let R;this.drawTitle(),h.textAlign=x.textAlign("left"),h.textBaseline="middle",h.lineWidth=.5,h.font=w.string;const{boxWidth:O,boxHeight:N,itemHeight:G}=GF(m,M),$=function(at,ft,et){if(isNaN(O)||O<=0||isNaN(N)||N<0)return;h.save();const nt=On(et.lineWidth,1);if(h.fillStyle=On(et.fillStyle,y),h.lineCap=On(et.lineCap,"butt"),h.lineDashOffset=On(et.lineDashOffset,0),h.lineJoin=On(et.lineJoin,"miter"),h.lineWidth=nt,h.strokeStyle=On(et.strokeStyle,y),h.setLineDash(On(et.lineDash,[])),m.usePointStyle){const W={radius:N*Math.SQRT2/2,pointStyle:et.pointStyle,rotation:et.rotation,borderWidth:nt},Q=x.xPlus(at,O/2),yt=ft+I;l$(h,W,Q,yt,m.pointStyleWidth&&O)}else{const W=ft+Math.max((M-N)/2,0),Q=x.leftForLtr(at,O),yt=vh(et.borderRadius);h.beginPath(),Object.values(yt).some(Pt=>Pt!==0)?_g(h,{x:Q,y:W,w:O,h:N,radius:yt}):h.rect(Q,W,O,N),h.fill(),nt!==0&&h.stroke()}h.restore()},z=function(at,ft,et){Ph(h,et.text,at,ft+G/2,w,{strikethrough:et.hidden,textAlign:x.textAlign(et.textAlign)})},B=this.isHorizontal(),H=this._computeTitleHeight();B?R={x:us(f,this.left+T,this.right-a[0]),y:this.top+T+H,line:0}:R={x:this.left+T,y:us(f,this.top+H+T,this.bottom-s[0].height),line:0},g$(this.ctx,r.textDirection);const K=G+T;this.legendItems.forEach((at,ft)=>{h.strokeStyle=at.fontColor,h.fillStyle=at.fontColor;const et=h.measureText(at.text).width,nt=x.textAlign(at.textAlign||(at.textAlign=m.textAlign)),W=O+I+et;let Q=R.x,yt=R.y;x.setWidth(this.width),B?ft>0&&Q+W+T>this.right&&(yt=R.y+=K,R.line++,Q=R.x=us(f,this.left+T,this.right-a[R.line])):ft>0&&yt+K>this.bottom&&(Q=R.x=Q+s[R.line].width+T,R.line++,yt=R.y=us(f,this.top+H+T,this.bottom-s[R.line].height));const Pt=x.x(Q);if($(Pt,yt,at),Q=jht(nt,Q+O+I,B?Q+W:this.right,r.rtl),z(x.x(Q),yt,at),B)R.x+=W+T;else if(typeof at.text!="string"){const st=w.lineHeight;R.y+=V$(at,st)+T}else R.y+=K}),_$(this.ctx,r.textDirection)}drawTitle(){const r=this.options,s=r.title,a=Vi(s.font),h=ps(s.padding);if(!s.display)return;const f=af(r.rtl,this.left,this.width),m=this.ctx,y=s.position,x=a.size/2,w=h.top+x;let T,M=this.left,I=this.width;if(this.isHorizontal())I=Math.max(...this.lineWidths),T=this.top+w,M=us(r.align,M,this.right-I);else{const O=this.columnSizes.reduce((N,G)=>Math.max(N,G.height),0);T=w+us(r.align,this.top,this.bottom-O-r.labels.padding-this._computeTitleHeight())}const R=us(y,M,M+I);m.textAlign=f.textAlign(vP(y)),m.textBaseline="middle",m.strokeStyle=s.color,m.fillStyle=s.color,m.font=a.string,Ph(m,s.text,R,T,a)}_computeTitleHeight(){const r=this.options.title,s=Vi(r.font),a=ps(r.padding);return r.display?s.lineHeight+a.height:0}_getLegendItemAt(r,s){let a,h,f;if(Cl(r,this.left,this.right)&&Cl(s,this.top,this.bottom)){for(f=this.legendHitBoxes,a=0;a<f.length;++a)if(h=f[a],Cl(r,h.left,h.left+h.width)&&Cl(s,h.top,h.top+h.height))return this.legendItems[a]}return null}handleEvent(r){const s=this.options;if(!wmt(r.type,s))return;const a=this._getLegendItemAt(r.x,r.y);if(r.type==="mousemove"||r.type==="mouseout"){const h=this._hoveredItem,f=ymt(h,a);h&&!f&&Lr(s.onLeave,[r,h,this],this),this._hoveredItem=a,a&&!f&&Lr(s.onHover,[r,a,this],this)}else a&&Lr(s.onClick,[r,a,this],this)}}function vmt(e,r,s,a,h){const f=xmt(a,e,r,s),m=bmt(h,a,r.lineHeight);return{itemWidth:f,itemHeight:m}}function xmt(e,r,s,a){let h=e.text;return h&&typeof h!="string"&&(h=h.reduce((f,m)=>f.length>m.length?f:m)),r+s.size/2+a.measureText(h).width}function bmt(e,r,s){let a=e;return typeof r.text!="string"&&(a=V$(r,s)),a}function V$(e,r){const s=e.text?e.text.length:0;return r*s}function wmt(e,r){return!!((e==="mousemove"||e==="mouseout")&&(r.onHover||r.onLeave)||r.onClick&&(e==="click"||e==="mouseup"))}var Smt={id:"legend",_element:WF,start(e,r,s){const a=e.legend=new WF({ctx:e.ctx,options:s,chart:e});ds.configure(e,a,s),ds.addBox(e,a)},stop(e){ds.removeBox(e,e.legend),delete e.legend},beforeUpdate(e,r,s){const a=e.legend;ds.configure(e,a,s),a.options=s},afterUpdate(e){const r=e.legend;r.buildLabels(),r.adjustHitBoxes()},afterEvent(e,r){r.replay||e.legend.handleEvent(r.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(e,r,s){const a=r.datasetIndex,h=s.chart;h.isDatasetVisible(a)?(h.hide(a),r.hidden=!0):(h.show(a),r.hidden=!1)},onHover:null,onLeave:null,labels:{color:e=>e.chart.options.color,boxWidth:40,padding:10,generateLabels(e){const r=e.data.datasets,{labels:{usePointStyle:s,pointStyle:a,textAlign:h,color:f,useBorderRadius:m,borderRadius:y}}=e.legend.options;return e._getSortedDatasetMetas().map(x=>{const w=x.controller.getStyle(s?0:void 0),T=ps(w.borderWidth);return{text:r[x.index].label,fillStyle:w.backgroundColor,fontColor:f,hidden:!x.visible,lineCap:w.borderCapStyle,lineDash:w.borderDash,lineDashOffset:w.borderDashOffset,lineJoin:w.borderJoinStyle,lineWidth:(T.width+T.height)/4,strokeStyle:w.borderColor,pointStyle:a||w.pointStyle,rotation:w.rotation,textAlign:h||w.textAlign,borderRadius:m&&(y||w.borderRadius),datasetIndex:x.index}},this)}},title:{color:e=>e.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:e=>!e.startsWith("on"),labels:{_scriptable:e=>!["generateLabels","filter","sort"].includes(e)}}};class PP extends Wl{constructor(r){super(),this.chart=r.chart,this.options=r.options,this.ctx=r.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(r,s){const a=this.options;if(this.left=0,this.top=0,!a.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=r,this.height=this.bottom=s;const h=jr(a.text)?a.text.length:1;this._padding=ps(a.padding);const f=h*Vi(a.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=f:this.width=f}isHorizontal(){const r=this.options.position;return r==="top"||r==="bottom"}_drawArgs(r){const{top:s,left:a,bottom:h,right:f,options:m}=this,y=m.align;let x=0,w,T,M;return this.isHorizontal()?(T=us(y,a,f),M=s+r,w=f-a):(m.position==="left"?(T=a+r,M=us(y,h,s),x=$r*-.5):(T=f-r,M=us(y,s,h),x=$r*.5),w=h-s),{titleX:T,titleY:M,maxWidth:w,rotation:x}}draw(){const r=this.ctx,s=this.options;if(!s.display)return;const a=Vi(s.font),f=a.lineHeight/2+this._padding.top,{titleX:m,titleY:y,maxWidth:x,rotation:w}=this._drawArgs(f);Ph(r,s.text,0,0,a,{color:s.color,maxWidth:x,rotation:w,textAlign:vP(s.align),textBaseline:"middle",translation:[m,y]})}}function Tmt(e,r){const s=new PP({ctx:e.ctx,options:r,chart:e});ds.configure(e,s,r),ds.addBox(e,s),e.titleBlock=s}var Emt={id:"title",_element:PP,start(e,r,s){Tmt(e,s)},stop(e){const r=e.titleBlock;ds.removeBox(e,r),delete e.titleBlock},beforeUpdate(e,r,s){const a=e.titleBlock;ds.configure(e,a,s),a.options=s},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const N0=new WeakMap;var Mmt={id:"subtitle",start(e,r,s){const a=new PP({ctx:e.ctx,options:s,chart:e});ds.configure(e,a,s),ds.addBox(e,a),N0.set(e,a)},stop(e){ds.removeBox(e,N0.get(e)),N0.delete(e)},beforeUpdate(e,r,s){const a=N0.get(e);ds.configure(e,a,s),a.options=s},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const mm={average(e){if(!e.length)return!1;let r,s,a=0,h=0,f=0;for(r=0,s=e.length;r<s;++r){const m=e[r].element;if(m&&m.hasValue()){const y=m.tooltipPosition();a+=y.x,h+=y.y,++f}}return{x:a/f,y:h/f}},nearest(e,r){if(!e.length)return!1;let s=r.x,a=r.y,h=Number.POSITIVE_INFINITY,f,m,y;for(f=0,m=e.length;f<m;++f){const x=e[f].element;if(x&&x.hasValue()){const w=x.getCenterPoint(),T=WM(r,w);T<h&&(h=T,y=x)}}if(y){const x=y.tooltipPosition();s=x.x,a=x.y}return{x:s,y:a}}};function Na(e,r){return r&&(jr(r)?Array.prototype.push.apply(e,r):e.push(r)),e}function bl(e){return(typeof e=="string"||e instanceof String)&&e.indexOf(`
`)>-1?e.split(`
`):e}function Amt(e,r){const{element:s,datasetIndex:a,index:h}=r,f=e.getDatasetMeta(a).controller,{label:m,value:y}=f.getLabelAndValue(h);return{chart:e,label:m,parsed:f.getParsed(h),raw:e.data.datasets[a].data[h],formattedValue:y,dataset:f.getDataset(),dataIndex:h,datasetIndex:a,element:s}}function HF(e,r){const s=e.chart.ctx,{body:a,footer:h,title:f}=e,{boxWidth:m,boxHeight:y}=r,x=Vi(r.bodyFont),w=Vi(r.titleFont),T=Vi(r.footerFont),M=f.length,I=h.length,R=a.length,O=ps(r.padding);let N=O.height,G=0,$=a.reduce((H,K)=>H+K.before.length+K.lines.length+K.after.length,0);if($+=e.beforeBody.length+e.afterBody.length,M&&(N+=M*w.lineHeight+(M-1)*r.titleSpacing+r.titleMarginBottom),$){const H=r.displayColors?Math.max(y,x.lineHeight):x.lineHeight;N+=R*H+($-R)*x.lineHeight+($-1)*r.bodySpacing}I&&(N+=r.footerMarginTop+I*T.lineHeight+(I-1)*r.footerSpacing);let z=0;const B=function(H){G=Math.max(G,s.measureText(H).width+z)};return s.save(),s.font=w.string,xr(e.title,B),s.font=x.string,xr(e.beforeBody.concat(e.afterBody),B),z=r.displayColors?m+2+r.boxPadding:0,xr(a,H=>{xr(H.before,B),xr(H.lines,B),xr(H.after,B)}),z=0,s.font=T.string,xr(e.footer,B),s.restore(),G+=O.width,{width:G,height:N}}function Cmt(e,r){const{y:s,height:a}=r;return s<a/2?"top":s>e.height-a/2?"bottom":"center"}function Pmt(e,r,s,a){const{x:h,width:f}=a,m=s.caretSize+s.caretPadding;if(e==="left"&&h+f+m>r.width||e==="right"&&h-f-m<0)return!0}function Imt(e,r,s,a){const{x:h,width:f}=s,{width:m,chartArea:{left:y,right:x}}=e;let w="center";return a==="center"?w=h<=(y+x)/2?"left":"right":h<=f/2?w="left":h>=m-f/2&&(w="right"),Pmt(w,e,r,s)&&(w="center"),w}function qF(e,r,s){const a=s.yAlign||r.yAlign||Cmt(e,s);return{xAlign:s.xAlign||r.xAlign||Imt(e,r,s,a),yAlign:a}}function kmt(e,r){let{x:s,width:a}=e;return r==="right"?s-=a:r==="center"&&(s-=a/2),s}function Dmt(e,r,s){let{y:a,height:h}=e;return r==="top"?a+=s:r==="bottom"?a-=h+s:a-=h/2,a}function ZF(e,r,s,a){const{caretSize:h,caretPadding:f,cornerRadius:m}=e,{xAlign:y,yAlign:x}=s,w=h+f,{topLeft:T,topRight:M,bottomLeft:I,bottomRight:R}=vh(m);let O=kmt(r,y);const N=Dmt(r,x,w);return x==="center"?y==="left"?O+=w:y==="right"&&(O-=w):y==="left"?O-=Math.max(T,I)+h:y==="right"&&(O+=Math.max(M,R)+h),{x:Wi(O,0,a.width-r.width),y:Wi(N,0,a.height-r.height)}}function F0(e,r,s){const a=ps(s.padding);return r==="center"?e.x+e.width/2:r==="right"?e.x+e.width-a.right:e.x+a.left}function XF(e){return Na([],bl(e))}function Rmt(e,r,s){return xu(e,{tooltip:r,tooltipItems:s,type:"tooltip"})}function YF(e,r){const s=r&&r.dataset&&r.dataset.tooltip&&r.dataset.tooltip.callbacks;return s?e.override(s):e}const U$={beforeTitle:yl,title(e){if(e.length>0){const r=e[0],s=r.chart.data.labels,a=s?s.length:0;if(this&&this.options&&this.options.mode==="dataset")return r.dataset.label||"";if(r.label)return r.label;if(a>0&&r.dataIndex<a)return s[r.dataIndex]}return""},afterTitle:yl,beforeBody:yl,beforeLabel:yl,label(e){if(this&&this.options&&this.options.mode==="dataset")return e.label+": "+e.formattedValue||e.formattedValue;let r=e.dataset.label||"";r&&(r+=": ");const s=e.formattedValue;return sr(s)||(r+=s),r},labelColor(e){const s=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:s.borderColor,backgroundColor:s.backgroundColor,borderWidth:s.borderWidth,borderDash:s.borderDash,borderDashOffset:s.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(e){const s=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:s.pointStyle,rotation:s.rotation}},afterLabel:yl,afterBody:yl,beforeFooter:yl,footer:yl,afterFooter:yl};function js(e,r,s,a){const h=e[r].call(s,a);return typeof h>"u"?U$[r].call(s,a):h}class tA extends Wl{constructor(r){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=r.chart,this.options=r.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(r){this.options=r,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const r=this._cachedAnimations;if(r)return r;const s=this.chart,a=this.options.setContext(this.getContext()),h=a.enabled&&s.options.animation&&a.animations,f=new b$(this.chart,h);return h._cacheable&&(this._cachedAnimations=Object.freeze(f)),f}getContext(){return this.$context||(this.$context=Rmt(this.chart.getContext(),this,this._tooltipItems))}getTitle(r,s){const{callbacks:a}=s,h=js(a,"beforeTitle",this,r),f=js(a,"title",this,r),m=js(a,"afterTitle",this,r);let y=[];return y=Na(y,bl(h)),y=Na(y,bl(f)),y=Na(y,bl(m)),y}getBeforeBody(r,s){return XF(js(s.callbacks,"beforeBody",this,r))}getBody(r,s){const{callbacks:a}=s,h=[];return xr(r,f=>{const m={before:[],lines:[],after:[]},y=YF(a,f);Na(m.before,bl(js(y,"beforeLabel",this,f))),Na(m.lines,js(y,"label",this,f)),Na(m.after,bl(js(y,"afterLabel",this,f))),h.push(m)}),h}getAfterBody(r,s){return XF(js(s.callbacks,"afterBody",this,r))}getFooter(r,s){const{callbacks:a}=s,h=js(a,"beforeFooter",this,r),f=js(a,"footer",this,r),m=js(a,"afterFooter",this,r);let y=[];return y=Na(y,bl(h)),y=Na(y,bl(f)),y=Na(y,bl(m)),y}_createItems(r){const s=this._active,a=this.chart.data,h=[],f=[],m=[];let y=[],x,w;for(x=0,w=s.length;x<w;++x)y.push(Amt(this.chart,s[x]));return r.filter&&(y=y.filter((T,M,I)=>r.filter(T,M,I,a))),r.itemSort&&(y=y.sort((T,M)=>r.itemSort(T,M,a))),xr(y,T=>{const M=YF(r.callbacks,T);h.push(js(M,"labelColor",this,T)),f.push(js(M,"labelPointStyle",this,T)),m.push(js(M,"labelTextColor",this,T))}),this.labelColors=h,this.labelPointStyles=f,this.labelTextColors=m,this.dataPoints=y,y}update(r,s){const a=this.options.setContext(this.getContext()),h=this._active;let f,m=[];if(!h.length)this.opacity!==0&&(f={opacity:0});else{const y=mm[a.position].call(this,h,this._eventPosition);m=this._createItems(a),this.title=this.getTitle(m,a),this.beforeBody=this.getBeforeBody(m,a),this.body=this.getBody(m,a),this.afterBody=this.getAfterBody(m,a),this.footer=this.getFooter(m,a);const x=this._size=HF(this,a),w=Object.assign({},y,x),T=qF(this.chart,a,w),M=ZF(a,w,T,this.chart);this.xAlign=T.xAlign,this.yAlign=T.yAlign,f={opacity:1,x:M.x,y:M.y,width:x.width,height:x.height,caretX:y.x,caretY:y.y}}this._tooltipItems=m,this.$context=void 0,f&&this._resolveAnimations().update(this,f),r&&a.external&&a.external.call(this,{chart:this.chart,tooltip:this,replay:s})}drawCaret(r,s,a,h){const f=this.getCaretPosition(r,a,h);s.lineTo(f.x1,f.y1),s.lineTo(f.x2,f.y2),s.lineTo(f.x3,f.y3)}getCaretPosition(r,s,a){const{xAlign:h,yAlign:f}=this,{caretSize:m,cornerRadius:y}=a,{topLeft:x,topRight:w,bottomLeft:T,bottomRight:M}=vh(y),{x:I,y:R}=r,{width:O,height:N}=s;let G,$,z,B,H,K;return f==="center"?(H=R+N/2,h==="left"?(G=I,$=G-m,B=H+m,K=H-m):(G=I+O,$=G+m,B=H-m,K=H+m),z=G):(h==="left"?$=I+Math.max(x,T)+m:h==="right"?$=I+O-Math.max(w,M)-m:$=this.caretX,f==="top"?(B=R,H=B-m,G=$-m,z=$+m):(B=R+N,H=B+m,G=$+m,z=$-m),K=B),{x1:G,x2:$,x3:z,y1:B,y2:H,y3:K}}drawTitle(r,s,a){const h=this.title,f=h.length;let m,y,x;if(f){const w=af(a.rtl,this.x,this.width);for(r.x=F0(this,a.titleAlign,a),s.textAlign=w.textAlign(a.titleAlign),s.textBaseline="middle",m=Vi(a.titleFont),y=a.titleSpacing,s.fillStyle=a.titleColor,s.font=m.string,x=0;x<f;++x)s.fillText(h[x],w.x(r.x),r.y+m.lineHeight/2),r.y+=m.lineHeight+y,x+1===f&&(r.y+=a.titleMarginBottom-y)}}_drawColorBox(r,s,a,h,f){const m=this.labelColors[a],y=this.labelPointStyles[a],{boxHeight:x,boxWidth:w}=f,T=Vi(f.bodyFont),M=F0(this,"left",f),I=h.x(M),R=x<T.lineHeight?(T.lineHeight-x)/2:0,O=s.y+R;if(f.usePointStyle){const N={radius:Math.min(w,x)/2,pointStyle:y.pointStyle,rotation:y.rotation,borderWidth:1},G=h.leftForLtr(I,w)+w/2,$=O+x/2;r.strokeStyle=f.multiKeyBackground,r.fillStyle=f.multiKeyBackground,qM(r,N,G,$),r.strokeStyle=m.borderColor,r.fillStyle=m.backgroundColor,qM(r,N,G,$)}else{r.lineWidth=Zn(m.borderWidth)?Math.max(...Object.values(m.borderWidth)):m.borderWidth||1,r.strokeStyle=m.borderColor,r.setLineDash(m.borderDash||[]),r.lineDashOffset=m.borderDashOffset||0;const N=h.leftForLtr(I,w),G=h.leftForLtr(h.xPlus(I,1),w-2),$=vh(m.borderRadius);Object.values($).some(z=>z!==0)?(r.beginPath(),r.fillStyle=f.multiKeyBackground,_g(r,{x:N,y:O,w,h:x,radius:$}),r.fill(),r.stroke(),r.fillStyle=m.backgroundColor,r.beginPath(),_g(r,{x:G,y:O+1,w:w-2,h:x-2,radius:$}),r.fill()):(r.fillStyle=f.multiKeyBackground,r.fillRect(N,O,w,x),r.strokeRect(N,O,w,x),r.fillStyle=m.backgroundColor,r.fillRect(G,O+1,w-2,x-2))}r.fillStyle=this.labelTextColors[a]}drawBody(r,s,a){const{body:h}=this,{bodySpacing:f,bodyAlign:m,displayColors:y,boxHeight:x,boxWidth:w,boxPadding:T}=a,M=Vi(a.bodyFont);let I=M.lineHeight,R=0;const O=af(a.rtl,this.x,this.width),N=function(et){s.fillText(et,O.x(r.x+R),r.y+I/2),r.y+=I+f},G=O.textAlign(m);let $,z,B,H,K,at,ft;for(s.textAlign=m,s.textBaseline="middle",s.font=M.string,r.x=F0(this,G,a),s.fillStyle=a.bodyColor,xr(this.beforeBody,N),R=y&&G!=="right"?m==="center"?w/2+T:w+2+T:0,H=0,at=h.length;H<at;++H){for($=h[H],z=this.labelTextColors[H],s.fillStyle=z,xr($.before,N),B=$.lines,y&&B.length&&(this._drawColorBox(s,r,H,O,a),I=Math.max(M.lineHeight,x)),K=0,ft=B.length;K<ft;++K)N(B[K]),I=M.lineHeight;xr($.after,N)}R=0,I=M.lineHeight,xr(this.afterBody,N),r.y-=f}drawFooter(r,s,a){const h=this.footer,f=h.length;let m,y;if(f){const x=af(a.rtl,this.x,this.width);for(r.x=F0(this,a.footerAlign,a),r.y+=a.footerMarginTop,s.textAlign=x.textAlign(a.footerAlign),s.textBaseline="middle",m=Vi(a.footerFont),s.fillStyle=a.footerColor,s.font=m.string,y=0;y<f;++y)s.fillText(h[y],x.x(r.x),r.y+m.lineHeight/2),r.y+=m.lineHeight+a.footerSpacing}}drawBackground(r,s,a,h){const{xAlign:f,yAlign:m}=this,{x:y,y:x}=r,{width:w,height:T}=a,{topLeft:M,topRight:I,bottomLeft:R,bottomRight:O}=vh(h.cornerRadius);s.fillStyle=h.backgroundColor,s.strokeStyle=h.borderColor,s.lineWidth=h.borderWidth,s.beginPath(),s.moveTo(y+M,x),m==="top"&&this.drawCaret(r,s,a,h),s.lineTo(y+w-I,x),s.quadraticCurveTo(y+w,x,y+w,x+I),m==="center"&&f==="right"&&this.drawCaret(r,s,a,h),s.lineTo(y+w,x+T-O),s.quadraticCurveTo(y+w,x+T,y+w-O,x+T),m==="bottom"&&this.drawCaret(r,s,a,h),s.lineTo(y+R,x+T),s.quadraticCurveTo(y,x+T,y,x+T-R),m==="center"&&f==="left"&&this.drawCaret(r,s,a,h),s.lineTo(y,x+M),s.quadraticCurveTo(y,x,y+M,x),s.closePath(),s.fill(),h.borderWidth>0&&s.stroke()}_updateAnimationTarget(r){const s=this.chart,a=this.$animations,h=a&&a.x,f=a&&a.y;if(h||f){const m=mm[r.position].call(this,this._active,this._eventPosition);if(!m)return;const y=this._size=HF(this,r),x=Object.assign({},m,this._size),w=qF(s,r,x),T=ZF(r,x,w,s);(h._to!==T.x||f._to!==T.y)&&(this.xAlign=w.xAlign,this.yAlign=w.yAlign,this.width=y.width,this.height=y.height,this.caretX=m.x,this.caretY=m.y,this._resolveAnimations().update(this,T))}}_willRender(){return!!this.opacity}draw(r){const s=this.options.setContext(this.getContext());let a=this.opacity;if(!a)return;this._updateAnimationTarget(s);const h={width:this.width,height:this.height},f={x:this.x,y:this.y};a=Math.abs(a)<.001?0:a;const m=ps(s.padding),y=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;s.enabled&&y&&(r.save(),r.globalAlpha=a,this.drawBackground(f,r,h,s),g$(r,s.textDirection),f.y+=m.top,this.drawTitle(f,r,s),this.drawBody(f,r,s),this.drawFooter(f,r,s),_$(r,s.textDirection),r.restore())}getActiveElements(){return this._active||[]}setActiveElements(r,s){const a=this._active,h=r.map(({datasetIndex:y,index:x})=>{const w=this.chart.getDatasetMeta(y);if(!w)throw new Error("Cannot find a dataset at index "+y);return{datasetIndex:y,element:w.data[x],index:x}}),f=!gx(a,h),m=this._positionChanged(h,s);(f||m)&&(this._active=h,this._eventPosition=s,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(r,s,a=!0){if(s&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const h=this.options,f=this._active||[],m=this._getActiveElements(r,f,s,a),y=this._positionChanged(m,r),x=s||!gx(m,f)||y;return x&&(this._active=m,(h.enabled||h.external)&&(this._eventPosition={x:r.x,y:r.y},this.update(!0,s))),x}_getActiveElements(r,s,a,h){const f=this.options;if(r.type==="mouseout")return[];if(!h)return s.filter(y=>this.chart.data.datasets[y.datasetIndex]&&this.chart.getDatasetMeta(y.datasetIndex).controller.getParsed(y.index)!==void 0);const m=this.chart.getElementsAtEventForMode(r,f.mode,f,a);return f.reverse&&m.reverse(),m}_positionChanged(r,s){const{caretX:a,caretY:h,options:f}=this,m=mm[f.position].call(this,r,s);return m!==!1&&(a!==m.x||h!==m.y)}}Ie(tA,"positioners",mm);var Omt={id:"tooltip",_element:tA,positioners:mm,afterInit(e,r,s){s&&(e.tooltip=new tA({chart:e,options:s}))},beforeUpdate(e,r,s){e.tooltip&&e.tooltip.initialize(s)},reset(e,r,s){e.tooltip&&e.tooltip.initialize(s)},afterDraw(e){const r=e.tooltip;if(r&&r._willRender()){const s={tooltip:r};if(e.notifyPlugins("beforeTooltipDraw",{...s,cancelable:!0})===!1)return;r.draw(e.ctx),e.notifyPlugins("afterTooltipDraw",s)}},afterEvent(e,r){if(e.tooltip){const s=r.replay;e.tooltip.handleEvent(r.event,s,r.inChartArea)&&(r.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(e,r)=>r.bodyFont.size,boxWidth:(e,r)=>r.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:U$},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:e=>e!=="filter"&&e!=="itemSort"&&e!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},Lmt=Object.freeze({__proto__:null,Colors:qpt,Decimation:Kpt,Filler:_mt,Legend:Smt,SubTitle:Mmt,Title:Emt,Tooltip:Omt});const zmt=(e,r,s,a)=>(typeof r=="string"?(s=e.push(r)-1,a.unshift({index:s,label:r})):isNaN(r)&&(s=null),s);function Nmt(e,r,s,a){const h=e.indexOf(r);if(h===-1)return zmt(e,r,s,a);const f=e.lastIndexOf(r);return h!==f?s:h}const Fmt=(e,r)=>e===null?null:Wi(Math.round(e),0,r);function KF(e){const r=this.getLabels();return e>=0&&e<r.length?r[e]:e}class eA extends Nh{constructor(r){super(r),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(r){const s=this._addedLabels;if(s.length){const a=this.getLabels();for(const{index:h,label:f}of s)a[h]===f&&a.splice(h,1);this._addedLabels=[]}super.init(r)}parse(r,s){if(sr(r))return null;const a=this.getLabels();return s=isFinite(s)&&a[s]===r?s:Nmt(a,r,On(s,r),this._addedLabels),Fmt(s,a.length-1)}determineDataLimits(){const{minDefined:r,maxDefined:s}=this.getUserBounds();let{min:a,max:h}=this.getMinMax(!0);this.options.bounds==="ticks"&&(r||(a=0),s||(h=this.getLabels().length-1)),this.min=a,this.max=h}buildTicks(){const r=this.min,s=this.max,a=this.options.offset,h=[];let f=this.getLabels();f=r===0&&s===f.length-1?f:f.slice(r,s+1),this._valueRange=Math.max(f.length-(a?0:1),1),this._startValue=this.min-(a?.5:0);for(let m=r;m<=s;m++)h.push({value:m});return h}getLabelForValue(r){return KF.call(this,r)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(r){return typeof r!="number"&&(r=this.parse(r)),r===null?NaN:this.getPixelForDecimal((r-this._startValue)/this._valueRange)}getPixelForTick(r){const s=this.ticks;return r<0||r>s.length-1?null:this.getPixelForValue(s[r].value)}getValueForPixel(r){return Math.round(this._startValue+this.getDecimalForPixel(r)*this._valueRange)}getBasePixel(){return this.bottom}}Ie(eA,"id","category"),Ie(eA,"defaults",{ticks:{callback:KF}});function Bmt(e,r){const s=[],{bounds:h,step:f,min:m,max:y,precision:x,count:w,maxTicks:T,maxDigits:M,includeBounds:I}=e,R=f||1,O=T-1,{min:N,max:G}=r,$=!sr(m),z=!sr(y),B=!sr(w),H=(G-N)/(M+1);let K=WN((G-N)/O/R)*R,at,ft,et,nt;if(K<1e-14&&!$&&!z)return[{value:N},{value:G}];nt=Math.ceil(G/K)-Math.floor(N/K),nt>O&&(K=WN(nt*K/O/R)*R),sr(x)||(at=Math.pow(10,x),K=Math.ceil(K*at)/at),h==="ticks"?(ft=Math.floor(N/K)*K,et=Math.ceil(G/K)*K):(ft=N,et=G),$&&z&&f&&Rht((y-m)/f,K/1e3)?(nt=Math.round(Math.min((y-m)/K,T)),K=(y-m)/nt,ft=m,et=y):B?(ft=$?m:ft,et=z?y:et,nt=w-1,K=(et-ft)/nt):(nt=(et-ft)/K,Rm(nt,Math.round(nt),K/1e3)?nt=Math.round(nt):nt=Math.ceil(nt));const W=Math.max(HN(K),HN(ft));at=Math.pow(10,sr(x)?W:x),ft=Math.round(ft*at)/at,et=Math.round(et*at)/at;let Q=0;for($&&(I&&ft!==m?(s.push({value:m}),ft<m&&Q++,Rm(Math.round((ft+Q*K)*at)/at,m,JF(m,H,e))&&Q++):ft<m&&Q++);Q<nt;++Q){const yt=Math.round((ft+Q*K)*at)/at;if(z&&yt>y)break;s.push({value:yt})}return z&&I&&et!==y?s.length&&Rm(s[s.length-1].value,y,JF(y,H,e))?s[s.length-1].value=y:s.push({value:y}):(!z||et===y)&&s.push({value:et}),s}function JF(e,r,{horizontal:s,minRotation:a}){const h=ha(a),f=(s?Math.sin(h):Math.cos(h))||.001,m=.75*r*(""+e).length;return Math.min(r/f,m)}class Sx extends Nh{constructor(r){super(r),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(r,s){return sr(r)||(typeof r=="number"||r instanceof Number)&&!isFinite(+r)?null:+r}handleTickRangeOptions(){const{beginAtZero:r}=this.options,{minDefined:s,maxDefined:a}=this.getUserBounds();let{min:h,max:f}=this;const m=x=>h=s?h:x,y=x=>f=a?f:x;if(r){const x=qa(h),w=qa(f);x<0&&w<0?y(0):x>0&&w>0&&m(0)}if(h===f){let x=f===0?1:Math.abs(f*.05);y(f+x),r||m(h-x)}this.min=h,this.max=f}getTickLimit(){const r=this.options.ticks;let{maxTicksLimit:s,stepSize:a}=r,h;return a?(h=Math.ceil(this.max/a)-Math.floor(this.min/a)+1,h>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${a} would result generating up to ${h} ticks. Limiting to 1000.`),h=1e3)):(h=this.computeTickLimit(),s=s||11),s&&(h=Math.min(s,h)),h}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const r=this.options,s=r.ticks;let a=this.getTickLimit();a=Math.max(2,a);const h={maxTicks:a,bounds:r.bounds,min:r.min,max:r.max,precision:s.precision,step:s.stepSize,count:s.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:s.minRotation||0,includeBounds:s.includeBounds!==!1},f=this._range||this,m=Bmt(h,f);return r.bounds==="ticks"&&Q8(m,this,"value"),r.reverse?(m.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),m}configure(){const r=this.ticks;let s=this.min,a=this.max;if(super.configure(),this.options.offset&&r.length){const h=(a-s)/Math.max(r.length-1,1)/2;s-=h,a+=h}this._startValue=s,this._endValue=a,this._valueRange=a-s}getLabelForValue(r){return jg(r,this.chart.options.locale,this.options.ticks.format)}}class nA extends Sx{determineDataLimits(){const{min:r,max:s}=this.getMinMax(!0);this.min=di(r)?r:0,this.max=di(s)?s:1,this.handleTickRangeOptions()}computeTickLimit(){const r=this.isHorizontal(),s=r?this.width:this.height,a=ha(this.options.ticks.minRotation),h=(r?Math.sin(a):Math.cos(a))||.001,f=this._resolveTickFontOptions(0);return Math.ceil(s/Math.min(40,f.lineHeight/h))}getPixelForValue(r){return r===null?NaN:this.getPixelForDecimal((r-this._startValue)/this._valueRange)}getValueForPixel(r){return this._startValue+this.getDecimalForPixel(r)*this._valueRange}}Ie(nA,"id","linear"),Ie(nA,"defaults",{ticks:{callback:_1.formatters.numeric}});const vg=e=>Math.floor($c(e)),Qu=(e,r)=>Math.pow(10,vg(e)+r);function QF(e){return e/Math.pow(10,vg(e))===1}function tB(e,r,s){const a=Math.pow(10,s),h=Math.floor(e/a);return Math.ceil(r/a)-h}function jmt(e,r){const s=r-e;let a=vg(s);for(;tB(e,r,a)>10;)a++;for(;tB(e,r,a)<10;)a--;return Math.min(a,vg(e))}function Vmt(e,{min:r,max:s}){r=io(e.min,r);const a=[],h=vg(r);let f=jmt(r,s),m=f<0?Math.pow(10,Math.abs(f)):1;const y=Math.pow(10,f),x=h>f?Math.pow(10,h):0,w=Math.round((r-x)*m)/m,T=Math.floor((r-x)/y/10)*y*10;let M=Math.floor((w-T)/Math.pow(10,f)),I=io(e.min,Math.round((x+T+M*Math.pow(10,f))*m)/m);for(;I<s;)a.push({value:I,major:QF(I),significand:M}),M>=10?M=M<15?15:20:M++,M>=20&&(f++,M=2,m=f>=0?1:m),I=Math.round((x+T+M*Math.pow(10,f))*m)/m;const R=io(e.max,I);return a.push({value:R,major:QF(R),significand:M}),a}class rA extends Nh{constructor(r){super(r),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(r,s){const a=Sx.prototype.parse.apply(this,[r,s]);if(a===0){this._zero=!0;return}return di(a)&&a>0?a:null}determineDataLimits(){const{min:r,max:s}=this.getMinMax(!0);this.min=di(r)?Math.max(0,r):null,this.max=di(s)?Math.max(0,s):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!di(this._userMin)&&(this.min=r===Qu(this.min,0)?Qu(this.min,-1):Qu(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:r,maxDefined:s}=this.getUserBounds();let a=this.min,h=this.max;const f=y=>a=r?a:y,m=y=>h=s?h:y;a===h&&(a<=0?(f(1),m(10)):(f(Qu(a,-1)),m(Qu(h,1)))),a<=0&&f(Qu(h,-1)),h<=0&&m(Qu(a,1)),this.min=a,this.max=h}buildTicks(){const r=this.options,s={min:this._userMin,max:this._userMax},a=Vmt(s,this);return r.bounds==="ticks"&&Q8(a,this,"value"),r.reverse?(a.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),a}getLabelForValue(r){return r===void 0?"0":jg(r,this.chart.options.locale,this.options.ticks.format)}configure(){const r=this.min;super.configure(),this._startValue=$c(r),this._valueRange=$c(this.max)-$c(r)}getPixelForValue(r){return(r===void 0||r===0)&&(r=this.min),r===null||isNaN(r)?NaN:this.getPixelForDecimal(r===this.min?0:($c(r)-this._startValue)/this._valueRange)}getValueForPixel(r){const s=this.getDecimalForPixel(r);return Math.pow(10,this._startValue+s*this._valueRange)}}Ie(rA,"id","logarithmic"),Ie(rA,"defaults",{ticks:{callback:_1.formatters.logarithmic,major:{enabled:!0}}});function iA(e){const r=e.ticks;if(r.display&&e.display){const s=ps(r.backdropPadding);return On(r.font&&r.font.size,fi.font.size)+s.height}return 0}function Umt(e,r,s){return s=jr(s)?s:[s],{w:Yht(e,r.string,s),h:s.length*r.lineHeight}}function eB(e,r,s,a,h){return e===a||e===h?{start:r-s/2,end:r+s/2}:e<a||e>h?{start:r-s,end:r}:{start:r,end:r+s}}function $mt(e){const r={l:e.left+e._padding.left,r:e.right-e._padding.right,t:e.top+e._padding.top,b:e.bottom-e._padding.bottom},s=Object.assign({},r),a=[],h=[],f=e._pointLabels.length,m=e.options.pointLabels,y=m.centerPointLabels?$r/f:0;for(let x=0;x<f;x++){const w=m.setContext(e.getPointLabelContext(x));h[x]=w.padding;const T=e.getPointPosition(x,e.drawingArea+h[x],y),M=Vi(w.font),I=Umt(e.ctx,M,e._pointLabels[x]);a[x]=I;const R=oo(e.getIndexAngle(x)+y),O=Math.round(_P(R)),N=eB(O,T.x,I.w,0,180),G=eB(O,T.y,I.h,90,270);Gmt(s,r,R,N,G)}e.setCenterPoint(r.l-s.l,s.r-r.r,r.t-s.t,s.b-r.b),e._pointLabelItems=qmt(e,a,h)}function Gmt(e,r,s,a,h){const f=Math.abs(Math.sin(s)),m=Math.abs(Math.cos(s));let y=0,x=0;a.start<r.l?(y=(r.l-a.start)/f,e.l=Math.min(e.l,r.l-y)):a.end>r.r&&(y=(a.end-r.r)/f,e.r=Math.max(e.r,r.r+y)),h.start<r.t?(x=(r.t-h.start)/m,e.t=Math.min(e.t,r.t-x)):h.end>r.b&&(x=(h.end-r.b)/m,e.b=Math.max(e.b,r.b+x))}function Wmt(e,r,s){const a=e.drawingArea,{extra:h,additionalAngle:f,padding:m,size:y}=s,x=e.getPointPosition(r,a+h+m,f),w=Math.round(_P(oo(x.angle+Ti))),T=Ymt(x.y,y.h,w),M=Zmt(w),I=Xmt(x.x,y.w,M);return{visible:!0,x:x.x,y:T,textAlign:M,left:I,top:T,right:I+y.w,bottom:T+y.h}}function Hmt(e,r){if(!r)return!0;const{left:s,top:a,right:h,bottom:f}=e;return!(Il({x:s,y:a},r)||Il({x:s,y:f},r)||Il({x:h,y:a},r)||Il({x:h,y:f},r))}function qmt(e,r,s){const a=[],h=e._pointLabels.length,f=e.options,{centerPointLabels:m,display:y}=f.pointLabels,x={extra:iA(f)/2,additionalAngle:m?$r/h:0};let w;for(let T=0;T<h;T++){x.padding=s[T],x.size=r[T];const M=Wmt(e,T,x);a.push(M),y==="auto"&&(M.visible=Hmt(M,w),M.visible&&(w=M))}return a}function Zmt(e){return e===0||e===180?"center":e<180?"left":"right"}function Xmt(e,r,s){return s==="right"?e-=r:s==="center"&&(e-=r/2),e}function Ymt(e,r,s){return s===90||s===270?e-=r/2:(s>270||s<90)&&(e-=r),e}function Kmt(e,r,s){const{left:a,top:h,right:f,bottom:m}=s,{backdropColor:y}=r;if(!sr(y)){const x=vh(r.borderRadius),w=ps(r.backdropPadding);e.fillStyle=y;const T=a-w.left,M=h-w.top,I=f-a+w.width,R=m-h+w.height;Object.values(x).some(O=>O!==0)?(e.beginPath(),_g(e,{x:T,y:M,w:I,h:R,radius:x}),e.fill()):e.fillRect(T,M,I,R)}}function Jmt(e,r){const{ctx:s,options:{pointLabels:a}}=e;for(let h=r-1;h>=0;h--){const f=e._pointLabelItems[h];if(!f.visible)continue;const m=a.setContext(e.getPointLabelContext(h));Kmt(s,m,f);const y=Vi(m.font),{x,y:w,textAlign:T}=f;Ph(s,e._pointLabels[h],x,w+y.lineHeight/2,y,{color:m.color,textAlign:T,textBaseline:"middle"})}}function $$(e,r,s,a){const{ctx:h}=e;if(s)h.arc(e.xCenter,e.yCenter,r,0,Ur);else{let f=e.getPointPosition(0,r);h.moveTo(f.x,f.y);for(let m=1;m<a;m++)f=e.getPointPosition(m,r),h.lineTo(f.x,f.y)}}function Qmt(e,r,s,a,h){const f=e.ctx,m=r.circular,{color:y,lineWidth:x}=r;!m&&!a||!y||!x||s<0||(f.save(),f.strokeStyle=y,f.lineWidth=x,f.setLineDash(h.dash),f.lineDashOffset=h.dashOffset,f.beginPath(),$$(e,s,m,a),f.closePath(),f.stroke(),f.restore())}function tgt(e,r,s){return xu(e,{label:s,index:r,type:"pointLabel"})}class gm extends Sx{constructor(r){super(r),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const r=this._padding=ps(iA(this.options)/2),s=this.width=this.maxWidth-r.width,a=this.height=this.maxHeight-r.height;this.xCenter=Math.floor(this.left+s/2+r.left),this.yCenter=Math.floor(this.top+a/2+r.top),this.drawingArea=Math.floor(Math.min(s,a)/2)}determineDataLimits(){const{min:r,max:s}=this.getMinMax(!1);this.min=di(r)&&!isNaN(r)?r:0,this.max=di(s)&&!isNaN(s)?s:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/iA(this.options))}generateTickLabels(r){Sx.prototype.generateTickLabels.call(this,r),this._pointLabels=this.getLabels().map((s,a)=>{const h=Lr(this.options.pointLabels.callback,[s,a],this);return h||h===0?h:""}).filter((s,a)=>this.chart.getDataVisibility(a))}fit(){const r=this.options;r.display&&r.pointLabels.display?$mt(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(r,s,a,h){this.xCenter+=Math.floor((r-s)/2),this.yCenter+=Math.floor((a-h)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(r,s,a,h))}getIndexAngle(r){const s=Ur/(this._pointLabels.length||1),a=this.options.startAngle||0;return oo(r*s+ha(a))}getDistanceFromCenterForValue(r){if(sr(r))return NaN;const s=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-r)*s:(r-this.min)*s}getValueForDistanceFromCenter(r){if(sr(r))return NaN;const s=r/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-s:this.min+s}getPointLabelContext(r){const s=this._pointLabels||[];if(r>=0&&r<s.length){const a=s[r];return tgt(this.getContext(),r,a)}}getPointPosition(r,s,a=0){const h=this.getIndexAngle(r)-Ti+a;return{x:Math.cos(h)*s+this.xCenter,y:Math.sin(h)*s+this.yCenter,angle:h}}getPointPositionForValue(r,s){return this.getPointPosition(r,this.getDistanceFromCenterForValue(s))}getBasePosition(r){return this.getPointPositionForValue(r||0,this.getBaseValue())}getPointLabelPosition(r){const{left:s,top:a,right:h,bottom:f}=this._pointLabelItems[r];return{left:s,top:a,right:h,bottom:f}}drawBackground(){const{backgroundColor:r,grid:{circular:s}}=this.options;if(r){const a=this.ctx;a.save(),a.beginPath(),$$(this,this.getDistanceFromCenterForValue(this._endValue),s,this._pointLabels.length),a.closePath(),a.fillStyle=r,a.fill(),a.restore()}}drawGrid(){const r=this.ctx,s=this.options,{angleLines:a,grid:h,border:f}=s,m=this._pointLabels.length;let y,x,w;if(s.pointLabels.display&&Jmt(this,m),h.display&&this.ticks.forEach((T,M)=>{if(M!==0){x=this.getDistanceFromCenterForValue(T.value);const I=this.getContext(M),R=h.setContext(I),O=f.setContext(I);Qmt(this,R,x,m,O)}}),a.display){for(r.save(),y=m-1;y>=0;y--){const T=a.setContext(this.getPointLabelContext(y)),{color:M,lineWidth:I}=T;!I||!M||(r.lineWidth=I,r.strokeStyle=M,r.setLineDash(T.borderDash),r.lineDashOffset=T.borderDashOffset,x=this.getDistanceFromCenterForValue(s.ticks.reverse?this.min:this.max),w=this.getPointPosition(y,x),r.beginPath(),r.moveTo(this.xCenter,this.yCenter),r.lineTo(w.x,w.y),r.stroke())}r.restore()}}drawBorder(){}drawLabels(){const r=this.ctx,s=this.options,a=s.ticks;if(!a.display)return;const h=this.getIndexAngle(0);let f,m;r.save(),r.translate(this.xCenter,this.yCenter),r.rotate(h),r.textAlign="center",r.textBaseline="middle",this.ticks.forEach((y,x)=>{if(x===0&&!s.reverse)return;const w=a.setContext(this.getContext(x)),T=Vi(w.font);if(f=this.getDistanceFromCenterForValue(this.ticks[x].value),w.showLabelBackdrop){r.font=T.string,m=r.measureText(y.label).width,r.fillStyle=w.backdropColor;const M=ps(w.backdropPadding);r.fillRect(-m/2-M.left,-f-T.size/2-M.top,m+M.width,T.size+M.height)}Ph(r,y.label,0,-f,T,{color:w.color,strokeColor:w.textStrokeColor,strokeWidth:w.textStrokeWidth})}),r.restore()}drawTitle(){}}Ie(gm,"id","radialLinear"),Ie(gm,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:_1.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(r){return r},padding:5,centerPointLabels:!1}}),Ie(gm,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),Ie(gm,"descriptors",{angleLines:{_fallback:"grid"}});const b1={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Us=Object.keys(b1);function nB(e,r){return e-r}function rB(e,r){if(sr(r))return null;const s=e._adapter,{parser:a,round:h,isoWeekday:f}=e._parseOpts;let m=r;return typeof a=="function"&&(m=a(m)),di(m)||(m=typeof a=="string"?s.parse(m,a):s.parse(m)),m===null?null:(h&&(m=h==="week"&&(xf(f)||f===!0)?s.startOf(m,"isoWeek",f):s.startOf(m,h)),+m)}function iB(e,r,s,a){const h=Us.length;for(let f=Us.indexOf(e);f<h-1;++f){const m=b1[Us[f]],y=m.steps?m.steps:Number.MAX_SAFE_INTEGER;if(m.common&&Math.ceil((s-r)/(y*m.size))<=a)return Us[f]}return Us[h-1]}function egt(e,r,s,a,h){for(let f=Us.length-1;f>=Us.indexOf(s);f--){const m=Us[f];if(b1[m].common&&e._adapter.diff(h,a,m)>=r-1)return m}return Us[s?Us.indexOf(s):0]}function ngt(e){for(let r=Us.indexOf(e)+1,s=Us.length;r<s;++r)if(b1[Us[r]].common)return Us[r]}function sB(e,r,s){if(!s)e[r]=!0;else if(s.length){const{lo:a,hi:h}=yP(s,r),f=s[a]>=r?s[a]:s[h];e[f]=!0}}function rgt(e,r,s,a){const h=e._adapter,f=+h.startOf(r[0].value,a),m=r[r.length-1].value;let y,x;for(y=f;y<=m;y=+h.add(y,1,a))x=s[y],x>=0&&(r[x].major=!0);return r}function oB(e,r,s){const a=[],h={},f=r.length;let m,y;for(m=0;m<f;++m)y=r[m],h[y]=m,a.push({value:y,major:!1});return f===0||!s?a:rgt(e,a,h,s)}class xg extends Nh{constructor(r){super(r),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(r,s={}){const a=r.time||(r.time={}),h=this._adapter=new dft._date(r.adapters.date);h.init(s),Dm(a.displayFormats,h.formats()),this._parseOpts={parser:a.parser,round:a.round,isoWeekday:a.isoWeekday},super.init(r),this._normalized=s.normalized}parse(r,s){return r===void 0?null:rB(this,r)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const r=this.options,s=this._adapter,a=r.time.unit||"day";let{min:h,max:f,minDefined:m,maxDefined:y}=this.getUserBounds();function x(w){!m&&!isNaN(w.min)&&(h=Math.min(h,w.min)),!y&&!isNaN(w.max)&&(f=Math.max(f,w.max))}(!m||!y)&&(x(this._getLabelBounds()),(r.bounds!=="ticks"||r.ticks.source!=="labels")&&x(this.getMinMax(!1))),h=di(h)&&!isNaN(h)?h:+s.startOf(Date.now(),a),f=di(f)&&!isNaN(f)?f:+s.endOf(Date.now(),a)+1,this.min=Math.min(h,f-1),this.max=Math.max(h+1,f)}_getLabelBounds(){const r=this.getLabelTimestamps();let s=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY;return r.length&&(s=r[0],a=r[r.length-1]),{min:s,max:a}}buildTicks(){const r=this.options,s=r.time,a=r.ticks,h=a.source==="labels"?this.getLabelTimestamps():this._generate();r.bounds==="ticks"&&h.length&&(this.min=this._userMin||h[0],this.max=this._userMax||h[h.length-1]);const f=this.min,m=this.max,y=Nht(h,f,m);return this._unit=s.unit||(a.autoSkip?iB(s.minUnit,this.min,this.max,this._getLabelCapacity(f)):egt(this,y.length,s.minUnit,this.min,this.max)),this._majorUnit=!a.major.enabled||this._unit==="year"?void 0:ngt(this._unit),this.initOffsets(h),r.reverse&&y.reverse(),oB(this,y,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(r=>+r.value))}initOffsets(r=[]){let s=0,a=0,h,f;this.options.offset&&r.length&&(h=this.getDecimalForValue(r[0]),r.length===1?s=1-h:s=(this.getDecimalForValue(r[1])-h)/2,f=this.getDecimalForValue(r[r.length-1]),r.length===1?a=f:a=(f-this.getDecimalForValue(r[r.length-2]))/2);const m=r.length<3?.5:.25;s=Wi(s,0,m),a=Wi(a,0,m),this._offsets={start:s,end:a,factor:1/(s+1+a)}}_generate(){const r=this._adapter,s=this.min,a=this.max,h=this.options,f=h.time,m=f.unit||iB(f.minUnit,s,a,this._getLabelCapacity(s)),y=On(h.ticks.stepSize,1),x=m==="week"?f.isoWeekday:!1,w=xf(x)||x===!0,T={};let M=s,I,R;if(w&&(M=+r.startOf(M,"isoWeek",x)),M=+r.startOf(M,w?"day":m),r.diff(a,s,m)>1e5*y)throw new Error(s+" and "+a+" are too far apart with stepSize of "+y+" "+m);const O=h.ticks.source==="data"&&this.getDataTimestamps();for(I=M,R=0;I<a;I=+r.add(I,y,m),R++)sB(T,I,O);return(I===a||h.bounds==="ticks"||R===1)&&sB(T,I,O),Object.keys(T).sort(nB).map(N=>+N)}getLabelForValue(r){const s=this._adapter,a=this.options.time;return a.tooltipFormat?s.format(r,a.tooltipFormat):s.format(r,a.displayFormats.datetime)}format(r,s){const h=this.options.time.displayFormats,f=this._unit,m=s||h[f];return this._adapter.format(r,m)}_tickFormatFunction(r,s,a,h){const f=this.options,m=f.ticks.callback;if(m)return Lr(m,[r,s,a],this);const y=f.time.displayFormats,x=this._unit,w=this._majorUnit,T=x&&y[x],M=w&&y[w],I=a[s],R=w&&M&&I&&I.major;return this._adapter.format(r,h||(R?M:T))}generateTickLabels(r){let s,a,h;for(s=0,a=r.length;s<a;++s)h=r[s],h.label=this._tickFormatFunction(h.value,s,r)}getDecimalForValue(r){return r===null?NaN:(r-this.min)/(this.max-this.min)}getPixelForValue(r){const s=this._offsets,a=this.getDecimalForValue(r);return this.getPixelForDecimal((s.start+a)*s.factor)}getValueForPixel(r){const s=this._offsets,a=this.getDecimalForPixel(r)/s.factor-s.end;return this.min+a*(this.max-this.min)}_getLabelSize(r){const s=this.options.ticks,a=this.ctx.measureText(r).width,h=ha(this.isHorizontal()?s.maxRotation:s.minRotation),f=Math.cos(h),m=Math.sin(h),y=this._resolveTickFontOptions(0).size;return{w:a*f+y*m,h:a*m+y*f}}_getLabelCapacity(r){const s=this.options.time,a=s.displayFormats,h=a[s.unit]||a.millisecond,f=this._tickFormatFunction(r,0,oB(this,[r],this._majorUnit),h),m=this._getLabelSize(f),y=Math.floor(this.isHorizontal()?this.width/m.w:this.height/m.h)-1;return y>0?y:1}getDataTimestamps(){let r=this._cache.data||[],s,a;if(r.length)return r;const h=this.getMatchingVisibleMetas();if(this._normalized&&h.length)return this._cache.data=h[0].controller.getAllParsedValues(this);for(s=0,a=h.length;s<a;++s)r=r.concat(h[s].controller.getAllParsedValues(this));return this._cache.data=this.normalize(r)}getLabelTimestamps(){const r=this._cache.labels||[];let s,a;if(r.length)return r;const h=this.getLabels();for(s=0,a=h.length;s<a;++s)r.push(rB(this,h[s]));return this._cache.labels=this._normalized?r:this.normalize(r)}normalize(r){return n$(r.sort(nB))}}Ie(xg,"id","time"),Ie(xg,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function B0(e,r,s){let a=0,h=e.length-1,f,m,y,x;s?(r>=e[a].pos&&r<=e[h].pos&&({lo:a,hi:h}=Pl(e,"pos",r)),{pos:f,time:y}=e[a],{pos:m,time:x}=e[h]):(r>=e[a].time&&r<=e[h].time&&({lo:a,hi:h}=Pl(e,"time",r)),{time:f,pos:y}=e[a],{time:m,pos:x}=e[h]);const w=m-f;return w?y+(x-y)*(r-f)/w:y}class sA extends xg{constructor(r){super(r),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const r=this._getTimestampsForTable(),s=this._table=this.buildLookupTable(r);this._minPos=B0(s,this.min),this._tableRange=B0(s,this.max)-this._minPos,super.initOffsets(r)}buildLookupTable(r){const{min:s,max:a}=this,h=[],f=[];let m,y,x,w,T;for(m=0,y=r.length;m<y;++m)w=r[m],w>=s&&w<=a&&h.push(w);if(h.length<2)return[{time:s,pos:0},{time:a,pos:1}];for(m=0,y=h.length;m<y;++m)T=h[m+1],x=h[m-1],w=h[m],Math.round((T+x)/2)!==w&&f.push({time:w,pos:m/(y-1)});return f}_generate(){const r=this.min,s=this.max;let a=super.getDataTimestamps();return(!a.includes(r)||!a.length)&&a.splice(0,0,r),(!a.includes(s)||a.length===1)&&a.push(s),a.sort((h,f)=>h-f)}_getTimestampsForTable(){let r=this._cache.all||[];if(r.length)return r;const s=this.getDataTimestamps(),a=this.getLabelTimestamps();return s.length&&a.length?r=this.normalize(s.concat(a)):r=s.length?s:a,r=this._cache.all=r,r}getDecimalForValue(r){return(B0(this._table,r)-this._minPos)/this._tableRange}getValueForPixel(r){const s=this._offsets,a=this.getDecimalForPixel(r)/s.factor-s.end;return B0(this._table,a*this._tableRange+this._minPos,!0)}}Ie(sA,"id","timeseries"),Ie(sA,"defaults",xg.defaults);var igt=Object.freeze({__proto__:null,CategoryScale:eA,LinearScale:nA,LogarithmicScale:rA,RadialLinearScale:gm,TimeScale:xg,TimeSeriesScale:sA});const sgt=[hft,Vpt,Lmt,igt];la.register(...sgt);function ogt(){const e=Y.useRef(null);return Y.useEffect(()=>{const r=e.current.getContext("2d");new la(r,{type:"pie",data:{labels:["Red","Blue","Yellow"],datasets:[{data:[10,20,30],backgroundColor:["red","blue","yellow"]}]},options:{responsive:!0,maintainAspectRatio:!1}})},[]),D.jsx("div",{children:D.jsx("canvas",{ref:e})})}function agt(){const e=Y.useRef(null);return Y.useEffect(()=>{const r=e.current.getContext("2d");new la(r,{type:"bar",data:{labels:["Label 1","Label 2","Label 3"],datasets:[{label:"Dataset 1",data:[10,20,30],backgroundColor:"rgba(75, 192, 192, 0.2)",borderColor:"rgba(75, 192, 192, 1)",borderWidth:1}]},options:{responsive:!0,scales:{y:{beginAtZero:!0}}}})},[]),D.jsx("canvas",{ref:e})}function lgt(){const e=Y.useRef(null);return Y.useEffect(()=>{const r=e.current.getContext("2d");new la(r,{type:"line",data:{labels:["January","February","March","April","May","June","July"],datasets:[{label:"Sample Data",data:[65,59,80,81,56,55,40],fill:!1,borderColor:"rgb(75, 192, 192)",tension:.1}]},options:{responsive:!0,scales:{y:{beginAtZero:!0}}}})},[]),D.jsx("canvas",{ref:e})}const aB=[{name:"Dashboard",to:"/admin/dashboard",current:!1},{name:"Guidelines",to:"/admin/create/guidelines",current:!1},{name:"Contacts",to:"/admin/create/contacts",current:!1},{name:"Evacution",to:"/evacuation",current:!1},{name:"Annoucement",to:"/announcement",current:!1},{name:"Reports",to:"/admin/report",current:!1}];function rm(...e){return e.filter(Boolean).join(" ")}function IP(){const e=fC(),{currentUser:r}=Rh(a=>a.user),s=async()=>{try{e(U8());const h=await(await yn.get("/api/v1/logout")).data;if(h.success===!1){e(px(h.message)),navigate("/");return}e(V8(h))}catch(a){e(px(a.message))}};return D.jsx(hh,{as:"nav",className:"bg-gray-950",children:({open:a})=>D.jsxs(D.Fragment,{children:[D.jsx("div",{className:"mx-auto max-w-7xl px-2 sm:px-6 lg:px-8",children:D.jsxs("div",{className:"relative flex h-16 items-center justify-between",children:[D.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center sm:hidden",children:D.jsxs(hh.Button,{className:"relative inline-flex items-center justify-center rounded-md p-2 text-gray-400 hover:bg-gray-700 hover:text-white focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white",children:[D.jsx("span",{className:"absolute -inset-0.5"}),D.jsx("span",{className:"sr-only",children:"Open main menu"}),a?D.jsx(AV,{className:"block h-6 w-6","aria-hidden":"true"}):D.jsx(MV,{className:"block h-6 w-6","aria-hidden":"true"})]})}),D.jsxs("div",{className:"flex flex-1 items-center justify-center sm:items-stretch sm:justify-start",children:[D.jsx("div",{className:"flex flex-shrink-0 items-center",children:D.jsx("img",{className:"h-8 w-auto",src:Kv,alt:"Your Company"})}),D.jsx("div",{className:"hidden sm:ml-6 sm:block",children:D.jsx("div",{className:"flex space-x-4",children:aB.map(h=>D.jsx(qn,{to:h.to,className:rm(h.current?"bg-gray-900 text-white":"text-gray-300 hover:bg-gray-700 hover:text-white","rounded-md px-3 py-2 text-sm font-medium"),"aria-current":h.current?"page":void 0,children:h.name},h.name))})})]}),D.jsxs("div",{className:"absolute inset-y-0 right-0 flex items-center pr-2 sm:static sm:inset-auto sm:ml-6 sm:pr-0",children:[D.jsxs("button",{type:"button",className:"relative rounded-full bg-gray-800 p-1 text-gray-400 hover:text-white focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-gray-800",children:[D.jsx("span",{className:"absolute -inset-1.5"}),D.jsx("span",{className:"sr-only",children:"View notifications"}),D.jsx(ert,{className:"h-6 w-6","aria-hidden":"true"})]}),D.jsxs(Od,{as:"div",className:"relative ml-3",children:[D.jsx("div",{children:D.jsxs(Od.Button,{className:"relative flex rounded-full bg-gray-800 text-sm focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-gray-800",children:[D.jsx("span",{className:"absolute -inset-1.5"}),D.jsx("span",{className:"sr-only",children:"Open user menu"}),D.jsx("img",{className:"h-8 w-8 rounded-full",src:r.avatar,alt:"avatar"})]})}),D.jsx(qnt,{as:Y.Fragment,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:D.jsxs(Od.Items,{className:"absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white py-1 shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none",children:[D.jsx(Od.Item,{children:({active:h})=>D.jsx(qn,{to:"/admin/profile",className:rm(h?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700"),children:"Your Profile"})}),D.jsx(Od.Item,{children:({active:h})=>D.jsx(qn,{to:"#",className:rm(h?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700"),children:"Settings"})}),D.jsx(Od.Item,{children:({active:h})=>D.jsx(qn,{to:"/",onClick:s,className:rm(h?"bg-gray-100":"","block px-4 py-2 text-sm text-gray-700"),children:"Log out"})})]})})]})]})]})}),D.jsx(hh.Panel,{className:"sm:hidden",children:D.jsx("div",{className:"space-y-1 px-2 pb-3 pt-2",children:aB.map(h=>D.jsx(qn,{to:h.to,className:rm(h.current?"bg-gray-900 text-white":"text-gray-300 hover:bg-gray-700 hover:text-white","block rounded-md px-3 py-2 text-base font-medium"),"aria-current":h.current?"page":void 0,children:h.name},h.name))})})]})})}function cgt(){return Rh(e=>e.user),D.jsx("section",{className:"bg-white",children:D.jsx("div",{className:"mx-auto max-w-screen-xl px-4 py-12 sm:px-6 md:py-16 lg:px-8",children:D.jsx("div",{className:"mt-8 sm:mt-12",children:D.jsxs("dl",{className:"grid grid-cols-1 gap-4 sm:grid-cols-4",children:[D.jsxs("div",{className:"flex flex-col rounded-lg px-4 py-8 text-center",children:[D.jsx("dt",{className:"order-last text-lg font-medium text-gray-500",children:"Total Sales"}),D.jsx("dd",{className:"text-4xl font-extrabold text-red-600 md:text-5xl",children:"$4.8m"})]}),D.jsxs("div",{className:"flex flex-col rounded-lg px-4 py-8 text-center",children:[D.jsx("dt",{className:"order-last text-lg font-medium text-gray-500",children:"Official Addons"}),D.jsx("dd",{className:"text-4xl font-extrabold text-blue-600 md:text-5xl",children:"24"})]}),D.jsxs("div",{className:"flex flex-col rounded-lg px-4 py-8 text-center",children:[D.jsx("dt",{className:"order-last text-lg font-medium text-gray-500",children:"Total Addons"}),D.jsx("dd",{className:"text-4xl font-extrabold text-green-600 md:text-5xl",children:"86"})]}),D.jsxs("div",{className:"flex flex-col rounded-lg px-4 py-8 text-center",children:[D.jsx("dt",{className:"order-last text-lg font-medium text-gray-500",children:"Total Addons"}),D.jsx("dd",{className:"text-4xl font-extrabold text-yellow-600 md:text-5xl",children:"86"})]})]})})})})}function ugt(){return D.jsx("div",{className:"overflow-x-auto",children:D.jsxs("table",{className:"table",children:[D.jsx("thead",{children:D.jsxs("tr",{children:[D.jsx("th",{children:D.jsx("label",{children:D.jsx("input",{type:"checkbox",className:"checkbox"})})}),D.jsx("th",{children:"Name"}),D.jsx("th",{children:"Job"}),D.jsx("th",{children:"Favorite Color"}),D.jsx("th",{})]})}),D.jsxs("tbody",{children:[D.jsxs("tr",{children:[D.jsx("th",{children:D.jsx("label",{children:D.jsx("input",{type:"checkbox",className:"checkbox"})})}),D.jsx("td",{children:D.jsxs("div",{className:"flex items-center gap-3",children:[D.jsx("div",{className:"avatar",children:D.jsx("div",{className:"mask mask-squircle w-12 h-12",children:D.jsx("img",{src:"/tailwind-css-component-profile-2@56w.png",alt:"Avatar Tailwind CSS Component"})})}),D.jsxs("div",{children:[D.jsx("div",{className:"font-bold",children:"Hart Hagerty"}),D.jsx("div",{className:"text-sm opacity-50",children:"United States"})]})]})}),D.jsxs("td",{children:["Zemlak, Daniel and Leannon",D.jsx("br",{}),D.jsx("span",{className:"badge badge-ghost badge-sm",children:"Desktop Support Technician"})]}),D.jsx("td",{children:"Purple"}),D.jsx("th",{children:D.jsx("button",{className:"btn btn-ghost btn-xs",children:"details"})})]}),D.jsxs("tr",{children:[D.jsx("th",{children:D.jsx("label",{children:D.jsx("input",{type:"checkbox",className:"checkbox"})})}),D.jsx("td",{children:D.jsxs("div",{className:"flex items-center gap-3",children:[D.jsx("div",{className:"avatar",children:D.jsx("div",{className:"mask mask-squircle w-12 h-12",children:D.jsx("img",{src:"/tailwind-css-component-profile-3@56w.png",alt:"Avatar Tailwind CSS Component"})})}),D.jsxs("div",{children:[D.jsx("div",{className:"font-bold",children:"Brice Swyre"}),D.jsx("div",{className:"text-sm opacity-50",children:"China"})]})]})}),D.jsxs("td",{children:["Carroll Group",D.jsx("br",{}),D.jsx("span",{className:"badge badge-ghost badge-sm",children:"Tax Accountant"})]}),D.jsx("td",{children:"Red"}),D.jsx("th",{children:D.jsx("button",{className:"btn btn-ghost btn-xs",children:"details"})})]}),D.jsxs("tr",{children:[D.jsx("th",{children:D.jsx("label",{children:D.jsx("input",{type:"checkbox",className:"checkbox"})})}),D.jsx("td",{children:D.jsxs("div",{className:"flex items-center gap-3",children:[D.jsx("div",{className:"avatar",children:D.jsx("div",{className:"mask mask-squircle w-12 h-12",children:D.jsx("img",{src:"/tailwind-css-component-profile-4@56w.png",alt:"Avatar Tailwind CSS Component"})})}),D.jsxs("div",{children:[D.jsx("div",{className:"font-bold",children:"Marjy Ferencz"}),D.jsx("div",{className:"text-sm opacity-50",children:"Russia"})]})]})}),D.jsxs("td",{children:["Rowe-Schoen",D.jsx("br",{}),D.jsx("span",{className:"badge badge-ghost badge-sm",children:"Office Assistant I"})]}),D.jsx("td",{children:"Crimson"}),D.jsx("th",{children:D.jsx("button",{className:"btn btn-ghost btn-xs",children:"details"})})]}),D.jsxs("tr",{children:[D.jsx("th",{children:D.jsx("label",{children:D.jsx("input",{type:"checkbox",className:"checkbox"})})}),D.jsx("td",{children:D.jsxs("div",{className:"flex items-center gap-3",children:[D.jsx("div",{className:"avatar",children:D.jsx("div",{className:"mask mask-squircle w-12 h-12",children:D.jsx("img",{src:"/tailwind-css-component-profile-5@56w.png",alt:"Avatar Tailwind CSS Component"})})}),D.jsxs("div",{children:[D.jsx("div",{className:"font-bold",children:"Yancy Tear"}),D.jsx("div",{className:"text-sm opacity-50",children:"Brazil"})]})]})}),D.jsxs("td",{children:["Wyman-Ledner",D.jsx("br",{}),D.jsx("span",{className:"badge badge-ghost badge-sm",children:"Community Outreach Specialist"})]}),D.jsx("td",{children:"Indigo"}),D.jsx("th",{children:D.jsx("button",{className:"btn btn-ghost btn-xs",children:"details"})})]})]}),D.jsx("tfoot",{children:D.jsxs("tr",{children:[D.jsx("th",{}),D.jsx("th",{children:"Name"}),D.jsx("th",{children:"Job"}),D.jsx("th",{children:"Favorite Color"}),D.jsx("th",{})]})})]})})}const hgt=()=>D.jsx("div",{className:"h-auto w-full bg-gray-950 text-red-50",children:D.jsx(dgt,{})}),dgt=()=>{const[e,r]=Y.useState(ggt);return D.jsxs("div",{className:"flex h-full w-full gap-3 overflow-scroll p-12",children:[D.jsx(j0,{title:"Backlog",column:"backlog",headingColor:"text-red-500",cards:e,setCards:r}),D.jsx(j0,{title:"TODO",column:"todo",headingColor:"text-yellow-500",cards:e,setCards:r}),D.jsx(j0,{title:"In progress",column:"doing",headingColor:"text-blue-500",cards:e,setCards:r}),D.jsx(j0,{title:"Complete",column:"done",headingColor:"text-emerald-500",cards:e,setCards:r}),D.jsx(pgt,{setCards:r})]})},j0=({title:e,headingColor:r,cards:s,column:a,setCards:h})=>{const[f,m]=Y.useState(!1),y=(G,$)=>{G.dataTransfer.setData("cardId",$.id)},x=G=>{const $=G.dataTransfer.getData("cardId");m(!1),T();const z=R(),{element:B}=I(G,z),H=B.dataset.before||"-1";if(H!==$){let K=[...s],at=K.find(et=>et.id===$);if(!at)return;if(at={...at,column:a},K=K.filter(et=>et.id!==$),H==="-1")K.push(at);else{const et=K.findIndex(nt=>nt.id===H);if(et===void 0)return;K.splice(et,0,at)}h(K)}},w=G=>{G.preventDefault(),M(G),m(!0)},T=G=>{(G||R()).forEach(z=>{z.style.opacity="0"})},M=G=>{const $=R();T($);const z=I(G,$);z.element.style.opacity="1"},I=(G,$)=>$.reduce((H,K)=>{const at=K.getBoundingClientRect(),ft=G.clientY-(at.top+50);return ft<0&&ft>H.offset?{offset:ft,element:K}:H},{offset:Number.NEGATIVE_INFINITY,element:$[$.length-1]}),R=()=>Array.from(document.querySelectorAll(`[data-column="${a}"]`)),O=()=>{T(),m(!1)},N=s.filter(G=>G.column===a);return D.jsxs("div",{className:"w-56 shrink-0",children:[D.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[D.jsx("h3",{className:`font-medium ${r}`,children:e}),D.jsx("span",{className:"rounded text-sm text-neutral-400",children:N.length})]}),D.jsxs("div",{onDrop:x,onDragOver:w,onDragLeave:O,className:`h-full w-full transition-colors ${f?"bg-neutral-800/50":"bg-neutral-800/0"}`,children:[N.map(G=>D.jsx(fgt,{...G,handleDragStart:y},G.id)),D.jsx(G$,{beforeId:null,column:a}),D.jsx(mgt,{column:a,setCards:h})]})]})},fgt=({title:e,id:r,column:s,handleDragStart:a})=>D.jsxs(D.Fragment,{children:[D.jsx(G$,{beforeId:r,column:s}),D.jsx(lx.div,{layout:!0,layoutId:r,draggable:"true",onDragStart:h=>a(h,{title:e,id:r,column:s}),className:"cursor-grab rounded border border-neutral-700 bg-white p-3 active:cursor-grabbing",children:D.jsx("p",{className:"text-sm text-black",children:e})})]}),G$=({beforeId:e,column:r})=>D.jsx("div",{"data-before":e||"-1","data-column":r,className:"my-0.5 h-0.5 w-full bg-red-400 opacity-0"}),pgt=({setCards:e})=>{const[r,s]=Y.useState(!1),a=m=>{m.preventDefault(),s(!0)},h=()=>{s(!1)},f=m=>{const y=m.dataTransfer.getData("cardId");e(x=>x.filter(w=>w.id!==y)),s(!1)};return D.jsx("div",{onDrop:f,onDragOver:a,onDragLeave:h,className:`mt-10 grid h-56 w-56 shrink-0 place-content-center rounded border text-3xl ${r?"border-red-800 bg-red-800/20 text-red-500":"border-neutral-500 bg-neutral-500/20 text-neutral-500"}`,children:r?D.jsx(Frt,{className:"animate-bounce"}):D.jsx(Nut,{})})},mgt=({column:e,setCards:r})=>{const[s,a]=Y.useState(""),[h,f]=Y.useState(!1),m=y=>{if(y.preventDefault(),!s.trim().length)return;const x={column:e,title:s.trim(),id:Math.random().toString()};r(w=>[...w,x]),f(!1)};return D.jsx(D.Fragment,{children:h?D.jsxs(lx.form,{layout:!0,onSubmit:m,children:[D.jsx("textarea",{onChange:y=>a(y.target.value),autoFocus:!0,placeholder:"Add new task...",className:"w-full rounded border border-red-400 bg-violet-400/20 p-3 text-sm text-neutral-50 placeholder-red-300 focus:outline-0"}),D.jsxs("div",{className:"mt-1.5 flex items-center justify-end gap-1.5",children:[D.jsx("button",{onClick:()=>f(!1),className:"px-3 py-1.5 text-xs text-neutral-400 transition-colors hover:text-neutral-50",children:"Close"}),D.jsxs("button",{type:"submit",className:"flex items-center gap-1.5 rounded bg-neutral-50 px-3 py-1.5 text-xs text-neutral-950 transition-colors hover:bg-neutral-300",children:[D.jsx("span",{children:"Add"}),D.jsx(LN,{})]})]})]}):D.jsxs(lx.button,{layout:!0,onClick:()=>f(!0),className:"flex w-full items-center gap-1.5 px-3 py-1.5 text-xs text-neutral-400 transition-colors hover:text-neutral-50",children:[D.jsx("span",{children:"Add card"}),D.jsx(LN,{})]})})},ggt=[{title:"Look into render bug in dashboard",id:"1",column:"backlog"},{title:"SOX compliance checklist",id:"2",column:"backlog"},{title:"[SPIKE] Migrate to Azure",id:"3",column:"backlog"},{title:"Document Notifications service",id:"4",column:"backlog"},{title:"Research DB options for new microservice",id:"5",column:"todo"},{title:"Postmortem for outage",id:"6",column:"todo"},{title:"Sync with product on Q3 roadmap",id:"7",column:"todo"},{title:"Refactor context providers to use Zustand",id:"8",column:"doing"},{title:"Add logging to daily CRON",id:"9",column:"doing"},{title:"Set up DD dashboards for Lambda listener",id:"10",column:"done"}];function _gt(){return D.jsxs("div",{children:[D.jsx(IP,{}),D.jsxs("div",{children:[D.jsx("h1",{className:"m-10 text-3xl font-bold",children:"Dashboard"}),D.jsx(cgt,{})]}),D.jsx("div",{className:"divider"}),D.jsx("h1",{className:"m-10 text-3xl font-bold",children:"Graphs"}),D.jsxs("div",{className:"grid grid-cols-3 gap-4 py-10 mx-auto m-auto rounded-md",children:[D.jsx("div",{className:" rounded-md ml-3",children:D.jsx(ogt,{})}),D.jsx("div",{className:" rounded-md m-3",children:D.jsx(agt,{})}),D.jsx("div",{className:" rounded-md mr-3",children:D.jsx(lgt,{})})]}),D.jsx("div",{children:D.jsx(hgt,{})}),D.jsx("h1",{className:"m-10 text-3xl font-bold",children:"Reports"}),D.jsx(ugt,{className:"m-10"})]})}function ygt(){return Rh(e=>e.user),D.jsxs("div",{className:"flex",children:[D.jsx("section",{className:"fixed left-0 top-0 bottom-0 w-64 bg-white overflow-y-auto border-r border-gray-200",children:D.jsx(vu,{})}),D.jsx("div",{className:"border-blue-700 w-10 h-10"})]})}function W$(){const[e,r]=Y.useState([]),[s,a]=Y.useState(1),[h,f]=Y.useState(1),[m]=Y.useState(7);Y.useEffect(()=>{y()},[s]);const y=async()=>{try{const T=await yn.get(`/api/v1/guidelines?page=${s}&limit=${m}`);r(T.data.guidelines),f(T.data.totalPages)}catch(T){console.error("Error fetching guidelines:",T)}},x=async T=>{try{await yn.delete(`/api/v1/guidelines/${T}`),r(e.filter(M=>M._id!==T))}catch(M){console.error("Error deleting guideline:",M)}},w=T=>{a(T)};return D.jsx("div",{className:"w-full mx-auto mt-8 flex justify-center",children:D.jsxs("div",{className:"overflow-x-auto",children:[D.jsxs("table",{className:"table-auto w-full text-sm",children:[D.jsx("thead",{children:D.jsxs("tr",{children:[D.jsx("th",{className:"px-4 py-1",children:"Name"}),D.jsx("th",{className:"px-4 py-2",children:"Description"}),D.jsx("th",{className:"px-4 py-2",children:"Image"}),D.jsx("th",{className:"px-4 py-2",children:"Steps"}),D.jsx("th",{className:"px-4 py-2",children:"Actions"})]})}),D.jsx("tbody",{children:e.map(T=>D.jsxs("tr",{children:[D.jsx("td",{className:"border px-4 py-2",children:T.name}),D.jsx("td",{className:"border px-4 py-2",children:T.description}),D.jsx("td",{className:"border px-4 py-2",children:D.jsx("img",{src:T.image,alt:T.name,className:"h-10 w-10 object-cover"})}),D.jsx("td",{className:"border px-4 py-2",children:D.jsx(qn,{to:`/admin/guidelines/${T._id}`,className:"bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600",children:"Steps"})}),D.jsx("td",{className:"border px-4 py-2",children:D.jsxs("div",{className:"flex ",children:[D.jsx(qn,{to:`/admin/update/guidelines/${T._id}`,className:"mr-2 text-blue-500",children:D.jsx(DV,{})}),D.jsx("button",{onClick:()=>x(T._id),className:"text-red-500",children:D.jsx(RV,{})})]})})]},T._id))})]}),D.jsx("div",{className:"flex justify-center mt-4",children:Array.from({length:h},(T,M)=>D.jsx("button",{onClick:()=>w(M+1),className:`mx-1 px-3 py-1 rounded ${s===M+1?"bg-gray-800 text-white":"bg-gray-200 text-gray-800"}`,children:M+1},M+1))})]})})}function vgt(){const[e,r]=Y.useState(!1),[s,a]=Y.useState({name:"",description:"",image:null,category:""}),[h,f]=Y.useState([]),m=$l();Y.useEffect(()=>{y()},[]);const y=async()=>{try{const T=await yn.get("/api/v1/categories");f(T.data)}catch(T){console.error("Error fetching categories:",T)}},x=T=>{const{name:M,value:I,files:R}=T.target;a(O=>({...O,[M]:M==="image"?R[0]:I}))},w=async T=>{T.preventDefault(),r(!0);const M=new FormData;M.append("name",s.name),M.append("description",s.description),M.append("image",s.image),M.append("category",s.category);try{const I=await yn.post("/api/v1/guidelines",M,{headers:{"Content-Type":"multipart/form-data"}});fr.success("Guideline created successfully"),console.log("Guideline created:",I.data),r(!1),a({name:"",description:"",image:null,category:""}),m("/admin/create/guidelines")}catch(I){fr.error("Error creating guideline"),console.error("Error creating guideline:",I)}};return D.jsxs(D.Fragment,{children:[D.jsx(IP,{}),D.jsx("div",{className:"flex",children:D.jsxs("div",{className:"w-full m-3",children:[D.jsx(dP,{}),D.jsx("h1",{className:"text-3xl font-bold mb-3 text-center",children:"Guidelines"}),D.jsxs("div",{className:"flex flex-col md:flex-row border rounded p-4",children:[" ",D.jsx("div",{className:"md:mr-5 flex-1 mb-5 md:mb-0",children:D.jsxs("form",{onSubmit:w,className:"space-y-4 text-sm",children:[D.jsx("h1",{className:"text-3xl font-bold mb-3 text-center",children:"CREATE GUIDELINES"}),D.jsxs("div",{children:[D.jsx("label",{className:"block mb-1 font-semibold",children:"Name:"}),D.jsx("input",{type:"text",name:"name",value:s.name,onChange:x,className:"w-full px-3 py-2 border rounded",required:!0})]}),D.jsxs("div",{children:[D.jsx("label",{className:"block mb-1 font-semibold",children:"Description:"}),D.jsx("textarea",{name:"description",value:s.description,onChange:x,className:"w-full px-3 py-2 border rounded",rows:"4",required:!0})]}),D.jsxs("div",{children:[D.jsx("label",{className:"block mb-1 font-semibold",children:"Image:"}),D.jsx("input",{type:"file",name:"image",accept:"image/*",onChange:x,className:"w-full px-3 py-2 border rounded",required:!0})]}),D.jsxs("div",{children:[D.jsx("label",{className:"block mb-1 font-semibold",children:"Category:"}),D.jsxs("select",{name:"category",value:s.category,onChange:x,className:"w-full px-3 py-2 border rounded",required:!0,children:[D.jsx("option",{value:"",children:"Select Category"}),h.map(T=>D.jsx("option",{value:T._id,children:T.name},T._id))]})]}),D.jsx("button",{type:"submit",disabled:e,className:`bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 w-full md:w-auto ${e?"opacity-50 cursor-not-allowed":""}`,children:e?"Creating...":"Create Guideline"})]})}),D.jsx("div",{className:"flex-1 border-t mt-5 md:mt-0 md:border-t-0 md:border-l md:pl-5",children:D.jsx("div",{children:D.jsx(W$,{})})})]})]})})]})}function xgt(){const{guidelineId:e}=Cf(),[r,s]=Y.useState({name:"",description:"",image:null,category:""}),[a,h]=Y.useState([]),[f,m]=Y.useState(null),y=$l();Y.useEffect(()=>{x(),w()},[]);const x=async()=>{try{const R=await yn.get("/api/v1/categories");h(R.data)}catch(R){console.error("Error fetching categories:",R)}},w=async()=>{try{const R=await yn.get(`/api/v1/guidelines/${e}`),{name:O,description:N,image:G,category:$}=R.data;s({name:O,description:N,image:G,category:$}),G&&m(G)}catch(R){console.error("Error fetching guideline data:",R)}},T=R=>{const{name:O,value:N,files:G}=R.target;if(O==="image"&&G.length>0){const $=new FileReader;$.onload=()=>{m($.result)},$.readAsDataURL(G[0])}s($=>({...$,[O]:O==="image"?G[0]:N}))};console.log(r.image);const M=()=>{s(R=>({...R,image:null})),m(null)},I=async R=>{R.preventDefault();const O=new FormData;O.append("name",r.name),O.append("description",r.description),O.append("image",r.image),O.append("category",r.category);try{const N=await yn.put(`/api/v1/guidelines/${e}`,O,{headers:{"Content-Type":"multipart/form-data"}});console.log("Guideline updated:",N.data),y("/admin/create/guidelines")}catch(N){console.error("Error updating guideline:",N)}};return D.jsxs("div",{className:"flex",children:[D.jsx("section",{className:"fixed left-0 top-0 bottom-0 w-64 bg-white overflow-y-auto border-r border-gray-200",children:D.jsx(vu,{})}),D.jsxs("div",{className:"flex-1 ml-64 mr-4 mt-8 p-4 rounded shadow",children:[D.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Update Guidelines"}),D.jsxs("form",{onSubmit:I,className:"space-y-4",children:[D.jsxs("div",{children:[D.jsx("label",{className:"block mb-1 font-semibold",children:"Name:"}),D.jsx("input",{type:"text",name:"name",value:r.name,onChange:T,className:"w-full px-3 py-2 border rounded",required:!0})]}),D.jsxs("div",{children:[D.jsx("label",{className:"block mb-1 font-semibold",children:"Description:"}),D.jsx("textarea",{name:"description",value:r.description,onChange:T,className:"w-full px-3 py-2 border rounded",rows:"4",required:!0})]}),D.jsxs("div",{children:[D.jsx("label",{className:"block mb-1 font-semibold",children:"Image:"}),D.jsx("input",{type:"file",name:"image",accept:"image/*",onChange:T,className:"w-full px-3 py-2 border rounded"}),f&&D.jsxs("div",{className:"mt-2",children:[D.jsx("img",{src:f,alt:"Preview",className:"max-w-20 h-auto"}),D.jsx("button",{type:"button",onClick:M,className:"text-red-500 mt-2",children:"Remove Image"})]})]}),D.jsxs("div",{children:[D.jsx("label",{className:"block mb-1 font-semibold",children:"Category:"}),D.jsxs("select",{name:"category",value:r.category,onChange:T,className:"w-full px-3 py-2 border rounded",required:!0,children:[D.jsx("option",{value:"",children:"Select Category"}),a.map(R=>D.jsx("option",{value:R._id,children:R.name},R._id))]})]}),D.jsx("button",{type:"submit",className:"bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600",children:"Update Guideline"})]})]})]})}function bgt(e){return ms({tag:"svg",attr:{viewBox:"0 0 1024 1024",fill:"currentColor",fillRule:"evenodd"},child:[{tag:"path",attr:{d:"M799.855 166.312c.023.007.043.018.084.059l57.69 57.69c.041.041.052.06.059.084a.118.118 0 0 1 0 .069c-.007.023-.018.042-.059.083L569.926 512l287.703 287.703c.041.04.052.06.059.083a.118.118 0 0 1 0 .07c-.007.022-.018.042-.059.083l-57.69 57.69c-.041.041-.06.052-.084.059a.118.118 0 0 1-.069 0c-.023-.007-.042-.018-.083-.059L512 569.926 224.297 857.629c-.04.041-.06.052-.083.059a.118.118 0 0 1-.07 0c-.022-.007-.042-.018-.083-.059l-57.69-57.69c-.041-.041-.052-.06-.059-.084a.118.118 0 0 1 0-.069c.007-.023.018-.042.059-.083L454.073 512 166.371 224.297c-.041-.04-.052-.06-.059-.083a.118.118 0 0 1 0-.07c.007-.022.018-.042.059-.083l57.69-57.69c.041-.041.06-.052.084-.059a.118.118 0 0 1 .069 0c.023.007.042.018.083.059L512 454.073l287.703-287.702c.04-.041.06-.052.083-.059a.118.118 0 0 1 .07 0Z"},child:[]}]})(e)}function H$(e){return ms({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"},child:[]}]})(e)}function q$(e){return ms({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 0 0 0-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 0 0 9.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"},child:[]}]})(e)}function wgt(){return D.jsx("div",{className:"flex-col gap-4 w-full flex items-center justify-center",children:D.jsx("div",{className:"w-28 h-28 border-8 text-red-400 text-4xl animate-spin border-gray-300 flex items-center justify-center border-t-red-400 rounded-full",children:D.jsx("img",{src:Kv,alt:"Vite Logo",className:"animate-ping w-5"})})})}function Sgt(){const{guidelineId:e}=Cf(),[r,s]=Y.useState({}),[a,h]=Y.useState([]),[f,m]=Y.useState(!0),[y,x]=Y.useState(null),[w,T]=Y.useState(!1),[M,I]=Y.useState(!1),[R,O]=Y.useState({stepNumber:"",description:"",image:null,guideline:""});Y.useEffect(()=>{(async()=>{try{const B=await yn.get(`/api/v1/guidelines/${e}/steps`),{guideline:H,steps:K}=B.data;s(H),h(K),m(!1)}catch(B){x(B),m(!1)}})()},[e]);const N=z=>{const{name:B,value:H,files:K}=z.target;O(at=>({...at,[B]:B==="image"?K[0]:H}))},G=async z=>{z.preventDefault();const B=new FormData;B.append("stepNumber",R.stepNumber),B.append("description",R.description),B.append("image",R.image),B.append("guideline",e);try{I(!0),console.log(e);const H=await yn.post("/api/v1/steps",B,{headers:{"Content-Type":"multipart/form-data"}});h([...a,H.data]),T(!1),I(!1)}catch(H){console.error("Error creating step:",H),I(!1)}},$=async z=>{try{await yn.delete(`/api/v1/steps/${z}`),h(a.filter(B=>B._id!==z))}catch(B){console.error("Error deleting step:",B)}};return f?D.jsx("div",{className:"flex justify-center items-center h-screen",children:D.jsx(wgt,{})}):y?D.jsxs("div",{children:["Error: ",y.message]}):D.jsxs("div",{className:"flex",children:[D.jsx("section",{className:"fixed left-0 top-0 bottom-0 w-64 bg-white overflow-y-auto border-r border-gray-200",children:D.jsx(vu,{})}),D.jsx("div",{className:"flex-1 ml-64 mr-4 mt-8 p-4",children:D.jsxs("div",{className:"w-full h-auto bg-white rounded-lg shadow-md p-4",children:[D.jsx("h2",{className:"text-xl font-bold mb-4",children:r.name}),D.jsx("p",{className:"mb-4",children:r.description}),r&&D.jsx("img",{src:r.image,alt:r.name,className:"w-10"}),w&&D.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:[D.jsx("div",{className:"absolute inset-0 bg-gray-900 opacity-50"}),D.jsxs("div",{className:"bg-white p-8 rounded-lg z-10 relative",children:[" ",D.jsxs("div",{className:"absolute top-2 right-2",children:[" ",D.jsx(bgt,{size:24,onClick:()=>T(!1),className:"cursor-pointer"})]}),D.jsx("h2",{className:"text-xl font-bold mb-4",children:"Add New Step"}),D.jsxs("form",{onSubmit:G,children:[D.jsxs("div",{className:"mb-4",children:[D.jsx("label",{htmlFor:"stepNumber",className:"block text-sm font-semibold mb-1",children:"Step no.:"}),D.jsx("input",{type:"number",id:"stepNumber",name:"stepNumber",value:R.stepNumber,onChange:N,className:"w-full px-3 py-2 border rounded",required:!0}),D.jsx("label",{htmlFor:"description",className:"block text-sm font-semibold mb-1",children:"Description:"}),D.jsx("input",{type:"text",id:"description",name:"description",value:R.description,onChange:N,className:"w-full px-3 py-2 border rounded",required:!0})]}),D.jsxs("div",{className:"mb-4",children:[D.jsx("label",{htmlFor:"image",className:"block text-sm font-semibold mb-1",children:"Image:"}),D.jsx("input",{type:"file",id:"image",name:"image",onChange:N,className:"w-full px-3 py-2 border rounded",accept:"image/*",required:!0})]}),D.jsxs("button",{type:"submit",className:"bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600",disabled:M,children:[M?"Adding...":"Add Step"," "]})]})]})]}),D.jsxs("div",{className:"w-full h-64 border-dotted border-2 border-red-400 flex flex-col justify-center items-center mt-4",children:[D.jsx("div",{className:"text-6xl text-red-400 font-bold",onClick:()=>T(!0),children:"+"}),D.jsx("div",{className:"text-lg text-red-600 mt-2",children:"Add Steps"})]}),D.jsx("h3",{className:"mt-4 mb-2",children:"Steps"}),D.jsx("ul",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4",children:a.map(z=>D.jsxs("li",{className:"bg-gray-100 rounded-lg p-4 relative",children:[D.jsxs("h2",{className:"text-lg font-semibold",children:["Step: ",z.stepNumber]}),D.jsx("p",{className:"mb-2",children:z.description}),z.imageUrl&&D.jsx("img",{src:z.imageUrl,alt:z.imageUrl,className:"w-full mb-2 rounded-md"}),D.jsxs("div",{className:"absolute top-2 right-2 flex space-x-2",children:[D.jsx(qn,{to:`/admin/update/steps/${z._id}`,className:"text-blue-500 hover:text-blue-700",children:D.jsx(q$,{className:"text-blue-500"})}),D.jsx("button",{onClick:()=>$(z._id),className:"text-red-500 hover:text-red-700",children:D.jsx(H$,{className:"text-red-500"})})]})]},z._id))})]})})]})}function Tgt(){return D.jsx("div",{children:"CreateSteps"})}function Egt(){const e=$l(),{stepId:r}=Cf(),[s,a]=Y.useState({}),[h,f]=Y.useState(!0),[m,y]=Y.useState(null),[x,w]=Y.useState({stepNumber:"",description:"",image:null,guideline:""}),[T,M]=Y.useState("");Y.useEffect(()=>{(async()=>{try{const G=await yn.get(`/api/v1/steps/${r}`);a(G.data),w({stepNumber:G.data.stepNumber,description:G.data.description,image:G.data.imageUrl,guideline:G.data.guideline}),f(!1),G.data.imageUrl&&M(G.data.imageUrl)}catch(G){y(G),f(!1)}})()},[r]);const I=N=>{const{name:G,value:$,files:z}=N.target;if(G==="image"){const B=z[0];w(K=>({...K,image:B}));const H=new FileReader;H.onload=()=>{H.readyState===2&&M(H.result)},H.readAsDataURL(B)}else w(B=>({...B,[G]:$}))},R=()=>{w(N=>({...N,image:null})),M("")},O=async N=>{N.preventDefault();const G=new FormData;G.append("stepNumber",x.stepNumber),G.append("description",x.description),G.append("image",x.image),G.append("guideline",s.guideline);try{const $=await yn.put(`/api/v1/steps/${r}`,G,{headers:{"Content-Type":"multipart/form-data"}});a($.data),e(`/admin/guidelines/${s.guideline}`)}catch($){console.error("Error updating step:",$)}};return h?D.jsx("div",{children:"Loading..."}):m?D.jsxs("div",{children:["Error: ",m.message]}):D.jsxs("div",{className:"max-w-lg mx-auto mt-8 p-4 bg-gray-100 rounded shadow",children:[D.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Update Steps"}),D.jsxs("form",{onSubmit:O,className:"space-y-4",children:[D.jsxs("div",{children:[D.jsx("label",{className:"block mb-1 font-semibold",children:"Step Number:"}),D.jsx("input",{type:"number",name:"stepNumber",value:x.stepNumber,onChange:I,className:"w-full px-3 py-2 border rounded",required:!0})]}),D.jsxs("div",{children:[D.jsx("label",{className:"block mb-1 font-semibold",children:"Description:"}),D.jsx("textarea",{name:"description",value:x.description,onChange:I,className:"w-full px-3 py-2 border rounded",rows:"4",required:!0})]}),D.jsxs("div",{children:[D.jsx("label",{className:"block mb-1 font-semibold",children:"Image:"}),D.jsx("input",{type:"file",name:"image",accept:"image/*",onChange:I,className:"w-full px-3 py-2 border rounded"}),T&&D.jsxs("div",{className:"mt-2 flex items-center",children:[D.jsx("img",{src:T,alt:"Image Preview",className:"w-20 h-20 mr-2 rounded"}),D.jsx("button",{type:"button",onClick:R,className:"px-2 py-1 bg-red-500 text-white rounded hover:bg-red-600",children:"Remove Image"})]})]}),D.jsx("button",{type:"submit",className:"bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600",children:"Update"})]})]})}function Mgt(){const[e,r]=Y.useState([]);Y.useEffect(()=>{s()},[]);const s=async()=>{try{const h=await yn.get("/api/v1/contacts");r(h.data)}catch(h){console.error("Error fetching contacts:",h)}},a=async h=>{try{await yn.delete(`/api/v1/contacts/${h}`),r(e.filter(f=>f._id!==h))}catch(f){console.error("Error deleting contacts:",f)}};return D.jsx("div",{className:"max-w-4xl mx-auto mt-8",children:D.jsx("div",{className:"overflow-x-auto",children:D.jsxs("table",{className:"table-auto w-full text-sm",children:[D.jsx("thead",{children:D.jsxs("tr",{children:[D.jsx("th",{className:"px-4 py-2",children:"Name"}),D.jsx("th",{className:"px-4 py-2",children:"Description"}),D.jsx("th",{className:"px-4 py-2",children:"Phone"}),D.jsx("th",{className:"px-4 py-2",children:"Image"}),D.jsx("th",{className:"px-4 py-2",children:"Actions"})]})}),D.jsx("tbody",{children:e.map(h=>D.jsxs("tr",{children:[D.jsx("td",{className:"border px-4 py-2",children:h.name}),D.jsx("td",{className:"border px-4 py-2",children:h.description}),D.jsx("td",{className:"border px-4 py-2",children:h.phone}),D.jsx("td",{className:"border px-4 py-2",children:D.jsx("img",{src:h.image,alt:h.name,className:"h-10 w-10 object-cover"})}),D.jsx("td",{className:"border px-4 py-2",children:D.jsxs("div",{className:"flex",children:[D.jsx(qn,{to:`/admin/update/contacts/${h._id}`,className:"mr-2",children:D.jsx(q$,{className:"text-blue-500"})}),D.jsx("button",{onClick:()=>a(h._id),children:D.jsx(H$,{className:"text-red-500"})})]})})]},h._id))})]})})})}function Agt(){const[e,r]=Y.useState({name:"",description:"",phone:"",image:null,category:""}),[s,a]=Y.useState([]);Y.useEffect(()=>{h()},[]);const h=async()=>{try{const y=await yn.get("/api/v2/categories");a(y.data)}catch(y){console.error("Error fetching categories:",y)}},f=y=>{const{name:x,value:w,files:T}=y.target;r(M=>({...M,[x]:x==="image"?T[0]:w}))},m=async y=>{y.preventDefault();const x=new FormData;x.append("name",e.name),x.append("description",e.description),x.append("phone",e.phone),x.append("image",e.image),x.append("category",e.category);try{const w=await yn.post("/api/v1/contacts",x,{headers:{"Content-Type":"multipart/form-data"}});console.log("Contacts created:",w.data)}catch(w){console.error("Error creating contact:",w)}};return D.jsxs("div",{className:"flex",children:[D.jsx("section",{className:"fixed left-0 top-0 bottom-0 w-64 bg-white overflow-y-auto border-r border-gray-200",children:D.jsx(vu,{})}),D.jsxs("div",{className:"flex-1 ml-64 mr-4 mt-8 p-4 rounded shadow",children:[D.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Create Contacts"}),D.jsxs("form",{onSubmit:m,className:"space-y-4",children:[D.jsxs("div",{children:[D.jsx("label",{className:"block mb-1 font-semibold",children:"Name:"}),D.jsx("input",{type:"text",name:"name",value:e.name,onChange:f,className:"w-full px-3 py-2 border rounded",required:!0})]}),D.jsxs("div",{children:[D.jsx("label",{className:"block mb-1 font-semibold",children:"Description:"}),D.jsx("textarea",{name:"description",value:e.description,onChange:f,className:"w-full px-3 py-2 border rounded",rows:"4",required:!0})]}),D.jsxs("div",{children:[D.jsx("label",{className:"block mb-1 font-semibold",children:"Phone:"}),D.jsx("input",{name:"phone",value:e.phone,onChange:f,className:"w-full px-3 py-2 border rounded",rows:"4",required:!0})]}),D.jsxs("div",{children:[D.jsx("label",{className:"block mb-1 font-semibold",children:"Image:"}),D.jsx("input",{type:"file",name:"image",accept:"image/*",onChange:f,className:"w-full px-3 py-2 border rounded",required:!0})]}),D.jsxs("div",{children:[D.jsx("label",{className:"block mb-1 font-semibold",children:"Category:"}),D.jsxs("select",{name:"category",value:e.category,onChange:f,className:"w-full px-3 py-2 border rounded",required:!0,children:[D.jsx("option",{value:"",children:"Select Category"}),s.map(y=>D.jsx("option",{value:y._id,children:y.name},y._id))]})]}),D.jsx("button",{type:"submit",className:"bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600",children:"Create Guideline"})]})]}),D.jsx("div",{children:D.jsx(Mgt,{})})]})}function aE(){const e=$l(),{categoryId:r}=Cf(),[s,a]=Y.useState({name:"",short_description:"",description:"",image:null}),[h,f]=Y.useState(null);Y.useEffect(()=>{async function w(){try{const T=await yn.get(`/api/v2/categories/${r}`),{name:M,short_description:I,description:R,image:O}=T.data;a({name:M,short_description:I,description:R,image:O}),O&&f(O)}catch(T){console.error("Error fetching category details:",T)}}w()},[r]);const m=w=>{const{name:T,value:M,files:I}=w.target;if(T==="image"&&I.length>0){const R=new FileReader;R.onload=()=>{f(R.result)},R.readAsDataURL(I[0])}a(R=>({...R,[T]:T==="image"?I[0]:M}))},y=()=>{a(w=>({...w,image:null})),f(null)},x=async w=>{w.preventDefault();const T=new FormData;T.append("name",s.name),T.append("short_description",s.short_description),T.append("description",s.description),T.append("image",s.image);try{const M=await yn.put(`/api/v2/categories/${r}`,T,{headers:{"Content-Type":"multipart/form-data"}});console.log("Category updated:",M.data),e("/admin/create/category/contacts"),a({name:"",short_description:"",description:"",image:null}),f(null)}catch(M){console.error("Error updating category:",M)}};return D.jsxs("div",{className:"flex",children:[D.jsx("section",{className:"fixed left-0 top-0 bottom-0 w-64 bg-white overflow-y-auto border-r border-gray-200",children:D.jsx(vu,{})}),D.jsxs("div",{className:"flex-1 ml-64 mr-4 mt-8 p-4 rounded shadow",children:[D.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Update Contacts Category"}),D.jsxs("form",{onSubmit:x,className:"space-y-4",children:[D.jsxs("div",{children:[D.jsx("label",{className:"block mb-1 font-semibold",children:"Name:"}),D.jsx("input",{type:"text",name:"name",value:s.name,onChange:m,className:"w-full px-3 py-2 border rounded",required:!0})]}),D.jsxs("div",{children:[D.jsx("label",{className:"block mb-1 font-semibold",children:"Short Description:"}),D.jsx("textarea",{name:"short_description",value:s.short_description,onChange:m,className:"w-full px-3 py-2 border rounded",rows:"4",required:!0})]}),D.jsxs("div",{children:[D.jsx("label",{className:"block mb-1 font-semibold",children:"Description:"}),D.jsx("textarea",{name:"description",value:s.description,onChange:m,className:"w-full px-3 py-2 border rounded",rows:"4",required:!0})]}),D.jsxs("div",{children:[D.jsx("label",{className:"block mb-1 font-semibold",children:"Image:"}),D.jsx("input",{type:"file",name:"image",accept:"image/*",onChange:m,className:"w-full px-3 py-2 border rounded"}),h&&D.jsxs("div",{className:"mt-2",children:[D.jsx("img",{src:h,alt:"Preview",className:"max-w-20 h-auto"}),D.jsx("button",{type:"button",onClick:y,className:"text-red-500 mt-2",children:"Remove Image"})]})]}),D.jsx("button",{type:"submit",className:"bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600",children:"Update Contacts Category"})]})]})]})}const lB=Mm("http://localhost:4000");function Cgt(){const[e,r]=Y.useState([]);Y.useEffect(()=>(s(),lB.on("newEmergencyReport",a=>{r(h=>[a,...h])}),()=>{lB.off("newEmergencyReport")}),[]);const s=async()=>{try{const a=await yn.get("/api/v1/report");r(a.data)}catch(a){console.error("Error fetching emergency reports:",a)}};return D.jsxs("div",{className:"flex",children:[D.jsx("section",{className:"fixed left-0 top-0 bottom-0 w-64 bg-white overflow-y-auto border-r border-gray-200",children:D.jsx(vu,{})}),D.jsxs("div",{className:"flex-1 ml-64 mr-4 mt-8 p-4 rounded shadow",children:[D.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Emergency Reports"}),D.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[D.jsx("thead",{className:"bg-gray-50",children:D.jsxs("tr",{children:[D.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Location"}),D.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"})]})}),D.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map((a,h)=>D.jsxs("tr",{children:[D.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.location}),D.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.description})]},h))})]})]})]})}function Pgt(){const[e,r]=Y.useState([]),[s,a]=Y.useState(1),[h,f]=Y.useState(1),[m]=Y.useState(7);Y.useEffect(()=>{y()},[s]);const y=async()=>{try{const T=await yn.get(`/api/v1/categories/pagination?page=${s}&limit=${m}`);r(T.data.categories),f(T.data.totalPages)}catch(T){console.error("Error fetching guidelines:",T)}},x=async T=>{try{await yn.delete(`/api/v1/categories/${T}`),r(e.filter(M=>M._id!==T))}catch(M){console.error("Error deleting category:",M)}},w=T=>{a(T)};return D.jsx("div",{className:"w-full mx-auto mt-8 flex justify-center",children:D.jsxs("div",{className:"overflow-x-auto",children:[D.jsxs("table",{className:"table-auto w-full text-sm",children:[D.jsx("thead",{children:D.jsxs("tr",{children:[D.jsx("th",{className:"px-4 py-2",children:"Name"}),D.jsx("th",{className:"px-4 py-2",children:"Description"}),D.jsx("th",{className:"px-4 py-2",children:"Image"}),D.jsx("th",{className:"px-4 py-2",children:"Actions"})]})}),D.jsx("tbody",{children:e.map(T=>D.jsxs("tr",{children:[D.jsx("td",{className:"border px-4 py-2",children:T.name}),D.jsx("td",{className:"border px-4 py-2 w-auto",children:T.description}),D.jsx("td",{className:"border px-4 py-2",children:D.jsx("img",{src:T.image,alt:T.name,className:"h-10 w-10 object-cover"})}),D.jsx("td",{className:"border px-4 py-2",children:D.jsxs("div",{className:"flex",children:[D.jsx(qn,{to:`/admin/update/category/guidelines/${T._id}`,className:"mr-2",children:D.jsx(DV,{className:"text-blue-500"})}),D.jsx("button",{onClick:()=>x(T._id),children:D.jsx(RV,{className:"text-red-500"})})]})})]},T._id))})]}),D.jsx("div",{className:"flex justify-center mt-4",children:Array.from({length:h},(T,M)=>D.jsx("button",{onClick:()=>w(M+1),className:`mx-1 px-3 py-1 rounded ${s===M+1?"bg-gray-800 text-white":"bg-gray-200 text-gray-800"}`,children:M+1},M+1))})]})})}function Igt(){const[e,r]=Y.useState(!1),[s,a]=Y.useState({name:"",short_description:"",description:"",image:null}),h=m=>{const{name:y,value:x,files:w}=m.target;a(T=>({...T,[y]:y==="image"?w[0]:x}))},f=async m=>{m.preventDefault(),r(!0);const y=new FormData;y.append("name",s.name),y.append("short_description",s.short_description),y.append("description",s.description),y.append("image",s.image);try{const x=await yn.post("/api/v1/categories",y,{headers:{"Content-Type":"multipart/form-data"}});fr.success("Category created successfully"),console.log("Guideline category created:",x.data),r(!1),a({name:"",short_description:"",description:"",image:null})}catch(x){fr.error("Error creating category"),console.error("Error creating guideline category:",x)}};return D.jsxs(D.Fragment,{children:[D.jsx(IP,{}),D.jsx("div",{className:"flex",children:D.jsxs("div",{className:"w-full m-3",children:[D.jsx(dP,{}),D.jsx("h1",{className:"text-3xl font-bold mb-3 text-center",children:"Guidelines Category"}),D.jsxs("div",{className:"flex flex-col md:flex-row border rounded p-4",children:[" ",D.jsx("div",{className:"md:mr-5 flex-1 mb-5 md:mb-0",children:D.jsxs("form",{onSubmit:f,className:"space-y-4 text-sm",children:[D.jsx("h1",{className:"text-3xl font-bold mb-3 text-center",children:"CREATE CATEGORY"}),D.jsxs("div",{children:[D.jsx("label",{className:"block mb-1 font-semibold",children:"Name:"}),D.jsx("input",{type:"text",name:"name",value:s.name,onChange:h,className:"w-full px-3 py-2 border rounded",required:!0})]}),D.jsxs("div",{children:[D.jsx("label",{className:"block mb-1 font-semibold",children:"Short Description:"}),D.jsx("input",{type:"text",name:"short_description",value:s.short_description,onChange:h,className:"w-full px-3 py-2 border rounded",required:!0})]}),D.jsxs("div",{children:[D.jsx("label",{className:"block mb-1 font-semibold",children:"Description:"}),D.jsx("textarea",{name:"description",value:s.description,onChange:h,className:"w-full px-3 py-2 border rounded",rows:"4",required:!0})]}),D.jsxs("div",{children:[D.jsx("label",{className:"block mb-1 font-semibold",children:"Image:"}),D.jsx("input",{type:"file",name:"image",accept:"image/*",onChange:h,className:"w-full px-3 py-2 border rounded",required:!0})]}),D.jsx("button",{type:"submit",disabled:e,className:`bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 w-full md:w-auto ${e?"opacity-50 cursor-not-allowed":""}`,children:e?"Creating...":"Create Category"})]})}),D.jsx("div",{className:"flex-1 border-t mt-5 md:mt-0 md:border-t-0 md:border-l md:pl-5",children:D.jsx("div",{children:D.jsx(Pgt,{})})})]})]})})]})}function kgt(){const e=$l(),{categoryId:r}=Cf(),[s,a]=Y.useState({name:"",short_description:"",description:"",image:null}),[h,f]=Y.useState(null);Y.useEffect(()=>{async function w(){try{const T=await yn.get(`/api/v1/categories/${r}`),{name:M,short_description:I,description:R,image:O}=T.data;a({name:M,short_description:I,description:R,image:O}),O&&f(O)}catch(T){console.error("Error fetching category details:",T)}}w()},[r]);const m=w=>{const{name:T,value:M,files:I}=w.target;if(T==="image"&&I.length>0){const R=new FileReader;R.onload=()=>{f(R.result)},R.readAsDataURL(I[0])}a(R=>({...R,[T]:T==="image"?I[0]:M}))},y=()=>{a(w=>({...w,image:null})),f(null)},x=async w=>{w.preventDefault();const T=new FormData;T.append("name",s.name),T.append("short_description",s.short_description),T.append("description",s.description),T.append("image",s.image);try{const M=await yn.put(`/api/v1/categories/${r}`,T,{headers:{"Content-Type":"multipart/form-data"}});console.log("Category updated:",M.data),e("/admin/create/category/guidelines"),a({name:"",short_description:"",description:"",image:null}),f(null)}catch(M){console.error("Error updating category:",M)}};return D.jsxs("div",{className:"flex",children:[D.jsx("section",{className:"fixed left-0 top-0 bottom-0 w-64 bg-white overflow-y-auto border-r border-gray-200",children:D.jsx(vu,{})}),D.jsxs("div",{className:"flex-1 ml-64 mr-4 mt-8 p-4 rounded shadow",children:[D.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Update Contacts Category"}),D.jsxs("form",{onSubmit:x,className:"space-y-4",children:[D.jsxs("div",{children:[D.jsx("label",{className:"block mb-1 font-semibold",children:"Name:"}),D.jsx("input",{type:"text",name:"name",value:s.name,onChange:m,className:"w-full px-3 py-2 border rounded",required:!0})]}),D.jsxs("div",{children:[D.jsx("label",{className:"block mb-1 font-semibold",children:"Short Description:"}),D.jsx("textarea",{name:"short_description",value:s.short_description,onChange:m,className:"w-full px-3 py-2 border rounded",rows:"4",required:!0})]}),D.jsxs("div",{children:[D.jsx("label",{className:"block mb-1 font-semibold",children:"Description:"}),D.jsx("textarea",{name:"description",value:s.description,onChange:m,className:"w-full px-3 py-2 border rounded",rows:"4",required:!0})]}),D.jsxs("div",{children:[D.jsx("label",{className:"block mb-1 font-semibold",children:"Image:"}),D.jsx("input",{type:"file",name:"image",accept:"image/*",onChange:m,className:"w-full px-3 py-2 border rounded"}),h&&D.jsxs("div",{className:"mt-2",children:[D.jsx("img",{src:h,alt:"Preview",className:"max-w-20 h-auto"}),D.jsx("button",{type:"button",onClick:y,className:"text-red-500 mt-2",children:"Remove Image"})]})]}),D.jsx("button",{type:"submit",className:"bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600",children:"Update Contacts Category"})]})]})]})}function Dgt(){const{departmentId:e}=Cf(),[r,s]=Y.useState({name:"",description:""});Y.useEffect(()=>{(async()=>{try{const y=(await yn.get(`/api/v1/departments/${e}`)).data;s({name:y.name,description:y.description})}catch(m){console.error("Error fetching department:",m)}})()},[e]);const a=f=>{s({...r,[f.target.name]:f.target.value})},h=async f=>{f.preventDefault();try{await yn.put(`/api/v1/departments/${e}`,r),console.log("Department updated successfully"),navigate("/admin/create/departments")}catch(m){console.error("Error updating department:",m)}};return D.jsxs("div",{className:"flex",children:[D.jsx("section",{className:"fixed left-0 top-0 bottom-0 w-64 bg-white overflow-y-auto border-r border-gray-200",children:D.jsx(vu,{})}),D.jsxs("div",{className:"flex-1 ml-64 mr-4 mt-8 p-4 rounded shadow",children:[D.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Update Department"}),D.jsxs("form",{onSubmit:h,className:"space-y-4",children:[D.jsxs("div",{children:[D.jsx("label",{className:"block mb-1 font-semibold",children:"Name:"}),D.jsx("input",{type:"text",name:"name",value:r.name,onChange:a,className:"w-full px-3 py-2 border rounded",required:!0})]}),D.jsxs("div",{children:[D.jsx("label",{className:"block mb-1 font-semibold",children:"Description:"}),D.jsx("textarea",{name:"description",value:r.description,onChange:a,className:"w-full px-3 py-2 border rounded",rows:"4",required:!0})]}),D.jsx("button",{type:"submit",className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600",children:"Update Department"})]})]})]})}const cB=Mm("http://localhost:4000"),Rgt=({element:e})=>{const r=Rh(s=>{var a;return(a=s.user.currentUser)==null?void 0:a.role});return Y.useEffect(()=>{r!=="Admin"&&(window.location.href="/")},[r]),D.jsx(D.Fragment,{children:e})};function Ogt(){const[e,r]=Y.useState(!1),[s,a]=Y.useState(null);return Y.useEffect(()=>(cB.on("newEmergencyReport",h=>{a(h)}),()=>{cB.off("newEmergencyReport")})),Y.useEffect(()=>{r(window.location.pathname.startsWith("/admin"))},[]),D.jsxs(S2,{children:[!e&&D.jsx(Crt,{}),D.jsxs(G5,{children:[D.jsx(Zr,{path:"/",element:D.jsx(ult,{})}),D.jsx(Zr,{path:"/register",element:D.jsx(Act,{})}),D.jsx(Zr,{path:"/login",element:D.jsx(Lut,{})}),D.jsx(Zr,{path:"/blog",element:D.jsx(i8,{})}),D.jsx(Zr,{path:"/evacuation/guidelines",element:D.jsx(But,{})}),D.jsx(Zr,{path:"/user/profile",element:D.jsx(tht,{})}),D.jsx(Zr,{path:"/admin/*",element:D.jsx(Rgt,{element:D.jsxs(G5,{children:[D.jsx(Zr,{path:"dashboard",element:D.jsx(_gt,{})}),D.jsx(Zr,{path:"report",element:D.jsx(Cgt,{})}),D.jsx(Zr,{path:"create/steps",element:D.jsx(Tgt,{})}),D.jsx(Zr,{path:"create/contacts",element:D.jsx(Agt,{})}),D.jsx(Zr,{path:"create/guidelines",element:D.jsx(vgt,{})}),D.jsx(Zr,{path:"create/category/contacts",element:D.jsx(aE,{})}),D.jsx(Zr,{path:"create/category/guidelines",element:D.jsx(Igt,{})}),D.jsx(Zr,{path:"update/steps/:stepId",element:D.jsx(Egt,{})}),D.jsx(Zr,{path:"update/departments/:departmentId",element:D.jsx(Dgt,{})}),D.jsx(Zr,{path:"update/contacts/:contactId",element:D.jsx(aE,{})}),D.jsx(Zr,{path:"update/guidelines/:guidelineId",element:D.jsx(xgt,{})}),D.jsx(Zr,{path:"update/category/contacts/:categoryId",element:D.jsx(aE,{})}),D.jsx(Zr,{path:"update/category/guidelines/:categoryId",element:D.jsx(kgt,{})}),D.jsx(Zr,{path:"guideline/table",element:D.jsx(W$,{})}),D.jsx(Zr,{path:"guidelines/:guidelineId",element:D.jsx(Sgt,{})}),D.jsx(Zr,{path:"profile",element:D.jsx(ygt,{})})]})})})]}),!e&&D.jsx(Prt,{})]})}function yv(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?yv=function(s){return typeof s}:yv=function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},yv(e)}function Lgt(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function uB(e,r){for(var s=0;s<r.length;s++){var a=r[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function zgt(e,r,s){return r&&uB(e.prototype,r),s&&uB(e,s),e}function Ngt(e,r){return r&&(yv(r)==="object"||typeof r=="function")?r:vv(e)}function oA(e){return oA=Object.setPrototypeOf?Object.getPrototypeOf:function(s){return s.__proto__||Object.getPrototypeOf(s)},oA(e)}function vv(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fgt(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&aA(e,r)}function aA(e,r){return aA=Object.setPrototypeOf||function(a,h){return a.__proto__=h,a},aA(e,r)}function xv(e,r,s){return r in e?Object.defineProperty(e,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[r]=s,e}var Z$=function(e){Fgt(r,e);function r(){var s,a;Lgt(this,r);for(var h=arguments.length,f=new Array(h),m=0;m<h;m++)f[m]=arguments[m];return a=Ngt(this,(s=oA(r)).call.apply(s,[this].concat(f))),xv(vv(a),"state",{bootstrapped:!1}),xv(vv(a),"_unsubscribe",void 0),xv(vv(a),"handlePersistorState",function(){var y=a.props.persistor,x=y.getState(),w=x.bootstrapped;w&&(a.props.onBeforeLift?Promise.resolve(a.props.onBeforeLift()).finally(function(){return a.setState({bootstrapped:!0})}):a.setState({bootstrapped:!0}),a._unsubscribe&&a._unsubscribe())}),a}return zgt(r,[{key:"componentDidMount",value:function(){this._unsubscribe=this.props.persistor.subscribe(this.handlePersistorState),this.handlePersistorState()}},{key:"componentWillUnmount",value:function(){this._unsubscribe&&this._unsubscribe()}},{key:"render",value:function(){return typeof this.props.children=="function"?this.props.children(this.state.bootstrapped):this.state.bootstrapped?this.props.children:this.props.loading}}]),r}(Y.PureComponent);xv(Z$,"defaultProps",{children:null,loading:null});var kP="persist:",X$="persist/FLUSH",DP="persist/REHYDRATE",Y$="persist/PAUSE",K$="persist/PERSIST",J$="persist/PURGE",Q$="persist/REGISTER",Bgt=-1;function bv(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?bv=function(s){return typeof s}:bv=function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},bv(e)}function hB(e,r){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),s.push.apply(s,a)}return s}function jgt(e){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?hB(s,!0).forEach(function(a){Vgt(e,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):hB(s).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(s,a))})}return e}function Vgt(e,r,s){return r in e?Object.defineProperty(e,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[r]=s,e}function Ugt(e,r,s,a){a.debug;var h=jgt({},s);return e&&bv(e)==="object"&&Object.keys(e).forEach(function(f){f!=="_persist"&&r[f]===s[f]&&(h[f]=e[f])}),h}function $gt(e){var r=e.blacklist||null,s=e.whitelist||null,a=e.transforms||[],h=e.throttle||0,f="".concat(e.keyPrefix!==void 0?e.keyPrefix:kP).concat(e.key),m=e.storage,y;e.serialize===!1?y=function(K){return K}:typeof e.serialize=="function"?y=e.serialize:y=Ggt;var x=e.writeFailHandler||null,w={},T={},M=[],I=null,R=null,O=function(K){Object.keys(K).forEach(function(at){$(at)&&w[at]!==K[at]&&M.indexOf(at)===-1&&M.push(at)}),Object.keys(w).forEach(function(at){K[at]===void 0&&$(at)&&M.indexOf(at)===-1&&w[at]!==void 0&&M.push(at)}),I===null&&(I=setInterval(N,h)),w=K};function N(){if(M.length===0){I&&clearInterval(I),I=null;return}var H=M.shift(),K=a.reduce(function(at,ft){return ft.in(at,H,w)},w[H]);if(K!==void 0)try{T[H]=y(K)}catch(at){console.error("redux-persist/createPersistoid: error serializing state",at)}else delete T[H];M.length===0&&G()}function G(){Object.keys(T).forEach(function(H){w[H]===void 0&&delete T[H]}),R=m.setItem(f,y(T)).catch(z)}function $(H){return!(s&&s.indexOf(H)===-1&&H!=="_persist"||r&&r.indexOf(H)!==-1)}function z(H){x&&x(H)}var B=function(){for(;M.length!==0;)N();return R||Promise.resolve()};return{update:O,flush:B}}function Ggt(e){return JSON.stringify(e)}function Wgt(e){var r=e.transforms||[],s="".concat(e.keyPrefix!==void 0?e.keyPrefix:kP).concat(e.key),a=e.storage;e.debug;var h;return e.deserialize===!1?h=function(m){return m}:typeof e.deserialize=="function"?h=e.deserialize:h=Hgt,a.getItem(s).then(function(f){if(f)try{var m={},y=h(f);return Object.keys(y).forEach(function(x){m[x]=r.reduceRight(function(w,T){return T.out(w,x,y)},h(y[x]))}),m}catch(x){throw x}else return})}function Hgt(e){return JSON.parse(e)}function qgt(e){var r=e.storage,s="".concat(e.keyPrefix!==void 0?e.keyPrefix:kP).concat(e.key);return r.removeItem(s,Zgt)}function Zgt(e){}function dB(e,r){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),s.push.apply(s,a)}return s}function vl(e){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?dB(s,!0).forEach(function(a){Xgt(e,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):dB(s).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(s,a))})}return e}function Xgt(e,r,s){return r in e?Object.defineProperty(e,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[r]=s,e}function Ygt(e,r){if(e==null)return{};var s=Kgt(e,r),a,h;if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(e);for(h=0;h<f.length;h++)a=f[h],!(r.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(s[a]=e[a])}return s}function Kgt(e,r){if(e==null)return{};var s={},a=Object.keys(e),h,f;for(f=0;f<a.length;f++)h=a[f],!(r.indexOf(h)>=0)&&(s[h]=e[h]);return s}var Jgt=5e3;function Qgt(e,r){var s=e.version!==void 0?e.version:Bgt;e.debug;var a=e.stateReconciler===void 0?Ugt:e.stateReconciler,h=e.getStoredState||Wgt,f=e.timeout!==void 0?e.timeout:Jgt,m=null,y=!1,x=!0,w=function(M){return M._persist.rehydrated&&m&&!x&&m.update(M),M};return function(T,M){var I=T||{},R=I._persist,O=Ygt(I,["_persist"]),N=O;if(M.type===K$){var G=!1,$=function(et,nt){G||(M.rehydrate(e.key,et,nt),G=!0)};if(f&&setTimeout(function(){!G&&$(void 0,new Error('redux-persist: persist timed out for persist key "'.concat(e.key,'"')))},f),x=!1,m||(m=$gt(e)),R)return vl({},r(N,M),{_persist:R});if(typeof M.rehydrate!="function"||typeof M.register!="function")throw new Error("redux-persist: either rehydrate or register is not a function on the PERSIST action. This can happen if the action is being replayed. This is an unexplored use case, please open an issue and we will figure out a resolution.");return M.register(e.key),h(e).then(function(ft){var et=e.migrate||function(nt,W){return Promise.resolve(nt)};et(ft,s).then(function(nt){$(nt)},function(nt){$(void 0,nt)})},function(ft){$(void 0,ft)}),vl({},r(N,M),{_persist:{version:s,rehydrated:!1}})}else{if(M.type===J$)return y=!0,M.result(qgt(e)),vl({},r(N,M),{_persist:R});if(M.type===X$)return M.result(m&&m.flush()),vl({},r(N,M),{_persist:R});if(M.type===Y$)x=!0;else if(M.type===DP){if(y)return vl({},N,{_persist:vl({},R,{rehydrated:!0})});if(M.key===e.key){var z=r(N,M),B=M.payload,H=a!==!1&&B!==void 0?a(B,T,z,e):z,K=vl({},H,{_persist:vl({},R,{rehydrated:!0})});return w(K)}}}if(!R)return r(T,M);var at=r(N,M);return at===N?T:w(vl({},at,{_persist:R}))}}function fB(e){return n_t(e)||e_t(e)||t_t()}function t_t(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function e_t(e){if(Symbol.iterator in Object(e)||Object.prototype.toString.call(e)==="[object Arguments]")return Array.from(e)}function n_t(e){if(Array.isArray(e)){for(var r=0,s=new Array(e.length);r<e.length;r++)s[r]=e[r];return s}}function pB(e,r){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(h){return Object.getOwnPropertyDescriptor(e,h).enumerable})),s.push.apply(s,a)}return s}function lA(e){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?pB(s,!0).forEach(function(a){r_t(e,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):pB(s).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(s,a))})}return e}function r_t(e,r,s){return r in e?Object.defineProperty(e,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[r]=s,e}var t7={registry:[],bootstrapped:!1},i_t=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:t7,s=arguments.length>1?arguments[1]:void 0;switch(s.type){case Q$:return lA({},r,{registry:[].concat(fB(r.registry),[s.key])});case DP:var a=r.registry.indexOf(s.key),h=fB(r.registry);return h.splice(a,1),lA({},r,{registry:h,bootstrapped:h.length===0});default:return r}};function s_t(e,r,s){var a=s||!1,h=aP(i_t,t7,r&&r.enhancer?r.enhancer:void 0),f=function(w){h.dispatch({type:Q$,key:w})},m=function(w,T,M){var I={type:DP,payload:T,err:M,key:w};e.dispatch(I),h.dispatch(I),a&&y.getState().bootstrapped&&(a(),a=!1)},y=lA({},h,{purge:function(){var w=[];return e.dispatch({type:J$,result:function(M){w.push(M)}}),Promise.all(w)},flush:function(){var w=[];return e.dispatch({type:X$,result:function(M){w.push(M)}}),Promise.all(w)},pause:function(){e.dispatch({type:Y$})},persist:function(){e.dispatch({type:K$,register:f,rehydrate:m})}});return r&&r.manualPersist||y.persist(),y}var RP={},OP={};OP.__esModule=!0;OP.default=l_t;function wv(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?wv=function(s){return typeof s}:wv=function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},wv(e)}function lE(){}var o_t={getItem:lE,setItem:lE,removeItem:lE};function a_t(e){if((typeof self>"u"?"undefined":wv(self))!=="object"||!(e in self))return!1;try{var r=self[e],s="redux-persist ".concat(e," test");r.setItem(s,"test"),r.getItem(s),r.removeItem(s)}catch{return!1}return!0}function l_t(e){var r="".concat(e,"Storage");return a_t(r)?self[r]:o_t}RP.__esModule=!0;RP.default=h_t;var c_t=u_t(OP);function u_t(e){return e&&e.__esModule?e:{default:e}}function h_t(e){var r=(0,c_t.default)(e);return{getItem:function(a){return new Promise(function(h,f){h(r.getItem(a))})},setItem:function(a,h){return new Promise(function(f,m){f(r.setItem(a,h))})},removeItem:function(a){return new Promise(function(h,f){h(r.removeItem(a))})}}}var e7=void 0,d_t=f_t(RP);function f_t(e){return e&&e.__esModule?e:{default:e}}var p_t=(0,d_t.default)("local");e7=p_t;const m_t=M8({user:Dut}),g_t={key:"root",storage:e7,version:1},__t=Qgt(g_t,m_t),n7=cut({reducer:__t,middleware:e=>e({serializableCheck:!1})}),y_t=s_t(n7),v_t=cE.createRoot(document.getElementById("root"));v_t.render(D.jsx(H2,{store:n7,children:D.jsx(Z$,{loading:null,persistor:y_t,children:D.jsx(Ogt,{})})}));
